Starting Experiments...
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:36:17,877 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 06:36:17,877 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:36:17,971 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:36:17,989 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:36:17,994 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 06:36:17,994 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 4.1869
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.521665:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.521665:   1%|          | 1/100 [00:02<04:05,  2.47s/it]Best trial: 1. Best value: 0.53121:   1%|          | 1/100 [00:04<04:05,  2.47s/it] Best trial: 1. Best value: 0.53121:   2%|▏         | 2/100 [00:04<03:37,  2.22s/it]Best trial: 2. Best value: 0.534835:   2%|▏         | 2/100 [00:06<03:37,  2.22s/it]Best trial: 2. Best value: 0.534835:   3%|▎         | 3/100 [00:06<03:18,  2.05s/it]Best trial: 2. Best value: 0.534835:   3%|▎         | 3/100 [00:09<03:18,  2.05s/it]Best trial: 2. Best value: 0.534835:   4%|▍         | 4/100 [00:09<04:10,  2.61s/it]Best trial: 2. Best value: 0.534835:   4%|▍         | 4/100 [00:12<04:10,  2.61s/it]Best trial: 2. Best value: 0.534835:   5%|▌         | 5/100 [00:12<04:10,  2.64s/it]Best trial: 2. Best value: 0.534835:   5%|▌         | 5/100 [00:14<04:10,  2.64s/it]Best trial: 2. Best value: 0.534835:   6%|▌         | 6/100 [00:14<03:46,  2.41s/it]Best trial: 2. Best value: 0.534835:   6%|▌         | 6/100 [00:16<03:46,  2.41s/it]Best trial: 2. Best value: 0.534835:   7%|▋         | 7/100 [00:16<03:24,  2.20s/it]Best trial: 2. Best value: 0.534835:   7%|▋         | 7/100 [00:17<03:24,  2.20s/it]Best trial: 2. Best value: 0.534835:   8%|▊         | 8/100 [00:17<03:08,  2.05s/it]Best trial: 2. Best value: 0.534835:   8%|▊         | 8/100 [00:20<03:08,  2.05s/it]Best trial: 2. Best value: 0.534835:   9%|▉         | 9/100 [00:20<03:20,  2.21s/it]Best trial: 9. Best value: 0.542366:   9%|▉         | 9/100 [00:24<03:20,  2.21s/it]Best trial: 9. Best value: 0.542366:  10%|█         | 10/100 [00:24<03:56,  2.63s/it]Best trial: 10. Best value: 0.543741:  10%|█         | 10/100 [00:26<03:56,  2.63s/it]Best trial: 10. Best value: 0.543741:  11%|█         | 11/100 [00:26<03:40,  2.48s/it]Best trial: 11. Best value: 0.552249:  11%|█         | 11/100 [00:28<03:40,  2.48s/it]Best trial: 11. Best value: 0.552249:  12%|█▏        | 12/100 [00:28<03:30,  2.40s/it]Best trial: 11. Best value: 0.552249:  12%|█▏        | 12/100 [00:30<03:30,  2.40s/it]Best trial: 11. Best value: 0.552249:  13%|█▎        | 13/100 [00:30<03:20,  2.30s/it]Best trial: 11. Best value: 0.552249:  13%|█▎        | 13/100 [00:32<03:20,  2.30s/it]Best trial: 11. Best value: 0.552249:  14%|█▍        | 14/100 [00:32<03:15,  2.28s/it]Best trial: 11. Best value: 0.552249:  14%|█▍        | 14/100 [00:35<03:15,  2.28s/it]Best trial: 11. Best value: 0.552249:  15%|█▌        | 15/100 [00:35<03:29,  2.46s/it]Best trial: 11. Best value: 0.552249:  15%|█▌        | 15/100 [00:37<03:29,  2.46s/it]Best trial: 11. Best value: 0.552249:  16%|█▌        | 16/100 [00:37<03:14,  2.32s/it]Best trial: 11. Best value: 0.552249:  16%|█▌        | 16/100 [00:40<03:14,  2.32s/it]Best trial: 11. Best value: 0.552249:  17%|█▋        | 17/100 [00:40<03:15,  2.36s/it]Best trial: 11. Best value: 0.552249:  17%|█▋        | 17/100 [00:41<03:15,  2.36s/it]Best trial: 11. Best value: 0.552249:  18%|█▊        | 18/100 [00:41<03:00,  2.20s/it]Best trial: 11. Best value: 0.552249:  18%|█▊        | 18/100 [00:45<03:00,  2.20s/it]Best trial: 11. Best value: 0.552249:  19%|█▉        | 19/100 [00:45<03:21,  2.48s/it]Best trial: 11. Best value: 0.552249:  19%|█▉        | 19/100 [00:47<03:21,  2.48s/it]Best trial: 11. Best value: 0.552249:  20%|██        | 20/100 [00:47<03:17,  2.46s/it]Best trial: 11. Best value: 0.552249:  20%|██        | 20/100 [00:48<03:17,  2.46s/it]Best trial: 11. Best value: 0.552249:  21%|██        | 21/100 [00:48<02:48,  2.14s/it]Best trial: 11. Best value: 0.552249:  21%|██        | 21/100 [00:51<02:48,  2.14s/it]Best trial: 11. Best value: 0.552249:  22%|██▏       | 22/100 [00:51<02:57,  2.27s/it]Best trial: 11. Best value: 0.552249:  22%|██▏       | 22/100 [00:54<02:57,  2.27s/it]Best trial: 11. Best value: 0.552249:  23%|██▎       | 23/100 [00:54<03:05,  2.41s/it]Best trial: 11. Best value: 0.552249:  23%|██▎       | 23/100 [00:56<03:05,  2.41s/it]Best trial: 11. Best value: 0.552249:  24%|██▍       | 24/100 [00:56<03:04,  2.43s/it]Best trial: 11. Best value: 0.552249:  24%|██▍       | 24/100 [00:59<03:04,  2.43s/it]Best trial: 11. Best value: 0.552249:  25%|██▌       | 25/100 [00:59<03:05,  2.48s/it]Best trial: 11. Best value: 0.552249:  25%|██▌       | 25/100 [01:01<03:05,  2.48s/it]Best trial: 11. Best value: 0.552249:  26%|██▌       | 26/100 [01:01<02:59,  2.42s/it]Best trial: 11. Best value: 0.552249:  26%|██▌       | 26/100 [01:03<02:59,  2.42s/it]Best trial: 11. Best value: 0.552249:  27%|██▋       | 27/100 [01:03<02:40,  2.20s/it]Best trial: 11. Best value: 0.552249:  27%|██▋       | 27/100 [01:06<02:40,  2.20s/it]Best trial: 11. Best value: 0.552249:  28%|██▊       | 28/100 [01:06<03:06,  2.59s/it]Best trial: 28. Best value: 0.555088:  28%|██▊       | 28/100 [01:10<03:06,  2.59s/it]Best trial: 28. Best value: 0.555088:  29%|██▉       | 29/100 [01:10<03:25,  2.89s/it]Best trial: 28. Best value: 0.555088:  29%|██▉       | 29/100 [01:13<03:25,  2.89s/it]Best trial: 28. Best value: 0.555088:  30%|███       | 30/100 [01:13<03:35,  3.07s/it]Best trial: 28. Best value: 0.555088:  30%|███       | 30/100 [01:17<03:35,  3.07s/it]Best trial: 28. Best value: 0.555088:  31%|███       | 31/100 [01:17<03:34,  3.12s/it]Best trial: 31. Best value: 0.562497:  31%|███       | 31/100 [01:19<03:34,  3.12s/it]Best trial: 31. Best value: 0.562497:  32%|███▏      | 32/100 [01:19<03:21,  2.96s/it]Best trial: 31. Best value: 0.562497:  32%|███▏      | 32/100 [01:23<03:21,  2.96s/it]Best trial: 31. Best value: 0.562497:  33%|███▎      | 33/100 [01:23<03:31,  3.15s/it]Best trial: 31. Best value: 0.562497:  33%|███▎      | 33/100 [01:26<03:31,  3.15s/it]Best trial: 31. Best value: 0.562497:  34%|███▍      | 34/100 [01:26<03:25,  3.12s/it]Best trial: 31. Best value: 0.562497:  34%|███▍      | 34/100 [01:29<03:25,  3.12s/it]Best trial: 31. Best value: 0.562497:  35%|███▌      | 35/100 [01:29<03:19,  3.08s/it]Best trial: 31. Best value: 0.562497:  35%|███▌      | 35/100 [01:31<03:19,  3.08s/it]Best trial: 31. Best value: 0.562497:  36%|███▌      | 36/100 [01:31<03:06,  2.91s/it]Best trial: 31. Best value: 0.562497:  36%|███▌      | 36/100 [01:35<03:06,  2.91s/it]Best trial: 31. Best value: 0.562497:  37%|███▋      | 37/100 [01:35<03:15,  3.10s/it]Best trial: 31. Best value: 0.562497:  37%|███▋      | 37/100 [01:37<03:15,  3.10s/it]Best trial: 31. Best value: 0.562497:  38%|███▊      | 38/100 [01:37<02:55,  2.83s/it]Best trial: 31. Best value: 0.562497:  38%|███▊      | 38/100 [01:41<02:55,  2.83s/it]Best trial: 31. Best value: 0.562497:  39%|███▉      | 39/100 [01:41<03:23,  3.33s/it]Best trial: 31. Best value: 0.562497:  39%|███▉      | 39/100 [01:46<03:23,  3.33s/it]Best trial: 31. Best value: 0.562497:  40%|████      | 40/100 [01:46<03:36,  3.60s/it]Best trial: 31. Best value: 0.562497:  40%|████      | 40/100 [01:48<03:36,  3.60s/it]Best trial: 31. Best value: 0.562497:  41%|████      | 41/100 [01:48<03:16,  3.33s/it]Best trial: 31. Best value: 0.562497:  41%|████      | 41/100 [01:51<03:16,  3.33s/it]Best trial: 31. Best value: 0.562497:  42%|████▏     | 42/100 [01:51<02:52,  2.98s/it]Best trial: 31. Best value: 0.562497:  42%|████▏     | 42/100 [01:54<02:52,  2.98s/it]Best trial: 31. Best value: 0.562497:  43%|████▎     | 43/100 [01:54<02:48,  2.96s/it]Best trial: 31. Best value: 0.562497:  43%|████▎     | 43/100 [01:57<02:48,  2.96s/it]Best trial: 31. Best value: 0.562497:  44%|████▍     | 44/100 [01:57<02:53,  3.09s/it]Best trial: 31. Best value: 0.562497:  44%|████▍     | 44/100 [02:01<02:53,  3.09s/it]Best trial: 31. Best value: 0.562497:  45%|████▌     | 45/100 [02:01<03:03,  3.33s/it]Best trial: 31. Best value: 0.562497:  45%|████▌     | 45/100 [02:03<03:03,  3.33s/it]Best trial: 31. Best value: 0.562497:  46%|████▌     | 46/100 [02:03<02:39,  2.96s/it]Best trial: 31. Best value: 0.562497:  46%|████▌     | 46/100 [02:05<02:39,  2.96s/it]Best trial: 31. Best value: 0.562497:  47%|████▋     | 47/100 [02:05<02:23,  2.71s/it]Best trial: 31. Best value: 0.562497:  47%|████▋     | 47/100 [02:09<02:23,  2.71s/it]Best trial: 31. Best value: 0.562497:  48%|████▊     | 48/100 [02:09<02:38,  3.04s/it]Best trial: 31. Best value: 0.562497:  48%|████▊     | 48/100 [02:12<02:38,  3.04s/it]Best trial: 31. Best value: 0.562497:  49%|████▉     | 49/100 [02:12<02:40,  3.14s/it]Best trial: 31. Best value: 0.562497:  49%|████▉     | 49/100 [02:20<02:40,  3.14s/it]Best trial: 31. Best value: 0.562497:  50%|█████     | 50/100 [02:20<03:50,  4.60s/it]Best trial: 31. Best value: 0.562497:  50%|█████     | 50/100 [02:24<03:50,  4.60s/it]Best trial: 31. Best value: 0.562497:  51%|█████     | 51/100 [02:24<03:39,  4.48s/it]Best trial: 31. Best value: 0.562497:  51%|█████     | 51/100 [02:29<03:39,  4.48s/it]Best trial: 31. Best value: 0.562497:  52%|█████▏    | 52/100 [02:29<03:42,  4.64s/it]Best trial: 31. Best value: 0.562497:  52%|█████▏    | 52/100 [02:33<03:42,  4.64s/it]Best trial: 31. Best value: 0.562497:  53%|█████▎    | 53/100 [02:33<03:25,  4.38s/it]Best trial: 31. Best value: 0.562497:  53%|█████▎    | 53/100 [02:37<03:25,  4.38s/it]Best trial: 31. Best value: 0.562497:  54%|█████▍    | 54/100 [02:37<03:11,  4.17s/it]Best trial: 31. Best value: 0.562497:  54%|█████▍    | 54/100 [02:40<03:11,  4.17s/it]Best trial: 31. Best value: 0.562497:  55%|█████▌    | 55/100 [02:40<02:50,  3.78s/it]Best trial: 31. Best value: 0.562497:  55%|█████▌    | 55/100 [02:45<02:50,  3.78s/it]Best trial: 31. Best value: 0.562497:  56%|█████▌    | 56/100 [02:45<03:01,  4.11s/it]Best trial: 31. Best value: 0.562497:  56%|█████▌    | 56/100 [02:49<03:01,  4.11s/it]Best trial: 31. Best value: 0.562497:  57%|█████▋    | 57/100 [02:49<02:58,  4.14s/it]Best trial: 31. Best value: 0.562497:  57%|█████▋    | 57/100 [02:52<02:58,  4.14s/it]Best trial: 31. Best value: 0.562497:  58%|█████▊    | 58/100 [02:52<02:39,  3.79s/it]Best trial: 31. Best value: 0.562497:  58%|█████▊    | 58/100 [02:54<02:39,  3.79s/it]Best trial: 31. Best value: 0.562497:  59%|█████▉    | 59/100 [02:54<02:20,  3.42s/it]Best trial: 31. Best value: 0.562497:  59%|█████▉    | 59/100 [02:57<02:20,  3.42s/it]Best trial: 31. Best value: 0.562497:  60%|██████    | 60/100 [02:57<02:07,  3.18s/it]Best trial: 31. Best value: 0.562497:  60%|██████    | 60/100 [02:59<02:07,  3.18s/it]Best trial: 31. Best value: 0.562497:  61%|██████    | 61/100 [02:59<01:52,  2.89s/it]Best trial: 31. Best value: 0.562497:  61%|██████    | 61/100 [03:02<01:52,  2.89s/it]Best trial: 31. Best value: 0.562497:  62%|██████▏   | 62/100 [03:02<01:53,  3.00s/it]Best trial: 31. Best value: 0.562497:  62%|██████▏   | 62/100 [03:06<01:53,  3.00s/it]Best trial: 31. Best value: 0.562497:  63%|██████▎   | 63/100 [03:06<01:52,  3.05s/it]Best trial: 31. Best value: 0.562497:  63%|██████▎   | 63/100 [03:09<01:52,  3.05s/it]Best trial: 31. Best value: 0.562497:  64%|██████▍   | 64/100 [03:09<01:52,  3.12s/it]Best trial: 31. Best value: 0.562497:  64%|██████▍   | 64/100 [03:12<01:52,  3.12s/it]Best trial: 31. Best value: 0.562497:  65%|██████▌   | 65/100 [03:12<01:51,  3.19s/it]Best trial: 31. Best value: 0.562497:  65%|██████▌   | 65/100 [03:15<01:51,  3.19s/it]Best trial: 31. Best value: 0.562497:  66%|██████▌   | 66/100 [03:15<01:43,  3.05s/it]Best trial: 31. Best value: 0.562497:  66%|██████▌   | 66/100 [03:18<01:43,  3.05s/it]Best trial: 31. Best value: 0.562497:  67%|██████▋   | 67/100 [03:18<01:38,  2.98s/it]Best trial: 31. Best value: 0.562497:  67%|██████▋   | 67/100 [03:20<01:38,  2.98s/it]Best trial: 31. Best value: 0.562497:  68%|██████▊   | 68/100 [03:20<01:28,  2.76s/it]Best trial: 31. Best value: 0.562497:  68%|██████▊   | 68/100 [03:23<01:28,  2.76s/it]Best trial: 31. Best value: 0.562497:  69%|██████▉   | 69/100 [03:23<01:24,  2.72s/it]Best trial: 31. Best value: 0.562497:  69%|██████▉   | 69/100 [03:27<01:24,  2.72s/it]Best trial: 31. Best value: 0.562497:  70%|███████   | 70/100 [03:27<01:37,  3.25s/it]Best trial: 31. Best value: 0.562497:  70%|███████   | 70/100 [03:30<01:37,  3.25s/it]Best trial: 31. Best value: 0.562497:  71%|███████   | 71/100 [03:30<01:31,  3.14s/it]Best trial: 31. Best value: 0.562497:  71%|███████   | 71/100 [03:34<01:31,  3.14s/it]Best trial: 31. Best value: 0.562497:  72%|███████▏  | 72/100 [03:34<01:33,  3.34s/it]Best trial: 31. Best value: 0.562497:  72%|███████▏  | 72/100 [03:37<01:33,  3.34s/it]Best trial: 31. Best value: 0.562497:  73%|███████▎  | 73/100 [03:37<01:25,  3.17s/it]Best trial: 73. Best value: 0.562953:  73%|███████▎  | 73/100 [03:40<01:25,  3.17s/it]Best trial: 73. Best value: 0.562953:  74%|███████▍  | 74/100 [03:40<01:20,  3.10s/it]Best trial: 73. Best value: 0.562953:  74%|███████▍  | 74/100 [03:42<01:20,  3.10s/it]Best trial: 73. Best value: 0.562953:  75%|███████▌  | 75/100 [03:42<01:13,  2.96s/it]Best trial: 73. Best value: 0.562953:  75%|███████▌  | 75/100 [03:44<01:13,  2.96s/it]Best trial: 73. Best value: 0.562953:  76%|███████▌  | 76/100 [03:44<01:04,  2.70s/it]Best trial: 73. Best value: 0.562953:  76%|███████▌  | 76/100 [03:47<01:04,  2.70s/it]Best trial: 73. Best value: 0.562953:  77%|███████▋  | 77/100 [03:47<00:59,  2.57s/it]Best trial: 73. Best value: 0.562953:  77%|███████▋  | 77/100 [03:49<00:59,  2.57s/it]Best trial: 73. Best value: 0.562953:  78%|███████▊  | 78/100 [03:49<00:58,  2.64s/it]Best trial: 73. Best value: 0.562953:  78%|███████▊  | 78/100 [03:52<00:58,  2.64s/it]Best trial: 73. Best value: 0.562953:  79%|███████▉  | 79/100 [03:52<00:55,  2.65s/it]Best trial: 73. Best value: 0.562953:  79%|███████▉  | 79/100 [03:55<00:55,  2.65s/it]Best trial: 73. Best value: 0.562953:  80%|████████  | 80/100 [03:55<00:51,  2.60s/it]Best trial: 73. Best value: 0.562953:  80%|████████  | 80/100 [03:57<00:51,  2.60s/it]Best trial: 73. Best value: 0.562953:  81%|████████  | 81/100 [03:57<00:48,  2.54s/it]Best trial: 73. Best value: 0.562953:  81%|████████  | 81/100 [04:01<00:48,  2.54s/it]Best trial: 73. Best value: 0.562953:  82%|████████▏ | 82/100 [04:01<00:54,  3.00s/it]Best trial: 73. Best value: 0.562953:  82%|████████▏ | 82/100 [04:04<00:54,  3.00s/it]Best trial: 73. Best value: 0.562953:  83%|████████▎ | 83/100 [04:04<00:52,  3.11s/it]Best trial: 73. Best value: 0.562953:  83%|████████▎ | 83/100 [04:08<00:52,  3.11s/it]Best trial: 73. Best value: 0.562953:  84%|████████▍ | 84/100 [04:08<00:51,  3.20s/it]Best trial: 73. Best value: 0.562953:  84%|████████▍ | 84/100 [04:12<00:51,  3.20s/it]Best trial: 73. Best value: 0.562953:  85%|████████▌ | 85/100 [04:12<00:53,  3.54s/it]Best trial: 73. Best value: 0.562953:  85%|████████▌ | 85/100 [04:15<00:53,  3.54s/it]Best trial: 73. Best value: 0.562953:  86%|████████▌ | 86/100 [04:15<00:48,  3.47s/it]Best trial: 73. Best value: 0.562953:  86%|████████▌ | 86/100 [04:18<00:48,  3.47s/it]Best trial: 73. Best value: 0.562953:  87%|████████▋ | 87/100 [04:18<00:42,  3.31s/it]  > HPO FAILED. Skipping training.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:40:40,883 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 06:40:40,883 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:40:40,969 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:40:40,977 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:40:40,979 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:40:40,979 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 4.1869
  0%|          | 0/100 [00:00<?, ?it/s]  > HPO FAILED. Skipping training.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
Starting Experiments...
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:43:23,220 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 06:43:23,220 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:43:23,300 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:43:23,318 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:43:23,322 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 06:43:23,322 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.528813:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.528813:   1%|          | 1/100 [00:03<06:10,  3.75s/it]Best trial: 1. Best value: 0.539459:   1%|          | 1/100 [00:05<06:10,  3.75s/it]Best trial: 1. Best value: 0.539459:   2%|▏         | 2/100 [00:05<04:15,  2.61s/it]Best trial: 1. Best value: 0.539459:   2%|▏         | 2/100 [00:06<04:15,  2.61s/it]Best trial: 1. Best value: 0.539459:   3%|▎         | 3/100 [00:06<03:13,  2.00s/it]Best trial: 3. Best value: 0.543075:   3%|▎         | 3/100 [00:09<03:13,  2.00s/it]Best trial: 3. Best value: 0.543075:   4%|▍         | 4/100 [00:09<03:40,  2.29s/it]Best trial: 3. Best value: 0.543075:   4%|▍         | 4/100 [00:10<03:40,  2.29s/it]Best trial: 3. Best value: 0.543075:   5%|▌         | 5/100 [00:10<02:58,  1.88s/it]Best trial: 3. Best value: 0.543075:   5%|▌         | 5/100 [00:13<02:58,  1.88s/it]Best trial: 3. Best value: 0.543075:   6%|▌         | 6/100 [00:13<03:28,  2.22s/it]Best trial: 3. Best value: 0.543075:   6%|▌         | 6/100 [00:15<03:28,  2.22s/it]Best trial: 3. Best value: 0.543075:   7%|▋         | 7/100 [00:15<03:13,  2.08s/it]Best trial: 3. Best value: 0.543075:   7%|▋         | 7/100 [00:19<03:13,  2.08s/it]Best trial: 3. Best value: 0.543075:   8%|▊         | 8/100 [00:19<04:04,  2.65s/it]Best trial: 3. Best value: 0.543075:   8%|▊         | 8/100 [00:21<04:04,  2.65s/it]Best trial: 3. Best value: 0.543075:   9%|▉         | 9/100 [00:21<03:57,  2.61s/it]Best trial: 3. Best value: 0.543075:   9%|▉         | 9/100 [00:24<03:57,  2.61s/it]Best trial: 3. Best value: 0.543075:  10%|█         | 10/100 [00:24<04:02,  2.70s/it]Best trial: 3. Best value: 0.543075:  10%|█         | 10/100 [00:27<04:02,  2.70s/it]Best trial: 3. Best value: 0.543075:  11%|█         | 11/100 [00:27<03:57,  2.67s/it]Best trial: 11. Best value: 0.550832:  11%|█         | 11/100 [00:30<03:57,  2.67s/it]Best trial: 11. Best value: 0.550832:  12%|█▏        | 12/100 [00:30<04:22,  2.98s/it]Best trial: 11. Best value: 0.550832:  12%|█▏        | 12/100 [00:34<04:22,  2.98s/it]Best trial: 11. Best value: 0.550832:  13%|█▎        | 13/100 [00:34<04:23,  3.03s/it]Best trial: 11. Best value: 0.550832:  13%|█▎        | 13/100 [00:36<04:23,  3.03s/it]Best trial: 11. Best value: 0.550832:  14%|█▍        | 14/100 [00:36<04:11,  2.92s/it]Best trial: 11. Best value: 0.550832:  14%|█▍        | 14/100 [00:40<04:11,  2.92s/it]Best trial: 11. Best value: 0.550832:  15%|█▌        | 15/100 [00:40<04:17,  3.03s/it]Best trial: 11. Best value: 0.550832:  15%|█▌        | 15/100 [00:43<04:17,  3.03s/it]Best trial: 11. Best value: 0.550832:  16%|█▌        | 16/100 [00:43<04:21,  3.11s/it]Best trial: 11. Best value: 0.550832:  16%|█▌        | 16/100 [00:46<04:21,  3.11s/it]Best trial: 11. Best value: 0.550832:  17%|█▋        | 17/100 [00:46<04:22,  3.16s/it]Best trial: 11. Best value: 0.550832:  17%|█▋        | 17/100 [00:49<04:22,  3.16s/it]Best trial: 11. Best value: 0.550832:  18%|█▊        | 18/100 [00:49<04:07,  3.02s/it]Best trial: 11. Best value: 0.550832:  18%|█▊        | 18/100 [00:51<04:07,  3.02s/it]Best trial: 11. Best value: 0.550832:  19%|█▉        | 19/100 [00:51<03:47,  2.80s/it]Best trial: 11. Best value: 0.550832:  19%|█▉        | 19/100 [00:55<03:47,  2.80s/it]Best trial: 11. Best value: 0.550832:  20%|██        | 20/100 [00:55<04:01,  3.02s/it]Best trial: 11. Best value: 0.550832:  20%|██        | 20/100 [00:58<04:01,  3.02s/it]Best trial: 11. Best value: 0.550832:  21%|██        | 21/100 [00:58<04:00,  3.05s/it]Best trial: 11. Best value: 0.550832:  21%|██        | 21/100 [01:01<04:00,  3.05s/it]Best trial: 11. Best value: 0.550832:  22%|██▏       | 22/100 [01:01<04:04,  3.13s/it]Best trial: 11. Best value: 0.550832:  22%|██▏       | 22/100 [01:05<04:04,  3.13s/it]Best trial: 11. Best value: 0.550832:  23%|██▎       | 23/100 [01:05<04:09,  3.24s/it]Best trial: 11. Best value: 0.550832:  23%|██▎       | 23/100 [01:08<04:09,  3.24s/it]Best trial: 11. Best value: 0.550832:  24%|██▍       | 24/100 [01:08<04:06,  3.24s/it]Best trial: 11. Best value: 0.550832:  24%|██▍       | 24/100 [01:11<04:06,  3.24s/it]Best trial: 11. Best value: 0.550832:  25%|██▌       | 25/100 [01:11<03:51,  3.09s/it]Best trial: 11. Best value: 0.550832:  25%|██▌       | 25/100 [01:13<03:51,  3.09s/it]Best trial: 11. Best value: 0.550832:  26%|██▌       | 26/100 [01:13<03:32,  2.87s/it]Best trial: 26. Best value: 0.556803:  26%|██▌       | 26/100 [01:16<03:32,  2.87s/it]Best trial: 26. Best value: 0.556803:  27%|██▋       | 27/100 [01:16<03:33,  2.93s/it]Best trial: 26. Best value: 0.556803:  27%|██▋       | 27/100 [01:19<03:33,  2.93s/it]Best trial: 26. Best value: 0.556803:  28%|██▊       | 28/100 [01:19<03:37,  3.02s/it]Best trial: 26. Best value: 0.556803:  28%|██▊       | 28/100 [01:22<03:37,  3.02s/it]Best trial: 26. Best value: 0.556803:  29%|██▉       | 29/100 [01:22<03:38,  3.07s/it]Best trial: 26. Best value: 0.556803:  29%|██▉       | 29/100 [01:27<03:38,  3.07s/it]Best trial: 26. Best value: 0.556803:  30%|███       | 30/100 [01:27<04:02,  3.47s/it]Best trial: 26. Best value: 0.556803:  30%|███       | 30/100 [01:30<04:02,  3.47s/it]Best trial: 26. Best value: 0.556803:  31%|███       | 31/100 [01:30<04:02,  3.52s/it]Best trial: 26. Best value: 0.556803:  31%|███       | 31/100 [01:34<04:02,  3.52s/it]Best trial: 26. Best value: 0.556803:  32%|███▏      | 32/100 [01:34<04:08,  3.66s/it]Best trial: 26. Best value: 0.556803:  32%|███▏      | 32/100 [01:38<04:08,  3.66s/it]Best trial: 26. Best value: 0.556803:  33%|███▎      | 33/100 [01:38<04:01,  3.61s/it]Best trial: 26. Best value: 0.556803:  33%|███▎      | 33/100 [01:41<04:01,  3.61s/it]Best trial: 26. Best value: 0.556803:  34%|███▍      | 34/100 [01:41<03:51,  3.51s/it]Best trial: 26. Best value: 0.556803:  34%|███▍      | 34/100 [01:44<03:51,  3.51s/it]Best trial: 26. Best value: 0.556803:  35%|███▌      | 35/100 [01:44<03:31,  3.25s/it]Best trial: 26. Best value: 0.556803:  35%|███▌      | 35/100 [01:47<03:31,  3.25s/it]Best trial: 26. Best value: 0.556803:  36%|███▌      | 36/100 [01:47<03:34,  3.36s/it]Best trial: 26. Best value: 0.556803:  36%|███▌      | 36/100 [01:50<03:34,  3.36s/it]Best trial: 26. Best value: 0.556803:  37%|███▋      | 37/100 [01:50<03:24,  3.24s/it]Best trial: 26. Best value: 0.556803:  37%|███▋      | 37/100 [01:53<03:24,  3.24s/it]Best trial: 26. Best value: 0.556803:  38%|███▊      | 38/100 [01:53<02:59,  2.90s/it]Best trial: 26. Best value: 0.556803:  38%|███▊      | 38/100 [01:55<02:59,  2.90s/it]Best trial: 26. Best value: 0.556803:  39%|███▉      | 39/100 [01:55<02:46,  2.73s/it]Best trial: 26. Best value: 0.556803:  39%|███▉      | 39/100 [01:57<02:46,  2.73s/it]Best trial: 26. Best value: 0.556803:  40%|████      | 40/100 [01:57<02:40,  2.68s/it]Best trial: 26. Best value: 0.556803:  40%|████      | 40/100 [02:01<02:40,  2.68s/it]Best trial: 26. Best value: 0.556803:  41%|████      | 41/100 [02:01<02:45,  2.80s/it]Best trial: 26. Best value: 0.556803:  41%|████      | 41/100 [02:04<02:45,  2.80s/it]Best trial: 26. Best value: 0.556803:  42%|████▏     | 42/100 [02:04<02:49,  2.92s/it]Best trial: 26. Best value: 0.556803:  42%|████▏     | 42/100 [02:06<02:49,  2.92s/it]Best trial: 26. Best value: 0.556803:  43%|████▎     | 43/100 [02:06<02:38,  2.79s/it]Best trial: 26. Best value: 0.556803:  43%|████▎     | 43/100 [02:11<02:38,  2.79s/it]Best trial: 26. Best value: 0.556803:  44%|████▍     | 44/100 [02:11<03:04,  3.29s/it]Best trial: 26. Best value: 0.556803:  44%|████▍     | 44/100 [02:15<03:04,  3.29s/it]Best trial: 26. Best value: 0.556803:  45%|████▌     | 45/100 [02:15<03:18,  3.61s/it]Best trial: 26. Best value: 0.556803:  45%|████▌     | 45/100 [02:17<03:18,  3.61s/it]Best trial: 26. Best value: 0.556803:  46%|████▌     | 46/100 [02:17<02:45,  3.06s/it]Best trial: 26. Best value: 0.556803:  46%|████▌     | 46/100 [02:19<02:45,  3.06s/it]Best trial: 26. Best value: 0.556803:  47%|████▋     | 47/100 [02:19<02:21,  2.67s/it]Best trial: 26. Best value: 0.556803:  47%|████▋     | 47/100 [02:20<02:21,  2.67s/it]Best trial: 26. Best value: 0.556803:  48%|████▊     | 48/100 [02:20<02:05,  2.41s/it]Best trial: 26. Best value: 0.556803:  48%|████▊     | 48/100 [02:23<02:05,  2.41s/it]Best trial: 26. Best value: 0.556803:  49%|████▉     | 49/100 [02:23<02:11,  2.57s/it]Best trial: 26. Best value: 0.556803:  49%|████▉     | 49/100 [02:27<02:11,  2.57s/it]Best trial: 26. Best value: 0.556803:  50%|█████     | 50/100 [02:27<02:19,  2.78s/it]Best trial: 26. Best value: 0.556803:  50%|█████     | 50/100 [02:28<02:19,  2.78s/it]Best trial: 26. Best value: 0.556803:  51%|█████     | 51/100 [02:28<02:01,  2.48s/it]Best trial: 26. Best value: 0.556803:  51%|█████     | 51/100 [02:30<02:01,  2.48s/it]Best trial: 26. Best value: 0.556803:  52%|█████▏    | 52/100 [02:30<01:52,  2.35s/it]Best trial: 26. Best value: 0.556803:  52%|█████▏    | 52/100 [02:32<01:52,  2.35s/it]Best trial: 26. Best value: 0.556803:  53%|█████▎    | 53/100 [02:32<01:43,  2.21s/it]Best trial: 26. Best value: 0.556803:  53%|█████▎    | 53/100 [02:34<01:43,  2.21s/it]Best trial: 26. Best value: 0.556803:  54%|█████▍    | 54/100 [02:34<01:35,  2.08s/it]Best trial: 26. Best value: 0.556803:  54%|█████▍    | 54/100 [02:36<01:35,  2.08s/it]Best trial: 26. Best value: 0.556803:  55%|█████▌    | 55/100 [02:36<01:38,  2.19s/it]Best trial: 26. Best value: 0.556803:  55%|█████▌    | 55/100 [02:39<01:38,  2.19s/it]Best trial: 26. Best value: 0.556803:  56%|█████▌    | 56/100 [02:39<01:39,  2.26s/it]Best trial: 26. Best value: 0.556803:  56%|█████▌    | 56/100 [02:42<01:39,  2.26s/it]Best trial: 26. Best value: 0.556803:  57%|█████▋    | 57/100 [02:42<01:48,  2.51s/it]Best trial: 26. Best value: 0.556803:  57%|█████▋    | 57/100 [02:44<01:48,  2.51s/it]Best trial: 26. Best value: 0.556803:  58%|█████▊    | 58/100 [02:44<01:39,  2.38s/it]Best trial: 26. Best value: 0.556803:  58%|█████▊    | 58/100 [02:46<01:39,  2.38s/it]Best trial: 26. Best value: 0.556803:  59%|█████▉    | 59/100 [02:46<01:26,  2.12s/it]Best trial: 26. Best value: 0.556803:  59%|█████▉    | 59/100 [02:48<01:26,  2.12s/it]Best trial: 26. Best value: 0.556803:  60%|██████    | 60/100 [02:48<01:33,  2.34s/it]Best trial: 26. Best value: 0.556803:  60%|██████    | 60/100 [02:53<01:33,  2.34s/it]Best trial: 26. Best value: 0.556803:  61%|██████    | 61/100 [02:53<01:57,  3.02s/it]Best trial: 26. Best value: 0.556803:  61%|██████    | 61/100 [02:58<01:57,  3.02s/it]Best trial: 26. Best value: 0.556803:  62%|██████▏   | 62/100 [02:58<02:13,  3.51s/it]Best trial: 26. Best value: 0.556803:  62%|██████▏   | 62/100 [03:01<02:13,  3.51s/it]Best trial: 26. Best value: 0.556803:  63%|██████▎   | 63/100 [03:01<02:04,  3.38s/it]Best trial: 26. Best value: 0.556803:  63%|██████▎   | 63/100 [03:04<02:04,  3.38s/it]Best trial: 26. Best value: 0.556803:  64%|██████▍   | 64/100 [03:04<02:00,  3.34s/it]Best trial: 26. Best value: 0.556803:  64%|██████▍   | 64/100 [03:07<02:00,  3.34s/it]Best trial: 26. Best value: 0.556803:  65%|██████▌   | 65/100 [03:07<01:57,  3.37s/it]Best trial: 26. Best value: 0.556803:  65%|██████▌   | 65/100 [03:10<01:57,  3.37s/it]Best trial: 26. Best value: 0.556803:  66%|██████▌   | 66/100 [03:10<01:43,  3.06s/it]Best trial: 26. Best value: 0.556803:  66%|██████▌   | 66/100 [03:12<01:43,  3.06s/it]Best trial: 26. Best value: 0.556803:  67%|██████▋   | 67/100 [03:12<01:34,  2.88s/it]Best trial: 26. Best value: 0.556803:  67%|██████▋   | 67/100 [03:16<01:34,  2.88s/it]Best trial: 26. Best value: 0.556803:  68%|██████▊   | 68/100 [03:16<01:37,  3.05s/it]Best trial: 26. Best value: 0.556803:  68%|██████▊   | 68/100 [03:19<01:37,  3.05s/it]Best trial: 26. Best value: 0.556803:  69%|██████▉   | 69/100 [03:19<01:37,  3.15s/it]Best trial: 26. Best value: 0.556803:  69%|██████▉   | 69/100 [03:24<01:37,  3.15s/it]Best trial: 26. Best value: 0.556803:  70%|███████   | 70/100 [03:24<01:47,  3.59s/it]Best trial: 26. Best value: 0.556803:  70%|███████   | 70/100 [03:26<01:47,  3.59s/it]Best trial: 26. Best value: 0.556803:  71%|███████   | 71/100 [03:26<01:31,  3.16s/it]Best trial: 26. Best value: 0.556803:  71%|███████   | 71/100 [03:30<01:31,  3.16s/it]Best trial: 26. Best value: 0.556803:  72%|███████▏  | 72/100 [03:30<01:38,  3.53s/it]Best trial: 26. Best value: 0.556803:  72%|███████▏  | 72/100 [03:34<01:38,  3.53s/it]Best trial: 26. Best value: 0.556803:  73%|███████▎  | 73/100 [03:34<01:38,  3.65s/it]Best trial: 26. Best value: 0.556803:  73%|███████▎  | 73/100 [03:39<01:38,  3.65s/it]Best trial: 26. Best value: 0.556803:  74%|███████▍  | 74/100 [03:39<01:46,  4.11s/it]Best trial: 26. Best value: 0.556803:  74%|███████▍  | 74/100 [03:42<01:46,  4.11s/it]Best trial: 26. Best value: 0.556803:  75%|███████▌  | 75/100 [03:42<01:28,  3.53s/it]Best trial: 26. Best value: 0.556803:  75%|███████▌  | 75/100 [03:44<01:28,  3.53s/it]Best trial: 26. Best value: 0.556803:  76%|███████▌  | 76/100 [03:44<01:14,  3.11s/it]Best trial: 26. Best value: 0.556803:  76%|███████▌  | 76/100 [03:46<01:14,  3.11s/it]Best trial: 26. Best value: 0.556803:  77%|███████▋  | 77/100 [03:46<01:07,  2.93s/it]Best trial: 26. Best value: 0.556803:  77%|███████▋  | 77/100 [03:49<01:07,  2.93s/it]Best trial: 26. Best value: 0.556803:  78%|███████▊  | 78/100 [03:49<01:02,  2.85s/it]Best trial: 78. Best value: 0.557646:  78%|███████▊  | 78/100 [03:53<01:02,  2.85s/it]Best trial: 78. Best value: 0.557646:  79%|███████▉  | 79/100 [03:53<01:10,  3.37s/it]Best trial: 78. Best value: 0.557646:  79%|███████▉  | 79/100 [03:56<01:10,  3.37s/it]Best trial: 78. Best value: 0.557646:  80%|████████  | 80/100 [03:56<01:03,  3.16s/it]Best trial: 78. Best value: 0.557646:  80%|████████  | 80/100 [03:59<01:03,  3.16s/it]Best trial: 78. Best value: 0.557646:  81%|████████  | 81/100 [03:59<00:57,  3.05s/it]Best trial: 78. Best value: 0.557646:  81%|████████  | 81/100 [04:02<00:57,  3.05s/it]Best trial: 78. Best value: 0.557646:  82%|████████▏ | 82/100 [04:02<00:57,  3.20s/it]Best trial: 78. Best value: 0.557646:  82%|████████▏ | 82/100 [04:05<00:57,  3.20s/it]Best trial: 78. Best value: 0.557646:  83%|████████▎ | 83/100 [04:05<00:50,  2.98s/it]Best trial: 78. Best value: 0.557646:  83%|████████▎ | 83/100 [04:09<00:50,  2.98s/it]Best trial: 78. Best value: 0.557646:  84%|████████▍ | 84/100 [04:09<00:51,  3.25s/it]Best trial: 78. Best value: 0.557646:  84%|████████▍ | 84/100 [04:13<00:51,  3.25s/it]Best trial: 78. Best value: 0.557646:  85%|████████▌ | 85/100 [04:13<00:53,  3.58s/it]Best trial: 78. Best value: 0.557646:  85%|████████▌ | 85/100 [04:17<00:53,  3.58s/it]Best trial: 78. Best value: 0.557646:  86%|████████▌ | 86/100 [04:17<00:50,  3.61s/it]Best trial: 86. Best value: 0.557747:  86%|████████▌ | 86/100 [04:19<00:50,  3.61s/it]Best trial: 86. Best value: 0.557747:  87%|████████▋ | 87/100 [04:19<00:40,  3.13s/it]Best trial: 86. Best value: 0.557747:  87%|████████▋ | 87/100 [04:20<00:40,  3.13s/it]Best trial: 86. Best value: 0.557747:  88%|████████▊ | 88/100 [04:20<00:30,  2.57s/it]Best trial: 86. Best value: 0.557747:  88%|████████▊ | 88/100 [04:22<00:30,  2.57s/it]Best trial: 86. Best value: 0.557747:  89%|████████▉ | 89/100 [04:22<00:26,  2.40s/it]Best trial: 86. Best value: 0.557747:  89%|████████▉ | 89/100 [04:24<00:26,  2.40s/it]Best trial: 86. Best value: 0.557747:  90%|█████████ | 90/100 [04:24<00:22,  2.26s/it]Best trial: 86. Best value: 0.557747:  90%|█████████ | 90/100 [04:27<00:22,  2.26s/it]Best trial: 86. Best value: 0.557747:  91%|█████████ | 91/100 [04:27<00:21,  2.43s/it]Best trial: 86. Best value: 0.557747:  91%|█████████ | 91/100 [04:29<00:21,  2.43s/it]Best trial: 86. Best value: 0.557747:  92%|█████████▏| 92/100 [04:29<00:19,  2.39s/it]Best trial: 92. Best value: 0.557866:  92%|█████████▏| 92/100 [04:31<00:19,  2.39s/it]Best trial: 92. Best value: 0.557866:  93%|█████████▎| 93/100 [04:31<00:16,  2.37s/it]Best trial: 92. Best value: 0.557866:  93%|█████████▎| 93/100 [04:33<00:16,  2.37s/it]Best trial: 92. Best value: 0.557866:  94%|█████████▍| 94/100 [04:33<00:13,  2.24s/it]Best trial: 92. Best value: 0.557866:  94%|█████████▍| 94/100 [04:36<00:13,  2.24s/it]Best trial: 92. Best value: 0.557866:  95%|█████████▌| 95/100 [04:36<00:11,  2.22s/it]Best trial: 92. Best value: 0.557866:  95%|█████████▌| 95/100 [04:38<00:11,  2.22s/it]Best trial: 92. Best value: 0.557866:  96%|█████████▌| 96/100 [04:38<00:08,  2.15s/it]Best trial: 92. Best value: 0.557866:  96%|█████████▌| 96/100 [04:40<00:08,  2.15s/it]Best trial: 92. Best value: 0.557866:  97%|█████████▋| 97/100 [04:40<00:06,  2.25s/it]Best trial: 92. Best value: 0.557866:  97%|█████████▋| 97/100 [04:42<00:06,  2.25s/it]Best trial: 92. Best value: 0.557866:  98%|█████████▊| 98/100 [04:42<00:04,  2.17s/it]Best trial: 92. Best value: 0.557866:  98%|█████████▊| 98/100 [04:44<00:04,  2.17s/it]Best trial: 92. Best value: 0.557866:  99%|█████████▉| 99/100 [04:44<00:02,  2.25s/it]Best trial: 92. Best value: 0.557866:  99%|█████████▉| 99/100 [04:47<00:02,  2.25s/it]Best trial: 92. Best value: 0.557866: 100%|██████████| 100/100 [04:47<00:00,  2.43s/it]Best trial: 92. Best value: 0.557866: 100%|██████████| 100/100 [04:47<00:00,  2.88s/it]
2025-11-30 06:48:11,157 - INFO - HPO Complete. Best AUPRC: 0.5579
2025-11-30 06:48:11,157 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.06423797852964291, 'max_depth': 3, 'subsample': 0.6376011662542743, 'colsample_bytree': 0.8713842745187579, 'gamma': 3.8079823422953836, 'reg_lambda': 3.3162862669022102e-06, 'reg_alpha': 0.012509882069554763}
2025-11-30 06:48:11,158 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 06:48:13,251 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 06:48:13,252 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:48:13,355 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:48:13,376 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:48:13,381 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 06:48:13,381 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 06:48:13,381 - INFO - Training model...
2025-11-30 06:48:14,050 - INFO - Evaluating model with bootstrapping...
2025-11-30 06:48:19,154 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 06:48:19,154 - INFO - AUROC: 0.8073 (0.7333 - 0.8588)
2025-11-30 06:48:19,154 - INFO - AUPRC: 0.3432 (0.1791 - 0.5071)
2025-11-30 06:48:19,154 - INFO - Brier Score: 0.0561 (0.0450 - 0.0710)
2025-11-30 06:48:19,154 - INFO - Accuracy: 0.9422 (0.9014 - 0.9673)
2025-11-30 06:48:19,154 - INFO - Precision: 0.4333 (0.2566 - 0.8444)
2025-11-30 06:48:19,154 - INFO - Sensitivity (Recall): 0.3611 (0.1801 - 0.5137)
2025-11-30 06:48:19,154 - INFO - F1-Score: 0.3939 (0.2452 - 0.5612)
2025-11-30 06:48:19,154 - INFO - Best Threshold: 0.5500 (0.3380 - 0.9000)
2025-11-30 06:48:19,154 - INFO - Specificity: 0.9741 (0.9207 - 0.9976)
2025-11-30 06:48:19,162 - INFO - Calculating SHAP values...
2025-11-30 06:48:20,244 - INFO - SHAP plots saved.
2025-11-30 06:48:20,245 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:48:21,570 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 06:48:21,570 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:48:21,655 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:48:21,663 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:48:21,665 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:48:21,665 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.123829:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.123829:   1%|          | 1/100 [00:02<03:32,  2.15s/it]Best trial: 0. Best value: 0.123829:   1%|          | 1/100 [00:02<03:32,  2.15s/it]Best trial: 0. Best value: 0.123829:   2%|▏         | 2/100 [00:02<02:08,  1.31s/it]Best trial: 0. Best value: 0.123829:   2%|▏         | 2/100 [00:04<02:08,  1.31s/it]Best trial: 0. Best value: 0.123829:   3%|▎         | 3/100 [00:04<02:13,  1.38s/it]Best trial: 0. Best value: 0.123829:   3%|▎         | 3/100 [00:06<02:13,  1.38s/it]Best trial: 0. Best value: 0.123829:   4%|▍         | 4/100 [00:06<02:42,  1.70s/it]Best trial: 0. Best value: 0.123829:   4%|▍         | 4/100 [00:07<02:42,  1.70s/it]Best trial: 0. Best value: 0.123829:   5%|▌         | 5/100 [00:07<02:28,  1.56s/it]Best trial: 0. Best value: 0.123829:   5%|▌         | 5/100 [00:11<02:28,  1.56s/it]Best trial: 0. Best value: 0.123829:   6%|▌         | 6/100 [00:11<03:37,  2.32s/it]Best trial: 0. Best value: 0.123829:   6%|▌         | 6/100 [00:12<03:37,  2.32s/it]Best trial: 0. Best value: 0.123829:   7%|▋         | 7/100 [00:12<03:04,  1.98s/it]Best trial: 0. Best value: 0.123829:   7%|▋         | 7/100 [00:15<03:04,  1.98s/it]Best trial: 0. Best value: 0.123829:   8%|▊         | 8/100 [00:15<03:15,  2.13s/it]Best trial: 0. Best value: 0.123829:   8%|▊         | 8/100 [00:17<03:15,  2.13s/it]Best trial: 0. Best value: 0.123829:   9%|▉         | 9/100 [00:17<03:16,  2.16s/it]Best trial: 0. Best value: 0.123829:   9%|▉         | 9/100 [00:19<03:16,  2.16s/it]Best trial: 0. Best value: 0.123829:  10%|█         | 10/100 [00:19<03:18,  2.20s/it]Best trial: 0. Best value: 0.123829:  10%|█         | 10/100 [00:22<03:18,  2.20s/it]Best trial: 0. Best value: 0.123829:  11%|█         | 11/100 [00:22<03:35,  2.42s/it]Best trial: 0. Best value: 0.123829:  11%|█         | 11/100 [00:25<03:35,  2.42s/it]Best trial: 0. Best value: 0.123829:  12%|█▏        | 12/100 [00:25<03:37,  2.47s/it]Best trial: 0. Best value: 0.123829:  12%|█▏        | 12/100 [00:28<03:37,  2.47s/it]Best trial: 0. Best value: 0.123829:  13%|█▎        | 13/100 [00:28<03:57,  2.73s/it]Best trial: 0. Best value: 0.123829:  13%|█▎        | 13/100 [00:30<03:57,  2.73s/it]Best trial: 0. Best value: 0.123829:  14%|█▍        | 14/100 [00:30<03:41,  2.58s/it]Best trial: 0. Best value: 0.123829:  14%|█▍        | 14/100 [00:33<03:41,  2.58s/it]Best trial: 0. Best value: 0.123829:  15%|█▌        | 15/100 [00:33<03:37,  2.56s/it]Best trial: 0. Best value: 0.123829:  15%|█▌        | 15/100 [00:36<03:37,  2.56s/it]Best trial: 0. Best value: 0.123829:  16%|█▌        | 16/100 [00:36<03:36,  2.57s/it]Best trial: 0. Best value: 0.123829:  16%|█▌        | 16/100 [00:37<03:36,  2.57s/it]Best trial: 0. Best value: 0.123829:  17%|█▋        | 17/100 [00:37<03:16,  2.36s/it]Best trial: 0. Best value: 0.123829:  17%|█▋        | 17/100 [00:38<03:16,  2.36s/it]Best trial: 0. Best value: 0.123829:  18%|█▊        | 18/100 [00:38<02:39,  1.94s/it]Best trial: 0. Best value: 0.123829:  18%|█▊        | 18/100 [00:40<02:39,  1.94s/it]Best trial: 0. Best value: 0.123829:  19%|█▉        | 19/100 [00:40<02:40,  1.98s/it]Best trial: 0. Best value: 0.123829:  19%|█▉        | 19/100 [00:42<02:40,  1.98s/it]Best trial: 0. Best value: 0.123829:  20%|██        | 20/100 [00:42<02:34,  1.93s/it]Best trial: 0. Best value: 0.123829:  20%|██        | 20/100 [00:44<02:34,  1.93s/it]Best trial: 0. Best value: 0.123829:  21%|██        | 21/100 [00:44<02:38,  2.01s/it]Best trial: 0. Best value: 0.123829:  21%|██        | 21/100 [00:47<02:38,  2.01s/it]Best trial: 0. Best value: 0.123829:  22%|██▏       | 22/100 [00:47<02:50,  2.18s/it]Best trial: 0. Best value: 0.123829:  22%|██▏       | 22/100 [00:50<02:50,  2.18s/it]Best trial: 0. Best value: 0.123829:  23%|██▎       | 23/100 [00:50<03:04,  2.40s/it]Best trial: 0. Best value: 0.123829:  23%|██▎       | 23/100 [00:53<03:04,  2.40s/it]Best trial: 0. Best value: 0.123829:  24%|██▍       | 24/100 [00:53<03:10,  2.51s/it]Best trial: 0. Best value: 0.123829:  24%|██▍       | 24/100 [00:54<03:10,  2.51s/it]Best trial: 0. Best value: 0.123829:  25%|██▌       | 25/100 [00:54<02:43,  2.18s/it]Best trial: 0. Best value: 0.123829:  25%|██▌       | 25/100 [00:57<02:43,  2.18s/it]Best trial: 0. Best value: 0.123829:  26%|██▌       | 26/100 [00:57<02:54,  2.35s/it]Best trial: 0. Best value: 0.123829:  26%|██▌       | 26/100 [00:59<02:54,  2.35s/it]Best trial: 0. Best value: 0.123829:  27%|██▋       | 27/100 [00:59<02:50,  2.34s/it]Best trial: 0. Best value: 0.123829:  27%|██▋       | 27/100 [01:01<02:50,  2.34s/it]Best trial: 0. Best value: 0.123829:  28%|██▊       | 28/100 [01:01<02:41,  2.24s/it]Best trial: 28. Best value: 0.126088:  28%|██▊       | 28/100 [01:03<02:41,  2.24s/it]Best trial: 28. Best value: 0.126088:  29%|██▉       | 29/100 [01:03<02:32,  2.15s/it]Best trial: 28. Best value: 0.126088:  29%|██▉       | 29/100 [01:04<02:32,  2.15s/it]Best trial: 28. Best value: 0.126088:  30%|███       | 30/100 [01:04<01:59,  1.71s/it]Best trial: 28. Best value: 0.126088:  30%|███       | 30/100 [01:05<01:59,  1.71s/it]Best trial: 28. Best value: 0.126088:  31%|███       | 31/100 [01:05<01:37,  1.42s/it]Best trial: 28. Best value: 0.126088:  31%|███       | 31/100 [01:05<01:37,  1.42s/it]Best trial: 28. Best value: 0.126088:  32%|███▏      | 32/100 [01:05<01:25,  1.25s/it]Best trial: 28. Best value: 0.126088:  32%|███▏      | 32/100 [01:07<01:25,  1.25s/it]Best trial: 28. Best value: 0.126088:  33%|███▎      | 33/100 [01:07<01:21,  1.21s/it]Best trial: 28. Best value: 0.126088:  33%|███▎      | 33/100 [01:07<01:21,  1.21s/it]Best trial: 28. Best value: 0.126088:  34%|███▍      | 34/100 [01:07<01:13,  1.11s/it]Best trial: 28. Best value: 0.126088:  34%|███▍      | 34/100 [01:09<01:13,  1.11s/it]Best trial: 28. Best value: 0.126088:  35%|███▌      | 35/100 [01:09<01:13,  1.13s/it]Best trial: 28. Best value: 0.126088:  35%|███▌      | 35/100 [01:10<01:13,  1.13s/it]Best trial: 28. Best value: 0.126088:  36%|███▌      | 36/100 [01:10<01:12,  1.14s/it]Best trial: 28. Best value: 0.126088:  36%|███▌      | 36/100 [01:11<01:12,  1.14s/it]Best trial: 28. Best value: 0.126088:  37%|███▋      | 37/100 [01:11<01:13,  1.17s/it]Best trial: 28. Best value: 0.126088:  37%|███▋      | 37/100 [01:12<01:13,  1.17s/it]Best trial: 28. Best value: 0.126088:  38%|███▊      | 38/100 [01:12<01:05,  1.06s/it]Best trial: 28. Best value: 0.126088:  38%|███▊      | 38/100 [01:13<01:05,  1.06s/it]Best trial: 28. Best value: 0.126088:  39%|███▉      | 39/100 [01:13<01:04,  1.05s/it]Best trial: 28. Best value: 0.126088:  39%|███▉      | 39/100 [01:14<01:04,  1.05s/it]Best trial: 28. Best value: 0.126088:  40%|████      | 40/100 [01:14<01:07,  1.12s/it]Best trial: 28. Best value: 0.126088:  40%|████      | 40/100 [01:16<01:07,  1.12s/it]Best trial: 28. Best value: 0.126088:  41%|████      | 41/100 [01:16<01:17,  1.31s/it]Best trial: 28. Best value: 0.126088:  41%|████      | 41/100 [01:17<01:17,  1.31s/it]Best trial: 28. Best value: 0.126088:  42%|████▏     | 42/100 [01:17<01:06,  1.15s/it]Best trial: 28. Best value: 0.126088:  42%|████▏     | 42/100 [01:18<01:06,  1.15s/it]Best trial: 28. Best value: 0.126088:  43%|████▎     | 43/100 [01:18<01:13,  1.29s/it]Best trial: 28. Best value: 0.126088:  43%|████▎     | 43/100 [01:19<01:13,  1.29s/it]Best trial: 28. Best value: 0.126088:  44%|████▍     | 44/100 [01:19<01:11,  1.27s/it]Best trial: 28. Best value: 0.126088:  44%|████▍     | 44/100 [01:20<01:11,  1.27s/it]Best trial: 28. Best value: 0.126088:  45%|████▌     | 45/100 [01:20<01:04,  1.18s/it]Best trial: 45. Best value: 0.126128:  45%|████▌     | 45/100 [01:21<01:04,  1.18s/it]Best trial: 45. Best value: 0.126128:  46%|████▌     | 46/100 [01:21<00:57,  1.06s/it]Best trial: 45. Best value: 0.126128:  46%|████▌     | 46/100 [01:22<00:57,  1.06s/it]Best trial: 45. Best value: 0.126128:  47%|████▋     | 47/100 [01:22<00:54,  1.02s/it]Best trial: 45. Best value: 0.126128:  47%|████▋     | 47/100 [01:24<00:54,  1.02s/it]Best trial: 45. Best value: 0.126128:  48%|████▊     | 48/100 [01:24<01:00,  1.16s/it]Best trial: 48. Best value: 0.129982:  48%|████▊     | 48/100 [01:24<01:00,  1.16s/it]Best trial: 48. Best value: 0.129982:  49%|████▉     | 49/100 [01:24<00:53,  1.05s/it]Best trial: 48. Best value: 0.129982:  49%|████▉     | 49/100 [01:25<00:53,  1.05s/it]Best trial: 48. Best value: 0.129982:  50%|█████     | 50/100 [01:25<00:48,  1.04it/s]Best trial: 50. Best value: 0.13146:  50%|█████     | 50/100 [01:26<00:48,  1.04it/s] Best trial: 50. Best value: 0.13146:  51%|█████     | 51/100 [01:26<00:50,  1.03s/it]Best trial: 50. Best value: 0.13146:  51%|█████     | 51/100 [01:27<00:50,  1.03s/it]Best trial: 50. Best value: 0.13146:  52%|█████▏    | 52/100 [01:27<00:47,  1.00it/s]Best trial: 50. Best value: 0.13146:  52%|█████▏    | 52/100 [01:28<00:47,  1.00it/s]Best trial: 50. Best value: 0.13146:  53%|█████▎    | 53/100 [01:28<00:42,  1.11it/s]Best trial: 50. Best value: 0.13146:  53%|█████▎    | 53/100 [01:29<00:42,  1.11it/s]Best trial: 50. Best value: 0.13146:  54%|█████▍    | 54/100 [01:29<00:42,  1.09it/s]Best trial: 50. Best value: 0.13146:  54%|█████▍    | 54/100 [01:30<00:42,  1.09it/s]Best trial: 50. Best value: 0.13146:  55%|█████▌    | 55/100 [01:30<00:39,  1.15it/s]Best trial: 50. Best value: 0.13146:  55%|█████▌    | 55/100 [01:30<00:39,  1.15it/s]Best trial: 50. Best value: 0.13146:  56%|█████▌    | 56/100 [01:30<00:35,  1.25it/s]Best trial: 50. Best value: 0.13146:  56%|█████▌    | 56/100 [01:32<00:35,  1.25it/s]Best trial: 50. Best value: 0.13146:  57%|█████▋    | 57/100 [01:32<00:43,  1.01s/it]Best trial: 50. Best value: 0.13146:  57%|█████▋    | 57/100 [01:33<00:43,  1.01s/it]Best trial: 50. Best value: 0.13146:  58%|█████▊    | 58/100 [01:33<00:39,  1.06it/s]Best trial: 50. Best value: 0.13146:  58%|█████▊    | 58/100 [01:35<00:39,  1.06it/s]Best trial: 50. Best value: 0.13146:  59%|█████▉    | 59/100 [01:35<00:51,  1.25s/it]Best trial: 50. Best value: 0.13146:  59%|█████▉    | 59/100 [01:35<00:51,  1.25s/it]Best trial: 50. Best value: 0.13146:  60%|██████    | 60/100 [01:35<00:43,  1.09s/it]Best trial: 50. Best value: 0.13146:  60%|██████    | 60/100 [01:36<00:43,  1.09s/it]Best trial: 50. Best value: 0.13146:  61%|██████    | 61/100 [01:36<00:41,  1.06s/it]Best trial: 50. Best value: 0.13146:  61%|██████    | 61/100 [01:37<00:41,  1.06s/it]Best trial: 50. Best value: 0.13146:  62%|██████▏   | 62/100 [01:37<00:39,  1.03s/it]Best trial: 50. Best value: 0.13146:  62%|██████▏   | 62/100 [01:38<00:39,  1.03s/it]Best trial: 50. Best value: 0.13146:  63%|██████▎   | 63/100 [01:38<00:37,  1.03s/it]Best trial: 50. Best value: 0.13146:  63%|██████▎   | 63/100 [01:39<00:37,  1.03s/it]Best trial: 50. Best value: 0.13146:  64%|██████▍   | 64/100 [01:39<00:33,  1.08it/s]Best trial: 64. Best value: 0.135714:  64%|██████▍   | 64/100 [01:40<00:33,  1.08it/s]Best trial: 64. Best value: 0.135714:  65%|██████▌   | 65/100 [01:40<00:32,  1.07it/s]Best trial: 64. Best value: 0.135714:  65%|██████▌   | 65/100 [01:41<00:32,  1.07it/s]Best trial: 64. Best value: 0.135714:  66%|██████▌   | 66/100 [01:41<00:30,  1.13it/s]Best trial: 64. Best value: 0.135714:  66%|██████▌   | 66/100 [01:42<00:30,  1.13it/s]Best trial: 64. Best value: 0.135714:  67%|██████▋   | 67/100 [01:42<00:29,  1.12it/s]Best trial: 64. Best value: 0.135714:  67%|██████▋   | 67/100 [01:42<00:29,  1.12it/s]Best trial: 64. Best value: 0.135714:  68%|██████▊   | 68/100 [01:42<00:26,  1.21it/s]Best trial: 64. Best value: 0.135714:  68%|██████▊   | 68/100 [01:43<00:26,  1.21it/s]Best trial: 64. Best value: 0.135714:  69%|██████▉   | 69/100 [01:43<00:25,  1.19it/s]Best trial: 64. Best value: 0.135714:  69%|██████▉   | 69/100 [01:45<00:25,  1.19it/s]Best trial: 64. Best value: 0.135714:  70%|███████   | 70/100 [01:45<00:32,  1.09s/it]Best trial: 64. Best value: 0.135714:  70%|███████   | 70/100 [01:46<00:32,  1.09s/it]Best trial: 64. Best value: 0.135714:  71%|███████   | 71/100 [01:46<00:30,  1.04s/it]Best trial: 64. Best value: 0.135714:  71%|███████   | 71/100 [01:47<00:30,  1.04s/it]Best trial: 64. Best value: 0.135714:  72%|███████▏  | 72/100 [01:47<00:30,  1.10s/it]Best trial: 64. Best value: 0.135714:  72%|███████▏  | 72/100 [01:48<00:30,  1.10s/it]Best trial: 64. Best value: 0.135714:  73%|███████▎  | 73/100 [01:48<00:29,  1.11s/it]Best trial: 64. Best value: 0.135714:  73%|███████▎  | 73/100 [01:50<00:29,  1.11s/it]Best trial: 64. Best value: 0.135714:  74%|███████▍  | 74/100 [01:50<00:33,  1.28s/it]Best trial: 64. Best value: 0.135714:  74%|███████▍  | 74/100 [01:52<00:33,  1.28s/it]Best trial: 64. Best value: 0.135714:  75%|███████▌  | 75/100 [01:52<00:38,  1.53s/it]Best trial: 64. Best value: 0.135714:  75%|███████▌  | 75/100 [01:52<00:38,  1.53s/it]Best trial: 64. Best value: 0.135714:  76%|███████▌  | 76/100 [01:52<00:29,  1.24s/it]Best trial: 64. Best value: 0.135714:  76%|███████▌  | 76/100 [01:54<00:29,  1.24s/it]Best trial: 64. Best value: 0.135714:  77%|███████▋  | 77/100 [01:54<00:29,  1.30s/it]Best trial: 64. Best value: 0.135714:  77%|███████▋  | 77/100 [01:55<00:29,  1.30s/it]Best trial: 64. Best value: 0.135714:  78%|███████▊  | 78/100 [01:55<00:28,  1.31s/it]Best trial: 64. Best value: 0.135714:  78%|███████▊  | 78/100 [01:57<00:28,  1.31s/it]Best trial: 64. Best value: 0.135714:  79%|███████▉  | 79/100 [01:57<00:27,  1.31s/it]Best trial: 64. Best value: 0.135714:  79%|███████▉  | 79/100 [01:58<00:27,  1.31s/it]Best trial: 64. Best value: 0.135714:  80%|████████  | 80/100 [01:58<00:25,  1.30s/it]Best trial: 64. Best value: 0.135714:  80%|████████  | 80/100 [01:59<00:25,  1.30s/it]Best trial: 64. Best value: 0.135714:  81%|████████  | 81/100 [01:59<00:22,  1.17s/it]Best trial: 64. Best value: 0.135714:  81%|████████  | 81/100 [02:00<00:22,  1.17s/it]Best trial: 64. Best value: 0.135714:  82%|████████▏ | 82/100 [02:00<00:20,  1.12s/it]Best trial: 64. Best value: 0.135714:  82%|████████▏ | 82/100 [02:01<00:20,  1.12s/it]Best trial: 64. Best value: 0.135714:  83%|████████▎ | 83/100 [02:01<00:18,  1.08s/it]Best trial: 64. Best value: 0.135714:  83%|████████▎ | 83/100 [02:01<00:18,  1.08s/it]Best trial: 64. Best value: 0.135714:  84%|████████▍ | 84/100 [02:01<00:15,  1.04it/s]Best trial: 64. Best value: 0.135714:  84%|████████▍ | 84/100 [02:02<00:15,  1.04it/s]Best trial: 64. Best value: 0.135714:  85%|████████▌ | 85/100 [02:02<00:13,  1.10it/s]Best trial: 64. Best value: 0.135714:  85%|████████▌ | 85/100 [02:03<00:13,  1.10it/s]Best trial: 64. Best value: 0.135714:  86%|████████▌ | 86/100 [02:03<00:13,  1.05it/s]Best trial: 64. Best value: 0.135714:  86%|████████▌ | 86/100 [02:04<00:13,  1.05it/s]Best trial: 64. Best value: 0.135714:  87%|████████▋ | 87/100 [02:04<00:12,  1.07it/s]Best trial: 64. Best value: 0.135714:  87%|████████▋ | 87/100 [02:05<00:12,  1.07it/s]Best trial: 64. Best value: 0.135714:  88%|████████▊ | 88/100 [02:05<00:10,  1.16it/s]Best trial: 64. Best value: 0.135714:  88%|████████▊ | 88/100 [02:05<00:10,  1.16it/s]Best trial: 64. Best value: 0.135714:  89%|████████▉ | 89/100 [02:05<00:08,  1.26it/s]Best trial: 64. Best value: 0.135714:  89%|████████▉ | 89/100 [02:06<00:08,  1.26it/s]Best trial: 64. Best value: 0.135714:  90%|█████████ | 90/100 [02:06<00:08,  1.23it/s]Best trial: 64. Best value: 0.135714:  90%|█████████ | 90/100 [02:07<00:08,  1.23it/s]Best trial: 64. Best value: 0.135714:  91%|█████████ | 91/100 [02:07<00:07,  1.21it/s]Best trial: 64. Best value: 0.135714:  91%|█████████ | 91/100 [02:08<00:07,  1.21it/s]Best trial: 64. Best value: 0.135714:  92%|█████████▏| 92/100 [02:08<00:06,  1.27it/s]Best trial: 64. Best value: 0.135714:  92%|█████████▏| 92/100 [02:09<00:06,  1.27it/s]Best trial: 64. Best value: 0.135714:  93%|█████████▎| 93/100 [02:09<00:05,  1.26it/s]Best trial: 64. Best value: 0.135714:  93%|█████████▎| 93/100 [02:09<00:05,  1.26it/s]Best trial: 64. Best value: 0.135714:  94%|█████████▍| 94/100 [02:09<00:04,  1.34it/s]Best trial: 64. Best value: 0.135714:  94%|█████████▍| 94/100 [02:10<00:04,  1.34it/s]Best trial: 64. Best value: 0.135714:  95%|█████████▌| 95/100 [02:10<00:03,  1.39it/s]Best trial: 64. Best value: 0.135714:  95%|█████████▌| 95/100 [02:11<00:03,  1.39it/s]Best trial: 64. Best value: 0.135714:  96%|█████████▌| 96/100 [02:11<00:02,  1.38it/s]Best trial: 64. Best value: 0.135714:  96%|█████████▌| 96/100 [02:11<00:02,  1.38it/s]Best trial: 64. Best value: 0.135714:  97%|█████████▋| 97/100 [02:11<00:02,  1.42it/s]Best trial: 64. Best value: 0.135714:  97%|█████████▋| 97/100 [02:12<00:02,  1.42it/s]Best trial: 64. Best value: 0.135714:  98%|█████████▊| 98/100 [02:12<00:01,  1.43it/s]Best trial: 64. Best value: 0.135714:  98%|█████████▊| 98/100 [02:13<00:01,  1.43it/s]Best trial: 64. Best value: 0.135714:  99%|█████████▉| 99/100 [02:13<00:00,  1.27it/s]Best trial: 64. Best value: 0.135714:  99%|█████████▉| 99/100 [02:14<00:00,  1.27it/s]Best trial: 64. Best value: 0.135714: 100%|██████████| 100/100 [02:14<00:00,  1.36it/s]Best trial: 64. Best value: 0.135714: 100%|██████████| 100/100 [02:14<00:00,  1.34s/it]
2025-11-30 06:50:35,810 - INFO - HPO Complete. Best AUPRC: 0.1357
2025-11-30 06:50:35,811 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.00013215905089188112, 'max_depth': 3, 'subsample': 0.620814732497203, 'colsample_bytree': 0.7708030092276753, 'gamma': 0.455630293133325, 'reg_lambda': 0.9395746026514036, 'reg_alpha': 4.829585689634234e-05}
2025-11-30 06:50:35,811 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 06:50:37,913 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 06:50:37,913 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:50:38,009 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:50:38,018 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:50:38,020 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:50:38,020 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 06:50:38,020 - INFO - Training model...
2025-11-30 06:50:39,024 - INFO - Evaluating model with bootstrapping...
2025-11-30 06:50:43,840 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 06:50:43,840 - INFO - AUROC: 0.6500 (0.5445 - 0.6857)
2025-11-30 06:50:43,840 - INFO - AUPRC: 0.0865 (0.0527 - 0.1192)
2025-11-30 06:50:43,840 - INFO - Brier Score: 0.2453 (0.2451 - 0.2457)
2025-11-30 06:50:43,840 - INFO - Accuracy: 0.8497 (0.1272 - 0.8639)
2025-11-30 06:50:43,840 - INFO - Precision: 0.0952 (0.0394 - 0.1577)
2025-11-30 06:50:43,840 - INFO - Sensitivity (Recall): 0.2222 (0.1736 - 1.0000)
2025-11-30 06:50:43,840 - INFO - F1-Score: 0.1333 (0.0757 - 0.2149)
2025-11-30 06:50:43,840 - INFO - Best Threshold: 0.5000 (0.4900 - 0.5000)
2025-11-30 06:50:43,840 - INFO - Specificity: 0.8841 (0.0931 - 0.8977)
2025-11-30 06:50:43,855 - INFO - Calculating SHAP values...
2025-11-30 06:50:45,040 - INFO - SHAP plots saved.
2025-11-30 06:50:45,042 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:50:46,678 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 06:50:46,678 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:50:46,770 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:50:46,778 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:50:46,780 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:50:46,780 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.107852:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.107852:   1%|          | 1/100 [00:01<02:38,  1.60s/it]Best trial: 0. Best value: 0.107852:   1%|          | 1/100 [00:03<02:38,  1.60s/it]Best trial: 0. Best value: 0.107852:   2%|▏         | 2/100 [00:03<02:35,  1.58s/it]Best trial: 0. Best value: 0.107852:   2%|▏         | 2/100 [00:04<02:35,  1.58s/it]Best trial: 0. Best value: 0.107852:   3%|▎         | 3/100 [00:04<02:16,  1.41s/it]Best trial: 0. Best value: 0.107852:   3%|▎         | 3/100 [00:06<02:16,  1.41s/it]Best trial: 0. Best value: 0.107852:   4%|▍         | 4/100 [00:06<02:28,  1.54s/it]Best trial: 0. Best value: 0.107852:   4%|▍         | 4/100 [00:07<02:28,  1.54s/it]Best trial: 0. Best value: 0.107852:   5%|▌         | 5/100 [00:07<02:19,  1.47s/it]Best trial: 0. Best value: 0.107852:   5%|▌         | 5/100 [00:08<02:19,  1.47s/it]Best trial: 0. Best value: 0.107852:   6%|▌         | 6/100 [00:08<02:17,  1.47s/it]Best trial: 0. Best value: 0.107852:   6%|▌         | 6/100 [00:10<02:17,  1.47s/it]Best trial: 0. Best value: 0.107852:   7%|▋         | 7/100 [00:10<02:07,  1.37s/it]Best trial: 0. Best value: 0.107852:   7%|▋         | 7/100 [00:12<02:07,  1.37s/it]Best trial: 0. Best value: 0.107852:   8%|▊         | 8/100 [00:12<02:27,  1.61s/it]Best trial: 0. Best value: 0.107852:   8%|▊         | 8/100 [00:14<02:27,  1.61s/it]Best trial: 0. Best value: 0.107852:   9%|▉         | 9/100 [00:14<02:45,  1.82s/it]Best trial: 0. Best value: 0.107852:   9%|▉         | 9/100 [00:18<02:45,  1.82s/it]Best trial: 0. Best value: 0.107852:  10%|█         | 10/100 [00:18<03:45,  2.51s/it]Best trial: 0. Best value: 0.107852:  10%|█         | 10/100 [00:20<03:45,  2.51s/it]Best trial: 0. Best value: 0.107852:  11%|█         | 11/100 [00:20<03:26,  2.31s/it]Best trial: 0. Best value: 0.107852:  11%|█         | 11/100 [00:21<03:26,  2.31s/it]Best trial: 0. Best value: 0.107852:  12%|█▏        | 12/100 [00:21<02:54,  1.98s/it]Best trial: 0. Best value: 0.107852:  12%|█▏        | 12/100 [00:23<02:54,  1.98s/it]Best trial: 0. Best value: 0.107852:  13%|█▎        | 13/100 [00:23<02:37,  1.81s/it]Best trial: 0. Best value: 0.107852:  13%|█▎        | 13/100 [00:24<02:37,  1.81s/it]Best trial: 0. Best value: 0.107852:  14%|█▍        | 14/100 [00:24<02:33,  1.78s/it]Best trial: 0. Best value: 0.107852:  14%|█▍        | 14/100 [00:25<02:33,  1.78s/it]Best trial: 0. Best value: 0.107852:  15%|█▌        | 15/100 [00:25<02:12,  1.56s/it]Best trial: 0. Best value: 0.107852:  15%|█▌        | 15/100 [00:27<02:12,  1.56s/it]Best trial: 0. Best value: 0.107852:  16%|█▌        | 16/100 [00:27<02:20,  1.67s/it]Best trial: 0. Best value: 0.107852:  16%|█▌        | 16/100 [00:29<02:20,  1.67s/it]Best trial: 0. Best value: 0.107852:  17%|█▋        | 17/100 [00:29<02:13,  1.61s/it]Best trial: 0. Best value: 0.107852:  17%|█▋        | 17/100 [00:30<02:13,  1.61s/it]Best trial: 0. Best value: 0.107852:  18%|█▊        | 18/100 [00:30<02:15,  1.65s/it]Best trial: 0. Best value: 0.107852:  18%|█▊        | 18/100 [00:32<02:15,  1.65s/it]Best trial: 0. Best value: 0.107852:  19%|█▉        | 19/100 [00:32<02:02,  1.51s/it]Best trial: 0. Best value: 0.107852:  19%|█▉        | 19/100 [00:34<02:02,  1.51s/it]Best trial: 0. Best value: 0.107852:  20%|██        | 20/100 [00:34<02:13,  1.67s/it]Best trial: 0. Best value: 0.107852:  20%|██        | 20/100 [00:35<02:13,  1.67s/it]Best trial: 0. Best value: 0.107852:  21%|██        | 21/100 [00:35<02:03,  1.56s/it]Best trial: 0. Best value: 0.107852:  21%|██        | 21/100 [00:36<02:03,  1.56s/it]Best trial: 0. Best value: 0.107852:  22%|██▏       | 22/100 [00:36<01:59,  1.53s/it]Best trial: 0. Best value: 0.107852:  22%|██▏       | 22/100 [00:38<01:59,  1.53s/it]Best trial: 0. Best value: 0.107852:  23%|██▎       | 23/100 [00:38<01:53,  1.48s/it]Best trial: 0. Best value: 0.107852:  23%|██▎       | 23/100 [00:40<01:53,  1.48s/it]Best trial: 0. Best value: 0.107852:  24%|██▍       | 24/100 [00:40<01:58,  1.56s/it]Best trial: 0. Best value: 0.107852:  24%|██▍       | 24/100 [00:41<01:58,  1.56s/it]Best trial: 0. Best value: 0.107852:  25%|██▌       | 25/100 [00:41<02:04,  1.66s/it]Best trial: 0. Best value: 0.107852:  25%|██▌       | 25/100 [00:43<02:04,  1.66s/it]Best trial: 0. Best value: 0.107852:  26%|██▌       | 26/100 [00:43<02:02,  1.66s/it]Best trial: 0. Best value: 0.107852:  26%|██▌       | 26/100 [00:45<02:02,  1.66s/it]Best trial: 0. Best value: 0.107852:  27%|██▋       | 27/100 [00:45<02:04,  1.71s/it]Best trial: 0. Best value: 0.107852:  27%|██▋       | 27/100 [00:46<02:04,  1.71s/it]Best trial: 0. Best value: 0.107852:  28%|██▊       | 28/100 [00:46<01:52,  1.56s/it]Best trial: 0. Best value: 0.107852:  28%|██▊       | 28/100 [00:48<01:52,  1.56s/it]Best trial: 0. Best value: 0.107852:  29%|██▉       | 29/100 [00:48<01:58,  1.67s/it]Best trial: 0. Best value: 0.107852:  29%|██▉       | 29/100 [00:49<01:58,  1.67s/it]Best trial: 0. Best value: 0.107852:  30%|███       | 30/100 [00:49<01:46,  1.53s/it]Best trial: 0. Best value: 0.107852:  30%|███       | 30/100 [00:51<01:46,  1.53s/it]Best trial: 0. Best value: 0.107852:  31%|███       | 31/100 [00:51<01:52,  1.62s/it]Best trial: 0. Best value: 0.107852:  31%|███       | 31/100 [00:53<01:52,  1.62s/it]Best trial: 0. Best value: 0.107852:  32%|███▏      | 32/100 [00:53<02:02,  1.81s/it]Best trial: 0. Best value: 0.107852:  32%|███▏      | 32/100 [00:55<02:02,  1.81s/it]Best trial: 0. Best value: 0.107852:  33%|███▎      | 33/100 [00:55<01:57,  1.75s/it]Best trial: 0. Best value: 0.107852:  33%|███▎      | 33/100 [00:57<01:57,  1.75s/it]Best trial: 0. Best value: 0.107852:  34%|███▍      | 34/100 [00:57<02:03,  1.87s/it]Best trial: 0. Best value: 0.107852:  34%|███▍      | 34/100 [00:59<02:03,  1.87s/it]Best trial: 0. Best value: 0.107852:  35%|███▌      | 35/100 [00:59<01:58,  1.83s/it]Best trial: 0. Best value: 0.107852:  35%|███▌      | 35/100 [01:00<01:58,  1.83s/it]Best trial: 0. Best value: 0.107852:  36%|███▌      | 36/100 [01:00<01:48,  1.70s/it]Best trial: 0. Best value: 0.107852:  36%|███▌      | 36/100 [01:01<01:48,  1.70s/it]Best trial: 0. Best value: 0.107852:  37%|███▋      | 37/100 [01:01<01:37,  1.54s/it]Best trial: 0. Best value: 0.107852:  37%|███▋      | 37/100 [01:04<01:37,  1.54s/it]Best trial: 0. Best value: 0.107852:  38%|███▊      | 38/100 [01:04<01:49,  1.77s/it]Best trial: 0. Best value: 0.107852:  38%|███▊      | 38/100 [01:06<01:49,  1.77s/it]Best trial: 0. Best value: 0.107852:  39%|███▉      | 39/100 [01:06<01:57,  1.93s/it]Best trial: 0. Best value: 0.107852:  39%|███▉      | 39/100 [01:08<01:57,  1.93s/it]Best trial: 0. Best value: 0.107852:  40%|████      | 40/100 [01:08<01:56,  1.94s/it]Best trial: 0. Best value: 0.107852:  40%|████      | 40/100 [01:10<01:56,  1.94s/it]Best trial: 0. Best value: 0.107852:  41%|████      | 41/100 [01:10<01:49,  1.85s/it]Best trial: 0. Best value: 0.107852:  41%|████      | 41/100 [01:12<01:49,  1.85s/it]Best trial: 0. Best value: 0.107852:  42%|████▏     | 42/100 [01:12<01:58,  2.04s/it]Best trial: 0. Best value: 0.107852:  42%|████▏     | 42/100 [01:14<01:58,  2.04s/it]Best trial: 0. Best value: 0.107852:  43%|████▎     | 43/100 [01:14<02:00,  2.12s/it]Best trial: 0. Best value: 0.107852:  43%|████▎     | 43/100 [01:17<02:00,  2.12s/it]Best trial: 0. Best value: 0.107852:  44%|████▍     | 44/100 [01:17<02:10,  2.34s/it]Best trial: 0. Best value: 0.107852:  44%|████▍     | 44/100 [01:21<02:10,  2.34s/it]Best trial: 0. Best value: 0.107852:  45%|████▌     | 45/100 [01:21<02:31,  2.75s/it]Best trial: 0. Best value: 0.107852:  45%|████▌     | 45/100 [01:23<02:31,  2.75s/it]Best trial: 0. Best value: 0.107852:  46%|████▌     | 46/100 [01:23<02:10,  2.42s/it]Best trial: 0. Best value: 0.107852:  46%|████▌     | 46/100 [01:24<02:10,  2.42s/it]Best trial: 0. Best value: 0.107852:  47%|████▋     | 47/100 [01:24<01:59,  2.25s/it]Best trial: 0. Best value: 0.107852:  47%|████▋     | 47/100 [01:25<01:59,  2.25s/it]Best trial: 0. Best value: 0.107852:  48%|████▊     | 48/100 [01:25<01:37,  1.87s/it]Best trial: 0. Best value: 0.107852:  48%|████▊     | 48/100 [01:27<01:37,  1.87s/it]Best trial: 0. Best value: 0.107852:  49%|████▉     | 49/100 [01:27<01:28,  1.73s/it]Best trial: 0. Best value: 0.107852:  49%|████▉     | 49/100 [01:29<01:28,  1.73s/it]Best trial: 0. Best value: 0.107852:  50%|█████     | 50/100 [01:29<01:31,  1.83s/it]Best trial: 0. Best value: 0.107852:  50%|█████     | 50/100 [01:32<01:31,  1.83s/it]Best trial: 0. Best value: 0.107852:  51%|█████     | 51/100 [01:32<01:43,  2.11s/it]Best trial: 0. Best value: 0.107852:  51%|█████     | 51/100 [01:34<01:43,  2.11s/it]Best trial: 0. Best value: 0.107852:  52%|█████▏    | 52/100 [01:34<01:41,  2.12s/it]Best trial: 0. Best value: 0.107852:  52%|█████▏    | 52/100 [01:35<01:41,  2.12s/it]Best trial: 0. Best value: 0.107852:  53%|█████▎    | 53/100 [01:35<01:26,  1.83s/it]Best trial: 0. Best value: 0.107852:  53%|█████▎    | 53/100 [01:37<01:26,  1.83s/it]Best trial: 0. Best value: 0.107852:  54%|█████▍    | 54/100 [01:37<01:24,  1.84s/it]Best trial: 0. Best value: 0.107852:  54%|█████▍    | 54/100 [01:38<01:24,  1.84s/it]Best trial: 0. Best value: 0.107852:  55%|█████▌    | 55/100 [01:38<01:19,  1.78s/it]Best trial: 0. Best value: 0.107852:  55%|█████▌    | 55/100 [01:41<01:19,  1.78s/it]Best trial: 0. Best value: 0.107852:  56%|█████▌    | 56/100 [01:41<01:25,  1.95s/it]Best trial: 0. Best value: 0.107852:  56%|█████▌    | 56/100 [01:43<01:25,  1.95s/it]Best trial: 0. Best value: 0.107852:  57%|█████▋    | 57/100 [01:43<01:23,  1.95s/it]Best trial: 0. Best value: 0.107852:  57%|█████▋    | 57/100 [01:44<01:23,  1.95s/it]Best trial: 0. Best value: 0.107852:  58%|█████▊    | 58/100 [01:44<01:12,  1.72s/it]Best trial: 0. Best value: 0.107852:  58%|█████▊    | 58/100 [01:45<01:12,  1.72s/it]Best trial: 0. Best value: 0.107852:  59%|█████▉    | 59/100 [01:45<01:05,  1.60s/it]Best trial: 0. Best value: 0.107852:  59%|█████▉    | 59/100 [01:47<01:05,  1.60s/it]Best trial: 0. Best value: 0.107852:  60%|██████    | 60/100 [01:47<01:07,  1.69s/it]Best trial: 0. Best value: 0.107852:  60%|██████    | 60/100 [01:49<01:07,  1.69s/it]Best trial: 0. Best value: 0.107852:  61%|██████    | 61/100 [01:49<01:06,  1.71s/it]Best trial: 0. Best value: 0.107852:  61%|██████    | 61/100 [01:51<01:06,  1.71s/it]Best trial: 0. Best value: 0.107852:  62%|██████▏   | 62/100 [01:51<01:06,  1.76s/it]Best trial: 0. Best value: 0.107852:  62%|██████▏   | 62/100 [01:52<01:06,  1.76s/it]Best trial: 0. Best value: 0.107852:  63%|██████▎   | 63/100 [01:52<01:02,  1.69s/it]Best trial: 0. Best value: 0.107852:  63%|██████▎   | 63/100 [01:54<01:02,  1.69s/it]Best trial: 0. Best value: 0.107852:  64%|██████▍   | 64/100 [01:54<01:04,  1.80s/it]Best trial: 0. Best value: 0.107852:  64%|██████▍   | 64/100 [01:55<01:04,  1.80s/it]Best trial: 0. Best value: 0.107852:  65%|██████▌   | 65/100 [01:55<00:55,  1.58s/it]Best trial: 0. Best value: 0.107852:  65%|██████▌   | 65/100 [01:57<00:55,  1.58s/it]Best trial: 0. Best value: 0.107852:  66%|██████▌   | 66/100 [01:57<00:48,  1.43s/it]Best trial: 0. Best value: 0.107852:  66%|██████▌   | 66/100 [01:58<00:48,  1.43s/it]Best trial: 0. Best value: 0.107852:  67%|██████▋   | 67/100 [01:58<00:44,  1.34s/it]Best trial: 0. Best value: 0.107852:  67%|██████▋   | 67/100 [01:59<00:44,  1.34s/it]Best trial: 0. Best value: 0.107852:  68%|██████▊   | 68/100 [01:59<00:44,  1.38s/it]Best trial: 0. Best value: 0.107852:  68%|██████▊   | 68/100 [02:00<00:44,  1.38s/it]Best trial: 0. Best value: 0.107852:  69%|██████▉   | 69/100 [02:00<00:40,  1.30s/it]Best trial: 0. Best value: 0.107852:  69%|██████▉   | 69/100 [02:01<00:40,  1.30s/it]Best trial: 0. Best value: 0.107852:  70%|███████   | 70/100 [02:01<00:35,  1.19s/it]Best trial: 0. Best value: 0.107852:  70%|███████   | 70/100 [02:03<00:35,  1.19s/it]Best trial: 0. Best value: 0.107852:  71%|███████   | 71/100 [02:03<00:39,  1.35s/it]Best trial: 0. Best value: 0.107852:  71%|███████   | 71/100 [02:05<00:39,  1.35s/it]Best trial: 0. Best value: 0.107852:  72%|███████▏  | 72/100 [02:05<00:40,  1.45s/it]Best trial: 0. Best value: 0.107852:  72%|███████▏  | 72/100 [02:06<00:40,  1.45s/it]Best trial: 0. Best value: 0.107852:  73%|███████▎  | 73/100 [02:06<00:35,  1.33s/it]Best trial: 0. Best value: 0.107852:  73%|███████▎  | 73/100 [02:07<00:35,  1.33s/it]Best trial: 0. Best value: 0.107852:  74%|███████▍  | 74/100 [02:07<00:31,  1.21s/it]Best trial: 0. Best value: 0.107852:  74%|███████▍  | 74/100 [02:07<00:31,  1.21s/it]Best trial: 0. Best value: 0.107852:  75%|███████▌  | 75/100 [02:07<00:26,  1.07s/it]Best trial: 0. Best value: 0.107852:  75%|███████▌  | 75/100 [02:08<00:26,  1.07s/it]Best trial: 0. Best value: 0.107852:  76%|███████▌  | 76/100 [02:08<00:23,  1.04it/s]Best trial: 0. Best value: 0.107852:  76%|███████▌  | 76/100 [02:09<00:23,  1.04it/s]Best trial: 0. Best value: 0.107852:  77%|███████▋  | 77/100 [02:09<00:19,  1.19it/s]Best trial: 0. Best value: 0.107852:  77%|███████▋  | 77/100 [02:09<00:19,  1.19it/s]Best trial: 0. Best value: 0.107852:  78%|███████▊  | 78/100 [02:09<00:17,  1.24it/s]Best trial: 0. Best value: 0.107852:  78%|███████▊  | 78/100 [02:10<00:17,  1.24it/s]Best trial: 0. Best value: 0.107852:  79%|███████▉  | 79/100 [02:10<00:18,  1.16it/s]Best trial: 0. Best value: 0.107852:  79%|███████▉  | 79/100 [02:11<00:18,  1.16it/s]Best trial: 0. Best value: 0.107852:  80%|████████  | 80/100 [02:11<00:16,  1.18it/s]Best trial: 0. Best value: 0.107852:  80%|████████  | 80/100 [02:12<00:16,  1.18it/s]Best trial: 0. Best value: 0.107852:  81%|████████  | 81/100 [02:12<00:17,  1.09it/s]Best trial: 0. Best value: 0.107852:  81%|████████  | 81/100 [02:13<00:17,  1.09it/s]Best trial: 0. Best value: 0.107852:  82%|████████▏ | 82/100 [02:13<00:15,  1.14it/s]Best trial: 0. Best value: 0.107852:  82%|████████▏ | 82/100 [02:14<00:15,  1.14it/s]Best trial: 0. Best value: 0.107852:  83%|████████▎ | 83/100 [02:14<00:13,  1.22it/s]Best trial: 0. Best value: 0.107852:  83%|████████▎ | 83/100 [02:15<00:13,  1.22it/s]Best trial: 0. Best value: 0.107852:  84%|████████▍ | 84/100 [02:15<00:15,  1.02it/s]Best trial: 0. Best value: 0.107852:  84%|████████▍ | 84/100 [02:16<00:15,  1.02it/s]Best trial: 0. Best value: 0.107852:  85%|████████▌ | 85/100 [02:16<00:14,  1.02it/s]Best trial: 0. Best value: 0.107852:  85%|████████▌ | 85/100 [02:17<00:14,  1.02it/s]Best trial: 0. Best value: 0.107852:  86%|████████▌ | 86/100 [02:17<00:13,  1.03it/s]Best trial: 0. Best value: 0.107852:  86%|████████▌ | 86/100 [02:18<00:13,  1.03it/s]Best trial: 0. Best value: 0.107852:  87%|████████▋ | 87/100 [02:18<00:11,  1.09it/s]Best trial: 0. Best value: 0.107852:  87%|████████▋ | 87/100 [02:19<00:11,  1.09it/s]Best trial: 0. Best value: 0.107852:  88%|████████▊ | 88/100 [02:19<00:11,  1.04it/s]Best trial: 0. Best value: 0.107852:  88%|████████▊ | 88/100 [02:20<00:11,  1.04it/s]Best trial: 0. Best value: 0.107852:  89%|████████▉ | 89/100 [02:20<00:09,  1.11it/s]Best trial: 0. Best value: 0.107852:  89%|████████▉ | 89/100 [02:20<00:09,  1.11it/s]Best trial: 0. Best value: 0.107852:  90%|█████████ | 90/100 [02:20<00:08,  1.17it/s]Best trial: 0. Best value: 0.107852:  90%|█████████ | 90/100 [02:21<00:08,  1.17it/s]Best trial: 0. Best value: 0.107852:  91%|█████████ | 91/100 [02:21<00:07,  1.13it/s]Best trial: 0. Best value: 0.107852:  91%|█████████ | 91/100 [02:22<00:07,  1.13it/s]Best trial: 0. Best value: 0.107852:  92%|█████████▏| 92/100 [02:22<00:06,  1.17it/s]Best trial: 0. Best value: 0.107852:  92%|█████████▏| 92/100 [02:23<00:06,  1.17it/s]Best trial: 0. Best value: 0.107852:  93%|█████████▎| 93/100 [02:23<00:06,  1.07it/s]Best trial: 0. Best value: 0.107852:  93%|█████████▎| 93/100 [02:24<00:06,  1.07it/s]Best trial: 0. Best value: 0.107852:  94%|█████████▍| 94/100 [02:24<00:05,  1.11it/s]Best trial: 0. Best value: 0.107852:  94%|█████████▍| 94/100 [02:25<00:05,  1.11it/s]Best trial: 0. Best value: 0.107852:  95%|█████████▌| 95/100 [02:25<00:04,  1.05it/s]Best trial: 0. Best value: 0.107852:  95%|█████████▌| 95/100 [02:26<00:04,  1.05it/s]Best trial: 0. Best value: 0.107852:  96%|█████████▌| 96/100 [02:26<00:04,  1.05s/it]Best trial: 96. Best value: 0.109133:  96%|█████████▌| 96/100 [02:27<00:04,  1.05s/it]Best trial: 96. Best value: 0.109133:  97%|█████████▋| 97/100 [02:27<00:03,  1.05s/it]Best trial: 96. Best value: 0.109133:  97%|█████████▋| 97/100 [02:28<00:03,  1.05s/it]Best trial: 96. Best value: 0.109133:  98%|█████████▊| 98/100 [02:28<00:02,  1.00s/it]Best trial: 96. Best value: 0.109133:  98%|█████████▊| 98/100 [02:30<00:02,  1.00s/it]Best trial: 96. Best value: 0.109133:  99%|█████████▉| 99/100 [02:30<00:01,  1.09s/it]Best trial: 96. Best value: 0.109133:  99%|█████████▉| 99/100 [02:31<00:01,  1.09s/it]Best trial: 96. Best value: 0.109133: 100%|██████████| 100/100 [02:31<00:00,  1.29s/it]Best trial: 96. Best value: 0.109133: 100%|██████████| 100/100 [02:31<00:00,  1.52s/it]
2025-11-30 06:53:18,639 - INFO - HPO Complete. Best AUPRC: 0.1091
2025-11-30 06:53:18,639 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.00041791711279028207, 'max_depth': 3, 'subsample': 0.7440104129787113, 'colsample_bytree': 0.8994807856403353, 'gamma': 2.6570243513431158, 'reg_lambda': 0.08410021522449047, 'reg_alpha': 1.521543651982029e-07}
2025-11-30 06:53:18,640 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 06:53:20,837 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 06:53:20,838 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:53:20,934 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:53:20,943 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:53:20,945 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:53:20,945 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 06:53:20,945 - INFO - Training model...
2025-11-30 06:53:22,880 - INFO - Evaluating model with bootstrapping...
2025-11-30 06:53:27,624 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 06:53:27,624 - INFO - AUROC: 0.5829 (0.4794 - 0.6381)
2025-11-30 06:53:27,624 - INFO - AUPRC: 0.0662 (0.0426 - 0.0884)
2025-11-30 06:53:27,624 - INFO - Brier Score: 0.2291 (0.2270 - 0.2303)
2025-11-30 06:53:27,624 - INFO - Accuracy: 0.4668 (0.3347 - 0.8757)
2025-11-30 06:53:27,624 - INFO - Precision: 0.0698 (0.0525 - 0.1171)
2025-11-30 06:53:27,624 - INFO - Sensitivity (Recall): 0.7500 (0.2195 - 0.8746)
2025-11-30 06:53:27,624 - INFO - F1-Score: 0.1277 (0.0983 - 0.1768)
2025-11-30 06:53:27,624 - INFO - Best Threshold: 0.4700 (0.4580 - 0.5100)
2025-11-30 06:53:27,624 - INFO - Specificity: 0.4512 (0.3071 - 0.9082)
2025-11-30 06:53:27,645 - INFO - Calculating SHAP values...
2025-11-30 06:53:28,866 - INFO - SHAP plots saved.
2025-11-30 06:53:28,870 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:53:30,383 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 06:53:30,383 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:53:30,473 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:53:30,481 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:53:30,483 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:53:30,484 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.154436:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.154436:   1%|          | 1/100 [00:01<02:40,  1.62s/it]Best trial: 0. Best value: 0.154436:   1%|          | 1/100 [00:02<02:40,  1.62s/it]Best trial: 0. Best value: 0.154436:   2%|▏         | 2/100 [00:02<02:16,  1.39s/it]Best trial: 0. Best value: 0.154436:   2%|▏         | 2/100 [00:04<02:16,  1.39s/it]Best trial: 0. Best value: 0.154436:   3%|▎         | 3/100 [00:04<02:04,  1.28s/it]Best trial: 0. Best value: 0.154436:   3%|▎         | 3/100 [00:07<02:04,  1.28s/it]Best trial: 0. Best value: 0.154436:   4%|▍         | 4/100 [00:07<03:09,  1.97s/it]Best trial: 0. Best value: 0.154436:   4%|▍         | 4/100 [00:08<03:09,  1.97s/it]Best trial: 0. Best value: 0.154436:   5%|▌         | 5/100 [00:08<02:42,  1.71s/it]Best trial: 5. Best value: 0.15983:   5%|▌         | 5/100 [00:11<02:42,  1.71s/it] Best trial: 5. Best value: 0.15983:   6%|▌         | 6/100 [00:11<03:13,  2.06s/it]Best trial: 6. Best value: 0.170876:   6%|▌         | 6/100 [00:12<03:13,  2.06s/it]Best trial: 6. Best value: 0.170876:   7%|▋         | 7/100 [00:12<03:08,  2.03s/it]Best trial: 6. Best value: 0.170876:   7%|▋         | 7/100 [00:14<03:08,  2.03s/it]Best trial: 6. Best value: 0.170876:   8%|▊         | 8/100 [00:14<02:52,  1.87s/it]Best trial: 6. Best value: 0.170876:   8%|▊         | 8/100 [00:17<02:52,  1.87s/it]Best trial: 6. Best value: 0.170876:   9%|▉         | 9/100 [00:17<03:26,  2.27s/it]Best trial: 6. Best value: 0.170876:   9%|▉         | 9/100 [00:19<03:26,  2.27s/it]Best trial: 6. Best value: 0.170876:  10%|█         | 10/100 [00:19<02:59,  1.99s/it]Best trial: 6. Best value: 0.170876:  10%|█         | 10/100 [00:20<02:59,  1.99s/it]Best trial: 6. Best value: 0.170876:  11%|█         | 11/100 [00:20<02:37,  1.77s/it]Best trial: 6. Best value: 0.170876:  11%|█         | 11/100 [00:23<02:37,  1.77s/it]Best trial: 6. Best value: 0.170876:  12%|█▏        | 12/100 [00:23<03:03,  2.09s/it]Best trial: 6. Best value: 0.170876:  12%|█▏        | 12/100 [00:24<03:03,  2.09s/it]Best trial: 6. Best value: 0.170876:  13%|█▎        | 13/100 [00:24<02:50,  1.96s/it]Best trial: 6. Best value: 0.170876:  13%|█▎        | 13/100 [00:26<02:50,  1.96s/it]Best trial: 6. Best value: 0.170876:  14%|█▍        | 14/100 [00:26<02:49,  1.97s/it]Best trial: 6. Best value: 0.170876:  14%|█▍        | 14/100 [00:29<02:49,  1.97s/it]Best trial: 6. Best value: 0.170876:  15%|█▌        | 15/100 [00:29<02:58,  2.10s/it]Best trial: 6. Best value: 0.170876:  15%|█▌        | 15/100 [00:31<02:58,  2.10s/it]Best trial: 6. Best value: 0.170876:  16%|█▌        | 16/100 [00:31<02:52,  2.05s/it]Best trial: 6. Best value: 0.170876:  16%|█▌        | 16/100 [00:33<02:52,  2.05s/it]Best trial: 6. Best value: 0.170876:  17%|█▋        | 17/100 [00:33<03:02,  2.20s/it]Best trial: 6. Best value: 0.170876:  17%|█▋        | 17/100 [00:35<03:02,  2.20s/it]Best trial: 6. Best value: 0.170876:  18%|█▊        | 18/100 [00:35<02:53,  2.12s/it]Best trial: 6. Best value: 0.170876:  18%|█▊        | 18/100 [00:37<02:53,  2.12s/it]Best trial: 6. Best value: 0.170876:  19%|█▉        | 19/100 [00:37<02:34,  1.90s/it]Best trial: 6. Best value: 0.170876:  19%|█▉        | 19/100 [00:39<02:34,  1.90s/it]Best trial: 6. Best value: 0.170876:  20%|██        | 20/100 [00:39<02:35,  1.94s/it]Best trial: 6. Best value: 0.170876:  20%|██        | 20/100 [00:40<02:35,  1.94s/it]Best trial: 6. Best value: 0.170876:  21%|██        | 21/100 [00:40<02:16,  1.72s/it]Best trial: 6. Best value: 0.170876:  21%|██        | 21/100 [00:42<02:16,  1.72s/it]Best trial: 6. Best value: 0.170876:  22%|██▏       | 22/100 [00:42<02:22,  1.82s/it]Best trial: 6. Best value: 0.170876:  22%|██▏       | 22/100 [00:43<02:22,  1.82s/it]Best trial: 6. Best value: 0.170876:  23%|██▎       | 23/100 [00:43<02:02,  1.59s/it]Best trial: 23. Best value: 0.178133:  23%|██▎       | 23/100 [00:44<02:02,  1.59s/it]Best trial: 23. Best value: 0.178133:  24%|██▍       | 24/100 [00:44<01:47,  1.41s/it]Best trial: 23. Best value: 0.178133:  24%|██▍       | 24/100 [00:45<01:47,  1.41s/it]Best trial: 23. Best value: 0.178133:  25%|██▌       | 25/100 [00:45<01:44,  1.40s/it]Best trial: 23. Best value: 0.178133:  25%|██▌       | 25/100 [00:46<01:44,  1.40s/it]Best trial: 23. Best value: 0.178133:  26%|██▌       | 26/100 [00:46<01:31,  1.24s/it]Best trial: 23. Best value: 0.178133:  26%|██▌       | 26/100 [00:48<01:31,  1.24s/it]Best trial: 23. Best value: 0.178133:  27%|██▋       | 27/100 [00:48<01:53,  1.55s/it]Best trial: 23. Best value: 0.178133:  27%|██▋       | 27/100 [00:50<01:53,  1.55s/it]Best trial: 23. Best value: 0.178133:  28%|██▊       | 28/100 [00:50<01:49,  1.52s/it]Best trial: 23. Best value: 0.178133:  28%|██▊       | 28/100 [00:52<01:49,  1.52s/it]Best trial: 23. Best value: 0.178133:  29%|██▉       | 29/100 [00:52<01:53,  1.60s/it]Best trial: 23. Best value: 0.178133:  29%|██▉       | 29/100 [00:53<01:53,  1.60s/it]Best trial: 23. Best value: 0.178133:  30%|███       | 30/100 [00:53<01:45,  1.51s/it]Best trial: 23. Best value: 0.178133:  30%|███       | 30/100 [00:54<01:45,  1.51s/it]Best trial: 23. Best value: 0.178133:  31%|███       | 31/100 [00:54<01:37,  1.41s/it]Best trial: 23. Best value: 0.178133:  31%|███       | 31/100 [00:55<01:37,  1.41s/it]Best trial: 23. Best value: 0.178133:  32%|███▏      | 32/100 [00:55<01:25,  1.26s/it]Best trial: 23. Best value: 0.178133:  32%|███▏      | 32/100 [00:56<01:25,  1.26s/it]Best trial: 23. Best value: 0.178133:  33%|███▎      | 33/100 [00:56<01:14,  1.12s/it]Best trial: 23. Best value: 0.178133:  33%|███▎      | 33/100 [00:57<01:14,  1.12s/it]Best trial: 23. Best value: 0.178133:  34%|███▍      | 34/100 [00:57<01:20,  1.21s/it]Best trial: 23. Best value: 0.178133:  34%|███▍      | 34/100 [00:58<01:20,  1.21s/it]Best trial: 23. Best value: 0.178133:  35%|███▌      | 35/100 [00:58<01:15,  1.17s/it]Best trial: 23. Best value: 0.178133:  35%|███▌      | 35/100 [01:00<01:15,  1.17s/it]Best trial: 23. Best value: 0.178133:  36%|███▌      | 36/100 [01:00<01:18,  1.23s/it]Best trial: 23. Best value: 0.178133:  36%|███▌      | 36/100 [01:01<01:18,  1.23s/it]Best trial: 23. Best value: 0.178133:  37%|███▋      | 37/100 [01:01<01:14,  1.18s/it]Best trial: 23. Best value: 0.178133:  37%|███▋      | 37/100 [01:02<01:14,  1.18s/it]Best trial: 23. Best value: 0.178133:  38%|███▊      | 38/100 [01:02<01:23,  1.34s/it]Best trial: 23. Best value: 0.178133:  38%|███▊      | 38/100 [01:04<01:23,  1.34s/it]Best trial: 23. Best value: 0.178133:  39%|███▉      | 39/100 [01:04<01:21,  1.33s/it]Best trial: 23. Best value: 0.178133:  39%|███▉      | 39/100 [01:05<01:21,  1.33s/it]Best trial: 23. Best value: 0.178133:  40%|████      | 40/100 [01:05<01:24,  1.41s/it]Best trial: 23. Best value: 0.178133:  40%|████      | 40/100 [01:07<01:24,  1.41s/it]Best trial: 23. Best value: 0.178133:  41%|████      | 41/100 [01:07<01:26,  1.47s/it]Best trial: 23. Best value: 0.178133:  41%|████      | 41/100 [01:08<01:26,  1.47s/it]Best trial: 23. Best value: 0.178133:  42%|████▏     | 42/100 [01:08<01:23,  1.45s/it]Best trial: 23. Best value: 0.178133:  42%|████▏     | 42/100 [01:10<01:23,  1.45s/it]Best trial: 23. Best value: 0.178133:  43%|████▎     | 43/100 [01:10<01:25,  1.49s/it]Best trial: 23. Best value: 0.178133:  43%|████▎     | 43/100 [01:11<01:25,  1.49s/it]Best trial: 23. Best value: 0.178133:  44%|████▍     | 44/100 [01:11<01:19,  1.42s/it]Best trial: 23. Best value: 0.178133:  44%|████▍     | 44/100 [01:12<01:19,  1.42s/it]Best trial: 23. Best value: 0.178133:  45%|████▌     | 45/100 [01:12<01:10,  1.28s/it]Best trial: 23. Best value: 0.178133:  45%|████▌     | 45/100 [01:14<01:10,  1.28s/it]Best trial: 23. Best value: 0.178133:  46%|████▌     | 46/100 [01:14<01:10,  1.31s/it]Best trial: 23. Best value: 0.178133:  46%|████▌     | 46/100 [01:15<01:10,  1.31s/it]Best trial: 23. Best value: 0.178133:  47%|████▋     | 47/100 [01:15<01:07,  1.27s/it]Best trial: 23. Best value: 0.178133:  47%|████▋     | 47/100 [01:16<01:07,  1.27s/it]Best trial: 23. Best value: 0.178133:  48%|████▊     | 48/100 [01:16<01:07,  1.30s/it]Best trial: 23. Best value: 0.178133:  48%|████▊     | 48/100 [01:19<01:07,  1.30s/it]Best trial: 23. Best value: 0.178133:  49%|████▉     | 49/100 [01:19<01:25,  1.68s/it]Best trial: 23. Best value: 0.178133:  49%|████▉     | 49/100 [01:19<01:25,  1.68s/it]Best trial: 23. Best value: 0.178133:  50%|█████     | 50/100 [01:19<01:11,  1.44s/it]Best trial: 23. Best value: 0.178133:  50%|█████     | 50/100 [01:21<01:11,  1.44s/it]Best trial: 23. Best value: 0.178133:  51%|█████     | 51/100 [01:21<01:06,  1.36s/it]Best trial: 23. Best value: 0.178133:  51%|█████     | 51/100 [01:22<01:06,  1.36s/it]Best trial: 23. Best value: 0.178133:  52%|█████▏    | 52/100 [01:22<01:06,  1.38s/it]Best trial: 23. Best value: 0.178133:  52%|█████▏    | 52/100 [01:23<01:06,  1.38s/it]Best trial: 23. Best value: 0.178133:  53%|█████▎    | 53/100 [01:23<01:02,  1.32s/it]Best trial: 23. Best value: 0.178133:  53%|█████▎    | 53/100 [01:25<01:02,  1.32s/it]Best trial: 23. Best value: 0.178133:  54%|█████▍    | 54/100 [01:25<01:00,  1.31s/it]Best trial: 23. Best value: 0.178133:  54%|█████▍    | 54/100 [01:26<01:00,  1.31s/it]Best trial: 23. Best value: 0.178133:  55%|█████▌    | 55/100 [01:26<01:02,  1.38s/it]Best trial: 23. Best value: 0.178133:  55%|█████▌    | 55/100 [01:27<01:02,  1.38s/it]Best trial: 23. Best value: 0.178133:  56%|█████▌    | 56/100 [01:27<00:56,  1.28s/it]Best trial: 23. Best value: 0.178133:  56%|█████▌    | 56/100 [01:29<00:56,  1.28s/it]Best trial: 23. Best value: 0.178133:  57%|█████▋    | 57/100 [01:29<00:57,  1.34s/it]Best trial: 23. Best value: 0.178133:  57%|█████▋    | 57/100 [01:30<00:57,  1.34s/it]Best trial: 23. Best value: 0.178133:  58%|█████▊    | 58/100 [01:30<00:58,  1.39s/it]Best trial: 23. Best value: 0.178133:  58%|█████▊    | 58/100 [01:32<00:58,  1.39s/it]Best trial: 23. Best value: 0.178133:  59%|█████▉    | 59/100 [01:32<01:07,  1.64s/it]Best trial: 23. Best value: 0.178133:  59%|█████▉    | 59/100 [01:34<01:07,  1.64s/it]Best trial: 23. Best value: 0.178133:  60%|██████    | 60/100 [01:34<01:02,  1.57s/it]Best trial: 23. Best value: 0.178133:  60%|██████    | 60/100 [01:36<01:02,  1.57s/it]Best trial: 23. Best value: 0.178133:  61%|██████    | 61/100 [01:36<01:05,  1.69s/it]Best trial: 23. Best value: 0.178133:  61%|██████    | 61/100 [01:37<01:05,  1.69s/it]Best trial: 23. Best value: 0.178133:  62%|██████▏   | 62/100 [01:37<01:01,  1.62s/it]Best trial: 23. Best value: 0.178133:  62%|██████▏   | 62/100 [01:39<01:01,  1.62s/it]Best trial: 23. Best value: 0.178133:  63%|██████▎   | 63/100 [01:39<00:58,  1.58s/it]Best trial: 23. Best value: 0.178133:  63%|██████▎   | 63/100 [01:40<00:58,  1.58s/it]Best trial: 23. Best value: 0.178133:  64%|██████▍   | 64/100 [01:40<00:50,  1.40s/it]Best trial: 23. Best value: 0.178133:  64%|██████▍   | 64/100 [01:41<00:50,  1.40s/it]Best trial: 23. Best value: 0.178133:  65%|██████▌   | 65/100 [01:41<00:52,  1.49s/it]Best trial: 23. Best value: 0.178133:  65%|██████▌   | 65/100 [01:44<00:52,  1.49s/it]Best trial: 23. Best value: 0.178133:  66%|██████▌   | 66/100 [01:44<00:57,  1.69s/it]Best trial: 23. Best value: 0.178133:  66%|██████▌   | 66/100 [01:46<00:57,  1.69s/it]Best trial: 23. Best value: 0.178133:  67%|██████▋   | 67/100 [01:46<01:00,  1.83s/it]Best trial: 23. Best value: 0.178133:  67%|██████▋   | 67/100 [01:47<01:00,  1.83s/it]Best trial: 23. Best value: 0.178133:  68%|██████▊   | 68/100 [01:47<00:54,  1.71s/it]Best trial: 23. Best value: 0.178133:  68%|██████▊   | 68/100 [01:48<00:54,  1.71s/it]Best trial: 23. Best value: 0.178133:  69%|██████▉   | 69/100 [01:48<00:47,  1.52s/it]Best trial: 23. Best value: 0.178133:  69%|██████▉   | 69/100 [01:50<00:47,  1.52s/it]Best trial: 23. Best value: 0.178133:  70%|███████   | 70/100 [01:50<00:51,  1.72s/it]Best trial: 23. Best value: 0.178133:  70%|███████   | 70/100 [01:52<00:51,  1.72s/it]Best trial: 23. Best value: 0.178133:  71%|███████   | 71/100 [01:52<00:50,  1.74s/it]Best trial: 23. Best value: 0.178133:  71%|███████   | 71/100 [01:55<00:50,  1.74s/it]Best trial: 23. Best value: 0.178133:  72%|███████▏  | 72/100 [01:55<00:56,  2.01s/it]Best trial: 23. Best value: 0.178133:  72%|███████▏  | 72/100 [01:57<00:56,  2.01s/it]Best trial: 23. Best value: 0.178133:  73%|███████▎  | 73/100 [01:57<00:53,  1.97s/it]Best trial: 23. Best value: 0.178133:  73%|███████▎  | 73/100 [01:58<00:53,  1.97s/it]Best trial: 23. Best value: 0.178133:  74%|███████▍  | 74/100 [01:58<00:45,  1.73s/it]Best trial: 23. Best value: 0.178133:  74%|███████▍  | 74/100 [02:00<00:45,  1.73s/it]Best trial: 23. Best value: 0.178133:  75%|███████▌  | 75/100 [02:00<00:43,  1.74s/it]Best trial: 23. Best value: 0.178133:  75%|███████▌  | 75/100 [02:01<00:43,  1.74s/it]Best trial: 23. Best value: 0.178133:  76%|███████▌  | 76/100 [02:01<00:42,  1.77s/it]Best trial: 23. Best value: 0.178133:  76%|███████▌  | 76/100 [02:03<00:42,  1.77s/it]Best trial: 23. Best value: 0.178133:  77%|███████▋  | 77/100 [02:03<00:39,  1.72s/it]Best trial: 23. Best value: 0.178133:  77%|███████▋  | 77/100 [02:04<00:39,  1.72s/it]Best trial: 23. Best value: 0.178133:  78%|███████▊  | 78/100 [02:04<00:33,  1.51s/it]Best trial: 23. Best value: 0.178133:  78%|███████▊  | 78/100 [02:06<00:33,  1.51s/it]Best trial: 23. Best value: 0.178133:  79%|███████▉  | 79/100 [02:06<00:32,  1.56s/it]Best trial: 23. Best value: 0.178133:  79%|███████▉  | 79/100 [02:07<00:32,  1.56s/it]Best trial: 23. Best value: 0.178133:  80%|████████  | 80/100 [02:07<00:30,  1.54s/it]Best trial: 23. Best value: 0.178133:  80%|████████  | 80/100 [02:08<00:30,  1.54s/it]Best trial: 23. Best value: 0.178133:  81%|████████  | 81/100 [02:08<00:26,  1.38s/it]Best trial: 23. Best value: 0.178133:  81%|████████  | 81/100 [02:09<00:26,  1.38s/it]Best trial: 23. Best value: 0.178133:  82%|████████▏ | 82/100 [02:09<00:22,  1.24s/it]Best trial: 23. Best value: 0.178133:  82%|████████▏ | 82/100 [02:10<00:22,  1.24s/it]Best trial: 23. Best value: 0.178133:  83%|████████▎ | 83/100 [02:10<00:18,  1.11s/it]Best trial: 23. Best value: 0.178133:  83%|████████▎ | 83/100 [02:11<00:18,  1.11s/it]Best trial: 23. Best value: 0.178133:  84%|████████▍ | 84/100 [02:11<00:17,  1.12s/it]Best trial: 23. Best value: 0.178133:  84%|████████▍ | 84/100 [02:13<00:17,  1.12s/it]Best trial: 23. Best value: 0.178133:  85%|████████▌ | 85/100 [02:13<00:18,  1.24s/it]Best trial: 23. Best value: 0.178133:  85%|████████▌ | 85/100 [02:14<00:18,  1.24s/it]Best trial: 23. Best value: 0.178133:  86%|████████▌ | 86/100 [02:14<00:17,  1.26s/it]Best trial: 23. Best value: 0.178133:  86%|████████▌ | 86/100 [02:15<00:17,  1.26s/it]Best trial: 23. Best value: 0.178133:  87%|████████▋ | 87/100 [02:15<00:17,  1.32s/it]Best trial: 23. Best value: 0.178133:  87%|████████▋ | 87/100 [02:17<00:17,  1.32s/it]Best trial: 23. Best value: 0.178133:  88%|████████▊ | 88/100 [02:17<00:16,  1.38s/it]Best trial: 23. Best value: 0.178133:  88%|████████▊ | 88/100 [02:18<00:16,  1.38s/it]Best trial: 23. Best value: 0.178133:  89%|████████▉ | 89/100 [02:18<00:13,  1.26s/it]Best trial: 23. Best value: 0.178133:  89%|████████▉ | 89/100 [02:20<00:13,  1.26s/it]Best trial: 23. Best value: 0.178133:  90%|█████████ | 90/100 [02:20<00:13,  1.38s/it]Best trial: 23. Best value: 0.178133:  90%|█████████ | 90/100 [02:21<00:13,  1.38s/it]Best trial: 23. Best value: 0.178133:  91%|█████████ | 91/100 [02:21<00:11,  1.30s/it]Best trial: 23. Best value: 0.178133:  91%|█████████ | 91/100 [02:22<00:11,  1.30s/it]Best trial: 23. Best value: 0.178133:  92%|█████████▏| 92/100 [02:22<00:10,  1.25s/it]Best trial: 23. Best value: 0.178133:  92%|█████████▏| 92/100 [02:23<00:10,  1.25s/it]Best trial: 23. Best value: 0.178133:  93%|█████████▎| 93/100 [02:23<00:09,  1.38s/it]Best trial: 23. Best value: 0.178133:  93%|█████████▎| 93/100 [02:24<00:09,  1.38s/it]Best trial: 23. Best value: 0.178133:  94%|█████████▍| 94/100 [02:24<00:07,  1.25s/it]Best trial: 23. Best value: 0.178133:  94%|█████████▍| 94/100 [02:25<00:07,  1.25s/it]Best trial: 23. Best value: 0.178133:  95%|█████████▌| 95/100 [02:25<00:05,  1.18s/it]Best trial: 23. Best value: 0.178133:  95%|█████████▌| 95/100 [02:26<00:05,  1.18s/it]Best trial: 23. Best value: 0.178133:  96%|█████████▌| 96/100 [02:26<00:04,  1.09s/it]Best trial: 23. Best value: 0.178133:  96%|█████████▌| 96/100 [02:28<00:04,  1.09s/it]Best trial: 23. Best value: 0.178133:  97%|█████████▋| 97/100 [02:28<00:03,  1.13s/it]Best trial: 23. Best value: 0.178133:  97%|█████████▋| 97/100 [02:29<00:03,  1.13s/it]Best trial: 23. Best value: 0.178133:  98%|█████████▊| 98/100 [02:29<00:02,  1.09s/it]Best trial: 23. Best value: 0.178133:  98%|█████████▊| 98/100 [02:30<00:02,  1.09s/it]Best trial: 23. Best value: 0.178133:  99%|█████████▉| 99/100 [02:30<00:01,  1.13s/it]Best trial: 23. Best value: 0.178133:  99%|█████████▉| 99/100 [02:31<00:01,  1.13s/it]Best trial: 23. Best value: 0.178133: 100%|██████████| 100/100 [02:31<00:00,  1.19s/it]Best trial: 23. Best value: 0.178133: 100%|██████████| 100/100 [02:31<00:00,  1.52s/it]
2025-11-30 06:56:02,083 - INFO - HPO Complete. Best AUPRC: 0.1781
2025-11-30 06:56:02,083 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.09350157251299027, 'max_depth': 3, 'subsample': 0.8958839784914591, 'colsample_bytree': 0.8874762625007534, 'gamma': 2.8413394037454243, 'reg_lambda': 0.00033424801070283574, 'reg_alpha': 0.15713417833218746}
2025-11-30 06:56:02,084 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 06:56:03,917 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 06:56:03,917 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:56:03,998 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:56:04,006 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:56:04,008 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:56:04,008 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 06:56:04,008 - INFO - Training model...
2025-11-30 06:56:04,584 - INFO - Evaluating model with bootstrapping...
2025-11-30 06:56:09,409 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 06:56:09,409 - INFO - AUROC: 0.5429 (0.4299 - 0.6209)
2025-11-30 06:56:09,409 - INFO - AUPRC: 0.0908 (0.0497 - 0.1641)
2025-11-30 06:56:09,409 - INFO - Brier Score: 0.0769 (0.0653 - 0.0939)
2025-11-30 06:56:09,409 - INFO - Accuracy: 0.8049 (0.3133 - 0.9584)
2025-11-30 06:56:09,409 - INFO - Precision: 0.0840 (0.0490 - 1.0000)
2025-11-30 06:56:09,409 - INFO - Sensitivity (Recall): 0.2778 (0.0722 - 0.7202)
2025-11-30 06:56:09,409 - INFO - F1-Score: 0.1290 (0.0896 - 0.1878)
2025-11-30 06:56:09,409 - INFO - Best Threshold: 0.2100 (0.0100 - 0.9300)
2025-11-30 06:56:09,409 - INFO - Specificity: 0.8338 (0.2894 - 1.0000)
2025-11-30 06:56:09,421 - INFO - Calculating SHAP values...
2025-11-30 06:56:10,489 - INFO - SHAP plots saved.
2025-11-30 06:56:10,489 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:56:11,815 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 06:56:11,815 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:56:11,919 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:56:11,928 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:56:11,930 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:56:11,931 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.175877:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.175877:   1%|          | 1/100 [00:01<01:54,  1.16s/it]Best trial: 1. Best value: 0.195048:   1%|          | 1/100 [00:02<01:54,  1.16s/it]Best trial: 1. Best value: 0.195048:   2%|▏         | 2/100 [00:02<02:29,  1.53s/it]Best trial: 1. Best value: 0.195048:   2%|▏         | 2/100 [00:04<02:29,  1.53s/it]Best trial: 1. Best value: 0.195048:   3%|▎         | 3/100 [00:04<02:34,  1.59s/it]Best trial: 1. Best value: 0.195048:   3%|▎         | 3/100 [00:05<02:34,  1.59s/it]Best trial: 1. Best value: 0.195048:   4%|▍         | 4/100 [00:05<02:18,  1.44s/it]Best trial: 1. Best value: 0.195048:   4%|▍         | 4/100 [00:08<02:18,  1.44s/it]Best trial: 1. Best value: 0.195048:   5%|▌         | 5/100 [00:08<02:52,  1.81s/it]Best trial: 1. Best value: 0.195048:   5%|▌         | 5/100 [00:09<02:52,  1.81s/it]Best trial: 1. Best value: 0.195048:   6%|▌         | 6/100 [00:09<02:25,  1.55s/it]Best trial: 1. Best value: 0.195048:   6%|▌         | 6/100 [00:13<02:25,  1.55s/it]Best trial: 1. Best value: 0.195048:   7%|▋         | 7/100 [00:13<03:31,  2.27s/it]Best trial: 1. Best value: 0.195048:   7%|▋         | 7/100 [00:16<03:31,  2.27s/it]Best trial: 1. Best value: 0.195048:   8%|▊         | 8/100 [00:16<03:59,  2.61s/it]Best trial: 1. Best value: 0.195048:   8%|▊         | 8/100 [00:17<03:59,  2.61s/it]Best trial: 1. Best value: 0.195048:   9%|▉         | 9/100 [00:17<03:05,  2.04s/it]Best trial: 1. Best value: 0.195048:   9%|▉         | 9/100 [00:18<03:05,  2.04s/it]Best trial: 1. Best value: 0.195048:  10%|█         | 10/100 [00:18<02:37,  1.75s/it]Best trial: 1. Best value: 0.195048:  10%|█         | 10/100 [00:19<02:37,  1.75s/it]Best trial: 1. Best value: 0.195048:  11%|█         | 11/100 [00:19<02:24,  1.63s/it]Best trial: 11. Best value: 0.207171:  11%|█         | 11/100 [00:21<02:24,  1.63s/it]Best trial: 11. Best value: 0.207171:  12%|█▏        | 12/100 [00:21<02:21,  1.61s/it]Best trial: 11. Best value: 0.207171:  12%|█▏        | 12/100 [00:24<02:21,  1.61s/it]Best trial: 11. Best value: 0.207171:  13%|█▎        | 13/100 [00:24<03:01,  2.09s/it]Best trial: 11. Best value: 0.207171:  13%|█▎        | 13/100 [00:27<03:01,  2.09s/it]Best trial: 11. Best value: 0.207171:  14%|█▍        | 14/100 [00:27<03:27,  2.42s/it]Best trial: 11. Best value: 0.207171:  14%|█▍        | 14/100 [00:31<03:27,  2.42s/it]Best trial: 11. Best value: 0.207171:  15%|█▌        | 15/100 [00:31<04:12,  2.97s/it]Best trial: 15. Best value: 0.215148:  15%|█▌        | 15/100 [00:34<04:12,  2.97s/it]Best trial: 15. Best value: 0.215148:  16%|█▌        | 16/100 [00:34<03:53,  2.78s/it]Best trial: 15. Best value: 0.215148:  16%|█▌        | 16/100 [00:35<03:53,  2.78s/it]Best trial: 15. Best value: 0.215148:  17%|█▋        | 17/100 [00:35<03:19,  2.41s/it]Best trial: 15. Best value: 0.215148:  17%|█▋        | 17/100 [00:38<03:19,  2.41s/it]Best trial: 15. Best value: 0.215148:  18%|█▊        | 18/100 [00:38<03:27,  2.54s/it]Best trial: 15. Best value: 0.215148:  18%|█▊        | 18/100 [00:40<03:27,  2.54s/it]Best trial: 15. Best value: 0.215148:  19%|█▉        | 19/100 [00:40<03:14,  2.40s/it]Best trial: 15. Best value: 0.215148:  19%|█▉        | 19/100 [00:41<03:14,  2.40s/it]Best trial: 15. Best value: 0.215148:  20%|██        | 20/100 [00:41<02:42,  2.03s/it]Best trial: 15. Best value: 0.215148:  20%|██        | 20/100 [00:43<02:42,  2.03s/it]Best trial: 15. Best value: 0.215148:  21%|██        | 21/100 [00:43<02:39,  2.01s/it]Best trial: 15. Best value: 0.215148:  21%|██        | 21/100 [00:44<02:39,  2.01s/it]Best trial: 15. Best value: 0.215148:  22%|██▏       | 22/100 [00:44<02:14,  1.72s/it]Best trial: 15. Best value: 0.215148:  22%|██▏       | 22/100 [00:46<02:14,  1.72s/it]Best trial: 15. Best value: 0.215148:  23%|██▎       | 23/100 [00:46<02:13,  1.73s/it]Best trial: 15. Best value: 0.215148:  23%|██▎       | 23/100 [00:48<02:13,  1.73s/it]Best trial: 15. Best value: 0.215148:  24%|██▍       | 24/100 [00:48<02:15,  1.78s/it]Best trial: 15. Best value: 0.215148:  24%|██▍       | 24/100 [00:51<02:15,  1.78s/it]Best trial: 15. Best value: 0.215148:  25%|██▌       | 25/100 [00:51<02:37,  2.10s/it]Best trial: 15. Best value: 0.215148:  25%|██▌       | 25/100 [00:53<02:37,  2.10s/it]Best trial: 15. Best value: 0.215148:  26%|██▌       | 26/100 [00:53<02:28,  2.01s/it]Best trial: 15. Best value: 0.215148:  26%|██▌       | 26/100 [00:54<02:28,  2.01s/it]Best trial: 15. Best value: 0.215148:  27%|██▋       | 27/100 [00:54<02:19,  1.91s/it]Best trial: 15. Best value: 0.215148:  27%|██▋       | 27/100 [00:56<02:19,  1.91s/it]Best trial: 15. Best value: 0.215148:  28%|██▊       | 28/100 [00:56<02:13,  1.85s/it]Best trial: 15. Best value: 0.215148:  28%|██▊       | 28/100 [00:58<02:13,  1.85s/it]Best trial: 15. Best value: 0.215148:  29%|██▉       | 29/100 [00:58<02:16,  1.93s/it]Best trial: 15. Best value: 0.215148:  29%|██▉       | 29/100 [01:00<02:16,  1.93s/it]Best trial: 15. Best value: 0.215148:  30%|███       | 30/100 [01:00<02:20,  2.01s/it]Best trial: 15. Best value: 0.215148:  30%|███       | 30/100 [01:03<02:20,  2.01s/it]Best trial: 15. Best value: 0.215148:  31%|███       | 31/100 [01:03<02:25,  2.11s/it]Best trial: 15. Best value: 0.215148:  31%|███       | 31/100 [01:04<02:25,  2.11s/it]Best trial: 15. Best value: 0.215148:  32%|███▏      | 32/100 [01:04<02:17,  2.02s/it]Best trial: 15. Best value: 0.215148:  32%|███▏      | 32/100 [01:06<02:17,  2.02s/it]Best trial: 15. Best value: 0.215148:  33%|███▎      | 33/100 [01:06<02:03,  1.85s/it]Best trial: 33. Best value: 0.225803:  33%|███▎      | 33/100 [01:07<02:03,  1.85s/it]Best trial: 33. Best value: 0.225803:  34%|███▍      | 34/100 [01:07<01:51,  1.69s/it]Best trial: 33. Best value: 0.225803:  34%|███▍      | 34/100 [01:09<01:51,  1.69s/it]Best trial: 33. Best value: 0.225803:  35%|███▌      | 35/100 [01:09<01:47,  1.65s/it]Best trial: 33. Best value: 0.225803:  35%|███▌      | 35/100 [01:10<01:47,  1.65s/it]Best trial: 33. Best value: 0.225803:  36%|███▌      | 36/100 [01:10<01:45,  1.65s/it]Best trial: 33. Best value: 0.225803:  36%|███▌      | 36/100 [01:12<01:45,  1.65s/it]Best trial: 33. Best value: 0.225803:  37%|███▋      | 37/100 [01:12<01:51,  1.77s/it]Best trial: 33. Best value: 0.225803:  37%|███▋      | 37/100 [01:14<01:51,  1.77s/it]Best trial: 33. Best value: 0.225803:  38%|███▊      | 38/100 [01:14<01:44,  1.69s/it]Best trial: 33. Best value: 0.225803:  38%|███▊      | 38/100 [01:15<01:44,  1.69s/it]Best trial: 33. Best value: 0.225803:  39%|███▉      | 39/100 [01:15<01:30,  1.48s/it]Best trial: 33. Best value: 0.225803:  39%|███▉      | 39/100 [01:16<01:30,  1.48s/it]Best trial: 33. Best value: 0.225803:  40%|████      | 40/100 [01:16<01:29,  1.49s/it]Best trial: 33. Best value: 0.225803:  40%|████      | 40/100 [01:18<01:29,  1.49s/it]Best trial: 33. Best value: 0.225803:  41%|████      | 41/100 [01:18<01:27,  1.48s/it]Best trial: 33. Best value: 0.225803:  41%|████      | 41/100 [01:19<01:27,  1.48s/it]Best trial: 33. Best value: 0.225803:  42%|████▏     | 42/100 [01:19<01:25,  1.48s/it]Best trial: 33. Best value: 0.225803:  42%|████▏     | 42/100 [01:22<01:25,  1.48s/it]Best trial: 33. Best value: 0.225803:  43%|████▎     | 43/100 [01:22<01:35,  1.68s/it]Best trial: 33. Best value: 0.225803:  43%|████▎     | 43/100 [01:23<01:35,  1.68s/it]Best trial: 33. Best value: 0.225803:  44%|████▍     | 44/100 [01:23<01:32,  1.65s/it]Best trial: 33. Best value: 0.225803:  44%|████▍     | 44/100 [01:25<01:32,  1.65s/it]Best trial: 33. Best value: 0.225803:  45%|████▌     | 45/100 [01:25<01:32,  1.67s/it]Best trial: 33. Best value: 0.225803:  45%|████▌     | 45/100 [01:27<01:32,  1.67s/it]Best trial: 33. Best value: 0.225803:  46%|████▌     | 46/100 [01:27<01:36,  1.79s/it]Best trial: 33. Best value: 0.225803:  46%|████▌     | 46/100 [01:29<01:36,  1.79s/it]Best trial: 33. Best value: 0.225803:  47%|████▋     | 47/100 [01:29<01:37,  1.84s/it]Best trial: 33. Best value: 0.225803:  47%|████▋     | 47/100 [01:31<01:37,  1.84s/it]Best trial: 33. Best value: 0.225803:  48%|████▊     | 48/100 [01:31<01:32,  1.79s/it]Best trial: 33. Best value: 0.225803:  48%|████▊     | 48/100 [01:32<01:32,  1.79s/it]Best trial: 33. Best value: 0.225803:  49%|████▉     | 49/100 [01:32<01:18,  1.53s/it]Best trial: 33. Best value: 0.225803:  49%|████▉     | 49/100 [01:34<01:18,  1.53s/it]Best trial: 33. Best value: 0.225803:  50%|█████     | 50/100 [01:34<01:30,  1.82s/it]Best trial: 33. Best value: 0.225803:  50%|█████     | 50/100 [01:35<01:30,  1.82s/it]Best trial: 33. Best value: 0.225803:  51%|█████     | 51/100 [01:35<01:15,  1.54s/it]Best trial: 33. Best value: 0.225803:  51%|█████     | 51/100 [01:36<01:15,  1.54s/it]Best trial: 33. Best value: 0.225803:  52%|█████▏    | 52/100 [01:36<01:13,  1.52s/it]Best trial: 33. Best value: 0.225803:  52%|█████▏    | 52/100 [01:37<01:13,  1.52s/it]Best trial: 33. Best value: 0.225803:  53%|█████▎    | 53/100 [01:37<01:05,  1.40s/it]Best trial: 33. Best value: 0.225803:  53%|█████▎    | 53/100 [01:39<01:05,  1.40s/it]Best trial: 33. Best value: 0.225803:  54%|█████▍    | 54/100 [01:39<01:02,  1.35s/it]Best trial: 33. Best value: 0.225803:  54%|█████▍    | 54/100 [01:40<01:02,  1.35s/it]Best trial: 33. Best value: 0.225803:  55%|█████▌    | 55/100 [01:40<00:56,  1.25s/it]Best trial: 33. Best value: 0.225803:  55%|█████▌    | 55/100 [01:42<00:56,  1.25s/it]Best trial: 33. Best value: 0.225803:  56%|█████▌    | 56/100 [01:42<01:06,  1.52s/it]Best trial: 33. Best value: 0.225803:  56%|█████▌    | 56/100 [01:43<01:06,  1.52s/it]Best trial: 33. Best value: 0.225803:  57%|█████▋    | 57/100 [01:43<01:05,  1.52s/it]Best trial: 33. Best value: 0.225803:  57%|█████▋    | 57/100 [01:44<01:05,  1.52s/it]Best trial: 33. Best value: 0.225803:  58%|█████▊    | 58/100 [01:44<00:55,  1.33s/it]Best trial: 33. Best value: 0.225803:  58%|█████▊    | 58/100 [01:46<00:55,  1.33s/it]Best trial: 33. Best value: 0.225803:  59%|█████▉    | 59/100 [01:46<00:55,  1.36s/it]Best trial: 33. Best value: 0.225803:  59%|█████▉    | 59/100 [01:47<00:55,  1.36s/it]Best trial: 33. Best value: 0.225803:  60%|██████    | 60/100 [01:47<00:57,  1.45s/it]Best trial: 33. Best value: 0.225803:  60%|██████    | 60/100 [01:49<00:57,  1.45s/it]Best trial: 33. Best value: 0.225803:  61%|██████    | 61/100 [01:49<00:56,  1.45s/it]Best trial: 33. Best value: 0.225803:  61%|██████    | 61/100 [01:50<00:56,  1.45s/it]Best trial: 33. Best value: 0.225803:  62%|██████▏   | 62/100 [01:50<00:51,  1.35s/it]Best trial: 33. Best value: 0.225803:  62%|██████▏   | 62/100 [01:51<00:51,  1.35s/it]Best trial: 33. Best value: 0.225803:  63%|██████▎   | 63/100 [01:51<00:48,  1.30s/it]Best trial: 33. Best value: 0.225803:  63%|██████▎   | 63/100 [01:52<00:48,  1.30s/it]Best trial: 33. Best value: 0.225803:  64%|██████▍   | 64/100 [01:52<00:43,  1.20s/it]Best trial: 33. Best value: 0.225803:  64%|██████▍   | 64/100 [01:53<00:43,  1.20s/it]Best trial: 33. Best value: 0.225803:  65%|██████▌   | 65/100 [01:53<00:43,  1.24s/it]Best trial: 33. Best value: 0.225803:  65%|██████▌   | 65/100 [01:55<00:43,  1.24s/it]Best trial: 33. Best value: 0.225803:  66%|██████▌   | 66/100 [01:55<00:41,  1.23s/it]Best trial: 33. Best value: 0.225803:  66%|██████▌   | 66/100 [01:56<00:41,  1.23s/it]Best trial: 33. Best value: 0.225803:  67%|██████▋   | 67/100 [01:56<00:40,  1.22s/it]Best trial: 33. Best value: 0.225803:  67%|██████▋   | 67/100 [01:57<00:40,  1.22s/it]Best trial: 33. Best value: 0.225803:  68%|██████▊   | 68/100 [01:57<00:39,  1.24s/it]Best trial: 33. Best value: 0.225803:  68%|██████▊   | 68/100 [02:00<00:39,  1.24s/it]Best trial: 33. Best value: 0.225803:  69%|██████▉   | 69/100 [02:00<00:53,  1.73s/it]Best trial: 33. Best value: 0.225803:  69%|██████▉   | 69/100 [02:01<00:53,  1.73s/it]Best trial: 33. Best value: 0.225803:  70%|███████   | 70/100 [02:01<00:48,  1.62s/it]Best trial: 33. Best value: 0.225803:  70%|███████   | 70/100 [02:03<00:48,  1.62s/it]Best trial: 33. Best value: 0.225803:  71%|███████   | 71/100 [02:03<00:44,  1.54s/it]Best trial: 33. Best value: 0.225803:  71%|███████   | 71/100 [02:04<00:44,  1.54s/it]Best trial: 33. Best value: 0.225803:  72%|███████▏  | 72/100 [02:04<00:36,  1.32s/it]Best trial: 33. Best value: 0.225803:  72%|███████▏  | 72/100 [02:05<00:36,  1.32s/it]Best trial: 33. Best value: 0.225803:  73%|███████▎  | 73/100 [02:05<00:35,  1.30s/it]Best trial: 33. Best value: 0.225803:  73%|███████▎  | 73/100 [02:06<00:35,  1.30s/it]Best trial: 33. Best value: 0.225803:  74%|███████▍  | 74/100 [02:06<00:33,  1.28s/it]Best trial: 33. Best value: 0.225803:  74%|███████▍  | 74/100 [02:07<00:33,  1.28s/it]Best trial: 33. Best value: 0.225803:  75%|███████▌  | 75/100 [02:07<00:30,  1.21s/it]Best trial: 33. Best value: 0.225803:  75%|███████▌  | 75/100 [02:08<00:30,  1.21s/it]Best trial: 33. Best value: 0.225803:  76%|███████▌  | 76/100 [02:08<00:26,  1.09s/it]Best trial: 33. Best value: 0.225803:  76%|███████▌  | 76/100 [02:09<00:26,  1.09s/it]Best trial: 33. Best value: 0.225803:  77%|███████▋  | 77/100 [02:09<00:27,  1.20s/it]Best trial: 33. Best value: 0.225803:  77%|███████▋  | 77/100 [02:10<00:27,  1.20s/it]Best trial: 33. Best value: 0.225803:  78%|███████▊  | 78/100 [02:10<00:25,  1.15s/it]Best trial: 33. Best value: 0.225803:  78%|███████▊  | 78/100 [02:12<00:25,  1.15s/it]Best trial: 33. Best value: 0.225803:  79%|███████▉  | 79/100 [02:12<00:25,  1.24s/it]Best trial: 33. Best value: 0.225803:  79%|███████▉  | 79/100 [02:13<00:25,  1.24s/it]Best trial: 33. Best value: 0.225803:  80%|████████  | 80/100 [02:13<00:23,  1.18s/it]Best trial: 33. Best value: 0.225803:  80%|████████  | 80/100 [02:14<00:23,  1.18s/it]Best trial: 33. Best value: 0.225803:  81%|████████  | 81/100 [02:14<00:22,  1.21s/it]Best trial: 33. Best value: 0.225803:  81%|████████  | 81/100 [02:15<00:22,  1.21s/it]Best trial: 33. Best value: 0.225803:  82%|████████▏ | 82/100 [02:15<00:20,  1.13s/it]Best trial: 33. Best value: 0.225803:  82%|████████▏ | 82/100 [02:16<00:20,  1.13s/it]Best trial: 33. Best value: 0.225803:  83%|████████▎ | 83/100 [02:16<00:19,  1.15s/it]Best trial: 33. Best value: 0.225803:  83%|████████▎ | 83/100 [02:18<00:19,  1.15s/it]Best trial: 33. Best value: 0.225803:  84%|████████▍ | 84/100 [02:18<00:18,  1.18s/it]Best trial: 33. Best value: 0.225803:  84%|████████▍ | 84/100 [02:19<00:18,  1.18s/it]Best trial: 33. Best value: 0.225803:  85%|████████▌ | 85/100 [02:19<00:17,  1.15s/it]Best trial: 33. Best value: 0.225803:  85%|████████▌ | 85/100 [02:19<00:17,  1.15s/it]Best trial: 33. Best value: 0.225803:  86%|████████▌ | 86/100 [02:19<00:14,  1.06s/it]Best trial: 33. Best value: 0.225803:  86%|████████▌ | 86/100 [02:20<00:14,  1.06s/it]Best trial: 33. Best value: 0.225803:  87%|████████▋ | 87/100 [02:20<00:12,  1.02it/s]Best trial: 33. Best value: 0.225803:  87%|████████▋ | 87/100 [02:21<00:12,  1.02it/s]Best trial: 33. Best value: 0.225803:  88%|████████▊ | 88/100 [02:21<00:11,  1.07it/s]Best trial: 33. Best value: 0.225803:  88%|████████▊ | 88/100 [02:23<00:11,  1.07it/s]Best trial: 33. Best value: 0.225803:  89%|████████▉ | 89/100 [02:23<00:14,  1.35s/it]Best trial: 33. Best value: 0.225803:  89%|████████▉ | 89/100 [02:25<00:14,  1.35s/it]Best trial: 33. Best value: 0.225803:  90%|█████████ | 90/100 [02:25<00:14,  1.44s/it]Best trial: 33. Best value: 0.225803:  90%|█████████ | 90/100 [02:26<00:14,  1.44s/it]Best trial: 33. Best value: 0.225803:  91%|█████████ | 91/100 [02:26<00:12,  1.37s/it]Best trial: 33. Best value: 0.225803:  91%|█████████ | 91/100 [02:27<00:12,  1.37s/it]Best trial: 33. Best value: 0.225803:  92%|█████████▏| 92/100 [02:27<00:09,  1.24s/it]Best trial: 92. Best value: 0.22842:  92%|█████████▏| 92/100 [02:28<00:09,  1.24s/it] Best trial: 92. Best value: 0.22842:  93%|█████████▎| 93/100 [02:28<00:07,  1.10s/it]Best trial: 92. Best value: 0.22842:  93%|█████████▎| 93/100 [02:29<00:07,  1.10s/it]Best trial: 92. Best value: 0.22842:  94%|█████████▍| 94/100 [02:29<00:06,  1.09s/it]Best trial: 92. Best value: 0.22842:  94%|█████████▍| 94/100 [02:30<00:06,  1.09s/it]Best trial: 92. Best value: 0.22842:  95%|█████████▌| 95/100 [02:30<00:05,  1.09s/it]Best trial: 92. Best value: 0.22842:  95%|█████████▌| 95/100 [02:31<00:05,  1.09s/it]Best trial: 92. Best value: 0.22842:  96%|█████████▌| 96/100 [02:31<00:03,  1.01it/s]Best trial: 92. Best value: 0.22842:  96%|█████████▌| 96/100 [02:32<00:03,  1.01it/s]Best trial: 92. Best value: 0.22842:  97%|█████████▋| 97/100 [02:32<00:03,  1.02s/it]Best trial: 92. Best value: 0.22842:  97%|█████████▋| 97/100 [02:33<00:03,  1.02s/it]Best trial: 92. Best value: 0.22842:  98%|█████████▊| 98/100 [02:33<00:01,  1.04it/s]Best trial: 92. Best value: 0.22842:  98%|█████████▊| 98/100 [02:34<00:01,  1.04it/s]Best trial: 92. Best value: 0.22842:  99%|█████████▉| 99/100 [02:34<00:00,  1.01it/s]Best trial: 92. Best value: 0.22842:  99%|█████████▉| 99/100 [02:35<00:00,  1.01it/s]Best trial: 92. Best value: 0.22842: 100%|██████████| 100/100 [02:35<00:00,  1.02it/s]Best trial: 92. Best value: 0.22842: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
2025-11-30 06:58:47,219 - INFO - HPO Complete. Best AUPRC: 0.2284
2025-11-30 06:58:47,219 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.08305524877919364, 'max_depth': 4, 'subsample': 0.9578154521959509, 'colsample_bytree': 0.6052076438157357, 'gamma': 2.685053079227925, 'reg_lambda': 0.04432337372673304, 'reg_alpha': 2.9417649538859727e-07}
2025-11-30 06:58:47,220 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 06:58:49,388 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 06:58:49,388 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:58:49,482 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:58:49,491 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:58:49,493 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 06:58:49,493 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 06:58:49,494 - INFO - Training model...
2025-11-30 06:58:50,377 - INFO - Evaluating model with bootstrapping...
2025-11-30 06:58:55,128 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 06:58:55,128 - INFO - AUROC: 0.6616 (0.5890 - 0.7385)
2025-11-30 06:58:55,128 - INFO - AUPRC: 0.1409 (0.0770 - 0.2526)
2025-11-30 06:58:55,129 - INFO - Brier Score: 0.0696 (0.0622 - 0.0845)
2025-11-30 06:58:55,129 - INFO - Accuracy: 0.9061 (0.6529 - 0.9610)
2025-11-30 06:58:55,129 - INFO - Precision: 0.1628 (0.0822 - 0.7867)
2025-11-30 06:58:55,129 - INFO - Sensitivity (Recall): 0.1944 (0.1269 - 0.6833)
2025-11-30 06:58:55,129 - INFO - F1-Score: 0.1772 (0.1416 - 0.3139)
2025-11-30 06:58:55,129 - INFO - Best Threshold: 0.4100 (0.0880 - 0.8500)
2025-11-30 06:58:55,129 - INFO - Specificity: 0.9451 (0.6502 - 0.9976)
2025-11-30 06:58:55,139 - INFO - Calculating SHAP values...
2025-11-30 06:58:56,321 - INFO - SHAP plots saved.
2025-11-30 06:58:56,322 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 06:58:57,832 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 06:58:57,832 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 06:58:57,916 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 06:58:57,936 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 06:58:57,940 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 06:58:57,940 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.18119:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.18119:   1%|          | 1/100 [00:04<08:07,  4.92s/it]Best trial: 1. Best value: 0.182652:   1%|          | 1/100 [00:07<08:07,  4.92s/it]Best trial: 1. Best value: 0.182652:   2%|▏         | 2/100 [00:07<05:45,  3.52s/it]Best trial: 1. Best value: 0.182652:   2%|▏         | 2/100 [00:11<05:45,  3.52s/it]Best trial: 1. Best value: 0.182652:   3%|▎         | 3/100 [00:11<05:57,  3.68s/it]Best trial: 1. Best value: 0.182652:   3%|▎         | 3/100 [00:13<05:57,  3.68s/it]Best trial: 1. Best value: 0.182652:   4%|▍         | 4/100 [00:13<04:41,  2.93s/it]Best trial: 1. Best value: 0.182652:   4%|▍         | 4/100 [00:15<04:41,  2.93s/it]Best trial: 1. Best value: 0.182652:   5%|▌         | 5/100 [00:15<04:32,  2.87s/it]Best trial: 1. Best value: 0.182652:   5%|▌         | 5/100 [00:19<04:32,  2.87s/it]Best trial: 1. Best value: 0.182652:   6%|▌         | 6/100 [00:19<04:48,  3.07s/it]Best trial: 1. Best value: 0.182652:   6%|▌         | 6/100 [00:25<04:48,  3.07s/it]Best trial: 1. Best value: 0.182652:   7%|▋         | 7/100 [00:25<06:33,  4.23s/it]Best trial: 1. Best value: 0.182652:   7%|▋         | 7/100 [00:30<06:33,  4.23s/it]Best trial: 1. Best value: 0.182652:   8%|▊         | 8/100 [00:30<06:38,  4.33s/it]Best trial: 1. Best value: 0.182652:   8%|▊         | 8/100 [00:32<06:38,  4.33s/it]Best trial: 1. Best value: 0.182652:   9%|▉         | 9/100 [00:32<05:37,  3.71s/it]Best trial: 1. Best value: 0.182652:   9%|▉         | 9/100 [00:36<05:37,  3.71s/it]Best trial: 1. Best value: 0.182652:  10%|█         | 10/100 [00:36<05:26,  3.63s/it]Best trial: 1. Best value: 0.182652:  10%|█         | 10/100 [00:38<05:26,  3.63s/it]Best trial: 1. Best value: 0.182652:  11%|█         | 11/100 [00:38<04:44,  3.19s/it]Best trial: 1. Best value: 0.182652:  11%|█         | 11/100 [00:41<04:44,  3.19s/it]Best trial: 1. Best value: 0.182652:  12%|█▏        | 12/100 [00:41<04:24,  3.01s/it]Best trial: 1. Best value: 0.182652:  12%|█▏        | 12/100 [00:43<04:24,  3.01s/it]Best trial: 1. Best value: 0.182652:  13%|█▎        | 13/100 [00:43<04:08,  2.85s/it]Best trial: 1. Best value: 0.182652:  13%|█▎        | 13/100 [00:46<04:08,  2.85s/it]Best trial: 1. Best value: 0.182652:  14%|█▍        | 14/100 [00:46<04:14,  2.96s/it]Best trial: 1. Best value: 0.182652:  14%|█▍        | 14/100 [00:49<04:14,  2.96s/it]Best trial: 1. Best value: 0.182652:  15%|█▌        | 15/100 [00:49<04:07,  2.91s/it]Best trial: 1. Best value: 0.182652:  15%|█▌        | 15/100 [00:52<04:07,  2.91s/it]Best trial: 1. Best value: 0.182652:  16%|█▌        | 16/100 [00:52<04:11,  2.99s/it]Best trial: 1. Best value: 0.182652:  16%|█▌        | 16/100 [00:55<04:11,  2.99s/it]Best trial: 1. Best value: 0.182652:  17%|█▋        | 17/100 [00:55<04:01,  2.91s/it]Best trial: 1. Best value: 0.182652:  17%|█▋        | 17/100 [01:00<04:01,  2.91s/it]Best trial: 1. Best value: 0.182652:  18%|█▊        | 18/100 [01:00<04:46,  3.50s/it]Best trial: 1. Best value: 0.182652:  18%|█▊        | 18/100 [01:03<04:46,  3.50s/it]Best trial: 1. Best value: 0.182652:  19%|█▉        | 19/100 [01:03<04:37,  3.42s/it]Best trial: 1. Best value: 0.182652:  19%|█▉        | 19/100 [01:06<04:37,  3.42s/it]Best trial: 1. Best value: 0.182652:  20%|██        | 20/100 [01:06<04:13,  3.17s/it]Best trial: 1. Best value: 0.182652:  20%|██        | 20/100 [01:10<04:13,  3.17s/it]Best trial: 1. Best value: 0.182652:  21%|██        | 21/100 [01:10<04:38,  3.52s/it]Best trial: 1. Best value: 0.182652:  21%|██        | 21/100 [01:13<04:38,  3.52s/it]Best trial: 1. Best value: 0.182652:  22%|██▏       | 22/100 [01:13<04:15,  3.27s/it]Best trial: 1. Best value: 0.182652:  22%|██▏       | 22/100 [01:16<04:15,  3.27s/it]Best trial: 1. Best value: 0.182652:  23%|██▎       | 23/100 [01:16<04:12,  3.27s/it]Best trial: 1. Best value: 0.182652:  23%|██▎       | 23/100 [01:18<04:12,  3.27s/it]Best trial: 1. Best value: 0.182652:  24%|██▍       | 24/100 [01:18<03:47,  2.99s/it]Best trial: 1. Best value: 0.182652:  24%|██▍       | 24/100 [01:21<03:47,  2.99s/it]Best trial: 1. Best value: 0.182652:  25%|██▌       | 25/100 [01:21<03:33,  2.85s/it]Best trial: 1. Best value: 0.182652:  25%|██▌       | 25/100 [01:25<03:33,  2.85s/it]Best trial: 1. Best value: 0.182652:  26%|██▌       | 26/100 [01:25<03:57,  3.21s/it]Best trial: 1. Best value: 0.182652:  26%|██▌       | 26/100 [01:29<03:57,  3.21s/it]Best trial: 1. Best value: 0.182652:  27%|██▋       | 27/100 [01:29<04:08,  3.41s/it]Best trial: 27. Best value: 0.188777:  27%|██▋       | 27/100 [01:32<04:08,  3.41s/it]Best trial: 27. Best value: 0.188777:  28%|██▊       | 28/100 [01:32<03:56,  3.28s/it]Best trial: 27. Best value: 0.188777:  28%|██▊       | 28/100 [01:36<03:56,  3.28s/it]Best trial: 27. Best value: 0.188777:  29%|██▉       | 29/100 [01:36<04:22,  3.70s/it]Best trial: 27. Best value: 0.188777:  29%|██▉       | 29/100 [01:39<04:22,  3.70s/it]Best trial: 27. Best value: 0.188777:  30%|███       | 30/100 [01:39<03:48,  3.26s/it]Best trial: 27. Best value: 0.188777:  30%|███       | 30/100 [01:42<03:48,  3.26s/it]Best trial: 27. Best value: 0.188777:  31%|███       | 31/100 [01:42<03:37,  3.16s/it]Best trial: 31. Best value: 0.189475:  31%|███       | 31/100 [01:45<03:37,  3.16s/it]Best trial: 31. Best value: 0.189475:  32%|███▏      | 32/100 [01:45<03:42,  3.28s/it]Best trial: 32. Best value: 0.191829:  32%|███▏      | 32/100 [01:49<03:42,  3.28s/it]Best trial: 32. Best value: 0.191829:  33%|███▎      | 33/100 [01:49<03:44,  3.35s/it]Best trial: 33. Best value: 0.19303:  33%|███▎      | 33/100 [01:51<03:44,  3.35s/it] Best trial: 33. Best value: 0.19303:  34%|███▍      | 34/100 [01:51<03:20,  3.04s/it]Best trial: 33. Best value: 0.19303:  34%|███▍      | 34/100 [01:54<03:20,  3.04s/it]Best trial: 33. Best value: 0.19303:  35%|███▌      | 35/100 [01:54<03:09,  2.92s/it]Best trial: 33. Best value: 0.19303:  35%|███▌      | 35/100 [01:56<03:09,  2.92s/it]Best trial: 33. Best value: 0.19303:  36%|███▌      | 36/100 [01:56<03:04,  2.88s/it]Best trial: 33. Best value: 0.19303:  36%|███▌      | 36/100 [01:58<03:04,  2.88s/it]Best trial: 33. Best value: 0.19303:  37%|███▋      | 37/100 [01:58<02:41,  2.56s/it]Best trial: 33. Best value: 0.19303:  37%|███▋      | 37/100 [02:01<02:41,  2.56s/it]Best trial: 33. Best value: 0.19303:  38%|███▊      | 38/100 [02:01<02:39,  2.58s/it]Best trial: 33. Best value: 0.19303:  38%|███▊      | 38/100 [02:04<02:39,  2.58s/it]Best trial: 33. Best value: 0.19303:  39%|███▉      | 39/100 [02:04<02:56,  2.90s/it]Best trial: 33. Best value: 0.19303:  39%|███▉      | 39/100 [02:06<02:56,  2.90s/it]Best trial: 33. Best value: 0.19303:  40%|████      | 40/100 [02:06<02:30,  2.51s/it]Best trial: 33. Best value: 0.19303:  40%|████      | 40/100 [02:09<02:30,  2.51s/it]Best trial: 33. Best value: 0.19303:  41%|████      | 41/100 [02:09<02:36,  2.65s/it]Best trial: 33. Best value: 0.19303:  41%|████      | 41/100 [02:12<02:36,  2.65s/it]Best trial: 33. Best value: 0.19303:  42%|████▏     | 42/100 [02:12<02:35,  2.69s/it]Best trial: 33. Best value: 0.19303:  42%|████▏     | 42/100 [02:16<02:35,  2.69s/it]Best trial: 33. Best value: 0.19303:  43%|████▎     | 43/100 [02:16<02:56,  3.10s/it]Best trial: 33. Best value: 0.19303:  43%|████▎     | 43/100 [02:19<02:56,  3.10s/it]Best trial: 33. Best value: 0.19303:  44%|████▍     | 44/100 [02:19<02:54,  3.12s/it]Best trial: 33. Best value: 0.19303:  44%|████▍     | 44/100 [02:22<02:54,  3.12s/it]Best trial: 33. Best value: 0.19303:  45%|████▌     | 45/100 [02:22<02:40,  2.92s/it]Best trial: 33. Best value: 0.19303:  45%|████▌     | 45/100 [02:23<02:40,  2.92s/it]Best trial: 33. Best value: 0.19303:  46%|████▌     | 46/100 [02:23<02:18,  2.56s/it]Best trial: 33. Best value: 0.19303:  46%|████▌     | 46/100 [02:25<02:18,  2.56s/it]Best trial: 33. Best value: 0.19303:  47%|████▋     | 47/100 [02:25<02:10,  2.46s/it]Best trial: 33. Best value: 0.19303:  47%|████▋     | 47/100 [02:27<02:10,  2.46s/it]Best trial: 33. Best value: 0.19303:  48%|████▊     | 48/100 [02:27<01:59,  2.29s/it]Best trial: 33. Best value: 0.19303:  48%|████▊     | 48/100 [02:30<01:59,  2.29s/it]Best trial: 33. Best value: 0.19303:  49%|████▉     | 49/100 [02:30<02:02,  2.39s/it]Best trial: 33. Best value: 0.19303:  49%|████▉     | 49/100 [02:32<02:02,  2.39s/it]Best trial: 33. Best value: 0.19303:  50%|█████     | 50/100 [02:32<01:59,  2.39s/it]Best trial: 33. Best value: 0.19303:  50%|█████     | 50/100 [02:35<01:59,  2.39s/it]Best trial: 33. Best value: 0.19303:  51%|█████     | 51/100 [02:35<02:00,  2.46s/it]Best trial: 51. Best value: 0.198062:  51%|█████     | 51/100 [02:37<02:00,  2.46s/it]Best trial: 51. Best value: 0.198062:  52%|█████▏    | 52/100 [02:37<01:56,  2.43s/it]Best trial: 51. Best value: 0.198062:  52%|█████▏    | 52/100 [02:41<01:56,  2.43s/it]Best trial: 51. Best value: 0.198062:  53%|█████▎    | 53/100 [02:41<02:04,  2.65s/it]Best trial: 51. Best value: 0.198062:  53%|█████▎    | 53/100 [02:43<02:04,  2.65s/it]Best trial: 51. Best value: 0.198062:  54%|█████▍    | 54/100 [02:43<02:05,  2.74s/it]Best trial: 51. Best value: 0.198062:  54%|█████▍    | 54/100 [02:46<02:05,  2.74s/it]Best trial: 51. Best value: 0.198062:  55%|█████▌    | 55/100 [02:46<01:57,  2.61s/it]Best trial: 51. Best value: 0.198062:  55%|█████▌    | 55/100 [02:48<01:57,  2.61s/it]Best trial: 51. Best value: 0.198062:  56%|█████▌    | 56/100 [02:48<01:46,  2.42s/it]Best trial: 51. Best value: 0.198062:  56%|█████▌    | 56/100 [02:51<01:46,  2.42s/it]Best trial: 51. Best value: 0.198062:  57%|█████▋    | 57/100 [02:51<01:52,  2.61s/it]Best trial: 51. Best value: 0.198062:  57%|█████▋    | 57/100 [02:55<01:52,  2.61s/it]Best trial: 51. Best value: 0.198062:  58%|█████▊    | 58/100 [02:55<02:04,  2.97s/it]Best trial: 51. Best value: 0.198062:  58%|█████▊    | 58/100 [02:58<02:04,  2.97s/it]Best trial: 51. Best value: 0.198062:  59%|█████▉    | 59/100 [02:58<02:02,  3.00s/it]Best trial: 51. Best value: 0.198062:  59%|█████▉    | 59/100 [03:00<02:02,  3.00s/it]Best trial: 51. Best value: 0.198062:  60%|██████    | 60/100 [03:00<01:48,  2.71s/it]Best trial: 51. Best value: 0.198062:  60%|██████    | 60/100 [03:02<01:48,  2.71s/it]Best trial: 51. Best value: 0.198062:  61%|██████    | 61/100 [03:02<01:44,  2.67s/it]Best trial: 51. Best value: 0.198062:  61%|██████    | 61/100 [03:05<01:44,  2.67s/it]Best trial: 51. Best value: 0.198062:  62%|██████▏   | 62/100 [03:05<01:37,  2.57s/it]Best trial: 51. Best value: 0.198062:  62%|██████▏   | 62/100 [03:07<01:37,  2.57s/it]Best trial: 51. Best value: 0.198062:  63%|██████▎   | 63/100 [03:07<01:38,  2.66s/it]Best trial: 51. Best value: 0.198062:  63%|██████▎   | 63/100 [03:10<01:38,  2.66s/it]Best trial: 51. Best value: 0.198062:  64%|██████▍   | 64/100 [03:10<01:33,  2.60s/it]Best trial: 51. Best value: 0.198062:  64%|██████▍   | 64/100 [03:12<01:33,  2.60s/it]Best trial: 51. Best value: 0.198062:  65%|██████▌   | 65/100 [03:12<01:26,  2.48s/it]Best trial: 51. Best value: 0.198062:  65%|██████▌   | 65/100 [03:16<01:26,  2.48s/it]Best trial: 51. Best value: 0.198062:  66%|██████▌   | 66/100 [03:16<01:39,  2.91s/it]Best trial: 51. Best value: 0.198062:  66%|██████▌   | 66/100 [03:19<01:39,  2.91s/it]Best trial: 51. Best value: 0.198062:  67%|██████▋   | 67/100 [03:19<01:31,  2.78s/it]Best trial: 51. Best value: 0.198062:  67%|██████▋   | 67/100 [03:21<01:31,  2.78s/it]Best trial: 51. Best value: 0.198062:  68%|██████▊   | 68/100 [03:21<01:26,  2.72s/it]Best trial: 51. Best value: 0.198062:  68%|██████▊   | 68/100 [03:24<01:26,  2.72s/it]Best trial: 51. Best value: 0.198062:  69%|██████▉   | 69/100 [03:24<01:24,  2.74s/it]Best trial: 51. Best value: 0.198062:  69%|██████▉   | 69/100 [03:26<01:24,  2.74s/it]Best trial: 51. Best value: 0.198062:  70%|███████   | 70/100 [03:26<01:18,  2.60s/it]Best trial: 51. Best value: 0.198062:  70%|███████   | 70/100 [03:28<01:18,  2.60s/it]Best trial: 51. Best value: 0.198062:  71%|███████   | 71/100 [03:28<01:10,  2.43s/it]Best trial: 51. Best value: 0.198062:  71%|███████   | 71/100 [03:30<01:10,  2.43s/it]Best trial: 51. Best value: 0.198062:  72%|███████▏  | 72/100 [03:30<01:03,  2.27s/it]Best trial: 51. Best value: 0.198062:  72%|███████▏  | 72/100 [03:32<01:03,  2.27s/it]Best trial: 51. Best value: 0.198062:  73%|███████▎  | 73/100 [03:32<01:01,  2.27s/it]Best trial: 51. Best value: 0.198062:  73%|███████▎  | 73/100 [03:35<01:01,  2.27s/it]Best trial: 51. Best value: 0.198062:  74%|███████▍  | 74/100 [03:35<01:01,  2.36s/it]Best trial: 51. Best value: 0.198062:  74%|███████▍  | 74/100 [03:37<01:01,  2.36s/it]Best trial: 51. Best value: 0.198062:  75%|███████▌  | 75/100 [03:37<00:58,  2.33s/it]Best trial: 51. Best value: 0.198062:  75%|███████▌  | 75/100 [03:40<00:58,  2.33s/it]Best trial: 51. Best value: 0.198062:  76%|███████▌  | 76/100 [03:40<00:58,  2.44s/it]Best trial: 51. Best value: 0.198062:  76%|███████▌  | 76/100 [03:43<00:58,  2.44s/it]Best trial: 51. Best value: 0.198062:  77%|███████▋  | 77/100 [03:43<00:58,  2.53s/it]Best trial: 51. Best value: 0.198062:  77%|███████▋  | 77/100 [03:46<00:58,  2.53s/it]Best trial: 51. Best value: 0.198062:  78%|███████▊  | 78/100 [03:46<01:00,  2.76s/it]Best trial: 51. Best value: 0.198062:  78%|███████▊  | 78/100 [03:49<01:00,  2.76s/it]Best trial: 51. Best value: 0.198062:  79%|███████▉  | 79/100 [03:49<01:00,  2.87s/it]Best trial: 51. Best value: 0.198062:  79%|███████▉  | 79/100 [03:51<01:00,  2.87s/it]Best trial: 51. Best value: 0.198062:  80%|████████  | 80/100 [03:51<00:53,  2.68s/it]Best trial: 80. Best value: 0.204454:  80%|████████  | 80/100 [03:54<00:53,  2.68s/it]Best trial: 80. Best value: 0.204454:  81%|████████  | 81/100 [03:54<00:48,  2.58s/it]Best trial: 80. Best value: 0.204454:  81%|████████  | 81/100 [03:57<00:48,  2.58s/it]Best trial: 80. Best value: 0.204454:  82%|████████▏ | 82/100 [03:57<00:48,  2.71s/it]Best trial: 82. Best value: 0.204752:  82%|████████▏ | 82/100 [03:59<00:48,  2.71s/it]Best trial: 82. Best value: 0.204752:  83%|████████▎ | 83/100 [03:59<00:42,  2.52s/it]Best trial: 82. Best value: 0.204752:  83%|████████▎ | 83/100 [04:02<00:42,  2.52s/it]Best trial: 82. Best value: 0.204752:  84%|████████▍ | 84/100 [04:02<00:42,  2.64s/it]Best trial: 84. Best value: 0.210358:  84%|████████▍ | 84/100 [04:05<00:42,  2.64s/it]Best trial: 84. Best value: 0.210358:  85%|████████▌ | 85/100 [04:05<00:43,  2.91s/it]Best trial: 84. Best value: 0.210358:  85%|████████▌ | 85/100 [04:08<00:43,  2.91s/it]Best trial: 84. Best value: 0.210358:  86%|████████▌ | 86/100 [04:08<00:39,  2.84s/it]Best trial: 84. Best value: 0.210358:  86%|████████▌ | 86/100 [04:10<00:39,  2.84s/it]Best trial: 84. Best value: 0.210358:  87%|████████▋ | 87/100 [04:10<00:35,  2.71s/it]Best trial: 84. Best value: 0.210358:  87%|████████▋ | 87/100 [04:13<00:35,  2.71s/it]Best trial: 84. Best value: 0.210358:  88%|████████▊ | 88/100 [04:13<00:33,  2.76s/it]Best trial: 84. Best value: 0.210358:  88%|████████▊ | 88/100 [04:16<00:33,  2.76s/it]Best trial: 84. Best value: 0.210358:  89%|████████▉ | 89/100 [04:16<00:31,  2.89s/it]Best trial: 84. Best value: 0.210358:  89%|████████▉ | 89/100 [04:19<00:31,  2.89s/it]Best trial: 84. Best value: 0.210358:  90%|█████████ | 90/100 [04:19<00:27,  2.72s/it]Best trial: 84. Best value: 0.210358:  90%|█████████ | 90/100 [04:22<00:27,  2.72s/it]Best trial: 84. Best value: 0.210358:  91%|█████████ | 91/100 [04:22<00:25,  2.89s/it]Best trial: 84. Best value: 0.210358:  91%|█████████ | 91/100 [04:26<00:25,  2.89s/it]Best trial: 84. Best value: 0.210358:  92%|█████████▏| 92/100 [04:26<00:25,  3.14s/it]Best trial: 84. Best value: 0.210358:  92%|█████████▏| 92/100 [04:28<00:25,  3.14s/it]Best trial: 84. Best value: 0.210358:  93%|█████████▎| 93/100 [04:28<00:19,  2.79s/it]Best trial: 93. Best value: 0.214209:  93%|█████████▎| 93/100 [04:30<00:19,  2.79s/it]Best trial: 93. Best value: 0.214209:  94%|█████████▍| 94/100 [04:30<00:16,  2.74s/it]Best trial: 93. Best value: 0.214209:  94%|█████████▍| 94/100 [04:33<00:16,  2.74s/it]Best trial: 93. Best value: 0.214209:  95%|█████████▌| 95/100 [04:33<00:13,  2.68s/it]Best trial: 93. Best value: 0.214209:  95%|█████████▌| 95/100 [04:35<00:13,  2.68s/it]Best trial: 93. Best value: 0.214209:  96%|█████████▌| 96/100 [04:35<00:10,  2.52s/it]Best trial: 93. Best value: 0.214209:  96%|█████████▌| 96/100 [04:38<00:10,  2.52s/it]Best trial: 93. Best value: 0.214209:  97%|█████████▋| 97/100 [04:38<00:08,  2.72s/it]Best trial: 93. Best value: 0.214209:  97%|█████████▋| 97/100 [04:41<00:08,  2.72s/it]Best trial: 93. Best value: 0.214209:  98%|█████████▊| 98/100 [04:41<00:05,  2.74s/it]Best trial: 93. Best value: 0.214209:  98%|█████████▊| 98/100 [04:43<00:05,  2.74s/it]Best trial: 93. Best value: 0.214209:  99%|█████████▉| 99/100 [04:43<00:02,  2.62s/it]Best trial: 93. Best value: 0.214209:  99%|█████████▉| 99/100 [04:45<00:02,  2.62s/it]Best trial: 93. Best value: 0.214209: 100%|██████████| 100/100 [04:45<00:00,  2.35s/it]Best trial: 93. Best value: 0.214209: 100%|██████████| 100/100 [04:45<00:00,  2.86s/it]
2025-11-30 07:03:43,484 - INFO - HPO Complete. Best AUPRC: 0.2142
2025-11-30 07:03:43,484 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.09061284926041009, 'max_depth': 4, 'subsample': 0.623051130107941, 'colsample_bytree': 0.6990729570304298, 'gamma': 2.6890537958041856, 'reg_lambda': 0.023490704371654906, 'reg_alpha': 0.6299359165127654}
2025-11-30 07:03:43,485 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:03:45,680 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 07:03:45,680 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:03:45,777 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 07:03:45,799 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:03:45,803 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 07:03:45,803 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:03:45,803 - INFO - Training model...
2025-11-30 07:03:47,832 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:03:52,811 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:03:52,811 - INFO - AUROC: 0.6881 (0.5719 - 0.7862)
2025-11-30 07:03:52,811 - INFO - AUPRC: 0.1735 (0.0932 - 0.2688)
2025-11-30 07:03:52,811 - INFO - Brier Score: 0.0529 (0.0421 - 0.0672)
2025-11-30 07:03:52,811 - INFO - Accuracy: 0.8931 (0.8645 - 0.9468)
2025-11-30 07:03:52,811 - INFO - Precision: 0.2121 (0.1377 - 0.5154)
2025-11-30 07:03:52,811 - INFO - Sensitivity (Recall): 0.3889 (0.1677 - 0.5319)
2025-11-30 07:03:52,811 - INFO - F1-Score: 0.2745 (0.1818 - 0.3629)
2025-11-30 07:03:52,812 - INFO - Best Threshold: 0.1700 (0.1300 - 0.5420)
2025-11-30 07:03:52,812 - INFO - Specificity: 0.9207 (0.8938 - 0.9857)
2025-11-30 07:03:52,828 - INFO - Calculating SHAP values...
2025-11-30 07:03:54,016 - INFO - SHAP plots saved.
2025-11-30 07:03:54,019 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:03:55,401 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 07:03:55,401 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:03:55,487 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 07:03:55,525 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:03:55,537 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 07:03:55,537 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.478833:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.478833:   1%|          | 1/100 [00:07<12:05,  7.33s/it]Best trial: 0. Best value: 0.478833:   1%|          | 1/100 [00:13<12:05,  7.33s/it]Best trial: 0. Best value: 0.478833:   2%|▏         | 2/100 [00:13<10:59,  6.73s/it]Best trial: 0. Best value: 0.478833:   2%|▏         | 2/100 [00:19<10:59,  6.73s/it]Best trial: 0. Best value: 0.478833:   3%|▎         | 3/100 [00:19<10:35,  6.55s/it]Best trial: 0. Best value: 0.478833:   3%|▎         | 3/100 [00:26<10:35,  6.55s/it]Best trial: 0. Best value: 0.478833:   4%|▍         | 4/100 [00:26<10:34,  6.61s/it]Best trial: 0. Best value: 0.478833:   4%|▍         | 4/100 [00:32<10:34,  6.61s/it]Best trial: 0. Best value: 0.478833:   5%|▌         | 5/100 [00:32<10:15,  6.48s/it]Best trial: 5. Best value: 0.496752:   5%|▌         | 5/100 [00:38<10:15,  6.48s/it]Best trial: 5. Best value: 0.496752:   6%|▌         | 6/100 [00:38<09:47,  6.25s/it]Best trial: 5. Best value: 0.496752:   6%|▌         | 6/100 [00:43<09:47,  6.25s/it]Best trial: 5. Best value: 0.496752:   7%|▋         | 7/100 [00:43<08:58,  5.79s/it]Best trial: 7. Best value: 0.499882:   7%|▋         | 7/100 [00:49<08:58,  5.79s/it]Best trial: 7. Best value: 0.499882:   8%|▊         | 8/100 [00:49<08:42,  5.68s/it]Best trial: 7. Best value: 0.499882:   8%|▊         | 8/100 [00:51<08:42,  5.68s/it]Best trial: 7. Best value: 0.499882:   9%|▉         | 9/100 [00:51<07:11,  4.74s/it]Best trial: 7. Best value: 0.499882:   9%|▉         | 9/100 [00:57<07:11,  4.74s/it]Best trial: 7. Best value: 0.499882:  10%|█         | 10/100 [00:57<07:32,  5.03s/it]Best trial: 7. Best value: 0.499882:  10%|█         | 10/100 [01:00<07:32,  5.03s/it]Best trial: 7. Best value: 0.499882:  11%|█         | 11/100 [01:00<06:31,  4.40s/it]Best trial: 7. Best value: 0.499882:  11%|█         | 11/100 [01:03<06:31,  4.40s/it]Best trial: 7. Best value: 0.499882:  12%|█▏        | 12/100 [01:03<05:55,  4.04s/it]Best trial: 12. Best value: 0.505092:  12%|█▏        | 12/100 [01:08<05:55,  4.04s/it]Best trial: 12. Best value: 0.505092:  13%|█▎        | 13/100 [01:08<06:11,  4.27s/it]Best trial: 12. Best value: 0.505092:  13%|█▎        | 13/100 [01:12<06:11,  4.27s/it]Best trial: 12. Best value: 0.505092:  14%|█▍        | 14/100 [01:12<05:59,  4.19s/it]Best trial: 12. Best value: 0.505092:  14%|█▍        | 14/100 [01:17<05:59,  4.19s/it]Best trial: 12. Best value: 0.505092:  15%|█▌        | 15/100 [01:17<06:15,  4.42s/it]Best trial: 12. Best value: 0.505092:  15%|█▌        | 15/100 [01:21<06:15,  4.42s/it]Best trial: 12. Best value: 0.505092:  16%|█▌        | 16/100 [01:21<05:59,  4.28s/it]Best trial: 12. Best value: 0.505092:  16%|█▌        | 16/100 [01:25<05:59,  4.28s/it]Best trial: 12. Best value: 0.505092:  17%|█▋        | 17/100 [01:25<06:02,  4.37s/it]Best trial: 12. Best value: 0.505092:  17%|█▋        | 17/100 [01:32<06:02,  4.37s/it]Best trial: 12. Best value: 0.505092:  18%|█▊        | 18/100 [01:32<06:48,  4.98s/it]Best trial: 12. Best value: 0.505092:  18%|█▊        | 18/100 [01:36<06:48,  4.98s/it]Best trial: 12. Best value: 0.505092:  19%|█▉        | 19/100 [01:36<06:30,  4.82s/it]Best trial: 12. Best value: 0.505092:  19%|█▉        | 19/100 [01:41<06:30,  4.82s/it]Best trial: 12. Best value: 0.505092:  20%|██        | 20/100 [01:41<06:23,  4.79s/it]Best trial: 20. Best value: 0.510052:  20%|██        | 20/100 [01:45<06:23,  4.79s/it]Best trial: 20. Best value: 0.510052:  21%|██        | 21/100 [01:45<06:09,  4.68s/it]Best trial: 20. Best value: 0.510052:  21%|██        | 21/100 [01:49<06:09,  4.68s/it]Best trial: 20. Best value: 0.510052:  22%|██▏       | 22/100 [01:49<05:50,  4.50s/it]Best trial: 22. Best value: 0.512308:  22%|██▏       | 22/100 [01:54<05:50,  4.50s/it]Best trial: 22. Best value: 0.512308:  23%|██▎       | 23/100 [01:54<05:49,  4.54s/it]Best trial: 22. Best value: 0.512308:  23%|██▎       | 23/100 [01:58<05:49,  4.54s/it]Best trial: 22. Best value: 0.512308:  24%|██▍       | 24/100 [01:58<05:34,  4.40s/it]Best trial: 22. Best value: 0.512308:  24%|██▍       | 24/100 [02:07<05:34,  4.40s/it]Best trial: 22. Best value: 0.512308:  25%|██▌       | 25/100 [02:07<07:00,  5.60s/it]Best trial: 22. Best value: 0.512308:  25%|██▌       | 25/100 [02:10<07:00,  5.60s/it]Best trial: 22. Best value: 0.512308:  26%|██▌       | 26/100 [02:10<06:04,  4.92s/it]Best trial: 22. Best value: 0.512308:  26%|██▌       | 26/100 [02:14<06:04,  4.92s/it]Best trial: 22. Best value: 0.512308:  27%|██▋       | 27/100 [02:14<05:35,  4.60s/it]Best trial: 22. Best value: 0.512308:  27%|██▋       | 27/100 [02:17<05:35,  4.60s/it]Best trial: 22. Best value: 0.512308:  28%|██▊       | 28/100 [02:17<05:08,  4.28s/it]Best trial: 22. Best value: 0.512308:  28%|██▊       | 28/100 [02:24<05:08,  4.28s/it]Best trial: 22. Best value: 0.512308:  29%|██▉       | 29/100 [02:24<06:04,  5.13s/it]Best trial: 22. Best value: 0.512308:  29%|██▉       | 29/100 [02:30<06:04,  5.13s/it]Best trial: 22. Best value: 0.512308:  30%|███       | 30/100 [02:30<06:17,  5.39s/it]Best trial: 22. Best value: 0.512308:  30%|███       | 30/100 [02:35<06:17,  5.39s/it]Best trial: 22. Best value: 0.512308:  31%|███       | 31/100 [02:35<06:05,  5.30s/it]Best trial: 22. Best value: 0.512308:  31%|███       | 31/100 [02:39<06:05,  5.30s/it]Best trial: 22. Best value: 0.512308:  32%|███▏      | 32/100 [02:39<05:31,  4.88s/it]Best trial: 22. Best value: 0.512308:  32%|███▏      | 32/100 [02:43<05:31,  4.88s/it]Best trial: 22. Best value: 0.512308:  33%|███▎      | 33/100 [02:43<05:07,  4.59s/it]Best trial: 22. Best value: 0.512308:  33%|███▎      | 33/100 [02:47<05:07,  4.59s/it]Best trial: 22. Best value: 0.512308:  34%|███▍      | 34/100 [02:47<04:48,  4.37s/it]Best trial: 22. Best value: 0.512308:  34%|███▍      | 34/100 [02:51<04:48,  4.37s/it]Best trial: 22. Best value: 0.512308:  35%|███▌      | 35/100 [02:51<04:34,  4.22s/it]Best trial: 22. Best value: 0.512308:  35%|███▌      | 35/100 [03:00<04:34,  4.22s/it]Best trial: 22. Best value: 0.512308:  36%|███▌      | 36/100 [03:00<05:58,  5.61s/it]Best trial: 22. Best value: 0.512308:  36%|███▌      | 36/100 [03:06<05:58,  5.61s/it]Best trial: 22. Best value: 0.512308:  37%|███▋      | 37/100 [03:06<05:54,  5.63s/it]Best trial: 22. Best value: 0.512308:  37%|███▋      | 37/100 [03:09<05:54,  5.63s/it]Best trial: 22. Best value: 0.512308:  38%|███▊      | 38/100 [03:09<05:08,  4.97s/it]Best trial: 22. Best value: 0.512308:  38%|███▊      | 38/100 [03:17<05:08,  4.97s/it]Best trial: 22. Best value: 0.512308:  39%|███▉      | 39/100 [03:17<05:51,  5.77s/it]Best trial: 22. Best value: 0.512308:  39%|███▉      | 39/100 [03:20<05:51,  5.77s/it]Best trial: 22. Best value: 0.512308:  40%|████      | 40/100 [03:20<05:11,  5.19s/it]Best trial: 22. Best value: 0.512308:  40%|████      | 40/100 [03:26<05:11,  5.19s/it]Best trial: 22. Best value: 0.512308:  41%|████      | 41/100 [03:26<05:07,  5.21s/it]Best trial: 22. Best value: 0.512308:  41%|████      | 41/100 [03:30<05:07,  5.21s/it]Best trial: 22. Best value: 0.512308:  42%|████▏     | 42/100 [03:30<04:45,  4.93s/it]Best trial: 22. Best value: 0.512308:  42%|████▏     | 42/100 [03:34<04:45,  4.93s/it]Best trial: 22. Best value: 0.512308:  43%|████▎     | 43/100 [03:34<04:25,  4.66s/it]Best trial: 22. Best value: 0.512308:  43%|████▎     | 43/100 [03:38<04:25,  4.66s/it]Best trial: 22. Best value: 0.512308:  44%|████▍     | 44/100 [03:38<04:03,  4.35s/it]Best trial: 22. Best value: 0.512308:  44%|████▍     | 44/100 [03:43<04:03,  4.35s/it]Best trial: 22. Best value: 0.512308:  45%|████▌     | 45/100 [03:43<04:20,  4.73s/it]Best trial: 22. Best value: 0.512308:  45%|████▌     | 45/100 [03:46<04:20,  4.73s/it]Best trial: 22. Best value: 0.512308:  46%|████▌     | 46/100 [03:46<03:47,  4.21s/it]Best trial: 22. Best value: 0.512308:  46%|████▌     | 46/100 [03:50<03:47,  4.21s/it]Best trial: 22. Best value: 0.512308:  47%|████▋     | 47/100 [03:50<03:29,  3.95s/it]Best trial: 22. Best value: 0.512308:  47%|████▋     | 47/100 [03:54<03:29,  3.95s/it]Best trial: 22. Best value: 0.512308:  48%|████▊     | 48/100 [03:54<03:29,  4.03s/it]Best trial: 22. Best value: 0.512308:  48%|████▊     | 48/100 [03:57<03:29,  4.03s/it]Best trial: 22. Best value: 0.512308:  49%|████▉     | 49/100 [03:57<03:13,  3.79s/it]Best trial: 22. Best value: 0.512308:  49%|████▉     | 49/100 [04:00<03:13,  3.79s/it]Best trial: 22. Best value: 0.512308:  50%|█████     | 50/100 [04:00<02:58,  3.57s/it]Best trial: 22. Best value: 0.512308:  50%|█████     | 50/100 [04:06<02:58,  3.57s/it]Best trial: 22. Best value: 0.512308:  51%|█████     | 51/100 [04:06<03:31,  4.31s/it]Best trial: 22. Best value: 0.512308:  51%|█████     | 51/100 [04:10<03:31,  4.31s/it]Best trial: 22. Best value: 0.512308:  52%|█████▏    | 52/100 [04:10<03:14,  4.05s/it]Best trial: 52. Best value: 0.514031:  52%|█████▏    | 52/100 [04:13<03:14,  4.05s/it]Best trial: 52. Best value: 0.514031:  53%|█████▎    | 53/100 [04:13<03:00,  3.85s/it]Best trial: 53. Best value: 0.514857:  53%|█████▎    | 53/100 [04:17<03:00,  3.85s/it]Best trial: 53. Best value: 0.514857:  54%|█████▍    | 54/100 [04:17<02:57,  3.86s/it]Best trial: 54. Best value: 0.514902:  54%|█████▍    | 54/100 [04:20<02:57,  3.86s/it]Best trial: 54. Best value: 0.514902:  55%|█████▌    | 55/100 [04:20<02:43,  3.63s/it]Best trial: 54. Best value: 0.514902:  55%|█████▌    | 55/100 [04:25<02:43,  3.63s/it]Best trial: 54. Best value: 0.514902:  56%|█████▌    | 56/100 [04:25<02:57,  4.03s/it]Best trial: 54. Best value: 0.514902:  56%|█████▌    | 56/100 [04:28<02:57,  4.03s/it]Best trial: 54. Best value: 0.514902:  57%|█████▋    | 57/100 [04:28<02:46,  3.87s/it]Best trial: 54. Best value: 0.514902:  57%|█████▋    | 57/100 [04:33<02:46,  3.87s/it]Best trial: 54. Best value: 0.514902:  58%|█████▊    | 58/100 [04:33<02:53,  4.13s/it]Best trial: 54. Best value: 0.514902:  58%|█████▊    | 58/100 [04:37<02:53,  4.13s/it]Best trial: 54. Best value: 0.514902:  59%|█████▉    | 59/100 [04:37<02:41,  3.93s/it]Best trial: 54. Best value: 0.514902:  59%|█████▉    | 59/100 [04:41<02:41,  3.93s/it]Best trial: 54. Best value: 0.514902:  60%|██████    | 60/100 [04:41<02:46,  4.17s/it]Best trial: 54. Best value: 0.514902:  60%|██████    | 60/100 [04:45<02:46,  4.17s/it]Best trial: 54. Best value: 0.514902:  61%|██████    | 61/100 [04:45<02:32,  3.90s/it]Best trial: 54. Best value: 0.514902:  61%|██████    | 61/100 [04:48<02:32,  3.90s/it]Best trial: 54. Best value: 0.514902:  62%|██████▏   | 62/100 [04:48<02:24,  3.81s/it]Best trial: 54. Best value: 0.514902:  62%|██████▏   | 62/100 [04:51<02:24,  3.81s/it]Best trial: 54. Best value: 0.514902:  63%|██████▎   | 63/100 [04:51<02:10,  3.53s/it]Best trial: 54. Best value: 0.514902:  63%|██████▎   | 63/100 [04:55<02:10,  3.53s/it]Best trial: 54. Best value: 0.514902:  64%|██████▍   | 64/100 [04:55<02:06,  3.50s/it]Best trial: 54. Best value: 0.514902:  64%|██████▍   | 64/100 [04:59<02:06,  3.50s/it]Best trial: 54. Best value: 0.514902:  65%|██████▌   | 65/100 [04:59<02:08,  3.68s/it]Best trial: 54. Best value: 0.514902:  65%|██████▌   | 65/100 [05:04<02:08,  3.68s/it]Best trial: 54. Best value: 0.514902:  66%|██████▌   | 66/100 [05:04<02:27,  4.34s/it]Best trial: 54. Best value: 0.514902:  66%|██████▌   | 66/100 [05:12<02:27,  4.34s/it]Best trial: 54. Best value: 0.514902:  67%|██████▋   | 67/100 [05:12<02:58,  5.40s/it]Best trial: 54. Best value: 0.514902:  67%|██████▋   | 67/100 [05:18<02:58,  5.40s/it]Best trial: 54. Best value: 0.514902:  68%|██████▊   | 68/100 [05:18<02:52,  5.38s/it]Best trial: 54. Best value: 0.514902:  68%|██████▊   | 68/100 [05:22<02:52,  5.38s/it]Best trial: 54. Best value: 0.514902:  69%|██████▉   | 69/100 [05:22<02:40,  5.16s/it]Best trial: 54. Best value: 0.514902:  69%|██████▉   | 69/100 [05:26<02:40,  5.16s/it]Best trial: 54. Best value: 0.514902:  70%|███████   | 70/100 [05:26<02:21,  4.71s/it]Best trial: 54. Best value: 0.514902:  70%|███████   | 70/100 [05:31<02:21,  4.71s/it]Best trial: 54. Best value: 0.514902:  71%|███████   | 71/100 [05:31<02:18,  4.79s/it]Best trial: 54. Best value: 0.514902:  71%|███████   | 71/100 [05:35<02:18,  4.79s/it]Best trial: 54. Best value: 0.514902:  72%|███████▏  | 72/100 [05:35<02:08,  4.60s/it]Best trial: 54. Best value: 0.514902:  72%|███████▏  | 72/100 [05:39<02:08,  4.60s/it]Best trial: 54. Best value: 0.514902:  73%|███████▎  | 73/100 [05:39<01:56,  4.31s/it]Best trial: 54. Best value: 0.514902:  73%|███████▎  | 73/100 [05:43<01:56,  4.31s/it]Best trial: 54. Best value: 0.514902:  74%|███████▍  | 74/100 [05:43<01:50,  4.26s/it]Best trial: 54. Best value: 0.514902:  74%|███████▍  | 74/100 [05:47<01:50,  4.26s/it]Best trial: 54. Best value: 0.514902:  75%|███████▌  | 75/100 [05:47<01:43,  4.13s/it]Best trial: 54. Best value: 0.514902:  75%|███████▌  | 75/100 [05:50<01:43,  4.13s/it]Best trial: 54. Best value: 0.514902:  76%|███████▌  | 76/100 [05:50<01:33,  3.89s/it]Best trial: 54. Best value: 0.514902:  76%|███████▌  | 76/100 [05:54<01:33,  3.89s/it]Best trial: 54. Best value: 0.514902:  77%|███████▋  | 77/100 [05:54<01:30,  3.93s/it]Best trial: 54. Best value: 0.514902:  77%|███████▋  | 77/100 [06:04<01:30,  3.93s/it]Best trial: 54. Best value: 0.514902:  78%|███████▊  | 78/100 [06:04<02:04,  5.67s/it]Best trial: 54. Best value: 0.514902:  78%|███████▊  | 78/100 [06:08<02:04,  5.67s/it]Best trial: 54. Best value: 0.514902:  79%|███████▉  | 79/100 [06:08<01:51,  5.30s/it]Best trial: 54. Best value: 0.514902:  79%|███████▉  | 79/100 [06:12<01:51,  5.30s/it]Best trial: 54. Best value: 0.514902:  80%|████████  | 80/100 [06:12<01:34,  4.72s/it]Best trial: 54. Best value: 0.514902:  80%|████████  | 80/100 [06:15<01:34,  4.72s/it]Best trial: 54. Best value: 0.514902:  81%|████████  | 81/100 [06:15<01:23,  4.38s/it]Best trial: 54. Best value: 0.514902:  81%|████████  | 81/100 [06:19<01:23,  4.38s/it]Best trial: 54. Best value: 0.514902:  82%|████████▏ | 82/100 [06:19<01:16,  4.26s/it]Best trial: 54. Best value: 0.514902:  82%|████████▏ | 82/100 [06:23<01:16,  4.26s/it]Best trial: 54. Best value: 0.514902:  83%|████████▎ | 83/100 [06:23<01:10,  4.15s/it]Best trial: 54. Best value: 0.514902:  83%|████████▎ | 83/100 [06:27<01:10,  4.15s/it]Best trial: 54. Best value: 0.514902:  84%|████████▍ | 84/100 [06:27<01:06,  4.14s/it]Best trial: 54. Best value: 0.514902:  84%|████████▍ | 84/100 [06:31<01:06,  4.14s/it]Best trial: 54. Best value: 0.514902:  85%|████████▌ | 85/100 [06:31<01:01,  4.13s/it]Best trial: 54. Best value: 0.514902:  85%|████████▌ | 85/100 [06:35<01:01,  4.13s/it]Best trial: 54. Best value: 0.514902:  86%|████████▌ | 86/100 [06:35<00:54,  3.87s/it]Best trial: 54. Best value: 0.514902:  86%|████████▌ | 86/100 [06:39<00:54,  3.87s/it]Best trial: 54. Best value: 0.514902:  87%|████████▋ | 87/100 [06:39<00:52,  4.07s/it]Best trial: 54. Best value: 0.514902:  87%|████████▋ | 87/100 [06:43<00:52,  4.07s/it]Best trial: 54. Best value: 0.514902:  88%|████████▊ | 88/100 [06:43<00:48,  4.01s/it]Best trial: 54. Best value: 0.514902:  88%|████████▊ | 88/100 [06:47<00:48,  4.01s/it]Best trial: 54. Best value: 0.514902:  89%|████████▉ | 89/100 [06:47<00:43,  4.00s/it]Best trial: 54. Best value: 0.514902:  89%|████████▉ | 89/100 [06:51<00:43,  4.00s/it]Best trial: 54. Best value: 0.514902:  90%|█████████ | 90/100 [06:51<00:40,  4.08s/it]Best trial: 54. Best value: 0.514902:  90%|█████████ | 90/100 [06:55<00:40,  4.08s/it]Best trial: 54. Best value: 0.514902:  91%|█████████ | 91/100 [06:55<00:34,  3.89s/it]Best trial: 54. Best value: 0.514902:  91%|█████████ | 91/100 [06:58<00:34,  3.89s/it]Best trial: 54. Best value: 0.514902:  92%|█████████▏| 92/100 [06:58<00:30,  3.78s/it]Best trial: 54. Best value: 0.514902:  92%|█████████▏| 92/100 [07:01<00:30,  3.78s/it]Best trial: 54. Best value: 0.514902:  93%|█████████▎| 93/100 [07:01<00:25,  3.60s/it]Best trial: 54. Best value: 0.514902:  93%|█████████▎| 93/100 [07:04<00:25,  3.60s/it]Best trial: 54. Best value: 0.514902:  94%|█████████▍| 94/100 [07:04<00:20,  3.43s/it]Best trial: 94. Best value: 0.515994:  94%|█████████▍| 94/100 [07:08<00:20,  3.43s/it]Best trial: 94. Best value: 0.515994:  95%|█████████▌| 95/100 [07:08<00:17,  3.55s/it]Best trial: 94. Best value: 0.515994:  95%|█████████▌| 95/100 [07:11<00:17,  3.55s/it]Best trial: 94. Best value: 0.515994:  96%|█████████▌| 96/100 [07:11<00:13,  3.40s/it]Best trial: 94. Best value: 0.515994:  96%|█████████▌| 96/100 [07:14<00:13,  3.40s/it]Best trial: 94. Best value: 0.515994:  97%|█████████▋| 97/100 [07:14<00:09,  3.33s/it]Best trial: 94. Best value: 0.515994:  97%|█████████▋| 97/100 [07:19<00:09,  3.33s/it]Best trial: 94. Best value: 0.515994:  98%|█████████▊| 98/100 [07:19<00:07,  3.69s/it]Best trial: 94. Best value: 0.515994:  98%|█████████▊| 98/100 [07:23<00:07,  3.69s/it]Best trial: 94. Best value: 0.515994:  99%|█████████▉| 99/100 [07:23<00:03,  3.77s/it]Best trial: 94. Best value: 0.515994:  99%|█████████▉| 99/100 [07:28<00:03,  3.77s/it]Best trial: 94. Best value: 0.515994: 100%|██████████| 100/100 [07:28<00:00,  4.07s/it]Best trial: 94. Best value: 0.515994: 100%|██████████| 100/100 [07:28<00:00,  4.48s/it]
2025-11-30 07:11:23,727 - INFO - HPO Complete. Best AUPRC: 0.5160
2025-11-30 07:11:23,727 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.00099018831428388, 'max_depth': 3, 'subsample': 0.6087724045369592, 'colsample_bytree': 0.7321415025251831, 'gamma': 1.4388099348944658, 'reg_lambda': 3.541783949084982e-05, 'reg_alpha': 9.356703114182324e-06}
2025-11-30 07:11:23,728 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:11:25,836 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 07:11:25,837 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:11:25,940 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 07:11:25,981 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:11:25,993 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 07:11:25,993 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:11:25,993 - INFO - Training model...
2025-11-30 07:11:28,610 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:11:34,319 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:11:34,319 - INFO - AUROC: 0.7953 (0.6932 - 0.8497)
2025-11-30 07:11:34,319 - INFO - AUPRC: 0.3851 (0.2866 - 0.5360)
2025-11-30 07:11:34,319 - INFO - Brier Score: 0.1796 (0.1769 - 0.1838)
2025-11-30 07:11:34,319 - INFO - Accuracy: 0.9538 (0.9049 - 0.9717)
2025-11-30 07:11:34,320 - INFO - Precision: 0.5769 (0.3218 - 0.9667)
2025-11-30 07:11:34,320 - INFO - Sensitivity (Recall): 0.4167 (0.2687 - 0.5616)
2025-11-30 07:11:34,320 - INFO - F1-Score: 0.4839 (0.3742 - 0.6363)
2025-11-30 07:11:34,320 - INFO - Best Threshold: 0.5400 (0.4800 - 0.6120)
2025-11-30 07:11:34,320 - INFO - Specificity: 0.9832 (0.9272 - 0.9991)
2025-11-30 07:11:34,333 - INFO - Calculating SHAP values...
2025-11-30 07:11:35,449 - INFO - SHAP plots saved.
2025-11-30 07:11:35,450 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:11:36,932 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 07:11:36,932 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:11:37,038 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 07:11:37,051 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:11:37,054 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:11:37,054 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.155005:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.155005:   1%|          | 1/100 [00:02<04:17,  2.60s/it]Best trial: 0. Best value: 0.155005:   1%|          | 1/100 [00:06<04:17,  2.60s/it]Best trial: 0. Best value: 0.155005:   2%|▏         | 2/100 [00:06<05:17,  3.24s/it]Best trial: 2. Best value: 0.193284:   2%|▏         | 2/100 [00:08<05:17,  3.24s/it]Best trial: 2. Best value: 0.193284:   3%|▎         | 3/100 [00:08<04:17,  2.66s/it]Best trial: 2. Best value: 0.193284:   3%|▎         | 3/100 [00:11<04:17,  2.66s/it]Best trial: 2. Best value: 0.193284:   4%|▍         | 4/100 [00:11<04:18,  2.69s/it]Best trial: 2. Best value: 0.193284:   4%|▍         | 4/100 [00:13<04:18,  2.69s/it]Best trial: 2. Best value: 0.193284:   5%|▌         | 5/100 [00:13<04:07,  2.61s/it]Best trial: 2. Best value: 0.193284:   5%|▌         | 5/100 [00:15<04:07,  2.61s/it]Best trial: 2. Best value: 0.193284:   6%|▌         | 6/100 [00:15<03:57,  2.52s/it]Best trial: 2. Best value: 0.193284:   6%|▌         | 6/100 [00:18<03:57,  2.52s/it]Best trial: 2. Best value: 0.193284:   7%|▋         | 7/100 [00:18<03:46,  2.43s/it]Best trial: 2. Best value: 0.193284:   7%|▋         | 7/100 [00:22<03:46,  2.43s/it]Best trial: 2. Best value: 0.193284:   8%|▊         | 8/100 [00:22<04:47,  3.13s/it]  > HPO FAILED. Skipping training.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:12:02,636 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 07:12:02,636 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:12:02,725 - INFO - Data loaded. Shape: (3453, 191)
2025-11-30 07:12:02,737 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:12:02,739 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:12:02,739 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]  > HPO FAILED. Skipping training.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
Starting Experiments...
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:19:32,395 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 07:19:32,395 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:19:32,476 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:19:32,495 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:19:32,499 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 07:19:32,499 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.508269:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.508269:   1%|          | 1/100 [00:02<04:47,  2.91s/it]Best trial: 0. Best value: 0.508269:   1%|          | 1/100 [00:07<04:47,  2.91s/it]Best trial: 0. Best value: 0.508269:   2%|▏         | 2/100 [00:07<05:54,  3.61s/it]Best trial: 2. Best value: 0.547977:   2%|▏         | 2/100 [00:12<05:54,  3.61s/it]Best trial: 2. Best value: 0.547977:   3%|▎         | 3/100 [00:12<07:01,  4.35s/it]Best trial: 2. Best value: 0.547977:   3%|▎         | 3/100 [00:13<07:01,  4.35s/it]Best trial: 2. Best value: 0.547977:   4%|▍         | 4/100 [00:13<05:10,  3.23s/it]Best trial: 2. Best value: 0.547977:   4%|▍         | 4/100 [00:15<05:10,  3.23s/it]Best trial: 2. Best value: 0.547977:   5%|▌         | 5/100 [00:15<04:26,  2.80s/it]Best trial: 2. Best value: 0.547977:   5%|▌         | 5/100 [00:18<04:26,  2.80s/it]Best trial: 2. Best value: 0.547977:   6%|▌         | 6/100 [00:18<04:12,  2.69s/it]Best trial: 2. Best value: 0.547977:   6%|▌         | 6/100 [00:21<04:12,  2.69s/it]Best trial: 2. Best value: 0.547977:   7%|▋         | 7/100 [00:21<04:31,  2.92s/it]Best trial: 2. Best value: 0.547977:   7%|▋         | 7/100 [00:24<04:31,  2.92s/it]Best trial: 2. Best value: 0.547977:   8%|▊         | 8/100 [00:24<04:22,  2.85s/it]Best trial: 2. Best value: 0.547977:   8%|▊         | 8/100 [00:27<04:22,  2.85s/it]Best trial: 2. Best value: 0.547977:   9%|▉         | 9/100 [00:27<04:14,  2.80s/it]Best trial: 2. Best value: 0.547977:   9%|▉         | 9/100 [00:28<04:14,  2.80s/it]Best trial: 2. Best value: 0.547977:  10%|█         | 10/100 [00:28<03:39,  2.43s/it]Best trial: 2. Best value: 0.547977:  10%|█         | 10/100 [00:33<03:39,  2.43s/it]Best trial: 2. Best value: 0.547977:  11%|█         | 11/100 [00:33<04:51,  3.28s/it]Best trial: 2. Best value: 0.547977:  11%|█         | 11/100 [00:35<04:51,  3.28s/it]Best trial: 2. Best value: 0.547977:  12%|█▏        | 12/100 [00:35<04:15,  2.90s/it]Best trial: 2. Best value: 0.547977:  12%|█▏        | 12/100 [00:37<04:15,  2.90s/it]Best trial: 2. Best value: 0.547977:  13%|█▎        | 13/100 [00:37<03:45,  2.59s/it]Best trial: 2. Best value: 0.547977:  13%|█▎        | 13/100 [00:40<03:45,  2.59s/it]Best trial: 2. Best value: 0.547977:  14%|█▍        | 14/100 [00:40<03:33,  2.48s/it]Best trial: 14. Best value: 0.554362:  14%|█▍        | 14/100 [00:45<03:33,  2.48s/it]Best trial: 14. Best value: 0.554362:  15%|█▌        | 15/100 [00:45<04:58,  3.51s/it]Best trial: 14. Best value: 0.554362:  15%|█▌        | 15/100 [00:51<04:58,  3.51s/it]Best trial: 14. Best value: 0.554362:  16%|█▌        | 16/100 [00:51<05:39,  4.04s/it]Best trial: 14. Best value: 0.554362:  16%|█▌        | 16/100 [00:56<05:39,  4.04s/it]Best trial: 14. Best value: 0.554362:  17%|█▋        | 17/100 [00:56<06:04,  4.39s/it]Best trial: 14. Best value: 0.554362:  17%|█▋        | 17/100 [00:59<06:04,  4.39s/it]Best trial: 14. Best value: 0.554362:  18%|█▊        | 18/100 [00:59<05:21,  3.93s/it]Best trial: 14. Best value: 0.554362:  18%|█▊        | 18/100 [01:02<05:21,  3.93s/it]Best trial: 14. Best value: 0.554362:  19%|█▉        | 19/100 [01:02<05:08,  3.81s/it]Best trial: 14. Best value: 0.554362:  19%|█▉        | 19/100 [01:05<05:08,  3.81s/it]Best trial: 14. Best value: 0.554362:  20%|██        | 20/100 [01:05<04:34,  3.43s/it]Best trial: 14. Best value: 0.554362:  20%|██        | 20/100 [01:07<04:34,  3.43s/it]Best trial: 14. Best value: 0.554362:  21%|██        | 21/100 [01:07<03:58,  3.02s/it]Best trial: 14. Best value: 0.554362:  21%|██        | 21/100 [01:12<03:58,  3.02s/it]Best trial: 14. Best value: 0.554362:  22%|██▏       | 22/100 [01:12<04:48,  3.70s/it]Best trial: 14. Best value: 0.554362:  22%|██▏       | 22/100 [01:15<04:48,  3.70s/it]Best trial: 14. Best value: 0.554362:  23%|██▎       | 23/100 [01:15<04:33,  3.55s/it]Best trial: 14. Best value: 0.554362:  23%|██▎       | 23/100 [01:19<04:33,  3.55s/it]Best trial: 14. Best value: 0.554362:  24%|██▍       | 24/100 [01:19<04:35,  3.63s/it]Best trial: 14. Best value: 0.554362:  24%|██▍       | 24/100 [01:23<04:35,  3.63s/it]Best trial: 14. Best value: 0.554362:  25%|██▌       | 25/100 [01:23<04:26,  3.55s/it]Best trial: 14. Best value: 0.554362:  25%|██▌       | 25/100 [01:26<04:26,  3.55s/it]Best trial: 14. Best value: 0.554362:  26%|██▌       | 26/100 [01:26<04:30,  3.65s/it]Best trial: 14. Best value: 0.554362:  26%|██▌       | 26/100 [01:30<04:30,  3.65s/it]Best trial: 14. Best value: 0.554362:  27%|██▋       | 27/100 [01:30<04:32,  3.74s/it]Best trial: 14. Best value: 0.554362:  27%|██▋       | 27/100 [01:33<04:32,  3.74s/it]Best trial: 14. Best value: 0.554362:  28%|██▊       | 28/100 [01:33<04:04,  3.40s/it]Best trial: 14. Best value: 0.554362:  28%|██▊       | 28/100 [01:35<04:04,  3.40s/it]Best trial: 14. Best value: 0.554362:  29%|██▉       | 29/100 [01:35<03:41,  3.12s/it]Best trial: 14. Best value: 0.554362:  29%|██▉       | 29/100 [01:38<03:41,  3.12s/it]Best trial: 14. Best value: 0.554362:  30%|███       | 30/100 [01:38<03:33,  3.05s/it]Best trial: 14. Best value: 0.554362:  30%|███       | 30/100 [01:41<03:33,  3.05s/it]Best trial: 14. Best value: 0.554362:  31%|███       | 31/100 [01:41<03:28,  3.03s/it]Best trial: 14. Best value: 0.554362:  31%|███       | 31/100 [01:44<03:28,  3.03s/it]Best trial: 14. Best value: 0.554362:  32%|███▏      | 32/100 [01:44<03:28,  3.06s/it]Best trial: 14. Best value: 0.554362:  32%|███▏      | 32/100 [01:47<03:28,  3.06s/it]Best trial: 14. Best value: 0.554362:  33%|███▎      | 33/100 [01:47<03:14,  2.90s/it]Best trial: 14. Best value: 0.554362:  33%|███▎      | 33/100 [01:50<03:14,  2.90s/it]Best trial: 14. Best value: 0.554362:  34%|███▍      | 34/100 [01:50<03:22,  3.06s/it]Best trial: 14. Best value: 0.554362:  34%|███▍      | 34/100 [01:53<03:22,  3.06s/it]Best trial: 14. Best value: 0.554362:  35%|███▌      | 35/100 [01:53<03:15,  3.01s/it]Best trial: 14. Best value: 0.554362:  35%|███▌      | 35/100 [01:55<03:15,  3.01s/it]Best trial: 14. Best value: 0.554362:  36%|███▌      | 36/100 [01:55<02:51,  2.69s/it]Best trial: 14. Best value: 0.554362:  36%|███▌      | 36/100 [02:00<02:51,  2.69s/it]Best trial: 14. Best value: 0.554362:  37%|███▋      | 37/100 [02:00<03:26,  3.27s/it]Best trial: 14. Best value: 0.554362:  37%|███▋      | 37/100 [02:03<03:26,  3.27s/it]Best trial: 14. Best value: 0.554362:  38%|███▊      | 38/100 [02:03<03:15,  3.15s/it]Best trial: 14. Best value: 0.554362:  38%|███▊      | 38/100 [02:06<03:15,  3.15s/it]Best trial: 14. Best value: 0.554362:  39%|███▉      | 39/100 [02:06<03:08,  3.09s/it]Best trial: 14. Best value: 0.554362:  39%|███▉      | 39/100 [02:09<03:08,  3.09s/it]Best trial: 14. Best value: 0.554362:  40%|████      | 40/100 [02:09<03:10,  3.17s/it]Best trial: 14. Best value: 0.554362:  40%|████      | 40/100 [02:14<03:10,  3.17s/it]Best trial: 14. Best value: 0.554362:  41%|████      | 41/100 [02:14<03:44,  3.80s/it]Best trial: 14. Best value: 0.554362:  41%|████      | 41/100 [02:17<03:44,  3.80s/it]Best trial: 14. Best value: 0.554362:  42%|████▏     | 42/100 [02:17<03:25,  3.54s/it]Best trial: 14. Best value: 0.554362:  42%|████▏     | 42/100 [02:20<03:25,  3.54s/it]Best trial: 14. Best value: 0.554362:  43%|████▎     | 43/100 [02:20<03:15,  3.42s/it]Best trial: 14. Best value: 0.554362:  43%|████▎     | 43/100 [02:24<03:15,  3.42s/it]Best trial: 14. Best value: 0.554362:  44%|████▍     | 44/100 [02:24<03:17,  3.53s/it]Best trial: 14. Best value: 0.554362:  44%|████▍     | 44/100 [02:28<03:17,  3.53s/it]Best trial: 14. Best value: 0.554362:  45%|████▌     | 45/100 [02:28<03:11,  3.49s/it]Best trial: 14. Best value: 0.554362:  45%|████▌     | 45/100 [02:30<03:11,  3.49s/it]Best trial: 14. Best value: 0.554362:  46%|████▌     | 46/100 [02:30<02:50,  3.16s/it]Best trial: 14. Best value: 0.554362:  46%|████▌     | 46/100 [02:33<02:50,  3.16s/it]Best trial: 14. Best value: 0.554362:  47%|████▋     | 47/100 [02:33<02:42,  3.07s/it]Best trial: 14. Best value: 0.554362:  47%|████▋     | 47/100 [02:35<02:42,  3.07s/it]Best trial: 14. Best value: 0.554362:  48%|████▊     | 48/100 [02:35<02:32,  2.94s/it]Best trial: 14. Best value: 0.554362:  48%|████▊     | 48/100 [02:40<02:32,  2.94s/it]Best trial: 14. Best value: 0.554362:  49%|████▉     | 49/100 [02:40<02:52,  3.38s/it]Best trial: 14. Best value: 0.554362:  49%|████▉     | 49/100 [02:44<02:52,  3.38s/it]Best trial: 14. Best value: 0.554362:  50%|█████     | 50/100 [02:44<02:54,  3.48s/it]Best trial: 14. Best value: 0.554362:  50%|█████     | 50/100 [02:46<02:54,  3.48s/it]Best trial: 14. Best value: 0.554362:  51%|█████     | 51/100 [02:46<02:32,  3.11s/it]Best trial: 14. Best value: 0.554362:  51%|█████     | 51/100 [02:50<02:32,  3.11s/it]Best trial: 14. Best value: 0.554362:  52%|█████▏    | 52/100 [02:50<02:37,  3.29s/it]Best trial: 14. Best value: 0.554362:  52%|█████▏    | 52/100 [02:55<02:37,  3.29s/it]Best trial: 14. Best value: 0.554362:  53%|█████▎    | 53/100 [02:55<03:01,  3.85s/it]Best trial: 14. Best value: 0.554362:  53%|█████▎    | 53/100 [02:59<03:01,  3.85s/it]Best trial: 14. Best value: 0.554362:  54%|█████▍    | 54/100 [02:59<03:05,  4.03s/it]Best trial: 14. Best value: 0.554362:  54%|█████▍    | 54/100 [03:03<03:05,  4.03s/it]Best trial: 14. Best value: 0.554362:  55%|█████▌    | 55/100 [03:03<03:05,  4.13s/it]Best trial: 55. Best value: 0.558534:  55%|█████▌    | 55/100 [03:07<03:05,  4.13s/it]Best trial: 55. Best value: 0.558534:  56%|█████▌    | 56/100 [03:07<02:58,  4.06s/it]Best trial: 55. Best value: 0.558534:  56%|█████▌    | 56/100 [03:11<02:58,  4.06s/it]Best trial: 55. Best value: 0.558534:  57%|█████▋    | 57/100 [03:11<02:55,  4.07s/it]Best trial: 55. Best value: 0.558534:  57%|█████▋    | 57/100 [03:14<02:55,  4.07s/it]Best trial: 55. Best value: 0.558534:  58%|█████▊    | 58/100 [03:14<02:35,  3.71s/it]Best trial: 55. Best value: 0.558534:  58%|█████▊    | 58/100 [03:17<02:35,  3.71s/it]Best trial: 55. Best value: 0.558534:  59%|█████▉    | 59/100 [03:17<02:15,  3.29s/it]Best trial: 55. Best value: 0.558534:  59%|█████▉    | 59/100 [03:20<02:15,  3.29s/it]Best trial: 55. Best value: 0.558534:  60%|██████    | 60/100 [03:20<02:17,  3.43s/it]Best trial: 55. Best value: 0.558534:  60%|██████    | 60/100 [03:24<02:17,  3.43s/it]Best trial: 55. Best value: 0.558534:  61%|██████    | 61/100 [03:24<02:19,  3.58s/it]Best trial: 55. Best value: 0.558534:  61%|██████    | 61/100 [03:28<02:19,  3.58s/it]Best trial: 55. Best value: 0.558534:  62%|██████▏   | 62/100 [03:28<02:18,  3.64s/it]Best trial: 55. Best value: 0.558534:  62%|██████▏   | 62/100 [03:31<02:18,  3.64s/it]Best trial: 55. Best value: 0.558534:  63%|██████▎   | 63/100 [03:31<02:06,  3.41s/it]Best trial: 55. Best value: 0.558534:  63%|██████▎   | 63/100 [03:34<02:06,  3.41s/it]Best trial: 55. Best value: 0.558534:  64%|██████▍   | 64/100 [03:34<02:02,  3.40s/it]Best trial: 55. Best value: 0.558534:  64%|██████▍   | 64/100 [03:38<02:02,  3.40s/it]Best trial: 55. Best value: 0.558534:  65%|██████▌   | 65/100 [03:38<01:58,  3.40s/it]Best trial: 55. Best value: 0.558534:  65%|██████▌   | 65/100 [03:42<01:58,  3.40s/it]Best trial: 55. Best value: 0.558534:  66%|██████▌   | 66/100 [03:42<02:03,  3.64s/it]Best trial: 55. Best value: 0.558534:  66%|██████▌   | 66/100 [03:46<02:03,  3.64s/it]Best trial: 55. Best value: 0.558534:  67%|██████▋   | 67/100 [03:46<02:01,  3.67s/it]Best trial: 55. Best value: 0.558534:  67%|██████▋   | 67/100 [03:48<02:01,  3.67s/it]Best trial: 55. Best value: 0.558534:  68%|██████▊   | 68/100 [03:48<01:46,  3.34s/it]Best trial: 55. Best value: 0.558534:  68%|██████▊   | 68/100 [03:51<01:46,  3.34s/it]Best trial: 55. Best value: 0.558534:  69%|██████▉   | 69/100 [03:51<01:35,  3.08s/it]Best trial: 55. Best value: 0.558534:  69%|██████▉   | 69/100 [03:54<01:35,  3.08s/it]Best trial: 55. Best value: 0.558534:  70%|███████   | 70/100 [03:54<01:32,  3.09s/it]Best trial: 55. Best value: 0.558534:  70%|███████   | 70/100 [03:58<01:32,  3.09s/it]Best trial: 55. Best value: 0.558534:  71%|███████   | 71/100 [03:58<01:35,  3.30s/it]Best trial: 55. Best value: 0.558534:  71%|███████   | 71/100 [04:01<01:35,  3.30s/it]Best trial: 55. Best value: 0.558534:  72%|███████▏  | 72/100 [04:01<01:30,  3.24s/it]Best trial: 55. Best value: 0.558534:  72%|███████▏  | 72/100 [04:05<01:30,  3.24s/it]Best trial: 55. Best value: 0.558534:  73%|███████▎  | 73/100 [04:05<01:33,  3.47s/it]Best trial: 55. Best value: 0.558534:  73%|███████▎  | 73/100 [04:08<01:33,  3.47s/it]Best trial: 55. Best value: 0.558534:  74%|███████▍  | 74/100 [04:08<01:25,  3.29s/it]Best trial: 55. Best value: 0.558534:  74%|███████▍  | 74/100 [04:10<01:25,  3.29s/it]Best trial: 55. Best value: 0.558534:  75%|███████▌  | 75/100 [04:10<01:17,  3.12s/it]Best trial: 55. Best value: 0.558534:  75%|███████▌  | 75/100 [04:13<01:17,  3.12s/it]Best trial: 55. Best value: 0.558534:  76%|███████▌  | 76/100 [04:13<01:12,  3.01s/it]Best trial: 55. Best value: 0.558534:  76%|███████▌  | 76/100 [04:18<01:12,  3.01s/it]Best trial: 55. Best value: 0.558534:  77%|███████▋  | 77/100 [04:18<01:25,  3.71s/it]Best trial: 55. Best value: 0.558534:  77%|███████▋  | 77/100 [04:22<01:25,  3.71s/it]Best trial: 55. Best value: 0.558534:  78%|███████▊  | 78/100 [04:22<01:21,  3.70s/it]Best trial: 55. Best value: 0.558534:  78%|███████▊  | 78/100 [04:26<01:21,  3.70s/it]Best trial: 55. Best value: 0.558534:  79%|███████▉  | 79/100 [04:26<01:20,  3.85s/it]Best trial: 55. Best value: 0.558534:  79%|███████▉  | 79/100 [04:33<01:20,  3.85s/it]Best trial: 55. Best value: 0.558534:  80%|████████  | 80/100 [04:33<01:34,  4.73s/it]Best trial: 55. Best value: 0.558534:  80%|████████  | 80/100 [04:37<01:34,  4.73s/it]Best trial: 55. Best value: 0.558534:  81%|████████  | 81/100 [04:37<01:23,  4.39s/it]Best trial: 55. Best value: 0.558534:  81%|████████  | 81/100 [04:42<01:23,  4.39s/it]Best trial: 55. Best value: 0.558534:  82%|████████▏ | 82/100 [04:42<01:23,  4.64s/it]Best trial: 55. Best value: 0.558534:  82%|████████▏ | 82/100 [04:46<01:23,  4.64s/it]Best trial: 55. Best value: 0.558534:  83%|████████▎ | 83/100 [04:46<01:17,  4.58s/it]Best trial: 55. Best value: 0.558534:  83%|████████▎ | 83/100 [04:51<01:17,  4.58s/it]Best trial: 55. Best value: 0.558534:  84%|████████▍ | 84/100 [04:51<01:13,  4.57s/it]Best trial: 55. Best value: 0.558534:  84%|████████▍ | 84/100 [04:55<01:13,  4.57s/it]Best trial: 55. Best value: 0.558534:  85%|████████▌ | 85/100 [04:55<01:05,  4.39s/it]Best trial: 55. Best value: 0.558534:  85%|████████▌ | 85/100 [04:58<01:05,  4.39s/it]Best trial: 55. Best value: 0.558534:  86%|████████▌ | 86/100 [04:58<00:57,  4.09s/it]Best trial: 55. Best value: 0.558534:  86%|████████▌ | 86/100 [05:02<00:57,  4.09s/it]Best trial: 55. Best value: 0.558534:  87%|████████▋ | 87/100 [05:02<00:52,  4.02s/it]Best trial: 55. Best value: 0.558534:  87%|████████▋ | 87/100 [05:07<00:52,  4.02s/it]Best trial: 55. Best value: 0.558534:  88%|████████▊ | 88/100 [05:07<00:51,  4.32s/it]Best trial: 88. Best value: 0.559794:  88%|████████▊ | 88/100 [05:11<00:51,  4.32s/it]Best trial: 88. Best value: 0.559794:  89%|████████▉ | 89/100 [05:11<00:45,  4.14s/it]Best trial: 88. Best value: 0.559794:  89%|████████▉ | 89/100 [05:15<00:45,  4.14s/it]Best trial: 88. Best value: 0.559794:  90%|█████████ | 90/100 [05:15<00:40,  4.01s/it]Best trial: 88. Best value: 0.559794:  90%|█████████ | 90/100 [05:20<00:40,  4.01s/it]Best trial: 88. Best value: 0.559794:  91%|█████████ | 91/100 [05:20<00:39,  4.37s/it]Best trial: 88. Best value: 0.559794:  91%|█████████ | 91/100 [05:23<00:39,  4.37s/it]Best trial: 88. Best value: 0.559794:  92%|█████████▏| 92/100 [05:23<00:32,  4.07s/it]Best trial: 88. Best value: 0.559794:  92%|█████████▏| 92/100 [05:26<00:32,  4.07s/it]Best trial: 88. Best value: 0.559794:  93%|█████████▎| 93/100 [05:26<00:26,  3.78s/it]Best trial: 88. Best value: 0.559794:  93%|█████████▎| 93/100 [05:29<00:26,  3.78s/it]Best trial: 88. Best value: 0.559794:  94%|█████████▍| 94/100 [05:29<00:20,  3.42s/it]Best trial: 88. Best value: 0.559794:  94%|█████████▍| 94/100 [05:32<00:20,  3.42s/it]Best trial: 88. Best value: 0.559794:  95%|█████████▌| 95/100 [05:32<00:16,  3.39s/it]Best trial: 88. Best value: 0.559794:  95%|█████████▌| 95/100 [05:36<00:16,  3.39s/it]Best trial: 88. Best value: 0.559794:  96%|█████████▌| 96/100 [05:36<00:13,  3.43s/it]Best trial: 88. Best value: 0.559794:  96%|█████████▌| 96/100 [05:39<00:13,  3.43s/it]Best trial: 88. Best value: 0.559794:  97%|█████████▋| 97/100 [05:39<00:10,  3.46s/it]Best trial: 88. Best value: 0.559794:  97%|█████████▋| 97/100 [05:42<00:10,  3.46s/it]Best trial: 88. Best value: 0.559794:  98%|█████████▊| 98/100 [05:42<00:06,  3.31s/it]Best trial: 88. Best value: 0.559794:  98%|█████████▊| 98/100 [05:46<00:06,  3.31s/it]Best trial: 88. Best value: 0.559794:  99%|█████████▉| 99/100 [05:46<00:03,  3.58s/it]Best trial: 88. Best value: 0.559794:  99%|█████████▉| 99/100 [05:52<00:03,  3.58s/it]Best trial: 88. Best value: 0.559794: 100%|██████████| 100/100 [05:52<00:00,  4.08s/it]Best trial: 88. Best value: 0.559794: 100%|██████████| 100/100 [05:52<00:00,  3.52s/it]
2025-11-30 07:25:24,652 - INFO - HPO Complete. Best AUPRC: 0.5598
2025-11-30 07:25:24,653 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.05444080173953758, 'max_depth': 8, 'subsample': 0.6096419352777968, 'colsample_bytree': 0.9483711864144633, 'gamma': 2.9070292369957116, 'reg_lambda': 0.03323349897949928, 'reg_alpha': 0.7581760248873117}
2025-11-30 07:25:24,654 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:25:26,552 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 07:25:26,553 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:25:26,643 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:25:26,660 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:25:26,665 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 07:25:26,665 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:25:26,665 - INFO - Training model...
2025-11-30 07:25:27,973 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:25:33,030 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:25:33,030 - INFO - AUROC: 0.7857 (0.6925 - 0.8467)
2025-11-30 07:25:33,030 - INFO - AUPRC: 0.3566 (0.1878 - 0.5331)
2025-11-30 07:25:33,030 - INFO - Brier Score: 0.0501 (0.0397 - 0.0639)
2025-11-30 07:25:33,030 - INFO - Accuracy: 0.9566 (0.8916 - 0.9708)
2025-11-30 07:25:33,030 - INFO - Precision: 0.7143 (0.2685 - 0.9349)
2025-11-30 07:25:33,030 - INFO - Sensitivity (Recall): 0.2778 (0.2029 - 0.5250)
2025-11-30 07:25:33,030 - INFO - F1-Score: 0.4000 (0.2642 - 0.5895)
2025-11-30 07:25:33,030 - INFO - Best Threshold: 0.8700 (0.1960 - 0.8700)
2025-11-30 07:25:33,030 - INFO - Specificity: 0.9939 (0.9110 - 0.9985)
2025-11-30 07:25:33,045 - INFO - Calculating SHAP values...
2025-11-30 07:25:34,089 - INFO - SHAP plots saved.
2025-11-30 07:25:34,091 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:25:35,306 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 07:25:35,306 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:25:35,391 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:25:35,399 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:25:35,401 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:25:35,401 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.117239:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.117239:   1%|          | 1/100 [00:01<01:45,  1.07s/it]Best trial: 0. Best value: 0.117239:   1%|          | 1/100 [00:02<01:45,  1.07s/it]Best trial: 0. Best value: 0.117239:   2%|▏         | 2/100 [00:02<01:45,  1.07s/it]Best trial: 0. Best value: 0.117239:   2%|▏         | 2/100 [00:02<01:45,  1.07s/it]Best trial: 0. Best value: 0.117239:   3%|▎         | 3/100 [00:02<01:32,  1.05it/s]Best trial: 0. Best value: 0.117239:   3%|▎         | 3/100 [00:03<01:32,  1.05it/s]Best trial: 0. Best value: 0.117239:   4%|▍         | 4/100 [00:03<01:22,  1.17it/s]Best trial: 0. Best value: 0.117239:   4%|▍         | 4/100 [00:05<01:22,  1.17it/s]Best trial: 0. Best value: 0.117239:   5%|▌         | 5/100 [00:05<01:39,  1.05s/it]Best trial: 5. Best value: 0.12419:   5%|▌         | 5/100 [00:05<01:39,  1.05s/it] Best trial: 5. Best value: 0.12419:   6%|▌         | 6/100 [00:05<01:27,  1.07it/s]Best trial: 5. Best value: 0.12419:   6%|▌         | 6/100 [00:07<01:27,  1.07it/s]Best trial: 5. Best value: 0.12419:   7%|▋         | 7/100 [00:07<01:52,  1.21s/it]Best trial: 5. Best value: 0.12419:   7%|▋         | 7/100 [00:09<01:52,  1.21s/it]Best trial: 5. Best value: 0.12419:   8%|▊         | 8/100 [00:09<01:59,  1.30s/it]Best trial: 5. Best value: 0.12419:   8%|▊         | 8/100 [00:09<01:59,  1.30s/it]Best trial: 5. Best value: 0.12419:   9%|▉         | 9/100 [00:09<01:38,  1.09s/it]Best trial: 5. Best value: 0.12419:   9%|▉         | 9/100 [00:10<01:38,  1.09s/it]Best trial: 5. Best value: 0.12419:  10%|█         | 10/100 [00:10<01:28,  1.01it/s]Best trial: 5. Best value: 0.12419:  10%|█         | 10/100 [00:11<01:28,  1.01it/s]Best trial: 5. Best value: 0.12419:  11%|█         | 11/100 [00:11<01:31,  1.03s/it]Best trial: 5. Best value: 0.12419:  11%|█         | 11/100 [00:12<01:31,  1.03s/it]Best trial: 5. Best value: 0.12419:  12%|█▏        | 12/100 [00:12<01:37,  1.11s/it]Best trial: 5. Best value: 0.12419:  12%|█▏        | 12/100 [00:14<01:37,  1.11s/it]Best trial: 5. Best value: 0.12419:  13%|█▎        | 13/100 [00:14<02:02,  1.41s/it]Best trial: 13. Best value: 0.130137:  13%|█▎        | 13/100 [00:15<02:02,  1.41s/it]Best trial: 13. Best value: 0.130137:  14%|█▍        | 14/100 [00:15<01:47,  1.25s/it]Best trial: 13. Best value: 0.130137:  14%|█▍        | 14/100 [00:17<01:47,  1.25s/it]Best trial: 13. Best value: 0.130137:  15%|█▌        | 15/100 [00:17<01:48,  1.28s/it]Best trial: 13. Best value: 0.130137:  15%|█▌        | 15/100 [00:17<01:48,  1.28s/it]Best trial: 13. Best value: 0.130137:  16%|█▌        | 16/100 [00:17<01:34,  1.13s/it]Best trial: 16. Best value: 0.132526:  16%|█▌        | 16/100 [00:18<01:34,  1.13s/it]Best trial: 16. Best value: 0.132526:  17%|█▋        | 17/100 [00:18<01:28,  1.06s/it]Best trial: 16. Best value: 0.132526:  17%|█▋        | 17/100 [00:20<01:28,  1.06s/it]Best trial: 16. Best value: 0.132526:  18%|█▊        | 18/100 [00:20<01:42,  1.25s/it]Best trial: 16. Best value: 0.132526:  18%|█▊        | 18/100 [00:22<01:42,  1.25s/it]Best trial: 16. Best value: 0.132526:  19%|█▉        | 19/100 [00:22<02:09,  1.59s/it]Best trial: 16. Best value: 0.132526:  19%|█▉        | 19/100 [00:23<02:09,  1.59s/it]Best trial: 16. Best value: 0.132526:  20%|██        | 20/100 [00:23<01:54,  1.43s/it]Best trial: 16. Best value: 0.132526:  20%|██        | 20/100 [00:25<01:54,  1.43s/it]Best trial: 16. Best value: 0.132526:  21%|██        | 21/100 [00:25<01:56,  1.48s/it]Best trial: 21. Best value: 0.138856:  21%|██        | 21/100 [00:26<01:56,  1.48s/it]Best trial: 21. Best value: 0.138856:  22%|██▏       | 22/100 [00:26<01:45,  1.35s/it]Best trial: 21. Best value: 0.138856:  22%|██▏       | 22/100 [00:27<01:45,  1.35s/it]Best trial: 21. Best value: 0.138856:  23%|██▎       | 23/100 [00:27<01:35,  1.24s/it]Best trial: 21. Best value: 0.138856:  23%|██▎       | 23/100 [00:28<01:35,  1.24s/it]Best trial: 21. Best value: 0.138856:  24%|██▍       | 24/100 [00:28<01:35,  1.26s/it]Best trial: 21. Best value: 0.138856:  24%|██▍       | 24/100 [00:29<01:35,  1.26s/it]Best trial: 21. Best value: 0.138856:  25%|██▌       | 25/100 [00:29<01:29,  1.19s/it]Best trial: 21. Best value: 0.138856:  25%|██▌       | 25/100 [00:31<01:29,  1.19s/it]Best trial: 21. Best value: 0.138856:  26%|██▌       | 26/100 [00:31<01:31,  1.24s/it]Best trial: 21. Best value: 0.138856:  26%|██▌       | 26/100 [00:32<01:31,  1.24s/it]Best trial: 21. Best value: 0.138856:  27%|██▋       | 27/100 [00:32<01:19,  1.09s/it]Best trial: 21. Best value: 0.138856:  27%|██▋       | 27/100 [00:33<01:19,  1.09s/it]Best trial: 21. Best value: 0.138856:  28%|██▊       | 28/100 [00:33<01:32,  1.29s/it]Best trial: 21. Best value: 0.138856:  28%|██▊       | 28/100 [00:35<01:32,  1.29s/it]Best trial: 21. Best value: 0.138856:  29%|██▉       | 29/100 [00:35<01:30,  1.28s/it]Best trial: 21. Best value: 0.138856:  29%|██▉       | 29/100 [00:35<01:30,  1.28s/it]Best trial: 21. Best value: 0.138856:  30%|███       | 30/100 [00:35<01:18,  1.12s/it]Best trial: 21. Best value: 0.138856:  30%|███       | 30/100 [00:37<01:18,  1.12s/it]Best trial: 21. Best value: 0.138856:  31%|███       | 31/100 [00:37<01:29,  1.30s/it]Best trial: 21. Best value: 0.138856:  31%|███       | 31/100 [00:38<01:29,  1.30s/it]Best trial: 21. Best value: 0.138856:  32%|███▏      | 32/100 [00:38<01:16,  1.12s/it]Best trial: 21. Best value: 0.138856:  32%|███▏      | 32/100 [00:38<01:16,  1.12s/it]Best trial: 21. Best value: 0.138856:  33%|███▎      | 33/100 [00:38<01:05,  1.03it/s]Best trial: 21. Best value: 0.138856:  33%|███▎      | 33/100 [00:39<01:05,  1.03it/s]Best trial: 21. Best value: 0.138856:  34%|███▍      | 34/100 [00:39<01:03,  1.04it/s]Best trial: 21. Best value: 0.138856:  34%|███▍      | 34/100 [00:40<01:03,  1.04it/s]Best trial: 21. Best value: 0.138856:  35%|███▌      | 35/100 [00:40<00:59,  1.09it/s]Best trial: 21. Best value: 0.138856:  35%|███▌      | 35/100 [00:41<00:59,  1.09it/s]Best trial: 21. Best value: 0.138856:  36%|███▌      | 36/100 [00:41<01:03,  1.00it/s]Best trial: 21. Best value: 0.138856:  36%|███▌      | 36/100 [00:42<01:03,  1.00it/s]Best trial: 21. Best value: 0.138856:  37%|███▋      | 37/100 [00:42<00:59,  1.06it/s]Best trial: 21. Best value: 0.138856:  37%|███▋      | 37/100 [00:43<00:59,  1.06it/s]Best trial: 21. Best value: 0.138856:  38%|███▊      | 38/100 [00:43<00:54,  1.13it/s]Best trial: 21. Best value: 0.138856:  38%|███▊      | 38/100 [00:44<00:54,  1.13it/s]Best trial: 21. Best value: 0.138856:  39%|███▉      | 39/100 [00:44<00:50,  1.21it/s]Best trial: 21. Best value: 0.138856:  39%|███▉      | 39/100 [00:45<00:50,  1.21it/s]Best trial: 21. Best value: 0.138856:  40%|████      | 40/100 [00:45<00:54,  1.10it/s]Best trial: 21. Best value: 0.138856:  40%|████      | 40/100 [00:46<00:54,  1.10it/s]Best trial: 21. Best value: 0.138856:  41%|████      | 41/100 [00:46<01:05,  1.11s/it]Best trial: 21. Best value: 0.138856:  41%|████      | 41/100 [00:47<01:05,  1.11s/it]Best trial: 21. Best value: 0.138856:  42%|████▏     | 42/100 [00:47<00:57,  1.01it/s]Best trial: 21. Best value: 0.138856:  42%|████▏     | 42/100 [00:48<00:57,  1.01it/s]Best trial: 21. Best value: 0.138856:  43%|████▎     | 43/100 [00:48<00:50,  1.12it/s]Best trial: 21. Best value: 0.138856:  43%|████▎     | 43/100 [00:48<00:50,  1.12it/s]Best trial: 21. Best value: 0.138856:  44%|████▍     | 44/100 [00:48<00:49,  1.12it/s]Best trial: 21. Best value: 0.138856:  44%|████▍     | 44/100 [00:49<00:49,  1.12it/s]Best trial: 21. Best value: 0.138856:  45%|████▌     | 45/100 [00:49<00:45,  1.21it/s]Best trial: 21. Best value: 0.138856:  45%|████▌     | 45/100 [00:50<00:45,  1.21it/s]Best trial: 21. Best value: 0.138856:  46%|████▌     | 46/100 [00:50<00:42,  1.27it/s]Best trial: 21. Best value: 0.138856:  46%|████▌     | 46/100 [00:51<00:42,  1.27it/s]Best trial: 21. Best value: 0.138856:  47%|████▋     | 47/100 [00:51<00:43,  1.23it/s]Best trial: 21. Best value: 0.138856:  47%|████▋     | 47/100 [00:52<00:43,  1.23it/s]Best trial: 21. Best value: 0.138856:  48%|████▊     | 48/100 [00:52<00:44,  1.16it/s]Best trial: 21. Best value: 0.138856:  48%|████▊     | 48/100 [00:53<00:44,  1.16it/s]Best trial: 21. Best value: 0.138856:  49%|████▉     | 49/100 [00:53<00:43,  1.18it/s]Best trial: 21. Best value: 0.138856:  49%|████▉     | 49/100 [00:54<00:43,  1.18it/s]Best trial: 21. Best value: 0.138856:  50%|█████     | 50/100 [00:54<00:51,  1.03s/it]Best trial: 21. Best value: 0.138856:  50%|█████     | 50/100 [00:55<00:51,  1.03s/it]Best trial: 21. Best value: 0.138856:  51%|█████     | 51/100 [00:55<00:50,  1.03s/it]Best trial: 21. Best value: 0.138856:  51%|█████     | 51/100 [00:56<00:50,  1.03s/it]Best trial: 21. Best value: 0.138856:  52%|█████▏    | 52/100 [00:56<00:46,  1.04it/s]Best trial: 21. Best value: 0.138856:  52%|█████▏    | 52/100 [00:57<00:46,  1.04it/s]Best trial: 21. Best value: 0.138856:  53%|█████▎    | 53/100 [00:57<00:43,  1.08it/s]Best trial: 21. Best value: 0.138856:  53%|█████▎    | 53/100 [00:58<00:43,  1.08it/s]Best trial: 21. Best value: 0.138856:  54%|█████▍    | 54/100 [00:58<00:41,  1.10it/s]Best trial: 21. Best value: 0.138856:  54%|█████▍    | 54/100 [00:59<00:41,  1.10it/s]Best trial: 21. Best value: 0.138856:  55%|█████▌    | 55/100 [00:59<00:42,  1.06it/s]Best trial: 21. Best value: 0.138856:  55%|█████▌    | 55/100 [01:00<00:42,  1.06it/s]Best trial: 21. Best value: 0.138856:  56%|█████▌    | 56/100 [01:00<00:45,  1.03s/it]Best trial: 21. Best value: 0.138856:  56%|█████▌    | 56/100 [01:01<00:45,  1.03s/it]Best trial: 21. Best value: 0.138856:  57%|█████▋    | 57/100 [01:01<00:45,  1.07s/it]Best trial: 21. Best value: 0.138856:  57%|█████▋    | 57/100 [01:03<00:45,  1.07s/it]Best trial: 21. Best value: 0.138856:  58%|█████▊    | 58/100 [01:03<00:57,  1.37s/it]Best trial: 21. Best value: 0.138856:  58%|█████▊    | 58/100 [01:05<00:57,  1.37s/it]Best trial: 21. Best value: 0.138856:  59%|█████▉    | 59/100 [01:05<01:00,  1.48s/it]Best trial: 21. Best value: 0.138856:  59%|█████▉    | 59/100 [01:07<01:00,  1.48s/it]Best trial: 21. Best value: 0.138856:  60%|██████    | 60/100 [01:07<01:06,  1.66s/it]Best trial: 21. Best value: 0.138856:  60%|██████    | 60/100 [01:08<01:06,  1.66s/it]Best trial: 21. Best value: 0.138856:  61%|██████    | 61/100 [01:08<01:03,  1.62s/it]Best trial: 21. Best value: 0.138856:  61%|██████    | 61/100 [01:09<01:03,  1.62s/it]Best trial: 21. Best value: 0.138856:  62%|██████▏   | 62/100 [01:09<00:55,  1.47s/it]Best trial: 21. Best value: 0.138856:  62%|██████▏   | 62/100 [01:11<00:55,  1.47s/it]Best trial: 21. Best value: 0.138856:  63%|██████▎   | 63/100 [01:11<00:51,  1.40s/it]Best trial: 21. Best value: 0.138856:  63%|██████▎   | 63/100 [01:12<00:51,  1.40s/it]Best trial: 21. Best value: 0.138856:  64%|██████▍   | 64/100 [01:12<00:45,  1.26s/it]Best trial: 21. Best value: 0.138856:  64%|██████▍   | 64/100 [01:13<00:45,  1.26s/it]Best trial: 21. Best value: 0.138856:  65%|██████▌   | 65/100 [01:13<00:42,  1.21s/it]Best trial: 21. Best value: 0.138856:  65%|██████▌   | 65/100 [01:14<00:42,  1.21s/it]Best trial: 21. Best value: 0.138856:  66%|██████▌   | 66/100 [01:14<00:40,  1.21s/it]Best trial: 21. Best value: 0.138856:  66%|██████▌   | 66/100 [01:15<00:40,  1.21s/it]Best trial: 21. Best value: 0.138856:  67%|██████▋   | 67/100 [01:15<00:37,  1.14s/it]Best trial: 21. Best value: 0.138856:  67%|██████▋   | 67/100 [01:16<00:37,  1.14s/it]Best trial: 21. Best value: 0.138856:  68%|██████▊   | 68/100 [01:16<00:34,  1.09s/it]Best trial: 21. Best value: 0.138856:  68%|██████▊   | 68/100 [01:18<00:34,  1.09s/it]Best trial: 21. Best value: 0.138856:  69%|██████▉   | 69/100 [01:18<00:39,  1.26s/it]Best trial: 21. Best value: 0.138856:  69%|██████▉   | 69/100 [01:18<00:39,  1.26s/it]Best trial: 21. Best value: 0.138856:  70%|███████   | 70/100 [01:18<00:32,  1.08s/it]Best trial: 21. Best value: 0.138856:  70%|███████   | 70/100 [01:19<00:32,  1.08s/it]Best trial: 21. Best value: 0.138856:  71%|███████   | 71/100 [01:19<00:31,  1.08s/it]Best trial: 21. Best value: 0.138856:  71%|███████   | 71/100 [01:20<00:31,  1.08s/it]Best trial: 21. Best value: 0.138856:  72%|███████▏  | 72/100 [01:20<00:28,  1.03s/it]Best trial: 21. Best value: 0.138856:  72%|███████▏  | 72/100 [01:22<00:28,  1.03s/it]Best trial: 21. Best value: 0.138856:  73%|███████▎  | 73/100 [01:22<00:32,  1.20s/it]Best trial: 21. Best value: 0.138856:  73%|███████▎  | 73/100 [01:23<00:32,  1.20s/it]Best trial: 21. Best value: 0.138856:  74%|███████▍  | 74/100 [01:23<00:27,  1.06s/it]Best trial: 21. Best value: 0.138856:  74%|███████▍  | 74/100 [01:24<00:27,  1.06s/it]Best trial: 21. Best value: 0.138856:  75%|███████▌  | 75/100 [01:24<00:26,  1.06s/it]Best trial: 21. Best value: 0.138856:  75%|███████▌  | 75/100 [01:24<00:26,  1.06s/it]Best trial: 21. Best value: 0.138856:  76%|███████▌  | 76/100 [01:24<00:23,  1.01it/s]Best trial: 21. Best value: 0.138856:  76%|███████▌  | 76/100 [01:26<00:23,  1.01it/s]Best trial: 21. Best value: 0.138856:  77%|███████▋  | 77/100 [01:26<00:27,  1.18s/it]Best trial: 21. Best value: 0.138856:  77%|███████▋  | 77/100 [01:28<00:27,  1.18s/it]Best trial: 21. Best value: 0.138856:  78%|███████▊  | 78/100 [01:28<00:29,  1.34s/it]Best trial: 21. Best value: 0.138856:  78%|███████▊  | 78/100 [01:29<00:29,  1.34s/it]Best trial: 21. Best value: 0.138856:  79%|███████▉  | 79/100 [01:29<00:24,  1.19s/it]Best trial: 21. Best value: 0.138856:  79%|███████▉  | 79/100 [01:30<00:24,  1.19s/it]Best trial: 21. Best value: 0.138856:  80%|████████  | 80/100 [01:30<00:23,  1.19s/it]Best trial: 21. Best value: 0.138856:  80%|████████  | 80/100 [01:30<00:23,  1.19s/it]Best trial: 21. Best value: 0.138856:  81%|████████  | 81/100 [01:30<00:19,  1.03s/it]Best trial: 21. Best value: 0.138856:  81%|████████  | 81/100 [01:31<00:19,  1.03s/it]Best trial: 21. Best value: 0.138856:  82%|████████▏ | 82/100 [01:31<00:17,  1.02it/s]Best trial: 21. Best value: 0.138856:  82%|████████▏ | 82/100 [01:32<00:17,  1.02it/s]Best trial: 21. Best value: 0.138856:  83%|████████▎ | 83/100 [01:32<00:16,  1.04it/s]Best trial: 21. Best value: 0.138856:  83%|████████▎ | 83/100 [01:33<00:16,  1.04it/s]Best trial: 21. Best value: 0.138856:  84%|████████▍ | 84/100 [01:33<00:16,  1.01s/it]Best trial: 21. Best value: 0.138856:  84%|████████▍ | 84/100 [01:34<00:16,  1.01s/it]Best trial: 21. Best value: 0.138856:  85%|████████▌ | 85/100 [01:34<00:14,  1.03it/s]Best trial: 21. Best value: 0.138856:  85%|████████▌ | 85/100 [01:35<00:14,  1.03it/s]Best trial: 21. Best value: 0.138856:  86%|████████▌ | 86/100 [01:35<00:12,  1.16it/s]Best trial: 21. Best value: 0.138856:  86%|████████▌ | 86/100 [01:36<00:12,  1.16it/s]Best trial: 21. Best value: 0.138856:  87%|████████▋ | 87/100 [01:36<00:11,  1.16it/s]Best trial: 21. Best value: 0.138856:  87%|████████▋ | 87/100 [01:37<00:11,  1.16it/s]Best trial: 21. Best value: 0.138856:  88%|████████▊ | 88/100 [01:37<00:11,  1.02it/s]Best trial: 21. Best value: 0.138856:  88%|████████▊ | 88/100 [01:38<00:11,  1.02it/s]Best trial: 21. Best value: 0.138856:  89%|████████▉ | 89/100 [01:38<00:10,  1.09it/s]Best trial: 21. Best value: 0.138856:  89%|████████▉ | 89/100 [01:39<00:10,  1.09it/s]Best trial: 21. Best value: 0.138856:  90%|█████████ | 90/100 [01:39<00:10,  1.00s/it]Best trial: 21. Best value: 0.138856:  90%|█████████ | 90/100 [01:40<00:10,  1.00s/it]Best trial: 21. Best value: 0.138856:  91%|█████████ | 91/100 [01:40<00:08,  1.05it/s]Best trial: 21. Best value: 0.138856:  91%|█████████ | 91/100 [01:41<00:08,  1.05it/s]Best trial: 21. Best value: 0.138856:  92%|█████████▏| 92/100 [01:41<00:07,  1.11it/s]Best trial: 21. Best value: 0.138856:  92%|█████████▏| 92/100 [01:41<00:07,  1.11it/s]Best trial: 21. Best value: 0.138856:  93%|█████████▎| 93/100 [01:41<00:06,  1.12it/s]Best trial: 21. Best value: 0.138856:  93%|█████████▎| 93/100 [01:42<00:06,  1.12it/s]Best trial: 21. Best value: 0.138856:  94%|█████████▍| 94/100 [01:42<00:04,  1.21it/s]Best trial: 21. Best value: 0.138856:  94%|█████████▍| 94/100 [01:43<00:04,  1.21it/s]Best trial: 21. Best value: 0.138856:  95%|█████████▌| 95/100 [01:43<00:04,  1.22it/s]Best trial: 21. Best value: 0.138856:  95%|█████████▌| 95/100 [01:44<00:04,  1.22it/s]Best trial: 21. Best value: 0.138856:  96%|█████████▌| 96/100 [01:44<00:03,  1.17it/s]Best trial: 21. Best value: 0.138856:  96%|█████████▌| 96/100 [01:44<00:03,  1.17it/s]Best trial: 21. Best value: 0.138856:  97%|█████████▋| 97/100 [01:44<00:02,  1.24it/s]Best trial: 21. Best value: 0.138856:  97%|█████████▋| 97/100 [01:45<00:02,  1.24it/s]Best trial: 21. Best value: 0.138856:  98%|█████████▊| 98/100 [01:45<00:01,  1.25it/s]Best trial: 21. Best value: 0.138856:  98%|█████████▊| 98/100 [01:46<00:01,  1.25it/s]Best trial: 21. Best value: 0.138856:  99%|█████████▉| 99/100 [01:46<00:00,  1.19it/s]Best trial: 21. Best value: 0.138856:  99%|█████████▉| 99/100 [01:47<00:00,  1.19it/s]Best trial: 21. Best value: 0.138856: 100%|██████████| 100/100 [01:47<00:00,  1.16it/s]Best trial: 21. Best value: 0.138856: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]
2025-11-30 07:27:23,032 - INFO - HPO Complete. Best AUPRC: 0.1389
2025-11-30 07:27:23,032 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.00023628652698839172, 'max_depth': 4, 'subsample': 0.6824150571091759, 'colsample_bytree': 0.6072225895402589, 'gamma': 4.419637296974182, 'reg_lambda': 0.5648387885661693, 'reg_alpha': 0.00010825852700864379}
2025-11-30 07:27:23,033 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:27:24,862 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 07:27:24,862 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:27:24,945 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:27:24,951 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:27:24,953 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:27:24,953 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:27:24,953 - INFO - Training model...
2025-11-30 07:27:25,401 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:27:30,158 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:27:30,158 - INFO - AUROC: 0.6484 (0.5426 - 0.6930)
2025-11-30 07:27:30,158 - INFO - AUPRC: 0.0951 (0.0513 - 0.1402)
2025-11-30 07:27:30,158 - INFO - Brier Score: 0.2457 (0.2456 - 0.2461)
2025-11-30 07:27:30,158 - INFO - Accuracy: 0.8815 (0.5445 - 0.8974)
2025-11-30 07:27:30,158 - INFO - Precision: 0.1406 (0.0663 - 0.2039)
2025-11-30 07:27:30,158 - INFO - Sensitivity (Recall): 0.2500 (0.1649 - 0.6368)
2025-11-30 07:27:30,158 - INFO - F1-Score: 0.1800 (0.1003 - 0.2548)
2025-11-30 07:27:30,158 - INFO - Best Threshold: 0.5000 (0.4960 - 0.5000)
2025-11-30 07:27:30,158 - INFO - Specificity: 0.9162 (0.5537 - 0.9345)
2025-11-30 07:27:30,165 - INFO - Calculating SHAP values...
2025-11-30 07:27:31,207 - INFO - SHAP plots saved.
2025-11-30 07:27:31,208 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:27:32,523 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 07:27:32,523 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:27:32,635 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:27:32,645 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:27:32,647 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:27:32,647 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.070192:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.070192:   1%|          | 1/100 [00:02<04:37,  2.80s/it]Best trial: 1. Best value: 0.0965937:   1%|          | 1/100 [00:04<04:37,  2.80s/it]Best trial: 1. Best value: 0.0965937:   2%|▏         | 2/100 [00:04<03:26,  2.10s/it]Best trial: 2. Best value: 0.109623:   2%|▏         | 2/100 [00:06<03:26,  2.10s/it] Best trial: 2. Best value: 0.109623:   3%|▎         | 3/100 [00:06<03:16,  2.03s/it]Best trial: 2. Best value: 0.109623:   3%|▎         | 3/100 [00:07<03:16,  2.03s/it]Best trial: 2. Best value: 0.109623:   4%|▍         | 4/100 [00:07<02:47,  1.75s/it]Best trial: 2. Best value: 0.109623:   4%|▍         | 4/100 [00:09<02:47,  1.75s/it]Best trial: 2. Best value: 0.109623:   5%|▌         | 5/100 [00:09<02:36,  1.65s/it]Best trial: 2. Best value: 0.109623:   5%|▌         | 5/100 [00:10<02:36,  1.65s/it]Best trial: 2. Best value: 0.109623:   6%|▌         | 6/100 [00:10<02:18,  1.47s/it]Best trial: 2. Best value: 0.109623:   6%|▌         | 6/100 [00:11<02:18,  1.47s/it]Best trial: 2. Best value: 0.109623:   7%|▋         | 7/100 [00:11<02:07,  1.38s/it]Best trial: 2. Best value: 0.109623:   7%|▋         | 7/100 [00:14<02:07,  1.38s/it]Best trial: 2. Best value: 0.109623:   8%|▊         | 8/100 [00:14<02:45,  1.80s/it]Best trial: 2. Best value: 0.109623:   8%|▊         | 8/100 [00:15<02:45,  1.80s/it]Best trial: 2. Best value: 0.109623:   9%|▉         | 9/100 [00:15<02:30,  1.65s/it]Best trial: 2. Best value: 0.109623:   9%|▉         | 9/100 [00:16<02:30,  1.65s/it]Best trial: 2. Best value: 0.109623:  10%|█         | 10/100 [00:16<02:14,  1.50s/it]Best trial: 2. Best value: 0.109623:  10%|█         | 10/100 [00:18<02:14,  1.50s/it]Best trial: 2. Best value: 0.109623:  11%|█         | 11/100 [00:18<02:17,  1.54s/it]Best trial: 2. Best value: 0.109623:  11%|█         | 11/100 [00:19<02:17,  1.54s/it]Best trial: 2. Best value: 0.109623:  12%|█▏        | 12/100 [00:19<02:00,  1.37s/it]Best trial: 2. Best value: 0.109623:  12%|█▏        | 12/100 [00:20<02:00,  1.37s/it]Best trial: 2. Best value: 0.109623:  13%|█▎        | 13/100 [00:20<02:04,  1.43s/it]Best trial: 2. Best value: 0.109623:  13%|█▎        | 13/100 [00:23<02:04,  1.43s/it]Best trial: 2. Best value: 0.109623:  14%|█▍        | 14/100 [00:23<02:33,  1.79s/it]Best trial: 2. Best value: 0.109623:  14%|█▍        | 14/100 [00:24<02:33,  1.79s/it]Best trial: 2. Best value: 0.109623:  15%|█▌        | 15/100 [00:24<02:09,  1.52s/it]Best trial: 2. Best value: 0.109623:  15%|█▌        | 15/100 [00:26<02:09,  1.52s/it]Best trial: 2. Best value: 0.109623:  16%|█▌        | 16/100 [00:26<02:12,  1.58s/it]Best trial: 2. Best value: 0.109623:  16%|█▌        | 16/100 [00:27<02:12,  1.58s/it]Best trial: 2. Best value: 0.109623:  17%|█▋        | 17/100 [00:27<02:14,  1.62s/it]Best trial: 2. Best value: 0.109623:  17%|█▋        | 17/100 [00:28<02:14,  1.62s/it]Best trial: 2. Best value: 0.109623:  18%|█▊        | 18/100 [00:28<02:01,  1.48s/it]Best trial: 2. Best value: 0.109623:  18%|█▊        | 18/100 [00:30<02:01,  1.48s/it]Best trial: 2. Best value: 0.109623:  19%|█▉        | 19/100 [00:30<02:05,  1.55s/it]Best trial: 2. Best value: 0.109623:  19%|█▉        | 19/100 [00:32<02:05,  1.55s/it]Best trial: 2. Best value: 0.109623:  20%|██        | 20/100 [00:32<02:08,  1.61s/it]Best trial: 2. Best value: 0.109623:  20%|██        | 20/100 [00:34<02:08,  1.61s/it]Best trial: 2. Best value: 0.109623:  21%|██        | 21/100 [00:34<02:08,  1.63s/it]Best trial: 2. Best value: 0.109623:  21%|██        | 21/100 [00:35<02:08,  1.63s/it]Best trial: 2. Best value: 0.109623:  22%|██▏       | 22/100 [00:35<01:57,  1.50s/it]Best trial: 2. Best value: 0.109623:  22%|██▏       | 22/100 [00:36<01:57,  1.50s/it]Best trial: 2. Best value: 0.109623:  23%|██▎       | 23/100 [00:36<01:41,  1.31s/it]Best trial: 2. Best value: 0.109623:  23%|██▎       | 23/100 [00:36<01:41,  1.31s/it]Best trial: 2. Best value: 0.109623:  24%|██▍       | 24/100 [00:36<01:26,  1.14s/it]Best trial: 2. Best value: 0.109623:  24%|██▍       | 24/100 [00:37<01:26,  1.14s/it]Best trial: 2. Best value: 0.109623:  25%|██▌       | 25/100 [00:37<01:20,  1.07s/it]Best trial: 2. Best value: 0.109623:  25%|██▌       | 25/100 [00:39<01:20,  1.07s/it]Best trial: 2. Best value: 0.109623:  26%|██▌       | 26/100 [00:39<01:30,  1.22s/it]Best trial: 2. Best value: 0.109623:  26%|██▌       | 26/100 [00:40<01:30,  1.22s/it]Best trial: 2. Best value: 0.109623:  27%|██▋       | 27/100 [00:40<01:34,  1.29s/it]Best trial: 2. Best value: 0.109623:  27%|██▋       | 27/100 [00:42<01:34,  1.29s/it]Best trial: 2. Best value: 0.109623:  28%|██▊       | 28/100 [00:42<01:34,  1.32s/it]Best trial: 2. Best value: 0.109623:  28%|██▊       | 28/100 [00:43<01:34,  1.32s/it]Best trial: 2. Best value: 0.109623:  29%|██▉       | 29/100 [00:43<01:32,  1.30s/it]Best trial: 2. Best value: 0.109623:  29%|██▉       | 29/100 [00:45<01:32,  1.30s/it]Best trial: 2. Best value: 0.109623:  30%|███       | 30/100 [00:45<01:44,  1.50s/it]Best trial: 2. Best value: 0.109623:  30%|███       | 30/100 [00:47<01:44,  1.50s/it]Best trial: 2. Best value: 0.109623:  31%|███       | 31/100 [00:47<01:53,  1.64s/it]Best trial: 2. Best value: 0.109623:  31%|███       | 31/100 [00:48<01:53,  1.64s/it]Best trial: 2. Best value: 0.109623:  32%|███▏      | 32/100 [00:48<01:42,  1.50s/it]Best trial: 2. Best value: 0.109623:  32%|███▏      | 32/100 [00:49<01:42,  1.50s/it]Best trial: 2. Best value: 0.109623:  33%|███▎      | 33/100 [00:49<01:31,  1.37s/it]Best trial: 2. Best value: 0.109623:  33%|███▎      | 33/100 [00:51<01:31,  1.37s/it]Best trial: 2. Best value: 0.109623:  34%|███▍      | 34/100 [00:51<01:39,  1.52s/it]Best trial: 2. Best value: 0.109623:  34%|███▍      | 34/100 [00:52<01:39,  1.52s/it]Best trial: 2. Best value: 0.109623:  35%|███▌      | 35/100 [00:52<01:38,  1.51s/it]Best trial: 2. Best value: 0.109623:  35%|███▌      | 35/100 [00:54<01:38,  1.51s/it]Best trial: 2. Best value: 0.109623:  36%|███▌      | 36/100 [00:54<01:42,  1.59s/it]Best trial: 2. Best value: 0.109623:  36%|███▌      | 36/100 [00:56<01:42,  1.59s/it]Best trial: 2. Best value: 0.109623:  37%|███▋      | 37/100 [00:56<01:45,  1.68s/it]Best trial: 2. Best value: 0.109623:  37%|███▋      | 37/100 [00:58<01:45,  1.68s/it]Best trial: 2. Best value: 0.109623:  38%|███▊      | 38/100 [00:58<01:44,  1.68s/it]Best trial: 2. Best value: 0.109623:  38%|███▊      | 38/100 [01:00<01:44,  1.68s/it]Best trial: 2. Best value: 0.109623:  39%|███▉      | 39/100 [01:00<01:49,  1.79s/it]Best trial: 2. Best value: 0.109623:  39%|███▉      | 39/100 [01:02<01:49,  1.79s/it]Best trial: 2. Best value: 0.109623:  40%|████      | 40/100 [01:02<01:50,  1.84s/it]Best trial: 2. Best value: 0.109623:  40%|████      | 40/100 [01:03<01:50,  1.84s/it]Best trial: 2. Best value: 0.109623:  41%|████      | 41/100 [01:03<01:33,  1.59s/it]Best trial: 2. Best value: 0.109623:  41%|████      | 41/100 [01:04<01:33,  1.59s/it]Best trial: 2. Best value: 0.109623:  42%|████▏     | 42/100 [01:04<01:22,  1.42s/it]Best trial: 2. Best value: 0.109623:  42%|████▏     | 42/100 [01:06<01:22,  1.42s/it]Best trial: 2. Best value: 0.109623:  43%|████▎     | 43/100 [01:06<01:26,  1.51s/it]Best trial: 2. Best value: 0.109623:  43%|████▎     | 43/100 [01:08<01:26,  1.51s/it]Best trial: 2. Best value: 0.109623:  44%|████▍     | 44/100 [01:08<01:31,  1.64s/it]Best trial: 2. Best value: 0.109623:  44%|████▍     | 44/100 [01:08<01:31,  1.64s/it]Best trial: 2. Best value: 0.109623:  45%|████▌     | 45/100 [01:08<01:17,  1.42s/it]Best trial: 2. Best value: 0.109623:  45%|████▌     | 45/100 [01:10<01:17,  1.42s/it]Best trial: 2. Best value: 0.109623:  46%|████▌     | 46/100 [01:10<01:11,  1.32s/it]Best trial: 2. Best value: 0.109623:  46%|████▌     | 46/100 [01:10<01:11,  1.32s/it]Best trial: 2. Best value: 0.109623:  47%|████▋     | 47/100 [01:10<01:01,  1.15s/it]Best trial: 2. Best value: 0.109623:  47%|████▋     | 47/100 [01:11<01:01,  1.15s/it]Best trial: 2. Best value: 0.109623:  48%|████▊     | 48/100 [01:11<00:53,  1.03s/it]Best trial: 2. Best value: 0.109623:  48%|████▊     | 48/100 [01:13<00:53,  1.03s/it]Best trial: 2. Best value: 0.109623:  49%|████▉     | 49/100 [01:13<01:00,  1.18s/it]Best trial: 2. Best value: 0.109623:  49%|████▉     | 49/100 [01:15<01:00,  1.18s/it]Best trial: 2. Best value: 0.109623:  50%|█████     | 50/100 [01:15<01:16,  1.53s/it]Best trial: 2. Best value: 0.109623:  50%|█████     | 50/100 [01:17<01:16,  1.53s/it]Best trial: 2. Best value: 0.109623:  51%|█████     | 51/100 [01:17<01:19,  1.63s/it]Best trial: 2. Best value: 0.109623:  51%|█████     | 51/100 [01:17<01:19,  1.63s/it]Best trial: 2. Best value: 0.109623:  52%|█████▏    | 52/100 [01:17<01:04,  1.35s/it]Best trial: 2. Best value: 0.109623:  52%|█████▏    | 52/100 [01:18<01:04,  1.35s/it]Best trial: 2. Best value: 0.109623:  53%|█████▎    | 53/100 [01:18<00:55,  1.17s/it]Best trial: 2. Best value: 0.109623:  53%|█████▎    | 53/100 [01:19<00:55,  1.17s/it]Best trial: 2. Best value: 0.109623:  54%|█████▍    | 54/100 [01:19<00:47,  1.02s/it]Best trial: 2. Best value: 0.109623:  54%|█████▍    | 54/100 [01:20<00:47,  1.02s/it]Best trial: 2. Best value: 0.109623:  55%|█████▌    | 55/100 [01:20<00:46,  1.04s/it]Best trial: 2. Best value: 0.109623:  55%|█████▌    | 55/100 [01:21<00:46,  1.04s/it]Best trial: 2. Best value: 0.109623:  56%|█████▌    | 56/100 [01:21<00:42,  1.04it/s]Best trial: 2. Best value: 0.109623:  56%|█████▌    | 56/100 [01:22<00:42,  1.04it/s]Best trial: 2. Best value: 0.109623:  57%|█████▋    | 57/100 [01:22<00:41,  1.04it/s]Best trial: 2. Best value: 0.109623:  57%|█████▋    | 57/100 [01:22<00:41,  1.04it/s]Best trial: 2. Best value: 0.109623:  58%|█████▊    | 58/100 [01:22<00:35,  1.17it/s]Best trial: 2. Best value: 0.109623:  58%|█████▊    | 58/100 [01:23<00:35,  1.17it/s]Best trial: 2. Best value: 0.109623:  59%|█████▉    | 59/100 [01:23<00:38,  1.07it/s]Best trial: 2. Best value: 0.109623:  59%|█████▉    | 59/100 [01:24<00:38,  1.07it/s]Best trial: 2. Best value: 0.109623:  60%|██████    | 60/100 [01:24<00:38,  1.04it/s]Best trial: 2. Best value: 0.109623:  60%|██████    | 60/100 [01:26<00:38,  1.04it/s]Best trial: 2. Best value: 0.109623:  61%|██████    | 61/100 [01:26<00:39,  1.01s/it]Best trial: 2. Best value: 0.109623:  61%|██████    | 61/100 [01:26<00:39,  1.01s/it]Best trial: 2. Best value: 0.109623:  62%|██████▏   | 62/100 [01:26<00:35,  1.06it/s]Best trial: 2. Best value: 0.109623:  62%|██████▏   | 62/100 [01:27<00:35,  1.06it/s]Best trial: 2. Best value: 0.109623:  63%|██████▎   | 63/100 [01:27<00:31,  1.17it/s]Best trial: 2. Best value: 0.109623:  63%|██████▎   | 63/100 [01:28<00:31,  1.17it/s]Best trial: 2. Best value: 0.109623:  64%|██████▍   | 64/100 [01:28<00:31,  1.13it/s]Best trial: 64. Best value: 0.112531:  64%|██████▍   | 64/100 [01:29<00:31,  1.13it/s]Best trial: 64. Best value: 0.112531:  65%|██████▌   | 65/100 [01:29<00:31,  1.11it/s]Best trial: 64. Best value: 0.112531:  65%|██████▌   | 65/100 [01:30<00:31,  1.11it/s]Best trial: 64. Best value: 0.112531:  66%|██████▌   | 66/100 [01:30<00:33,  1.02it/s]Best trial: 64. Best value: 0.112531:  66%|██████▌   | 66/100 [01:31<00:33,  1.02it/s]Best trial: 64. Best value: 0.112531:  67%|██████▋   | 67/100 [01:31<00:35,  1.08s/it]Best trial: 64. Best value: 0.112531:  67%|██████▋   | 67/100 [01:33<00:35,  1.08s/it]Best trial: 64. Best value: 0.112531:  68%|██████▊   | 68/100 [01:33<00:39,  1.23s/it]Best trial: 64. Best value: 0.112531:  68%|██████▊   | 68/100 [01:34<00:39,  1.23s/it]Best trial: 64. Best value: 0.112531:  69%|██████▉   | 69/100 [01:34<00:40,  1.30s/it]Best trial: 64. Best value: 0.112531:  69%|██████▉   | 69/100 [01:35<00:40,  1.30s/it]Best trial: 64. Best value: 0.112531:  70%|███████   | 70/100 [01:35<00:34,  1.16s/it]Best trial: 64. Best value: 0.112531:  70%|███████   | 70/100 [01:36<00:34,  1.16s/it]Best trial: 64. Best value: 0.112531:  71%|███████   | 71/100 [01:36<00:32,  1.14s/it]Best trial: 64. Best value: 0.112531:  71%|███████   | 71/100 [01:37<00:32,  1.14s/it]Best trial: 64. Best value: 0.112531:  72%|███████▏  | 72/100 [01:37<00:28,  1.03s/it]Best trial: 64. Best value: 0.112531:  72%|███████▏  | 72/100 [01:38<00:28,  1.03s/it]Best trial: 64. Best value: 0.112531:  73%|███████▎  | 73/100 [01:38<00:25,  1.06it/s]Best trial: 64. Best value: 0.112531:  73%|███████▎  | 73/100 [01:39<00:25,  1.06it/s]Best trial: 64. Best value: 0.112531:  74%|███████▍  | 74/100 [01:39<00:24,  1.05it/s]Best trial: 64. Best value: 0.112531:  74%|███████▍  | 74/100 [01:41<00:24,  1.05it/s]Best trial: 64. Best value: 0.112531:  75%|███████▌  | 75/100 [01:41<00:31,  1.28s/it]Best trial: 64. Best value: 0.112531:  75%|███████▌  | 75/100 [01:42<00:31,  1.28s/it]Best trial: 64. Best value: 0.112531:  76%|███████▌  | 76/100 [01:42<00:29,  1.21s/it]Best trial: 64. Best value: 0.112531:  76%|███████▌  | 76/100 [01:43<00:29,  1.21s/it]Best trial: 64. Best value: 0.112531:  77%|███████▋  | 77/100 [01:43<00:26,  1.14s/it]Best trial: 64. Best value: 0.112531:  77%|███████▋  | 77/100 [01:44<00:26,  1.14s/it]Best trial: 64. Best value: 0.112531:  78%|███████▊  | 78/100 [01:44<00:23,  1.08s/it]Best trial: 64. Best value: 0.112531:  78%|███████▊  | 78/100 [01:45<00:23,  1.08s/it]Best trial: 64. Best value: 0.112531:  79%|███████▉  | 79/100 [01:45<00:22,  1.07s/it]Best trial: 64. Best value: 0.112531:  79%|███████▉  | 79/100 [01:46<00:22,  1.07s/it]Best trial: 64. Best value: 0.112531:  80%|████████  | 80/100 [01:46<00:22,  1.12s/it]Best trial: 64. Best value: 0.112531:  80%|████████  | 80/100 [01:47<00:22,  1.12s/it]Best trial: 64. Best value: 0.112531:  81%|████████  | 81/100 [01:47<00:22,  1.20s/it]Best trial: 64. Best value: 0.112531:  81%|████████  | 81/100 [01:49<00:22,  1.20s/it]Best trial: 64. Best value: 0.112531:  82%|████████▏ | 82/100 [01:49<00:21,  1.20s/it]Best trial: 64. Best value: 0.112531:  82%|████████▏ | 82/100 [01:50<00:21,  1.20s/it]Best trial: 64. Best value: 0.112531:  83%|████████▎ | 83/100 [01:50<00:18,  1.10s/it]Best trial: 64. Best value: 0.112531:  83%|████████▎ | 83/100 [01:51<00:18,  1.10s/it]Best trial: 64. Best value: 0.112531:  84%|████████▍ | 84/100 [01:51<00:17,  1.06s/it]Best trial: 64. Best value: 0.112531:  84%|████████▍ | 84/100 [01:52<00:17,  1.06s/it]Best trial: 64. Best value: 0.112531:  85%|████████▌ | 85/100 [01:52<00:19,  1.32s/it]Best trial: 64. Best value: 0.112531:  85%|████████▌ | 85/100 [01:54<00:19,  1.32s/it]Best trial: 64. Best value: 0.112531:  86%|████████▌ | 86/100 [01:54<00:17,  1.28s/it]Best trial: 64. Best value: 0.112531:  86%|████████▌ | 86/100 [01:55<00:17,  1.28s/it]Best trial: 64. Best value: 0.112531:  87%|████████▋ | 87/100 [01:55<00:17,  1.36s/it]Best trial: 64. Best value: 0.112531:  87%|████████▋ | 87/100 [01:56<00:17,  1.36s/it]Best trial: 64. Best value: 0.112531:  88%|████████▊ | 88/100 [01:56<00:15,  1.33s/it]Best trial: 64. Best value: 0.112531:  88%|████████▊ | 88/100 [01:58<00:15,  1.33s/it]Best trial: 64. Best value: 0.112531:  89%|████████▉ | 89/100 [01:58<00:14,  1.29s/it]Best trial: 64. Best value: 0.112531:  89%|████████▉ | 89/100 [01:59<00:14,  1.29s/it]Best trial: 64. Best value: 0.112531:  90%|█████████ | 90/100 [01:59<00:13,  1.34s/it]Best trial: 64. Best value: 0.112531:  90%|█████████ | 90/100 [02:00<00:13,  1.34s/it]Best trial: 64. Best value: 0.112531:  91%|█████████ | 91/100 [02:00<00:11,  1.29s/it]Best trial: 64. Best value: 0.112531:  91%|█████████ | 91/100 [02:02<00:11,  1.29s/it]Best trial: 64. Best value: 0.112531:  92%|█████████▏| 92/100 [02:02<00:10,  1.31s/it]Best trial: 64. Best value: 0.112531:  92%|█████████▏| 92/100 [02:03<00:10,  1.31s/it]Best trial: 64. Best value: 0.112531:  93%|█████████▎| 93/100 [02:03<00:09,  1.30s/it]Best trial: 64. Best value: 0.112531:  93%|█████████▎| 93/100 [02:04<00:09,  1.30s/it]Best trial: 64. Best value: 0.112531:  94%|█████████▍| 94/100 [02:04<00:07,  1.24s/it]Best trial: 64. Best value: 0.112531:  94%|█████████▍| 94/100 [02:05<00:07,  1.24s/it]Best trial: 64. Best value: 0.112531:  95%|█████████▌| 95/100 [02:05<00:06,  1.20s/it]Best trial: 64. Best value: 0.112531:  95%|█████████▌| 95/100 [02:06<00:06,  1.20s/it]Best trial: 64. Best value: 0.112531:  96%|█████████▌| 96/100 [02:06<00:04,  1.18s/it]Best trial: 64. Best value: 0.112531:  96%|█████████▌| 96/100 [02:07<00:04,  1.18s/it]Best trial: 64. Best value: 0.112531:  97%|█████████▋| 97/100 [02:07<00:03,  1.18s/it]Best trial: 64. Best value: 0.112531:  97%|█████████▋| 97/100 [02:09<00:03,  1.18s/it]Best trial: 64. Best value: 0.112531:  98%|█████████▊| 98/100 [02:09<00:02,  1.21s/it]Best trial: 64. Best value: 0.112531:  98%|█████████▊| 98/100 [02:10<00:02,  1.21s/it]Best trial: 64. Best value: 0.112531:  99%|█████████▉| 99/100 [02:10<00:01,  1.19s/it]Best trial: 64. Best value: 0.112531:  99%|█████████▉| 99/100 [02:11<00:01,  1.19s/it]Best trial: 64. Best value: 0.112531: 100%|██████████| 100/100 [02:11<00:00,  1.19s/it]Best trial: 64. Best value: 0.112531: 100%|██████████| 100/100 [02:11<00:00,  1.32s/it]
2025-11-30 07:29:44,181 - INFO - HPO Complete. Best AUPRC: 0.1125
2025-11-30 07:29:44,181 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0007225361561835507, 'max_depth': 3, 'subsample': 0.6506221702730564, 'colsample_bytree': 0.6155865190659722, 'gamma': 3.2993714355107473, 'reg_lambda': 0.0003234911982901524, 'reg_alpha': 0.00012625015770022658}
2025-11-30 07:29:44,182 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:29:46,073 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 07:29:46,073 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:29:46,173 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:29:46,181 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:29:46,183 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:29:46,183 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:29:46,183 - INFO - Training model...
2025-11-30 07:29:47,294 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:29:52,053 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:29:52,053 - INFO - AUROC: 0.5794 (0.4789 - 0.6464)
2025-11-30 07:29:52,053 - INFO - AUPRC: 0.0679 (0.0424 - 0.0976)
2025-11-30 07:29:52,053 - INFO - Brier Score: 0.2175 (0.2148 - 0.2193)
2025-11-30 07:29:52,053 - INFO - Accuracy: 0.5231 (0.3590 - 0.8983)
2025-11-30 07:29:52,053 - INFO - Precision: 0.0702 (0.0516 - 0.1571)
2025-11-30 07:29:52,053 - INFO - Sensitivity (Recall): 0.6667 (0.1555 - 0.8893)
2025-11-30 07:29:52,053 - INFO - F1-Score: 0.1270 (0.0967 - 0.1783)
2025-11-30 07:29:52,053 - INFO - Best Threshold: 0.4600 (0.4420 - 0.5220)
2025-11-30 07:29:52,053 - INFO - Specificity: 0.5152 (0.3352 - 0.9361)
2025-11-30 07:29:52,075 - INFO - Calculating SHAP values...
2025-11-30 07:29:53,308 - INFO - SHAP plots saved.
2025-11-30 07:29:53,313 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:29:54,887 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 07:29:54,887 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:29:54,995 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:29:55,004 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:29:55,006 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:29:55,006 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.155235:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.155235:   1%|          | 1/100 [00:02<03:27,  2.10s/it]Best trial: 1. Best value: 0.161208:   1%|          | 1/100 [00:04<03:27,  2.10s/it]Best trial: 1. Best value: 0.161208:   2%|▏         | 2/100 [00:04<03:43,  2.28s/it]Best trial: 1. Best value: 0.161208:   2%|▏         | 2/100 [00:07<03:43,  2.28s/it]Best trial: 1. Best value: 0.161208:   3%|▎         | 3/100 [00:07<03:53,  2.41s/it]Best trial: 1. Best value: 0.161208:   3%|▎         | 3/100 [00:08<03:53,  2.41s/it]Best trial: 1. Best value: 0.161208:   4%|▍         | 4/100 [00:08<03:00,  1.88s/it]Best trial: 1. Best value: 0.161208:   4%|▍         | 4/100 [00:09<03:00,  1.88s/it]Best trial: 1. Best value: 0.161208:   5%|▌         | 5/100 [00:09<02:41,  1.70s/it]Best trial: 1. Best value: 0.161208:   5%|▌         | 5/100 [00:11<02:41,  1.70s/it]Best trial: 1. Best value: 0.161208:   6%|▌         | 6/100 [00:11<02:41,  1.72s/it]Best trial: 6. Best value: 0.161521:   6%|▌         | 6/100 [00:13<02:41,  1.72s/it]Best trial: 6. Best value: 0.161521:   7%|▋         | 7/100 [00:13<02:43,  1.75s/it]Best trial: 6. Best value: 0.161521:   7%|▋         | 7/100 [00:14<02:43,  1.75s/it]Best trial: 6. Best value: 0.161521:   8%|▊         | 8/100 [00:14<02:25,  1.58s/it]Best trial: 8. Best value: 0.165642:   8%|▊         | 8/100 [00:15<02:25,  1.58s/it]Best trial: 8. Best value: 0.165642:   9%|▉         | 9/100 [00:15<02:19,  1.53s/it]Best trial: 8. Best value: 0.165642:   9%|▉         | 9/100 [00:17<02:19,  1.53s/it]Best trial: 8. Best value: 0.165642:  10%|█         | 10/100 [00:17<02:31,  1.68s/it]Best trial: 8. Best value: 0.165642:  10%|█         | 10/100 [00:20<02:31,  1.68s/it]Best trial: 8. Best value: 0.165642:  11%|█         | 11/100 [00:20<03:09,  2.13s/it]Best trial: 11. Best value: 0.17747:  11%|█         | 11/100 [00:22<03:09,  2.13s/it]Best trial: 11. Best value: 0.17747:  12%|█▏        | 12/100 [00:22<02:49,  1.93s/it]Best trial: 11. Best value: 0.17747:  12%|█▏        | 12/100 [00:23<02:49,  1.93s/it]Best trial: 11. Best value: 0.17747:  13%|█▎        | 13/100 [00:23<02:33,  1.77s/it]Best trial: 13. Best value: 0.17818:  13%|█▎        | 13/100 [00:25<02:33,  1.77s/it]Best trial: 13. Best value: 0.17818:  14%|█▍        | 14/100 [00:25<02:30,  1.75s/it]Best trial: 13. Best value: 0.17818:  14%|█▍        | 14/100 [00:26<02:30,  1.75s/it]Best trial: 13. Best value: 0.17818:  15%|█▌        | 15/100 [00:26<02:19,  1.64s/it]Best trial: 13. Best value: 0.17818:  15%|█▌        | 15/100 [00:27<02:19,  1.64s/it]Best trial: 13. Best value: 0.17818:  16%|█▌        | 16/100 [00:27<02:04,  1.49s/it]Best trial: 13. Best value: 0.17818:  16%|█▌        | 16/100 [00:29<02:04,  1.49s/it]Best trial: 13. Best value: 0.17818:  17%|█▋        | 17/100 [00:29<02:06,  1.53s/it]Best trial: 13. Best value: 0.17818:  17%|█▋        | 17/100 [00:30<02:06,  1.53s/it]Best trial: 13. Best value: 0.17818:  18%|█▊        | 18/100 [00:30<01:56,  1.42s/it]Best trial: 13. Best value: 0.17818:  18%|█▊        | 18/100 [00:32<01:56,  1.42s/it]Best trial: 13. Best value: 0.17818:  19%|█▉        | 19/100 [00:32<02:00,  1.49s/it]Best trial: 13. Best value: 0.17818:  19%|█▉        | 19/100 [00:34<02:00,  1.49s/it]Best trial: 13. Best value: 0.17818:  20%|██        | 20/100 [00:34<02:11,  1.65s/it]Best trial: 13. Best value: 0.17818:  20%|██        | 20/100 [00:35<02:11,  1.65s/it]Best trial: 13. Best value: 0.17818:  21%|██        | 21/100 [00:35<01:55,  1.47s/it]Best trial: 13. Best value: 0.17818:  21%|██        | 21/100 [00:36<01:55,  1.47s/it]Best trial: 13. Best value: 0.17818:  22%|██▏       | 22/100 [00:36<01:47,  1.38s/it]Best trial: 13. Best value: 0.17818:  22%|██▏       | 22/100 [00:38<01:47,  1.38s/it]Best trial: 13. Best value: 0.17818:  23%|██▎       | 23/100 [00:38<01:48,  1.41s/it]Best trial: 13. Best value: 0.17818:  23%|██▎       | 23/100 [00:39<01:48,  1.41s/it]Best trial: 13. Best value: 0.17818:  24%|██▍       | 24/100 [00:39<01:43,  1.36s/it]Best trial: 13. Best value: 0.17818:  24%|██▍       | 24/100 [00:40<01:43,  1.36s/it]Best trial: 13. Best value: 0.17818:  25%|██▌       | 25/100 [00:40<01:43,  1.38s/it]Best trial: 13. Best value: 0.17818:  25%|██▌       | 25/100 [00:43<01:43,  1.38s/it]Best trial: 13. Best value: 0.17818:  26%|██▌       | 26/100 [00:43<02:06,  1.71s/it]Best trial: 13. Best value: 0.17818:  26%|██▌       | 26/100 [00:44<02:06,  1.71s/it]Best trial: 13. Best value: 0.17818:  27%|██▋       | 27/100 [00:44<01:53,  1.55s/it]Best trial: 13. Best value: 0.17818:  27%|██▋       | 27/100 [00:46<01:53,  1.55s/it]Best trial: 13. Best value: 0.17818:  28%|██▊       | 28/100 [00:46<01:58,  1.64s/it]Best trial: 13. Best value: 0.17818:  28%|██▊       | 28/100 [00:47<01:58,  1.64s/it]Best trial: 13. Best value: 0.17818:  29%|██▉       | 29/100 [00:47<01:45,  1.49s/it]Best trial: 13. Best value: 0.17818:  29%|██▉       | 29/100 [00:48<01:45,  1.49s/it]Best trial: 13. Best value: 0.17818:  30%|███       | 30/100 [00:48<01:43,  1.48s/it]Best trial: 13. Best value: 0.17818:  30%|███       | 30/100 [00:50<01:43,  1.48s/it]Best trial: 13. Best value: 0.17818:  31%|███       | 31/100 [00:50<01:47,  1.56s/it]Best trial: 13. Best value: 0.17818:  31%|███       | 31/100 [00:52<01:47,  1.56s/it]Best trial: 13. Best value: 0.17818:  32%|███▏      | 32/100 [00:52<02:01,  1.78s/it]Best trial: 13. Best value: 0.17818:  32%|███▏      | 32/100 [00:56<02:01,  1.78s/it]Best trial: 13. Best value: 0.17818:  33%|███▎      | 33/100 [00:56<02:32,  2.27s/it]Best trial: 13. Best value: 0.17818:  33%|███▎      | 33/100 [00:57<02:32,  2.27s/it]Best trial: 13. Best value: 0.17818:  34%|███▍      | 34/100 [00:57<02:16,  2.07s/it]Best trial: 13. Best value: 0.17818:  34%|███▍      | 34/100 [01:00<02:16,  2.07s/it]Best trial: 13. Best value: 0.17818:  35%|███▌      | 35/100 [01:00<02:19,  2.15s/it]Best trial: 13. Best value: 0.17818:  35%|███▌      | 35/100 [01:02<02:19,  2.15s/it]Best trial: 13. Best value: 0.17818:  36%|███▌      | 36/100 [01:02<02:26,  2.29s/it]Best trial: 13. Best value: 0.17818:  36%|███▌      | 36/100 [01:04<02:26,  2.29s/it]Best trial: 13. Best value: 0.17818:  37%|███▋      | 37/100 [01:04<02:04,  1.98s/it]Best trial: 13. Best value: 0.17818:  37%|███▋      | 37/100 [01:05<02:04,  1.98s/it]Best trial: 13. Best value: 0.17818:  38%|███▊      | 38/100 [01:05<01:56,  1.88s/it]Best trial: 13. Best value: 0.17818:  38%|███▊      | 38/100 [01:07<01:56,  1.88s/it]Best trial: 13. Best value: 0.17818:  39%|███▉      | 39/100 [01:07<01:43,  1.70s/it]Best trial: 13. Best value: 0.17818:  39%|███▉      | 39/100 [01:08<01:43,  1.70s/it]Best trial: 13. Best value: 0.17818:  40%|████      | 40/100 [01:08<01:39,  1.65s/it]Best trial: 13. Best value: 0.17818:  40%|████      | 40/100 [01:10<01:39,  1.65s/it]Best trial: 13. Best value: 0.17818:  41%|████      | 41/100 [01:10<01:34,  1.60s/it]Best trial: 13. Best value: 0.17818:  41%|████      | 41/100 [01:11<01:34,  1.60s/it]Best trial: 13. Best value: 0.17818:  42%|████▏     | 42/100 [01:11<01:26,  1.49s/it]Best trial: 13. Best value: 0.17818:  42%|████▏     | 42/100 [01:14<01:26,  1.49s/it]Best trial: 13. Best value: 0.17818:  43%|████▎     | 43/100 [01:14<01:45,  1.84s/it]Best trial: 13. Best value: 0.17818:  43%|████▎     | 43/100 [01:15<01:45,  1.84s/it]Best trial: 13. Best value: 0.17818:  44%|████▍     | 44/100 [01:15<01:40,  1.79s/it]Best trial: 13. Best value: 0.17818:  44%|████▍     | 44/100 [01:17<01:40,  1.79s/it]Best trial: 13. Best value: 0.17818:  45%|████▌     | 45/100 [01:17<01:33,  1.71s/it]Best trial: 13. Best value: 0.17818:  45%|████▌     | 45/100 [01:18<01:33,  1.71s/it]Best trial: 13. Best value: 0.17818:  46%|████▌     | 46/100 [01:18<01:30,  1.68s/it]Best trial: 13. Best value: 0.17818:  46%|████▌     | 46/100 [01:20<01:30,  1.68s/it]Best trial: 13. Best value: 0.17818:  47%|████▋     | 47/100 [01:20<01:35,  1.80s/it]Best trial: 13. Best value: 0.17818:  47%|████▋     | 47/100 [01:22<01:35,  1.80s/it]Best trial: 13. Best value: 0.17818:  48%|████▊     | 48/100 [01:22<01:32,  1.78s/it]Best trial: 13. Best value: 0.17818:  48%|████▊     | 48/100 [01:25<01:32,  1.78s/it]Best trial: 13. Best value: 0.17818:  49%|████▉     | 49/100 [01:25<01:52,  2.20s/it]Best trial: 13. Best value: 0.17818:  49%|████▉     | 49/100 [01:29<01:52,  2.20s/it]Best trial: 13. Best value: 0.17818:  50%|█████     | 50/100 [01:29<02:17,  2.75s/it]Best trial: 13. Best value: 0.17818:  50%|█████     | 50/100 [01:31<02:17,  2.75s/it]Best trial: 13. Best value: 0.17818:  51%|█████     | 51/100 [01:31<01:54,  2.34s/it]Best trial: 13. Best value: 0.17818:  51%|█████     | 51/100 [01:32<01:54,  2.34s/it]Best trial: 13. Best value: 0.17818:  52%|█████▏    | 52/100 [01:32<01:43,  2.15s/it]Best trial: 13. Best value: 0.17818:  52%|█████▏    | 52/100 [01:34<01:43,  2.15s/it]Best trial: 13. Best value: 0.17818:  53%|█████▎    | 53/100 [01:34<01:39,  2.11s/it]Best trial: 13. Best value: 0.17818:  53%|█████▎    | 53/100 [01:36<01:39,  2.11s/it]Best trial: 13. Best value: 0.17818:  54%|█████▍    | 54/100 [01:36<01:32,  2.01s/it]Best trial: 13. Best value: 0.17818:  54%|█████▍    | 54/100 [01:38<01:32,  2.01s/it]Best trial: 13. Best value: 0.17818:  55%|█████▌    | 55/100 [01:38<01:29,  1.99s/it]Best trial: 13. Best value: 0.17818:  55%|█████▌    | 55/100 [01:40<01:29,  1.99s/it]Best trial: 13. Best value: 0.17818:  56%|█████▌    | 56/100 [01:40<01:24,  1.93s/it]Best trial: 13. Best value: 0.17818:  56%|█████▌    | 56/100 [01:42<01:24,  1.93s/it]Best trial: 13. Best value: 0.17818:  57%|█████▋    | 57/100 [01:42<01:22,  1.91s/it]Best trial: 13. Best value: 0.17818:  57%|█████▋    | 57/100 [01:45<01:22,  1.91s/it]Best trial: 13. Best value: 0.17818:  58%|█████▊    | 58/100 [01:45<01:31,  2.17s/it]Best trial: 13. Best value: 0.17818:  58%|█████▊    | 58/100 [01:46<01:31,  2.17s/it]Best trial: 13. Best value: 0.17818:  59%|█████▉    | 59/100 [01:46<01:23,  2.03s/it]Best trial: 13. Best value: 0.17818:  59%|█████▉    | 59/100 [01:49<01:23,  2.03s/it]Best trial: 13. Best value: 0.17818:  60%|██████    | 60/100 [01:49<01:31,  2.29s/it]Best trial: 13. Best value: 0.17818:  60%|██████    | 60/100 [01:51<01:31,  2.29s/it]Best trial: 13. Best value: 0.17818:  61%|██████    | 61/100 [01:51<01:22,  2.12s/it]Best trial: 13. Best value: 0.17818:  61%|██████    | 61/100 [01:53<01:22,  2.12s/it]Best trial: 13. Best value: 0.17818:  62%|██████▏   | 62/100 [01:53<01:16,  2.00s/it]Best trial: 13. Best value: 0.17818:  62%|██████▏   | 62/100 [01:54<01:16,  2.00s/it]Best trial: 13. Best value: 0.17818:  63%|██████▎   | 63/100 [01:54<01:10,  1.90s/it]Best trial: 13. Best value: 0.17818:  63%|██████▎   | 63/100 [01:57<01:10,  1.90s/it]Best trial: 13. Best value: 0.17818:  64%|██████▍   | 64/100 [01:57<01:11,  2.00s/it]Best trial: 13. Best value: 0.17818:  64%|██████▍   | 64/100 [01:59<01:11,  2.00s/it]Best trial: 13. Best value: 0.17818:  65%|██████▌   | 65/100 [01:59<01:12,  2.06s/it]Best trial: 13. Best value: 0.17818:  65%|██████▌   | 65/100 [02:00<01:12,  2.06s/it]Best trial: 13. Best value: 0.17818:  66%|██████▌   | 66/100 [02:00<01:03,  1.88s/it]Best trial: 13. Best value: 0.17818:  66%|██████▌   | 66/100 [02:02<01:03,  1.88s/it]Best trial: 13. Best value: 0.17818:  67%|██████▋   | 67/100 [02:02<01:01,  1.85s/it]Best trial: 13. Best value: 0.17818:  67%|██████▋   | 67/100 [02:04<01:01,  1.85s/it]Best trial: 13. Best value: 0.17818:  68%|██████▊   | 68/100 [02:04<00:58,  1.82s/it]Best trial: 13. Best value: 0.17818:  68%|██████▊   | 68/100 [02:05<00:58,  1.82s/it]Best trial: 13. Best value: 0.17818:  69%|██████▉   | 69/100 [02:05<00:53,  1.73s/it]Best trial: 13. Best value: 0.17818:  69%|██████▉   | 69/100 [02:07<00:53,  1.73s/it]Best trial: 13. Best value: 0.17818:  70%|███████   | 70/100 [02:07<00:54,  1.80s/it]Best trial: 13. Best value: 0.17818:  70%|███████   | 70/100 [02:09<00:54,  1.80s/it]Best trial: 13. Best value: 0.17818:  71%|███████   | 71/100 [02:09<00:49,  1.71s/it]Best trial: 13. Best value: 0.17818:  71%|███████   | 71/100 [02:11<00:49,  1.71s/it]Best trial: 13. Best value: 0.17818:  72%|███████▏  | 72/100 [02:11<00:52,  1.87s/it]Best trial: 13. Best value: 0.17818:  72%|███████▏  | 72/100 [02:12<00:52,  1.87s/it]Best trial: 13. Best value: 0.17818:  73%|███████▎  | 73/100 [02:12<00:47,  1.75s/it]Best trial: 13. Best value: 0.17818:  73%|███████▎  | 73/100 [02:14<00:47,  1.75s/it]Best trial: 13. Best value: 0.17818:  74%|███████▍  | 74/100 [02:14<00:44,  1.70s/it]Best trial: 13. Best value: 0.17818:  74%|███████▍  | 74/100 [02:15<00:44,  1.70s/it]Best trial: 13. Best value: 0.17818:  75%|███████▌  | 75/100 [02:15<00:40,  1.60s/it]Best trial: 13. Best value: 0.17818:  75%|███████▌  | 75/100 [02:17<00:40,  1.60s/it]Best trial: 13. Best value: 0.17818:  76%|███████▌  | 76/100 [02:17<00:38,  1.61s/it]Best trial: 13. Best value: 0.17818:  76%|███████▌  | 76/100 [02:19<00:38,  1.61s/it]Best trial: 13. Best value: 0.17818:  77%|███████▋  | 77/100 [02:19<00:41,  1.81s/it]Best trial: 13. Best value: 0.17818:  77%|███████▋  | 77/100 [02:21<00:41,  1.81s/it]Best trial: 13. Best value: 0.17818:  78%|███████▊  | 78/100 [02:21<00:39,  1.82s/it]Best trial: 13. Best value: 0.17818:  78%|███████▊  | 78/100 [02:23<00:39,  1.82s/it]Best trial: 13. Best value: 0.17818:  79%|███████▉  | 79/100 [02:23<00:35,  1.71s/it]Best trial: 13. Best value: 0.17818:  79%|███████▉  | 79/100 [02:24<00:35,  1.71s/it]Best trial: 13. Best value: 0.17818:  80%|████████  | 80/100 [02:24<00:32,  1.64s/it]Best trial: 13. Best value: 0.17818:  80%|████████  | 80/100 [02:25<00:32,  1.64s/it]Best trial: 13. Best value: 0.17818:  81%|████████  | 81/100 [02:25<00:28,  1.51s/it]Best trial: 13. Best value: 0.17818:  81%|████████  | 81/100 [02:27<00:28,  1.51s/it]Best trial: 13. Best value: 0.17818:  82%|████████▏ | 82/100 [02:27<00:26,  1.47s/it]Best trial: 13. Best value: 0.17818:  82%|████████▏ | 82/100 [02:28<00:26,  1.47s/it]Best trial: 13. Best value: 0.17818:  83%|████████▎ | 83/100 [02:28<00:24,  1.45s/it]Best trial: 13. Best value: 0.17818:  83%|████████▎ | 83/100 [02:29<00:24,  1.45s/it]Best trial: 13. Best value: 0.17818:  84%|████████▍ | 84/100 [02:29<00:22,  1.43s/it]Best trial: 13. Best value: 0.17818:  84%|████████▍ | 84/100 [02:31<00:22,  1.43s/it]Best trial: 13. Best value: 0.17818:  85%|████████▌ | 85/100 [02:31<00:20,  1.40s/it]Best trial: 13. Best value: 0.17818:  85%|████████▌ | 85/100 [02:32<00:20,  1.40s/it]Best trial: 13. Best value: 0.17818:  86%|████████▌ | 86/100 [02:32<00:19,  1.42s/it]Best trial: 13. Best value: 0.17818:  86%|████████▌ | 86/100 [02:34<00:19,  1.42s/it]Best trial: 13. Best value: 0.17818:  87%|████████▋ | 87/100 [02:34<00:19,  1.49s/it]Best trial: 13. Best value: 0.17818:  87%|████████▋ | 87/100 [02:35<00:19,  1.49s/it]Best trial: 13. Best value: 0.17818:  88%|████████▊ | 88/100 [02:35<00:17,  1.46s/it]Best trial: 13. Best value: 0.17818:  88%|████████▊ | 88/100 [02:37<00:17,  1.46s/it]Best trial: 13. Best value: 0.17818:  89%|████████▉ | 89/100 [02:37<00:17,  1.57s/it]Best trial: 13. Best value: 0.17818:  89%|████████▉ | 89/100 [02:39<00:17,  1.57s/it]Best trial: 13. Best value: 0.17818:  90%|█████████ | 90/100 [02:39<00:17,  1.77s/it]Best trial: 13. Best value: 0.17818:  90%|█████████ | 90/100 [02:41<00:17,  1.77s/it]Best trial: 13. Best value: 0.17818:  91%|█████████ | 91/100 [02:41<00:14,  1.66s/it]Best trial: 13. Best value: 0.17818:  91%|█████████ | 91/100 [02:42<00:14,  1.66s/it]Best trial: 13. Best value: 0.17818:  92%|█████████▏| 92/100 [02:42<00:12,  1.60s/it]Best trial: 13. Best value: 0.17818:  92%|█████████▏| 92/100 [02:44<00:12,  1.60s/it]Best trial: 13. Best value: 0.17818:  93%|█████████▎| 93/100 [02:44<00:11,  1.69s/it]Best trial: 93. Best value: 0.179393:  93%|█████████▎| 93/100 [02:46<00:11,  1.69s/it]Best trial: 93. Best value: 0.179393:  94%|█████████▍| 94/100 [02:46<00:10,  1.82s/it]Best trial: 93. Best value: 0.179393:  94%|█████████▍| 94/100 [02:48<00:10,  1.82s/it]Best trial: 93. Best value: 0.179393:  95%|█████████▌| 95/100 [02:48<00:08,  1.72s/it]Best trial: 93. Best value: 0.179393:  95%|█████████▌| 95/100 [02:49<00:08,  1.72s/it]Best trial: 93. Best value: 0.179393:  96%|█████████▌| 96/100 [02:49<00:06,  1.67s/it]Best trial: 93. Best value: 0.179393:  96%|█████████▌| 96/100 [02:51<00:06,  1.67s/it]Best trial: 93. Best value: 0.179393:  97%|█████████▋| 97/100 [02:51<00:05,  1.83s/it]Best trial: 93. Best value: 0.179393:  97%|█████████▋| 97/100 [02:53<00:05,  1.83s/it]Best trial: 93. Best value: 0.179393:  98%|█████████▊| 98/100 [02:53<00:03,  1.76s/it]Best trial: 93. Best value: 0.179393:  98%|█████████▊| 98/100 [02:54<00:03,  1.76s/it]Best trial: 93. Best value: 0.179393:  99%|█████████▉| 99/100 [02:54<00:01,  1.64s/it]Best trial: 93. Best value: 0.179393:  99%|█████████▉| 99/100 [02:56<00:01,  1.64s/it]Best trial: 93. Best value: 0.179393: 100%|██████████| 100/100 [02:56<00:00,  1.61s/it]Best trial: 93. Best value: 0.179393: 100%|██████████| 100/100 [02:56<00:00,  1.76s/it]
2025-11-30 07:32:51,495 - INFO - HPO Complete. Best AUPRC: 0.1794
2025-11-30 07:32:51,496 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.002180533856995016, 'max_depth': 6, 'subsample': 0.7380947081640608, 'colsample_bytree': 0.791741809770731, 'gamma': 3.3581290375205133, 'reg_lambda': 1.3441162192283853e-07, 'reg_alpha': 0.2968512688218936}
2025-11-30 07:32:51,497 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:32:53,452 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 07:32:53,453 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:32:53,535 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:32:53,541 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:32:53,543 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:32:53,543 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:32:53,543 - INFO - Training model...
2025-11-30 07:32:54,245 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:32:58,897 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:32:58,897 - INFO - AUROC: 0.6026 (0.4566 - 0.6842)
2025-11-30 07:32:58,897 - INFO - AUPRC: 0.1268 (0.0463 - 0.2091)
2025-11-30 07:32:58,897 - INFO - Brier Score: 0.1887 (0.1873 - 0.1937)
2025-11-30 07:32:58,897 - INFO - Accuracy: 0.7225 (0.4240 - 0.9592)
2025-11-30 07:32:58,897 - INFO - Precision: 0.0806 (0.0589 - 1.0000)
2025-11-30 07:32:58,897 - INFO - Sensitivity (Recall): 0.4167 (0.0882 - 0.8262)
2025-11-30 07:32:58,897 - INFO - F1-Score: 0.1351 (0.1009 - 0.2480)
2025-11-30 07:32:58,897 - INFO - Best Threshold: 0.4600 (0.3960 - 0.5900)
2025-11-30 07:32:58,897 - INFO - Specificity: 0.7393 (0.4045 - 1.0000)
2025-11-30 07:32:58,907 - INFO - Calculating SHAP values...
2025-11-30 07:32:59,988 - INFO - SHAP plots saved.
2025-11-30 07:32:59,989 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:33:01,183 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 07:33:01,183 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:33:01,268 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:33:01,276 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:33:01,278 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:33:01,278 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.182801:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.182801:   1%|          | 1/100 [00:01<03:06,  1.89s/it]Best trial: 1. Best value: 0.185705:   1%|          | 1/100 [00:02<03:06,  1.89s/it]Best trial: 1. Best value: 0.185705:   2%|▏         | 2/100 [00:02<02:00,  1.23s/it]Best trial: 1. Best value: 0.185705:   2%|▏         | 2/100 [00:03<02:00,  1.23s/it]Best trial: 1. Best value: 0.185705:   3%|▎         | 3/100 [00:03<01:57,  1.21s/it]Best trial: 1. Best value: 0.185705:   3%|▎         | 3/100 [00:05<01:57,  1.21s/it]Best trial: 1. Best value: 0.185705:   4%|▍         | 4/100 [00:05<02:23,  1.49s/it]Best trial: 1. Best value: 0.185705:   4%|▍         | 4/100 [00:08<02:23,  1.49s/it]Best trial: 1. Best value: 0.185705:   5%|▌         | 5/100 [00:08<03:06,  1.96s/it]Best trial: 1. Best value: 0.185705:   5%|▌         | 5/100 [00:10<03:06,  1.96s/it]Best trial: 1. Best value: 0.185705:   6%|▌         | 6/100 [00:10<02:51,  1.82s/it]Best trial: 6. Best value: 0.197324:   6%|▌         | 6/100 [00:12<02:51,  1.82s/it]Best trial: 6. Best value: 0.197324:   7%|▋         | 7/100 [00:12<03:13,  2.08s/it]Best trial: 7. Best value: 0.200061:   7%|▋         | 7/100 [00:15<03:13,  2.08s/it]Best trial: 7. Best value: 0.200061:   8%|▊         | 8/100 [00:15<03:22,  2.20s/it]Best trial: 7. Best value: 0.200061:   8%|▊         | 8/100 [00:17<03:22,  2.20s/it]Best trial: 7. Best value: 0.200061:   9%|▉         | 9/100 [00:17<03:23,  2.24s/it]Best trial: 7. Best value: 0.200061:   9%|▉         | 9/100 [00:19<03:23,  2.24s/it]Best trial: 7. Best value: 0.200061:  10%|█         | 10/100 [00:19<03:11,  2.13s/it]Best trial: 7. Best value: 0.200061:  10%|█         | 10/100 [00:22<03:11,  2.13s/it]Best trial: 7. Best value: 0.200061:  11%|█         | 11/100 [00:22<03:34,  2.42s/it]Best trial: 7. Best value: 0.200061:  11%|█         | 11/100 [00:24<03:34,  2.42s/it]Best trial: 7. Best value: 0.200061:  12%|█▏        | 12/100 [00:24<03:11,  2.17s/it]Best trial: 7. Best value: 0.200061:  12%|█▏        | 12/100 [00:26<03:11,  2.17s/it]Best trial: 7. Best value: 0.200061:  13%|█▎        | 13/100 [00:26<03:13,  2.22s/it]Best trial: 7. Best value: 0.200061:  13%|█▎        | 13/100 [00:28<03:13,  2.22s/it]Best trial: 7. Best value: 0.200061:  14%|█▍        | 14/100 [00:28<03:08,  2.19s/it]Best trial: 7. Best value: 0.200061:  14%|█▍        | 14/100 [00:30<03:08,  2.19s/it]Best trial: 7. Best value: 0.200061:  15%|█▌        | 15/100 [00:30<02:58,  2.10s/it]Best trial: 7. Best value: 0.200061:  15%|█▌        | 15/100 [00:33<02:58,  2.10s/it]Best trial: 7. Best value: 0.200061:  16%|█▌        | 16/100 [00:33<03:09,  2.25s/it]Best trial: 16. Best value: 0.212989:  16%|█▌        | 16/100 [00:35<03:09,  2.25s/it]Best trial: 16. Best value: 0.212989:  17%|█▋        | 17/100 [00:35<03:04,  2.22s/it]Best trial: 16. Best value: 0.212989:  17%|█▋        | 17/100 [00:36<03:04,  2.22s/it]Best trial: 16. Best value: 0.212989:  18%|█▊        | 18/100 [00:36<02:36,  1.91s/it]Best trial: 16. Best value: 0.212989:  18%|█▊        | 18/100 [00:37<02:36,  1.91s/it]Best trial: 16. Best value: 0.212989:  19%|█▉        | 19/100 [00:37<02:23,  1.78s/it]Best trial: 16. Best value: 0.212989:  19%|█▉        | 19/100 [00:41<02:23,  1.78s/it]Best trial: 16. Best value: 0.212989:  20%|██        | 20/100 [00:41<03:00,  2.26s/it]Best trial: 16. Best value: 0.212989:  20%|██        | 20/100 [00:43<03:00,  2.26s/it]Best trial: 16. Best value: 0.212989:  21%|██        | 21/100 [00:43<02:54,  2.21s/it]Best trial: 16. Best value: 0.212989:  21%|██        | 21/100 [00:44<02:54,  2.21s/it]Best trial: 16. Best value: 0.212989:  22%|██▏       | 22/100 [00:44<02:25,  1.87s/it]Best trial: 16. Best value: 0.212989:  22%|██▏       | 22/100 [00:45<02:25,  1.87s/it]Best trial: 16. Best value: 0.212989:  23%|██▎       | 23/100 [00:45<01:59,  1.56s/it]Best trial: 16. Best value: 0.212989:  23%|██▎       | 23/100 [00:46<01:59,  1.56s/it]Best trial: 16. Best value: 0.212989:  24%|██▍       | 24/100 [00:46<01:49,  1.44s/it]Best trial: 16. Best value: 0.212989:  24%|██▍       | 24/100 [00:47<01:49,  1.44s/it]Best trial: 16. Best value: 0.212989:  25%|██▌       | 25/100 [00:47<01:46,  1.41s/it]Best trial: 16. Best value: 0.212989:  25%|██▌       | 25/100 [00:48<01:46,  1.41s/it]Best trial: 16. Best value: 0.212989:  26%|██▌       | 26/100 [00:48<01:35,  1.29s/it]Best trial: 16. Best value: 0.212989:  26%|██▌       | 26/100 [00:50<01:35,  1.29s/it]Best trial: 16. Best value: 0.212989:  27%|██▋       | 27/100 [00:50<01:40,  1.38s/it]Best trial: 16. Best value: 0.212989:  27%|██▋       | 27/100 [00:51<01:40,  1.38s/it]Best trial: 16. Best value: 0.212989:  28%|██▊       | 28/100 [00:51<01:38,  1.37s/it]Best trial: 16. Best value: 0.212989:  28%|██▊       | 28/100 [00:53<01:38,  1.37s/it]Best trial: 16. Best value: 0.212989:  29%|██▉       | 29/100 [00:53<01:40,  1.42s/it]Best trial: 16. Best value: 0.212989:  29%|██▉       | 29/100 [00:55<01:40,  1.42s/it]Best trial: 16. Best value: 0.212989:  30%|███       | 30/100 [00:55<01:53,  1.62s/it]Best trial: 16. Best value: 0.212989:  30%|███       | 30/100 [00:56<01:53,  1.62s/it]Best trial: 16. Best value: 0.212989:  31%|███       | 31/100 [00:56<01:49,  1.59s/it]Best trial: 16. Best value: 0.212989:  31%|███       | 31/100 [00:57<01:49,  1.59s/it]Best trial: 16. Best value: 0.212989:  32%|███▏      | 32/100 [00:57<01:32,  1.36s/it]Best trial: 16. Best value: 0.212989:  32%|███▏      | 32/100 [00:58<01:32,  1.36s/it]Best trial: 16. Best value: 0.212989:  33%|███▎      | 33/100 [00:58<01:18,  1.18s/it]Best trial: 16. Best value: 0.212989:  33%|███▎      | 33/100 [00:59<01:18,  1.18s/it]Best trial: 16. Best value: 0.212989:  34%|███▍      | 34/100 [00:59<01:15,  1.14s/it]Best trial: 16. Best value: 0.212989:  34%|███▍      | 34/100 [01:00<01:15,  1.14s/it]Best trial: 16. Best value: 0.212989:  35%|███▌      | 35/100 [01:00<01:13,  1.13s/it]Best trial: 16. Best value: 0.212989:  35%|███▌      | 35/100 [01:01<01:13,  1.13s/it]Best trial: 16. Best value: 0.212989:  36%|███▌      | 36/100 [01:01<01:10,  1.10s/it]Best trial: 16. Best value: 0.212989:  36%|███▌      | 36/100 [01:02<01:10,  1.10s/it]Best trial: 16. Best value: 0.212989:  37%|███▋      | 37/100 [01:02<01:09,  1.10s/it]Best trial: 16. Best value: 0.212989:  37%|███▋      | 37/100 [01:05<01:09,  1.10s/it]Best trial: 16. Best value: 0.212989:  38%|███▊      | 38/100 [01:05<01:38,  1.59s/it]Best trial: 16. Best value: 0.212989:  38%|███▊      | 38/100 [01:06<01:38,  1.59s/it]Best trial: 16. Best value: 0.212989:  39%|███▉      | 39/100 [01:06<01:34,  1.55s/it]Best trial: 16. Best value: 0.212989:  39%|███▉      | 39/100 [01:07<01:34,  1.55s/it]Best trial: 16. Best value: 0.212989:  40%|████      | 40/100 [01:07<01:17,  1.30s/it]Best trial: 16. Best value: 0.212989:  40%|████      | 40/100 [01:09<01:17,  1.30s/it]Best trial: 16. Best value: 0.212989:  41%|████      | 41/100 [01:09<01:30,  1.53s/it]Best trial: 16. Best value: 0.212989:  41%|████      | 41/100 [01:11<01:30,  1.53s/it]Best trial: 16. Best value: 0.212989:  42%|████▏     | 42/100 [01:11<01:42,  1.77s/it]Best trial: 16. Best value: 0.212989:  42%|████▏     | 42/100 [01:14<01:42,  1.77s/it]Best trial: 16. Best value: 0.212989:  43%|████▎     | 43/100 [01:14<01:47,  1.89s/it]Best trial: 16. Best value: 0.212989:  43%|████▎     | 43/100 [01:16<01:47,  1.89s/it]Best trial: 16. Best value: 0.212989:  44%|████▍     | 44/100 [01:16<01:59,  2.13s/it]Best trial: 16. Best value: 0.212989:  44%|████▍     | 44/100 [01:19<01:59,  2.13s/it]Best trial: 16. Best value: 0.212989:  45%|████▌     | 45/100 [01:19<02:01,  2.21s/it]Best trial: 16. Best value: 0.212989:  45%|████▌     | 45/100 [01:21<02:01,  2.21s/it]Best trial: 16. Best value: 0.212989:  46%|████▌     | 46/100 [01:21<01:55,  2.14s/it]Best trial: 16. Best value: 0.212989:  46%|████▌     | 46/100 [01:24<01:55,  2.14s/it]Best trial: 16. Best value: 0.212989:  47%|████▋     | 47/100 [01:24<02:04,  2.35s/it]Best trial: 16. Best value: 0.212989:  47%|████▋     | 47/100 [01:27<02:04,  2.35s/it]Best trial: 16. Best value: 0.212989:  48%|████▊     | 48/100 [01:27<02:26,  2.81s/it]Best trial: 16. Best value: 0.212989:  48%|████▊     | 48/100 [01:29<02:26,  2.81s/it]Best trial: 16. Best value: 0.212989:  49%|████▉     | 49/100 [01:29<02:08,  2.52s/it]Best trial: 16. Best value: 0.212989:  49%|████▉     | 49/100 [01:31<02:08,  2.52s/it]Best trial: 16. Best value: 0.212989:  50%|█████     | 50/100 [01:31<01:55,  2.32s/it]Best trial: 16. Best value: 0.212989:  50%|█████     | 50/100 [01:34<01:55,  2.32s/it]Best trial: 16. Best value: 0.212989:  51%|█████     | 51/100 [01:34<01:56,  2.38s/it]Best trial: 16. Best value: 0.212989:  51%|█████     | 51/100 [01:35<01:56,  2.38s/it]Best trial: 16. Best value: 0.212989:  52%|█████▏    | 52/100 [01:35<01:34,  1.96s/it]Best trial: 16. Best value: 0.212989:  52%|█████▏    | 52/100 [01:36<01:34,  1.96s/it]Best trial: 16. Best value: 0.212989:  53%|█████▎    | 53/100 [01:36<01:17,  1.65s/it]Best trial: 16. Best value: 0.212989:  53%|█████▎    | 53/100 [01:37<01:17,  1.65s/it]Best trial: 16. Best value: 0.212989:  54%|█████▍    | 54/100 [01:37<01:06,  1.45s/it]Best trial: 16. Best value: 0.212989:  54%|█████▍    | 54/100 [01:38<01:06,  1.45s/it]Best trial: 16. Best value: 0.212989:  55%|█████▌    | 55/100 [01:38<01:01,  1.36s/it]Best trial: 16. Best value: 0.212989:  55%|█████▌    | 55/100 [01:39<01:01,  1.36s/it]Best trial: 16. Best value: 0.212989:  56%|█████▌    | 56/100 [01:39<00:55,  1.25s/it]Best trial: 16. Best value: 0.212989:  56%|█████▌    | 56/100 [01:40<00:55,  1.25s/it]Best trial: 16. Best value: 0.212989:  57%|█████▋    | 57/100 [01:40<00:52,  1.23s/it]Best trial: 16. Best value: 0.212989:  57%|█████▋    | 57/100 [01:41<00:52,  1.23s/it]Best trial: 16. Best value: 0.212989:  58%|█████▊    | 58/100 [01:41<00:50,  1.19s/it]Best trial: 16. Best value: 0.212989:  58%|█████▊    | 58/100 [01:42<00:50,  1.19s/it]Best trial: 16. Best value: 0.212989:  59%|█████▉    | 59/100 [01:42<00:45,  1.10s/it]Best trial: 16. Best value: 0.212989:  59%|█████▉    | 59/100 [01:43<00:45,  1.10s/it]Best trial: 16. Best value: 0.212989:  60%|██████    | 60/100 [01:43<00:45,  1.13s/it]Best trial: 16. Best value: 0.212989:  60%|██████    | 60/100 [01:44<00:45,  1.13s/it]Best trial: 16. Best value: 0.212989:  61%|██████    | 61/100 [01:44<00:43,  1.10s/it]Best trial: 16. Best value: 0.212989:  61%|██████    | 61/100 [01:45<00:43,  1.10s/it]Best trial: 16. Best value: 0.212989:  62%|██████▏   | 62/100 [01:45<00:40,  1.07s/it]Best trial: 16. Best value: 0.212989:  62%|██████▏   | 62/100 [01:46<00:40,  1.07s/it]Best trial: 16. Best value: 0.212989:  63%|██████▎   | 63/100 [01:46<00:37,  1.02s/it]Best trial: 16. Best value: 0.212989:  63%|██████▎   | 63/100 [01:47<00:37,  1.02s/it]Best trial: 16. Best value: 0.212989:  64%|██████▍   | 64/100 [01:47<00:36,  1.01s/it]Best trial: 16. Best value: 0.212989:  64%|██████▍   | 64/100 [01:48<00:36,  1.01s/it]Best trial: 16. Best value: 0.212989:  65%|██████▌   | 65/100 [01:48<00:37,  1.07s/it]Best trial: 16. Best value: 0.212989:  65%|██████▌   | 65/100 [01:49<00:37,  1.07s/it]Best trial: 16. Best value: 0.212989:  66%|██████▌   | 66/100 [01:49<00:35,  1.04s/it]Best trial: 16. Best value: 0.212989:  66%|██████▌   | 66/100 [01:50<00:35,  1.04s/it]Best trial: 16. Best value: 0.212989:  67%|██████▋   | 67/100 [01:50<00:36,  1.10s/it]Best trial: 16. Best value: 0.212989:  67%|██████▋   | 67/100 [01:51<00:36,  1.10s/it]Best trial: 16. Best value: 0.212989:  68%|██████▊   | 68/100 [01:51<00:33,  1.04s/it]Best trial: 16. Best value: 0.212989:  68%|██████▊   | 68/100 [01:52<00:33,  1.04s/it]Best trial: 16. Best value: 0.212989:  69%|██████▉   | 69/100 [01:52<00:29,  1.04it/s]Best trial: 16. Best value: 0.212989:  69%|██████▉   | 69/100 [01:53<00:29,  1.04it/s]Best trial: 16. Best value: 0.212989:  70%|███████   | 70/100 [01:53<00:27,  1.09it/s]Best trial: 16. Best value: 0.212989:  70%|███████   | 70/100 [01:54<00:27,  1.09it/s]Best trial: 16. Best value: 0.212989:  71%|███████   | 71/100 [01:54<00:26,  1.09it/s]Best trial: 16. Best value: 0.212989:  71%|███████   | 71/100 [01:55<00:26,  1.09it/s]Best trial: 16. Best value: 0.212989:  72%|███████▏  | 72/100 [01:55<00:27,  1.03it/s]Best trial: 16. Best value: 0.212989:  72%|███████▏  | 72/100 [01:56<00:27,  1.03it/s]Best trial: 16. Best value: 0.212989:  73%|███████▎  | 73/100 [01:56<00:25,  1.05it/s]Best trial: 16. Best value: 0.212989:  73%|███████▎  | 73/100 [01:57<00:25,  1.05it/s]Best trial: 16. Best value: 0.212989:  74%|███████▍  | 74/100 [01:57<00:25,  1.01it/s]Best trial: 16. Best value: 0.212989:  74%|███████▍  | 74/100 [01:58<00:25,  1.01it/s]Best trial: 16. Best value: 0.212989:  75%|███████▌  | 75/100 [01:58<00:26,  1.07s/it]Best trial: 16. Best value: 0.212989:  75%|███████▌  | 75/100 [01:59<00:26,  1.07s/it]Best trial: 16. Best value: 0.212989:  76%|███████▌  | 76/100 [01:59<00:26,  1.12s/it]Best trial: 16. Best value: 0.212989:  76%|███████▌  | 76/100 [02:00<00:26,  1.12s/it]Best trial: 16. Best value: 0.212989:  77%|███████▋  | 77/100 [02:00<00:24,  1.07s/it]Best trial: 16. Best value: 0.212989:  77%|███████▋  | 77/100 [02:01<00:24,  1.07s/it]Best trial: 16. Best value: 0.212989:  78%|███████▊  | 78/100 [02:01<00:21,  1.01it/s]Best trial: 16. Best value: 0.212989:  78%|███████▊  | 78/100 [02:02<00:21,  1.01it/s]Best trial: 16. Best value: 0.212989:  79%|███████▉  | 79/100 [02:02<00:19,  1.07it/s]Best trial: 16. Best value: 0.212989:  79%|███████▉  | 79/100 [02:03<00:19,  1.07it/s]Best trial: 16. Best value: 0.212989:  80%|████████  | 80/100 [02:03<00:19,  1.02it/s]Best trial: 16. Best value: 0.212989:  80%|████████  | 80/100 [02:04<00:19,  1.02it/s]Best trial: 16. Best value: 0.212989:  81%|████████  | 81/100 [02:04<00:17,  1.09it/s]Best trial: 16. Best value: 0.212989:  81%|████████  | 81/100 [02:05<00:17,  1.09it/s]Best trial: 16. Best value: 0.212989:  82%|████████▏ | 82/100 [02:05<00:16,  1.06it/s]Best trial: 16. Best value: 0.212989:  82%|████████▏ | 82/100 [02:06<00:16,  1.06it/s]Best trial: 16. Best value: 0.212989:  83%|████████▎ | 83/100 [02:06<00:16,  1.06it/s]Best trial: 16. Best value: 0.212989:  83%|████████▎ | 83/100 [02:07<00:16,  1.06it/s]Best trial: 16. Best value: 0.212989:  84%|████████▍ | 84/100 [02:07<00:15,  1.05it/s]Best trial: 16. Best value: 0.212989:  84%|████████▍ | 84/100 [02:08<00:15,  1.05it/s]Best trial: 16. Best value: 0.212989:  85%|████████▌ | 85/100 [02:08<00:16,  1.10s/it]Best trial: 16. Best value: 0.212989:  85%|████████▌ | 85/100 [02:10<00:16,  1.10s/it]Best trial: 16. Best value: 0.212989:  86%|████████▌ | 86/100 [02:10<00:18,  1.30s/it]Best trial: 16. Best value: 0.212989:  86%|████████▌ | 86/100 [02:12<00:18,  1.30s/it]Best trial: 16. Best value: 0.212989:  87%|████████▋ | 87/100 [02:12<00:19,  1.52s/it]Best trial: 16. Best value: 0.212989:  87%|████████▋ | 87/100 [02:13<00:19,  1.52s/it]Best trial: 16. Best value: 0.212989:  88%|████████▊ | 88/100 [02:13<00:17,  1.49s/it]Best trial: 16. Best value: 0.212989:  88%|████████▊ | 88/100 [02:15<00:17,  1.49s/it]Best trial: 16. Best value: 0.212989:  89%|████████▉ | 89/100 [02:15<00:16,  1.46s/it]Best trial: 16. Best value: 0.212989:  89%|████████▉ | 89/100 [02:16<00:16,  1.46s/it]Best trial: 16. Best value: 0.212989:  90%|█████████ | 90/100 [02:16<00:14,  1.43s/it]Best trial: 16. Best value: 0.212989:  90%|█████████ | 90/100 [02:17<00:14,  1.43s/it]Best trial: 16. Best value: 0.212989:  91%|█████████ | 91/100 [02:17<00:10,  1.22s/it]Best trial: 16. Best value: 0.212989:  91%|█████████ | 91/100 [02:18<00:10,  1.22s/it]Best trial: 16. Best value: 0.212989:  92%|█████████▏| 92/100 [02:18<00:09,  1.14s/it]Best trial: 16. Best value: 0.212989:  92%|█████████▏| 92/100 [02:19<00:09,  1.14s/it]Best trial: 16. Best value: 0.212989:  93%|█████████▎| 93/100 [02:19<00:07,  1.11s/it]Best trial: 16. Best value: 0.212989:  93%|█████████▎| 93/100 [02:20<00:07,  1.11s/it]Best trial: 16. Best value: 0.212989:  94%|█████████▍| 94/100 [02:20<00:06,  1.08s/it]Best trial: 16. Best value: 0.212989:  94%|█████████▍| 94/100 [02:21<00:06,  1.08s/it]Best trial: 16. Best value: 0.212989:  95%|█████████▌| 95/100 [02:21<00:05,  1.09s/it]Best trial: 16. Best value: 0.212989:  95%|█████████▌| 95/100 [02:22<00:05,  1.09s/it]Best trial: 16. Best value: 0.212989:  96%|█████████▌| 96/100 [02:22<00:04,  1.12s/it]Best trial: 16. Best value: 0.212989:  96%|█████████▌| 96/100 [02:23<00:04,  1.12s/it]Best trial: 16. Best value: 0.212989:  97%|█████████▋| 97/100 [02:23<00:03,  1.16s/it]Best trial: 16. Best value: 0.212989:  97%|█████████▋| 97/100 [02:25<00:03,  1.16s/it]Best trial: 16. Best value: 0.212989:  98%|█████████▊| 98/100 [02:25<00:02,  1.16s/it]Best trial: 16. Best value: 0.212989:  98%|█████████▊| 98/100 [02:28<00:02,  1.16s/it]Best trial: 16. Best value: 0.212989:  99%|█████████▉| 99/100 [02:28<00:01,  1.73s/it]Best trial: 16. Best value: 0.212989:  99%|█████████▉| 99/100 [02:29<00:01,  1.73s/it]Best trial: 16. Best value: 0.212989: 100%|██████████| 100/100 [02:29<00:00,  1.56s/it]Best trial: 16. Best value: 0.212989: 100%|██████████| 100/100 [02:29<00:00,  1.49s/it]
2025-11-30 07:35:30,565 - INFO - HPO Complete. Best AUPRC: 0.2130
2025-11-30 07:35:30,566 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.03174072126761788, 'max_depth': 9, 'subsample': 0.6486763264484566, 'colsample_bytree': 0.6674792370591744, 'gamma': 4.979826159735195, 'reg_lambda': 4.535528541436677e-07, 'reg_alpha': 3.1813693416826723e-06}
2025-11-30 07:35:30,566 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:35:32,457 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 07:35:32,457 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:35:32,566 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:35:32,574 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:35:32,575 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 07:35:32,576 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:35:32,576 - INFO - Training model...
2025-11-30 07:35:34,231 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:35:39,054 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:35:39,054 - INFO - AUROC: 0.6706 (0.5915 - 0.7631)
2025-11-30 07:35:39,054 - INFO - AUPRC: 0.1726 (0.0878 - 0.2922)
2025-11-30 07:35:39,054 - INFO - Brier Score: 0.0579 (0.0483 - 0.0728)
2025-11-30 07:35:39,054 - INFO - Accuracy: 0.9292 (0.7162 - 0.9595)
2025-11-30 07:35:39,054 - INFO - Precision: 0.2759 (0.0960 - 0.7397)
2025-11-30 07:35:39,054 - INFO - Sensitivity (Recall): 0.2222 (0.1269 - 0.6599)
2025-11-30 07:35:39,054 - INFO - F1-Score: 0.2462 (0.1547 - 0.3454)
2025-11-30 07:35:39,054 - INFO - Best Threshold: 0.4400 (0.0900 - 0.7700)
2025-11-30 07:35:39,054 - INFO - Specificity: 0.9680 (0.7219 - 0.9970)
2025-11-30 07:35:39,071 - INFO - Calculating SHAP values...
2025-11-30 07:35:40,355 - INFO - SHAP plots saved.
2025-11-30 07:35:40,358 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:35:41,909 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 07:35:41,909 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:35:41,999 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:35:42,020 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:35:42,024 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 07:35:42,024 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.165224:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.165224:   1%|          | 1/100 [00:02<03:42,  2.24s/it]Best trial: 0. Best value: 0.165224:   1%|          | 1/100 [00:06<03:42,  2.24s/it]Best trial: 0. Best value: 0.165224:   2%|▏         | 2/100 [00:06<05:31,  3.39s/it]Best trial: 2. Best value: 0.177059:   2%|▏         | 2/100 [00:08<05:31,  3.39s/it]Best trial: 2. Best value: 0.177059:   3%|▎         | 3/100 [00:08<04:34,  2.83s/it]Best trial: 2. Best value: 0.177059:   3%|▎         | 3/100 [00:12<04:34,  2.83s/it]Best trial: 2. Best value: 0.177059:   4%|▍         | 4/100 [00:12<05:15,  3.28s/it]Best trial: 2. Best value: 0.177059:   4%|▍         | 4/100 [00:15<05:15,  3.28s/it]Best trial: 2. Best value: 0.177059:   5%|▌         | 5/100 [00:15<05:12,  3.29s/it]Best trial: 2. Best value: 0.177059:   5%|▌         | 5/100 [00:21<05:12,  3.29s/it]Best trial: 2. Best value: 0.177059:   6%|▌         | 6/100 [00:21<06:10,  3.94s/it]Best trial: 2. Best value: 0.177059:   6%|▌         | 6/100 [00:22<06:10,  3.94s/it]Best trial: 2. Best value: 0.177059:   7%|▋         | 7/100 [00:22<05:00,  3.23s/it]Best trial: 7. Best value: 0.181592:   7%|▋         | 7/100 [00:24<05:00,  3.23s/it]Best trial: 7. Best value: 0.181592:   8%|▊         | 8/100 [00:24<04:06,  2.68s/it]Best trial: 7. Best value: 0.181592:   8%|▊         | 8/100 [00:27<04:06,  2.68s/it]Best trial: 7. Best value: 0.181592:   9%|▉         | 9/100 [00:27<04:09,  2.74s/it]Best trial: 7. Best value: 0.181592:   9%|▉         | 9/100 [00:29<04:09,  2.74s/it]Best trial: 7. Best value: 0.181592:  10%|█         | 10/100 [00:29<03:53,  2.59s/it]Best trial: 10. Best value: 0.187747:  10%|█         | 10/100 [00:32<03:53,  2.59s/it]Best trial: 10. Best value: 0.187747:  11%|█         | 11/100 [00:32<04:10,  2.81s/it]Best trial: 10. Best value: 0.187747:  11%|█         | 11/100 [00:35<04:10,  2.81s/it]Best trial: 10. Best value: 0.187747:  12%|█▏        | 12/100 [00:35<04:08,  2.82s/it]Best trial: 10. Best value: 0.187747:  12%|█▏        | 12/100 [00:40<04:08,  2.82s/it]Best trial: 10. Best value: 0.187747:  13%|█▎        | 13/100 [00:40<04:49,  3.32s/it]Best trial: 10. Best value: 0.187747:  13%|█▎        | 13/100 [00:43<04:49,  3.32s/it]Best trial: 10. Best value: 0.187747:  14%|█▍        | 14/100 [00:43<04:49,  3.36s/it]Best trial: 10. Best value: 0.187747:  14%|█▍        | 14/100 [00:47<04:49,  3.36s/it]Best trial: 10. Best value: 0.187747:  15%|█▌        | 15/100 [00:47<05:06,  3.61s/it]Best trial: 10. Best value: 0.187747:  15%|█▌        | 15/100 [00:51<05:06,  3.61s/it]Best trial: 10. Best value: 0.187747:  16%|█▌        | 16/100 [00:51<04:58,  3.55s/it]Best trial: 10. Best value: 0.187747:  16%|█▌        | 16/100 [00:54<04:58,  3.55s/it]Best trial: 10. Best value: 0.187747:  17%|█▋        | 17/100 [00:54<04:38,  3.35s/it]Best trial: 10. Best value: 0.187747:  17%|█▋        | 17/100 [00:57<04:38,  3.35s/it]Best trial: 10. Best value: 0.187747:  18%|█▊        | 18/100 [00:57<04:46,  3.49s/it]Best trial: 10. Best value: 0.187747:  18%|█▊        | 18/100 [01:01<04:46,  3.49s/it]Best trial: 10. Best value: 0.187747:  19%|█▉        | 19/100 [01:01<04:47,  3.55s/it]Best trial: 10. Best value: 0.187747:  19%|█▉        | 19/100 [01:04<04:47,  3.55s/it]Best trial: 10. Best value: 0.187747:  20%|██        | 20/100 [01:04<04:26,  3.33s/it]Best trial: 10. Best value: 0.187747:  20%|██        | 20/100 [01:06<04:26,  3.33s/it]Best trial: 10. Best value: 0.187747:  21%|██        | 21/100 [01:06<04:01,  3.05s/it]Best trial: 10. Best value: 0.187747:  21%|██        | 21/100 [01:10<04:01,  3.05s/it]Best trial: 10. Best value: 0.187747:  22%|██▏       | 22/100 [01:10<04:19,  3.33s/it]Best trial: 10. Best value: 0.187747:  22%|██▏       | 22/100 [01:15<04:19,  3.33s/it]Best trial: 10. Best value: 0.187747:  23%|██▎       | 23/100 [01:15<04:44,  3.69s/it]Best trial: 10. Best value: 0.187747:  23%|██▎       | 23/100 [01:19<04:44,  3.69s/it]Best trial: 10. Best value: 0.187747:  24%|██▍       | 24/100 [01:19<04:44,  3.74s/it]Best trial: 10. Best value: 0.187747:  24%|██▍       | 24/100 [01:22<04:44,  3.74s/it]Best trial: 10. Best value: 0.187747:  25%|██▌       | 25/100 [01:22<04:42,  3.77s/it]Best trial: 10. Best value: 0.187747:  25%|██▌       | 25/100 [01:26<04:42,  3.77s/it]Best trial: 10. Best value: 0.187747:  26%|██▌       | 26/100 [01:26<04:24,  3.57s/it]Best trial: 10. Best value: 0.187747:  26%|██▌       | 26/100 [01:31<04:24,  3.57s/it]Best trial: 10. Best value: 0.187747:  27%|██▋       | 27/100 [01:31<05:07,  4.21s/it]Best trial: 10. Best value: 0.187747:  27%|██▋       | 27/100 [01:35<05:07,  4.21s/it]Best trial: 10. Best value: 0.187747:  28%|██▊       | 28/100 [01:35<04:42,  3.93s/it]Best trial: 10. Best value: 0.187747:  28%|██▊       | 28/100 [01:38<04:42,  3.93s/it]Best trial: 10. Best value: 0.187747:  29%|██▉       | 29/100 [01:38<04:22,  3.70s/it]Best trial: 10. Best value: 0.187747:  29%|██▉       | 29/100 [01:42<04:22,  3.70s/it]Best trial: 10. Best value: 0.187747:  30%|███       | 30/100 [01:42<04:25,  3.79s/it]Best trial: 10. Best value: 0.187747:  30%|███       | 30/100 [01:47<04:25,  3.79s/it]Best trial: 10. Best value: 0.187747:  31%|███       | 31/100 [01:47<05:00,  4.35s/it]Best trial: 10. Best value: 0.187747:  31%|███       | 31/100 [01:50<05:00,  4.35s/it]Best trial: 10. Best value: 0.187747:  32%|███▏      | 32/100 [01:50<04:11,  3.70s/it]Best trial: 10. Best value: 0.187747:  32%|███▏      | 32/100 [01:52<04:11,  3.70s/it]Best trial: 10. Best value: 0.187747:  33%|███▎      | 33/100 [01:52<03:35,  3.22s/it]Best trial: 10. Best value: 0.187747:  33%|███▎      | 33/100 [01:54<03:35,  3.22s/it]Best trial: 10. Best value: 0.187747:  34%|███▍      | 34/100 [01:54<03:08,  2.86s/it]Best trial: 10. Best value: 0.187747:  34%|███▍      | 34/100 [01:56<03:08,  2.86s/it]Best trial: 10. Best value: 0.187747:  35%|███▌      | 35/100 [01:56<02:54,  2.68s/it]Best trial: 10. Best value: 0.187747:  35%|███▌      | 35/100 [01:58<02:54,  2.68s/it]Best trial: 10. Best value: 0.187747:  36%|███▌      | 36/100 [01:58<02:39,  2.50s/it]Best trial: 10. Best value: 0.187747:  36%|███▌      | 36/100 [02:00<02:39,  2.50s/it]Best trial: 10. Best value: 0.187747:  37%|███▋      | 37/100 [02:00<02:34,  2.44s/it]Best trial: 10. Best value: 0.187747:  37%|███▋      | 37/100 [02:03<02:34,  2.44s/it]Best trial: 10. Best value: 0.187747:  38%|███▊      | 38/100 [02:03<02:40,  2.58s/it]Best trial: 10. Best value: 0.187747:  38%|███▊      | 38/100 [02:05<02:40,  2.58s/it]Best trial: 10. Best value: 0.187747:  39%|███▉      | 39/100 [02:05<02:27,  2.42s/it]Best trial: 10. Best value: 0.187747:  39%|███▉      | 39/100 [02:07<02:27,  2.42s/it]Best trial: 10. Best value: 0.187747:  40%|████      | 40/100 [02:07<02:18,  2.31s/it]Best trial: 40. Best value: 0.190957:  40%|████      | 40/100 [02:10<02:18,  2.31s/it]Best trial: 40. Best value: 0.190957:  41%|████      | 41/100 [02:10<02:20,  2.38s/it]Best trial: 40. Best value: 0.190957:  41%|████      | 41/100 [02:12<02:20,  2.38s/it]Best trial: 40. Best value: 0.190957:  42%|████▏     | 42/100 [02:12<02:21,  2.44s/it]Best trial: 40. Best value: 0.190957:  42%|████▏     | 42/100 [02:14<02:21,  2.44s/it]Best trial: 40. Best value: 0.190957:  43%|████▎     | 43/100 [02:14<02:10,  2.29s/it]Best trial: 40. Best value: 0.190957:  43%|████▎     | 43/100 [02:17<02:10,  2.29s/it]Best trial: 40. Best value: 0.190957:  44%|████▍     | 44/100 [02:17<02:06,  2.25s/it]Best trial: 40. Best value: 0.190957:  44%|████▍     | 44/100 [02:19<02:06,  2.25s/it]Best trial: 40. Best value: 0.190957:  45%|████▌     | 45/100 [02:19<01:59,  2.17s/it]Best trial: 40. Best value: 0.190957:  45%|████▌     | 45/100 [02:21<01:59,  2.17s/it]Best trial: 40. Best value: 0.190957:  46%|████▌     | 46/100 [02:21<01:55,  2.13s/it]Best trial: 40. Best value: 0.190957:  46%|████▌     | 46/100 [02:23<01:55,  2.13s/it]Best trial: 40. Best value: 0.190957:  47%|████▋     | 47/100 [02:23<01:50,  2.08s/it]Best trial: 40. Best value: 0.190957:  47%|████▋     | 47/100 [02:25<01:50,  2.08s/it]Best trial: 40. Best value: 0.190957:  48%|████▊     | 48/100 [02:25<01:49,  2.10s/it]Best trial: 40. Best value: 0.190957:  48%|████▊     | 48/100 [02:28<01:49,  2.10s/it]Best trial: 40. Best value: 0.190957:  49%|████▉     | 49/100 [02:28<02:05,  2.47s/it]Best trial: 40. Best value: 0.190957:  49%|████▉     | 49/100 [02:30<02:05,  2.47s/it]Best trial: 40. Best value: 0.190957:  50%|█████     | 50/100 [02:30<02:02,  2.45s/it]Best trial: 40. Best value: 0.190957:  50%|█████     | 50/100 [02:33<02:02,  2.45s/it]Best trial: 40. Best value: 0.190957:  51%|█████     | 51/100 [02:33<01:55,  2.36s/it]Best trial: 51. Best value: 0.192268:  51%|█████     | 51/100 [02:34<01:55,  2.36s/it]Best trial: 51. Best value: 0.192268:  52%|█████▏    | 52/100 [02:34<01:45,  2.20s/it]Best trial: 51. Best value: 0.192268:  52%|█████▏    | 52/100 [02:38<01:45,  2.20s/it]Best trial: 51. Best value: 0.192268:  53%|█████▎    | 53/100 [02:38<02:04,  2.66s/it]Best trial: 51. Best value: 0.192268:  53%|█████▎    | 53/100 [02:40<02:04,  2.66s/it]Best trial: 51. Best value: 0.192268:  54%|█████▍    | 54/100 [02:40<01:53,  2.48s/it]Best trial: 54. Best value: 0.199965:  54%|█████▍    | 54/100 [02:43<01:53,  2.48s/it]Best trial: 54. Best value: 0.199965:  55%|█████▌    | 55/100 [02:43<01:53,  2.53s/it]Best trial: 54. Best value: 0.199965:  55%|█████▌    | 55/100 [02:45<01:53,  2.53s/it]Best trial: 54. Best value: 0.199965:  56%|█████▌    | 56/100 [02:45<01:51,  2.53s/it]Best trial: 54. Best value: 0.199965:  56%|█████▌    | 56/100 [02:47<01:51,  2.53s/it]Best trial: 54. Best value: 0.199965:  57%|█████▋    | 57/100 [02:47<01:40,  2.34s/it]Best trial: 54. Best value: 0.199965:  57%|█████▋    | 57/100 [02:50<01:40,  2.34s/it]Best trial: 54. Best value: 0.199965:  58%|█████▊    | 58/100 [02:50<01:40,  2.40s/it]Best trial: 54. Best value: 0.199965:  58%|█████▊    | 58/100 [02:53<01:40,  2.40s/it]Best trial: 54. Best value: 0.199965:  59%|█████▉    | 59/100 [02:53<01:44,  2.56s/it]Best trial: 54. Best value: 0.199965:  59%|█████▉    | 59/100 [02:56<01:44,  2.56s/it]Best trial: 54. Best value: 0.199965:  60%|██████    | 60/100 [02:56<01:46,  2.67s/it]Best trial: 54. Best value: 0.199965:  60%|██████    | 60/100 [02:58<01:46,  2.67s/it]Best trial: 54. Best value: 0.199965:  61%|██████    | 61/100 [02:58<01:44,  2.68s/it]Best trial: 54. Best value: 0.199965:  61%|██████    | 61/100 [03:01<01:44,  2.68s/it]Best trial: 54. Best value: 0.199965:  62%|██████▏   | 62/100 [03:01<01:37,  2.57s/it]Best trial: 62. Best value: 0.207348:  62%|██████▏   | 62/100 [03:03<01:37,  2.57s/it]Best trial: 62. Best value: 0.207348:  63%|██████▎   | 63/100 [03:03<01:34,  2.55s/it]Best trial: 62. Best value: 0.207348:  63%|██████▎   | 63/100 [03:06<01:34,  2.55s/it]Best trial: 62. Best value: 0.207348:  64%|██████▍   | 64/100 [03:06<01:29,  2.50s/it]Best trial: 62. Best value: 0.207348:  64%|██████▍   | 64/100 [03:08<01:29,  2.50s/it]Best trial: 62. Best value: 0.207348:  65%|██████▌   | 65/100 [03:08<01:29,  2.56s/it]Best trial: 62. Best value: 0.207348:  65%|██████▌   | 65/100 [03:11<01:29,  2.56s/it]Best trial: 62. Best value: 0.207348:  66%|██████▌   | 66/100 [03:11<01:26,  2.56s/it]Best trial: 62. Best value: 0.207348:  66%|██████▌   | 66/100 [03:13<01:26,  2.56s/it]Best trial: 62. Best value: 0.207348:  67%|██████▋   | 67/100 [03:13<01:24,  2.56s/it]Best trial: 62. Best value: 0.207348:  67%|██████▋   | 67/100 [03:16<01:24,  2.56s/it]Best trial: 62. Best value: 0.207348:  68%|██████▊   | 68/100 [03:16<01:21,  2.54s/it]Best trial: 62. Best value: 0.207348:  68%|██████▊   | 68/100 [03:19<01:21,  2.54s/it]Best trial: 62. Best value: 0.207348:  69%|██████▉   | 69/100 [03:19<01:26,  2.78s/it]Best trial: 62. Best value: 0.207348:  69%|██████▉   | 69/100 [03:21<01:26,  2.78s/it]Best trial: 62. Best value: 0.207348:  70%|███████   | 70/100 [03:21<01:18,  2.61s/it]Best trial: 62. Best value: 0.207348:  70%|███████   | 70/100 [03:24<01:18,  2.61s/it]Best trial: 62. Best value: 0.207348:  71%|███████   | 71/100 [03:24<01:17,  2.67s/it]Best trial: 62. Best value: 0.207348:  71%|███████   | 71/100 [03:27<01:17,  2.67s/it]Best trial: 62. Best value: 0.207348:  72%|███████▏  | 72/100 [03:27<01:16,  2.73s/it]Best trial: 62. Best value: 0.207348:  72%|███████▏  | 72/100 [03:29<01:16,  2.73s/it]Best trial: 62. Best value: 0.207348:  73%|███████▎  | 73/100 [03:29<01:06,  2.47s/it]Best trial: 62. Best value: 0.207348:  73%|███████▎  | 73/100 [03:31<01:06,  2.47s/it]Best trial: 62. Best value: 0.207348:  74%|███████▍  | 74/100 [03:31<00:59,  2.30s/it]Best trial: 62. Best value: 0.207348:  74%|███████▍  | 74/100 [03:33<00:59,  2.30s/it]Best trial: 62. Best value: 0.207348:  75%|███████▌  | 75/100 [03:33<00:53,  2.13s/it]Best trial: 62. Best value: 0.207348:  75%|███████▌  | 75/100 [03:36<00:53,  2.13s/it]Best trial: 62. Best value: 0.207348:  76%|███████▌  | 76/100 [03:36<00:59,  2.46s/it]Best trial: 62. Best value: 0.207348:  76%|███████▌  | 76/100 [03:39<00:59,  2.46s/it]Best trial: 62. Best value: 0.207348:  77%|███████▋  | 77/100 [03:39<01:02,  2.72s/it]Best trial: 62. Best value: 0.207348:  77%|███████▋  | 77/100 [03:43<01:02,  2.72s/it]Best trial: 62. Best value: 0.207348:  78%|███████▊  | 78/100 [03:43<01:07,  3.05s/it]Best trial: 62. Best value: 0.207348:  78%|███████▊  | 78/100 [03:47<01:07,  3.05s/it]Best trial: 62. Best value: 0.207348:  79%|███████▉  | 79/100 [03:47<01:07,  3.23s/it]Best trial: 62. Best value: 0.207348:  79%|███████▉  | 79/100 [03:49<01:07,  3.23s/it]Best trial: 62. Best value: 0.207348:  80%|████████  | 80/100 [03:49<01:00,  3.00s/it]Best trial: 62. Best value: 0.207348:  80%|████████  | 80/100 [03:53<01:00,  3.00s/it]Best trial: 62. Best value: 0.207348:  81%|████████  | 81/100 [03:53<00:59,  3.12s/it]Best trial: 62. Best value: 0.207348:  81%|████████  | 81/100 [03:57<00:59,  3.12s/it]Best trial: 62. Best value: 0.207348:  82%|████████▏ | 82/100 [03:57<01:03,  3.52s/it]Best trial: 62. Best value: 0.207348:  82%|████████▏ | 82/100 [03:59<01:03,  3.52s/it]Best trial: 62. Best value: 0.207348:  83%|████████▎ | 83/100 [03:59<00:54,  3.19s/it]Best trial: 62. Best value: 0.207348:  83%|████████▎ | 83/100 [04:03<00:54,  3.19s/it]Best trial: 62. Best value: 0.207348:  84%|████████▍ | 84/100 [04:03<00:52,  3.30s/it]Best trial: 62. Best value: 0.207348:  84%|████████▍ | 84/100 [04:07<00:52,  3.30s/it]Best trial: 62. Best value: 0.207348:  85%|████████▌ | 85/100 [04:07<00:51,  3.43s/it]Best trial: 62. Best value: 0.207348:  85%|████████▌ | 85/100 [04:10<00:51,  3.43s/it]Best trial: 62. Best value: 0.207348:  86%|████████▌ | 86/100 [04:10<00:46,  3.35s/it]Best trial: 62. Best value: 0.207348:  86%|████████▌ | 86/100 [04:12<00:46,  3.35s/it]Best trial: 62. Best value: 0.207348:  87%|████████▋ | 87/100 [04:12<00:40,  3.10s/it]Best trial: 62. Best value: 0.207348:  87%|████████▋ | 87/100 [04:14<00:40,  3.10s/it]Best trial: 62. Best value: 0.207348:  88%|████████▊ | 88/100 [04:14<00:32,  2.74s/it]Best trial: 62. Best value: 0.207348:  88%|████████▊ | 88/100 [04:16<00:32,  2.74s/it]Best trial: 62. Best value: 0.207348:  89%|████████▉ | 89/100 [04:16<00:28,  2.55s/it]Best trial: 62. Best value: 0.207348:  89%|████████▉ | 89/100 [04:19<00:28,  2.55s/it]Best trial: 62. Best value: 0.207348:  90%|█████████ | 90/100 [04:19<00:26,  2.64s/it]Best trial: 62. Best value: 0.207348:  90%|█████████ | 90/100 [04:21<00:26,  2.64s/it]Best trial: 62. Best value: 0.207348:  91%|█████████ | 91/100 [04:21<00:22,  2.47s/it]Best trial: 62. Best value: 0.207348:  91%|█████████ | 91/100 [04:23<00:22,  2.47s/it]Best trial: 62. Best value: 0.207348:  92%|█████████▏| 92/100 [04:23<00:18,  2.30s/it]Best trial: 62. Best value: 0.207348:  92%|█████████▏| 92/100 [04:25<00:18,  2.30s/it]Best trial: 62. Best value: 0.207348:  93%|█████████▎| 93/100 [04:25<00:16,  2.29s/it]Best trial: 62. Best value: 0.207348:  93%|█████████▎| 93/100 [04:27<00:16,  2.29s/it]Best trial: 62. Best value: 0.207348:  94%|█████████▍| 94/100 [04:27<00:12,  2.07s/it]Best trial: 62. Best value: 0.207348:  94%|█████████▍| 94/100 [04:29<00:12,  2.07s/it]Best trial: 62. Best value: 0.207348:  95%|█████████▌| 95/100 [04:29<00:10,  2.11s/it]Best trial: 62. Best value: 0.207348:  95%|█████████▌| 95/100 [04:31<00:10,  2.11s/it]Best trial: 62. Best value: 0.207348:  96%|█████████▌| 96/100 [04:31<00:07,  1.96s/it]Best trial: 62. Best value: 0.207348:  96%|█████████▌| 96/100 [04:32<00:07,  1.96s/it]Best trial: 62. Best value: 0.207348:  97%|█████████▋| 97/100 [04:32<00:05,  1.86s/it]Best trial: 62. Best value: 0.207348:  97%|█████████▋| 97/100 [04:35<00:05,  1.86s/it]Best trial: 62. Best value: 0.207348:  98%|█████████▊| 98/100 [04:35<00:04,  2.17s/it]Best trial: 62. Best value: 0.207348:  98%|█████████▊| 98/100 [04:37<00:04,  2.17s/it]Best trial: 62. Best value: 0.207348:  99%|█████████▉| 99/100 [04:37<00:02,  2.16s/it]Best trial: 62. Best value: 0.207348:  99%|█████████▉| 99/100 [04:39<00:02,  2.16s/it]Best trial: 62. Best value: 0.207348: 100%|██████████| 100/100 [04:39<00:00,  2.08s/it]Best trial: 62. Best value: 0.207348: 100%|██████████| 100/100 [04:39<00:00,  2.80s/it]
2025-11-30 07:40:21,882 - INFO - HPO Complete. Best AUPRC: 0.2073
2025-11-30 07:40:21,882 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.003787933681600137, 'max_depth': 4, 'subsample': 0.6109933807832393, 'colsample_bytree': 0.7196844085743519, 'gamma': 2.4021310735492785, 'reg_lambda': 0.45671820128996843, 'reg_alpha': 0.000407671264337539}
2025-11-30 07:40:21,883 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:40:23,988 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 07:40:23,988 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:40:24,078 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:40:24,098 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:40:24,103 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 07:40:24,103 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:40:24,103 - INFO - Training model...
2025-11-30 07:40:28,974 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:40:33,991 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:40:33,991 - INFO - AUROC: 0.6832 (0.5484 - 0.7748)
2025-11-30 07:40:33,991 - INFO - AUPRC: 0.1646 (0.0877 - 0.2392)
2025-11-30 07:40:33,991 - INFO - Brier Score: 0.0900 (0.0847 - 0.0994)
2025-11-30 07:40:33,991 - INFO - Accuracy: 0.8916 (0.7358 - 0.9408)
2025-11-30 07:40:33,991 - INFO - Precision: 0.2000 (0.1109 - 0.4545)
2025-11-30 07:40:33,991 - INFO - Sensitivity (Recall): 0.3611 (0.2237 - 0.5830)
2025-11-30 07:40:33,991 - INFO - F1-Score: 0.2574 (0.1636 - 0.3460)
2025-11-30 07:40:33,991 - INFO - Best Threshold: 0.4500 (0.3180 - 0.6340)
2025-11-30 07:40:33,991 - INFO - Specificity: 0.9207 (0.7484 - 0.9765)
2025-11-30 07:40:34,017 - INFO - Calculating SHAP values...
2025-11-30 07:40:35,218 - INFO - SHAP plots saved.
2025-11-30 07:40:35,220 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:40:36,585 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 07:40:36,585 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:40:36,700 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:40:36,744 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:40:36,757 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 07:40:36,757 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.482294:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.482294:   1%|          | 1/100 [00:06<10:29,  6.36s/it]Best trial: 1. Best value: 0.486199:   1%|          | 1/100 [00:11<10:29,  6.36s/it]Best trial: 1. Best value: 0.486199:   2%|▏         | 2/100 [00:11<08:45,  5.36s/it]Best trial: 2. Best value: 0.50555:   2%|▏         | 2/100 [00:15<08:45,  5.36s/it] Best trial: 2. Best value: 0.50555:   3%|▎         | 3/100 [00:15<07:59,  4.94s/it]Best trial: 2. Best value: 0.50555:   3%|▎         | 3/100 [00:21<07:59,  4.94s/it]Best trial: 2. Best value: 0.50555:   4%|▍         | 4/100 [00:21<08:33,  5.35s/it]Best trial: 2. Best value: 0.50555:   4%|▍         | 4/100 [00:25<08:33,  5.35s/it]Best trial: 2. Best value: 0.50555:   5%|▌         | 5/100 [00:25<07:42,  4.87s/it]Best trial: 2. Best value: 0.50555:   5%|▌         | 5/100 [00:30<07:42,  4.87s/it]Best trial: 2. Best value: 0.50555:   6%|▌         | 6/100 [00:30<07:27,  4.76s/it]Best trial: 2. Best value: 0.50555:   6%|▌         | 6/100 [00:37<07:27,  4.76s/it]Best trial: 2. Best value: 0.50555:   7%|▋         | 7/100 [00:37<08:41,  5.61s/it]Best trial: 2. Best value: 0.50555:   7%|▋         | 7/100 [00:42<08:41,  5.61s/it]Best trial: 2. Best value: 0.50555:   8%|▊         | 8/100 [00:42<08:33,  5.58s/it]Best trial: 2. Best value: 0.50555:   8%|▊         | 8/100 [00:46<08:33,  5.58s/it]Best trial: 2. Best value: 0.50555:   9%|▉         | 9/100 [00:46<07:37,  5.03s/it]Best trial: 2. Best value: 0.50555:   9%|▉         | 9/100 [00:50<07:37,  5.03s/it]Best trial: 2. Best value: 0.50555:  10%|█         | 10/100 [00:50<07:11,  4.80s/it]Best trial: 2. Best value: 0.50555:  10%|█         | 10/100 [00:53<07:11,  4.80s/it]Best trial: 2. Best value: 0.50555:  11%|█         | 11/100 [00:53<06:09,  4.15s/it]Best trial: 2. Best value: 0.50555:  11%|█         | 11/100 [00:57<06:09,  4.15s/it]Best trial: 2. Best value: 0.50555:  12%|█▏        | 12/100 [00:57<05:56,  4.05s/it]Best trial: 2. Best value: 0.50555:  12%|█▏        | 12/100 [01:00<05:56,  4.05s/it]Best trial: 2. Best value: 0.50555:  13%|█▎        | 13/100 [01:00<05:33,  3.84s/it]Best trial: 2. Best value: 0.50555:  13%|█▎        | 13/100 [01:04<05:33,  3.84s/it]Best trial: 2. Best value: 0.50555:  14%|█▍        | 14/100 [01:04<05:13,  3.64s/it]Best trial: 2. Best value: 0.50555:  14%|█▍        | 14/100 [01:07<05:13,  3.64s/it]Best trial: 2. Best value: 0.50555:  15%|█▌        | 15/100 [01:07<05:09,  3.64s/it]Best trial: 2. Best value: 0.50555:  15%|█▌        | 15/100 [01:12<05:09,  3.64s/it]Best trial: 2. Best value: 0.50555:  16%|█▌        | 16/100 [01:12<05:39,  4.04s/it]Best trial: 16. Best value: 0.510548:  16%|█▌        | 16/100 [01:16<05:39,  4.04s/it]Best trial: 16. Best value: 0.510548:  17%|█▋        | 17/100 [01:16<05:24,  3.91s/it]Best trial: 16. Best value: 0.510548:  17%|█▋        | 17/100 [01:18<05:24,  3.91s/it]Best trial: 16. Best value: 0.510548:  18%|█▊        | 18/100 [01:18<04:51,  3.55s/it]Best trial: 16. Best value: 0.510548:  18%|█▊        | 18/100 [01:21<04:51,  3.55s/it]Best trial: 16. Best value: 0.510548:  19%|█▉        | 19/100 [01:21<04:14,  3.14s/it]Best trial: 16. Best value: 0.510548:  19%|█▉        | 19/100 [01:24<04:14,  3.14s/it]Best trial: 16. Best value: 0.510548:  20%|██        | 20/100 [01:24<04:18,  3.24s/it]Best trial: 16. Best value: 0.510548:  20%|██        | 20/100 [01:29<04:18,  3.24s/it]Best trial: 16. Best value: 0.510548:  21%|██        | 21/100 [01:29<04:53,  3.71s/it]Best trial: 16. Best value: 0.510548:  21%|██        | 21/100 [01:33<04:53,  3.71s/it]Best trial: 16. Best value: 0.510548:  22%|██▏       | 22/100 [01:33<04:58,  3.83s/it]Best trial: 16. Best value: 0.510548:  22%|██▏       | 22/100 [01:37<04:58,  3.83s/it]Best trial: 16. Best value: 0.510548:  23%|██▎       | 23/100 [01:37<04:54,  3.83s/it]Best trial: 16. Best value: 0.510548:  23%|██▎       | 23/100 [01:40<04:54,  3.83s/it]Best trial: 16. Best value: 0.510548:  24%|██▍       | 24/100 [01:40<04:36,  3.64s/it]Best trial: 24. Best value: 0.51093:  24%|██▍       | 24/100 [01:43<04:36,  3.64s/it] Best trial: 24. Best value: 0.51093:  25%|██▌       | 25/100 [01:43<04:17,  3.43s/it]Best trial: 25. Best value: 0.511312:  25%|██▌       | 25/100 [01:46<04:17,  3.43s/it]Best trial: 25. Best value: 0.511312:  26%|██▌       | 26/100 [01:46<04:10,  3.39s/it]Best trial: 25. Best value: 0.511312:  26%|██▌       | 26/100 [01:50<04:10,  3.39s/it]Best trial: 25. Best value: 0.511312:  27%|██▋       | 27/100 [01:50<04:06,  3.38s/it]Best trial: 25. Best value: 0.511312:  27%|██▋       | 27/100 [01:53<04:06,  3.38s/it]Best trial: 25. Best value: 0.511312:  28%|██▊       | 28/100 [01:53<03:54,  3.26s/it]Best trial: 25. Best value: 0.511312:  28%|██▊       | 28/100 [01:56<03:54,  3.26s/it]Best trial: 25. Best value: 0.511312:  29%|██▉       | 29/100 [01:56<03:44,  3.17s/it]Best trial: 25. Best value: 0.511312:  29%|██▉       | 29/100 [02:01<03:44,  3.17s/it]Best trial: 25. Best value: 0.511312:  30%|███       | 30/100 [02:01<04:28,  3.83s/it]Best trial: 25. Best value: 0.511312:  30%|███       | 30/100 [02:05<04:28,  3.83s/it]Best trial: 25. Best value: 0.511312:  31%|███       | 31/100 [02:05<04:30,  3.93s/it]Best trial: 25. Best value: 0.511312:  31%|███       | 31/100 [02:08<04:30,  3.93s/it]Best trial: 25. Best value: 0.511312:  32%|███▏      | 32/100 [02:08<04:11,  3.70s/it]Best trial: 25. Best value: 0.511312:  32%|███▏      | 32/100 [02:13<04:11,  3.70s/it]Best trial: 25. Best value: 0.511312:  33%|███▎      | 33/100 [02:13<04:24,  3.95s/it]Best trial: 25. Best value: 0.511312:  33%|███▎      | 33/100 [02:16<04:24,  3.95s/it]Best trial: 25. Best value: 0.511312:  34%|███▍      | 34/100 [02:16<03:59,  3.63s/it]Best trial: 25. Best value: 0.511312:  34%|███▍      | 34/100 [02:20<03:59,  3.63s/it]Best trial: 25. Best value: 0.511312:  35%|███▌      | 35/100 [02:20<04:14,  3.91s/it]Best trial: 25. Best value: 0.511312:  35%|███▌      | 35/100 [02:24<04:14,  3.91s/it]Best trial: 25. Best value: 0.511312:  36%|███▌      | 36/100 [02:24<04:01,  3.77s/it]Best trial: 25. Best value: 0.511312:  36%|███▌      | 36/100 [02:27<04:01,  3.77s/it]Best trial: 25. Best value: 0.511312:  37%|███▋      | 37/100 [02:27<03:56,  3.75s/it]Best trial: 25. Best value: 0.511312:  37%|███▋      | 37/100 [02:31<03:56,  3.75s/it]Best trial: 25. Best value: 0.511312:  38%|███▊      | 38/100 [02:31<03:45,  3.63s/it]Best trial: 25. Best value: 0.511312:  38%|███▊      | 38/100 [02:39<03:45,  3.63s/it]Best trial: 25. Best value: 0.511312:  39%|███▉      | 39/100 [02:39<05:04,  4.99s/it]Best trial: 25. Best value: 0.511312:  39%|███▉      | 39/100 [02:43<05:04,  4.99s/it]Best trial: 25. Best value: 0.511312:  40%|████      | 40/100 [02:43<04:36,  4.60s/it]Best trial: 25. Best value: 0.511312:  40%|████      | 40/100 [02:46<04:36,  4.60s/it]Best trial: 25. Best value: 0.511312:  41%|████      | 41/100 [02:46<04:10,  4.25s/it]Best trial: 25. Best value: 0.511312:  41%|████      | 41/100 [02:49<04:10,  4.25s/it]Best trial: 25. Best value: 0.511312:  42%|████▏     | 42/100 [02:49<03:49,  3.96s/it]Best trial: 25. Best value: 0.511312:  42%|████▏     | 42/100 [02:53<03:49,  3.96s/it]Best trial: 25. Best value: 0.511312:  43%|████▎     | 43/100 [02:53<03:42,  3.90s/it]Best trial: 25. Best value: 0.511312:  43%|████▎     | 43/100 [02:57<03:42,  3.90s/it]Best trial: 25. Best value: 0.511312:  44%|████▍     | 44/100 [02:57<03:38,  3.91s/it]Best trial: 25. Best value: 0.511312:  44%|████▍     | 44/100 [03:04<03:38,  3.91s/it]Best trial: 25. Best value: 0.511312:  45%|████▌     | 45/100 [03:04<04:29,  4.89s/it]Best trial: 25. Best value: 0.511312:  45%|████▌     | 45/100 [03:08<04:29,  4.89s/it]Best trial: 25. Best value: 0.511312:  46%|████▌     | 46/100 [03:08<04:03,  4.51s/it]Best trial: 25. Best value: 0.511312:  46%|████▌     | 46/100 [03:12<04:03,  4.51s/it]Best trial: 25. Best value: 0.511312:  47%|████▋     | 47/100 [03:12<04:00,  4.53s/it]Best trial: 25. Best value: 0.511312:  47%|████▋     | 47/100 [03:17<04:00,  4.53s/it]Best trial: 25. Best value: 0.511312:  48%|████▊     | 48/100 [03:17<04:00,  4.63s/it]Best trial: 25. Best value: 0.511312:  48%|████▊     | 48/100 [03:22<04:00,  4.63s/it]Best trial: 25. Best value: 0.511312:  49%|████▉     | 49/100 [03:22<04:01,  4.74s/it]Best trial: 25. Best value: 0.511312:  49%|████▉     | 49/100 [03:26<04:01,  4.74s/it]Best trial: 25. Best value: 0.511312:  50%|█████     | 50/100 [03:26<03:44,  4.49s/it]Best trial: 25. Best value: 0.511312:  50%|█████     | 50/100 [03:30<03:44,  4.49s/it]Best trial: 25. Best value: 0.511312:  51%|█████     | 51/100 [03:30<03:25,  4.20s/it]Best trial: 25. Best value: 0.511312:  51%|█████     | 51/100 [03:33<03:25,  4.20s/it]Best trial: 25. Best value: 0.511312:  52%|█████▏    | 52/100 [03:33<03:11,  3.98s/it]Best trial: 25. Best value: 0.511312:  52%|█████▏    | 52/100 [03:36<03:11,  3.98s/it]Best trial: 25. Best value: 0.511312:  53%|█████▎    | 53/100 [03:36<02:57,  3.77s/it]Best trial: 25. Best value: 0.511312:  53%|█████▎    | 53/100 [03:40<02:57,  3.77s/it]Best trial: 25. Best value: 0.511312:  54%|█████▍    | 54/100 [03:40<02:44,  3.58s/it]Best trial: 25. Best value: 0.511312:  54%|█████▍    | 54/100 [03:43<02:44,  3.58s/it]Best trial: 25. Best value: 0.511312:  55%|█████▌    | 55/100 [03:43<02:41,  3.58s/it]Best trial: 25. Best value: 0.511312:  55%|█████▌    | 55/100 [03:46<02:41,  3.58s/it]Best trial: 25. Best value: 0.511312:  56%|█████▌    | 56/100 [03:46<02:30,  3.43s/it]Best trial: 25. Best value: 0.511312:  56%|█████▌    | 56/100 [03:49<02:30,  3.43s/it]Best trial: 25. Best value: 0.511312:  57%|█████▋    | 57/100 [03:49<02:20,  3.27s/it]Best trial: 57. Best value: 0.512754:  57%|█████▋    | 57/100 [03:52<02:20,  3.27s/it]Best trial: 57. Best value: 0.512754:  58%|█████▊    | 58/100 [03:52<02:16,  3.24s/it]Best trial: 57. Best value: 0.512754:  58%|█████▊    | 58/100 [03:56<02:16,  3.24s/it]Best trial: 57. Best value: 0.512754:  59%|█████▉    | 59/100 [03:56<02:22,  3.48s/it]Best trial: 57. Best value: 0.512754:  59%|█████▉    | 59/100 [04:02<02:22,  3.48s/it]Best trial: 57. Best value: 0.512754:  60%|██████    | 60/100 [04:02<02:50,  4.27s/it]Best trial: 57. Best value: 0.512754:  60%|██████    | 60/100 [04:08<02:50,  4.27s/it]Best trial: 57. Best value: 0.512754:  61%|██████    | 61/100 [04:08<03:06,  4.78s/it]Best trial: 57. Best value: 0.512754:  61%|██████    | 61/100 [04:12<03:06,  4.78s/it]Best trial: 57. Best value: 0.512754:  62%|██████▏   | 62/100 [04:12<02:46,  4.38s/it]Best trial: 57. Best value: 0.512754:  62%|██████▏   | 62/100 [04:15<02:46,  4.38s/it]Best trial: 57. Best value: 0.512754:  63%|██████▎   | 63/100 [04:15<02:31,  4.09s/it]Best trial: 63. Best value: 0.514832:  63%|██████▎   | 63/100 [04:19<02:31,  4.09s/it]Best trial: 63. Best value: 0.514832:  64%|██████▍   | 64/100 [04:19<02:20,  3.90s/it]Best trial: 63. Best value: 0.514832:  64%|██████▍   | 64/100 [04:22<02:20,  3.90s/it]Best trial: 63. Best value: 0.514832:  65%|██████▌   | 65/100 [04:22<02:12,  3.78s/it]Best trial: 63. Best value: 0.514832:  65%|██████▌   | 65/100 [04:26<02:12,  3.78s/it]Best trial: 63. Best value: 0.514832:  66%|██████▌   | 66/100 [04:26<02:11,  3.86s/it]Best trial: 63. Best value: 0.514832:  66%|██████▌   | 66/100 [04:29<02:11,  3.86s/it]Best trial: 63. Best value: 0.514832:  67%|██████▋   | 67/100 [04:29<01:54,  3.46s/it]Best trial: 63. Best value: 0.514832:  67%|██████▋   | 67/100 [04:33<01:54,  3.46s/it]Best trial: 63. Best value: 0.514832:  68%|██████▊   | 68/100 [04:33<02:01,  3.80s/it]Best trial: 63. Best value: 0.514832:  68%|██████▊   | 68/100 [04:37<02:01,  3.80s/it]Best trial: 63. Best value: 0.514832:  69%|██████▉   | 69/100 [04:37<01:54,  3.70s/it]Best trial: 63. Best value: 0.514832:  69%|██████▉   | 69/100 [04:40<01:54,  3.70s/it]Best trial: 63. Best value: 0.514832:  70%|███████   | 70/100 [04:40<01:47,  3.58s/it]Best trial: 63. Best value: 0.514832:  70%|███████   | 70/100 [04:43<01:47,  3.58s/it]Best trial: 63. Best value: 0.514832:  71%|███████   | 71/100 [04:43<01:38,  3.41s/it]Best trial: 63. Best value: 0.514832:  71%|███████   | 71/100 [04:46<01:38,  3.41s/it]Best trial: 63. Best value: 0.514832:  72%|███████▏  | 72/100 [04:46<01:34,  3.38s/it]Best trial: 63. Best value: 0.514832:  72%|███████▏  | 72/100 [04:50<01:34,  3.38s/it]Best trial: 63. Best value: 0.514832:  73%|███████▎  | 73/100 [04:50<01:28,  3.29s/it]Best trial: 63. Best value: 0.514832:  73%|███████▎  | 73/100 [04:53<01:28,  3.29s/it]Best trial: 63. Best value: 0.514832:  74%|███████▍  | 74/100 [04:53<01:24,  3.26s/it]Best trial: 63. Best value: 0.514832:  74%|███████▍  | 74/100 [04:56<01:24,  3.26s/it]Best trial: 63. Best value: 0.514832:  75%|███████▌  | 75/100 [04:56<01:21,  3.27s/it]Best trial: 63. Best value: 0.514832:  75%|███████▌  | 75/100 [04:59<01:21,  3.27s/it]Best trial: 63. Best value: 0.514832:  76%|███████▌  | 76/100 [04:59<01:17,  3.23s/it]Best trial: 63. Best value: 0.514832:  76%|███████▌  | 76/100 [05:03<01:17,  3.23s/it]Best trial: 63. Best value: 0.514832:  77%|███████▋  | 77/100 [05:03<01:17,  3.37s/it]Best trial: 63. Best value: 0.514832:  77%|███████▋  | 77/100 [05:06<01:17,  3.37s/it]Best trial: 63. Best value: 0.514832:  78%|███████▊  | 78/100 [05:06<01:12,  3.30s/it]Best trial: 63. Best value: 0.514832:  78%|███████▊  | 78/100 [05:11<01:12,  3.30s/it]Best trial: 63. Best value: 0.514832:  79%|███████▉  | 79/100 [05:11<01:18,  3.75s/it]Best trial: 63. Best value: 0.514832:  79%|███████▉  | 79/100 [05:15<01:18,  3.75s/it]Best trial: 63. Best value: 0.514832:  80%|████████  | 80/100 [05:15<01:17,  3.87s/it]Best trial: 63. Best value: 0.514832:  80%|████████  | 80/100 [05:18<01:17,  3.87s/it]Best trial: 63. Best value: 0.514832:  81%|████████  | 81/100 [05:18<01:11,  3.75s/it]Best trial: 63. Best value: 0.514832:  81%|████████  | 81/100 [05:22<01:11,  3.75s/it]Best trial: 63. Best value: 0.514832:  82%|████████▏ | 82/100 [05:22<01:06,  3.69s/it]Best trial: 82. Best value: 0.516204:  82%|████████▏ | 82/100 [05:25<01:06,  3.69s/it]Best trial: 82. Best value: 0.516204:  83%|████████▎ | 83/100 [05:25<01:01,  3.61s/it]Best trial: 82. Best value: 0.516204:  83%|████████▎ | 83/100 [05:29<01:01,  3.61s/it]Best trial: 82. Best value: 0.516204:  84%|████████▍ | 84/100 [05:29<00:55,  3.46s/it]Best trial: 82. Best value: 0.516204:  84%|████████▍ | 84/100 [05:32<00:55,  3.46s/it]Best trial: 82. Best value: 0.516204:  85%|████████▌ | 85/100 [05:32<00:50,  3.35s/it]Best trial: 82. Best value: 0.516204:  85%|████████▌ | 85/100 [05:35<00:50,  3.35s/it]Best trial: 82. Best value: 0.516204:  86%|████████▌ | 86/100 [05:35<00:46,  3.32s/it]Best trial: 82. Best value: 0.516204:  86%|████████▌ | 86/100 [05:38<00:46,  3.32s/it]Best trial: 82. Best value: 0.516204:  87%|████████▋ | 87/100 [05:38<00:42,  3.26s/it]Best trial: 82. Best value: 0.516204:  87%|████████▋ | 87/100 [05:42<00:42,  3.26s/it]Best trial: 82. Best value: 0.516204:  88%|████████▊ | 88/100 [05:42<00:43,  3.62s/it]Best trial: 82. Best value: 0.516204:  88%|████████▊ | 88/100 [05:46<00:43,  3.62s/it]Best trial: 82. Best value: 0.516204:  89%|████████▉ | 89/100 [05:46<00:38,  3.46s/it]Best trial: 82. Best value: 0.516204:  89%|████████▉ | 89/100 [05:49<00:38,  3.46s/it]Best trial: 82. Best value: 0.516204:  90%|█████████ | 90/100 [05:49<00:33,  3.33s/it]Best trial: 82. Best value: 0.516204:  90%|█████████ | 90/100 [05:52<00:33,  3.33s/it]Best trial: 82. Best value: 0.516204:  91%|█████████ | 91/100 [05:52<00:30,  3.36s/it]Best trial: 82. Best value: 0.516204:  91%|█████████ | 91/100 [05:55<00:30,  3.36s/it]Best trial: 82. Best value: 0.516204:  92%|█████████▏| 92/100 [05:55<00:25,  3.18s/it]Best trial: 82. Best value: 0.516204:  92%|█████████▏| 92/100 [05:58<00:25,  3.18s/it]Best trial: 82. Best value: 0.516204:  93%|█████████▎| 93/100 [05:58<00:22,  3.25s/it]Best trial: 82. Best value: 0.516204:  93%|█████████▎| 93/100 [06:01<00:22,  3.25s/it]Best trial: 82. Best value: 0.516204:  94%|█████████▍| 94/100 [06:01<00:18,  3.12s/it]Best trial: 82. Best value: 0.516204:  94%|█████████▍| 94/100 [06:04<00:18,  3.12s/it]Best trial: 82. Best value: 0.516204:  95%|█████████▌| 95/100 [06:04<00:14,  2.97s/it]Best trial: 82. Best value: 0.516204:  95%|█████████▌| 95/100 [06:07<00:14,  2.97s/it]Best trial: 82. Best value: 0.516204:  96%|█████████▌| 96/100 [06:07<00:12,  3.22s/it]Best trial: 82. Best value: 0.516204:  96%|█████████▌| 96/100 [06:10<00:12,  3.22s/it]Best trial: 82. Best value: 0.516204:  97%|█████████▋| 97/100 [06:10<00:08,  2.96s/it]Best trial: 82. Best value: 0.516204:  97%|█████████▋| 97/100 [06:12<00:08,  2.96s/it]Best trial: 82. Best value: 0.516204:  98%|█████████▊| 98/100 [06:12<00:05,  2.85s/it]Best trial: 82. Best value: 0.516204:  98%|█████████▊| 98/100 [06:16<00:05,  2.85s/it]Best trial: 82. Best value: 0.516204:  99%|█████████▉| 99/100 [06:16<00:03,  3.02s/it]Best trial: 82. Best value: 0.516204:  99%|█████████▉| 99/100 [06:19<00:03,  3.02s/it]Best trial: 82. Best value: 0.516204: 100%|██████████| 100/100 [06:19<00:00,  3.09s/it]Best trial: 82. Best value: 0.516204: 100%|██████████| 100/100 [06:19<00:00,  3.80s/it]
2025-11-30 07:46:56,322 - INFO - HPO Complete. Best AUPRC: 0.5162
2025-11-30 07:46:56,322 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.0007029999719497579, 'max_depth': 3, 'subsample': 0.6405427006083577, 'colsample_bytree': 0.689410779855778, 'gamma': 2.97881753787946, 'reg_lambda': 8.296946101973667e-05, 'reg_alpha': 1.0876296016550217e-08}
2025-11-30 07:46:56,322 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:46:58,183 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 07:46:58,184 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:46:58,269 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:46:58,306 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:46:58,317 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 07:46:58,317 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:46:58,318 - INFO - Training model...
2025-11-30 07:47:00,009 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:47:05,677 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:47:05,677 - INFO - AUROC: 0.7921 (0.6864 - 0.8465)
2025-11-30 07:47:05,678 - INFO - AUPRC: 0.3870 (0.2901 - 0.5374)
2025-11-30 07:47:05,678 - INFO - Brier Score: 0.2054 (0.2037 - 0.2081)
2025-11-30 07:47:05,678 - INFO - Accuracy: 0.9538 (0.9223 - 0.9705)
2025-11-30 07:47:05,678 - INFO - Precision: 0.5769 (0.3270 - 0.9178)
2025-11-30 07:47:05,678 - INFO - Sensitivity (Recall): 0.4167 (0.2687 - 0.5606)
2025-11-30 07:47:05,678 - INFO - F1-Score: 0.4839 (0.3769 - 0.6258)
2025-11-30 07:47:05,678 - INFO - Best Threshold: 0.5200 (0.5000 - 0.5680)
2025-11-30 07:47:05,678 - INFO - Specificity: 0.9832 (0.9436 - 0.9985)
2025-11-30 07:47:05,688 - INFO - Calculating SHAP values...
2025-11-30 07:47:06,732 - INFO - SHAP plots saved.
2025-11-30 07:47:06,733 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:47:08,032 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 07:47:08,032 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:47:08,140 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:47:08,153 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:47:08,156 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:47:08,156 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.15843:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.15843:   1%|          | 1/100 [00:02<03:58,  2.41s/it]Best trial: 0. Best value: 0.15843:   1%|          | 1/100 [00:03<03:58,  2.41s/it]Best trial: 0. Best value: 0.15843:   2%|▏         | 2/100 [00:03<03:03,  1.87s/it]Best trial: 0. Best value: 0.15843:   2%|▏         | 2/100 [00:06<03:03,  1.87s/it]Best trial: 0. Best value: 0.15843:   3%|▎         | 3/100 [00:06<03:20,  2.06s/it]Best trial: 3. Best value: 0.167134:   3%|▎         | 3/100 [00:08<03:20,  2.06s/it]Best trial: 3. Best value: 0.167134:   4%|▍         | 4/100 [00:08<03:27,  2.16s/it]Best trial: 3. Best value: 0.167134:   4%|▍         | 4/100 [00:10<03:27,  2.16s/it]Best trial: 3. Best value: 0.167134:   5%|▌         | 5/100 [00:10<03:17,  2.07s/it]Best trial: 3. Best value: 0.167134:   5%|▌         | 5/100 [00:16<03:17,  2.07s/it]Best trial: 3. Best value: 0.167134:   6%|▌         | 6/100 [00:16<05:29,  3.50s/it]Best trial: 3. Best value: 0.167134:   6%|▌         | 6/100 [00:19<05:29,  3.50s/it]Best trial: 3. Best value: 0.167134:   7%|▋         | 7/100 [00:19<05:03,  3.27s/it]Best trial: 3. Best value: 0.167134:   7%|▋         | 7/100 [00:21<05:03,  3.27s/it]Best trial: 3. Best value: 0.167134:   8%|▊         | 8/100 [00:21<04:12,  2.74s/it]Best trial: 3. Best value: 0.167134:   8%|▊         | 8/100 [00:22<04:12,  2.74s/it]Best trial: 3. Best value: 0.167134:   9%|▉         | 9/100 [00:22<03:32,  2.33s/it]Best trial: 3. Best value: 0.167134:   9%|▉         | 9/100 [00:26<03:32,  2.33s/it]Best trial: 3. Best value: 0.167134:  10%|█         | 10/100 [00:26<04:11,  2.79s/it]Best trial: 10. Best value: 0.18291:  10%|█         | 10/100 [00:27<04:11,  2.79s/it]Best trial: 10. Best value: 0.18291:  11%|█         | 11/100 [00:27<03:26,  2.32s/it]Best trial: 10. Best value: 0.18291:  11%|█         | 11/100 [00:28<03:26,  2.32s/it]Best trial: 10. Best value: 0.18291:  12%|█▏        | 12/100 [00:28<02:55,  2.00s/it]Best trial: 10. Best value: 0.18291:  12%|█▏        | 12/100 [00:30<02:55,  2.00s/it]Best trial: 10. Best value: 0.18291:  13%|█▎        | 13/100 [00:30<02:49,  1.95s/it]Best trial: 10. Best value: 0.18291:  13%|█▎        | 13/100 [00:32<02:49,  1.95s/it]Best trial: 10. Best value: 0.18291:  14%|█▍        | 14/100 [00:32<02:34,  1.79s/it]Best trial: 10. Best value: 0.18291:  14%|█▍        | 14/100 [00:33<02:34,  1.79s/it]Best trial: 10. Best value: 0.18291:  15%|█▌        | 15/100 [00:33<02:32,  1.80s/it]Best trial: 10. Best value: 0.18291:  15%|█▌        | 15/100 [00:35<02:32,  1.80s/it]Best trial: 10. Best value: 0.18291:  16%|█▌        | 16/100 [00:35<02:34,  1.84s/it]Best trial: 10. Best value: 0.18291:  16%|█▌        | 16/100 [00:38<02:34,  1.84s/it]Best trial: 10. Best value: 0.18291:  17%|█▋        | 17/100 [00:38<02:44,  1.99s/it]Best trial: 10. Best value: 0.18291:  17%|█▋        | 17/100 [00:41<02:44,  1.99s/it]Best trial: 10. Best value: 0.18291:  18%|█▊        | 18/100 [00:41<03:26,  2.52s/it]Best trial: 10. Best value: 0.18291:  18%|█▊        | 18/100 [00:43<03:26,  2.52s/it]Best trial: 10. Best value: 0.18291:  19%|█▉        | 19/100 [00:43<03:03,  2.27s/it]Best trial: 19. Best value: 0.195441:  19%|█▉        | 19/100 [00:45<03:03,  2.27s/it]Best trial: 19. Best value: 0.195441:  20%|██        | 20/100 [00:45<02:41,  2.02s/it]Best trial: 19. Best value: 0.195441:  20%|██        | 20/100 [00:48<02:41,  2.02s/it]Best trial: 19. Best value: 0.195441:  21%|██        | 21/100 [00:48<03:05,  2.34s/it]Best trial: 19. Best value: 0.195441:  21%|██        | 21/100 [00:49<03:05,  2.34s/it]Best trial: 19. Best value: 0.195441:  22%|██▏       | 22/100 [00:49<02:43,  2.09s/it]Best trial: 19. Best value: 0.195441:  22%|██▏       | 22/100 [00:51<02:43,  2.09s/it]Best trial: 19. Best value: 0.195441:  23%|██▎       | 23/100 [00:51<02:28,  1.93s/it]Best trial: 19. Best value: 0.195441:  23%|██▎       | 23/100 [00:53<02:28,  1.93s/it]Best trial: 19. Best value: 0.195441:  24%|██▍       | 24/100 [00:53<02:25,  1.91s/it]Best trial: 19. Best value: 0.195441:  24%|██▍       | 24/100 [00:54<02:25,  1.91s/it]Best trial: 19. Best value: 0.195441:  25%|██▌       | 25/100 [00:54<02:18,  1.85s/it]Best trial: 19. Best value: 0.195441:  25%|██▌       | 25/100 [00:56<02:18,  1.85s/it]Best trial: 19. Best value: 0.195441:  26%|██▌       | 26/100 [00:56<02:04,  1.68s/it]Best trial: 19. Best value: 0.195441:  26%|██▌       | 26/100 [00:59<02:04,  1.68s/it]Best trial: 19. Best value: 0.195441:  27%|██▋       | 27/100 [00:59<02:49,  2.33s/it]Best trial: 19. Best value: 0.195441:  27%|██▋       | 27/100 [01:02<02:49,  2.33s/it]Best trial: 19. Best value: 0.195441:  28%|██▊       | 28/100 [01:02<02:47,  2.32s/it]Best trial: 19. Best value: 0.195441:  28%|██▊       | 28/100 [01:04<02:47,  2.32s/it]Best trial: 19. Best value: 0.195441:  29%|██▉       | 29/100 [01:04<02:37,  2.22s/it]Best trial: 19. Best value: 0.195441:  29%|██▉       | 29/100 [01:06<02:37,  2.22s/it]Best trial: 19. Best value: 0.195441:  30%|███       | 30/100 [01:06<02:27,  2.11s/it]Best trial: 19. Best value: 0.195441:  30%|███       | 30/100 [01:08<02:27,  2.11s/it]Best trial: 19. Best value: 0.195441:  31%|███       | 31/100 [01:08<02:30,  2.18s/it]Best trial: 19. Best value: 0.195441:  31%|███       | 31/100 [01:10<02:30,  2.18s/it]Best trial: 19. Best value: 0.195441:  32%|███▏      | 32/100 [01:10<02:22,  2.10s/it]Best trial: 19. Best value: 0.195441:  32%|███▏      | 32/100 [01:11<02:22,  2.10s/it]Best trial: 19. Best value: 0.195441:  33%|███▎      | 33/100 [01:11<02:08,  1.92s/it]Best trial: 19. Best value: 0.195441:  33%|███▎      | 33/100 [01:12<02:08,  1.92s/it]Best trial: 19. Best value: 0.195441:  34%|███▍      | 34/100 [01:12<01:51,  1.68s/it]Best trial: 19. Best value: 0.195441:  34%|███▍      | 34/100 [01:14<01:51,  1.68s/it]Best trial: 19. Best value: 0.195441:  35%|███▌      | 35/100 [01:14<01:47,  1.65s/it]Best trial: 19. Best value: 0.195441:  35%|███▌      | 35/100 [01:17<01:47,  1.65s/it]Best trial: 19. Best value: 0.195441:  36%|███▌      | 36/100 [01:17<02:02,  1.91s/it]Best trial: 19. Best value: 0.195441:  36%|███▌      | 36/100 [01:19<02:02,  1.91s/it]Best trial: 19. Best value: 0.195441:  37%|███▋      | 37/100 [01:19<02:07,  2.03s/it]Best trial: 19. Best value: 0.195441:  37%|███▋      | 37/100 [01:20<02:07,  2.03s/it]Best trial: 19. Best value: 0.195441:  38%|███▊      | 38/100 [01:20<01:50,  1.78s/it]Best trial: 19. Best value: 0.195441:  38%|███▊      | 38/100 [01:22<01:50,  1.78s/it]Best trial: 19. Best value: 0.195441:  39%|███▉      | 39/100 [01:22<01:48,  1.77s/it]Best trial: 19. Best value: 0.195441:  39%|███▉      | 39/100 [01:24<01:48,  1.77s/it]Best trial: 19. Best value: 0.195441:  40%|████      | 40/100 [01:24<01:50,  1.85s/it]Best trial: 19. Best value: 0.195441:  40%|████      | 40/100 [01:26<01:50,  1.85s/it]Best trial: 19. Best value: 0.195441:  41%|████      | 41/100 [01:26<01:52,  1.91s/it]Best trial: 19. Best value: 0.195441:  41%|████      | 41/100 [01:27<01:52,  1.91s/it]Best trial: 19. Best value: 0.195441:  42%|████▏     | 42/100 [01:27<01:42,  1.77s/it]Best trial: 19. Best value: 0.195441:  42%|████▏     | 42/100 [01:29<01:42,  1.77s/it]Best trial: 19. Best value: 0.195441:  43%|████▎     | 43/100 [01:29<01:37,  1.70s/it]Best trial: 19. Best value: 0.195441:  43%|████▎     | 43/100 [01:30<01:37,  1.70s/it]Best trial: 19. Best value: 0.195441:  44%|████▍     | 44/100 [01:30<01:26,  1.55s/it]Best trial: 19. Best value: 0.195441:  44%|████▍     | 44/100 [01:31<01:26,  1.55s/it]Best trial: 19. Best value: 0.195441:  45%|████▌     | 45/100 [01:31<01:20,  1.46s/it]Best trial: 19. Best value: 0.195441:  45%|████▌     | 45/100 [01:33<01:20,  1.46s/it]Best trial: 19. Best value: 0.195441:  46%|████▌     | 46/100 [01:33<01:16,  1.42s/it]Best trial: 19. Best value: 0.195441:  46%|████▌     | 46/100 [01:34<01:16,  1.42s/it]Best trial: 19. Best value: 0.195441:  47%|████▋     | 47/100 [01:34<01:14,  1.41s/it]Best trial: 19. Best value: 0.195441:  47%|████▋     | 47/100 [01:35<01:14,  1.41s/it]Best trial: 19. Best value: 0.195441:  48%|████▊     | 48/100 [01:35<01:12,  1.39s/it]Best trial: 19. Best value: 0.195441:  48%|████▊     | 48/100 [01:37<01:12,  1.39s/it]Best trial: 19. Best value: 0.195441:  49%|████▉     | 49/100 [01:37<01:12,  1.42s/it]Best trial: 19. Best value: 0.195441:  49%|████▉     | 49/100 [01:39<01:12,  1.42s/it]Best trial: 19. Best value: 0.195441:  50%|█████     | 50/100 [01:39<01:27,  1.76s/it]Best trial: 19. Best value: 0.195441:  50%|█████     | 50/100 [01:41<01:27,  1.76s/it]Best trial: 19. Best value: 0.195441:  51%|█████     | 51/100 [01:41<01:30,  1.85s/it]Best trial: 19. Best value: 0.195441:  51%|█████     | 51/100 [01:43<01:30,  1.85s/it]Best trial: 19. Best value: 0.195441:  52%|█████▏    | 52/100 [01:43<01:18,  1.63s/it]Best trial: 19. Best value: 0.195441:  52%|█████▏    | 52/100 [01:44<01:18,  1.63s/it]Best trial: 19. Best value: 0.195441:  53%|█████▎    | 53/100 [01:44<01:12,  1.54s/it]Best trial: 19. Best value: 0.195441:  53%|█████▎    | 53/100 [01:45<01:12,  1.54s/it]Best trial: 19. Best value: 0.195441:  54%|█████▍    | 54/100 [01:45<01:07,  1.46s/it]Best trial: 19. Best value: 0.195441:  54%|█████▍    | 54/100 [01:47<01:07,  1.46s/it]Best trial: 19. Best value: 0.195441:  55%|█████▌    | 55/100 [01:47<01:09,  1.54s/it]Best trial: 19. Best value: 0.195441:  55%|█████▌    | 55/100 [01:49<01:09,  1.54s/it]Best trial: 19. Best value: 0.195441:  56%|█████▌    | 56/100 [01:49<01:08,  1.55s/it]Best trial: 19. Best value: 0.195441:  56%|█████▌    | 56/100 [01:51<01:08,  1.55s/it]Best trial: 19. Best value: 0.195441:  57%|█████▋    | 57/100 [01:51<01:18,  1.82s/it]Best trial: 19. Best value: 0.195441:  57%|█████▋    | 57/100 [01:52<01:18,  1.82s/it]Best trial: 19. Best value: 0.195441:  58%|█████▊    | 58/100 [01:52<01:10,  1.69s/it]Best trial: 19. Best value: 0.195441:  58%|█████▊    | 58/100 [01:54<01:10,  1.69s/it]Best trial: 19. Best value: 0.195441:  59%|█████▉    | 59/100 [01:54<01:10,  1.72s/it]Best trial: 19. Best value: 0.195441:  59%|█████▉    | 59/100 [01:55<01:10,  1.72s/it]Best trial: 19. Best value: 0.195441:  60%|██████    | 60/100 [01:55<01:01,  1.53s/it]Best trial: 19. Best value: 0.195441:  60%|██████    | 60/100 [01:57<01:01,  1.53s/it]Best trial: 19. Best value: 0.195441:  61%|██████    | 61/100 [01:57<01:03,  1.62s/it]Best trial: 19. Best value: 0.195441:  61%|██████    | 61/100 [01:58<01:03,  1.62s/it]Best trial: 19. Best value: 0.195441:  62%|██████▏   | 62/100 [01:58<00:59,  1.57s/it]Best trial: 19. Best value: 0.195441:  62%|██████▏   | 62/100 [02:00<00:59,  1.57s/it]Best trial: 19. Best value: 0.195441:  63%|██████▎   | 63/100 [02:00<00:54,  1.47s/it]Best trial: 63. Best value: 0.199045:  63%|██████▎   | 63/100 [02:02<00:54,  1.47s/it]Best trial: 63. Best value: 0.199045:  64%|██████▍   | 64/100 [02:02<00:59,  1.65s/it]Best trial: 63. Best value: 0.199045:  64%|██████▍   | 64/100 [02:04<00:59,  1.65s/it]Best trial: 63. Best value: 0.199045:  65%|██████▌   | 65/100 [02:04<01:00,  1.73s/it]Best trial: 63. Best value: 0.199045:  65%|██████▌   | 65/100 [02:05<01:00,  1.73s/it]Best trial: 63. Best value: 0.199045:  66%|██████▌   | 66/100 [02:05<00:54,  1.60s/it]Best trial: 63. Best value: 0.199045:  66%|██████▌   | 66/100 [02:07<00:54,  1.60s/it]Best trial: 63. Best value: 0.199045:  67%|██████▋   | 67/100 [02:07<00:59,  1.79s/it]Best trial: 63. Best value: 0.199045:  67%|██████▋   | 67/100 [02:09<00:59,  1.79s/it]Best trial: 63. Best value: 0.199045:  68%|██████▊   | 68/100 [02:09<00:55,  1.75s/it]Best trial: 63. Best value: 0.199045:  68%|██████▊   | 68/100 [02:13<00:55,  1.75s/it]Best trial: 63. Best value: 0.199045:  69%|██████▉   | 69/100 [02:13<01:15,  2.44s/it]Best trial: 63. Best value: 0.199045:  69%|██████▉   | 69/100 [02:14<01:15,  2.44s/it]Best trial: 63. Best value: 0.199045:  70%|███████   | 70/100 [02:14<01:03,  2.11s/it]Best trial: 63. Best value: 0.199045:  70%|███████   | 70/100 [02:16<01:03,  2.11s/it]Best trial: 63. Best value: 0.199045:  71%|███████   | 71/100 [02:16<00:58,  2.01s/it]Best trial: 63. Best value: 0.199045:  71%|███████   | 71/100 [02:18<00:58,  2.01s/it]Best trial: 63. Best value: 0.199045:  72%|███████▏  | 72/100 [02:18<00:56,  2.03s/it]Best trial: 63. Best value: 0.199045:  72%|███████▏  | 72/100 [02:20<00:56,  2.03s/it]Best trial: 63. Best value: 0.199045:  73%|███████▎  | 73/100 [02:20<00:51,  1.90s/it]Best trial: 63. Best value: 0.199045:  73%|███████▎  | 73/100 [02:21<00:51,  1.90s/it]Best trial: 63. Best value: 0.199045:  74%|███████▍  | 74/100 [02:21<00:43,  1.68s/it]Best trial: 63. Best value: 0.199045:  74%|███████▍  | 74/100 [02:24<00:43,  1.68s/it]Best trial: 63. Best value: 0.199045:  75%|███████▌  | 75/100 [02:24<00:49,  1.97s/it]Best trial: 63. Best value: 0.199045:  75%|███████▌  | 75/100 [02:25<00:49,  1.97s/it]Best trial: 63. Best value: 0.199045:  76%|███████▌  | 76/100 [02:25<00:44,  1.86s/it]Best trial: 63. Best value: 0.199045:  76%|███████▌  | 76/100 [02:26<00:44,  1.86s/it]Best trial: 63. Best value: 0.199045:  77%|███████▋  | 77/100 [02:26<00:38,  1.67s/it]Best trial: 63. Best value: 0.199045:  77%|███████▋  | 77/100 [02:28<00:38,  1.67s/it]Best trial: 63. Best value: 0.199045:  78%|███████▊  | 78/100 [02:28<00:36,  1.64s/it]Best trial: 63. Best value: 0.199045:  78%|███████▊  | 78/100 [02:30<00:36,  1.64s/it]Best trial: 63. Best value: 0.199045:  79%|███████▉  | 79/100 [02:30<00:36,  1.73s/it]Best trial: 63. Best value: 0.199045:  79%|███████▉  | 79/100 [02:31<00:36,  1.73s/it]Best trial: 63. Best value: 0.199045:  80%|████████  | 80/100 [02:31<00:32,  1.63s/it]Best trial: 63. Best value: 0.199045:  80%|████████  | 80/100 [02:34<00:32,  1.63s/it]Best trial: 63. Best value: 0.199045:  81%|████████  | 81/100 [02:34<00:34,  1.83s/it]Best trial: 63. Best value: 0.199045:  81%|████████  | 81/100 [02:35<00:34,  1.83s/it]Best trial: 63. Best value: 0.199045:  82%|████████▏ | 82/100 [02:35<00:32,  1.81s/it]Best trial: 82. Best value: 0.200324:  82%|████████▏ | 82/100 [02:37<00:32,  1.81s/it]Best trial: 82. Best value: 0.200324:  83%|████████▎ | 83/100 [02:37<00:28,  1.70s/it]Best trial: 82. Best value: 0.200324:  83%|████████▎ | 83/100 [02:38<00:28,  1.70s/it]Best trial: 82. Best value: 0.200324:  84%|████████▍ | 84/100 [02:38<00:26,  1.67s/it]Best trial: 82. Best value: 0.200324:  84%|████████▍ | 84/100 [02:41<00:26,  1.67s/it]Best trial: 82. Best value: 0.200324:  85%|████████▌ | 85/100 [02:41<00:28,  1.93s/it]Best trial: 82. Best value: 0.200324:  85%|████████▌ | 85/100 [02:43<00:28,  1.93s/it]Best trial: 82. Best value: 0.200324:  86%|████████▌ | 86/100 [02:43<00:25,  1.84s/it]Best trial: 82. Best value: 0.200324:  86%|████████▌ | 86/100 [02:44<00:25,  1.84s/it]Best trial: 82. Best value: 0.200324:  87%|████████▋ | 87/100 [02:44<00:23,  1.81s/it]Best trial: 82. Best value: 0.200324:  87%|████████▋ | 87/100 [02:47<00:23,  1.81s/it]Best trial: 82. Best value: 0.200324:  88%|████████▊ | 88/100 [02:47<00:24,  2.02s/it]Best trial: 82. Best value: 0.200324:  88%|████████▊ | 88/100 [02:48<00:24,  2.02s/it]Best trial: 82. Best value: 0.200324:  89%|████████▉ | 89/100 [02:48<00:20,  1.83s/it]Best trial: 82. Best value: 0.200324:  89%|████████▉ | 89/100 [02:50<00:20,  1.83s/it]Best trial: 82. Best value: 0.200324:  90%|█████████ | 90/100 [02:50<00:18,  1.86s/it]Best trial: 82. Best value: 0.200324:  90%|█████████ | 90/100 [02:52<00:18,  1.86s/it]Best trial: 82. Best value: 0.200324:  91%|█████████ | 91/100 [02:52<00:17,  1.98s/it]Best trial: 82. Best value: 0.200324:  91%|█████████ | 91/100 [02:54<00:17,  1.98s/it]Best trial: 82. Best value: 0.200324:  92%|█████████▏| 92/100 [02:54<00:14,  1.84s/it]Best trial: 82. Best value: 0.200324:  92%|█████████▏| 92/100 [02:55<00:14,  1.84s/it]Best trial: 82. Best value: 0.200324:  93%|█████████▎| 93/100 [02:55<00:12,  1.72s/it]Best trial: 82. Best value: 0.200324:  93%|█████████▎| 93/100 [02:57<00:12,  1.72s/it]Best trial: 82. Best value: 0.200324:  94%|█████████▍| 94/100 [02:57<00:09,  1.65s/it]Best trial: 82. Best value: 0.200324:  94%|█████████▍| 94/100 [02:58<00:09,  1.65s/it]Best trial: 82. Best value: 0.200324:  95%|█████████▌| 95/100 [02:58<00:08,  1.62s/it]Best trial: 82. Best value: 0.200324:  95%|█████████▌| 95/100 [03:00<00:08,  1.62s/it]Best trial: 82. Best value: 0.200324:  96%|█████████▌| 96/100 [03:00<00:06,  1.69s/it]Best trial: 82. Best value: 0.200324:  96%|█████████▌| 96/100 [03:02<00:06,  1.69s/it]Best trial: 82. Best value: 0.200324:  97%|█████████▋| 97/100 [03:02<00:04,  1.66s/it]Best trial: 82. Best value: 0.200324:  97%|█████████▋| 97/100 [03:04<00:04,  1.66s/it]Best trial: 82. Best value: 0.200324:  98%|█████████▊| 98/100 [03:04<00:03,  1.79s/it]Best trial: 82. Best value: 0.200324:  98%|█████████▊| 98/100 [03:05<00:03,  1.79s/it]Best trial: 82. Best value: 0.200324:  99%|█████████▉| 99/100 [03:05<00:01,  1.69s/it]Best trial: 82. Best value: 0.200324:  99%|█████████▉| 99/100 [03:07<00:01,  1.69s/it]Best trial: 82. Best value: 0.200324: 100%|██████████| 100/100 [03:07<00:00,  1.55s/it]Best trial: 82. Best value: 0.200324: 100%|██████████| 100/100 [03:07<00:00,  1.87s/it]
2025-11-30 07:50:15,235 - INFO - HPO Complete. Best AUPRC: 0.2003
2025-11-30 07:50:15,236 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.04719629072329978, 'max_depth': 4, 'subsample': 0.6506225758325666, 'colsample_bytree': 0.7667777379059207, 'gamma': 3.7927098539181383, 'reg_lambda': 0.01581148447797846, 'reg_alpha': 4.379406442608656e-08}
2025-11-30 07:50:15,236 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:50:17,408 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 07:50:17,408 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:50:17,509 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:50:17,528 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:50:17,532 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:50:17,532 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:50:17,532 - INFO - Training model...
2025-11-30 07:50:18,656 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:50:23,435 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:50:23,435 - INFO - AUROC: 0.6381 (0.5150 - 0.7456)
2025-11-30 07:50:23,435 - INFO - AUPRC: 0.1516 (0.0733 - 0.2487)
2025-11-30 07:50:23,435 - INFO - Brier Score: 0.0574 (0.0462 - 0.0726)
2025-11-30 07:50:23,435 - INFO - Accuracy: 0.9061 (0.6266 - 0.9480)
2025-11-30 07:50:23,435 - INFO - Precision: 0.2041 (0.0832 - 0.4295)
2025-11-30 07:50:23,435 - INFO - Sensitivity (Recall): 0.2778 (0.1207 - 0.5825)
2025-11-30 07:50:23,435 - INFO - F1-Score: 0.2353 (0.1464 - 0.3428)
2025-11-30 07:50:23,435 - INFO - Best Threshold: 0.2900 (0.0500 - 0.5520)
2025-11-30 07:50:23,435 - INFO - Specificity: 0.9405 (0.6292 - 0.9860)
2025-11-30 07:50:23,445 - INFO - Calculating SHAP values...
2025-11-30 07:50:24,527 - INFO - SHAP plots saved.
2025-11-30 07:50:24,528 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:50:25,722 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 07:50:25,722 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:50:25,805 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:50:25,817 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:50:25,819 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:50:25,820 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0887792:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0887792:   1%|          | 1/100 [00:02<04:41,  2.84s/it]Best trial: 1. Best value: 0.0958644:   1%|          | 1/100 [00:05<04:41,  2.84s/it]Best trial: 1. Best value: 0.0958644:   2%|▏         | 2/100 [00:05<04:20,  2.66s/it]Best trial: 2. Best value: 0.108626:   2%|▏         | 2/100 [00:07<04:20,  2.66s/it] Best trial: 2. Best value: 0.108626:   3%|▎         | 3/100 [00:07<04:05,  2.53s/it]Best trial: 2. Best value: 0.108626:   3%|▎         | 3/100 [00:09<04:05,  2.53s/it]Best trial: 2. Best value: 0.108626:   4%|▍         | 4/100 [00:09<03:35,  2.24s/it]Best trial: 2. Best value: 0.108626:   4%|▍         | 4/100 [00:11<03:35,  2.24s/it]Best trial: 2. Best value: 0.108626:   5%|▌         | 5/100 [00:11<03:27,  2.18s/it]Best trial: 2. Best value: 0.108626:   5%|▌         | 5/100 [00:13<03:27,  2.18s/it]Best trial: 2. Best value: 0.108626:   6%|▌         | 6/100 [00:13<03:03,  1.96s/it]Best trial: 2. Best value: 0.108626:   6%|▌         | 6/100 [00:14<03:03,  1.96s/it]Best trial: 2. Best value: 0.108626:   7%|▋         | 7/100 [00:14<02:33,  1.65s/it]Best trial: 7. Best value: 0.115987:   7%|▋         | 7/100 [00:15<02:33,  1.65s/it]Best trial: 7. Best value: 0.115987:   8%|▊         | 8/100 [00:15<02:17,  1.49s/it]Best trial: 7. Best value: 0.115987:   8%|▊         | 8/100 [00:17<02:17,  1.49s/it]Best trial: 7. Best value: 0.115987:   9%|▉         | 9/100 [00:17<02:35,  1.71s/it]Best trial: 9. Best value: 0.122215:   9%|▉         | 9/100 [00:19<02:35,  1.71s/it]Best trial: 9. Best value: 0.122215:  10%|█         | 10/100 [00:19<02:50,  1.90s/it]Best trial: 9. Best value: 0.122215:  10%|█         | 10/100 [00:21<02:50,  1.90s/it]Best trial: 9. Best value: 0.122215:  11%|█         | 11/100 [00:21<02:45,  1.86s/it]Best trial: 9. Best value: 0.122215:  11%|█         | 11/100 [00:22<02:45,  1.86s/it]Best trial: 9. Best value: 0.122215:  12%|█▏        | 12/100 [00:22<02:17,  1.56s/it]Best trial: 9. Best value: 0.122215:  12%|█▏        | 12/100 [00:24<02:17,  1.56s/it]Best trial: 9. Best value: 0.122215:  13%|█▎        | 13/100 [00:24<02:24,  1.66s/it]Best trial: 9. Best value: 0.122215:  13%|█▎        | 13/100 [00:25<02:24,  1.66s/it]Best trial: 9. Best value: 0.122215:  14%|█▍        | 14/100 [00:25<02:07,  1.49s/it]Best trial: 9. Best value: 0.122215:  14%|█▍        | 14/100 [00:27<02:07,  1.49s/it]Best trial: 9. Best value: 0.122215:  15%|█▌        | 15/100 [00:27<02:21,  1.67s/it]Best trial: 9. Best value: 0.122215:  15%|█▌        | 15/100 [00:29<02:21,  1.67s/it]Best trial: 9. Best value: 0.122215:  16%|█▌        | 16/100 [00:29<02:38,  1.89s/it]Best trial: 9. Best value: 0.122215:  16%|█▌        | 16/100 [00:32<02:38,  1.89s/it]Best trial: 9. Best value: 0.122215:  17%|█▋        | 17/100 [00:32<02:54,  2.11s/it]Best trial: 9. Best value: 0.122215:  17%|█▋        | 17/100 [00:34<02:54,  2.11s/it]Best trial: 9. Best value: 0.122215:  18%|█▊        | 18/100 [00:34<02:36,  1.91s/it]Best trial: 9. Best value: 0.122215:  18%|█▊        | 18/100 [00:34<02:36,  1.91s/it]Best trial: 9. Best value: 0.122215:  19%|█▉        | 19/100 [00:34<02:12,  1.63s/it]Best trial: 9. Best value: 0.122215:  19%|█▉        | 19/100 [00:37<02:12,  1.63s/it]Best trial: 9. Best value: 0.122215:  20%|██        | 20/100 [00:37<02:32,  1.90s/it]Best trial: 9. Best value: 0.122215:  20%|██        | 20/100 [00:38<02:32,  1.90s/it]Best trial: 9. Best value: 0.122215:  21%|██        | 21/100 [00:38<02:12,  1.68s/it]Best trial: 9. Best value: 0.122215:  21%|██        | 21/100 [00:39<02:12,  1.68s/it]Best trial: 9. Best value: 0.122215:  22%|██▏       | 22/100 [00:39<01:50,  1.42s/it]Best trial: 9. Best value: 0.122215:  22%|██▏       | 22/100 [00:40<01:50,  1.42s/it]Best trial: 9. Best value: 0.122215:  23%|██▎       | 23/100 [00:40<01:39,  1.29s/it]Best trial: 9. Best value: 0.122215:  23%|██▎       | 23/100 [00:41<01:39,  1.29s/it]Best trial: 9. Best value: 0.122215:  24%|██▍       | 24/100 [00:41<01:36,  1.27s/it]Best trial: 24. Best value: 0.136895:  24%|██▍       | 24/100 [00:42<01:36,  1.27s/it]Best trial: 24. Best value: 0.136895:  25%|██▌       | 25/100 [00:42<01:26,  1.15s/it]Best trial: 25. Best value: 0.13926:  25%|██▌       | 25/100 [00:43<01:26,  1.15s/it] Best trial: 25. Best value: 0.13926:  26%|██▌       | 26/100 [00:43<01:20,  1.09s/it]Best trial: 25. Best value: 0.13926:  26%|██▌       | 26/100 [00:45<01:20,  1.09s/it]Best trial: 25. Best value: 0.13926:  27%|██▋       | 27/100 [00:45<01:48,  1.49s/it]Best trial: 25. Best value: 0.13926:  27%|██▋       | 27/100 [00:48<01:48,  1.49s/it]Best trial: 25. Best value: 0.13926:  28%|██▊       | 28/100 [00:48<02:03,  1.72s/it]Best trial: 25. Best value: 0.13926:  28%|██▊       | 28/100 [00:49<02:03,  1.72s/it]Best trial: 25. Best value: 0.13926:  29%|██▉       | 29/100 [00:49<01:54,  1.61s/it]Best trial: 25. Best value: 0.13926:  29%|██▉       | 29/100 [00:52<01:54,  1.61s/it]Best trial: 25. Best value: 0.13926:  30%|███       | 30/100 [00:52<02:27,  2.10s/it]Best trial: 25. Best value: 0.13926:  30%|███       | 30/100 [00:54<02:27,  2.10s/it]Best trial: 25. Best value: 0.13926:  31%|███       | 31/100 [00:54<02:22,  2.07s/it]Best trial: 25. Best value: 0.13926:  31%|███       | 31/100 [00:55<02:22,  2.07s/it]Best trial: 25. Best value: 0.13926:  32%|███▏      | 32/100 [00:55<01:56,  1.71s/it]Best trial: 25. Best value: 0.13926:  32%|███▏      | 32/100 [00:56<01:56,  1.71s/it]Best trial: 25. Best value: 0.13926:  33%|███▎      | 33/100 [00:56<01:41,  1.52s/it]Best trial: 25. Best value: 0.13926:  33%|███▎      | 33/100 [00:57<01:41,  1.52s/it]Best trial: 25. Best value: 0.13926:  34%|███▍      | 34/100 [00:57<01:27,  1.32s/it]Best trial: 25. Best value: 0.13926:  34%|███▍      | 34/100 [00:58<01:27,  1.32s/it]Best trial: 25. Best value: 0.13926:  35%|███▌      | 35/100 [00:58<01:22,  1.27s/it]Best trial: 25. Best value: 0.13926:  35%|███▌      | 35/100 [01:00<01:22,  1.27s/it]Best trial: 25. Best value: 0.13926:  36%|███▌      | 36/100 [01:00<01:23,  1.31s/it]Best trial: 36. Best value: 0.140137:  36%|███▌      | 36/100 [01:01<01:23,  1.31s/it]Best trial: 36. Best value: 0.140137:  37%|███▋      | 37/100 [01:01<01:20,  1.29s/it]Best trial: 36. Best value: 0.140137:  37%|███▋      | 37/100 [01:02<01:20,  1.29s/it]Best trial: 36. Best value: 0.140137:  38%|███▊      | 38/100 [01:02<01:20,  1.29s/it]Best trial: 36. Best value: 0.140137:  38%|███▊      | 38/100 [01:03<01:20,  1.29s/it]Best trial: 36. Best value: 0.140137:  39%|███▉      | 39/100 [01:03<01:17,  1.27s/it]Best trial: 36. Best value: 0.140137:  39%|███▉      | 39/100 [01:05<01:17,  1.27s/it]Best trial: 36. Best value: 0.140137:  40%|████      | 40/100 [01:05<01:12,  1.22s/it]Best trial: 36. Best value: 0.140137:  40%|████      | 40/100 [01:06<01:12,  1.22s/it]Best trial: 36. Best value: 0.140137:  41%|████      | 41/100 [01:06<01:18,  1.33s/it]Best trial: 36. Best value: 0.140137:  41%|████      | 41/100 [01:07<01:18,  1.33s/it]Best trial: 36. Best value: 0.140137:  42%|████▏     | 42/100 [01:07<01:11,  1.23s/it]Best trial: 36. Best value: 0.140137:  42%|████▏     | 42/100 [01:08<01:11,  1.23s/it]Best trial: 36. Best value: 0.140137:  43%|████▎     | 43/100 [01:08<01:07,  1.18s/it]Best trial: 36. Best value: 0.140137:  43%|████▎     | 43/100 [01:09<01:07,  1.18s/it]Best trial: 36. Best value: 0.140137:  44%|████▍     | 44/100 [01:09<01:06,  1.18s/it]Best trial: 36. Best value: 0.140137:  44%|████▍     | 44/100 [01:10<01:06,  1.18s/it]Best trial: 36. Best value: 0.140137:  45%|████▌     | 45/100 [01:10<01:02,  1.13s/it]Best trial: 36. Best value: 0.140137:  45%|████▌     | 45/100 [01:12<01:02,  1.13s/it]Best trial: 36. Best value: 0.140137:  46%|████▌     | 46/100 [01:12<01:04,  1.19s/it]Best trial: 36. Best value: 0.140137:  46%|████▌     | 46/100 [01:13<01:04,  1.19s/it]Best trial: 36. Best value: 0.140137:  47%|████▋     | 47/100 [01:13<01:07,  1.28s/it]Best trial: 36. Best value: 0.140137:  47%|████▋     | 47/100 [01:14<01:07,  1.28s/it]Best trial: 36. Best value: 0.140137:  48%|████▊     | 48/100 [01:14<01:02,  1.20s/it]Best trial: 36. Best value: 0.140137:  48%|████▊     | 48/100 [01:16<01:02,  1.20s/it]Best trial: 36. Best value: 0.140137:  49%|████▉     | 49/100 [01:16<01:04,  1.26s/it]Best trial: 36. Best value: 0.140137:  49%|████▉     | 49/100 [01:17<01:04,  1.26s/it]Best trial: 36. Best value: 0.140137:  50%|█████     | 50/100 [01:17<00:58,  1.17s/it]Best trial: 36. Best value: 0.140137:  50%|█████     | 50/100 [01:18<00:58,  1.17s/it]Best trial: 36. Best value: 0.140137:  51%|█████     | 51/100 [01:18<00:57,  1.17s/it]Best trial: 36. Best value: 0.140137:  51%|█████     | 51/100 [01:19<00:57,  1.17s/it]Best trial: 36. Best value: 0.140137:  52%|█████▏    | 52/100 [01:19<00:55,  1.15s/it]Best trial: 36. Best value: 0.140137:  52%|█████▏    | 52/100 [01:20<00:55,  1.15s/it]Best trial: 36. Best value: 0.140137:  53%|█████▎    | 53/100 [01:20<00:52,  1.11s/it]Best trial: 36. Best value: 0.140137:  53%|█████▎    | 53/100 [01:21<00:52,  1.11s/it]Best trial: 36. Best value: 0.140137:  54%|█████▍    | 54/100 [01:21<00:48,  1.05s/it]Best trial: 36. Best value: 0.140137:  54%|█████▍    | 54/100 [01:22<00:48,  1.05s/it]Best trial: 36. Best value: 0.140137:  55%|█████▌    | 55/100 [01:22<00:50,  1.12s/it]Best trial: 36. Best value: 0.140137:  55%|█████▌    | 55/100 [01:23<00:50,  1.12s/it]Best trial: 36. Best value: 0.140137:  56%|█████▌    | 56/100 [01:23<00:48,  1.11s/it]Best trial: 36. Best value: 0.140137:  56%|█████▌    | 56/100 [01:24<00:48,  1.11s/it]Best trial: 36. Best value: 0.140137:  57%|█████▋    | 57/100 [01:24<00:49,  1.14s/it]Best trial: 36. Best value: 0.140137:  57%|█████▋    | 57/100 [01:25<00:49,  1.14s/it]Best trial: 36. Best value: 0.140137:  58%|█████▊    | 58/100 [01:25<00:46,  1.11s/it]Best trial: 36. Best value: 0.140137:  58%|█████▊    | 58/100 [01:27<00:46,  1.11s/it]Best trial: 36. Best value: 0.140137:  59%|█████▉    | 59/100 [01:27<00:48,  1.19s/it]Best trial: 36. Best value: 0.140137:  59%|█████▉    | 59/100 [01:28<00:48,  1.19s/it]Best trial: 36. Best value: 0.140137:  60%|██████    | 60/100 [01:28<00:44,  1.12s/it]Best trial: 36. Best value: 0.140137:  60%|██████    | 60/100 [01:29<00:44,  1.12s/it]Best trial: 36. Best value: 0.140137:  61%|██████    | 61/100 [01:29<00:47,  1.21s/it]Best trial: 36. Best value: 0.140137:  61%|██████    | 61/100 [01:30<00:47,  1.21s/it]Best trial: 36. Best value: 0.140137:  62%|██████▏   | 62/100 [01:30<00:43,  1.14s/it]Best trial: 36. Best value: 0.140137:  62%|██████▏   | 62/100 [01:31<00:43,  1.14s/it]Best trial: 36. Best value: 0.140137:  63%|██████▎   | 63/100 [01:31<00:44,  1.19s/it]Best trial: 36. Best value: 0.140137:  63%|██████▎   | 63/100 [01:33<00:44,  1.19s/it]Best trial: 36. Best value: 0.140137:  64%|██████▍   | 64/100 [01:33<00:42,  1.17s/it]Best trial: 64. Best value: 0.151457:  64%|██████▍   | 64/100 [01:33<00:42,  1.17s/it]Best trial: 64. Best value: 0.151457:  65%|██████▌   | 65/100 [01:33<00:37,  1.08s/it]Best trial: 64. Best value: 0.151457:  65%|██████▌   | 65/100 [01:35<00:37,  1.08s/it]Best trial: 64. Best value: 0.151457:  66%|██████▌   | 66/100 [01:35<00:39,  1.15s/it]Best trial: 64. Best value: 0.151457:  66%|██████▌   | 66/100 [01:36<00:39,  1.15s/it]Best trial: 64. Best value: 0.151457:  67%|██████▋   | 67/100 [01:36<00:38,  1.15s/it]Best trial: 64. Best value: 0.151457:  67%|██████▋   | 67/100 [01:38<00:38,  1.15s/it]Best trial: 64. Best value: 0.151457:  68%|██████▊   | 68/100 [01:38<00:41,  1.31s/it]Best trial: 64. Best value: 0.151457:  68%|██████▊   | 68/100 [01:39<00:41,  1.31s/it]Best trial: 64. Best value: 0.151457:  69%|██████▉   | 69/100 [01:39<00:42,  1.37s/it]Best trial: 64. Best value: 0.151457:  69%|██████▉   | 69/100 [01:41<00:42,  1.37s/it]Best trial: 64. Best value: 0.151457:  70%|███████   | 70/100 [01:41<00:41,  1.40s/it]Best trial: 64. Best value: 0.151457:  70%|███████   | 70/100 [01:41<00:41,  1.40s/it]Best trial: 64. Best value: 0.151457:  71%|███████   | 71/100 [01:41<00:36,  1.25s/it]Best trial: 64. Best value: 0.151457:  71%|███████   | 71/100 [01:42<00:36,  1.25s/it]Best trial: 64. Best value: 0.151457:  72%|███████▏  | 72/100 [01:42<00:31,  1.14s/it]Best trial: 64. Best value: 0.151457:  72%|███████▏  | 72/100 [01:43<00:31,  1.14s/it]Best trial: 64. Best value: 0.151457:  73%|███████▎  | 73/100 [01:43<00:29,  1.09s/it]Best trial: 64. Best value: 0.151457:  73%|███████▎  | 73/100 [01:45<00:29,  1.09s/it]Best trial: 64. Best value: 0.151457:  74%|███████▍  | 74/100 [01:45<00:29,  1.13s/it]Best trial: 64. Best value: 0.151457:  74%|███████▍  | 74/100 [01:46<00:29,  1.13s/it]Best trial: 64. Best value: 0.151457:  75%|███████▌  | 75/100 [01:46<00:28,  1.15s/it]Best trial: 64. Best value: 0.151457:  75%|███████▌  | 75/100 [01:47<00:28,  1.15s/it]Best trial: 64. Best value: 0.151457:  76%|███████▌  | 76/100 [01:47<00:27,  1.15s/it]Best trial: 64. Best value: 0.151457:  76%|███████▌  | 76/100 [01:48<00:27,  1.15s/it]Best trial: 64. Best value: 0.151457:  77%|███████▋  | 77/100 [01:48<00:27,  1.20s/it]Best trial: 64. Best value: 0.151457:  77%|███████▋  | 77/100 [01:49<00:27,  1.20s/it]Best trial: 64. Best value: 0.151457:  78%|███████▊  | 78/100 [01:49<00:23,  1.09s/it]Best trial: 64. Best value: 0.151457:  78%|███████▊  | 78/100 [01:50<00:23,  1.09s/it]Best trial: 64. Best value: 0.151457:  79%|███████▉  | 79/100 [01:50<00:23,  1.14s/it]Best trial: 64. Best value: 0.151457:  79%|███████▉  | 79/100 [01:52<00:23,  1.14s/it]Best trial: 64. Best value: 0.151457:  80%|████████  | 80/100 [01:52<00:24,  1.21s/it]Best trial: 64. Best value: 0.151457:  80%|████████  | 80/100 [01:53<00:24,  1.21s/it]Best trial: 64. Best value: 0.151457:  81%|████████  | 81/100 [01:53<00:25,  1.34s/it]Best trial: 64. Best value: 0.151457:  81%|████████  | 81/100 [01:55<00:25,  1.34s/it]Best trial: 64. Best value: 0.151457:  82%|████████▏ | 82/100 [01:55<00:23,  1.31s/it]Best trial: 64. Best value: 0.151457:  82%|████████▏ | 82/100 [01:56<00:23,  1.31s/it]Best trial: 64. Best value: 0.151457:  83%|████████▎ | 83/100 [01:56<00:22,  1.34s/it]Best trial: 64. Best value: 0.151457:  83%|████████▎ | 83/100 [01:57<00:22,  1.34s/it]Best trial: 64. Best value: 0.151457:  84%|████████▍ | 84/100 [01:57<00:19,  1.23s/it]Best trial: 64. Best value: 0.151457:  84%|████████▍ | 84/100 [01:58<00:19,  1.23s/it]Best trial: 64. Best value: 0.151457:  85%|████████▌ | 85/100 [01:58<00:16,  1.12s/it]Best trial: 64. Best value: 0.151457:  85%|████████▌ | 85/100 [01:59<00:16,  1.12s/it]Best trial: 64. Best value: 0.151457:  86%|████████▌ | 86/100 [01:59<00:16,  1.19s/it]Best trial: 64. Best value: 0.151457:  86%|████████▌ | 86/100 [02:01<00:16,  1.19s/it]Best trial: 64. Best value: 0.151457:  87%|████████▋ | 87/100 [02:01<00:19,  1.53s/it]Best trial: 64. Best value: 0.151457:  87%|████████▋ | 87/100 [02:03<00:19,  1.53s/it]Best trial: 64. Best value: 0.151457:  88%|████████▊ | 88/100 [02:03<00:16,  1.40s/it]Best trial: 64. Best value: 0.151457:  88%|████████▊ | 88/100 [02:04<00:16,  1.40s/it]Best trial: 64. Best value: 0.151457:  89%|████████▉ | 89/100 [02:04<00:14,  1.36s/it]Best trial: 64. Best value: 0.151457:  89%|████████▉ | 89/100 [02:05<00:14,  1.36s/it]Best trial: 64. Best value: 0.151457:  90%|█████████ | 90/100 [02:05<00:12,  1.24s/it]Best trial: 64. Best value: 0.151457:  90%|█████████ | 90/100 [02:06<00:12,  1.24s/it]Best trial: 64. Best value: 0.151457:  91%|█████████ | 91/100 [02:06<00:10,  1.19s/it]Best trial: 64. Best value: 0.151457:  91%|█████████ | 91/100 [02:07<00:10,  1.19s/it]Best trial: 64. Best value: 0.151457:  92%|█████████▏| 92/100 [02:07<00:09,  1.13s/it]Best trial: 64. Best value: 0.151457:  92%|█████████▏| 92/100 [02:08<00:09,  1.13s/it]Best trial: 64. Best value: 0.151457:  93%|█████████▎| 93/100 [02:08<00:07,  1.12s/it]Best trial: 64. Best value: 0.151457:  93%|█████████▎| 93/100 [02:09<00:07,  1.12s/it]Best trial: 64. Best value: 0.151457:  94%|█████████▍| 94/100 [02:09<00:06,  1.05s/it]Best trial: 64. Best value: 0.151457:  94%|█████████▍| 94/100 [02:11<00:06,  1.05s/it]Best trial: 64. Best value: 0.151457:  95%|█████████▌| 95/100 [02:11<00:06,  1.38s/it]Best trial: 64. Best value: 0.151457:  95%|█████████▌| 95/100 [02:12<00:06,  1.38s/it]Best trial: 64. Best value: 0.151457:  96%|█████████▌| 96/100 [02:12<00:04,  1.24s/it]Best trial: 64. Best value: 0.151457:  96%|█████████▌| 96/100 [02:13<00:04,  1.24s/it]Best trial: 64. Best value: 0.151457:  97%|█████████▋| 97/100 [02:13<00:03,  1.18s/it]Best trial: 64. Best value: 0.151457:  97%|█████████▋| 97/100 [02:14<00:03,  1.18s/it]Best trial: 64. Best value: 0.151457:  98%|█████████▊| 98/100 [02:14<00:02,  1.18s/it]Best trial: 64. Best value: 0.151457:  98%|█████████▊| 98/100 [02:15<00:02,  1.18s/it]Best trial: 64. Best value: 0.151457:  99%|█████████▉| 99/100 [02:15<00:01,  1.08s/it]Best trial: 64. Best value: 0.151457:  99%|█████████▉| 99/100 [02:16<00:01,  1.08s/it]Best trial: 64. Best value: 0.151457: 100%|██████████| 100/100 [02:16<00:00,  1.18s/it]Best trial: 64. Best value: 0.151457: 100%|██████████| 100/100 [02:16<00:00,  1.37s/it]
2025-11-30 07:52:42,710 - INFO - HPO Complete. Best AUPRC: 0.1515
2025-11-30 07:52:42,711 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.02312913658097715, 'max_depth': 3, 'subsample': 0.6585718790945131, 'colsample_bytree': 0.6694658012999809, 'gamma': 2.4072766514372486, 'reg_lambda': 8.850843430080334e-05, 'reg_alpha': 3.897164143544884e-06}
2025-11-30 07:52:42,711 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:52:44,852 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 07:52:44,853 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:52:44,955 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:52:44,967 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:52:44,970 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 07:52:44,970 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:52:44,970 - INFO - Training model...
2025-11-30 07:52:47,344 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:52:52,136 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:52:52,136 - INFO - AUROC: 0.5935 (0.4879 - 0.6523)
2025-11-30 07:52:52,136 - INFO - AUPRC: 0.0755 (0.0433 - 0.1251)
2025-11-30 07:52:52,136 - INFO - Brier Score: 0.0830 (0.0739 - 0.0978)
2025-11-30 07:52:52,136 - INFO - Accuracy: 0.8772 (0.3066 - 0.9078)
2025-11-30 07:52:52,136 - INFO - Precision: 0.1231 (0.0472 - 0.2073)
2025-11-30 07:52:52,136 - INFO - Sensitivity (Recall): 0.2222 (0.1480 - 0.8841)
2025-11-30 07:52:52,136 - INFO - F1-Score: 0.1584 (0.0881 - 0.2428)
2025-11-30 07:52:52,136 - INFO - Best Threshold: 0.4000 (0.0600 - 0.4760)
2025-11-30 07:52:52,136 - INFO - Specificity: 0.9131 (0.2853 - 0.9505)
2025-11-30 07:52:52,154 - INFO - Calculating SHAP values...
2025-11-30 07:52:53,389 - INFO - SHAP plots saved.
2025-11-30 07:52:53,392 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:52:54,913 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 07:52:54,913 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:52:55,006 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:52:55,031 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:52:55,037 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 07:52:55,037 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.500728:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.500728:   1%|          | 1/100 [00:03<05:43,  3.47s/it]Best trial: 1. Best value: 0.51753:   1%|          | 1/100 [00:07<05:43,  3.47s/it] Best trial: 1. Best value: 0.51753:   2%|▏         | 2/100 [00:07<05:58,  3.66s/it]Best trial: 1. Best value: 0.51753:   2%|▏         | 2/100 [00:10<05:58,  3.66s/it]Best trial: 1. Best value: 0.51753:   3%|▎         | 3/100 [00:10<05:15,  3.25s/it]Best trial: 3. Best value: 0.536154:   3%|▎         | 3/100 [00:13<05:15,  3.25s/it]Best trial: 3. Best value: 0.536154:   4%|▍         | 4/100 [00:13<05:05,  3.18s/it]Best trial: 4. Best value: 0.542946:   4%|▍         | 4/100 [00:16<05:05,  3.18s/it]Best trial: 4. Best value: 0.542946:   5%|▌         | 5/100 [00:16<05:15,  3.32s/it]Best trial: 4. Best value: 0.542946:   5%|▌         | 5/100 [00:19<05:15,  3.32s/it]Best trial: 4. Best value: 0.542946:   6%|▌         | 6/100 [00:19<05:07,  3.28s/it]Best trial: 4. Best value: 0.542946:   6%|▌         | 6/100 [00:24<05:07,  3.28s/it]Best trial: 4. Best value: 0.542946:   7%|▋         | 7/100 [00:24<05:33,  3.59s/it]Best trial: 4. Best value: 0.542946:   7%|▋         | 7/100 [00:28<05:33,  3.59s/it]Best trial: 4. Best value: 0.542946:   8%|▊         | 8/100 [00:28<05:48,  3.79s/it]Best trial: 4. Best value: 0.542946:   8%|▊         | 8/100 [00:31<05:48,  3.79s/it]Best trial: 4. Best value: 0.542946:   9%|▉         | 9/100 [00:31<05:23,  3.56s/it]Best trial: 4. Best value: 0.542946:   9%|▉         | 9/100 [00:35<05:23,  3.56s/it]Best trial: 4. Best value: 0.542946:  10%|█         | 10/100 [00:35<05:49,  3.88s/it]Best trial: 4. Best value: 0.542946:  10%|█         | 10/100 [00:38<05:49,  3.88s/it]Best trial: 4. Best value: 0.542946:  11%|█         | 11/100 [00:38<05:19,  3.59s/it]Best trial: 4. Best value: 0.542946:  11%|█         | 11/100 [00:44<05:19,  3.59s/it]Best trial: 4. Best value: 0.542946:  12%|█▏        | 12/100 [00:44<06:09,  4.20s/it]Best trial: 4. Best value: 0.542946:  12%|█▏        | 12/100 [00:50<06:09,  4.20s/it]Best trial: 4. Best value: 0.542946:  13%|█▎        | 13/100 [00:50<07:04,  4.88s/it]Best trial: 4. Best value: 0.542946:  13%|█▎        | 13/100 [00:53<07:04,  4.88s/it]Best trial: 4. Best value: 0.542946:  14%|█▍        | 14/100 [00:53<05:57,  4.15s/it]Best trial: 4. Best value: 0.542946:  14%|█▍        | 14/100 [00:57<05:57,  4.15s/it]Best trial: 4. Best value: 0.542946:  15%|█▌        | 15/100 [00:57<05:56,  4.19s/it]Best trial: 4. Best value: 0.542946:  15%|█▌        | 15/100 [01:01<05:56,  4.19s/it]Best trial: 4. Best value: 0.542946:  16%|█▌        | 16/100 [01:01<05:46,  4.12s/it]Best trial: 4. Best value: 0.542946:  16%|█▌        | 16/100 [01:06<05:46,  4.12s/it]Best trial: 4. Best value: 0.542946:  17%|█▋        | 17/100 [01:06<05:54,  4.27s/it]Best trial: 17. Best value: 0.545042:  17%|█▋        | 17/100 [01:08<05:54,  4.27s/it]Best trial: 17. Best value: 0.545042:  18%|█▊        | 18/100 [01:08<05:02,  3.69s/it]Best trial: 17. Best value: 0.545042:  18%|█▊        | 18/100 [01:10<05:02,  3.69s/it]Best trial: 17. Best value: 0.545042:  19%|█▉        | 19/100 [01:10<04:17,  3.18s/it]Best trial: 17. Best value: 0.545042:  19%|█▉        | 19/100 [01:13<04:17,  3.18s/it]Best trial: 17. Best value: 0.545042:  20%|██        | 20/100 [01:13<04:14,  3.18s/it]Best trial: 17. Best value: 0.545042:  20%|██        | 20/100 [01:15<04:14,  3.18s/it]Best trial: 17. Best value: 0.545042:  21%|██        | 21/100 [01:15<03:46,  2.87s/it]Best trial: 21. Best value: 0.548101:  21%|██        | 21/100 [01:18<03:46,  2.87s/it]Best trial: 21. Best value: 0.548101:  22%|██▏       | 22/100 [01:18<03:31,  2.71s/it]Best trial: 21. Best value: 0.548101:  22%|██▏       | 22/100 [01:20<03:31,  2.71s/it]Best trial: 21. Best value: 0.548101:  23%|██▎       | 23/100 [01:20<03:26,  2.68s/it]Best trial: 21. Best value: 0.548101:  23%|██▎       | 23/100 [01:23<03:26,  2.68s/it]Best trial: 21. Best value: 0.548101:  24%|██▍       | 24/100 [01:23<03:25,  2.71s/it]Best trial: 24. Best value: 0.548753:  24%|██▍       | 24/100 [01:27<03:25,  2.71s/it]Best trial: 24. Best value: 0.548753:  25%|██▌       | 25/100 [01:27<03:44,  2.99s/it]Best trial: 24. Best value: 0.548753:  25%|██▌       | 25/100 [01:30<03:44,  2.99s/it]Best trial: 24. Best value: 0.548753:  26%|██▌       | 26/100 [01:30<03:49,  3.10s/it]Best trial: 24. Best value: 0.548753:  26%|██▌       | 26/100 [01:33<03:49,  3.10s/it]Best trial: 24. Best value: 0.548753:  27%|██▋       | 27/100 [01:33<03:40,  3.03s/it]Best trial: 24. Best value: 0.548753:  27%|██▋       | 27/100 [01:35<03:40,  3.03s/it]Best trial: 24. Best value: 0.548753:  28%|██▊       | 28/100 [01:35<03:15,  2.72s/it]Best trial: 24. Best value: 0.548753:  28%|██▊       | 28/100 [01:37<03:15,  2.72s/it]Best trial: 24. Best value: 0.548753:  29%|██▉       | 29/100 [01:37<03:03,  2.59s/it]Best trial: 24. Best value: 0.548753:  29%|██▉       | 29/100 [01:40<03:03,  2.59s/it]Best trial: 24. Best value: 0.548753:  30%|███       | 30/100 [01:40<03:03,  2.62s/it]Best trial: 24. Best value: 0.548753:  30%|███       | 30/100 [01:43<03:03,  2.62s/it]Best trial: 24. Best value: 0.548753:  31%|███       | 31/100 [01:43<03:14,  2.82s/it]Best trial: 24. Best value: 0.548753:  31%|███       | 31/100 [01:45<03:14,  2.82s/it]Best trial: 24. Best value: 0.548753:  32%|███▏      | 32/100 [01:45<02:53,  2.55s/it]Best trial: 24. Best value: 0.548753:  32%|███▏      | 32/100 [01:48<02:53,  2.55s/it]Best trial: 24. Best value: 0.548753:  33%|███▎      | 33/100 [01:48<02:48,  2.52s/it]Best trial: 24. Best value: 0.548753:  33%|███▎      | 33/100 [01:50<02:48,  2.52s/it]Best trial: 24. Best value: 0.548753:  34%|███▍      | 34/100 [01:50<02:34,  2.34s/it]Best trial: 24. Best value: 0.548753:  34%|███▍      | 34/100 [01:52<02:34,  2.34s/it]Best trial: 24. Best value: 0.548753:  35%|███▌      | 35/100 [01:52<02:29,  2.31s/it]Best trial: 24. Best value: 0.548753:  35%|███▌      | 35/100 [01:55<02:29,  2.31s/it]Best trial: 24. Best value: 0.548753:  36%|███▌      | 36/100 [01:55<02:36,  2.45s/it]Best trial: 24. Best value: 0.548753:  36%|███▌      | 36/100 [01:57<02:36,  2.45s/it]Best trial: 24. Best value: 0.548753:  37%|███▋      | 37/100 [01:57<02:24,  2.30s/it]Best trial: 24. Best value: 0.548753:  37%|███▋      | 37/100 [01:59<02:24,  2.30s/it]Best trial: 24. Best value: 0.548753:  38%|███▊      | 38/100 [01:59<02:28,  2.40s/it]Best trial: 24. Best value: 0.548753:  38%|███▊      | 38/100 [02:01<02:28,  2.40s/it]Best trial: 24. Best value: 0.548753:  39%|███▉      | 39/100 [02:01<02:12,  2.17s/it]Best trial: 24. Best value: 0.548753:  39%|███▉      | 39/100 [02:03<02:12,  2.17s/it]Best trial: 24. Best value: 0.548753:  40%|████      | 40/100 [02:03<02:19,  2.32s/it]Best trial: 24. Best value: 0.548753:  40%|████      | 40/100 [02:06<02:19,  2.32s/it]Best trial: 24. Best value: 0.548753:  41%|████      | 41/100 [02:06<02:16,  2.32s/it]Best trial: 24. Best value: 0.548753:  41%|████      | 41/100 [02:09<02:16,  2.32s/it]Best trial: 24. Best value: 0.548753:  42%|████▏     | 42/100 [02:09<02:29,  2.58s/it]Best trial: 24. Best value: 0.548753:  42%|████▏     | 42/100 [02:13<02:29,  2.58s/it]Best trial: 24. Best value: 0.548753:  43%|████▎     | 43/100 [02:13<02:54,  3.05s/it]Best trial: 24. Best value: 0.548753:  43%|████▎     | 43/100 [02:16<02:54,  3.05s/it]Best trial: 24. Best value: 0.548753:  44%|████▍     | 44/100 [02:16<02:47,  2.99s/it]Best trial: 24. Best value: 0.548753:  44%|████▍     | 44/100 [02:20<02:47,  2.99s/it]Best trial: 24. Best value: 0.548753:  45%|████▌     | 45/100 [02:20<03:08,  3.43s/it]Best trial: 24. Best value: 0.548753:  45%|████▌     | 45/100 [02:23<03:08,  3.43s/it]Best trial: 24. Best value: 0.548753:  46%|████▌     | 46/100 [02:23<02:58,  3.31s/it]Best trial: 24. Best value: 0.548753:  46%|████▌     | 46/100 [02:25<02:58,  3.31s/it]Best trial: 24. Best value: 0.548753:  47%|████▋     | 47/100 [02:25<02:34,  2.92s/it]Best trial: 24. Best value: 0.548753:  47%|████▋     | 47/100 [02:29<02:34,  2.92s/it]Best trial: 24. Best value: 0.548753:  48%|████▊     | 48/100 [02:29<02:36,  3.01s/it]Best trial: 24. Best value: 0.548753:  48%|████▊     | 48/100 [02:34<02:36,  3.01s/it]Best trial: 24. Best value: 0.548753:  49%|████▉     | 49/100 [02:34<03:03,  3.60s/it]Best trial: 24. Best value: 0.548753:  49%|████▉     | 49/100 [02:37<03:03,  3.60s/it]Best trial: 24. Best value: 0.548753:  50%|█████     | 50/100 [02:37<03:01,  3.64s/it]Best trial: 24. Best value: 0.548753:  50%|█████     | 50/100 [02:39<03:01,  3.64s/it]Best trial: 24. Best value: 0.548753:  51%|█████     | 51/100 [02:39<02:33,  3.14s/it]Best trial: 24. Best value: 0.548753:  51%|█████     | 51/100 [02:43<02:33,  3.14s/it]Best trial: 24. Best value: 0.548753:  52%|█████▏    | 52/100 [02:43<02:40,  3.34s/it]Best trial: 24. Best value: 0.548753:  52%|█████▏    | 52/100 [02:48<02:40,  3.34s/it]Best trial: 24. Best value: 0.548753:  53%|█████▎    | 53/100 [02:48<02:55,  3.74s/it]Best trial: 24. Best value: 0.548753:  53%|█████▎    | 53/100 [02:50<02:55,  3.74s/it]Best trial: 24. Best value: 0.548753:  54%|█████▍    | 54/100 [02:50<02:35,  3.37s/it]Best trial: 24. Best value: 0.548753:  54%|█████▍    | 54/100 [02:54<02:35,  3.37s/it]Best trial: 24. Best value: 0.548753:  55%|█████▌    | 55/100 [02:54<02:36,  3.47s/it]Best trial: 24. Best value: 0.548753:  55%|█████▌    | 55/100 [02:57<02:36,  3.47s/it]Best trial: 24. Best value: 0.548753:  56%|█████▌    | 56/100 [02:57<02:30,  3.42s/it]Best trial: 24. Best value: 0.548753:  56%|█████▌    | 56/100 [03:01<02:30,  3.42s/it]Best trial: 24. Best value: 0.548753:  57%|█████▋    | 57/100 [03:01<02:27,  3.44s/it]Best trial: 24. Best value: 0.548753:  57%|█████▋    | 57/100 [03:04<02:27,  3.44s/it]Best trial: 24. Best value: 0.548753:  58%|█████▊    | 58/100 [03:04<02:22,  3.40s/it]Best trial: 24. Best value: 0.548753:  58%|█████▊    | 58/100 [03:13<02:22,  3.40s/it]Best trial: 24. Best value: 0.548753:  59%|█████▉    | 59/100 [03:13<03:26,  5.04s/it]Best trial: 24. Best value: 0.548753:  59%|█████▉    | 59/100 [03:16<03:26,  5.04s/it]Best trial: 24. Best value: 0.548753:  60%|██████    | 60/100 [03:16<02:55,  4.39s/it]Best trial: 24. Best value: 0.548753:  60%|██████    | 60/100 [03:18<02:55,  4.39s/it]Best trial: 24. Best value: 0.548753:  61%|██████    | 61/100 [03:18<02:29,  3.82s/it]Best trial: 24. Best value: 0.548753:  61%|██████    | 61/100 [03:21<02:29,  3.82s/it]Best trial: 24. Best value: 0.548753:  62%|██████▏   | 62/100 [03:21<02:09,  3.41s/it]Best trial: 62. Best value: 0.553014:  62%|██████▏   | 62/100 [03:23<02:09,  3.41s/it]Best trial: 62. Best value: 0.553014:  63%|██████▎   | 63/100 [03:23<01:52,  3.04s/it]Best trial: 62. Best value: 0.553014:  63%|██████▎   | 63/100 [03:25<01:52,  3.04s/it]Best trial: 62. Best value: 0.553014:  64%|██████▍   | 64/100 [03:25<01:42,  2.86s/it]Best trial: 62. Best value: 0.553014:  64%|██████▍   | 64/100 [03:27<01:42,  2.86s/it]Best trial: 62. Best value: 0.553014:  65%|██████▌   | 65/100 [03:27<01:31,  2.60s/it]Best trial: 62. Best value: 0.553014:  65%|██████▌   | 65/100 [03:30<01:31,  2.60s/it]Best trial: 62. Best value: 0.553014:  66%|██████▌   | 66/100 [03:30<01:30,  2.66s/it]Best trial: 62. Best value: 0.553014:  66%|██████▌   | 66/100 [03:33<01:30,  2.66s/it]Best trial: 62. Best value: 0.553014:  67%|██████▋   | 67/100 [03:33<01:24,  2.56s/it]Best trial: 62. Best value: 0.553014:  67%|██████▋   | 67/100 [03:35<01:24,  2.56s/it]Best trial: 62. Best value: 0.553014:  68%|██████▊   | 68/100 [03:35<01:21,  2.56s/it]Best trial: 62. Best value: 0.553014:  68%|██████▊   | 68/100 [03:37<01:21,  2.56s/it]Best trial: 62. Best value: 0.553014:  69%|██████▉   | 69/100 [03:37<01:17,  2.50s/it]Best trial: 62. Best value: 0.553014:  69%|██████▉   | 69/100 [03:41<01:17,  2.50s/it]Best trial: 62. Best value: 0.553014:  70%|███████   | 70/100 [03:41<01:27,  2.92s/it]Best trial: 62. Best value: 0.553014:  70%|███████   | 70/100 [03:45<01:27,  2.92s/it]Best trial: 62. Best value: 0.553014:  71%|███████   | 71/100 [03:45<01:34,  3.26s/it]Best trial: 62. Best value: 0.553014:  71%|███████   | 71/100 [03:48<01:34,  3.26s/it]Best trial: 62. Best value: 0.553014:  72%|███████▏  | 72/100 [03:48<01:27,  3.14s/it]Best trial: 62. Best value: 0.553014:  72%|███████▏  | 72/100 [03:50<01:27,  3.14s/it]Best trial: 62. Best value: 0.553014:  73%|███████▎  | 73/100 [03:50<01:16,  2.85s/it]Best trial: 62. Best value: 0.553014:  73%|███████▎  | 73/100 [03:53<01:16,  2.85s/it]Best trial: 62. Best value: 0.553014:  74%|███████▍  | 74/100 [03:53<01:12,  2.78s/it]Best trial: 62. Best value: 0.553014:  74%|███████▍  | 74/100 [03:55<01:12,  2.78s/it]Best trial: 62. Best value: 0.553014:  75%|███████▌  | 75/100 [03:55<01:06,  2.66s/it]Best trial: 62. Best value: 0.553014:  75%|███████▌  | 75/100 [03:58<01:06,  2.66s/it]Best trial: 62. Best value: 0.553014:  76%|███████▌  | 76/100 [03:58<01:03,  2.66s/it]Best trial: 62. Best value: 0.553014:  76%|███████▌  | 76/100 [04:01<01:03,  2.66s/it]Best trial: 62. Best value: 0.553014:  77%|███████▋  | 77/100 [04:01<01:01,  2.69s/it]Best trial: 62. Best value: 0.553014:  77%|███████▋  | 77/100 [04:04<01:01,  2.69s/it]Best trial: 62. Best value: 0.553014:  78%|███████▊  | 78/100 [04:04<00:59,  2.71s/it]Best trial: 62. Best value: 0.553014:  78%|███████▊  | 78/100 [04:06<00:59,  2.71s/it]Best trial: 62. Best value: 0.553014:  79%|███████▉  | 79/100 [04:06<00:53,  2.54s/it]Best trial: 62. Best value: 0.553014:  79%|███████▉  | 79/100 [04:08<00:53,  2.54s/it]Best trial: 62. Best value: 0.553014:  80%|████████  | 80/100 [04:08<00:50,  2.53s/it]Best trial: 62. Best value: 0.553014:  80%|████████  | 80/100 [04:12<00:50,  2.53s/it]Best trial: 62. Best value: 0.553014:  81%|████████  | 81/100 [04:12<00:53,  2.84s/it]Best trial: 62. Best value: 0.553014:  81%|████████  | 81/100 [04:15<00:53,  2.84s/it]Best trial: 62. Best value: 0.553014:  82%|████████▏ | 82/100 [04:15<00:50,  2.81s/it]Best trial: 62. Best value: 0.553014:  82%|████████▏ | 82/100 [04:17<00:50,  2.81s/it]Best trial: 62. Best value: 0.553014:  83%|████████▎ | 83/100 [04:17<00:45,  2.65s/it]Best trial: 62. Best value: 0.553014:  83%|████████▎ | 83/100 [04:19<00:45,  2.65s/it]Best trial: 62. Best value: 0.553014:  84%|████████▍ | 84/100 [04:19<00:41,  2.56s/it]Best trial: 62. Best value: 0.553014:  84%|████████▍ | 84/100 [04:21<00:41,  2.56s/it]Best trial: 62. Best value: 0.553014:  85%|████████▌ | 85/100 [04:21<00:37,  2.48s/it]Best trial: 62. Best value: 0.553014:  85%|████████▌ | 85/100 [04:24<00:37,  2.48s/it]Best trial: 62. Best value: 0.553014:  86%|████████▌ | 86/100 [04:24<00:34,  2.43s/it]Best trial: 62. Best value: 0.553014:  86%|████████▌ | 86/100 [04:26<00:34,  2.43s/it]Best trial: 62. Best value: 0.553014:  87%|████████▋ | 87/100 [04:26<00:29,  2.31s/it]Best trial: 87. Best value: 0.560697:  87%|████████▋ | 87/100 [04:28<00:29,  2.31s/it]Best trial: 87. Best value: 0.560697:  88%|████████▊ | 88/100 [04:28<00:26,  2.24s/it]Best trial: 87. Best value: 0.560697:  88%|████████▊ | 88/100 [04:30<00:26,  2.24s/it]Best trial: 87. Best value: 0.560697:  89%|████████▉ | 89/100 [04:30<00:24,  2.22s/it]Best trial: 87. Best value: 0.560697:  89%|████████▉ | 89/100 [04:33<00:24,  2.22s/it]Best trial: 87. Best value: 0.560697:  90%|█████████ | 90/100 [04:33<00:23,  2.34s/it]Best trial: 87. Best value: 0.560697:  90%|█████████ | 90/100 [04:35<00:23,  2.34s/it]Best trial: 87. Best value: 0.560697:  91%|█████████ | 91/100 [04:35<00:20,  2.22s/it]Best trial: 87. Best value: 0.560697:  91%|█████████ | 91/100 [04:37<00:20,  2.22s/it]Best trial: 87. Best value: 0.560697:  92%|█████████▏| 92/100 [04:37<00:17,  2.16s/it]Best trial: 87. Best value: 0.560697:  92%|█████████▏| 92/100 [04:39<00:17,  2.16s/it]Best trial: 87. Best value: 0.560697:  93%|█████████▎| 93/100 [04:39<00:14,  2.10s/it]Best trial: 87. Best value: 0.560697:  93%|█████████▎| 93/100 [04:41<00:14,  2.10s/it]Best trial: 87. Best value: 0.560697:  94%|█████████▍| 94/100 [04:41<00:12,  2.08s/it]Best trial: 87. Best value: 0.560697:  94%|█████████▍| 94/100 [04:43<00:12,  2.08s/it]Best trial: 87. Best value: 0.560697:  95%|█████████▌| 95/100 [04:43<00:10,  2.15s/it]Best trial: 87. Best value: 0.560697:  95%|█████████▌| 95/100 [04:45<00:10,  2.15s/it]Best trial: 87. Best value: 0.560697:  96%|█████████▌| 96/100 [04:45<00:08,  2.22s/it]Best trial: 87. Best value: 0.560697:  96%|█████████▌| 96/100 [04:48<00:08,  2.22s/it]Best trial: 87. Best value: 0.560697:  97%|█████████▋| 97/100 [04:48<00:06,  2.30s/it]Best trial: 97. Best value: 0.567117:  97%|█████████▋| 97/100 [04:50<00:06,  2.30s/it]Best trial: 97. Best value: 0.567117:  98%|█████████▊| 98/100 [04:50<00:04,  2.30s/it]Best trial: 97. Best value: 0.567117:  98%|█████████▊| 98/100 [04:52<00:04,  2.30s/it]Best trial: 97. Best value: 0.567117:  99%|█████████▉| 99/100 [04:52<00:02,  2.17s/it]Best trial: 99. Best value: 0.567363:  99%|█████████▉| 99/100 [04:55<00:02,  2.17s/it]Best trial: 99. Best value: 0.567363: 100%|██████████| 100/100 [04:55<00:00,  2.27s/it]Best trial: 99. Best value: 0.567363: 100%|██████████| 100/100 [04:55<00:00,  2.95s/it]
2025-11-30 07:57:50,056 - INFO - HPO Complete. Best AUPRC: 0.5674
2025-11-30 07:57:50,056 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.048313026266575465, 'max_depth': 3, 'subsample': 0.6003107425117243, 'colsample_bytree': 0.603170776007886, 'gamma': 2.2522377895439676, 'reg_lambda': 2.1244896702797155e-08, 'reg_alpha': 0.14055208320141804}
2025-11-30 07:57:50,057 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 07:57:52,173 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 07:57:52,173 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:57:52,277 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:57:52,301 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:57:52,307 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 07:57:52,307 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 07:57:52,307 - INFO - Training model...
2025-11-30 07:57:54,477 - INFO - Evaluating model with bootstrapping...
2025-11-30 07:57:59,838 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 07:57:59,839 - INFO - AUROC: 0.7965 (0.7286 - 0.8471)
2025-11-30 07:57:59,839 - INFO - AUPRC: 0.3019 (0.1652 - 0.5193)
2025-11-30 07:57:59,839 - INFO - Brier Score: 0.0481 (0.0359 - 0.0630)
2025-11-30 07:57:59,839 - INFO - Accuracy: 0.9523 (0.8639 - 0.9688)
2025-11-30 07:57:59,839 - INFO - Precision: 0.5714 (0.1867 - 0.8653)
2025-11-30 07:57:59,839 - INFO - Sensitivity (Recall): 0.3333 (0.2236 - 0.5350)
2025-11-30 07:57:59,839 - INFO - F1-Score: 0.4211 (0.2621 - 0.5748)
2025-11-30 07:57:59,839 - INFO - Best Threshold: 0.6100 (0.1240 - 0.7900)
2025-11-30 07:57:59,839 - INFO - Specificity: 0.9863 (0.8813 - 0.9967)
2025-11-30 07:57:59,858 - INFO - Calculating SHAP values...
2025-11-30 07:58:00,888 - INFO - SHAP plots saved.
2025-11-30 07:58:00,891 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 07:58:02,453 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 07:58:02,453 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 07:58:02,555 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 07:58:02,582 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 07:58:02,589 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 07:58:02,590 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.494236:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.494236:   1%|          | 1/100 [00:02<03:58,  2.41s/it]Best trial: 1. Best value: 0.514041:   1%|          | 1/100 [00:04<03:58,  2.41s/it]Best trial: 1. Best value: 0.514041:   2%|▏         | 2/100 [00:04<04:04,  2.50s/it]Best trial: 1. Best value: 0.514041:   2%|▏         | 2/100 [00:09<04:04,  2.50s/it]Best trial: 1. Best value: 0.514041:   3%|▎         | 3/100 [00:09<05:16,  3.26s/it]Best trial: 1. Best value: 0.514041:   3%|▎         | 3/100 [00:11<05:16,  3.26s/it]Best trial: 1. Best value: 0.514041:   4%|▍         | 4/100 [00:11<04:32,  2.84s/it]Best trial: 1. Best value: 0.514041:   4%|▍         | 4/100 [00:13<04:32,  2.84s/it]Best trial: 1. Best value: 0.514041:   5%|▌         | 5/100 [00:13<04:06,  2.59s/it]Best trial: 1. Best value: 0.514041:   5%|▌         | 5/100 [00:15<04:06,  2.59s/it]Best trial: 1. Best value: 0.514041:   6%|▌         | 6/100 [00:15<03:49,  2.44s/it]Best trial: 1. Best value: 0.514041:   6%|▌         | 6/100 [00:17<03:49,  2.44s/it]Best trial: 1. Best value: 0.514041:   7%|▋         | 7/100 [00:17<03:35,  2.31s/it]Best trial: 1. Best value: 0.514041:   7%|▋         | 7/100 [00:19<03:35,  2.31s/it]Best trial: 1. Best value: 0.514041:   8%|▊         | 8/100 [00:19<03:15,  2.13s/it]Best trial: 1. Best value: 0.514041:   8%|▊         | 8/100 [00:22<03:15,  2.13s/it]Best trial: 1. Best value: 0.514041:   9%|▉         | 9/100 [00:22<03:38,  2.41s/it]Best trial: 1. Best value: 0.514041:   9%|▉         | 9/100 [00:25<03:38,  2.41s/it]Best trial: 1. Best value: 0.514041:  10%|█         | 10/100 [00:25<03:41,  2.46s/it]Best trial: 1. Best value: 0.514041:  10%|█         | 10/100 [00:28<03:41,  2.46s/it]Best trial: 1. Best value: 0.514041:  11%|█         | 11/100 [00:28<03:59,  2.69s/it]Best trial: 1. Best value: 0.514041:  11%|█         | 11/100 [00:29<03:59,  2.69s/it]Best trial: 1. Best value: 0.514041:  12%|█▏        | 12/100 [00:29<03:28,  2.37s/it]Best trial: 1. Best value: 0.514041:  12%|█▏        | 12/100 [00:31<03:28,  2.37s/it]Best trial: 1. Best value: 0.514041:  13%|█▎        | 13/100 [00:31<03:17,  2.27s/it]Best trial: 1. Best value: 0.514041:  13%|█▎        | 13/100 [00:33<03:17,  2.27s/it]Best trial: 1. Best value: 0.514041:  14%|█▍        | 14/100 [00:33<03:07,  2.18s/it]Best trial: 1. Best value: 0.514041:  14%|█▍        | 14/100 [00:36<03:07,  2.18s/it]Best trial: 1. Best value: 0.514041:  15%|█▌        | 15/100 [00:36<03:16,  2.31s/it]Best trial: 1. Best value: 0.514041:  15%|█▌        | 15/100 [00:38<03:16,  2.31s/it]Best trial: 1. Best value: 0.514041:  16%|█▌        | 16/100 [00:38<03:17,  2.35s/it]Best trial: 1. Best value: 0.514041:  16%|█▌        | 16/100 [00:40<03:17,  2.35s/it]Best trial: 1. Best value: 0.514041:  17%|█▋        | 17/100 [00:40<03:03,  2.21s/it]Best trial: 1. Best value: 0.514041:  17%|█▋        | 17/100 [00:43<03:03,  2.21s/it]Best trial: 1. Best value: 0.514041:  18%|█▊        | 18/100 [00:43<03:15,  2.38s/it]Best trial: 1. Best value: 0.514041:  18%|█▊        | 18/100 [00:45<03:15,  2.38s/it]Best trial: 1. Best value: 0.514041:  19%|█▉        | 19/100 [00:45<03:12,  2.38s/it]Best trial: 19. Best value: 0.533559:  19%|█▉        | 19/100 [00:47<03:12,  2.38s/it]Best trial: 19. Best value: 0.533559:  20%|██        | 20/100 [00:47<02:57,  2.22s/it]Best trial: 19. Best value: 0.533559:  20%|██        | 20/100 [00:50<02:57,  2.22s/it]Best trial: 19. Best value: 0.533559:  21%|██        | 21/100 [00:50<02:55,  2.23s/it]Best trial: 19. Best value: 0.533559:  21%|██        | 21/100 [00:52<02:55,  2.23s/it]Best trial: 19. Best value: 0.533559:  22%|██▏       | 22/100 [00:52<02:53,  2.23s/it]Best trial: 19. Best value: 0.533559:  22%|██▏       | 22/100 [00:54<02:53,  2.23s/it]Best trial: 19. Best value: 0.533559:  23%|██▎       | 23/100 [00:54<02:55,  2.29s/it]Best trial: 23. Best value: 0.540357:  23%|██▎       | 23/100 [00:57<02:55,  2.29s/it]Best trial: 23. Best value: 0.540357:  24%|██▍       | 24/100 [00:57<02:57,  2.33s/it]Best trial: 23. Best value: 0.540357:  24%|██▍       | 24/100 [00:59<02:57,  2.33s/it]Best trial: 23. Best value: 0.540357:  25%|██▌       | 25/100 [00:59<02:46,  2.22s/it]Best trial: 23. Best value: 0.540357:  25%|██▌       | 25/100 [01:01<02:46,  2.22s/it]Best trial: 23. Best value: 0.540357:  26%|██▌       | 26/100 [01:01<02:58,  2.41s/it]Best trial: 23. Best value: 0.540357:  26%|██▌       | 26/100 [01:04<02:58,  2.41s/it]Best trial: 23. Best value: 0.540357:  27%|██▋       | 27/100 [01:04<03:02,  2.50s/it]Best trial: 23. Best value: 0.540357:  27%|██▋       | 27/100 [01:06<03:02,  2.50s/it]Best trial: 23. Best value: 0.540357:  28%|██▊       | 28/100 [01:06<02:56,  2.44s/it]Best trial: 23. Best value: 0.540357:  28%|██▊       | 28/100 [01:10<02:56,  2.44s/it]Best trial: 23. Best value: 0.540357:  29%|██▉       | 29/100 [01:10<03:10,  2.69s/it]Best trial: 23. Best value: 0.540357:  29%|██▉       | 29/100 [01:12<03:10,  2.69s/it]Best trial: 23. Best value: 0.540357:  30%|███       | 30/100 [01:12<03:07,  2.68s/it]Best trial: 23. Best value: 0.540357:  30%|███       | 30/100 [01:16<03:07,  2.68s/it]Best trial: 23. Best value: 0.540357:  31%|███       | 31/100 [01:16<03:19,  2.90s/it]Best trial: 23. Best value: 0.540357:  31%|███       | 31/100 [01:18<03:19,  2.90s/it]Best trial: 23. Best value: 0.540357:  32%|███▏      | 32/100 [01:18<03:09,  2.78s/it]Best trial: 23. Best value: 0.540357:  32%|███▏      | 32/100 [01:21<03:09,  2.78s/it]Best trial: 23. Best value: 0.540357:  33%|███▎      | 33/100 [01:21<03:14,  2.90s/it]Best trial: 23. Best value: 0.540357:  33%|███▎      | 33/100 [01:25<03:14,  2.90s/it]Best trial: 23. Best value: 0.540357:  34%|███▍      | 34/100 [01:25<03:32,  3.21s/it]Best trial: 23. Best value: 0.540357:  34%|███▍      | 34/100 [01:28<03:32,  3.21s/it]Best trial: 23. Best value: 0.540357:  35%|███▌      | 35/100 [01:28<03:14,  2.99s/it]Best trial: 23. Best value: 0.540357:  35%|███▌      | 35/100 [01:32<03:14,  2.99s/it]Best trial: 23. Best value: 0.540357:  36%|███▌      | 36/100 [01:32<03:30,  3.30s/it]Best trial: 23. Best value: 0.540357:  36%|███▌      | 36/100 [01:34<03:30,  3.30s/it]Best trial: 23. Best value: 0.540357:  37%|███▋      | 37/100 [01:34<03:07,  2.98s/it]Best trial: 23. Best value: 0.540357:  37%|███▋      | 37/100 [01:37<03:07,  2.98s/it]Best trial: 23. Best value: 0.540357:  38%|███▊      | 38/100 [01:37<02:54,  2.81s/it]Best trial: 23. Best value: 0.540357:  38%|███▊      | 38/100 [01:40<02:54,  2.81s/it]Best trial: 23. Best value: 0.540357:  39%|███▉      | 39/100 [01:40<02:55,  2.88s/it]Best trial: 23. Best value: 0.540357:  39%|███▉      | 39/100 [01:41<02:55,  2.88s/it]Best trial: 23. Best value: 0.540357:  40%|████      | 40/100 [01:41<02:34,  2.57s/it]Best trial: 23. Best value: 0.540357:  40%|████      | 40/100 [01:45<02:34,  2.57s/it]Best trial: 23. Best value: 0.540357:  41%|████      | 41/100 [01:45<02:43,  2.77s/it]Best trial: 23. Best value: 0.540357:  41%|████      | 41/100 [01:48<02:43,  2.77s/it]Best trial: 23. Best value: 0.540357:  42%|████▏     | 42/100 [01:48<02:44,  2.84s/it]Best trial: 23. Best value: 0.540357:  42%|████▏     | 42/100 [01:51<02:44,  2.84s/it]Best trial: 23. Best value: 0.540357:  43%|████▎     | 43/100 [01:51<02:46,  2.92s/it]Best trial: 23. Best value: 0.540357:  43%|████▎     | 43/100 [01:54<02:46,  2.92s/it]Best trial: 23. Best value: 0.540357:  44%|████▍     | 44/100 [01:54<02:44,  2.94s/it]Best trial: 23. Best value: 0.540357:  44%|████▍     | 44/100 [01:56<02:44,  2.94s/it]Best trial: 23. Best value: 0.540357:  45%|████▌     | 45/100 [01:56<02:31,  2.76s/it]Best trial: 23. Best value: 0.540357:  45%|████▌     | 45/100 [01:59<02:31,  2.76s/it]Best trial: 23. Best value: 0.540357:  46%|████▌     | 46/100 [01:59<02:37,  2.91s/it]Best trial: 23. Best value: 0.540357:  46%|████▌     | 46/100 [02:02<02:37,  2.91s/it]Best trial: 23. Best value: 0.540357:  47%|████▋     | 47/100 [02:02<02:28,  2.80s/it]Best trial: 23. Best value: 0.540357:  47%|████▋     | 47/100 [02:06<02:28,  2.80s/it]Best trial: 23. Best value: 0.540357:  48%|████▊     | 48/100 [02:06<02:41,  3.10s/it]Best trial: 23. Best value: 0.540357:  48%|████▊     | 48/100 [02:08<02:41,  3.10s/it]Best trial: 23. Best value: 0.540357:  49%|████▉     | 49/100 [02:08<02:23,  2.81s/it]Best trial: 23. Best value: 0.540357:  49%|████▉     | 49/100 [02:11<02:23,  2.81s/it]Best trial: 23. Best value: 0.540357:  50%|█████     | 50/100 [02:11<02:31,  3.02s/it]Best trial: 23. Best value: 0.540357:  50%|█████     | 50/100 [02:16<02:31,  3.02s/it]Best trial: 23. Best value: 0.540357:  51%|█████     | 51/100 [02:16<02:57,  3.63s/it]Best trial: 23. Best value: 0.540357:  51%|█████     | 51/100 [02:20<02:57,  3.63s/it]Best trial: 23. Best value: 0.540357:  52%|█████▏    | 52/100 [02:20<02:57,  3.70s/it]Best trial: 23. Best value: 0.540357:  52%|█████▏    | 52/100 [02:24<02:57,  3.70s/it]Best trial: 23. Best value: 0.540357:  53%|█████▎    | 53/100 [02:24<02:53,  3.70s/it]Best trial: 23. Best value: 0.540357:  53%|█████▎    | 53/100 [02:28<02:53,  3.70s/it]Best trial: 23. Best value: 0.540357:  54%|█████▍    | 54/100 [02:28<02:57,  3.86s/it]Best trial: 23. Best value: 0.540357:  54%|█████▍    | 54/100 [02:32<02:57,  3.86s/it]Best trial: 23. Best value: 0.540357:  55%|█████▌    | 55/100 [02:32<02:54,  3.87s/it]Best trial: 23. Best value: 0.540357:  55%|█████▌    | 55/100 [02:36<02:54,  3.87s/it]Best trial: 23. Best value: 0.540357:  56%|█████▌    | 56/100 [02:36<02:46,  3.78s/it]Best trial: 23. Best value: 0.540357:  56%|█████▌    | 56/100 [02:39<02:46,  3.78s/it]Best trial: 23. Best value: 0.540357:  57%|█████▋    | 57/100 [02:39<02:32,  3.54s/it]Best trial: 23. Best value: 0.540357:  57%|█████▋    | 57/100 [02:42<02:32,  3.54s/it]Best trial: 23. Best value: 0.540357:  58%|█████▊    | 58/100 [02:42<02:21,  3.37s/it]Best trial: 23. Best value: 0.540357:  58%|█████▊    | 58/100 [02:46<02:21,  3.37s/it]Best trial: 23. Best value: 0.540357:  59%|█████▉    | 59/100 [02:46<02:26,  3.58s/it]Best trial: 23. Best value: 0.540357:  59%|█████▉    | 59/100 [02:49<02:26,  3.58s/it]Best trial: 23. Best value: 0.540357:  60%|██████    | 60/100 [02:49<02:19,  3.49s/it]Best trial: 23. Best value: 0.540357:  60%|██████    | 60/100 [02:54<02:19,  3.49s/it]Best trial: 23. Best value: 0.540357:  61%|██████    | 61/100 [02:54<02:37,  4.04s/it]Best trial: 23. Best value: 0.540357:  61%|██████    | 61/100 [02:59<02:37,  4.04s/it]Best trial: 23. Best value: 0.540357:  62%|██████▏   | 62/100 [02:59<02:40,  4.23s/it]Best trial: 23. Best value: 0.540357:  62%|██████▏   | 62/100 [03:03<02:40,  4.23s/it]Best trial: 23. Best value: 0.540357:  63%|██████▎   | 63/100 [03:03<02:36,  4.23s/it]Best trial: 23. Best value: 0.540357:  63%|██████▎   | 63/100 [03:06<02:36,  4.23s/it]Best trial: 23. Best value: 0.540357:  64%|██████▍   | 64/100 [03:06<02:16,  3.78s/it]Best trial: 23. Best value: 0.540357:  64%|██████▍   | 64/100 [03:10<02:16,  3.78s/it]Best trial: 23. Best value: 0.540357:  65%|██████▌   | 65/100 [03:10<02:14,  3.84s/it]Best trial: 23. Best value: 0.540357:  65%|██████▌   | 65/100 [03:15<02:14,  3.84s/it]Best trial: 23. Best value: 0.540357:  66%|██████▌   | 66/100 [03:15<02:23,  4.23s/it]Best trial: 23. Best value: 0.540357:  66%|██████▌   | 66/100 [03:19<02:23,  4.23s/it]Best trial: 23. Best value: 0.540357:  67%|██████▋   | 67/100 [03:19<02:17,  4.17s/it]Best trial: 23. Best value: 0.540357:  67%|██████▋   | 67/100 [03:24<02:17,  4.17s/it]Best trial: 23. Best value: 0.540357:  68%|██████▊   | 68/100 [03:24<02:20,  4.38s/it]Best trial: 23. Best value: 0.540357:  68%|██████▊   | 68/100 [03:28<02:20,  4.38s/it]Best trial: 23. Best value: 0.540357:  69%|██████▉   | 69/100 [03:28<02:09,  4.18s/it]Best trial: 23. Best value: 0.540357:  69%|██████▉   | 69/100 [03:33<02:09,  4.18s/it]Best trial: 23. Best value: 0.540357:  70%|███████   | 70/100 [03:33<02:11,  4.40s/it]Best trial: 23. Best value: 0.540357:  70%|███████   | 70/100 [03:37<02:11,  4.40s/it]Best trial: 23. Best value: 0.540357:  71%|███████   | 71/100 [03:37<02:09,  4.47s/it]Best trial: 23. Best value: 0.540357:  71%|███████   | 71/100 [03:40<02:09,  4.47s/it]Best trial: 23. Best value: 0.540357:  72%|███████▏  | 72/100 [03:40<01:52,  4.01s/it]Best trial: 23. Best value: 0.540357:  72%|███████▏  | 72/100 [03:43<01:52,  4.01s/it]Best trial: 23. Best value: 0.540357:  73%|███████▎  | 73/100 [03:43<01:36,  3.58s/it]Best trial: 23. Best value: 0.540357:  73%|███████▎  | 73/100 [03:46<01:36,  3.58s/it]Best trial: 23. Best value: 0.540357:  74%|███████▍  | 74/100 [03:46<01:32,  3.57s/it]Best trial: 23. Best value: 0.540357:  74%|███████▍  | 74/100 [03:49<01:32,  3.57s/it]Best trial: 23. Best value: 0.540357:  75%|███████▌  | 75/100 [03:49<01:25,  3.42s/it]Best trial: 23. Best value: 0.540357:  75%|███████▌  | 75/100 [03:52<01:25,  3.42s/it]Best trial: 23. Best value: 0.540357:  76%|███████▌  | 76/100 [03:52<01:15,  3.14s/it]Best trial: 23. Best value: 0.540357:  76%|███████▌  | 76/100 [03:55<01:15,  3.14s/it]Best trial: 23. Best value: 0.540357:  77%|███████▋  | 77/100 [03:55<01:13,  3.21s/it]Best trial: 23. Best value: 0.540357:  77%|███████▋  | 77/100 [03:57<01:13,  3.21s/it]Best trial: 23. Best value: 0.540357:  78%|███████▊  | 78/100 [03:57<01:03,  2.89s/it]Best trial: 23. Best value: 0.540357:  78%|███████▊  | 78/100 [04:00<01:03,  2.89s/it]Best trial: 23. Best value: 0.540357:  79%|███████▉  | 79/100 [04:00<00:56,  2.69s/it]Best trial: 23. Best value: 0.540357:  79%|███████▉  | 79/100 [04:03<00:56,  2.69s/it]Best trial: 23. Best value: 0.540357:  80%|████████  | 80/100 [04:03<00:57,  2.88s/it]Best trial: 23. Best value: 0.540357:  80%|████████  | 80/100 [04:06<00:57,  2.88s/it]Best trial: 23. Best value: 0.540357:  81%|████████  | 81/100 [04:06<00:55,  2.92s/it]Best trial: 23. Best value: 0.540357:  81%|████████  | 81/100 [04:08<00:55,  2.92s/it]Best trial: 23. Best value: 0.540357:  82%|████████▏ | 82/100 [04:08<00:48,  2.72s/it]Best trial: 23. Best value: 0.540357:  82%|████████▏ | 82/100 [04:10<00:48,  2.72s/it]Best trial: 23. Best value: 0.540357:  83%|████████▎ | 83/100 [04:10<00:41,  2.43s/it]Best trial: 23. Best value: 0.540357:  83%|████████▎ | 83/100 [04:12<00:41,  2.43s/it]Best trial: 23. Best value: 0.540357:  84%|████████▍ | 84/100 [04:12<00:38,  2.40s/it]Best trial: 23. Best value: 0.540357:  84%|████████▍ | 84/100 [04:14<00:38,  2.40s/it]Best trial: 23. Best value: 0.540357:  85%|████████▌ | 85/100 [04:14<00:33,  2.25s/it]Best trial: 23. Best value: 0.540357:  85%|████████▌ | 85/100 [04:17<00:33,  2.25s/it]Best trial: 23. Best value: 0.540357:  86%|████████▌ | 86/100 [04:17<00:32,  2.34s/it]Best trial: 23. Best value: 0.540357:  86%|████████▌ | 86/100 [04:19<00:32,  2.34s/it]Best trial: 23. Best value: 0.540357:  87%|████████▋ | 87/100 [04:19<00:31,  2.39s/it]Best trial: 23. Best value: 0.540357:  87%|████████▋ | 87/100 [04:22<00:31,  2.39s/it]Best trial: 23. Best value: 0.540357:  88%|████████▊ | 88/100 [04:22<00:29,  2.47s/it]Best trial: 23. Best value: 0.540357:  88%|████████▊ | 88/100 [04:25<00:29,  2.47s/it]Best trial: 23. Best value: 0.540357:  89%|████████▉ | 89/100 [04:25<00:29,  2.69s/it]Best trial: 23. Best value: 0.540357:  89%|████████▉ | 89/100 [04:27<00:29,  2.69s/it]Best trial: 23. Best value: 0.540357:  90%|█████████ | 90/100 [04:27<00:24,  2.45s/it]Best trial: 23. Best value: 0.540357:  90%|█████████ | 90/100 [04:29<00:24,  2.45s/it]Best trial: 23. Best value: 0.540357:  91%|█████████ | 91/100 [04:29<00:20,  2.25s/it]Best trial: 23. Best value: 0.540357:  91%|█████████ | 91/100 [04:31<00:20,  2.25s/it]Best trial: 23. Best value: 0.540357:  92%|█████████▏| 92/100 [04:31<00:18,  2.36s/it]Best trial: 23. Best value: 0.540357:  92%|█████████▏| 92/100 [04:34<00:18,  2.36s/it]Best trial: 23. Best value: 0.540357:  93%|█████████▎| 93/100 [04:34<00:16,  2.33s/it]Best trial: 23. Best value: 0.540357:  93%|█████████▎| 93/100 [04:36<00:16,  2.33s/it]Best trial: 23. Best value: 0.540357:  94%|█████████▍| 94/100 [04:36<00:14,  2.34s/it]Best trial: 23. Best value: 0.540357:  94%|█████████▍| 94/100 [04:38<00:14,  2.34s/it]Best trial: 23. Best value: 0.540357:  95%|█████████▌| 95/100 [04:38<00:11,  2.27s/it]Best trial: 23. Best value: 0.540357:  95%|█████████▌| 95/100 [04:40<00:11,  2.27s/it]Best trial: 23. Best value: 0.540357:  96%|█████████▌| 96/100 [04:40<00:09,  2.26s/it]Best trial: 23. Best value: 0.540357:  96%|█████████▌| 96/100 [04:43<00:09,  2.26s/it]Best trial: 23. Best value: 0.540357:  97%|█████████▋| 97/100 [04:43<00:06,  2.24s/it]Best trial: 23. Best value: 0.540357:  97%|█████████▋| 97/100 [04:45<00:06,  2.24s/it]Best trial: 23. Best value: 0.540357:  98%|█████████▊| 98/100 [04:45<00:04,  2.19s/it]Best trial: 23. Best value: 0.540357:  98%|█████████▊| 98/100 [04:47<00:04,  2.19s/it]Best trial: 23. Best value: 0.540357:  99%|█████████▉| 99/100 [04:47<00:02,  2.20s/it]Best trial: 23. Best value: 0.540357:  99%|█████████▉| 99/100 [04:49<00:02,  2.20s/it]Best trial: 23. Best value: 0.540357: 100%|██████████| 100/100 [04:49<00:00,  2.17s/it]Best trial: 23. Best value: 0.540357: 100%|██████████| 100/100 [04:49<00:00,  2.89s/it]
2025-11-30 08:02:52,044 - INFO - HPO Complete. Best AUPRC: 0.5404
2025-11-30 08:02:52,044 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.03716964986872647, 'max_depth': 3, 'subsample': 0.6758409220806133, 'colsample_bytree': 0.6953950545456743, 'gamma': 4.095332817644275, 'reg_lambda': 0.09329138202770085, 'reg_alpha': 3.833799892308911e-06}
2025-11-30 08:02:52,046 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:02:54,289 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 08:02:54,289 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:02:54,373 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:02:54,396 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:02:54,401 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 08:02:54,402 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:02:54,402 - INFO - Training model...
2025-11-30 08:02:55,848 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:03:01,133 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:03:01,133 - INFO - AUROC: 0.8022 (0.7096 - 0.8690)
2025-11-30 08:03:01,133 - INFO - AUPRC: 0.3723 (0.1804 - 0.5210)
2025-11-30 08:03:01,133 - INFO - Brier Score: 0.0490 (0.0379 - 0.0616)
2025-11-30 08:03:01,133 - INFO - Accuracy: 0.9422 (0.8795 - 0.9685)
2025-11-30 08:03:01,133 - INFO - Precision: 0.4375 (0.2357 - 0.9538)
2025-11-30 08:03:01,133 - INFO - Sensitivity (Recall): 0.3889 (0.2067 - 0.5905)
2025-11-30 08:03:01,133 - INFO - F1-Score: 0.4118 (0.2865 - 0.5633)
2025-11-30 08:03:01,133 - INFO - Best Threshold: 0.4800 (0.2000 - 0.7900)
2025-11-30 08:03:01,133 - INFO - Specificity: 0.9726 (0.8983 - 0.9991)
2025-11-30 08:03:01,146 - INFO - Calculating SHAP values...
2025-11-30 08:03:02,118 - INFO - SHAP plots saved.
2025-11-30 08:03:02,119 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:03:03,420 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 08:03:03,420 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:03:03,504 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:03:03,527 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:03:03,534 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 08:03:03,534 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.483955:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.483955:   1%|          | 1/100 [00:02<04:45,  2.88s/it]Best trial: 0. Best value: 0.483955:   1%|          | 1/100 [00:06<04:45,  2.88s/it]Best trial: 0. Best value: 0.483955:   2%|▏         | 2/100 [00:06<05:27,  3.34s/it]Best trial: 2. Best value: 0.490127:   2%|▏         | 2/100 [00:09<05:27,  3.34s/it]Best trial: 2. Best value: 0.490127:   3%|▎         | 3/100 [00:09<05:15,  3.25s/it]Best trial: 3. Best value: 0.524259:   3%|▎         | 3/100 [00:12<05:15,  3.25s/it]Best trial: 3. Best value: 0.524259:   4%|▍         | 4/100 [00:12<05:08,  3.21s/it]Best trial: 3. Best value: 0.524259:   4%|▍         | 4/100 [00:14<05:08,  3.21s/it]Best trial: 3. Best value: 0.524259:   5%|▌         | 5/100 [00:14<04:28,  2.83s/it]Best trial: 3. Best value: 0.524259:   5%|▌         | 5/100 [00:17<04:28,  2.83s/it]Best trial: 3. Best value: 0.524259:   6%|▌         | 6/100 [00:17<04:29,  2.87s/it]Best trial: 3. Best value: 0.524259:   6%|▌         | 6/100 [00:20<04:29,  2.87s/it]Best trial: 3. Best value: 0.524259:   7%|▋         | 7/100 [00:20<04:19,  2.79s/it]Best trial: 3. Best value: 0.524259:   7%|▋         | 7/100 [00:24<04:19,  2.79s/it]Best trial: 3. Best value: 0.524259:   8%|▊         | 8/100 [00:24<04:43,  3.09s/it]Best trial: 3. Best value: 0.524259:   8%|▊         | 8/100 [00:27<04:43,  3.09s/it]Best trial: 3. Best value: 0.524259:   9%|▉         | 9/100 [00:27<04:40,  3.08s/it]Best trial: 3. Best value: 0.524259:   9%|▉         | 9/100 [00:29<04:40,  3.08s/it]Best trial: 3. Best value: 0.524259:  10%|█         | 10/100 [00:29<04:19,  2.88s/it]Best trial: 3. Best value: 0.524259:  10%|█         | 10/100 [00:31<04:19,  2.88s/it]Best trial: 3. Best value: 0.524259:  11%|█         | 11/100 [00:31<03:41,  2.49s/it]Best trial: 11. Best value: 0.524879:  11%|█         | 11/100 [00:33<03:41,  2.49s/it]Best trial: 11. Best value: 0.524879:  12%|█▏        | 12/100 [00:33<03:16,  2.24s/it]Best trial: 11. Best value: 0.524879:  12%|█▏        | 12/100 [00:34<03:16,  2.24s/it]Best trial: 11. Best value: 0.524879:  13%|█▎        | 13/100 [00:34<02:56,  2.03s/it]Best trial: 11. Best value: 0.524879:  13%|█▎        | 13/100 [00:39<02:56,  2.03s/it]Best trial: 11. Best value: 0.524879:  14%|█▍        | 14/100 [00:39<04:04,  2.84s/it]Best trial: 14. Best value: 0.528493:  14%|█▍        | 14/100 [00:41<04:04,  2.84s/it]Best trial: 14. Best value: 0.528493:  15%|█▌        | 15/100 [00:41<03:54,  2.76s/it]Best trial: 14. Best value: 0.528493:  15%|█▌        | 15/100 [00:44<03:54,  2.76s/it]Best trial: 14. Best value: 0.528493:  16%|█▌        | 16/100 [00:44<03:37,  2.60s/it]Best trial: 16. Best value: 0.5289:  16%|█▌        | 16/100 [00:46<03:37,  2.60s/it]  Best trial: 16. Best value: 0.5289:  17%|█▋        | 17/100 [00:46<03:23,  2.45s/it]Best trial: 17. Best value: 0.531575:  17%|█▋        | 17/100 [00:48<03:23,  2.45s/it]Best trial: 17. Best value: 0.531575:  18%|█▊        | 18/100 [00:48<03:17,  2.40s/it]Best trial: 18. Best value: 0.53786:  18%|█▊        | 18/100 [00:50<03:17,  2.40s/it] Best trial: 18. Best value: 0.53786:  19%|█▉        | 19/100 [00:50<03:08,  2.33s/it]Best trial: 18. Best value: 0.53786:  19%|█▉        | 19/100 [00:52<03:08,  2.33s/it]Best trial: 18. Best value: 0.53786:  20%|██        | 20/100 [00:52<02:59,  2.24s/it]Best trial: 18. Best value: 0.53786:  20%|██        | 20/100 [00:56<02:59,  2.24s/it]Best trial: 18. Best value: 0.53786:  21%|██        | 21/100 [00:56<03:25,  2.61s/it]Best trial: 18. Best value: 0.53786:  21%|██        | 21/100 [00:58<03:25,  2.61s/it]Best trial: 18. Best value: 0.53786:  22%|██▏       | 22/100 [00:58<03:16,  2.52s/it]Best trial: 18. Best value: 0.53786:  22%|██▏       | 22/100 [01:00<03:16,  2.52s/it]Best trial: 18. Best value: 0.53786:  23%|██▎       | 23/100 [01:00<03:12,  2.50s/it]Best trial: 18. Best value: 0.53786:  23%|██▎       | 23/100 [01:03<03:12,  2.50s/it]Best trial: 18. Best value: 0.53786:  24%|██▍       | 24/100 [01:03<03:01,  2.39s/it]Best trial: 18. Best value: 0.53786:  24%|██▍       | 24/100 [01:06<03:01,  2.39s/it]Best trial: 18. Best value: 0.53786:  25%|██▌       | 25/100 [01:06<03:19,  2.67s/it]Best trial: 18. Best value: 0.53786:  25%|██▌       | 25/100 [01:07<03:19,  2.67s/it]Best trial: 18. Best value: 0.53786:  26%|██▌       | 26/100 [01:07<02:53,  2.34s/it]Best trial: 18. Best value: 0.53786:  26%|██▌       | 26/100 [01:11<02:53,  2.34s/it]Best trial: 18. Best value: 0.53786:  27%|██▋       | 27/100 [01:11<03:11,  2.62s/it]Best trial: 18. Best value: 0.53786:  27%|██▋       | 27/100 [01:13<03:11,  2.62s/it]Best trial: 18. Best value: 0.53786:  28%|██▊       | 28/100 [01:13<03:04,  2.56s/it]Best trial: 18. Best value: 0.53786:  28%|██▊       | 28/100 [01:16<03:04,  2.56s/it]Best trial: 18. Best value: 0.53786:  29%|██▉       | 29/100 [01:16<03:06,  2.62s/it]Best trial: 18. Best value: 0.53786:  29%|██▉       | 29/100 [01:18<03:06,  2.62s/it]Best trial: 18. Best value: 0.53786:  30%|███       | 30/100 [01:18<03:00,  2.58s/it]Best trial: 18. Best value: 0.53786:  30%|███       | 30/100 [01:20<03:00,  2.58s/it]Best trial: 18. Best value: 0.53786:  31%|███       | 31/100 [01:20<02:35,  2.25s/it]Best trial: 18. Best value: 0.53786:  31%|███       | 31/100 [01:22<02:35,  2.25s/it]Best trial: 18. Best value: 0.53786:  32%|███▏      | 32/100 [01:22<02:37,  2.32s/it]Best trial: 18. Best value: 0.53786:  32%|███▏      | 32/100 [01:24<02:37,  2.32s/it]Best trial: 18. Best value: 0.53786:  33%|███▎      | 33/100 [01:24<02:30,  2.24s/it]Best trial: 18. Best value: 0.53786:  33%|███▎      | 33/100 [01:29<02:30,  2.24s/it]Best trial: 18. Best value: 0.53786:  34%|███▍      | 34/100 [01:29<03:10,  2.89s/it]Best trial: 18. Best value: 0.53786:  34%|███▍      | 34/100 [01:31<03:10,  2.89s/it]Best trial: 18. Best value: 0.53786:  35%|███▌      | 35/100 [01:31<02:56,  2.72s/it]Best trial: 18. Best value: 0.53786:  35%|███▌      | 35/100 [01:33<02:56,  2.72s/it]Best trial: 18. Best value: 0.53786:  36%|███▌      | 36/100 [01:33<02:36,  2.44s/it]Best trial: 18. Best value: 0.53786:  36%|███▌      | 36/100 [01:36<02:36,  2.44s/it]Best trial: 18. Best value: 0.53786:  37%|███▋      | 37/100 [01:36<02:40,  2.54s/it]Best trial: 18. Best value: 0.53786:  37%|███▋      | 37/100 [01:39<02:40,  2.54s/it]Best trial: 18. Best value: 0.53786:  38%|███▊      | 38/100 [01:39<02:50,  2.76s/it]Best trial: 18. Best value: 0.53786:  38%|███▊      | 38/100 [01:42<02:50,  2.76s/it]Best trial: 18. Best value: 0.53786:  39%|███▉      | 39/100 [01:42<02:52,  2.83s/it]Best trial: 18. Best value: 0.53786:  39%|███▉      | 39/100 [01:45<02:52,  2.83s/it]Best trial: 18. Best value: 0.53786:  40%|████      | 40/100 [01:45<02:45,  2.75s/it]Best trial: 18. Best value: 0.53786:  40%|████      | 40/100 [01:50<02:45,  2.75s/it]Best trial: 18. Best value: 0.53786:  41%|████      | 41/100 [01:50<03:21,  3.42s/it]Best trial: 18. Best value: 0.53786:  41%|████      | 41/100 [01:52<03:21,  3.42s/it]Best trial: 18. Best value: 0.53786:  42%|████▏     | 42/100 [01:52<03:02,  3.14s/it]Best trial: 18. Best value: 0.53786:  42%|████▏     | 42/100 [01:54<03:02,  3.14s/it]Best trial: 18. Best value: 0.53786:  43%|████▎     | 43/100 [01:54<02:40,  2.82s/it]Best trial: 18. Best value: 0.53786:  43%|████▎     | 43/100 [01:57<02:40,  2.82s/it]Best trial: 18. Best value: 0.53786:  44%|████▍     | 44/100 [01:57<02:32,  2.72s/it]Best trial: 18. Best value: 0.53786:  44%|████▍     | 44/100 [02:01<02:32,  2.72s/it]Best trial: 18. Best value: 0.53786:  45%|████▌     | 45/100 [02:01<02:59,  3.26s/it]Best trial: 18. Best value: 0.53786:  45%|████▌     | 45/100 [02:03<02:59,  3.26s/it]Best trial: 18. Best value: 0.53786:  46%|████▌     | 46/100 [02:03<02:36,  2.89s/it]Best trial: 18. Best value: 0.53786:  46%|████▌     | 46/100 [02:06<02:36,  2.89s/it]Best trial: 18. Best value: 0.53786:  47%|████▋     | 47/100 [02:06<02:36,  2.96s/it]Best trial: 18. Best value: 0.53786:  47%|████▋     | 47/100 [02:08<02:36,  2.96s/it]Best trial: 18. Best value: 0.53786:  48%|████▊     | 48/100 [02:08<02:22,  2.74s/it]Best trial: 18. Best value: 0.53786:  48%|████▊     | 48/100 [02:11<02:22,  2.74s/it]Best trial: 18. Best value: 0.53786:  49%|████▉     | 49/100 [02:11<02:11,  2.58s/it]Best trial: 18. Best value: 0.53786:  49%|████▉     | 49/100 [02:13<02:11,  2.58s/it]Best trial: 18. Best value: 0.53786:  50%|█████     | 50/100 [02:13<02:03,  2.47s/it]Best trial: 18. Best value: 0.53786:  50%|█████     | 50/100 [02:17<02:03,  2.47s/it]Best trial: 18. Best value: 0.53786:  51%|█████     | 51/100 [02:17<02:18,  2.83s/it]Best trial: 18. Best value: 0.53786:  51%|█████     | 51/100 [02:19<02:18,  2.83s/it]Best trial: 18. Best value: 0.53786:  52%|█████▏    | 52/100 [02:19<02:04,  2.59s/it]Best trial: 18. Best value: 0.53786:  52%|█████▏    | 52/100 [02:20<02:04,  2.59s/it]Best trial: 18. Best value: 0.53786:  53%|█████▎    | 53/100 [02:20<01:50,  2.35s/it]Best trial: 18. Best value: 0.53786:  53%|█████▎    | 53/100 [02:23<01:50,  2.35s/it]Best trial: 18. Best value: 0.53786:  54%|█████▍    | 54/100 [02:23<01:48,  2.37s/it]Best trial: 18. Best value: 0.53786:  54%|█████▍    | 54/100 [02:25<01:48,  2.37s/it]Best trial: 18. Best value: 0.53786:  55%|█████▌    | 55/100 [02:25<01:45,  2.35s/it]Best trial: 18. Best value: 0.53786:  55%|█████▌    | 55/100 [02:27<01:45,  2.35s/it]Best trial: 18. Best value: 0.53786:  56%|█████▌    | 56/100 [02:27<01:36,  2.19s/it]Best trial: 18. Best value: 0.53786:  56%|█████▌    | 56/100 [02:29<01:36,  2.19s/it]Best trial: 18. Best value: 0.53786:  57%|█████▋    | 57/100 [02:29<01:29,  2.08s/it]Best trial: 18. Best value: 0.53786:  57%|█████▋    | 57/100 [02:31<01:29,  2.08s/it]Best trial: 18. Best value: 0.53786:  58%|█████▊    | 58/100 [02:31<01:24,  2.01s/it]Best trial: 18. Best value: 0.53786:  58%|█████▊    | 58/100 [02:35<01:24,  2.01s/it]Best trial: 18. Best value: 0.53786:  59%|█████▉    | 59/100 [02:35<01:56,  2.84s/it]Best trial: 18. Best value: 0.53786:  59%|█████▉    | 59/100 [02:37<01:56,  2.84s/it]Best trial: 18. Best value: 0.53786:  60%|██████    | 60/100 [02:37<01:44,  2.62s/it]Best trial: 18. Best value: 0.53786:  60%|██████    | 60/100 [02:40<01:44,  2.62s/it]Best trial: 18. Best value: 0.53786:  61%|██████    | 61/100 [02:40<01:46,  2.72s/it]Best trial: 18. Best value: 0.53786:  61%|██████    | 61/100 [02:43<01:46,  2.72s/it]Best trial: 18. Best value: 0.53786:  62%|██████▏   | 62/100 [02:43<01:43,  2.73s/it]Best trial: 18. Best value: 0.53786:  62%|██████▏   | 62/100 [02:45<01:43,  2.73s/it]Best trial: 18. Best value: 0.53786:  63%|██████▎   | 63/100 [02:45<01:36,  2.61s/it]Best trial: 18. Best value: 0.53786:  63%|██████▎   | 63/100 [02:48<01:36,  2.61s/it]Best trial: 18. Best value: 0.53786:  64%|██████▍   | 64/100 [02:48<01:32,  2.58s/it]Best trial: 18. Best value: 0.53786:  64%|██████▍   | 64/100 [02:50<01:32,  2.58s/it]Best trial: 18. Best value: 0.53786:  65%|██████▌   | 65/100 [02:50<01:24,  2.40s/it]Best trial: 18. Best value: 0.53786:  65%|██████▌   | 65/100 [02:52<01:24,  2.40s/it]Best trial: 18. Best value: 0.53786:  66%|██████▌   | 66/100 [02:52<01:21,  2.41s/it]Best trial: 18. Best value: 0.53786:  66%|██████▌   | 66/100 [02:57<01:21,  2.41s/it]Best trial: 18. Best value: 0.53786:  67%|██████▋   | 67/100 [02:57<01:36,  2.94s/it]Best trial: 18. Best value: 0.53786:  67%|██████▋   | 67/100 [03:00<01:36,  2.94s/it]Best trial: 18. Best value: 0.53786:  68%|██████▊   | 68/100 [03:00<01:37,  3.04s/it]Best trial: 18. Best value: 0.53786:  68%|██████▊   | 68/100 [03:04<01:37,  3.04s/it]Best trial: 18. Best value: 0.53786:  69%|██████▉   | 69/100 [03:04<01:48,  3.49s/it]Best trial: 18. Best value: 0.53786:  69%|██████▉   | 69/100 [03:07<01:48,  3.49s/it]Best trial: 18. Best value: 0.53786:  70%|███████   | 70/100 [03:07<01:38,  3.28s/it]Best trial: 18. Best value: 0.53786:  70%|███████   | 70/100 [03:11<01:38,  3.28s/it]Best trial: 18. Best value: 0.53786:  71%|███████   | 71/100 [03:11<01:40,  3.48s/it]Best trial: 18. Best value: 0.53786:  71%|███████   | 71/100 [03:15<01:40,  3.48s/it]Best trial: 18. Best value: 0.53786:  72%|███████▏  | 72/100 [03:15<01:40,  3.59s/it]Best trial: 18. Best value: 0.53786:  72%|███████▏  | 72/100 [03:20<01:40,  3.59s/it]Best trial: 18. Best value: 0.53786:  73%|███████▎  | 73/100 [03:20<01:45,  3.91s/it]Best trial: 18. Best value: 0.53786:  73%|███████▎  | 73/100 [03:22<01:45,  3.91s/it]Best trial: 18. Best value: 0.53786:  74%|███████▍  | 74/100 [03:22<01:33,  3.58s/it]Best trial: 18. Best value: 0.53786:  74%|███████▍  | 74/100 [03:25<01:33,  3.58s/it]Best trial: 18. Best value: 0.53786:  75%|███████▌  | 75/100 [03:25<01:24,  3.37s/it]Best trial: 18. Best value: 0.53786:  75%|███████▌  | 75/100 [03:28<01:24,  3.37s/it]Best trial: 18. Best value: 0.53786:  76%|███████▌  | 76/100 [03:28<01:14,  3.12s/it]Best trial: 18. Best value: 0.53786:  76%|███████▌  | 76/100 [03:32<01:14,  3.12s/it]Best trial: 18. Best value: 0.53786:  77%|███████▋  | 77/100 [03:32<01:18,  3.42s/it]Best trial: 18. Best value: 0.53786:  77%|███████▋  | 77/100 [03:35<01:18,  3.42s/it]Best trial: 18. Best value: 0.53786:  78%|███████▊  | 78/100 [03:35<01:15,  3.45s/it]Best trial: 18. Best value: 0.53786:  78%|███████▊  | 78/100 [03:40<01:15,  3.45s/it]Best trial: 18. Best value: 0.53786:  79%|███████▉  | 79/100 [03:40<01:17,  3.69s/it]Best trial: 18. Best value: 0.53786:  79%|███████▉  | 79/100 [03:42<01:17,  3.69s/it]Best trial: 18. Best value: 0.53786:  80%|████████  | 80/100 [03:42<01:06,  3.31s/it]Best trial: 18. Best value: 0.53786:  80%|████████  | 80/100 [03:46<01:06,  3.31s/it]Best trial: 18. Best value: 0.53786:  81%|████████  | 81/100 [03:46<01:03,  3.32s/it]Best trial: 18. Best value: 0.53786:  81%|████████  | 81/100 [03:48<01:03,  3.32s/it]Best trial: 18. Best value: 0.53786:  82%|████████▏ | 82/100 [03:48<00:57,  3.17s/it]Best trial: 18. Best value: 0.53786:  82%|████████▏ | 82/100 [03:52<00:57,  3.17s/it]Best trial: 18. Best value: 0.53786:  83%|████████▎ | 83/100 [03:52<00:57,  3.38s/it]Best trial: 18. Best value: 0.53786:  83%|████████▎ | 83/100 [03:56<00:57,  3.38s/it]Best trial: 18. Best value: 0.53786:  84%|████████▍ | 84/100 [03:56<00:57,  3.62s/it]Best trial: 18. Best value: 0.53786:  84%|████████▍ | 84/100 [04:00<00:57,  3.62s/it]Best trial: 18. Best value: 0.53786:  85%|████████▌ | 85/100 [04:00<00:52,  3.52s/it]Best trial: 18. Best value: 0.53786:  85%|████████▌ | 85/100 [04:03<00:52,  3.52s/it]Best trial: 18. Best value: 0.53786:  86%|████████▌ | 86/100 [04:03<00:49,  3.53s/it]Best trial: 18. Best value: 0.53786:  86%|████████▌ | 86/100 [04:06<00:49,  3.53s/it]Best trial: 18. Best value: 0.53786:  87%|████████▋ | 87/100 [04:06<00:41,  3.21s/it]Best trial: 18. Best value: 0.53786:  87%|████████▋ | 87/100 [04:11<00:41,  3.21s/it]Best trial: 18. Best value: 0.53786:  88%|████████▊ | 88/100 [04:11<00:46,  3.83s/it]Best trial: 18. Best value: 0.53786:  88%|████████▊ | 88/100 [04:14<00:46,  3.83s/it]Best trial: 18. Best value: 0.53786:  89%|████████▉ | 89/100 [04:14<00:40,  3.68s/it]Best trial: 18. Best value: 0.53786:  89%|████████▉ | 89/100 [04:17<00:40,  3.68s/it]Best trial: 18. Best value: 0.53786:  90%|█████████ | 90/100 [04:17<00:34,  3.40s/it]Best trial: 18. Best value: 0.53786:  90%|█████████ | 90/100 [04:20<00:34,  3.40s/it]Best trial: 18. Best value: 0.53786:  91%|█████████ | 91/100 [04:20<00:30,  3.36s/it]Best trial: 18. Best value: 0.53786:  91%|█████████ | 91/100 [04:23<00:30,  3.36s/it]Best trial: 18. Best value: 0.53786:  92%|█████████▏| 92/100 [04:23<00:25,  3.17s/it]Best trial: 18. Best value: 0.53786:  92%|█████████▏| 92/100 [04:26<00:25,  3.17s/it]Best trial: 18. Best value: 0.53786:  93%|█████████▎| 93/100 [04:26<00:20,  2.98s/it]Best trial: 18. Best value: 0.53786:  93%|█████████▎| 93/100 [04:29<00:20,  2.98s/it]Best trial: 18. Best value: 0.53786:  94%|█████████▍| 94/100 [04:29<00:18,  3.03s/it]Best trial: 18. Best value: 0.53786:  94%|█████████▍| 94/100 [04:31<00:18,  3.03s/it]Best trial: 18. Best value: 0.53786:  95%|█████████▌| 95/100 [04:31<00:14,  2.95s/it]Best trial: 18. Best value: 0.53786:  95%|█████████▌| 95/100 [04:34<00:14,  2.95s/it]Best trial: 18. Best value: 0.53786:  96%|█████████▌| 96/100 [04:34<00:11,  2.91s/it]Best trial: 18. Best value: 0.53786:  96%|█████████▌| 96/100 [04:37<00:11,  2.91s/it]Best trial: 18. Best value: 0.53786:  97%|█████████▋| 97/100 [04:37<00:08,  2.97s/it]Best trial: 18. Best value: 0.53786:  97%|█████████▋| 97/100 [04:40<00:08,  2.97s/it]Best trial: 18. Best value: 0.53786:  98%|█████████▊| 98/100 [04:40<00:05,  2.79s/it]Best trial: 18. Best value: 0.53786:  98%|█████████▊| 98/100 [04:42<00:05,  2.79s/it]Best trial: 18. Best value: 0.53786:  99%|█████████▉| 99/100 [04:42<00:02,  2.65s/it]Best trial: 18. Best value: 0.53786:  99%|█████████▉| 99/100 [04:45<00:02,  2.65s/it]Best trial: 18. Best value: 0.53786: 100%|██████████| 100/100 [04:45<00:00,  2.69s/it]Best trial: 18. Best value: 0.53786: 100%|██████████| 100/100 [04:45<00:00,  2.85s/it]
2025-11-30 08:07:48,910 - INFO - HPO Complete. Best AUPRC: 0.5379
2025-11-30 08:07:48,911 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.008733707589123766, 'max_depth': 4, 'subsample': 0.6004609829913518, 'colsample_bytree': 0.7582886852717102, 'gamma': 0.8681613820014404, 'reg_lambda': 0.0427251538035335, 'reg_alpha': 0.03721572383399781}
2025-11-30 08:07:48,911 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:07:50,714 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 08:07:50,715 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:07:50,797 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:07:50,820 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:07:50,825 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 08:07:50,825 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:07:50,825 - INFO - Training model...
2025-11-30 08:07:53,287 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:07:58,552 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:07:58,552 - INFO - AUROC: 0.7914 (0.6852 - 0.8664)
2025-11-30 08:07:58,552 - INFO - AUPRC: 0.3490 (0.2083 - 0.5496)
2025-11-30 08:07:58,552 - INFO - Brier Score: 0.0529 (0.0438 - 0.0650)
2025-11-30 08:07:58,552 - INFO - Accuracy: 0.9595 (0.8702 - 0.9723)
2025-11-30 08:07:58,553 - INFO - Precision: 0.7857 (0.2161 - 0.9667)
2025-11-30 08:07:58,553 - INFO - Sensitivity (Recall): 0.3056 (0.2343 - 0.6044)
2025-11-30 08:07:58,553 - INFO - F1-Score: 0.4400 (0.3116 - 0.6078)
2025-11-30 08:07:58,553 - INFO - Best Threshold: 0.7200 (0.2620 - 0.7200)
2025-11-30 08:07:58,553 - INFO - Specificity: 0.9954 (0.8891 - 0.9991)
2025-11-30 08:07:58,572 - INFO - Calculating SHAP values...
2025-11-30 08:07:59,609 - INFO - SHAP plots saved.
2025-11-30 08:07:59,611 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:08:00,931 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 08:08:00,931 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:08:01,037 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:08:01,064 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:08:01,071 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 08:08:01,071 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.511246:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.511246:   1%|          | 1/100 [00:03<06:28,  3.93s/it]Best trial: 0. Best value: 0.511246:   1%|          | 1/100 [00:09<06:28,  3.93s/it]Best trial: 0. Best value: 0.511246:   2%|▏         | 2/100 [00:09<07:36,  4.66s/it]Best trial: 0. Best value: 0.511246:   2%|▏         | 2/100 [00:11<07:36,  4.66s/it]Best trial: 0. Best value: 0.511246:   3%|▎         | 3/100 [00:11<06:00,  3.72s/it]Best trial: 0. Best value: 0.511246:   3%|▎         | 3/100 [00:14<06:00,  3.72s/it]Best trial: 0. Best value: 0.511246:   4%|▍         | 4/100 [00:14<05:13,  3.26s/it]Best trial: 0. Best value: 0.511246:   4%|▍         | 4/100 [00:19<05:13,  3.26s/it]Best trial: 0. Best value: 0.511246:   5%|▌         | 5/100 [00:19<06:12,  3.92s/it]Best trial: 0. Best value: 0.511246:   5%|▌         | 5/100 [00:22<06:12,  3.92s/it]Best trial: 0. Best value: 0.511246:   6%|▌         | 6/100 [00:22<05:40,  3.62s/it]Best trial: 0. Best value: 0.511246:   6%|▌         | 6/100 [00:28<05:40,  3.62s/it]Best trial: 0. Best value: 0.511246:   7%|▋         | 7/100 [00:28<06:55,  4.46s/it]Best trial: 0. Best value: 0.511246:   7%|▋         | 7/100 [00:32<06:55,  4.46s/it]Best trial: 0. Best value: 0.511246:   8%|▊         | 8/100 [00:32<06:21,  4.15s/it]Best trial: 0. Best value: 0.511246:   8%|▊         | 8/100 [00:34<06:21,  4.15s/it]Best trial: 0. Best value: 0.511246:   9%|▉         | 9/100 [00:34<05:22,  3.55s/it]Best trial: 0. Best value: 0.511246:   9%|▉         | 9/100 [00:37<05:22,  3.55s/it]Best trial: 0. Best value: 0.511246:  10%|█         | 10/100 [00:37<04:56,  3.29s/it]Best trial: 0. Best value: 0.511246:  10%|█         | 10/100 [00:45<04:56,  3.29s/it]Best trial: 0. Best value: 0.511246:  11%|█         | 11/100 [00:45<07:26,  5.02s/it]Best trial: 11. Best value: 0.526376:  11%|█         | 11/100 [00:48<07:26,  5.02s/it]Best trial: 11. Best value: 0.526376:  12%|█▏        | 12/100 [00:48<06:28,  4.41s/it]Best trial: 11. Best value: 0.526376:  12%|█▏        | 12/100 [00:51<06:28,  4.41s/it]Best trial: 11. Best value: 0.526376:  13%|█▎        | 13/100 [00:51<05:44,  3.97s/it]Best trial: 11. Best value: 0.526376:  13%|█▎        | 13/100 [00:55<05:44,  3.97s/it]Best trial: 11. Best value: 0.526376:  14%|█▍        | 14/100 [00:55<05:31,  3.85s/it]Best trial: 11. Best value: 0.526376:  14%|█▍        | 14/100 [01:00<05:31,  3.85s/it]Best trial: 11. Best value: 0.526376:  15%|█▌        | 15/100 [01:00<05:47,  4.08s/it]Best trial: 11. Best value: 0.526376:  15%|█▌        | 15/100 [01:02<05:47,  4.08s/it]Best trial: 11. Best value: 0.526376:  16%|█▌        | 16/100 [01:02<05:01,  3.60s/it]Best trial: 11. Best value: 0.526376:  16%|█▌        | 16/100 [01:11<05:01,  3.60s/it]Best trial: 11. Best value: 0.526376:  17%|█▋        | 17/100 [01:11<07:03,  5.10s/it]Best trial: 11. Best value: 0.526376:  17%|█▋        | 17/100 [01:14<07:03,  5.10s/it]Best trial: 11. Best value: 0.526376:  18%|█▊        | 18/100 [01:14<06:02,  4.42s/it]Best trial: 11. Best value: 0.526376:  18%|█▊        | 18/100 [01:17<06:02,  4.42s/it]Best trial: 11. Best value: 0.526376:  19%|█▉        | 19/100 [01:17<05:44,  4.25s/it]Best trial: 11. Best value: 0.526376:  19%|█▉        | 19/100 [01:19<05:44,  4.25s/it]Best trial: 11. Best value: 0.526376:  20%|██        | 20/100 [01:19<04:47,  3.59s/it]Best trial: 11. Best value: 0.526376:  20%|██        | 20/100 [01:24<04:47,  3.59s/it]Best trial: 11. Best value: 0.526376:  21%|██        | 21/100 [01:24<05:01,  3.82s/it]Best trial: 11. Best value: 0.526376:  21%|██        | 21/100 [01:28<05:01,  3.82s/it]Best trial: 11. Best value: 0.526376:  22%|██▏       | 22/100 [01:28<05:07,  3.95s/it]Best trial: 11. Best value: 0.526376:  22%|██▏       | 22/100 [01:31<05:07,  3.95s/it]Best trial: 11. Best value: 0.526376:  23%|██▎       | 23/100 [01:31<04:32,  3.53s/it]Best trial: 11. Best value: 0.526376:  23%|██▎       | 23/100 [01:33<04:32,  3.53s/it]Best trial: 11. Best value: 0.526376:  24%|██▍       | 24/100 [01:33<03:54,  3.09s/it]Best trial: 11. Best value: 0.526376:  24%|██▍       | 24/100 [01:36<03:54,  3.09s/it]Best trial: 11. Best value: 0.526376:  25%|██▌       | 25/100 [01:36<03:51,  3.08s/it]Best trial: 11. Best value: 0.526376:  25%|██▌       | 25/100 [01:38<03:51,  3.08s/it]Best trial: 11. Best value: 0.526376:  26%|██▌       | 26/100 [01:38<03:41,  3.00s/it]Best trial: 11. Best value: 0.526376:  26%|██▌       | 26/100 [01:42<03:41,  3.00s/it]Best trial: 11. Best value: 0.526376:  27%|██▋       | 27/100 [01:42<03:59,  3.27s/it]Best trial: 11. Best value: 0.526376:  27%|██▋       | 27/100 [01:46<03:59,  3.27s/it]Best trial: 11. Best value: 0.526376:  28%|██▊       | 28/100 [01:46<03:58,  3.32s/it]Best trial: 11. Best value: 0.526376:  28%|██▊       | 28/100 [01:50<03:58,  3.32s/it]Best trial: 11. Best value: 0.526376:  29%|██▉       | 29/100 [01:50<04:14,  3.59s/it]Best trial: 11. Best value: 0.526376:  29%|██▉       | 29/100 [01:56<04:14,  3.59s/it]Best trial: 11. Best value: 0.526376:  30%|███       | 30/100 [01:56<05:00,  4.30s/it]Best trial: 11. Best value: 0.526376:  30%|███       | 30/100 [01:58<05:00,  4.30s/it]Best trial: 11. Best value: 0.526376:  31%|███       | 31/100 [01:58<04:16,  3.72s/it]Best trial: 11. Best value: 0.526376:  31%|███       | 31/100 [02:01<04:16,  3.72s/it]Best trial: 11. Best value: 0.526376:  32%|███▏      | 32/100 [02:01<03:45,  3.32s/it]Best trial: 11. Best value: 0.526376:  32%|███▏      | 32/100 [02:03<03:45,  3.32s/it]Best trial: 11. Best value: 0.526376:  33%|███▎      | 33/100 [02:03<03:29,  3.13s/it]Best trial: 11. Best value: 0.526376:  33%|███▎      | 33/100 [02:06<03:29,  3.13s/it]Best trial: 11. Best value: 0.526376:  34%|███▍      | 34/100 [02:06<03:21,  3.05s/it]Best trial: 11. Best value: 0.526376:  34%|███▍      | 34/100 [02:09<03:21,  3.05s/it]Best trial: 11. Best value: 0.526376:  35%|███▌      | 35/100 [02:09<03:10,  2.94s/it]Best trial: 11. Best value: 0.526376:  35%|███▌      | 35/100 [02:12<03:10,  2.94s/it]Best trial: 11. Best value: 0.526376:  36%|███▌      | 36/100 [02:12<03:12,  3.00s/it]Best trial: 11. Best value: 0.526376:  36%|███▌      | 36/100 [02:15<03:12,  3.00s/it]Best trial: 11. Best value: 0.526376:  37%|███▋      | 37/100 [02:15<03:14,  3.08s/it]Best trial: 11. Best value: 0.526376:  37%|███▋      | 37/100 [02:19<03:14,  3.08s/it]Best trial: 11. Best value: 0.526376:  38%|███▊      | 38/100 [02:19<03:25,  3.31s/it]Best trial: 11. Best value: 0.526376:  38%|███▊      | 38/100 [02:21<03:25,  3.31s/it]Best trial: 11. Best value: 0.526376:  39%|███▉      | 39/100 [02:21<02:56,  2.89s/it]Best trial: 11. Best value: 0.526376:  39%|███▉      | 39/100 [02:24<02:56,  2.89s/it]Best trial: 11. Best value: 0.526376:  40%|████      | 40/100 [02:24<02:57,  2.97s/it]Best trial: 11. Best value: 0.526376:  40%|████      | 40/100 [02:27<02:57,  2.97s/it]Best trial: 11. Best value: 0.526376:  41%|████      | 41/100 [02:27<02:42,  2.75s/it]Best trial: 11. Best value: 0.526376:  41%|████      | 41/100 [02:29<02:42,  2.75s/it]Best trial: 11. Best value: 0.526376:  42%|████▏     | 42/100 [02:29<02:40,  2.77s/it]Best trial: 11. Best value: 0.526376:  42%|████▏     | 42/100 [02:33<02:40,  2.77s/it]Best trial: 11. Best value: 0.526376:  43%|████▎     | 43/100 [02:33<02:49,  2.98s/it]Best trial: 11. Best value: 0.526376:  43%|████▎     | 43/100 [02:36<02:49,  2.98s/it]Best trial: 11. Best value: 0.526376:  44%|████▍     | 44/100 [02:36<02:41,  2.88s/it]Best trial: 11. Best value: 0.526376:  44%|████▍     | 44/100 [02:38<02:41,  2.88s/it]Best trial: 11. Best value: 0.526376:  45%|████▌     | 45/100 [02:38<02:29,  2.71s/it]Best trial: 11. Best value: 0.526376:  45%|████▌     | 45/100 [02:40<02:29,  2.71s/it]Best trial: 11. Best value: 0.526376:  46%|████▌     | 46/100 [02:40<02:17,  2.54s/it]Best trial: 11. Best value: 0.526376:  46%|████▌     | 46/100 [02:42<02:17,  2.54s/it]Best trial: 11. Best value: 0.526376:  47%|████▋     | 47/100 [02:42<02:07,  2.41s/it]Best trial: 11. Best value: 0.526376:  47%|████▋     | 47/100 [02:45<02:07,  2.41s/it]Best trial: 11. Best value: 0.526376:  48%|████▊     | 48/100 [02:45<02:15,  2.60s/it]Best trial: 11. Best value: 0.526376:  48%|████▊     | 48/100 [02:47<02:15,  2.60s/it]Best trial: 11. Best value: 0.526376:  49%|████▉     | 49/100 [02:47<02:08,  2.52s/it]Best trial: 11. Best value: 0.526376:  49%|████▉     | 49/100 [02:50<02:08,  2.52s/it]Best trial: 11. Best value: 0.526376:  50%|█████     | 50/100 [02:50<02:03,  2.48s/it]Best trial: 11. Best value: 0.526376:  50%|█████     | 50/100 [02:52<02:03,  2.48s/it]Best trial: 11. Best value: 0.526376:  51%|█████     | 51/100 [02:52<01:57,  2.40s/it]Best trial: 11. Best value: 0.526376:  51%|█████     | 51/100 [02:54<01:57,  2.40s/it]Best trial: 11. Best value: 0.526376:  52%|█████▏    | 52/100 [02:54<01:53,  2.36s/it]Best trial: 11. Best value: 0.526376:  52%|█████▏    | 52/100 [02:57<01:53,  2.36s/it]Best trial: 11. Best value: 0.526376:  53%|█████▎    | 53/100 [02:57<01:49,  2.32s/it]Best trial: 11. Best value: 0.526376:  53%|█████▎    | 53/100 [02:59<01:49,  2.32s/it]Best trial: 11. Best value: 0.526376:  54%|█████▍    | 54/100 [02:59<01:49,  2.38s/it]Best trial: 11. Best value: 0.526376:  54%|█████▍    | 54/100 [03:01<01:49,  2.38s/it]Best trial: 11. Best value: 0.526376:  55%|█████▌    | 55/100 [03:01<01:46,  2.37s/it]Best trial: 11. Best value: 0.526376:  55%|█████▌    | 55/100 [03:05<01:46,  2.37s/it]Best trial: 11. Best value: 0.526376:  56%|█████▌    | 56/100 [03:05<02:00,  2.73s/it]Best trial: 11. Best value: 0.526376:  56%|█████▌    | 56/100 [03:08<02:00,  2.73s/it]Best trial: 11. Best value: 0.526376:  57%|█████▋    | 57/100 [03:08<01:55,  2.68s/it]Best trial: 11. Best value: 0.526376:  57%|█████▋    | 57/100 [03:11<01:55,  2.68s/it]Best trial: 11. Best value: 0.526376:  58%|█████▊    | 58/100 [03:11<02:05,  2.99s/it]Best trial: 11. Best value: 0.526376:  58%|█████▊    | 58/100 [03:14<02:05,  2.99s/it]Best trial: 11. Best value: 0.526376:  59%|█████▉    | 59/100 [03:14<02:00,  2.95s/it]Best trial: 11. Best value: 0.526376:  59%|█████▉    | 59/100 [03:16<02:00,  2.95s/it]Best trial: 11. Best value: 0.526376:  60%|██████    | 60/100 [03:16<01:46,  2.67s/it]Best trial: 11. Best value: 0.526376:  60%|██████    | 60/100 [03:20<01:46,  2.67s/it]Best trial: 11. Best value: 0.526376:  61%|██████    | 61/100 [03:20<02:02,  3.14s/it]Best trial: 11. Best value: 0.526376:  61%|██████    | 61/100 [03:22<02:02,  3.14s/it]Best trial: 11. Best value: 0.526376:  62%|██████▏   | 62/100 [03:22<01:46,  2.79s/it]Best trial: 11. Best value: 0.526376:  62%|██████▏   | 62/100 [03:25<01:46,  2.79s/it]Best trial: 11. Best value: 0.526376:  63%|██████▎   | 63/100 [03:25<01:39,  2.69s/it]Best trial: 11. Best value: 0.526376:  63%|██████▎   | 63/100 [03:27<01:39,  2.69s/it]Best trial: 11. Best value: 0.526376:  64%|██████▍   | 64/100 [03:27<01:35,  2.64s/it]Best trial: 11. Best value: 0.526376:  64%|██████▍   | 64/100 [03:30<01:35,  2.64s/it]Best trial: 11. Best value: 0.526376:  65%|██████▌   | 65/100 [03:30<01:30,  2.59s/it]Best trial: 11. Best value: 0.526376:  65%|██████▌   | 65/100 [03:32<01:30,  2.59s/it]Best trial: 11. Best value: 0.526376:  66%|██████▌   | 66/100 [03:32<01:24,  2.48s/it]Best trial: 11. Best value: 0.526376:  66%|██████▌   | 66/100 [03:34<01:24,  2.48s/it]Best trial: 11. Best value: 0.526376:  67%|██████▋   | 67/100 [03:34<01:19,  2.42s/it]Best trial: 11. Best value: 0.526376:  67%|██████▋   | 67/100 [03:37<01:19,  2.42s/it]Best trial: 11. Best value: 0.526376:  68%|██████▊   | 68/100 [03:37<01:19,  2.49s/it]Best trial: 68. Best value: 0.527924:  68%|██████▊   | 68/100 [03:41<01:19,  2.49s/it]Best trial: 68. Best value: 0.527924:  69%|██████▉   | 69/100 [03:41<01:27,  2.81s/it]Best trial: 69. Best value: 0.529045:  69%|██████▉   | 69/100 [03:44<01:27,  2.81s/it]Best trial: 69. Best value: 0.529045:  70%|███████   | 70/100 [03:44<01:26,  2.88s/it]Best trial: 69. Best value: 0.529045:  70%|███████   | 70/100 [03:46<01:26,  2.88s/it]Best trial: 69. Best value: 0.529045:  71%|███████   | 71/100 [03:46<01:18,  2.71s/it]Best trial: 69. Best value: 0.529045:  71%|███████   | 71/100 [03:49<01:18,  2.71s/it]Best trial: 69. Best value: 0.529045:  72%|███████▏  | 72/100 [03:49<01:18,  2.80s/it]Best trial: 69. Best value: 0.529045:  72%|███████▏  | 72/100 [03:51<01:18,  2.80s/it]Best trial: 69. Best value: 0.529045:  73%|███████▎  | 73/100 [03:51<01:13,  2.72s/it]Best trial: 69. Best value: 0.529045:  73%|███████▎  | 73/100 [03:55<01:13,  2.72s/it]Best trial: 69. Best value: 0.529045:  74%|███████▍  | 74/100 [03:55<01:16,  2.95s/it]Best trial: 69. Best value: 0.529045:  74%|███████▍  | 74/100 [03:58<01:16,  2.95s/it]Best trial: 69. Best value: 0.529045:  75%|███████▌  | 75/100 [03:58<01:11,  2.87s/it]Best trial: 75. Best value: 0.532474:  75%|███████▌  | 75/100 [04:00<01:11,  2.87s/it]Best trial: 75. Best value: 0.532474:  76%|███████▌  | 76/100 [04:00<01:07,  2.82s/it]Best trial: 75. Best value: 0.532474:  76%|███████▌  | 76/100 [04:03<01:07,  2.82s/it]Best trial: 75. Best value: 0.532474:  77%|███████▋  | 77/100 [04:03<01:05,  2.83s/it]Best trial: 75. Best value: 0.532474:  77%|███████▋  | 77/100 [04:06<01:05,  2.83s/it]Best trial: 75. Best value: 0.532474:  78%|███████▊  | 78/100 [04:06<01:02,  2.86s/it]Best trial: 75. Best value: 0.532474:  78%|███████▊  | 78/100 [04:09<01:02,  2.86s/it]Best trial: 75. Best value: 0.532474:  79%|███████▉  | 79/100 [04:09<00:59,  2.83s/it]Best trial: 75. Best value: 0.532474:  79%|███████▉  | 79/100 [04:12<00:59,  2.83s/it]Best trial: 75. Best value: 0.532474:  80%|████████  | 80/100 [04:12<00:57,  2.89s/it]Best trial: 75. Best value: 0.532474:  80%|████████  | 80/100 [04:15<00:57,  2.89s/it]Best trial: 75. Best value: 0.532474:  81%|████████  | 81/100 [04:15<00:57,  3.02s/it]Best trial: 75. Best value: 0.532474:  81%|████████  | 81/100 [04:18<00:57,  3.02s/it]Best trial: 75. Best value: 0.532474:  82%|████████▏ | 82/100 [04:18<00:50,  2.83s/it]Best trial: 75. Best value: 0.532474:  82%|████████▏ | 82/100 [04:20<00:50,  2.83s/it]Best trial: 75. Best value: 0.532474:  83%|████████▎ | 83/100 [04:20<00:46,  2.75s/it]Best trial: 75. Best value: 0.532474:  83%|████████▎ | 83/100 [04:23<00:46,  2.75s/it]Best trial: 75. Best value: 0.532474:  84%|████████▍ | 84/100 [04:23<00:45,  2.82s/it]Best trial: 75. Best value: 0.532474:  84%|████████▍ | 84/100 [04:26<00:45,  2.82s/it]Best trial: 75. Best value: 0.532474:  85%|████████▌ | 85/100 [04:26<00:42,  2.86s/it]Best trial: 75. Best value: 0.532474:  85%|████████▌ | 85/100 [04:29<00:42,  2.86s/it]Best trial: 75. Best value: 0.532474:  86%|████████▌ | 86/100 [04:29<00:42,  3.02s/it]Best trial: 75. Best value: 0.532474:  86%|████████▌ | 86/100 [04:32<00:42,  3.02s/it]Best trial: 75. Best value: 0.532474:  87%|████████▋ | 87/100 [04:32<00:36,  2.81s/it]Best trial: 75. Best value: 0.532474:  87%|████████▋ | 87/100 [04:35<00:36,  2.81s/it]Best trial: 75. Best value: 0.532474:  88%|████████▊ | 88/100 [04:35<00:33,  2.79s/it]Best trial: 75. Best value: 0.532474:  88%|████████▊ | 88/100 [04:37<00:33,  2.79s/it]Best trial: 75. Best value: 0.532474:  89%|████████▉ | 89/100 [04:37<00:29,  2.71s/it]Best trial: 75. Best value: 0.532474:  89%|████████▉ | 89/100 [04:40<00:29,  2.71s/it]Best trial: 75. Best value: 0.532474:  90%|█████████ | 90/100 [04:40<00:28,  2.80s/it]Best trial: 75. Best value: 0.532474:  90%|█████████ | 90/100 [04:42<00:28,  2.80s/it]Best trial: 75. Best value: 0.532474:  91%|█████████ | 91/100 [04:42<00:23,  2.59s/it]Best trial: 75. Best value: 0.532474:  91%|█████████ | 91/100 [04:45<00:23,  2.59s/it]Best trial: 75. Best value: 0.532474:  92%|█████████▏| 92/100 [04:45<00:22,  2.78s/it]Best trial: 75. Best value: 0.532474:  92%|█████████▏| 92/100 [04:48<00:22,  2.78s/it]Best trial: 75. Best value: 0.532474:  93%|█████████▎| 93/100 [04:48<00:19,  2.84s/it]Best trial: 75. Best value: 0.532474:  93%|█████████▎| 93/100 [04:52<00:19,  2.84s/it]Best trial: 75. Best value: 0.532474:  94%|█████████▍| 94/100 [04:52<00:17,  2.93s/it]Best trial: 75. Best value: 0.532474:  94%|█████████▍| 94/100 [04:54<00:17,  2.93s/it]Best trial: 75. Best value: 0.532474:  95%|█████████▌| 95/100 [04:54<00:14,  2.81s/it]Best trial: 75. Best value: 0.532474:  95%|█████████▌| 95/100 [04:57<00:14,  2.81s/it]Best trial: 75. Best value: 0.532474:  96%|█████████▌| 96/100 [04:57<00:11,  2.88s/it]Best trial: 75. Best value: 0.532474:  96%|█████████▌| 96/100 [04:59<00:11,  2.88s/it]Best trial: 75. Best value: 0.532474:  97%|█████████▋| 97/100 [04:59<00:08,  2.70s/it]Best trial: 75. Best value: 0.532474:  97%|█████████▋| 97/100 [05:02<00:08,  2.70s/it]Best trial: 75. Best value: 0.532474:  98%|█████████▊| 98/100 [05:02<00:05,  2.75s/it]Best trial: 75. Best value: 0.532474:  98%|█████████▊| 98/100 [05:05<00:05,  2.75s/it]Best trial: 75. Best value: 0.532474:  99%|█████████▉| 99/100 [05:05<00:02,  2.62s/it]Best trial: 75. Best value: 0.532474:  99%|█████████▉| 99/100 [05:07<00:02,  2.62s/it]Best trial: 75. Best value: 0.532474: 100%|██████████| 100/100 [05:07<00:00,  2.60s/it]Best trial: 75. Best value: 0.532474: 100%|██████████| 100/100 [05:07<00:00,  3.08s/it]
2025-11-30 08:13:08,694 - INFO - HPO Complete. Best AUPRC: 0.5325
2025-11-30 08:13:08,695 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.02120889475835577, 'max_depth': 3, 'subsample': 0.6504160918545752, 'colsample_bytree': 0.6510129146267793, 'gamma': 0.19405453548753215, 'reg_lambda': 0.40817665817250165, 'reg_alpha': 0.00011074040646732394}
2025-11-30 08:13:08,695 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:13:10,602 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 08:13:10,603 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:13:10,686 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:13:10,708 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:13:10,713 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 08:13:10,714 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:13:10,714 - INFO - Training model...
2025-11-30 08:13:11,753 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:13:16,974 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:13:16,975 - INFO - AUROC: 0.8093 (0.7085 - 0.8692)
2025-11-30 08:13:16,975 - INFO - AUPRC: 0.3926 (0.2724 - 0.5371)
2025-11-30 08:13:16,975 - INFO - Brier Score: 0.0641 (0.0554 - 0.0766)
2025-11-30 08:13:16,975 - INFO - Accuracy: 0.9509 (0.9249 - 0.9723)
2025-11-30 08:13:16,975 - INFO - Precision: 0.5333 (0.3607 - 0.8733)
2025-11-30 08:13:16,975 - INFO - Sensitivity (Recall): 0.4444 (0.2771 - 0.5934)
2025-11-30 08:13:16,975 - INFO - F1-Score: 0.4848 (0.3553 - 0.6144)
2025-11-30 08:13:16,975 - INFO - Best Threshold: 0.6100 (0.4400 - 0.7500)
2025-11-30 08:13:16,975 - INFO - Specificity: 0.9787 (0.9488 - 0.9967)
2025-11-30 08:13:16,984 - INFO - Calculating SHAP values...
2025-11-30 08:13:17,924 - INFO - SHAP plots saved.
2025-11-30 08:13:17,925 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:13:19,230 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 08:13:19,230 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:13:19,343 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:13:19,385 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:13:19,403 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:13:19,403 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.480036:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.480036:   1%|          | 1/100 [00:03<06:12,  3.76s/it]Best trial: 0. Best value: 0.480036:   1%|          | 1/100 [00:07<06:12,  3.76s/it]Best trial: 0. Best value: 0.480036:   2%|▏         | 2/100 [00:07<05:52,  3.60s/it]Best trial: 0. Best value: 0.480036:   2%|▏         | 2/100 [00:10<05:52,  3.60s/it]Best trial: 0. Best value: 0.480036:   3%|▎         | 3/100 [00:10<05:32,  3.42s/it]Best trial: 3. Best value: 0.480535:   3%|▎         | 3/100 [00:15<05:32,  3.42s/it]Best trial: 3. Best value: 0.480535:   4%|▍         | 4/100 [00:15<06:11,  3.87s/it]Best trial: 3. Best value: 0.480535:   4%|▍         | 4/100 [00:19<06:11,  3.87s/it]Best trial: 3. Best value: 0.480535:   5%|▌         | 5/100 [00:19<06:11,  3.91s/it]Best trial: 5. Best value: 0.505529:   5%|▌         | 5/100 [00:22<06:11,  3.91s/it]Best trial: 5. Best value: 0.505529:   6%|▌         | 6/100 [00:22<06:02,  3.86s/it]Best trial: 5. Best value: 0.505529:   6%|▌         | 6/100 [00:25<06:02,  3.86s/it]Best trial: 5. Best value: 0.505529:   7%|▋         | 7/100 [00:25<05:22,  3.47s/it]Best trial: 5. Best value: 0.505529:   7%|▋         | 7/100 [00:28<05:22,  3.47s/it]Best trial: 5. Best value: 0.505529:   8%|▊         | 8/100 [00:28<05:02,  3.29s/it]Best trial: 5. Best value: 0.505529:   8%|▊         | 8/100 [00:34<05:02,  3.29s/it]Best trial: 5. Best value: 0.505529:   9%|▉         | 9/100 [00:34<06:12,  4.09s/it]Best trial: 5. Best value: 0.505529:   9%|▉         | 9/100 [00:38<06:12,  4.09s/it]Best trial: 5. Best value: 0.505529:  10%|█         | 10/100 [00:38<06:22,  4.25s/it]Best trial: 5. Best value: 0.505529:  10%|█         | 10/100 [00:43<06:22,  4.25s/it]Best trial: 5. Best value: 0.505529:  11%|█         | 11/100 [00:43<06:43,  4.54s/it]Best trial: 5. Best value: 0.505529:  11%|█         | 11/100 [00:45<06:43,  4.54s/it]Best trial: 5. Best value: 0.505529:  12%|█▏        | 12/100 [00:45<05:31,  3.77s/it]Best trial: 5. Best value: 0.505529:  12%|█▏        | 12/100 [00:48<05:31,  3.77s/it]Best trial: 5. Best value: 0.505529:  13%|█▎        | 13/100 [00:48<04:59,  3.44s/it]Best trial: 13. Best value: 0.513932:  13%|█▎        | 13/100 [00:52<04:59,  3.44s/it]Best trial: 13. Best value: 0.513932:  14%|█▍        | 14/100 [00:52<05:04,  3.54s/it]Best trial: 13. Best value: 0.513932:  14%|█▍        | 14/100 [00:56<05:04,  3.54s/it]Best trial: 13. Best value: 0.513932:  15%|█▌        | 15/100 [00:56<05:12,  3.68s/it]Best trial: 13. Best value: 0.513932:  15%|█▌        | 15/100 [01:00<05:12,  3.68s/it]Best trial: 13. Best value: 0.513932:  16%|█▌        | 16/100 [01:00<05:28,  3.92s/it]Best trial: 13. Best value: 0.513932:  16%|█▌        | 16/100 [01:03<05:28,  3.92s/it]Best trial: 13. Best value: 0.513932:  17%|█▋        | 17/100 [01:03<04:47,  3.47s/it]Best trial: 13. Best value: 0.513932:  17%|█▋        | 17/100 [01:07<04:47,  3.47s/it]Best trial: 13. Best value: 0.513932:  18%|█▊        | 18/100 [01:07<05:06,  3.74s/it]Best trial: 13. Best value: 0.513932:  18%|█▊        | 18/100 [01:11<05:06,  3.74s/it]Best trial: 13. Best value: 0.513932:  19%|█▉        | 19/100 [01:11<05:05,  3.78s/it]Best trial: 13. Best value: 0.513932:  19%|█▉        | 19/100 [01:14<05:05,  3.78s/it]Best trial: 13. Best value: 0.513932:  20%|██        | 20/100 [01:14<04:38,  3.48s/it]Best trial: 13. Best value: 0.513932:  20%|██        | 20/100 [01:18<04:38,  3.48s/it]Best trial: 13. Best value: 0.513932:  21%|██        | 21/100 [01:18<04:47,  3.63s/it]Best trial: 13. Best value: 0.513932:  21%|██        | 21/100 [01:22<04:47,  3.63s/it]Best trial: 13. Best value: 0.513932:  22%|██▏       | 22/100 [01:22<04:48,  3.70s/it]Best trial: 13. Best value: 0.513932:  22%|██▏       | 22/100 [01:25<04:48,  3.70s/it]Best trial: 13. Best value: 0.513932:  23%|██▎       | 23/100 [01:25<04:29,  3.51s/it]Best trial: 13. Best value: 0.513932:  23%|██▎       | 23/100 [01:28<04:29,  3.51s/it]Best trial: 13. Best value: 0.513932:  24%|██▍       | 24/100 [01:28<04:30,  3.56s/it]Best trial: 13. Best value: 0.513932:  24%|██▍       | 24/100 [01:32<04:30,  3.56s/it]Best trial: 13. Best value: 0.513932:  25%|██▌       | 25/100 [01:32<04:21,  3.49s/it]Best trial: 13. Best value: 0.513932:  25%|██▌       | 25/100 [01:35<04:21,  3.49s/it]Best trial: 13. Best value: 0.513932:  26%|██▌       | 26/100 [01:35<04:10,  3.39s/it]Best trial: 13. Best value: 0.513932:  26%|██▌       | 26/100 [01:37<04:10,  3.39s/it]Best trial: 13. Best value: 0.513932:  27%|██▋       | 27/100 [01:37<03:43,  3.06s/it]Best trial: 13. Best value: 0.513932:  27%|██▋       | 27/100 [01:41<03:43,  3.06s/it]Best trial: 13. Best value: 0.513932:  28%|██▊       | 28/100 [01:41<03:59,  3.33s/it]Best trial: 13. Best value: 0.513932:  28%|██▊       | 28/100 [01:47<03:59,  3.33s/it]Best trial: 13. Best value: 0.513932:  29%|██▉       | 29/100 [01:47<04:51,  4.11s/it]Best trial: 13. Best value: 0.513932:  29%|██▉       | 29/100 [01:51<04:51,  4.11s/it]Best trial: 13. Best value: 0.513932:  30%|███       | 30/100 [01:51<04:37,  3.96s/it]Best trial: 13. Best value: 0.513932:  30%|███       | 30/100 [01:54<04:37,  3.96s/it]Best trial: 13. Best value: 0.513932:  31%|███       | 31/100 [01:54<04:23,  3.82s/it]Best trial: 13. Best value: 0.513932:  31%|███       | 31/100 [01:58<04:23,  3.82s/it]Best trial: 13. Best value: 0.513932:  32%|███▏      | 32/100 [01:58<04:12,  3.71s/it]Best trial: 13. Best value: 0.513932:  32%|███▏      | 32/100 [02:00<04:12,  3.71s/it]Best trial: 13. Best value: 0.513932:  33%|███▎      | 33/100 [02:00<03:50,  3.44s/it]Best trial: 13. Best value: 0.513932:  33%|███▎      | 33/100 [02:03<03:50,  3.44s/it]Best trial: 13. Best value: 0.513932:  34%|███▍      | 34/100 [02:03<03:36,  3.28s/it]Best trial: 13. Best value: 0.513932:  34%|███▍      | 34/100 [02:07<03:36,  3.28s/it]Best trial: 13. Best value: 0.513932:  35%|███▌      | 35/100 [02:07<03:47,  3.50s/it]Best trial: 35. Best value: 0.514425:  35%|███▌      | 35/100 [02:10<03:47,  3.50s/it]Best trial: 35. Best value: 0.514425:  36%|███▌      | 36/100 [02:10<03:36,  3.38s/it]Best trial: 35. Best value: 0.514425:  36%|███▌      | 36/100 [02:14<03:36,  3.38s/it]Best trial: 35. Best value: 0.514425:  37%|███▋      | 37/100 [02:14<03:26,  3.27s/it]Best trial: 35. Best value: 0.514425:  37%|███▋      | 37/100 [02:17<03:26,  3.27s/it]Best trial: 35. Best value: 0.514425:  38%|███▊      | 38/100 [02:17<03:22,  3.26s/it]Best trial: 35. Best value: 0.514425:  38%|███▊      | 38/100 [02:20<03:22,  3.26s/it]Best trial: 35. Best value: 0.514425:  39%|███▉      | 39/100 [02:20<03:12,  3.15s/it]Best trial: 35. Best value: 0.514425:  39%|███▉      | 39/100 [02:22<03:12,  3.15s/it]Best trial: 35. Best value: 0.514425:  40%|████      | 40/100 [02:22<02:51,  2.85s/it]Best trial: 35. Best value: 0.514425:  40%|████      | 40/100 [02:26<02:51,  2.85s/it]Best trial: 35. Best value: 0.514425:  41%|████      | 41/100 [02:26<03:03,  3.11s/it]Best trial: 35. Best value: 0.514425:  41%|████      | 41/100 [02:29<03:03,  3.11s/it]Best trial: 35. Best value: 0.514425:  42%|████▏     | 42/100 [02:29<03:09,  3.26s/it]Best trial: 35. Best value: 0.514425:  42%|████▏     | 42/100 [02:32<03:09,  3.26s/it]Best trial: 35. Best value: 0.514425:  43%|████▎     | 43/100 [02:32<03:03,  3.22s/it]Best trial: 35. Best value: 0.514425:  43%|████▎     | 43/100 [02:35<03:03,  3.22s/it]Best trial: 35. Best value: 0.514425:  44%|████▍     | 44/100 [02:35<02:57,  3.17s/it]Best trial: 35. Best value: 0.514425:  44%|████▍     | 44/100 [02:40<02:57,  3.17s/it]Best trial: 35. Best value: 0.514425:  45%|████▌     | 45/100 [02:40<03:23,  3.70s/it]Best trial: 35. Best value: 0.514425:  45%|████▌     | 45/100 [02:44<03:23,  3.70s/it]Best trial: 35. Best value: 0.514425:  46%|████▌     | 46/100 [02:44<03:17,  3.66s/it]Best trial: 35. Best value: 0.514425:  46%|████▌     | 46/100 [02:47<03:17,  3.66s/it]Best trial: 35. Best value: 0.514425:  47%|████▋     | 47/100 [02:47<03:04,  3.48s/it]Best trial: 35. Best value: 0.514425:  47%|████▋     | 47/100 [02:52<03:04,  3.48s/it]Best trial: 35. Best value: 0.514425:  48%|████▊     | 48/100 [02:52<03:19,  3.84s/it]Best trial: 35. Best value: 0.514425:  48%|████▊     | 48/100 [02:56<03:19,  3.84s/it]Best trial: 35. Best value: 0.514425:  49%|████▉     | 49/100 [02:56<03:21,  3.96s/it]Best trial: 35. Best value: 0.514425:  49%|████▉     | 49/100 [02:58<03:21,  3.96s/it]Best trial: 35. Best value: 0.514425:  50%|█████     | 50/100 [02:58<02:56,  3.53s/it]Best trial: 35. Best value: 0.514425:  50%|█████     | 50/100 [03:03<02:56,  3.53s/it]Best trial: 35. Best value: 0.514425:  51%|█████     | 51/100 [03:03<03:02,  3.73s/it]Best trial: 35. Best value: 0.514425:  51%|█████     | 51/100 [03:06<03:02,  3.73s/it]Best trial: 35. Best value: 0.514425:  52%|█████▏    | 52/100 [03:06<02:54,  3.64s/it]Best trial: 35. Best value: 0.514425:  52%|█████▏    | 52/100 [03:10<02:54,  3.64s/it]Best trial: 35. Best value: 0.514425:  53%|█████▎    | 53/100 [03:10<02:52,  3.67s/it]Best trial: 53. Best value: 0.515425:  53%|█████▎    | 53/100 [03:13<02:52,  3.67s/it]Best trial: 53. Best value: 0.515425:  54%|█████▍    | 54/100 [03:13<02:43,  3.56s/it]Best trial: 53. Best value: 0.515425:  54%|█████▍    | 54/100 [03:16<02:43,  3.56s/it]Best trial: 53. Best value: 0.515425:  55%|█████▌    | 55/100 [03:16<02:36,  3.48s/it]Best trial: 53. Best value: 0.515425:  55%|█████▌    | 55/100 [03:19<02:36,  3.48s/it]Best trial: 53. Best value: 0.515425:  56%|█████▌    | 56/100 [03:19<02:29,  3.40s/it]Best trial: 53. Best value: 0.515425:  56%|█████▌    | 56/100 [03:23<02:29,  3.40s/it]Best trial: 53. Best value: 0.515425:  57%|█████▋    | 57/100 [03:23<02:21,  3.29s/it]Best trial: 53. Best value: 0.515425:  57%|█████▋    | 57/100 [03:26<02:21,  3.29s/it]Best trial: 53. Best value: 0.515425:  58%|█████▊    | 58/100 [03:26<02:15,  3.23s/it]Best trial: 53. Best value: 0.515425:  58%|█████▊    | 58/100 [03:29<02:15,  3.23s/it]Best trial: 53. Best value: 0.515425:  59%|█████▉    | 59/100 [03:29<02:12,  3.23s/it]Best trial: 53. Best value: 0.515425:  59%|█████▉    | 59/100 [03:31<02:12,  3.23s/it]Best trial: 53. Best value: 0.515425:  60%|██████    | 60/100 [03:31<02:01,  3.03s/it]Best trial: 53. Best value: 0.515425:  60%|██████    | 60/100 [03:34<02:01,  3.03s/it]Best trial: 53. Best value: 0.515425:  61%|██████    | 61/100 [03:34<01:48,  2.78s/it]Best trial: 53. Best value: 0.515425:  61%|██████    | 61/100 [03:37<01:48,  2.78s/it]Best trial: 53. Best value: 0.515425:  62%|██████▏   | 62/100 [03:37<01:53,  2.97s/it]Best trial: 53. Best value: 0.515425:  62%|██████▏   | 62/100 [03:40<01:53,  2.97s/it]Best trial: 53. Best value: 0.515425:  63%|██████▎   | 63/100 [03:40<01:54,  3.10s/it]Best trial: 53. Best value: 0.515425:  63%|██████▎   | 63/100 [03:46<01:54,  3.10s/it]Best trial: 53. Best value: 0.515425:  64%|██████▍   | 64/100 [03:46<02:14,  3.75s/it]Best trial: 53. Best value: 0.515425:  64%|██████▍   | 64/100 [03:49<02:14,  3.75s/it]Best trial: 53. Best value: 0.515425:  65%|██████▌   | 65/100 [03:49<02:04,  3.56s/it]Best trial: 53. Best value: 0.515425:  65%|██████▌   | 65/100 [03:54<02:04,  3.56s/it]Best trial: 53. Best value: 0.515425:  66%|██████▌   | 66/100 [03:54<02:12,  3.90s/it]Best trial: 53. Best value: 0.515425:  66%|██████▌   | 66/100 [03:56<02:12,  3.90s/it]Best trial: 53. Best value: 0.515425:  67%|██████▋   | 67/100 [03:56<01:59,  3.61s/it]Best trial: 53. Best value: 0.515425:  67%|██████▋   | 67/100 [03:59<01:59,  3.61s/it]Best trial: 53. Best value: 0.515425:  68%|██████▊   | 68/100 [03:59<01:47,  3.36s/it]Best trial: 53. Best value: 0.515425:  68%|██████▊   | 68/100 [04:02<01:47,  3.36s/it]Best trial: 53. Best value: 0.515425:  69%|██████▉   | 69/100 [04:02<01:36,  3.12s/it]Best trial: 53. Best value: 0.515425:  69%|██████▉   | 69/100 [04:05<01:36,  3.12s/it]Best trial: 53. Best value: 0.515425:  70%|███████   | 70/100 [04:05<01:38,  3.27s/it]Best trial: 53. Best value: 0.515425:  70%|███████   | 70/100 [04:09<01:38,  3.27s/it]Best trial: 53. Best value: 0.515425:  71%|███████   | 71/100 [04:09<01:36,  3.34s/it]Best trial: 53. Best value: 0.515425:  71%|███████   | 71/100 [04:12<01:36,  3.34s/it]Best trial: 53. Best value: 0.515425:  72%|███████▏  | 72/100 [04:12<01:32,  3.29s/it]Best trial: 53. Best value: 0.515425:  72%|███████▏  | 72/100 [04:16<01:32,  3.29s/it]Best trial: 53. Best value: 0.515425:  73%|███████▎  | 73/100 [04:16<01:33,  3.48s/it]Best trial: 53. Best value: 0.515425:  73%|███████▎  | 73/100 [04:20<01:33,  3.48s/it]Best trial: 53. Best value: 0.515425:  74%|███████▍  | 74/100 [04:20<01:31,  3.51s/it]Best trial: 53. Best value: 0.515425:  74%|███████▍  | 74/100 [04:23<01:31,  3.51s/it]Best trial: 53. Best value: 0.515425:  75%|███████▌  | 75/100 [04:23<01:23,  3.34s/it]Best trial: 53. Best value: 0.515425:  75%|███████▌  | 75/100 [04:26<01:23,  3.34s/it]Best trial: 53. Best value: 0.515425:  76%|███████▌  | 76/100 [04:26<01:19,  3.31s/it]Best trial: 53. Best value: 0.515425:  76%|███████▌  | 76/100 [04:29<01:19,  3.31s/it]Best trial: 53. Best value: 0.515425:  77%|███████▋  | 77/100 [04:29<01:12,  3.17s/it]Best trial: 53. Best value: 0.515425:  77%|███████▋  | 77/100 [04:31<01:12,  3.17s/it]Best trial: 53. Best value: 0.515425:  78%|███████▊  | 78/100 [04:31<01:07,  3.08s/it]Best trial: 53. Best value: 0.515425:  78%|███████▊  | 78/100 [04:35<01:07,  3.08s/it]Best trial: 53. Best value: 0.515425:  79%|███████▉  | 79/100 [04:35<01:09,  3.29s/it]Best trial: 53. Best value: 0.515425:  79%|███████▉  | 79/100 [04:39<01:09,  3.29s/it]Best trial: 53. Best value: 0.515425:  80%|████████  | 80/100 [04:39<01:07,  3.37s/it]Best trial: 53. Best value: 0.515425:  80%|████████  | 80/100 [04:42<01:07,  3.37s/it]Best trial: 53. Best value: 0.515425:  81%|████████  | 81/100 [04:42<01:02,  3.31s/it]Best trial: 53. Best value: 0.515425:  81%|████████  | 81/100 [04:46<01:02,  3.31s/it]Best trial: 53. Best value: 0.515425:  82%|████████▏ | 82/100 [04:46<01:01,  3.40s/it]Best trial: 53. Best value: 0.515425:  82%|████████▏ | 82/100 [04:50<01:01,  3.40s/it]Best trial: 53. Best value: 0.515425:  83%|████████▎ | 83/100 [04:50<01:00,  3.55s/it]Best trial: 53. Best value: 0.515425:  83%|████████▎ | 83/100 [04:53<01:00,  3.55s/it]Best trial: 53. Best value: 0.515425:  84%|████████▍ | 84/100 [04:53<00:58,  3.66s/it]Best trial: 53. Best value: 0.515425:  84%|████████▍ | 84/100 [04:57<00:58,  3.66s/it]Best trial: 53. Best value: 0.515425:  85%|████████▌ | 85/100 [04:57<00:55,  3.71s/it]Best trial: 53. Best value: 0.515425:  85%|████████▌ | 85/100 [05:01<00:55,  3.71s/it]Best trial: 53. Best value: 0.515425:  86%|████████▌ | 86/100 [05:01<00:52,  3.77s/it]Best trial: 53. Best value: 0.515425:  86%|████████▌ | 86/100 [05:05<00:52,  3.77s/it]Best trial: 53. Best value: 0.515425:  87%|████████▋ | 87/100 [05:05<00:47,  3.68s/it]Best trial: 53. Best value: 0.515425:  87%|████████▋ | 87/100 [05:13<00:47,  3.68s/it]Best trial: 53. Best value: 0.515425:  88%|████████▊ | 88/100 [05:13<00:59,  4.95s/it]Best trial: 53. Best value: 0.515425:  88%|████████▊ | 88/100 [05:16<00:59,  4.95s/it]Best trial: 53. Best value: 0.515425:  89%|████████▉ | 89/100 [05:16<00:47,  4.36s/it]Best trial: 53. Best value: 0.515425:  89%|████████▉ | 89/100 [05:18<00:47,  4.36s/it]Best trial: 53. Best value: 0.515425:  90%|█████████ | 90/100 [05:18<00:39,  3.91s/it]Best trial: 53. Best value: 0.515425:  90%|█████████ | 90/100 [05:22<00:39,  3.91s/it]Best trial: 53. Best value: 0.515425:  91%|█████████ | 91/100 [05:22<00:33,  3.69s/it]Best trial: 53. Best value: 0.515425:  91%|█████████ | 91/100 [05:25<00:33,  3.69s/it]Best trial: 53. Best value: 0.515425:  92%|█████████▏| 92/100 [05:25<00:29,  3.65s/it]Best trial: 53. Best value: 0.515425:  92%|█████████▏| 92/100 [05:29<00:29,  3.65s/it]Best trial: 53. Best value: 0.515425:  93%|█████████▎| 93/100 [05:29<00:25,  3.62s/it]Best trial: 53. Best value: 0.515425:  93%|█████████▎| 93/100 [05:32<00:25,  3.62s/it]Best trial: 53. Best value: 0.515425:  94%|█████████▍| 94/100 [05:32<00:20,  3.44s/it]Best trial: 53. Best value: 0.515425:  94%|█████████▍| 94/100 [05:35<00:20,  3.44s/it]Best trial: 53. Best value: 0.515425:  95%|█████████▌| 95/100 [05:35<00:16,  3.31s/it]Best trial: 53. Best value: 0.515425:  95%|█████████▌| 95/100 [05:38<00:16,  3.31s/it]Best trial: 53. Best value: 0.515425:  96%|█████████▌| 96/100 [05:38<00:13,  3.35s/it]Best trial: 53. Best value: 0.515425:  96%|█████████▌| 96/100 [05:41<00:13,  3.35s/it]Best trial: 53. Best value: 0.515425:  97%|█████████▋| 97/100 [05:41<00:09,  3.20s/it]Best trial: 53. Best value: 0.515425:  97%|█████████▋| 97/100 [05:44<00:09,  3.20s/it]Best trial: 53. Best value: 0.515425:  98%|█████████▊| 98/100 [05:44<00:06,  3.27s/it]Best trial: 53. Best value: 0.515425:  98%|█████████▊| 98/100 [05:47<00:06,  3.27s/it]Best trial: 53. Best value: 0.515425:  99%|█████████▉| 99/100 [05:47<00:03,  3.21s/it]Best trial: 53. Best value: 0.515425:  99%|█████████▉| 99/100 [05:51<00:03,  3.21s/it]Best trial: 53. Best value: 0.515425: 100%|██████████| 100/100 [05:51<00:00,  3.41s/it]Best trial: 53. Best value: 0.515425: 100%|██████████| 100/100 [05:51<00:00,  3.52s/it]
2025-11-30 08:19:11,262 - INFO - HPO Complete. Best AUPRC: 0.5154
2025-11-30 08:19:11,263 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.00021689445975227016, 'max_depth': 5, 'subsample': 0.6238314229456521, 'colsample_bytree': 0.8802414639218036, 'gamma': 0.9256992685800789, 'reg_lambda': 9.782372953740224e-08, 'reg_alpha': 3.416430285557881e-05}
2025-11-30 08:19:11,264 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:19:13,229 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 08:19:13,229 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:19:13,322 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:19:13,354 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:19:13,364 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:19:13,364 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:19:13,364 - INFO - Training model...
2025-11-30 08:19:16,150 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:19:21,741 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:19:21,741 - INFO - AUROC: 0.7864 (0.6808 - 0.8392)
2025-11-30 08:19:21,741 - INFO - AUPRC: 0.3653 (0.2613 - 0.5248)
2025-11-30 08:19:21,741 - INFO - Brier Score: 0.2063 (0.2049 - 0.2081)
2025-11-30 08:19:21,741 - INFO - Accuracy: 0.9595 (0.9156 - 0.9740)
2025-11-30 08:19:21,741 - INFO - Precision: 0.7500 (0.3143 - 0.9667)
2025-11-30 08:19:21,741 - INFO - Sensitivity (Recall): 0.3333 (0.2310 - 0.5351)
2025-11-30 08:19:21,741 - INFO - F1-Score: 0.4615 (0.3469 - 0.6418)
2025-11-30 08:19:21,741 - INFO - Best Threshold: 0.5100 (0.4800 - 0.5300)
2025-11-30 08:19:21,741 - INFO - Specificity: 0.9939 (0.9434 - 0.9991)
2025-11-30 08:19:21,767 - INFO - Calculating SHAP values...
2025-11-30 08:19:22,956 - INFO - SHAP plots saved.
2025-11-30 08:19:22,958 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:19:24,276 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 08:19:24,276 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:19:24,363 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:19:24,395 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:19:24,404 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:19:24,404 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.472406:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.472406:   1%|          | 1/100 [00:03<04:58,  3.01s/it]Best trial: 1. Best value: 0.515268:   1%|          | 1/100 [00:05<04:58,  3.01s/it]Best trial: 1. Best value: 0.515268:   2%|▏         | 2/100 [00:05<04:45,  2.91s/it]Best trial: 1. Best value: 0.515268:   2%|▏         | 2/100 [00:08<04:45,  2.91s/it]Best trial: 1. Best value: 0.515268:   3%|▎         | 3/100 [00:08<04:20,  2.68s/it]Best trial: 1. Best value: 0.515268:   3%|▎         | 3/100 [00:11<04:20,  2.68s/it]Best trial: 1. Best value: 0.515268:   4%|▍         | 4/100 [00:11<04:41,  2.93s/it]Best trial: 1. Best value: 0.515268:   4%|▍         | 4/100 [00:16<04:41,  2.93s/it]Best trial: 1. Best value: 0.515268:   5%|▌         | 5/100 [00:16<06:02,  3.82s/it]Best trial: 1. Best value: 0.515268:   5%|▌         | 5/100 [00:20<06:02,  3.82s/it]Best trial: 1. Best value: 0.515268:   6%|▌         | 6/100 [00:20<05:43,  3.65s/it]Best trial: 1. Best value: 0.515268:   6%|▌         | 6/100 [00:26<05:43,  3.65s/it]Best trial: 1. Best value: 0.515268:   7%|▋         | 7/100 [00:26<06:43,  4.34s/it]Best trial: 1. Best value: 0.515268:   7%|▋         | 7/100 [00:31<06:43,  4.34s/it]Best trial: 1. Best value: 0.515268:   8%|▊         | 8/100 [00:31<06:58,  4.54s/it]Best trial: 1. Best value: 0.515268:   8%|▊         | 8/100 [00:35<06:58,  4.54s/it]Best trial: 1. Best value: 0.515268:   9%|▉         | 9/100 [00:35<06:43,  4.44s/it]Best trial: 1. Best value: 0.515268:   9%|▉         | 9/100 [00:39<06:43,  4.44s/it]Best trial: 1. Best value: 0.515268:  10%|█         | 10/100 [00:39<06:36,  4.41s/it]Best trial: 1. Best value: 0.515268:  10%|█         | 10/100 [00:42<06:36,  4.41s/it]Best trial: 1. Best value: 0.515268:  11%|█         | 11/100 [00:42<05:51,  3.95s/it]Best trial: 1. Best value: 0.515268:  11%|█         | 11/100 [00:47<05:51,  3.95s/it]Best trial: 1. Best value: 0.515268:  12%|█▏        | 12/100 [00:47<06:14,  4.25s/it]Best trial: 1. Best value: 0.515268:  12%|█▏        | 12/100 [00:51<06:14,  4.25s/it]Best trial: 1. Best value: 0.515268:  13%|█▎        | 13/100 [00:51<06:11,  4.27s/it]Best trial: 1. Best value: 0.515268:  13%|█▎        | 13/100 [00:56<06:11,  4.27s/it]Best trial: 1. Best value: 0.515268:  14%|█▍        | 14/100 [00:56<06:25,  4.48s/it]Best trial: 1. Best value: 0.515268:  14%|█▍        | 14/100 [01:02<06:25,  4.48s/it]Best trial: 1. Best value: 0.515268:  15%|█▌        | 15/100 [01:02<07:05,  5.00s/it]Best trial: 1. Best value: 0.515268:  15%|█▌        | 15/100 [01:08<07:05,  5.00s/it]Best trial: 1. Best value: 0.515268:  16%|█▌        | 16/100 [01:08<07:15,  5.18s/it]Best trial: 1. Best value: 0.515268:  16%|█▌        | 16/100 [01:12<07:15,  5.18s/it]Best trial: 1. Best value: 0.515268:  17%|█▋        | 17/100 [01:12<06:35,  4.77s/it]Best trial: 1. Best value: 0.515268:  17%|█▋        | 17/100 [01:15<06:35,  4.77s/it]Best trial: 1. Best value: 0.515268:  18%|█▊        | 18/100 [01:15<05:48,  4.25s/it]Best trial: 1. Best value: 0.515268:  18%|█▊        | 18/100 [01:19<05:48,  4.25s/it]Best trial: 1. Best value: 0.515268:  19%|█▉        | 19/100 [01:19<05:50,  4.33s/it]Best trial: 1. Best value: 0.515268:  19%|█▉        | 19/100 [01:22<05:50,  4.33s/it]Best trial: 1. Best value: 0.515268:  20%|██        | 20/100 [01:22<05:01,  3.77s/it]Best trial: 1. Best value: 0.515268:  20%|██        | 20/100 [01:24<05:01,  3.77s/it]Best trial: 1. Best value: 0.515268:  21%|██        | 21/100 [01:24<04:19,  3.29s/it]Best trial: 21. Best value: 0.516462:  21%|██        | 21/100 [01:27<04:19,  3.29s/it]Best trial: 21. Best value: 0.516462:  22%|██▏       | 22/100 [01:27<04:02,  3.11s/it]Best trial: 21. Best value: 0.516462:  22%|██▏       | 22/100 [01:30<04:02,  3.11s/it]Best trial: 21. Best value: 0.516462:  23%|██▎       | 23/100 [01:30<03:52,  3.02s/it]Best trial: 21. Best value: 0.516462:  23%|██▎       | 23/100 [01:33<03:52,  3.02s/it]Best trial: 21. Best value: 0.516462:  24%|██▍       | 24/100 [01:33<03:53,  3.07s/it]Best trial: 21. Best value: 0.516462:  24%|██▍       | 24/100 [01:36<03:53,  3.07s/it]Best trial: 21. Best value: 0.516462:  25%|██▌       | 25/100 [01:36<04:05,  3.27s/it]Best trial: 21. Best value: 0.516462:  25%|██▌       | 25/100 [01:39<04:05,  3.27s/it]Best trial: 21. Best value: 0.516462:  26%|██▌       | 26/100 [01:39<03:52,  3.14s/it]Best trial: 21. Best value: 0.516462:  26%|██▌       | 26/100 [01:44<03:52,  3.14s/it]Best trial: 21. Best value: 0.516462:  27%|██▋       | 27/100 [01:44<04:14,  3.49s/it]Best trial: 21. Best value: 0.516462:  27%|██▋       | 27/100 [01:48<04:14,  3.49s/it]Best trial: 21. Best value: 0.516462:  28%|██▊       | 28/100 [01:48<04:25,  3.68s/it]Best trial: 21. Best value: 0.516462:  28%|██▊       | 28/100 [01:51<04:25,  3.68s/it]Best trial: 21. Best value: 0.516462:  29%|██▉       | 29/100 [01:51<04:17,  3.62s/it]Best trial: 21. Best value: 0.516462:  29%|██▉       | 29/100 [01:54<04:17,  3.62s/it]Best trial: 21. Best value: 0.516462:  30%|███       | 30/100 [01:54<04:04,  3.49s/it]Best trial: 21. Best value: 0.516462:  30%|███       | 30/100 [01:58<04:04,  3.49s/it]Best trial: 21. Best value: 0.516462:  31%|███       | 31/100 [01:58<04:13,  3.67s/it]Best trial: 31. Best value: 0.522598:  31%|███       | 31/100 [02:02<04:13,  3.67s/it]Best trial: 31. Best value: 0.522598:  32%|███▏      | 32/100 [02:02<03:59,  3.52s/it]Best trial: 31. Best value: 0.522598:  32%|███▏      | 32/100 [02:04<03:59,  3.52s/it]Best trial: 31. Best value: 0.522598:  33%|███▎      | 33/100 [02:04<03:39,  3.28s/it]Best trial: 31. Best value: 0.522598:  33%|███▎      | 33/100 [02:11<03:39,  3.28s/it]Best trial: 31. Best value: 0.522598:  34%|███▍      | 34/100 [02:11<04:50,  4.40s/it]Best trial: 31. Best value: 0.522598:  34%|███▍      | 34/100 [02:14<04:50,  4.40s/it]Best trial: 31. Best value: 0.522598:  35%|███▌      | 35/100 [02:14<04:19,  3.99s/it]Best trial: 31. Best value: 0.522598:  35%|███▌      | 35/100 [02:17<04:19,  3.99s/it]Best trial: 31. Best value: 0.522598:  36%|███▌      | 36/100 [02:17<03:53,  3.65s/it]Best trial: 31. Best value: 0.522598:  36%|███▌      | 36/100 [02:20<03:53,  3.65s/it]Best trial: 31. Best value: 0.522598:  37%|███▋      | 37/100 [02:20<03:40,  3.50s/it]Best trial: 31. Best value: 0.522598:  37%|███▋      | 37/100 [02:24<03:40,  3.50s/it]Best trial: 31. Best value: 0.522598:  38%|███▊      | 38/100 [02:24<03:30,  3.39s/it]Best trial: 31. Best value: 0.522598:  38%|███▊      | 38/100 [02:26<03:30,  3.39s/it]Best trial: 31. Best value: 0.522598:  39%|███▉      | 39/100 [02:26<03:05,  3.05s/it]Best trial: 31. Best value: 0.522598:  39%|███▉      | 39/100 [02:28<03:05,  3.05s/it]Best trial: 31. Best value: 0.522598:  40%|████      | 40/100 [02:28<02:49,  2.82s/it]Best trial: 31. Best value: 0.522598:  40%|████      | 40/100 [02:31<02:49,  2.82s/it]Best trial: 31. Best value: 0.522598:  41%|████      | 41/100 [02:31<02:43,  2.77s/it]Best trial: 31. Best value: 0.522598:  41%|████      | 41/100 [02:33<02:43,  2.77s/it]Best trial: 31. Best value: 0.522598:  42%|████▏     | 42/100 [02:33<02:37,  2.71s/it]Best trial: 31. Best value: 0.522598:  42%|████▏     | 42/100 [02:37<02:37,  2.71s/it]Best trial: 31. Best value: 0.522598:  43%|████▎     | 43/100 [02:37<02:54,  3.06s/it]Best trial: 31. Best value: 0.522598:  43%|████▎     | 43/100 [02:40<02:54,  3.06s/it]Best trial: 31. Best value: 0.522598:  44%|████▍     | 44/100 [02:40<02:40,  2.86s/it]Best trial: 31. Best value: 0.522598:  44%|████▍     | 44/100 [02:43<02:40,  2.86s/it]Best trial: 31. Best value: 0.522598:  45%|████▌     | 45/100 [02:43<02:50,  3.10s/it]Best trial: 31. Best value: 0.522598:  45%|████▌     | 45/100 [02:48<02:50,  3.10s/it]Best trial: 31. Best value: 0.522598:  46%|████▌     | 46/100 [02:48<03:06,  3.46s/it]Best trial: 31. Best value: 0.522598:  46%|████▌     | 46/100 [02:51<03:06,  3.46s/it]Best trial: 31. Best value: 0.522598:  47%|████▋     | 47/100 [02:51<03:07,  3.54s/it]Best trial: 31. Best value: 0.522598:  47%|████▋     | 47/100 [02:53<03:07,  3.54s/it]Best trial: 31. Best value: 0.522598:  48%|████▊     | 48/100 [02:53<02:41,  3.11s/it]Best trial: 31. Best value: 0.522598:  48%|████▊     | 48/100 [02:58<02:41,  3.11s/it]Best trial: 31. Best value: 0.522598:  49%|████▉     | 49/100 [02:58<03:00,  3.54s/it]Best trial: 31. Best value: 0.522598:  49%|████▉     | 49/100 [03:01<03:00,  3.54s/it]Best trial: 31. Best value: 0.522598:  50%|█████     | 50/100 [03:01<02:57,  3.55s/it]Best trial: 31. Best value: 0.522598:  50%|█████     | 50/100 [03:04<02:57,  3.55s/it]Best trial: 31. Best value: 0.522598:  51%|█████     | 51/100 [03:04<02:45,  3.38s/it]Best trial: 31. Best value: 0.522598:  51%|█████     | 51/100 [03:08<02:45,  3.38s/it]Best trial: 31. Best value: 0.522598:  52%|█████▏    | 52/100 [03:08<02:40,  3.33s/it]Best trial: 31. Best value: 0.522598:  52%|█████▏    | 52/100 [03:11<02:40,  3.33s/it]Best trial: 31. Best value: 0.522598:  53%|█████▎    | 53/100 [03:11<02:35,  3.31s/it]Best trial: 31. Best value: 0.522598:  53%|█████▎    | 53/100 [03:15<02:35,  3.31s/it]Best trial: 31. Best value: 0.522598:  54%|█████▍    | 54/100 [03:15<02:41,  3.51s/it]Best trial: 31. Best value: 0.522598:  54%|█████▍    | 54/100 [03:18<02:41,  3.51s/it]Best trial: 31. Best value: 0.522598:  55%|█████▌    | 55/100 [03:18<02:26,  3.26s/it]Best trial: 31. Best value: 0.522598:  55%|█████▌    | 55/100 [03:22<02:26,  3.26s/it]Best trial: 31. Best value: 0.522598:  56%|█████▌    | 56/100 [03:22<02:44,  3.73s/it]Best trial: 31. Best value: 0.522598:  56%|█████▌    | 56/100 [03:25<02:44,  3.73s/it]Best trial: 31. Best value: 0.522598:  57%|█████▋    | 57/100 [03:25<02:27,  3.43s/it]Best trial: 31. Best value: 0.522598:  57%|█████▋    | 57/100 [03:28<02:27,  3.43s/it]Best trial: 31. Best value: 0.522598:  58%|█████▊    | 58/100 [03:28<02:19,  3.32s/it]Best trial: 58. Best value: 0.524884:  58%|█████▊    | 58/100 [03:30<02:19,  3.32s/it]Best trial: 58. Best value: 0.524884:  59%|█████▉    | 59/100 [03:30<02:01,  2.96s/it]Best trial: 58. Best value: 0.524884:  59%|█████▉    | 59/100 [03:32<02:01,  2.96s/it]Best trial: 58. Best value: 0.524884:  60%|██████    | 60/100 [03:32<01:48,  2.70s/it]Best trial: 60. Best value: 0.528599:  60%|██████    | 60/100 [03:35<01:48,  2.70s/it]Best trial: 60. Best value: 0.528599:  61%|██████    | 61/100 [03:35<01:42,  2.62s/it]Best trial: 61. Best value: 0.529812:  61%|██████    | 61/100 [03:37<01:42,  2.62s/it]Best trial: 61. Best value: 0.529812:  62%|██████▏   | 62/100 [03:37<01:35,  2.52s/it]Best trial: 61. Best value: 0.529812:  62%|██████▏   | 62/100 [03:39<01:35,  2.52s/it]Best trial: 61. Best value: 0.529812:  63%|██████▎   | 63/100 [03:39<01:30,  2.44s/it]Best trial: 61. Best value: 0.529812:  63%|██████▎   | 63/100 [03:42<01:30,  2.44s/it]Best trial: 61. Best value: 0.529812:  64%|██████▍   | 64/100 [03:42<01:24,  2.35s/it]Best trial: 61. Best value: 0.529812:  64%|██████▍   | 64/100 [03:44<01:24,  2.35s/it]Best trial: 61. Best value: 0.529812:  65%|██████▌   | 65/100 [03:44<01:27,  2.50s/it]Best trial: 61. Best value: 0.529812:  65%|██████▌   | 65/100 [03:47<01:27,  2.50s/it]Best trial: 61. Best value: 0.529812:  66%|██████▌   | 66/100 [03:47<01:22,  2.43s/it]Best trial: 61. Best value: 0.529812:  66%|██████▌   | 66/100 [03:49<01:22,  2.43s/it]Best trial: 61. Best value: 0.529812:  67%|██████▋   | 67/100 [03:49<01:16,  2.32s/it]Best trial: 61. Best value: 0.529812:  67%|██████▋   | 67/100 [03:51<01:16,  2.32s/it]Best trial: 61. Best value: 0.529812:  68%|██████▊   | 68/100 [03:51<01:12,  2.26s/it]Best trial: 61. Best value: 0.529812:  68%|██████▊   | 68/100 [03:54<01:12,  2.26s/it]Best trial: 61. Best value: 0.529812:  69%|██████▉   | 69/100 [03:54<01:13,  2.38s/it]Best trial: 61. Best value: 0.529812:  69%|██████▉   | 69/100 [03:56<01:13,  2.38s/it]Best trial: 61. Best value: 0.529812:  70%|███████   | 70/100 [03:56<01:11,  2.39s/it]Best trial: 61. Best value: 0.529812:  70%|███████   | 70/100 [03:59<01:11,  2.39s/it]Best trial: 61. Best value: 0.529812:  71%|███████   | 71/100 [03:59<01:12,  2.49s/it]Best trial: 61. Best value: 0.529812:  71%|███████   | 71/100 [04:02<01:12,  2.49s/it]Best trial: 61. Best value: 0.529812:  72%|███████▏  | 72/100 [04:02<01:15,  2.69s/it]Best trial: 72. Best value: 0.535128:  72%|███████▏  | 72/100 [04:05<01:15,  2.69s/it]Best trial: 72. Best value: 0.535128:  73%|███████▎  | 73/100 [04:05<01:16,  2.84s/it]Best trial: 72. Best value: 0.535128:  73%|███████▎  | 73/100 [04:08<01:16,  2.84s/it]Best trial: 72. Best value: 0.535128:  74%|███████▍  | 74/100 [04:08<01:16,  2.95s/it]Best trial: 72. Best value: 0.535128:  74%|███████▍  | 74/100 [04:11<01:16,  2.95s/it]Best trial: 72. Best value: 0.535128:  75%|███████▌  | 75/100 [04:11<01:09,  2.79s/it]Best trial: 72. Best value: 0.535128:  75%|███████▌  | 75/100 [04:13<01:09,  2.79s/it]Best trial: 72. Best value: 0.535128:  76%|███████▌  | 76/100 [04:13<01:06,  2.78s/it]Best trial: 72. Best value: 0.535128:  76%|███████▌  | 76/100 [04:16<01:06,  2.78s/it]Best trial: 72. Best value: 0.535128:  77%|███████▋  | 77/100 [04:16<01:02,  2.71s/it]Best trial: 72. Best value: 0.535128:  77%|███████▋  | 77/100 [04:18<01:02,  2.71s/it]Best trial: 72. Best value: 0.535128:  78%|███████▊  | 78/100 [04:18<00:54,  2.48s/it]Best trial: 72. Best value: 0.535128:  78%|███████▊  | 78/100 [04:22<00:54,  2.48s/it]Best trial: 72. Best value: 0.535128:  79%|███████▉  | 79/100 [04:22<01:00,  2.88s/it]Best trial: 72. Best value: 0.535128:  79%|███████▉  | 79/100 [04:25<01:00,  2.88s/it]Best trial: 72. Best value: 0.535128:  80%|████████  | 80/100 [04:25<00:59,  2.99s/it]Best trial: 72. Best value: 0.535128:  80%|████████  | 80/100 [04:27<00:59,  2.99s/it]Best trial: 72. Best value: 0.535128:  81%|████████  | 81/100 [04:27<00:52,  2.76s/it]Best trial: 72. Best value: 0.535128:  81%|████████  | 81/100 [04:29<00:52,  2.76s/it]Best trial: 72. Best value: 0.535128:  82%|████████▏ | 82/100 [04:29<00:46,  2.57s/it]Best trial: 72. Best value: 0.535128:  82%|████████▏ | 82/100 [04:32<00:46,  2.57s/it]Best trial: 72. Best value: 0.535128:  83%|████████▎ | 83/100 [04:32<00:42,  2.48s/it]Best trial: 72. Best value: 0.535128:  83%|████████▎ | 83/100 [04:35<00:42,  2.48s/it]Best trial: 72. Best value: 0.535128:  84%|████████▍ | 84/100 [04:35<00:43,  2.74s/it]Best trial: 72. Best value: 0.535128:  84%|████████▍ | 84/100 [04:38<00:43,  2.74s/it]Best trial: 72. Best value: 0.535128:  85%|████████▌ | 85/100 [04:38<00:40,  2.71s/it]Best trial: 72. Best value: 0.535128:  85%|████████▌ | 85/100 [04:40<00:40,  2.71s/it]Best trial: 72. Best value: 0.535128:  86%|████████▌ | 86/100 [04:40<00:37,  2.65s/it]Best trial: 72. Best value: 0.535128:  86%|████████▌ | 86/100 [04:42<00:37,  2.65s/it]Best trial: 72. Best value: 0.535128:  87%|████████▋ | 87/100 [04:42<00:33,  2.57s/it]Best trial: 72. Best value: 0.535128:  87%|████████▋ | 87/100 [04:46<00:33,  2.57s/it]Best trial: 72. Best value: 0.535128:  88%|████████▊ | 88/100 [04:46<00:33,  2.83s/it]Best trial: 72. Best value: 0.535128:  88%|████████▊ | 88/100 [04:48<00:33,  2.83s/it]Best trial: 72. Best value: 0.535128:  89%|████████▉ | 89/100 [04:48<00:30,  2.75s/it]Best trial: 72. Best value: 0.535128:  89%|████████▉ | 89/100 [04:52<00:30,  2.75s/it]Best trial: 72. Best value: 0.535128:  90%|█████████ | 90/100 [04:52<00:29,  2.98s/it]Best trial: 72. Best value: 0.535128:  90%|█████████ | 90/100 [04:56<00:29,  2.98s/it]Best trial: 72. Best value: 0.535128:  91%|█████████ | 91/100 [04:56<00:30,  3.37s/it]Best trial: 72. Best value: 0.535128:  91%|█████████ | 91/100 [04:59<00:30,  3.37s/it]Best trial: 72. Best value: 0.535128:  92%|█████████▏| 92/100 [04:59<00:25,  3.16s/it]Best trial: 72. Best value: 0.535128:  92%|█████████▏| 92/100 [05:01<00:25,  3.16s/it]Best trial: 72. Best value: 0.535128:  93%|█████████▎| 93/100 [05:01<00:20,  2.91s/it]Best trial: 72. Best value: 0.535128:  93%|█████████▎| 93/100 [05:03<00:20,  2.91s/it]Best trial: 72. Best value: 0.535128:  94%|█████████▍| 94/100 [05:03<00:16,  2.69s/it]Best trial: 72. Best value: 0.535128:  94%|█████████▍| 94/100 [05:07<00:16,  2.69s/it]Best trial: 72. Best value: 0.535128:  95%|█████████▌| 95/100 [05:07<00:14,  2.98s/it]Best trial: 72. Best value: 0.535128:  95%|█████████▌| 95/100 [05:11<00:14,  2.98s/it]Best trial: 72. Best value: 0.535128:  96%|█████████▌| 96/100 [05:11<00:12,  3.15s/it]Best trial: 72. Best value: 0.535128:  96%|█████████▌| 96/100 [05:15<00:12,  3.15s/it]Best trial: 72. Best value: 0.535128:  97%|█████████▋| 97/100 [05:15<00:10,  3.40s/it]Best trial: 72. Best value: 0.535128:  97%|█████████▋| 97/100 [05:18<00:10,  3.40s/it]Best trial: 72. Best value: 0.535128:  98%|█████████▊| 98/100 [05:18<00:07,  3.55s/it]Best trial: 72. Best value: 0.535128:  98%|█████████▊| 98/100 [05:21<00:07,  3.55s/it]Best trial: 72. Best value: 0.535128:  99%|█████████▉| 99/100 [05:21<00:03,  3.38s/it]Best trial: 72. Best value: 0.535128:  99%|█████████▉| 99/100 [05:24<00:03,  3.38s/it]Best trial: 72. Best value: 0.535128: 100%|██████████| 100/100 [05:24<00:00,  3.24s/it]Best trial: 72. Best value: 0.535128: 100%|██████████| 100/100 [05:24<00:00,  3.25s/it]
2025-11-30 08:24:49,260 - INFO - HPO Complete. Best AUPRC: 0.5351
2025-11-30 08:24:49,261 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.03820318295957334, 'max_depth': 3, 'subsample': 0.7415380248445007, 'colsample_bytree': 0.6802473107816559, 'gamma': 4.4208535646865075, 'reg_lambda': 0.7502982513770817, 'reg_alpha': 0.010820205947471994}
2025-11-30 08:24:49,262 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:24:51,572 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 08:24:51,573 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:24:51,662 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:24:51,695 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:24:51,705 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:24:51,705 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:24:51,705 - INFO - Training model...
2025-11-30 08:24:52,788 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:24:58,370 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:24:58,370 - INFO - AUROC: 0.7898 (0.6865 - 0.8585)
2025-11-30 08:24:58,370 - INFO - AUPRC: 0.3540 (0.1863 - 0.5242)
2025-11-30 08:24:58,370 - INFO - Brier Score: 0.0560 (0.0467 - 0.0698)
2025-11-30 08:24:58,370 - INFO - Accuracy: 0.9595 (0.9014 - 0.9723)
2025-11-30 08:24:58,370 - INFO - Precision: 0.7500 (0.2597 - 0.9067)
2025-11-30 08:24:58,370 - INFO - Sensitivity (Recall): 0.3333 (0.2329 - 0.5000)
2025-11-30 08:24:58,370 - INFO - F1-Score: 0.4615 (0.2990 - 0.6224)
2025-11-30 08:24:58,370 - INFO - Best Threshold: 0.7500 (0.3640 - 0.8000)
2025-11-30 08:24:58,370 - INFO - Specificity: 0.9939 (0.9288 - 0.9976)
2025-11-30 08:24:58,379 - INFO - Calculating SHAP values...
2025-11-30 08:24:59,342 - INFO - SHAP plots saved.
2025-11-30 08:24:59,342 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:25:00,584 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 08:25:00,584 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:25:00,669 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:25:00,701 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:25:00,708 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:25:00,708 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.456426:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.456426:   1%|          | 1/100 [00:03<06:28,  3.93s/it]Best trial: 1. Best value: 0.483989:   1%|          | 1/100 [00:08<06:28,  3.93s/it]Best trial: 1. Best value: 0.483989:   2%|▏         | 2/100 [00:08<07:01,  4.30s/it]Best trial: 2. Best value: 0.496359:   2%|▏         | 2/100 [00:13<07:01,  4.30s/it]Best trial: 2. Best value: 0.496359:   3%|▎         | 3/100 [00:13<07:06,  4.40s/it]Best trial: 2. Best value: 0.496359:   3%|▎         | 3/100 [00:16<07:06,  4.40s/it]Best trial: 2. Best value: 0.496359:   4%|▍         | 4/100 [00:16<06:12,  3.88s/it]Best trial: 4. Best value: 0.502654:   4%|▍         | 4/100 [00:20<06:12,  3.88s/it]Best trial: 4. Best value: 0.502654:   5%|▌         | 5/100 [00:20<06:36,  4.17s/it]Best trial: 4. Best value: 0.502654:   5%|▌         | 5/100 [00:26<06:36,  4.17s/it]Best trial: 4. Best value: 0.502654:   6%|▌         | 6/100 [00:26<07:10,  4.58s/it]Best trial: 4. Best value: 0.502654:   6%|▌         | 6/100 [00:31<07:10,  4.58s/it]Best trial: 4. Best value: 0.502654:   7%|▋         | 7/100 [00:31<07:21,  4.75s/it]Best trial: 7. Best value: 0.513465:   7%|▋         | 7/100 [00:33<07:21,  4.75s/it]Best trial: 7. Best value: 0.513465:   8%|▊         | 8/100 [00:33<06:08,  4.00s/it]Best trial: 7. Best value: 0.513465:   8%|▊         | 8/100 [00:37<06:08,  4.00s/it]Best trial: 7. Best value: 0.513465:   9%|▉         | 9/100 [00:37<05:46,  3.81s/it]Best trial: 7. Best value: 0.513465:   9%|▉         | 9/100 [00:41<05:46,  3.81s/it]Best trial: 7. Best value: 0.513465:  10%|█         | 10/100 [00:41<06:08,  4.10s/it]Best trial: 10. Best value: 0.517797:  10%|█         | 10/100 [00:43<06:08,  4.10s/it]Best trial: 10. Best value: 0.517797:  11%|█         | 11/100 [00:43<05:13,  3.52s/it]Best trial: 11. Best value: 0.520499:  11%|█         | 11/100 [00:45<05:13,  3.52s/it]Best trial: 11. Best value: 0.520499:  12%|█▏        | 12/100 [00:45<04:27,  3.04s/it]Best trial: 11. Best value: 0.520499:  12%|█▏        | 12/100 [00:48<04:27,  3.04s/it]Best trial: 11. Best value: 0.520499:  13%|█▎        | 13/100 [00:48<04:13,  2.91s/it]Best trial: 11. Best value: 0.520499:  13%|█▎        | 13/100 [00:52<04:13,  2.91s/it]Best trial: 11. Best value: 0.520499:  14%|█▍        | 14/100 [00:52<04:38,  3.24s/it]Best trial: 11. Best value: 0.520499:  14%|█▍        | 14/100 [00:55<04:38,  3.24s/it]Best trial: 11. Best value: 0.520499:  15%|█▌        | 15/100 [00:55<04:32,  3.21s/it]Best trial: 11. Best value: 0.520499:  15%|█▌        | 15/100 [00:58<04:32,  3.21s/it]Best trial: 11. Best value: 0.520499:  16%|█▌        | 16/100 [00:58<04:07,  2.95s/it]Best trial: 11. Best value: 0.520499:  16%|█▌        | 16/100 [01:01<04:07,  2.95s/it]Best trial: 11. Best value: 0.520499:  17%|█▋        | 17/100 [01:01<04:10,  3.01s/it]Best trial: 11. Best value: 0.520499:  17%|█▋        | 17/100 [01:05<04:10,  3.01s/it]Best trial: 11. Best value: 0.520499:  18%|█▊        | 18/100 [01:05<04:48,  3.51s/it]Best trial: 11. Best value: 0.520499:  18%|█▊        | 18/100 [01:09<04:48,  3.51s/it]Best trial: 11. Best value: 0.520499:  19%|█▉        | 19/100 [01:09<04:43,  3.50s/it]Best trial: 11. Best value: 0.520499:  19%|█▉        | 19/100 [01:12<04:43,  3.50s/it]Best trial: 11. Best value: 0.520499:  20%|██        | 20/100 [01:12<04:41,  3.52s/it]Best trial: 11. Best value: 0.520499:  20%|██        | 20/100 [01:16<04:41,  3.52s/it]Best trial: 11. Best value: 0.520499:  21%|██        | 21/100 [01:16<04:43,  3.59s/it]Best trial: 11. Best value: 0.520499:  21%|██        | 21/100 [01:20<04:43,  3.59s/it]Best trial: 11. Best value: 0.520499:  22%|██▏       | 22/100 [01:20<04:43,  3.63s/it]Best trial: 11. Best value: 0.520499:  22%|██▏       | 22/100 [01:23<04:43,  3.63s/it]Best trial: 11. Best value: 0.520499:  23%|██▎       | 23/100 [01:23<04:20,  3.38s/it]Best trial: 11. Best value: 0.520499:  23%|██▎       | 23/100 [01:26<04:20,  3.38s/it]Best trial: 11. Best value: 0.520499:  24%|██▍       | 24/100 [01:26<04:12,  3.32s/it]Best trial: 11. Best value: 0.520499:  24%|██▍       | 24/100 [01:31<04:12,  3.32s/it]Best trial: 11. Best value: 0.520499:  25%|██▌       | 25/100 [01:31<05:00,  4.01s/it]Best trial: 11. Best value: 0.520499:  25%|██▌       | 25/100 [01:34<05:00,  4.01s/it]Best trial: 11. Best value: 0.520499:  26%|██▌       | 26/100 [01:34<04:15,  3.45s/it]Best trial: 11. Best value: 0.520499:  26%|██▌       | 26/100 [01:36<04:15,  3.45s/it]Best trial: 11. Best value: 0.520499:  27%|██▋       | 27/100 [01:36<03:53,  3.20s/it]Best trial: 11. Best value: 0.520499:  27%|██▋       | 27/100 [01:39<03:53,  3.20s/it]Best trial: 11. Best value: 0.520499:  28%|██▊       | 28/100 [01:39<03:46,  3.15s/it]Best trial: 11. Best value: 0.520499:  28%|██▊       | 28/100 [01:42<03:46,  3.15s/it]Best trial: 11. Best value: 0.520499:  29%|██▉       | 29/100 [01:42<03:26,  2.91s/it]Best trial: 11. Best value: 0.520499:  29%|██▉       | 29/100 [01:44<03:26,  2.91s/it]Best trial: 11. Best value: 0.520499:  30%|███       | 30/100 [01:44<03:15,  2.79s/it]Best trial: 11. Best value: 0.520499:  30%|███       | 30/100 [01:46<03:15,  2.79s/it]Best trial: 11. Best value: 0.520499:  31%|███       | 31/100 [01:46<02:58,  2.59s/it]Best trial: 11. Best value: 0.520499:  31%|███       | 31/100 [01:50<02:58,  2.59s/it]Best trial: 11. Best value: 0.520499:  32%|███▏      | 32/100 [01:50<03:15,  2.87s/it]Best trial: 11. Best value: 0.520499:  32%|███▏      | 32/100 [01:54<03:15,  2.87s/it]Best trial: 11. Best value: 0.520499:  33%|███▎      | 33/100 [01:54<03:44,  3.34s/it]Best trial: 11. Best value: 0.520499:  33%|███▎      | 33/100 [01:58<03:44,  3.34s/it]Best trial: 11. Best value: 0.520499:  34%|███▍      | 34/100 [01:58<03:50,  3.49s/it]Best trial: 11. Best value: 0.520499:  34%|███▍      | 34/100 [02:01<03:50,  3.49s/it]Best trial: 11. Best value: 0.520499:  35%|███▌      | 35/100 [02:01<03:28,  3.20s/it]Best trial: 11. Best value: 0.520499:  35%|███▌      | 35/100 [02:04<03:28,  3.20s/it]Best trial: 11. Best value: 0.520499:  36%|███▌      | 36/100 [02:04<03:21,  3.15s/it]Best trial: 11. Best value: 0.520499:  36%|███▌      | 36/100 [02:06<03:21,  3.15s/it]Best trial: 11. Best value: 0.520499:  37%|███▋      | 37/100 [02:06<03:12,  3.06s/it]Best trial: 11. Best value: 0.520499:  37%|███▋      | 37/100 [02:11<03:12,  3.06s/it]Best trial: 11. Best value: 0.520499:  38%|███▊      | 38/100 [02:11<03:43,  3.61s/it]Best trial: 11. Best value: 0.520499:  38%|███▊      | 38/100 [02:14<03:43,  3.61s/it]Best trial: 11. Best value: 0.520499:  39%|███▉      | 39/100 [02:14<03:21,  3.31s/it]Best trial: 11. Best value: 0.520499:  39%|███▉      | 39/100 [02:16<03:21,  3.31s/it]Best trial: 11. Best value: 0.520499:  40%|████      | 40/100 [02:16<03:00,  3.00s/it]Best trial: 11. Best value: 0.520499:  40%|████      | 40/100 [02:19<03:00,  3.00s/it]Best trial: 11. Best value: 0.520499:  41%|████      | 41/100 [02:19<02:48,  2.86s/it]Best trial: 11. Best value: 0.520499:  41%|████      | 41/100 [02:22<02:48,  2.86s/it]Best trial: 11. Best value: 0.520499:  42%|████▏     | 42/100 [02:22<02:43,  2.82s/it]Best trial: 11. Best value: 0.520499:  42%|████▏     | 42/100 [02:24<02:43,  2.82s/it]Best trial: 11. Best value: 0.520499:  43%|████▎     | 43/100 [02:24<02:33,  2.69s/it]Best trial: 11. Best value: 0.520499:  43%|████▎     | 43/100 [02:26<02:33,  2.69s/it]Best trial: 11. Best value: 0.520499:  44%|████▍     | 44/100 [02:26<02:29,  2.66s/it]Best trial: 11. Best value: 0.520499:  44%|████▍     | 44/100 [02:31<02:29,  2.66s/it]Best trial: 11. Best value: 0.520499:  45%|████▌     | 45/100 [02:31<02:57,  3.23s/it]Best trial: 11. Best value: 0.520499:  45%|████▌     | 45/100 [02:34<02:57,  3.23s/it]Best trial: 11. Best value: 0.520499:  46%|████▌     | 46/100 [02:34<02:53,  3.22s/it]Best trial: 11. Best value: 0.520499:  46%|████▌     | 46/100 [02:40<02:53,  3.22s/it]Best trial: 11. Best value: 0.520499:  47%|████▋     | 47/100 [02:40<03:23,  3.85s/it]Best trial: 11. Best value: 0.520499:  47%|████▋     | 47/100 [02:42<03:23,  3.85s/it]Best trial: 11. Best value: 0.520499:  48%|████▊     | 48/100 [02:42<03:01,  3.49s/it]Best trial: 11. Best value: 0.520499:  48%|████▊     | 48/100 [02:45<03:01,  3.49s/it]Best trial: 11. Best value: 0.520499:  49%|████▉     | 49/100 [02:45<02:46,  3.27s/it]Best trial: 11. Best value: 0.520499:  49%|████▉     | 49/100 [02:48<02:46,  3.27s/it]Best trial: 11. Best value: 0.520499:  50%|█████     | 50/100 [02:48<02:34,  3.09s/it]Best trial: 11. Best value: 0.520499:  50%|█████     | 50/100 [02:51<02:34,  3.09s/it]Best trial: 11. Best value: 0.520499:  51%|█████     | 51/100 [02:51<02:33,  3.14s/it]Best trial: 11. Best value: 0.520499:  51%|█████     | 51/100 [02:53<02:33,  3.14s/it]Best trial: 11. Best value: 0.520499:  52%|█████▏    | 52/100 [02:53<02:22,  2.96s/it]Best trial: 11. Best value: 0.520499:  52%|█████▏    | 52/100 [02:56<02:22,  2.96s/it]Best trial: 11. Best value: 0.520499:  53%|█████▎    | 53/100 [02:56<02:09,  2.75s/it]Best trial: 11. Best value: 0.520499:  53%|█████▎    | 53/100 [02:59<02:09,  2.75s/it]Best trial: 11. Best value: 0.520499:  54%|█████▍    | 54/100 [02:59<02:07,  2.78s/it]Best trial: 54. Best value: 0.524478:  54%|█████▍    | 54/100 [03:01<02:07,  2.78s/it]Best trial: 54. Best value: 0.524478:  55%|█████▌    | 55/100 [03:01<01:59,  2.66s/it]Best trial: 54. Best value: 0.524478:  55%|█████▌    | 55/100 [03:04<01:59,  2.66s/it]Best trial: 54. Best value: 0.524478:  56%|█████▌    | 56/100 [03:04<02:06,  2.88s/it]Best trial: 54. Best value: 0.524478:  56%|█████▌    | 56/100 [03:07<02:06,  2.88s/it]Best trial: 54. Best value: 0.524478:  57%|█████▋    | 57/100 [03:07<01:58,  2.76s/it]Best trial: 54. Best value: 0.524478:  57%|█████▋    | 57/100 [03:11<01:58,  2.76s/it]Best trial: 54. Best value: 0.524478:  58%|█████▊    | 58/100 [03:11<02:09,  3.09s/it]Best trial: 54. Best value: 0.524478:  58%|█████▊    | 58/100 [03:13<02:09,  3.09s/it]Best trial: 54. Best value: 0.524478:  59%|█████▉    | 59/100 [03:13<01:55,  2.82s/it]Best trial: 54. Best value: 0.524478:  59%|█████▉    | 59/100 [03:17<01:55,  2.82s/it]Best trial: 54. Best value: 0.524478:  60%|██████    | 60/100 [03:17<02:06,  3.16s/it]Best trial: 54. Best value: 0.524478:  60%|██████    | 60/100 [03:20<02:06,  3.16s/it]Best trial: 54. Best value: 0.524478:  61%|██████    | 61/100 [03:20<02:07,  3.27s/it]Best trial: 54. Best value: 0.524478:  61%|██████    | 61/100 [03:23<02:07,  3.27s/it]Best trial: 54. Best value: 0.524478:  62%|██████▏   | 62/100 [03:23<01:53,  2.98s/it]Best trial: 54. Best value: 0.524478:  62%|██████▏   | 62/100 [03:25<01:53,  2.98s/it]Best trial: 54. Best value: 0.524478:  63%|██████▎   | 63/100 [03:25<01:44,  2.82s/it]Best trial: 54. Best value: 0.524478:  63%|██████▎   | 63/100 [03:27<01:44,  2.82s/it]Best trial: 54. Best value: 0.524478:  64%|██████▍   | 64/100 [03:27<01:37,  2.70s/it]Best trial: 54. Best value: 0.524478:  64%|██████▍   | 64/100 [03:31<01:37,  2.70s/it]Best trial: 54. Best value: 0.524478:  65%|██████▌   | 65/100 [03:31<01:43,  2.94s/it]Best trial: 54. Best value: 0.524478:  65%|██████▌   | 65/100 [03:34<01:43,  2.94s/it]Best trial: 54. Best value: 0.524478:  66%|██████▌   | 66/100 [03:34<01:36,  2.83s/it]Best trial: 54. Best value: 0.524478:  66%|██████▌   | 66/100 [03:36<01:36,  2.83s/it]Best trial: 54. Best value: 0.524478:  67%|██████▋   | 67/100 [03:36<01:28,  2.69s/it]Best trial: 54. Best value: 0.524478:  67%|██████▋   | 67/100 [03:41<01:28,  2.69s/it]Best trial: 54. Best value: 0.524478:  68%|██████▊   | 68/100 [03:41<01:47,  3.35s/it]Best trial: 54. Best value: 0.524478:  68%|██████▊   | 68/100 [03:44<01:47,  3.35s/it]Best trial: 54. Best value: 0.524478:  69%|██████▉   | 69/100 [03:44<01:43,  3.33s/it]Best trial: 54. Best value: 0.524478:  69%|██████▉   | 69/100 [03:50<01:43,  3.33s/it]Best trial: 54. Best value: 0.524478:  70%|███████   | 70/100 [03:50<01:59,  3.98s/it]Best trial: 54. Best value: 0.524478:  70%|███████   | 70/100 [03:52<01:59,  3.98s/it]Best trial: 54. Best value: 0.524478:  71%|███████   | 71/100 [03:52<01:42,  3.53s/it]Best trial: 54. Best value: 0.524478:  71%|███████   | 71/100 [03:54<01:42,  3.53s/it]Best trial: 54. Best value: 0.524478:  72%|███████▏  | 72/100 [03:54<01:27,  3.11s/it]Best trial: 54. Best value: 0.524478:  72%|███████▏  | 72/100 [03:57<01:27,  3.11s/it]Best trial: 54. Best value: 0.524478:  73%|███████▎  | 73/100 [03:57<01:19,  2.96s/it]Best trial: 54. Best value: 0.524478:  73%|███████▎  | 73/100 [03:59<01:19,  2.96s/it]Best trial: 54. Best value: 0.524478:  74%|███████▍  | 74/100 [03:59<01:12,  2.80s/it]Best trial: 54. Best value: 0.524478:  74%|███████▍  | 74/100 [04:02<01:12,  2.80s/it]Best trial: 54. Best value: 0.524478:  75%|███████▌  | 75/100 [04:02<01:08,  2.73s/it]Best trial: 54. Best value: 0.524478:  75%|███████▌  | 75/100 [04:05<01:08,  2.73s/it]Best trial: 54. Best value: 0.524478:  76%|███████▌  | 76/100 [04:05<01:05,  2.73s/it]Best trial: 54. Best value: 0.524478:  76%|███████▌  | 76/100 [04:08<01:05,  2.73s/it]Best trial: 54. Best value: 0.524478:  77%|███████▋  | 77/100 [04:08<01:06,  2.90s/it]Best trial: 54. Best value: 0.524478:  77%|███████▋  | 77/100 [04:13<01:06,  2.90s/it]Best trial: 54. Best value: 0.524478:  78%|███████▊  | 78/100 [04:13<01:17,  3.53s/it]Best trial: 54. Best value: 0.524478:  78%|███████▊  | 78/100 [04:16<01:17,  3.53s/it]Best trial: 54. Best value: 0.524478:  79%|███████▉  | 79/100 [04:16<01:11,  3.42s/it]Best trial: 54. Best value: 0.524478:  79%|███████▉  | 79/100 [04:20<01:11,  3.42s/it]Best trial: 54. Best value: 0.524478:  80%|████████  | 80/100 [04:20<01:11,  3.56s/it]Best trial: 54. Best value: 0.524478:  80%|████████  | 80/100 [04:22<01:11,  3.56s/it]Best trial: 54. Best value: 0.524478:  81%|████████  | 81/100 [04:22<01:00,  3.20s/it]Best trial: 54. Best value: 0.524478:  81%|████████  | 81/100 [04:25<01:00,  3.20s/it]Best trial: 54. Best value: 0.524478:  82%|████████▏ | 82/100 [04:25<00:53,  2.99s/it]Best trial: 54. Best value: 0.524478:  82%|████████▏ | 82/100 [04:27<00:53,  2.99s/it]Best trial: 54. Best value: 0.524478:  83%|████████▎ | 83/100 [04:27<00:48,  2.85s/it]Best trial: 54. Best value: 0.524478:  83%|████████▎ | 83/100 [04:30<00:48,  2.85s/it]Best trial: 54. Best value: 0.524478:  84%|████████▍ | 84/100 [04:30<00:45,  2.84s/it]Best trial: 54. Best value: 0.524478:  84%|████████▍ | 84/100 [04:34<00:45,  2.84s/it]Best trial: 54. Best value: 0.524478:  85%|████████▌ | 85/100 [04:34<00:47,  3.16s/it]Best trial: 54. Best value: 0.524478:  85%|████████▌ | 85/100 [04:36<00:47,  3.16s/it]Best trial: 54. Best value: 0.524478:  86%|████████▌ | 86/100 [04:36<00:40,  2.90s/it]Best trial: 54. Best value: 0.524478:  86%|████████▌ | 86/100 [04:39<00:40,  2.90s/it]Best trial: 54. Best value: 0.524478:  87%|████████▋ | 87/100 [04:39<00:37,  2.85s/it]Best trial: 54. Best value: 0.524478:  87%|████████▋ | 87/100 [04:42<00:37,  2.85s/it]Best trial: 54. Best value: 0.524478:  88%|████████▊ | 88/100 [04:42<00:35,  2.97s/it]Best trial: 54. Best value: 0.524478:  88%|████████▊ | 88/100 [04:45<00:35,  2.97s/it]Best trial: 54. Best value: 0.524478:  89%|████████▉ | 89/100 [04:45<00:30,  2.82s/it]Best trial: 54. Best value: 0.524478:  89%|████████▉ | 89/100 [04:47<00:30,  2.82s/it]Best trial: 54. Best value: 0.524478:  90%|█████████ | 90/100 [04:47<00:27,  2.71s/it]Best trial: 54. Best value: 0.524478:  90%|█████████ | 90/100 [04:50<00:27,  2.71s/it]Best trial: 54. Best value: 0.524478:  91%|█████████ | 91/100 [04:50<00:23,  2.66s/it]Best trial: 54. Best value: 0.524478:  91%|█████████ | 91/100 [04:52<00:23,  2.66s/it]Best trial: 54. Best value: 0.524478:  92%|█████████▏| 92/100 [04:52<00:21,  2.65s/it]Best trial: 54. Best value: 0.524478:  92%|█████████▏| 92/100 [04:55<00:21,  2.65s/it]Best trial: 54. Best value: 0.524478:  93%|█████████▎| 93/100 [04:55<00:18,  2.67s/it]Best trial: 54. Best value: 0.524478:  93%|█████████▎| 93/100 [04:58<00:18,  2.67s/it]Best trial: 54. Best value: 0.524478:  94%|█████████▍| 94/100 [04:58<00:16,  2.71s/it]Best trial: 54. Best value: 0.524478:  94%|█████████▍| 94/100 [05:01<00:16,  2.71s/it]Best trial: 54. Best value: 0.524478:  95%|█████████▌| 95/100 [05:01<00:14,  2.92s/it]Best trial: 54. Best value: 0.524478:  95%|█████████▌| 95/100 [05:04<00:14,  2.92s/it]Best trial: 54. Best value: 0.524478:  96%|█████████▌| 96/100 [05:04<00:11,  2.94s/it]Best trial: 54. Best value: 0.524478:  96%|█████████▌| 96/100 [05:08<00:11,  2.94s/it]Best trial: 54. Best value: 0.524478:  97%|█████████▋| 97/100 [05:08<00:09,  3.14s/it]Best trial: 54. Best value: 0.524478:  97%|█████████▋| 97/100 [05:11<00:09,  3.14s/it]Best trial: 54. Best value: 0.524478:  98%|█████████▊| 98/100 [05:11<00:06,  3.01s/it]Best trial: 54. Best value: 0.524478:  98%|█████████▊| 98/100 [05:13<00:06,  3.01s/it]Best trial: 54. Best value: 0.524478:  99%|█████████▉| 99/100 [05:13<00:02,  2.90s/it]Best trial: 54. Best value: 0.524478:  99%|█████████▉| 99/100 [05:17<00:02,  2.90s/it]Best trial: 54. Best value: 0.524478: 100%|██████████| 100/100 [05:17<00:00,  3.20s/it]Best trial: 54. Best value: 0.524478: 100%|██████████| 100/100 [05:17<00:00,  3.18s/it]
2025-11-30 08:30:18,344 - INFO - HPO Complete. Best AUPRC: 0.5245
2025-11-30 08:30:18,344 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.00016923892781096217, 'max_depth': 3, 'subsample': 0.7526433249409942, 'colsample_bytree': 0.6154731508427467, 'gamma': 3.908544189536858, 'reg_lambda': 8.273754995055436e-06, 'reg_alpha': 0.9882451235897434}
2025-11-30 08:30:18,345 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:30:20,289 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 08:30:20,289 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:30:20,376 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:30:20,408 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:30:20,418 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:30:20,418 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:30:20,418 - INFO - Training model...
2025-11-30 08:30:22,165 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:30:27,579 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:30:27,579 - INFO - AUROC: 0.7993 (0.7049 - 0.8557)
2025-11-30 08:30:27,580 - INFO - AUPRC: 0.4003 (0.2998 - 0.5437)
2025-11-30 08:30:27,580 - INFO - Brier Score: 0.2359 (0.2353 - 0.2369)
2025-11-30 08:30:27,580 - INFO - Accuracy: 0.9509 (0.9098 - 0.9688)
2025-11-30 08:30:27,580 - INFO - Precision: 0.5357 (0.2822 - 0.8921)
2025-11-30 08:30:27,580 - INFO - Sensitivity (Recall): 0.4167 (0.2927 - 0.5613)
2025-11-30 08:30:27,580 - INFO - F1-Score: 0.4688 (0.3345 - 0.6126)
2025-11-30 08:30:27,580 - INFO - Best Threshold: 0.5100 (0.5000 - 0.5200)
2025-11-30 08:30:27,580 - INFO - Specificity: 0.9802 (0.9347 - 0.9976)
2025-11-30 08:30:27,590 - INFO - Calculating SHAP values...
2025-11-30 08:30:28,566 - INFO - SHAP plots saved.
2025-11-30 08:30:28,567 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:30:29,864 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 08:30:29,865 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:30:29,969 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:30:30,003 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:30:30,012 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:30:30,012 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.477503:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.477503:   1%|          | 1/100 [00:06<10:40,  6.47s/it]Best trial: 1. Best value: 0.48747:   1%|          | 1/100 [00:11<10:40,  6.47s/it] Best trial: 1. Best value: 0.48747:   2%|▏         | 2/100 [00:11<08:42,  5.33s/it]Best trial: 1. Best value: 0.48747:   2%|▏         | 2/100 [00:15<08:42,  5.33s/it]Best trial: 1. Best value: 0.48747:   3%|▎         | 3/100 [00:15<08:19,  5.15s/it]Best trial: 1. Best value: 0.48747:   3%|▎         | 3/100 [00:18<08:19,  5.15s/it]Best trial: 1. Best value: 0.48747:   4%|▍         | 4/100 [00:18<06:40,  4.17s/it]Best trial: 1. Best value: 0.48747:   4%|▍         | 4/100 [00:22<06:40,  4.17s/it]Best trial: 1. Best value: 0.48747:   5%|▌         | 5/100 [00:22<06:29,  4.11s/it]Best trial: 1. Best value: 0.48747:   5%|▌         | 5/100 [00:26<06:29,  4.11s/it]Best trial: 1. Best value: 0.48747:   6%|▌         | 6/100 [00:26<06:20,  4.05s/it]Best trial: 1. Best value: 0.48747:   6%|▌         | 6/100 [00:32<06:20,  4.05s/it]Best trial: 1. Best value: 0.48747:   7%|▋         | 7/100 [00:32<07:16,  4.70s/it]Best trial: 1. Best value: 0.48747:   7%|▋         | 7/100 [00:35<07:16,  4.70s/it]Best trial: 1. Best value: 0.48747:   8%|▊         | 8/100 [00:35<06:23,  4.17s/it]Best trial: 1. Best value: 0.48747:   8%|▊         | 8/100 [00:39<06:23,  4.17s/it]Best trial: 1. Best value: 0.48747:   9%|▉         | 9/100 [00:39<05:59,  3.95s/it]Best trial: 9. Best value: 0.491907:   9%|▉         | 9/100 [00:44<05:59,  3.95s/it]Best trial: 9. Best value: 0.491907:  10%|█         | 10/100 [00:44<06:41,  4.46s/it]Best trial: 10. Best value: 0.501823:  10%|█         | 10/100 [00:48<06:41,  4.46s/it]Best trial: 10. Best value: 0.501823:  11%|█         | 11/100 [00:48<06:27,  4.35s/it]Best trial: 11. Best value: 0.512109:  11%|█         | 11/100 [00:52<06:27,  4.35s/it]Best trial: 11. Best value: 0.512109:  12%|█▏        | 12/100 [00:52<05:55,  4.04s/it]Best trial: 11. Best value: 0.512109:  12%|█▏        | 12/100 [00:55<05:55,  4.04s/it]Best trial: 11. Best value: 0.512109:  13%|█▎        | 13/100 [00:55<05:26,  3.76s/it]Best trial: 13. Best value: 0.512576:  13%|█▎        | 13/100 [00:59<05:26,  3.76s/it]Best trial: 13. Best value: 0.512576:  14%|█▍        | 14/100 [00:59<05:24,  3.78s/it]Best trial: 14. Best value: 0.512899:  14%|█▍        | 14/100 [01:02<05:24,  3.78s/it]Best trial: 14. Best value: 0.512899:  15%|█▌        | 15/100 [01:02<05:11,  3.66s/it]Best trial: 14. Best value: 0.512899:  15%|█▌        | 15/100 [01:07<05:11,  3.66s/it]Best trial: 14. Best value: 0.512899:  16%|█▌        | 16/100 [01:07<05:49,  4.17s/it]Best trial: 14. Best value: 0.512899:  16%|█▌        | 16/100 [01:10<05:49,  4.17s/it]Best trial: 14. Best value: 0.512899:  17%|█▋        | 17/100 [01:10<05:16,  3.82s/it]Best trial: 14. Best value: 0.512899:  17%|█▋        | 17/100 [01:15<05:16,  3.82s/it]Best trial: 14. Best value: 0.512899:  18%|█▊        | 18/100 [01:15<05:34,  4.08s/it]Best trial: 14. Best value: 0.512899:  18%|█▊        | 18/100 [01:18<05:34,  4.08s/it]Best trial: 14. Best value: 0.512899:  19%|█▉        | 19/100 [01:18<05:09,  3.82s/it]Best trial: 14. Best value: 0.512899:  19%|█▉        | 19/100 [01:21<05:09,  3.82s/it]Best trial: 14. Best value: 0.512899:  20%|██        | 20/100 [01:21<04:43,  3.54s/it]Best trial: 14. Best value: 0.512899:  20%|██        | 20/100 [01:24<04:43,  3.54s/it]Best trial: 14. Best value: 0.512899:  21%|██        | 21/100 [01:24<04:32,  3.46s/it]Best trial: 14. Best value: 0.512899:  21%|██        | 21/100 [01:28<04:32,  3.46s/it]Best trial: 14. Best value: 0.512899:  22%|██▏       | 22/100 [01:28<04:28,  3.44s/it]Best trial: 14. Best value: 0.512899:  22%|██▏       | 22/100 [01:31<04:28,  3.44s/it]Best trial: 14. Best value: 0.512899:  23%|██▎       | 23/100 [01:31<04:22,  3.41s/it]Best trial: 14. Best value: 0.512899:  23%|██▎       | 23/100 [01:34<04:22,  3.41s/it]Best trial: 14. Best value: 0.512899:  24%|██▍       | 24/100 [01:34<04:11,  3.31s/it]Best trial: 14. Best value: 0.512899:  24%|██▍       | 24/100 [01:37<04:11,  3.31s/it]Best trial: 14. Best value: 0.512899:  25%|██▌       | 25/100 [01:37<04:05,  3.27s/it]Best trial: 14. Best value: 0.512899:  25%|██▌       | 25/100 [01:40<04:05,  3.27s/it]Best trial: 14. Best value: 0.512899:  26%|██▌       | 26/100 [01:40<03:47,  3.07s/it]Best trial: 26. Best value: 0.514171:  26%|██▌       | 26/100 [01:44<03:47,  3.07s/it]Best trial: 26. Best value: 0.514171:  27%|██▋       | 27/100 [01:44<03:59,  3.28s/it]Best trial: 26. Best value: 0.514171:  27%|██▋       | 27/100 [01:48<03:59,  3.28s/it]Best trial: 26. Best value: 0.514171:  28%|██▊       | 28/100 [01:48<04:09,  3.46s/it]Best trial: 26. Best value: 0.514171:  28%|██▊       | 28/100 [01:51<04:09,  3.46s/it]Best trial: 26. Best value: 0.514171:  29%|██▉       | 29/100 [01:51<04:00,  3.38s/it]Best trial: 26. Best value: 0.514171:  29%|██▉       | 29/100 [01:53<04:00,  3.38s/it]Best trial: 26. Best value: 0.514171:  30%|███       | 30/100 [01:53<03:41,  3.16s/it]Best trial: 26. Best value: 0.514171:  30%|███       | 30/100 [01:57<03:41,  3.16s/it]Best trial: 26. Best value: 0.514171:  31%|███       | 31/100 [01:57<03:45,  3.26s/it]Best trial: 26. Best value: 0.514171:  31%|███       | 31/100 [02:01<03:45,  3.26s/it]Best trial: 26. Best value: 0.514171:  32%|███▏      | 32/100 [02:01<04:05,  3.62s/it]Best trial: 32. Best value: 0.514711:  32%|███▏      | 32/100 [02:06<04:05,  3.62s/it]Best trial: 32. Best value: 0.514711:  33%|███▎      | 33/100 [02:06<04:20,  3.88s/it]Best trial: 32. Best value: 0.514711:  33%|███▎      | 33/100 [02:13<04:20,  3.88s/it]Best trial: 32. Best value: 0.514711:  34%|███▍      | 34/100 [02:13<05:19,  4.85s/it]Best trial: 32. Best value: 0.514711:  34%|███▍      | 34/100 [02:16<05:19,  4.85s/it]Best trial: 32. Best value: 0.514711:  35%|███▌      | 35/100 [02:16<04:34,  4.22s/it]Best trial: 32. Best value: 0.514711:  35%|███▌      | 35/100 [02:20<04:34,  4.22s/it]Best trial: 32. Best value: 0.514711:  36%|███▌      | 36/100 [02:20<04:38,  4.36s/it]Best trial: 32. Best value: 0.514711:  36%|███▌      | 36/100 [02:23<04:38,  4.36s/it]Best trial: 32. Best value: 0.514711:  37%|███▋      | 37/100 [02:23<04:00,  3.81s/it]Best trial: 32. Best value: 0.514711:  37%|███▋      | 37/100 [02:28<04:00,  3.81s/it]Best trial: 32. Best value: 0.514711:  38%|███▊      | 38/100 [02:28<04:14,  4.10s/it]Best trial: 32. Best value: 0.514711:  38%|███▊      | 38/100 [02:33<04:14,  4.10s/it]Best trial: 32. Best value: 0.514711:  39%|███▉      | 39/100 [02:33<04:22,  4.31s/it]Best trial: 32. Best value: 0.514711:  39%|███▉      | 39/100 [02:37<04:22,  4.31s/it]Best trial: 32. Best value: 0.514711:  40%|████      | 40/100 [02:37<04:24,  4.41s/it]Best trial: 32. Best value: 0.514711:  40%|████      | 40/100 [02:41<04:24,  4.41s/it]Best trial: 32. Best value: 0.514711:  41%|████      | 41/100 [02:41<04:10,  4.24s/it]Best trial: 32. Best value: 0.514711:  41%|████      | 41/100 [02:45<04:10,  4.24s/it]Best trial: 32. Best value: 0.514711:  42%|████▏     | 42/100 [02:45<03:55,  4.05s/it]Best trial: 32. Best value: 0.514711:  42%|████▏     | 42/100 [02:49<03:55,  4.05s/it]Best trial: 32. Best value: 0.514711:  43%|████▎     | 43/100 [02:49<03:58,  4.18s/it]Best trial: 32. Best value: 0.514711:  43%|████▎     | 43/100 [02:52<03:58,  4.18s/it]Best trial: 32. Best value: 0.514711:  44%|████▍     | 44/100 [02:52<03:35,  3.84s/it]Best trial: 32. Best value: 0.514711:  44%|████▍     | 44/100 [02:56<03:35,  3.84s/it]Best trial: 32. Best value: 0.514711:  45%|████▌     | 45/100 [02:56<03:37,  3.95s/it]Best trial: 32. Best value: 0.514711:  45%|████▌     | 45/100 [03:01<03:37,  3.95s/it]Best trial: 32. Best value: 0.514711:  46%|████▌     | 46/100 [03:01<03:46,  4.20s/it]Best trial: 32. Best value: 0.514711:  46%|████▌     | 46/100 [03:04<03:46,  4.20s/it]Best trial: 32. Best value: 0.514711:  47%|████▋     | 47/100 [03:04<03:28,  3.94s/it]Best trial: 32. Best value: 0.514711:  47%|████▋     | 47/100 [03:08<03:28,  3.94s/it]Best trial: 32. Best value: 0.514711:  48%|████▊     | 48/100 [03:08<03:19,  3.84s/it]Best trial: 32. Best value: 0.514711:  48%|████▊     | 48/100 [03:13<03:19,  3.84s/it]Best trial: 32. Best value: 0.514711:  49%|████▉     | 49/100 [03:13<03:37,  4.26s/it]Best trial: 32. Best value: 0.514711:  49%|████▉     | 49/100 [03:18<03:37,  4.26s/it]Best trial: 32. Best value: 0.514711:  50%|█████     | 50/100 [03:18<03:46,  4.53s/it]Best trial: 32. Best value: 0.514711:  50%|█████     | 50/100 [03:21<03:46,  4.53s/it]Best trial: 32. Best value: 0.514711:  51%|█████     | 51/100 [03:21<03:17,  4.04s/it]Best trial: 51. Best value: 0.526879:  51%|█████     | 51/100 [03:25<03:17,  4.04s/it]Best trial: 51. Best value: 0.526879:  52%|█████▏    | 52/100 [03:25<03:09,  3.95s/it]Best trial: 51. Best value: 0.526879:  52%|█████▏    | 52/100 [03:32<03:09,  3.95s/it]Best trial: 51. Best value: 0.526879:  53%|█████▎    | 53/100 [03:32<03:45,  4.79s/it]Best trial: 51. Best value: 0.526879:  53%|█████▎    | 53/100 [03:37<03:45,  4.79s/it]Best trial: 51. Best value: 0.526879:  54%|█████▍    | 54/100 [03:37<03:46,  4.92s/it]Best trial: 51. Best value: 0.526879:  54%|█████▍    | 54/100 [03:41<03:46,  4.92s/it]Best trial: 51. Best value: 0.526879:  55%|█████▌    | 55/100 [03:41<03:30,  4.68s/it]Best trial: 51. Best value: 0.526879:  55%|█████▌    | 55/100 [03:44<03:30,  4.68s/it]Best trial: 51. Best value: 0.526879:  56%|█████▌    | 56/100 [03:44<03:00,  4.11s/it]Best trial: 51. Best value: 0.526879:  56%|█████▌    | 56/100 [03:48<03:00,  4.11s/it]Best trial: 51. Best value: 0.526879:  57%|█████▋    | 57/100 [03:48<02:58,  4.15s/it]Best trial: 51. Best value: 0.526879:  57%|█████▋    | 57/100 [03:52<02:58,  4.15s/it]Best trial: 51. Best value: 0.526879:  58%|█████▊    | 58/100 [03:52<02:48,  4.01s/it]Best trial: 51. Best value: 0.526879:  58%|█████▊    | 58/100 [03:56<02:48,  4.01s/it]Best trial: 51. Best value: 0.526879:  59%|█████▉    | 59/100 [03:56<02:47,  4.09s/it]Best trial: 51. Best value: 0.526879:  59%|█████▉    | 59/100 [03:59<02:47,  4.09s/it]Best trial: 51. Best value: 0.526879:  60%|██████    | 60/100 [03:59<02:32,  3.81s/it]Best trial: 51. Best value: 0.526879:  60%|██████    | 60/100 [04:07<02:32,  3.81s/it]Best trial: 51. Best value: 0.526879:  61%|██████    | 61/100 [04:07<03:08,  4.84s/it]Best trial: 51. Best value: 0.526879:  61%|██████    | 61/100 [04:10<03:08,  4.84s/it]Best trial: 51. Best value: 0.526879:  62%|██████▏   | 62/100 [04:10<02:44,  4.33s/it]Best trial: 51. Best value: 0.526879:  62%|██████▏   | 62/100 [04:15<02:44,  4.33s/it]Best trial: 51. Best value: 0.526879:  63%|██████▎   | 63/100 [04:15<02:51,  4.64s/it]Best trial: 51. Best value: 0.526879:  63%|██████▎   | 63/100 [04:19<02:51,  4.64s/it]Best trial: 51. Best value: 0.526879:  64%|██████▍   | 64/100 [04:19<02:38,  4.41s/it]Best trial: 51. Best value: 0.526879:  64%|██████▍   | 64/100 [04:23<02:38,  4.41s/it]Best trial: 51. Best value: 0.526879:  65%|██████▌   | 65/100 [04:23<02:28,  4.25s/it]Best trial: 51. Best value: 0.526879:  65%|██████▌   | 65/100 [04:26<02:28,  4.25s/it]Best trial: 51. Best value: 0.526879:  66%|██████▌   | 66/100 [04:26<02:11,  3.86s/it]Best trial: 51. Best value: 0.526879:  66%|██████▌   | 66/100 [04:29<02:11,  3.86s/it]Best trial: 51. Best value: 0.526879:  67%|██████▋   | 67/100 [04:29<01:59,  3.62s/it]Best trial: 51. Best value: 0.526879:  67%|██████▋   | 67/100 [04:33<01:59,  3.62s/it]Best trial: 51. Best value: 0.526879:  68%|██████▊   | 68/100 [04:33<01:56,  3.65s/it]Best trial: 51. Best value: 0.526879:  68%|██████▊   | 68/100 [04:37<01:56,  3.65s/it]Best trial: 51. Best value: 0.526879:  69%|██████▉   | 69/100 [04:37<01:56,  3.77s/it]Best trial: 51. Best value: 0.526879:  69%|██████▉   | 69/100 [04:40<01:56,  3.77s/it]Best trial: 51. Best value: 0.526879:  70%|███████   | 70/100 [04:40<01:49,  3.65s/it]Best trial: 51. Best value: 0.526879:  70%|███████   | 70/100 [04:44<01:49,  3.65s/it]Best trial: 51. Best value: 0.526879:  71%|███████   | 71/100 [04:44<01:50,  3.81s/it]Best trial: 51. Best value: 0.526879:  71%|███████   | 71/100 [04:48<01:50,  3.81s/it]Best trial: 51. Best value: 0.526879:  72%|███████▏  | 72/100 [04:48<01:46,  3.82s/it]Best trial: 51. Best value: 0.526879:  72%|███████▏  | 72/100 [04:52<01:46,  3.82s/it]Best trial: 51. Best value: 0.526879:  73%|███████▎  | 73/100 [04:52<01:46,  3.95s/it]Best trial: 51. Best value: 0.526879:  73%|███████▎  | 73/100 [04:57<01:46,  3.95s/it]Best trial: 51. Best value: 0.526879:  74%|███████▍  | 74/100 [04:57<01:50,  4.24s/it]Best trial: 51. Best value: 0.526879:  74%|███████▍  | 74/100 [05:03<01:50,  4.24s/it]Best trial: 51. Best value: 0.526879:  75%|███████▌  | 75/100 [05:03<01:57,  4.69s/it]Best trial: 51. Best value: 0.526879:  75%|███████▌  | 75/100 [05:07<01:57,  4.69s/it]Best trial: 51. Best value: 0.526879:  76%|███████▌  | 76/100 [05:07<01:46,  4.43s/it]Best trial: 51. Best value: 0.526879:  76%|███████▌  | 76/100 [05:10<01:46,  4.43s/it]Best trial: 51. Best value: 0.526879:  77%|███████▋  | 77/100 [05:10<01:33,  4.08s/it]Best trial: 51. Best value: 0.526879:  77%|███████▋  | 77/100 [05:15<01:33,  4.08s/it]Best trial: 51. Best value: 0.526879:  78%|███████▊  | 78/100 [05:15<01:36,  4.38s/it]Best trial: 51. Best value: 0.526879:  78%|███████▊  | 78/100 [05:19<01:36,  4.38s/it]Best trial: 51. Best value: 0.526879:  79%|███████▉  | 79/100 [05:19<01:25,  4.09s/it]Best trial: 51. Best value: 0.526879:  79%|███████▉  | 79/100 [05:21<01:25,  4.09s/it]Best trial: 51. Best value: 0.526879:  80%|████████  | 80/100 [05:21<01:14,  3.74s/it]Best trial: 51. Best value: 0.526879:  80%|████████  | 80/100 [05:27<01:14,  3.74s/it]Best trial: 51. Best value: 0.526879:  81%|████████  | 81/100 [05:27<01:18,  4.15s/it]Best trial: 51. Best value: 0.526879:  81%|████████  | 81/100 [05:31<01:18,  4.15s/it]Best trial: 51. Best value: 0.526879:  82%|████████▏ | 82/100 [05:31<01:18,  4.37s/it]Best trial: 51. Best value: 0.526879:  82%|████████▏ | 82/100 [05:34<01:18,  4.37s/it]Best trial: 51. Best value: 0.526879:  83%|████████▎ | 83/100 [05:34<01:05,  3.87s/it]Best trial: 51. Best value: 0.526879:  83%|████████▎ | 83/100 [05:37<01:05,  3.87s/it]Best trial: 51. Best value: 0.526879:  84%|████████▍ | 84/100 [05:37<00:59,  3.70s/it]Best trial: 51. Best value: 0.526879:  84%|████████▍ | 84/100 [05:41<00:59,  3.70s/it]Best trial: 51. Best value: 0.526879:  85%|████████▌ | 85/100 [05:41<00:53,  3.59s/it]Best trial: 51. Best value: 0.526879:  85%|████████▌ | 85/100 [05:44<00:53,  3.59s/it]Best trial: 51. Best value: 0.526879:  86%|████████▌ | 86/100 [05:44<00:47,  3.38s/it]Best trial: 51. Best value: 0.526879:  86%|████████▌ | 86/100 [05:47<00:47,  3.38s/it]Best trial: 51. Best value: 0.526879:  87%|████████▋ | 87/100 [05:47<00:44,  3.41s/it]Best trial: 51. Best value: 0.526879:  87%|████████▋ | 87/100 [05:52<00:44,  3.41s/it]Best trial: 51. Best value: 0.526879:  88%|████████▊ | 88/100 [05:52<00:47,  3.96s/it]Best trial: 51. Best value: 0.526879:  88%|████████▊ | 88/100 [05:56<00:47,  3.96s/it]Best trial: 51. Best value: 0.526879:  89%|████████▉ | 89/100 [05:56<00:42,  3.84s/it]Best trial: 51. Best value: 0.526879:  89%|████████▉ | 89/100 [05:59<00:42,  3.84s/it]Best trial: 51. Best value: 0.526879:  90%|█████████ | 90/100 [05:59<00:35,  3.59s/it]Best trial: 51. Best value: 0.526879:  90%|█████████ | 90/100 [06:02<00:35,  3.59s/it]Best trial: 51. Best value: 0.526879:  91%|█████████ | 91/100 [06:02<00:30,  3.44s/it]Best trial: 51. Best value: 0.526879:  91%|█████████ | 91/100 [06:06<00:30,  3.44s/it]Best trial: 51. Best value: 0.526879:  92%|█████████▏| 92/100 [06:06<00:27,  3.47s/it]Best trial: 51. Best value: 0.526879:  92%|█████████▏| 92/100 [06:10<00:27,  3.47s/it]Best trial: 51. Best value: 0.526879:  93%|█████████▎| 93/100 [06:10<00:25,  3.71s/it]Best trial: 51. Best value: 0.526879:  93%|█████████▎| 93/100 [06:13<00:25,  3.71s/it]Best trial: 51. Best value: 0.526879:  94%|█████████▍| 94/100 [06:13<00:21,  3.58s/it]Best trial: 51. Best value: 0.526879:  94%|█████████▍| 94/100 [06:17<00:21,  3.58s/it]Best trial: 51. Best value: 0.526879:  95%|█████████▌| 95/100 [06:17<00:18,  3.71s/it]Best trial: 51. Best value: 0.526879:  95%|█████████▌| 95/100 [06:20<00:18,  3.71s/it]Best trial: 51. Best value: 0.526879:  96%|█████████▌| 96/100 [06:20<00:13,  3.45s/it]Best trial: 51. Best value: 0.526879:  96%|█████████▌| 96/100 [06:23<00:13,  3.45s/it]Best trial: 51. Best value: 0.526879:  97%|█████████▋| 97/100 [06:23<00:09,  3.20s/it]Best trial: 51. Best value: 0.526879:  97%|█████████▋| 97/100 [06:25<00:09,  3.20s/it]Best trial: 51. Best value: 0.526879:  98%|█████████▊| 98/100 [06:25<00:05,  2.98s/it]Best trial: 51. Best value: 0.526879:  98%|█████████▊| 98/100 [06:28<00:05,  2.98s/it]Best trial: 51. Best value: 0.526879:  99%|█████████▉| 99/100 [06:28<00:02,  2.94s/it]Best trial: 51. Best value: 0.526879:  99%|█████████▉| 99/100 [06:31<00:02,  2.94s/it]Best trial: 51. Best value: 0.526879: 100%|██████████| 100/100 [06:31<00:00,  2.91s/it]Best trial: 51. Best value: 0.526879: 100%|██████████| 100/100 [06:31<00:00,  3.91s/it]
2025-11-30 08:37:01,271 - INFO - HPO Complete. Best AUPRC: 0.5269
2025-11-30 08:37:01,272 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.0008276820916669372, 'max_depth': 4, 'subsample': 0.6105069175935308, 'colsample_bytree': 0.619090585232189, 'gamma': 0.011738117920389313, 'reg_lambda': 7.663456790459002e-06, 'reg_alpha': 0.0015192853984073399}
2025-11-30 08:37:01,272 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/non_windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:37:03,067 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 08:37:03,067 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 08:37:03,157 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 08:37:03,189 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:37:03,199 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 08:37:03,199 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:37:03,199 - INFO - Training model...
2025-11-30 08:37:07,641 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:37:13,217 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:37:13,218 - INFO - AUROC: 0.8077 (0.7192 - 0.8643)
2025-11-30 08:37:13,218 - INFO - AUPRC: 0.3859 (0.2716 - 0.5295)
2025-11-30 08:37:13,218 - INFO - Brier Score: 0.1424 (0.1390 - 0.1477)
2025-11-30 08:37:13,218 - INFO - Accuracy: 0.9509 (0.9370 - 0.9717)
2025-11-30 08:37:13,218 - INFO - Precision: 0.5357 (0.3788 - 0.8921)
2025-11-30 08:37:13,218 - INFO - Sensitivity (Recall): 0.4167 (0.2767 - 0.5484)
2025-11-30 08:37:13,218 - INFO - F1-Score: 0.4688 (0.3502 - 0.6209)
2025-11-30 08:37:13,218 - INFO - Best Threshold: 0.5000 (0.4840 - 0.5700)
2025-11-30 08:37:13,218 - INFO - Specificity: 0.9802 (0.9630 - 0.9976)
2025-11-30 08:37:13,247 - INFO - Calculating SHAP values...
2025-11-30 08:37:14,462 - INFO - SHAP plots saved.
2025-11-30 08:37:14,466 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/non_windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:37:15,859 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_only
2025-11-30 08:37:15,859 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:37:16,076 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:37:16,094 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:37:16,100 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 08:37:16,100 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.503173:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.503173:   1%|          | 1/100 [00:04<06:52,  4.17s/it]Best trial: 0. Best value: 0.503173:   1%|          | 1/100 [00:05<06:52,  4.17s/it]Best trial: 0. Best value: 0.503173:   2%|▏         | 2/100 [00:05<04:02,  2.48s/it]Best trial: 2. Best value: 0.511873:   2%|▏         | 2/100 [00:07<04:02,  2.48s/it]Best trial: 2. Best value: 0.511873:   3%|▎         | 3/100 [00:07<03:24,  2.11s/it]Best trial: 3. Best value: 0.521872:   3%|▎         | 3/100 [00:09<03:24,  2.11s/it]Best trial: 3. Best value: 0.521872:   4%|▍         | 4/100 [00:09<03:24,  2.13s/it]Best trial: 4. Best value: 0.522385:   4%|▍         | 4/100 [00:16<03:24,  2.13s/it]Best trial: 4. Best value: 0.522385:   5%|▌         | 5/100 [00:16<06:04,  3.84s/it]Best trial: 5. Best value: 0.52282:   5%|▌         | 5/100 [00:17<06:04,  3.84s/it] Best trial: 5. Best value: 0.52282:   6%|▌         | 6/100 [00:17<04:48,  3.06s/it]Best trial: 6. Best value: 0.537201:   6%|▌         | 6/100 [00:22<04:48,  3.06s/it]Best trial: 6. Best value: 0.537201:   7%|▋         | 7/100 [00:22<05:35,  3.60s/it]Best trial: 6. Best value: 0.537201:   7%|▋         | 7/100 [00:24<05:35,  3.60s/it]Best trial: 6. Best value: 0.537201:   8%|▊         | 8/100 [00:24<04:43,  3.08s/it]Best trial: 6. Best value: 0.537201:   8%|▊         | 8/100 [00:26<04:43,  3.08s/it]Best trial: 6. Best value: 0.537201:   9%|▉         | 9/100 [00:26<04:11,  2.77s/it]Best trial: 6. Best value: 0.537201:   9%|▉         | 9/100 [00:28<04:11,  2.77s/it]Best trial: 6. Best value: 0.537201:  10%|█         | 10/100 [00:28<03:35,  2.39s/it]Best trial: 10. Best value: 0.538189:  10%|█         | 10/100 [00:30<03:35,  2.39s/it]Best trial: 10. Best value: 0.538189:  11%|█         | 11/100 [00:30<03:33,  2.39s/it]Best trial: 11. Best value: 0.548849:  11%|█         | 11/100 [00:33<03:33,  2.39s/it]Best trial: 11. Best value: 0.548849:  12%|█▏        | 12/100 [00:33<03:39,  2.50s/it]Best trial: 12. Best value: 0.549135:  12%|█▏        | 12/100 [00:35<03:39,  2.50s/it]Best trial: 12. Best value: 0.549135:  13%|█▎        | 13/100 [00:35<03:40,  2.53s/it]Best trial: 12. Best value: 0.549135:  13%|█▎        | 13/100 [00:38<03:40,  2.53s/it]Best trial: 12. Best value: 0.549135:  14%|█▍        | 14/100 [00:38<03:42,  2.59s/it]Best trial: 12. Best value: 0.549135:  14%|█▍        | 14/100 [00:43<03:42,  2.59s/it]Best trial: 12. Best value: 0.549135:  15%|█▌        | 15/100 [00:43<04:31,  3.20s/it]Best trial: 12. Best value: 0.549135:  15%|█▌        | 15/100 [00:46<04:31,  3.20s/it]Best trial: 12. Best value: 0.549135:  16%|█▌        | 16/100 [00:46<04:39,  3.33s/it]Best trial: 12. Best value: 0.549135:  16%|█▌        | 16/100 [00:49<04:39,  3.33s/it]Best trial: 12. Best value: 0.549135:  17%|█▋        | 17/100 [00:49<04:31,  3.27s/it]Best trial: 12. Best value: 0.549135:  17%|█▋        | 17/100 [00:53<04:31,  3.27s/it]Best trial: 12. Best value: 0.549135:  18%|█▊        | 18/100 [00:53<04:29,  3.29s/it]Best trial: 12. Best value: 0.549135:  18%|█▊        | 18/100 [00:57<04:29,  3.29s/it]Best trial: 12. Best value: 0.549135:  19%|█▉        | 19/100 [00:57<04:57,  3.67s/it]Best trial: 12. Best value: 0.549135:  19%|█▉        | 19/100 [01:01<04:57,  3.67s/it]Best trial: 12. Best value: 0.549135:  20%|██        | 20/100 [01:01<04:50,  3.63s/it]Best trial: 12. Best value: 0.549135:  20%|██        | 20/100 [01:04<04:50,  3.63s/it]Best trial: 12. Best value: 0.549135:  21%|██        | 21/100 [01:04<04:47,  3.64s/it]Best trial: 21. Best value: 0.553118:  21%|██        | 21/100 [01:07<04:47,  3.64s/it]Best trial: 21. Best value: 0.553118:  22%|██▏       | 22/100 [01:07<04:13,  3.26s/it]Best trial: 21. Best value: 0.553118:  22%|██▏       | 22/100 [01:10<04:13,  3.26s/it]Best trial: 21. Best value: 0.553118:  23%|██▎       | 23/100 [01:10<04:09,  3.24s/it]Best trial: 21. Best value: 0.553118:  23%|██▎       | 23/100 [01:14<04:09,  3.24s/it]Best trial: 21. Best value: 0.553118:  24%|██▍       | 24/100 [01:14<04:28,  3.53s/it]Best trial: 21. Best value: 0.553118:  24%|██▍       | 24/100 [01:17<04:28,  3.53s/it]Best trial: 21. Best value: 0.553118:  25%|██▌       | 25/100 [01:17<04:14,  3.39s/it]Best trial: 21. Best value: 0.553118:  25%|██▌       | 25/100 [01:22<04:14,  3.39s/it]Best trial: 21. Best value: 0.553118:  26%|██▌       | 26/100 [01:22<04:33,  3.69s/it]Best trial: 21. Best value: 0.553118:  26%|██▌       | 26/100 [01:26<04:33,  3.69s/it]Best trial: 21. Best value: 0.553118:  27%|██▋       | 27/100 [01:26<04:53,  4.03s/it]Best trial: 21. Best value: 0.553118:  27%|██▋       | 27/100 [01:30<04:53,  4.03s/it]Best trial: 21. Best value: 0.553118:  28%|██▊       | 28/100 [01:30<04:29,  3.74s/it]Best trial: 21. Best value: 0.553118:  28%|██▊       | 28/100 [01:34<04:29,  3.74s/it]Best trial: 21. Best value: 0.553118:  29%|██▉       | 29/100 [01:34<04:32,  3.84s/it]Best trial: 21. Best value: 0.553118:  29%|██▉       | 29/100 [01:36<04:32,  3.84s/it]Best trial: 21. Best value: 0.553118:  30%|███       | 30/100 [01:36<04:08,  3.54s/it]Best trial: 21. Best value: 0.553118:  30%|███       | 30/100 [01:41<04:08,  3.54s/it]Best trial: 21. Best value: 0.553118:  31%|███       | 31/100 [01:41<04:20,  3.78s/it]Best trial: 21. Best value: 0.553118:  31%|███       | 31/100 [01:44<04:20,  3.78s/it]Best trial: 21. Best value: 0.553118:  32%|███▏      | 32/100 [01:44<03:56,  3.48s/it]Best trial: 21. Best value: 0.553118:  32%|███▏      | 32/100 [01:47<03:56,  3.48s/it]Best trial: 21. Best value: 0.553118:  33%|███▎      | 33/100 [01:47<04:01,  3.60s/it]Best trial: 21. Best value: 0.553118:  33%|███▎      | 33/100 [01:53<04:01,  3.60s/it]Best trial: 21. Best value: 0.553118:  34%|███▍      | 34/100 [01:53<04:27,  4.05s/it]Best trial: 21. Best value: 0.553118:  34%|███▍      | 34/100 [01:55<04:27,  4.05s/it]Best trial: 21. Best value: 0.553118:  35%|███▌      | 35/100 [01:55<03:47,  3.51s/it]Best trial: 35. Best value: 0.557623:  35%|███▌      | 35/100 [01:59<03:47,  3.51s/it]Best trial: 35. Best value: 0.557623:  36%|███▌      | 36/100 [01:59<03:48,  3.57s/it]Best trial: 35. Best value: 0.557623:  36%|███▌      | 36/100 [02:05<03:48,  3.57s/it]Best trial: 35. Best value: 0.557623:  37%|███▋      | 37/100 [02:05<04:48,  4.58s/it]Best trial: 35. Best value: 0.557623:  37%|███▋      | 37/100 [02:10<04:48,  4.58s/it]Best trial: 35. Best value: 0.557623:  38%|███▊      | 38/100 [02:10<04:35,  4.45s/it]Best trial: 35. Best value: 0.557623:  38%|███▊      | 38/100 [02:12<04:35,  4.45s/it]Best trial: 35. Best value: 0.557623:  39%|███▉      | 39/100 [02:12<03:56,  3.87s/it]Best trial: 35. Best value: 0.557623:  39%|███▉      | 39/100 [02:16<03:56,  3.87s/it]Best trial: 35. Best value: 0.557623:  40%|████      | 40/100 [02:16<03:57,  3.95s/it]Best trial: 35. Best value: 0.557623:  40%|████      | 40/100 [02:22<03:57,  3.95s/it]Best trial: 35. Best value: 0.557623:  41%|████      | 41/100 [02:22<04:28,  4.56s/it]Best trial: 35. Best value: 0.557623:  41%|████      | 41/100 [02:26<04:28,  4.56s/it]Best trial: 35. Best value: 0.557623:  42%|████▏     | 42/100 [02:26<04:02,  4.18s/it]Best trial: 35. Best value: 0.557623:  42%|████▏     | 42/100 [02:30<04:02,  4.18s/it]Best trial: 35. Best value: 0.557623:  43%|████▎     | 43/100 [02:30<04:08,  4.36s/it]Best trial: 35. Best value: 0.557623:  43%|████▎     | 43/100 [02:34<04:08,  4.36s/it]Best trial: 35. Best value: 0.557623:  44%|████▍     | 44/100 [02:34<03:50,  4.12s/it]Best trial: 35. Best value: 0.557623:  44%|████▍     | 44/100 [02:38<03:50,  4.12s/it]Best trial: 35. Best value: 0.557623:  45%|████▌     | 45/100 [02:38<03:47,  4.14s/it]Best trial: 35. Best value: 0.557623:  45%|████▌     | 45/100 [02:43<03:47,  4.14s/it]Best trial: 35. Best value: 0.557623:  46%|████▌     | 46/100 [02:43<04:01,  4.48s/it]Best trial: 35. Best value: 0.557623:  46%|████▌     | 46/100 [02:48<04:01,  4.48s/it]Best trial: 35. Best value: 0.557623:  47%|████▋     | 47/100 [02:48<04:07,  4.68s/it]Best trial: 35. Best value: 0.557623:  47%|████▋     | 47/100 [02:56<04:07,  4.68s/it]Best trial: 35. Best value: 0.557623:  48%|████▊     | 48/100 [02:56<04:40,  5.38s/it]Best trial: 35. Best value: 0.557623:  48%|████▊     | 48/100 [03:00<04:40,  5.38s/it]Best trial: 35. Best value: 0.557623:  49%|████▉     | 49/100 [03:00<04:25,  5.21s/it]Best trial: 35. Best value: 0.557623:  49%|████▉     | 49/100 [03:05<04:25,  5.21s/it]Best trial: 35. Best value: 0.557623:  50%|█████     | 50/100 [03:05<04:18,  5.18s/it]Best trial: 35. Best value: 0.557623:  50%|█████     | 50/100 [03:11<04:18,  5.18s/it]Best trial: 35. Best value: 0.557623:  51%|█████     | 51/100 [03:11<04:25,  5.41s/it]Best trial: 35. Best value: 0.557623:  51%|█████     | 51/100 [03:15<04:25,  5.41s/it]Best trial: 35. Best value: 0.557623:  52%|█████▏    | 52/100 [03:15<03:57,  4.94s/it]Best trial: 35. Best value: 0.557623:  52%|█████▏    | 52/100 [03:20<03:57,  4.94s/it]Best trial: 35. Best value: 0.557623:  53%|█████▎    | 53/100 [03:20<03:51,  4.92s/it]Best trial: 35. Best value: 0.557623:  53%|█████▎    | 53/100 [03:26<03:51,  4.92s/it]Best trial: 35. Best value: 0.557623:  54%|█████▍    | 54/100 [03:26<04:01,  5.26s/it]Best trial: 35. Best value: 0.557623:  54%|█████▍    | 54/100 [03:33<04:01,  5.26s/it]Best trial: 35. Best value: 0.557623:  55%|█████▌    | 55/100 [03:33<04:22,  5.83s/it]Best trial: 35. Best value: 0.557623:  55%|█████▌    | 55/100 [03:37<04:22,  5.83s/it]Best trial: 35. Best value: 0.557623:  56%|█████▌    | 56/100 [03:37<03:51,  5.25s/it]Best trial: 35. Best value: 0.557623:  56%|█████▌    | 56/100 [03:42<03:51,  5.25s/it]Best trial: 35. Best value: 0.557623:  57%|█████▋    | 57/100 [03:42<03:37,  5.05s/it]Best trial: 35. Best value: 0.557623:  57%|█████▋    | 57/100 [03:46<03:37,  5.05s/it]Best trial: 35. Best value: 0.557623:  58%|█████▊    | 58/100 [03:46<03:19,  4.76s/it]Best trial: 35. Best value: 0.557623:  58%|█████▊    | 58/100 [03:50<03:19,  4.76s/it]Best trial: 35. Best value: 0.557623:  59%|█████▉    | 59/100 [03:50<03:11,  4.68s/it]Best trial: 35. Best value: 0.557623:  59%|█████▉    | 59/100 [03:53<03:11,  4.68s/it]Best trial: 35. Best value: 0.557623:  60%|██████    | 60/100 [03:53<02:42,  4.07s/it]Best trial: 35. Best value: 0.557623:  60%|██████    | 60/100 [03:59<02:42,  4.07s/it]Best trial: 35. Best value: 0.557623:  61%|██████    | 61/100 [03:59<03:01,  4.66s/it]Best trial: 35. Best value: 0.557623:  61%|██████    | 61/100 [04:04<03:01,  4.66s/it]Best trial: 35. Best value: 0.557623:  62%|██████▏   | 62/100 [04:04<03:05,  4.89s/it]Best trial: 35. Best value: 0.557623:  62%|██████▏   | 62/100 [04:09<03:05,  4.89s/it]Best trial: 35. Best value: 0.557623:  63%|██████▎   | 63/100 [04:09<02:55,  4.73s/it]Best trial: 35. Best value: 0.557623:  63%|██████▎   | 63/100 [04:13<02:55,  4.73s/it]Best trial: 35. Best value: 0.557623:  64%|██████▍   | 64/100 [04:13<02:41,  4.48s/it]Best trial: 35. Best value: 0.557623:  64%|██████▍   | 64/100 [04:17<02:41,  4.48s/it]Best trial: 35. Best value: 0.557623:  65%|██████▌   | 65/100 [04:17<02:35,  4.45s/it]Best trial: 35. Best value: 0.557623:  65%|██████▌   | 65/100 [04:21<02:35,  4.45s/it]Best trial: 35. Best value: 0.557623:  66%|██████▌   | 66/100 [04:21<02:26,  4.30s/it]Best trial: 35. Best value: 0.557623:  66%|██████▌   | 66/100 [04:25<02:26,  4.30s/it]Best trial: 35. Best value: 0.557623:  67%|██████▋   | 67/100 [04:25<02:16,  4.13s/it]Best trial: 35. Best value: 0.557623:  67%|██████▋   | 67/100 [04:29<02:16,  4.13s/it]Best trial: 35. Best value: 0.557623:  68%|██████▊   | 68/100 [04:29<02:13,  4.18s/it]Best trial: 35. Best value: 0.557623:  68%|██████▊   | 68/100 [04:33<02:13,  4.18s/it]Best trial: 35. Best value: 0.557623:  69%|██████▉   | 69/100 [04:33<02:06,  4.07s/it]Best trial: 69. Best value: 0.566864:  69%|██████▉   | 69/100 [04:40<02:06,  4.07s/it]Best trial: 69. Best value: 0.566864:  70%|███████   | 70/100 [04:40<02:27,  4.92s/it]Best trial: 69. Best value: 0.566864:  70%|███████   | 70/100 [04:44<02:27,  4.92s/it]Best trial: 69. Best value: 0.566864:  71%|███████   | 71/100 [04:44<02:18,  4.77s/it]Best trial: 69. Best value: 0.566864:  71%|███████   | 71/100 [04:49<02:18,  4.77s/it]Best trial: 69. Best value: 0.566864:  72%|███████▏  | 72/100 [04:49<02:12,  4.73s/it]Best trial: 69. Best value: 0.566864:  72%|███████▏  | 72/100 [04:52<02:12,  4.73s/it]Best trial: 69. Best value: 0.566864:  73%|███████▎  | 73/100 [04:52<01:55,  4.28s/it]Best trial: 69. Best value: 0.566864:  73%|███████▎  | 73/100 [04:55<01:55,  4.28s/it]Best trial: 69. Best value: 0.566864:  74%|███████▍  | 74/100 [04:55<01:39,  3.81s/it]Best trial: 69. Best value: 0.566864:  74%|███████▍  | 74/100 [04:58<01:39,  3.81s/it]Best trial: 69. Best value: 0.566864:  75%|███████▌  | 75/100 [04:58<01:28,  3.55s/it]Best trial: 69. Best value: 0.566864:  75%|███████▌  | 75/100 [05:01<01:28,  3.55s/it]Best trial: 69. Best value: 0.566864:  76%|███████▌  | 76/100 [05:01<01:19,  3.32s/it]Best trial: 69. Best value: 0.566864:  76%|███████▌  | 76/100 [05:06<01:19,  3.32s/it]Best trial: 69. Best value: 0.566864:  77%|███████▋  | 77/100 [05:06<01:28,  3.84s/it]Best trial: 69. Best value: 0.566864:  77%|███████▋  | 77/100 [05:09<01:28,  3.84s/it]Best trial: 69. Best value: 0.566864:  78%|███████▊  | 78/100 [05:09<01:21,  3.72s/it]Best trial: 69. Best value: 0.566864:  78%|███████▊  | 78/100 [05:12<01:21,  3.72s/it]Best trial: 69. Best value: 0.566864:  79%|███████▉  | 79/100 [05:12<01:15,  3.59s/it]Best trial: 69. Best value: 0.566864:  79%|███████▉  | 79/100 [05:15<01:15,  3.59s/it]Best trial: 69. Best value: 0.566864:  80%|████████  | 80/100 [05:15<01:05,  3.30s/it]Best trial: 69. Best value: 0.566864:  80%|████████  | 80/100 [05:20<01:05,  3.30s/it]Best trial: 69. Best value: 0.566864:  81%|████████  | 81/100 [05:20<01:10,  3.73s/it]Best trial: 69. Best value: 0.566864:  81%|████████  | 81/100 [05:24<01:10,  3.73s/it]Best trial: 69. Best value: 0.566864:  82%|████████▏ | 82/100 [05:24<01:11,  3.95s/it]Best trial: 69. Best value: 0.566864:  82%|████████▏ | 82/100 [05:28<01:11,  3.95s/it]Best trial: 69. Best value: 0.566864:  83%|████████▎ | 83/100 [05:28<01:04,  3.81s/it]Best trial: 69. Best value: 0.566864:  83%|████████▎ | 83/100 [05:32<01:04,  3.81s/it]Best trial: 69. Best value: 0.566864:  84%|████████▍ | 84/100 [05:32<01:03,  3.95s/it]Best trial: 69. Best value: 0.566864:  84%|████████▍ | 84/100 [05:37<01:03,  3.95s/it]Best trial: 69. Best value: 0.566864:  85%|████████▌ | 85/100 [05:37<01:04,  4.29s/it]Best trial: 69. Best value: 0.566864:  85%|████████▌ | 85/100 [05:40<01:04,  4.29s/it]Best trial: 69. Best value: 0.566864:  86%|████████▌ | 86/100 [05:40<00:54,  3.91s/it]Best trial: 69. Best value: 0.566864:  86%|████████▌ | 86/100 [05:43<00:54,  3.91s/it]Best trial: 69. Best value: 0.566864:  87%|████████▋ | 87/100 [05:43<00:49,  3.80s/it]Best trial: 69. Best value: 0.566864:  87%|████████▋ | 87/100 [05:47<00:49,  3.80s/it]Best trial: 69. Best value: 0.566864:  88%|████████▊ | 88/100 [05:47<00:43,  3.65s/it]Best trial: 69. Best value: 0.566864:  88%|████████▊ | 88/100 [05:49<00:43,  3.65s/it]Best trial: 69. Best value: 0.566864:  89%|████████▉ | 89/100 [05:49<00:35,  3.22s/it]Best trial: 69. Best value: 0.566864:  89%|████████▉ | 89/100 [05:52<00:35,  3.22s/it]Best trial: 69. Best value: 0.566864:  90%|█████████ | 90/100 [05:52<00:31,  3.20s/it]Best trial: 69. Best value: 0.566864:  90%|█████████ | 90/100 [05:54<00:31,  3.20s/it]Best trial: 69. Best value: 0.566864:  91%|█████████ | 91/100 [05:54<00:25,  2.84s/it]Best trial: 69. Best value: 0.566864:  91%|█████████ | 91/100 [05:57<00:25,  2.84s/it]Best trial: 69. Best value: 0.566864:  92%|█████████▏| 92/100 [05:57<00:23,  2.90s/it]Best trial: 69. Best value: 0.566864:  92%|█████████▏| 92/100 [06:01<00:23,  2.90s/it]Best trial: 69. Best value: 0.566864:  93%|█████████▎| 93/100 [06:01<00:21,  3.13s/it]Best trial: 69. Best value: 0.566864:  93%|█████████▎| 93/100 [06:04<00:21,  3.13s/it]Best trial: 69. Best value: 0.566864:  94%|█████████▍| 94/100 [06:04<00:17,  2.98s/it]Best trial: 69. Best value: 0.566864:  94%|█████████▍| 94/100 [06:06<00:17,  2.98s/it]Best trial: 69. Best value: 0.566864:  95%|█████████▌| 95/100 [06:06<00:14,  2.93s/it]Best trial: 69. Best value: 0.566864:  95%|█████████▌| 95/100 [06:09<00:14,  2.93s/it]Best trial: 69. Best value: 0.566864:  96%|█████████▌| 96/100 [06:09<00:11,  2.93s/it]Best trial: 69. Best value: 0.566864:  96%|█████████▌| 96/100 [06:12<00:11,  2.93s/it]Best trial: 69. Best value: 0.566864:  97%|█████████▋| 97/100 [06:12<00:08,  2.98s/it]Best trial: 69. Best value: 0.566864:  97%|█████████▋| 97/100 [06:15<00:08,  2.98s/it]Best trial: 69. Best value: 0.566864:  98%|█████████▊| 98/100 [06:15<00:05,  2.74s/it]Best trial: 69. Best value: 0.566864:  98%|█████████▊| 98/100 [06:17<00:05,  2.74s/it]Best trial: 69. Best value: 0.566864:  99%|█████████▉| 99/100 [06:17<00:02,  2.56s/it]Best trial: 69. Best value: 0.566864:  99%|█████████▉| 99/100 [06:21<00:02,  2.56s/it]Best trial: 69. Best value: 0.566864: 100%|██████████| 100/100 [06:21<00:00,  3.05s/it]Best trial: 69. Best value: 0.566864: 100%|██████████| 100/100 [06:21<00:00,  3.81s/it]
2025-11-30 08:43:37,460 - INFO - HPO Complete. Best AUPRC: 0.5669
2025-11-30 08:43:37,460 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.027786001289676523, 'max_depth': 9, 'subsample': 0.6511108008903749, 'colsample_bytree': 0.6957110461028984, 'gamma': 3.585405988952835, 'reg_lambda': 2.481605566178373e-06, 'reg_alpha': 0.032222049617671104}
2025-11-30 08:43:37,460 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:43:39,524 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_only
2025-11-30 08:43:39,524 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:43:39,753 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:43:39,775 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:43:39,780 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 08:43:39,780 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:43:39,780 - INFO - Training model...
2025-11-30 08:43:40,835 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:43:46,113 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:43:46,114 - INFO - AUROC: 0.7718 (0.6728 - 0.8482)
2025-11-30 08:43:46,114 - INFO - AUPRC: 0.3472 (0.1642 - 0.5232)
2025-11-30 08:43:46,114 - INFO - Brier Score: 0.0469 (0.0355 - 0.0599)
2025-11-30 08:43:46,114 - INFO - Accuracy: 0.9552 (0.8977 - 0.9673)
2025-11-30 08:43:46,114 - INFO - Precision: 0.6316 (0.2583 - 0.8921)
2025-11-30 08:43:46,114 - INFO - Sensitivity (Recall): 0.3333 (0.2241 - 0.6763)
2025-11-30 08:43:46,114 - INFO - F1-Score: 0.4364 (0.2767 - 0.5723)
2025-11-30 08:43:46,114 - INFO - Best Threshold: 0.6800 (0.1560 - 0.7760)
2025-11-30 08:43:46,114 - INFO - Specificity: 0.9893 (0.9106 - 0.9976)
2025-11-30 08:43:46,131 - INFO - Calculating SHAP values...
2025-11-30 08:43:47,154 - INFO - SHAP plots saved.
2025-11-30 08:43:47,157 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:43:48,496 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: pleth_only
2025-11-30 08:43:48,496 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:43:48,697 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:43:48,718 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:43:48,723 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:43:48,723 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.129556:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.129556:   1%|          | 1/100 [00:04<07:49,  4.74s/it]Best trial: 0. Best value: 0.129556:   1%|          | 1/100 [00:06<07:49,  4.74s/it]Best trial: 0. Best value: 0.129556:   2%|▏         | 2/100 [00:06<05:13,  3.19s/it]Best trial: 2. Best value: 0.135292:   2%|▏         | 2/100 [00:11<05:13,  3.19s/it]Best trial: 2. Best value: 0.135292:   3%|▎         | 3/100 [00:11<06:31,  4.04s/it]Best trial: 2. Best value: 0.135292:   3%|▎         | 3/100 [00:15<06:31,  4.04s/it]Best trial: 2. Best value: 0.135292:   4%|▍         | 4/100 [00:15<06:12,  3.88s/it]Best trial: 4. Best value: 0.139906:   4%|▍         | 4/100 [00:19<06:12,  3.88s/it]Best trial: 4. Best value: 0.139906:   5%|▌         | 5/100 [00:19<05:57,  3.76s/it]Best trial: 4. Best value: 0.139906:   5%|▌         | 5/100 [00:23<05:57,  3.76s/it]Best trial: 4. Best value: 0.139906:   6%|▌         | 6/100 [00:23<06:16,  4.01s/it]Best trial: 4. Best value: 0.139906:   6%|▌         | 6/100 [00:26<06:16,  4.01s/it]Best trial: 4. Best value: 0.139906:   7%|▋         | 7/100 [00:26<05:54,  3.81s/it]Best trial: 4. Best value: 0.139906:   7%|▋         | 7/100 [00:30<05:54,  3.81s/it]Best trial: 4. Best value: 0.139906:   8%|▊         | 8/100 [00:30<05:45,  3.76s/it]Best trial: 4. Best value: 0.139906:   8%|▊         | 8/100 [00:34<05:45,  3.76s/it]Best trial: 4. Best value: 0.139906:   9%|▉         | 9/100 [00:34<05:54,  3.90s/it]Best trial: 4. Best value: 0.139906:   9%|▉         | 9/100 [00:40<05:54,  3.90s/it]Best trial: 4. Best value: 0.139906:  10%|█         | 10/100 [00:40<06:48,  4.54s/it]Best trial: 4. Best value: 0.139906:  10%|█         | 10/100 [00:43<06:48,  4.54s/it]Best trial: 4. Best value: 0.139906:  11%|█         | 11/100 [00:43<05:46,  3.89s/it]Best trial: 11. Best value: 0.141521:  11%|█         | 11/100 [00:46<05:46,  3.89s/it]Best trial: 11. Best value: 0.141521:  12%|█▏        | 12/100 [00:46<05:21,  3.65s/it]Best trial: 11. Best value: 0.141521:  12%|█▏        | 12/100 [00:49<05:21,  3.65s/it]Best trial: 11. Best value: 0.141521:  13%|█▎        | 13/100 [00:49<04:55,  3.40s/it]Best trial: 11. Best value: 0.141521:  13%|█▎        | 13/100 [00:51<04:55,  3.40s/it]Best trial: 11. Best value: 0.141521:  14%|█▍        | 14/100 [00:51<04:36,  3.21s/it]Best trial: 11. Best value: 0.141521:  14%|█▍        | 14/100 [00:55<04:36,  3.21s/it]Best trial: 11. Best value: 0.141521:  15%|█▌        | 15/100 [00:55<04:33,  3.22s/it]Best trial: 11. Best value: 0.141521:  15%|█▌        | 15/100 [01:00<04:33,  3.22s/it]Best trial: 11. Best value: 0.141521:  16%|█▌        | 16/100 [01:00<05:15,  3.75s/it]Best trial: 11. Best value: 0.141521:  16%|█▌        | 16/100 [01:04<05:15,  3.75s/it]Best trial: 11. Best value: 0.141521:  17%|█▋        | 17/100 [01:04<05:22,  3.89s/it]Best trial: 11. Best value: 0.141521:  17%|█▋        | 17/100 [01:06<05:22,  3.89s/it]Best trial: 11. Best value: 0.141521:  18%|█▊        | 18/100 [01:06<04:45,  3.48s/it]Best trial: 18. Best value: 0.149041:  18%|█▊        | 18/100 [01:09<04:45,  3.48s/it]Best trial: 18. Best value: 0.149041:  19%|█▉        | 19/100 [01:09<04:18,  3.19s/it]Best trial: 18. Best value: 0.149041:  19%|█▉        | 19/100 [01:11<04:18,  3.19s/it]Best trial: 18. Best value: 0.149041:  20%|██        | 20/100 [01:11<03:48,  2.86s/it]Best trial: 18. Best value: 0.149041:  20%|██        | 20/100 [01:14<03:48,  2.86s/it]Best trial: 18. Best value: 0.149041:  21%|██        | 21/100 [01:14<03:46,  2.87s/it]Best trial: 18. Best value: 0.149041:  21%|██        | 21/100 [01:17<03:46,  2.87s/it]Best trial: 18. Best value: 0.149041:  22%|██▏       | 22/100 [01:17<03:39,  2.81s/it]Best trial: 18. Best value: 0.149041:  22%|██▏       | 22/100 [01:20<03:39,  2.81s/it]Best trial: 18. Best value: 0.149041:  23%|██▎       | 23/100 [01:20<03:43,  2.91s/it]Best trial: 18. Best value: 0.149041:  23%|██▎       | 23/100 [01:22<03:43,  2.91s/it]Best trial: 18. Best value: 0.149041:  24%|██▍       | 24/100 [01:22<03:38,  2.88s/it]Best trial: 18. Best value: 0.149041:  24%|██▍       | 24/100 [01:25<03:38,  2.88s/it]Best trial: 18. Best value: 0.149041:  25%|██▌       | 25/100 [01:25<03:26,  2.76s/it]Best trial: 18. Best value: 0.149041:  25%|██▌       | 25/100 [01:28<03:26,  2.76s/it]Best trial: 18. Best value: 0.149041:  26%|██▌       | 26/100 [01:28<03:25,  2.78s/it]Best trial: 18. Best value: 0.149041:  26%|██▌       | 26/100 [01:31<03:25,  2.78s/it]Best trial: 18. Best value: 0.149041:  27%|██▋       | 27/100 [01:31<03:22,  2.78s/it]Best trial: 18. Best value: 0.149041:  27%|██▋       | 27/100 [01:35<03:22,  2.78s/it]Best trial: 18. Best value: 0.149041:  28%|██▊       | 28/100 [01:35<03:46,  3.14s/it]Best trial: 18. Best value: 0.149041:  28%|██▊       | 28/100 [01:38<03:46,  3.14s/it]Best trial: 18. Best value: 0.149041:  29%|██▉       | 29/100 [01:38<03:41,  3.12s/it]Best trial: 18. Best value: 0.149041:  29%|██▉       | 29/100 [01:40<03:41,  3.12s/it]Best trial: 18. Best value: 0.149041:  30%|███       | 30/100 [01:40<03:30,  3.00s/it]Best trial: 18. Best value: 0.149041:  30%|███       | 30/100 [01:44<03:30,  3.00s/it]Best trial: 18. Best value: 0.149041:  31%|███       | 31/100 [01:44<03:33,  3.10s/it]Best trial: 18. Best value: 0.149041:  31%|███       | 31/100 [01:48<03:33,  3.10s/it]Best trial: 18. Best value: 0.149041:  32%|███▏      | 32/100 [01:48<03:48,  3.36s/it]Best trial: 18. Best value: 0.149041:  32%|███▏      | 32/100 [01:50<03:48,  3.36s/it]Best trial: 18. Best value: 0.149041:  33%|███▎      | 33/100 [01:50<03:19,  2.98s/it]Best trial: 18. Best value: 0.149041:  33%|███▎      | 33/100 [01:55<03:19,  2.98s/it]Best trial: 18. Best value: 0.149041:  34%|███▍      | 34/100 [01:55<03:57,  3.59s/it]Best trial: 18. Best value: 0.149041:  34%|███▍      | 34/100 [01:57<03:57,  3.59s/it]Best trial: 18. Best value: 0.149041:  35%|███▌      | 35/100 [01:57<03:33,  3.29s/it]Best trial: 18. Best value: 0.149041:  35%|███▌      | 35/100 [01:59<03:33,  3.29s/it]Best trial: 18. Best value: 0.149041:  36%|███▌      | 36/100 [01:59<03:07,  2.93s/it]Best trial: 18. Best value: 0.149041:  36%|███▌      | 36/100 [02:03<03:07,  2.93s/it]Best trial: 18. Best value: 0.149041:  37%|███▋      | 37/100 [02:03<03:13,  3.07s/it]Best trial: 18. Best value: 0.149041:  37%|███▋      | 37/100 [02:06<03:13,  3.07s/it]Best trial: 18. Best value: 0.149041:  38%|███▊      | 38/100 [02:06<03:10,  3.08s/it]Best trial: 18. Best value: 0.149041:  38%|███▊      | 38/100 [02:09<03:10,  3.08s/it]Best trial: 18. Best value: 0.149041:  39%|███▉      | 39/100 [02:09<03:08,  3.09s/it]Best trial: 18. Best value: 0.149041:  39%|███▉      | 39/100 [02:13<03:08,  3.09s/it]Best trial: 18. Best value: 0.149041:  40%|████      | 40/100 [02:13<03:27,  3.46s/it]Best trial: 18. Best value: 0.149041:  40%|████      | 40/100 [02:16<03:27,  3.46s/it]Best trial: 18. Best value: 0.149041:  41%|████      | 41/100 [02:16<03:13,  3.28s/it]Best trial: 18. Best value: 0.149041:  41%|████      | 41/100 [02:21<03:13,  3.28s/it]Best trial: 18. Best value: 0.149041:  42%|████▏     | 42/100 [02:21<03:32,  3.67s/it]Best trial: 18. Best value: 0.149041:  42%|████▏     | 42/100 [02:25<03:32,  3.67s/it]Best trial: 18. Best value: 0.149041:  43%|████▎     | 43/100 [02:25<03:39,  3.84s/it]Best trial: 18. Best value: 0.149041:  43%|████▎     | 43/100 [02:28<03:39,  3.84s/it]Best trial: 18. Best value: 0.149041:  44%|████▍     | 44/100 [02:28<03:17,  3.53s/it]Best trial: 18. Best value: 0.149041:  44%|████▍     | 44/100 [02:31<03:17,  3.53s/it]Best trial: 18. Best value: 0.149041:  45%|████▌     | 45/100 [02:31<03:01,  3.30s/it]Best trial: 18. Best value: 0.149041:  45%|████▌     | 45/100 [02:37<03:01,  3.30s/it]Best trial: 18. Best value: 0.149041:  46%|████▌     | 46/100 [02:37<03:48,  4.23s/it]Best trial: 18. Best value: 0.149041:  46%|████▌     | 46/100 [02:41<03:48,  4.23s/it]Best trial: 18. Best value: 0.149041:  47%|████▋     | 47/100 [02:41<03:40,  4.16s/it]Best trial: 18. Best value: 0.149041:  47%|████▋     | 47/100 [02:44<03:40,  4.16s/it]Best trial: 18. Best value: 0.149041:  48%|████▊     | 48/100 [02:44<03:14,  3.74s/it]Best trial: 18. Best value: 0.149041:  48%|████▊     | 48/100 [02:48<03:14,  3.74s/it]Best trial: 18. Best value: 0.149041:  49%|████▉     | 49/100 [02:48<03:12,  3.78s/it]Best trial: 18. Best value: 0.149041:  49%|████▉     | 49/100 [02:50<03:12,  3.78s/it]Best trial: 18. Best value: 0.149041:  50%|█████     | 50/100 [02:50<02:48,  3.38s/it]Best trial: 18. Best value: 0.149041:  50%|█████     | 50/100 [02:53<02:48,  3.38s/it]Best trial: 18. Best value: 0.149041:  51%|█████     | 51/100 [02:53<02:39,  3.25s/it]Best trial: 18. Best value: 0.149041:  51%|█████     | 51/100 [03:00<02:39,  3.25s/it]Best trial: 18. Best value: 0.149041:  52%|█████▏    | 52/100 [03:00<03:25,  4.27s/it]Best trial: 18. Best value: 0.149041:  52%|█████▏    | 52/100 [03:03<03:25,  4.27s/it]Best trial: 18. Best value: 0.149041:  53%|█████▎    | 53/100 [03:03<03:10,  4.06s/it]Best trial: 18. Best value: 0.149041:  53%|█████▎    | 53/100 [03:06<03:10,  4.06s/it]Best trial: 18. Best value: 0.149041:  54%|█████▍    | 54/100 [03:06<02:53,  3.76s/it]Best trial: 18. Best value: 0.149041:  54%|█████▍    | 54/100 [03:10<02:53,  3.76s/it]Best trial: 18. Best value: 0.149041:  55%|█████▌    | 55/100 [03:10<02:44,  3.64s/it]Best trial: 18. Best value: 0.149041:  55%|█████▌    | 55/100 [03:13<02:44,  3.64s/it]Best trial: 18. Best value: 0.149041:  56%|█████▌    | 56/100 [03:13<02:38,  3.59s/it]Best trial: 18. Best value: 0.149041:  56%|█████▌    | 56/100 [03:16<02:38,  3.59s/it]Best trial: 18. Best value: 0.149041:  57%|█████▋    | 57/100 [03:16<02:21,  3.28s/it]Best trial: 18. Best value: 0.149041:  57%|█████▋    | 57/100 [03:19<02:21,  3.28s/it]Best trial: 18. Best value: 0.149041:  58%|█████▊    | 58/100 [03:19<02:17,  3.27s/it]Best trial: 18. Best value: 0.149041:  58%|█████▊    | 58/100 [03:22<02:17,  3.27s/it]Best trial: 18. Best value: 0.149041:  59%|█████▉    | 59/100 [03:22<02:11,  3.21s/it]Best trial: 18. Best value: 0.149041:  59%|█████▉    | 59/100 [03:26<02:11,  3.21s/it]Best trial: 18. Best value: 0.149041:  60%|██████    | 60/100 [03:26<02:16,  3.41s/it]Best trial: 18. Best value: 0.149041:  60%|██████    | 60/100 [03:29<02:16,  3.41s/it]Best trial: 18. Best value: 0.149041:  61%|██████    | 61/100 [03:29<02:10,  3.35s/it]Best trial: 18. Best value: 0.149041:  61%|██████    | 61/100 [03:33<02:10,  3.35s/it]Best trial: 18. Best value: 0.149041:  62%|██████▏   | 62/100 [03:33<02:12,  3.49s/it]Best trial: 62. Best value: 0.158675:  62%|██████▏   | 62/100 [03:35<02:12,  3.49s/it]Best trial: 62. Best value: 0.158675:  63%|██████▎   | 63/100 [03:35<01:58,  3.21s/it]Best trial: 62. Best value: 0.158675:  63%|██████▎   | 63/100 [03:38<01:58,  3.21s/it]Best trial: 62. Best value: 0.158675:  64%|██████▍   | 64/100 [03:38<01:47,  2.99s/it]Best trial: 62. Best value: 0.158675:  64%|██████▍   | 64/100 [03:41<01:47,  2.99s/it]Best trial: 62. Best value: 0.158675:  65%|██████▌   | 65/100 [03:41<01:39,  2.86s/it]Best trial: 62. Best value: 0.158675:  65%|██████▌   | 65/100 [03:44<01:39,  2.86s/it]Best trial: 62. Best value: 0.158675:  66%|██████▌   | 66/100 [03:44<01:39,  2.92s/it]Best trial: 62. Best value: 0.158675:  66%|██████▌   | 66/100 [03:46<01:39,  2.92s/it]Best trial: 62. Best value: 0.158675:  67%|██████▋   | 67/100 [03:46<01:29,  2.70s/it]Best trial: 62. Best value: 0.158675:  67%|██████▋   | 67/100 [03:49<01:29,  2.70s/it]Best trial: 62. Best value: 0.158675:  68%|██████▊   | 68/100 [03:49<01:32,  2.90s/it]Best trial: 62. Best value: 0.158675:  68%|██████▊   | 68/100 [03:51<01:32,  2.90s/it]Best trial: 62. Best value: 0.158675:  69%|██████▉   | 69/100 [03:51<01:23,  2.70s/it]Best trial: 62. Best value: 0.158675:  69%|██████▉   | 69/100 [03:54<01:23,  2.70s/it]Best trial: 62. Best value: 0.158675:  70%|███████   | 70/100 [03:54<01:16,  2.55s/it]Best trial: 62. Best value: 0.158675:  70%|███████   | 70/100 [03:56<01:16,  2.55s/it]Best trial: 62. Best value: 0.158675:  71%|███████   | 71/100 [03:56<01:13,  2.52s/it]Best trial: 62. Best value: 0.158675:  71%|███████   | 71/100 [03:59<01:13,  2.52s/it]Best trial: 62. Best value: 0.158675:  72%|███████▏  | 72/100 [03:59<01:12,  2.60s/it]Best trial: 62. Best value: 0.158675:  72%|███████▏  | 72/100 [04:01<01:12,  2.60s/it]Best trial: 62. Best value: 0.158675:  73%|███████▎  | 73/100 [04:01<01:10,  2.61s/it]Best trial: 62. Best value: 0.158675:  73%|███████▎  | 73/100 [04:04<01:10,  2.61s/it]Best trial: 62. Best value: 0.158675:  74%|███████▍  | 74/100 [04:04<01:05,  2.53s/it]Best trial: 62. Best value: 0.158675:  74%|███████▍  | 74/100 [04:06<01:05,  2.53s/it]Best trial: 62. Best value: 0.158675:  75%|███████▌  | 75/100 [04:06<01:00,  2.40s/it]Best trial: 62. Best value: 0.158675:  75%|███████▌  | 75/100 [04:08<01:00,  2.40s/it]Best trial: 62. Best value: 0.158675:  76%|███████▌  | 76/100 [04:08<00:56,  2.35s/it]Best trial: 62. Best value: 0.158675:  76%|███████▌  | 76/100 [04:12<00:56,  2.35s/it]Best trial: 62. Best value: 0.158675:  77%|███████▋  | 77/100 [04:12<01:01,  2.67s/it]Best trial: 62. Best value: 0.158675:  77%|███████▋  | 77/100 [04:15<01:01,  2.67s/it]Best trial: 62. Best value: 0.158675:  78%|███████▊  | 78/100 [04:15<01:01,  2.79s/it]Best trial: 78. Best value: 0.163526:  78%|███████▊  | 78/100 [04:18<01:01,  2.79s/it]Best trial: 78. Best value: 0.163526:  79%|███████▉  | 79/100 [04:18<00:59,  2.86s/it]Best trial: 78. Best value: 0.163526:  79%|███████▉  | 79/100 [04:21<00:59,  2.86s/it]Best trial: 78. Best value: 0.163526:  80%|████████  | 80/100 [04:21<00:57,  2.86s/it]Best trial: 78. Best value: 0.163526:  80%|████████  | 80/100 [04:23<00:57,  2.86s/it]Best trial: 78. Best value: 0.163526:  81%|████████  | 81/100 [04:23<00:50,  2.64s/it]Best trial: 78. Best value: 0.163526:  81%|████████  | 81/100 [04:25<00:50,  2.64s/it]Best trial: 78. Best value: 0.163526:  82%|████████▏ | 82/100 [04:25<00:47,  2.66s/it]Best trial: 78. Best value: 0.163526:  82%|████████▏ | 82/100 [04:28<00:47,  2.66s/it]Best trial: 78. Best value: 0.163526:  83%|████████▎ | 83/100 [04:28<00:47,  2.80s/it]Best trial: 78. Best value: 0.163526:  83%|████████▎ | 83/100 [04:31<00:47,  2.80s/it]Best trial: 78. Best value: 0.163526:  84%|████████▍ | 84/100 [04:31<00:44,  2.79s/it]Best trial: 78. Best value: 0.163526:  84%|████████▍ | 84/100 [04:35<00:44,  2.79s/it]Best trial: 78. Best value: 0.163526:  85%|████████▌ | 85/100 [04:35<00:44,  3.00s/it]Best trial: 78. Best value: 0.163526:  85%|████████▌ | 85/100 [04:37<00:44,  3.00s/it]Best trial: 78. Best value: 0.163526:  86%|████████▌ | 86/100 [04:37<00:40,  2.89s/it]Best trial: 78. Best value: 0.163526:  86%|████████▌ | 86/100 [04:40<00:40,  2.89s/it]Best trial: 78. Best value: 0.163526:  87%|████████▋ | 87/100 [04:40<00:38,  2.94s/it]Best trial: 78. Best value: 0.163526:  87%|████████▋ | 87/100 [04:43<00:38,  2.94s/it]Best trial: 78. Best value: 0.163526:  88%|████████▊ | 88/100 [04:43<00:33,  2.77s/it]Best trial: 78. Best value: 0.163526:  88%|████████▊ | 88/100 [04:45<00:33,  2.77s/it]Best trial: 78. Best value: 0.163526:  89%|████████▉ | 89/100 [04:45<00:29,  2.72s/it]Best trial: 78. Best value: 0.163526:  89%|████████▉ | 89/100 [04:48<00:29,  2.72s/it]Best trial: 78. Best value: 0.163526:  90%|█████████ | 90/100 [04:48<00:27,  2.72s/it]Best trial: 78. Best value: 0.163526:  90%|█████████ | 90/100 [04:51<00:27,  2.72s/it]Best trial: 78. Best value: 0.163526:  91%|█████████ | 91/100 [04:51<00:24,  2.68s/it]Best trial: 78. Best value: 0.163526:  91%|█████████ | 91/100 [04:53<00:24,  2.68s/it]Best trial: 78. Best value: 0.163526:  92%|█████████▏| 92/100 [04:53<00:21,  2.69s/it]Best trial: 78. Best value: 0.163526:  92%|█████████▏| 92/100 [04:56<00:21,  2.69s/it]Best trial: 78. Best value: 0.163526:  93%|█████████▎| 93/100 [04:56<00:19,  2.79s/it]Best trial: 78. Best value: 0.163526:  93%|█████████▎| 93/100 [04:59<00:19,  2.79s/it]Best trial: 78. Best value: 0.163526:  94%|█████████▍| 94/100 [04:59<00:16,  2.80s/it]Best trial: 78. Best value: 0.163526:  94%|█████████▍| 94/100 [05:01<00:16,  2.80s/it]Best trial: 78. Best value: 0.163526:  95%|█████████▌| 95/100 [05:01<00:12,  2.47s/it]Best trial: 78. Best value: 0.163526:  95%|█████████▌| 95/100 [05:03<00:12,  2.47s/it]Best trial: 78. Best value: 0.163526:  96%|█████████▌| 96/100 [05:03<00:08,  2.21s/it]Best trial: 78. Best value: 0.163526:  96%|█████████▌| 96/100 [05:04<00:08,  2.21s/it]Best trial: 78. Best value: 0.163526:  97%|█████████▋| 97/100 [05:04<00:06,  2.09s/it]Best trial: 78. Best value: 0.163526:  97%|█████████▋| 97/100 [05:07<00:06,  2.09s/it]Best trial: 78. Best value: 0.163526:  98%|█████████▊| 98/100 [05:07<00:04,  2.40s/it]Best trial: 78. Best value: 0.163526:  98%|█████████▊| 98/100 [05:09<00:04,  2.40s/it]Best trial: 78. Best value: 0.163526:  99%|█████████▉| 99/100 [05:09<00:02,  2.23s/it]Best trial: 78. Best value: 0.163526:  99%|█████████▉| 99/100 [05:11<00:02,  2.23s/it]Best trial: 78. Best value: 0.163526: 100%|██████████| 100/100 [05:11<00:00,  2.10s/it]Best trial: 78. Best value: 0.163526: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
2025-11-30 08:49:00,352 - INFO - HPO Complete. Best AUPRC: 0.1635
2025-11-30 08:49:00,353 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.042684722501318, 'max_depth': 4, 'subsample': 0.6329006953853292, 'colsample_bytree': 0.6899480740959902, 'gamma': 4.922048377418762, 'reg_lambda': 0.6284340519669375, 'reg_alpha': 0.2961521879301694}
2025-11-30 08:49:00,354 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:49:02,272 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: pleth_only
2025-11-30 08:49:02,273 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:49:02,466 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:49:02,488 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:49:02,492 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:49:02,492 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:49:02,492 - INFO - Training model...
2025-11-30 08:49:03,490 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:49:08,519 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:49:08,520 - INFO - AUROC: 0.6330 (0.5408 - 0.7168)
2025-11-30 08:49:08,520 - INFO - AUPRC: 0.0918 (0.0573 - 0.1411)
2025-11-30 08:49:08,520 - INFO - Brier Score: 0.0636 (0.0534 - 0.0761)
2025-11-30 08:49:08,520 - INFO - Accuracy: 0.9061 (0.6176 - 0.9263)
2025-11-30 08:49:08,520 - INFO - Precision: 0.1628 (0.0695 - 0.2428)
2025-11-30 08:49:08,520 - INFO - Sensitivity (Recall): 0.1944 (0.1756 - 0.6354)
2025-11-30 08:49:08,520 - INFO - F1-Score: 0.1772 (0.1162 - 0.2489)
2025-11-30 08:49:08,520 - INFO - Best Threshold: 0.3600 (0.1080 - 0.3860)
2025-11-30 08:49:08,520 - INFO - Specificity: 0.9451 (0.6175 - 0.9590)
2025-11-30 08:49:08,530 - INFO - Calculating SHAP values...
2025-11-30 08:49:09,677 - INFO - SHAP plots saved.
2025-11-30 08:49:09,679 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:49:11,261 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: ecg_only
2025-11-30 08:49:11,261 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:49:11,498 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:49:11,520 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:49:11,525 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:49:11,525 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.104669:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.104669:   1%|          | 1/100 [00:03<05:15,  3.19s/it]Best trial: 1. Best value: 0.120442:   1%|          | 1/100 [00:05<05:15,  3.19s/it]Best trial: 1. Best value: 0.120442:   2%|▏         | 2/100 [00:05<04:03,  2.48s/it]Best trial: 1. Best value: 0.120442:   2%|▏         | 2/100 [00:07<04:03,  2.48s/it]Best trial: 1. Best value: 0.120442:   3%|▎         | 3/100 [00:07<03:47,  2.35s/it]Best trial: 1. Best value: 0.120442:   3%|▎         | 3/100 [00:09<03:47,  2.35s/it]Best trial: 1. Best value: 0.120442:   4%|▍         | 4/100 [00:09<03:28,  2.17s/it]Best trial: 1. Best value: 0.120442:   4%|▍         | 4/100 [00:11<03:28,  2.17s/it]Best trial: 1. Best value: 0.120442:   5%|▌         | 5/100 [00:11<03:12,  2.03s/it]Best trial: 1. Best value: 0.120442:   5%|▌         | 5/100 [00:13<03:12,  2.03s/it]Best trial: 1. Best value: 0.120442:   6%|▌         | 6/100 [00:13<03:13,  2.06s/it]Best trial: 1. Best value: 0.120442:   6%|▌         | 6/100 [00:15<03:13,  2.06s/it]Best trial: 1. Best value: 0.120442:   7%|▋         | 7/100 [00:15<03:14,  2.10s/it]Best trial: 7. Best value: 0.127859:   7%|▋         | 7/100 [00:19<03:14,  2.10s/it]Best trial: 7. Best value: 0.127859:   8%|▊         | 8/100 [00:19<04:26,  2.89s/it]Best trial: 7. Best value: 0.127859:   8%|▊         | 8/100 [00:23<04:26,  2.89s/it]Best trial: 7. Best value: 0.127859:   9%|▉         | 9/100 [00:23<04:29,  2.96s/it]Best trial: 7. Best value: 0.127859:   9%|▉         | 9/100 [00:27<04:29,  2.96s/it]Best trial: 7. Best value: 0.127859:  10%|█         | 10/100 [00:27<05:01,  3.35s/it]Best trial: 7. Best value: 0.127859:  10%|█         | 10/100 [00:31<05:01,  3.35s/it]Best trial: 7. Best value: 0.127859:  11%|█         | 11/100 [00:31<05:31,  3.73s/it]Best trial: 7. Best value: 0.127859:  11%|█         | 11/100 [00:36<05:31,  3.73s/it]Best trial: 7. Best value: 0.127859:  12%|█▏        | 12/100 [00:36<05:40,  3.87s/it]Best trial: 7. Best value: 0.127859:  12%|█▏        | 12/100 [00:42<05:40,  3.87s/it]Best trial: 7. Best value: 0.127859:  13%|█▎        | 13/100 [00:42<06:54,  4.77s/it]Best trial: 7. Best value: 0.127859:  13%|█▎        | 13/100 [00:46<06:54,  4.77s/it]Best trial: 7. Best value: 0.127859:  14%|█▍        | 14/100 [00:46<06:12,  4.34s/it]Best trial: 14. Best value: 0.139447:  14%|█▍        | 14/100 [00:48<06:12,  4.34s/it]Best trial: 14. Best value: 0.139447:  15%|█▌        | 15/100 [00:48<05:17,  3.74s/it]Best trial: 14. Best value: 0.139447:  15%|█▌        | 15/100 [00:52<05:17,  3.74s/it]Best trial: 14. Best value: 0.139447:  16%|█▌        | 16/100 [00:52<05:07,  3.67s/it]Best trial: 16. Best value: 0.148426:  16%|█▌        | 16/100 [00:54<05:07,  3.67s/it]Best trial: 16. Best value: 0.148426:  17%|█▋        | 17/100 [00:54<04:39,  3.37s/it]Best trial: 16. Best value: 0.148426:  17%|█▋        | 17/100 [00:58<04:39,  3.37s/it]Best trial: 16. Best value: 0.148426:  18%|█▊        | 18/100 [00:58<04:34,  3.35s/it]Best trial: 16. Best value: 0.148426:  18%|█▊        | 18/100 [01:00<04:34,  3.35s/it]Best trial: 16. Best value: 0.148426:  19%|█▉        | 19/100 [01:00<04:07,  3.06s/it]Best trial: 16. Best value: 0.148426:  19%|█▉        | 19/100 [01:04<04:07,  3.06s/it]Best trial: 16. Best value: 0.148426:  20%|██        | 20/100 [01:04<04:24,  3.30s/it]Best trial: 16. Best value: 0.148426:  20%|██        | 20/100 [01:08<04:24,  3.30s/it]Best trial: 16. Best value: 0.148426:  21%|██        | 21/100 [01:08<04:33,  3.46s/it]Best trial: 16. Best value: 0.148426:  21%|██        | 21/100 [01:10<04:33,  3.46s/it]Best trial: 16. Best value: 0.148426:  22%|██▏       | 22/100 [01:10<04:09,  3.20s/it]Best trial: 16. Best value: 0.148426:  22%|██▏       | 22/100 [01:13<04:09,  3.20s/it]Best trial: 16. Best value: 0.148426:  23%|██▎       | 23/100 [01:13<03:52,  3.02s/it]Best trial: 16. Best value: 0.148426:  23%|██▎       | 23/100 [01:18<03:52,  3.02s/it]Best trial: 16. Best value: 0.148426:  24%|██▍       | 24/100 [01:18<04:33,  3.60s/it]Best trial: 16. Best value: 0.148426:  24%|██▍       | 24/100 [01:20<04:33,  3.60s/it]Best trial: 16. Best value: 0.148426:  25%|██▌       | 25/100 [01:20<04:07,  3.30s/it]Best trial: 16. Best value: 0.148426:  25%|██▌       | 25/100 [01:23<04:07,  3.30s/it]Best trial: 16. Best value: 0.148426:  26%|██▌       | 26/100 [01:23<03:55,  3.18s/it]Best trial: 16. Best value: 0.148426:  26%|██▌       | 26/100 [01:26<03:55,  3.18s/it]Best trial: 16. Best value: 0.148426:  27%|██▋       | 27/100 [01:26<03:49,  3.14s/it]Best trial: 16. Best value: 0.148426:  27%|██▋       | 27/100 [01:30<03:49,  3.14s/it]Best trial: 16. Best value: 0.148426:  28%|██▊       | 28/100 [01:30<04:00,  3.34s/it]Best trial: 16. Best value: 0.148426:  28%|██▊       | 28/100 [01:34<04:00,  3.34s/it]Best trial: 16. Best value: 0.148426:  29%|██▉       | 29/100 [01:34<04:09,  3.52s/it]Best trial: 16. Best value: 0.148426:  29%|██▉       | 29/100 [01:39<04:09,  3.52s/it]Best trial: 16. Best value: 0.148426:  30%|███       | 30/100 [01:39<04:40,  4.01s/it]Best trial: 16. Best value: 0.148426:  30%|███       | 30/100 [01:48<04:40,  4.01s/it]Best trial: 16. Best value: 0.148426:  31%|███       | 31/100 [01:48<06:15,  5.45s/it]Best trial: 16. Best value: 0.148426:  31%|███       | 31/100 [01:51<06:15,  5.45s/it]Best trial: 16. Best value: 0.148426:  32%|███▏      | 32/100 [01:51<05:18,  4.68s/it]Best trial: 16. Best value: 0.148426:  32%|███▏      | 32/100 [01:54<05:18,  4.68s/it]Best trial: 16. Best value: 0.148426:  33%|███▎      | 33/100 [01:54<04:38,  4.15s/it]Best trial: 16. Best value: 0.148426:  33%|███▎      | 33/100 [01:56<04:38,  4.15s/it]Best trial: 16. Best value: 0.148426:  34%|███▍      | 34/100 [01:56<04:02,  3.68s/it]Best trial: 16. Best value: 0.148426:  34%|███▍      | 34/100 [01:58<04:02,  3.68s/it]Best trial: 16. Best value: 0.148426:  35%|███▌      | 35/100 [01:58<03:25,  3.16s/it]Best trial: 16. Best value: 0.148426:  35%|███▌      | 35/100 [02:01<03:25,  3.16s/it]Best trial: 16. Best value: 0.148426:  36%|███▌      | 36/100 [02:01<03:03,  2.86s/it]Best trial: 16. Best value: 0.148426:  36%|███▌      | 36/100 [02:03<03:03,  2.86s/it]Best trial: 16. Best value: 0.148426:  37%|███▋      | 37/100 [02:03<02:45,  2.63s/it]Best trial: 16. Best value: 0.148426:  37%|███▋      | 37/100 [02:05<02:45,  2.63s/it]Best trial: 16. Best value: 0.148426:  38%|███▊      | 38/100 [02:05<02:32,  2.47s/it]Best trial: 16. Best value: 0.148426:  38%|███▊      | 38/100 [02:07<02:32,  2.47s/it]Best trial: 16. Best value: 0.148426:  39%|███▉      | 39/100 [02:07<02:33,  2.51s/it]Best trial: 16. Best value: 0.148426:  39%|███▉      | 39/100 [02:09<02:33,  2.51s/it]Best trial: 16. Best value: 0.148426:  40%|████      | 40/100 [02:09<02:15,  2.26s/it]Best trial: 16. Best value: 0.148426:  40%|████      | 40/100 [02:12<02:15,  2.26s/it]Best trial: 16. Best value: 0.148426:  41%|████      | 41/100 [02:12<02:22,  2.42s/it]Best trial: 16. Best value: 0.148426:  41%|████      | 41/100 [02:13<02:22,  2.42s/it]Best trial: 16. Best value: 0.148426:  42%|████▏     | 42/100 [02:13<02:07,  2.19s/it]Best trial: 16. Best value: 0.148426:  42%|████▏     | 42/100 [02:16<02:07,  2.19s/it]Best trial: 16. Best value: 0.148426:  43%|████▎     | 43/100 [02:16<02:09,  2.27s/it]Best trial: 16. Best value: 0.148426:  43%|████▎     | 43/100 [02:18<02:09,  2.27s/it]Best trial: 16. Best value: 0.148426:  44%|████▍     | 44/100 [02:18<02:11,  2.34s/it]Best trial: 16. Best value: 0.148426:  44%|████▍     | 44/100 [02:20<02:11,  2.34s/it]Best trial: 16. Best value: 0.148426:  45%|████▌     | 45/100 [02:20<02:01,  2.20s/it]Best trial: 16. Best value: 0.148426:  45%|████▌     | 45/100 [02:22<02:01,  2.20s/it]Best trial: 16. Best value: 0.148426:  46%|████▌     | 46/100 [02:22<01:57,  2.18s/it]Best trial: 16. Best value: 0.148426:  46%|████▌     | 46/100 [02:26<01:57,  2.18s/it]Best trial: 16. Best value: 0.148426:  47%|████▋     | 47/100 [02:26<02:14,  2.53s/it]Best trial: 16. Best value: 0.148426:  47%|████▋     | 47/100 [02:29<02:14,  2.53s/it]Best trial: 16. Best value: 0.148426:  48%|████▊     | 48/100 [02:29<02:27,  2.83s/it]Best trial: 16. Best value: 0.148426:  48%|████▊     | 48/100 [02:32<02:27,  2.83s/it]Best trial: 16. Best value: 0.148426:  49%|████▉     | 49/100 [02:32<02:16,  2.67s/it]Best trial: 16. Best value: 0.148426:  49%|████▉     | 49/100 [02:34<02:16,  2.67s/it]Best trial: 16. Best value: 0.148426:  50%|█████     | 50/100 [02:34<02:07,  2.55s/it]Best trial: 16. Best value: 0.148426:  50%|█████     | 50/100 [02:38<02:07,  2.55s/it]Best trial: 16. Best value: 0.148426:  51%|█████     | 51/100 [02:38<02:31,  3.09s/it]Best trial: 51. Best value: 0.150567:  51%|█████     | 51/100 [02:41<02:31,  3.09s/it]Best trial: 51. Best value: 0.150567:  52%|█████▏    | 52/100 [02:41<02:27,  3.07s/it]Best trial: 51. Best value: 0.150567:  52%|█████▏    | 52/100 [02:44<02:27,  3.07s/it]Best trial: 51. Best value: 0.150567:  53%|█████▎    | 53/100 [02:44<02:17,  2.93s/it]Best trial: 51. Best value: 0.150567:  53%|█████▎    | 53/100 [02:46<02:17,  2.93s/it]Best trial: 51. Best value: 0.150567:  54%|█████▍    | 54/100 [02:46<01:58,  2.57s/it]Best trial: 51. Best value: 0.150567:  54%|█████▍    | 54/100 [02:49<01:58,  2.57s/it]Best trial: 51. Best value: 0.150567:  55%|█████▌    | 55/100 [02:49<02:02,  2.72s/it]Best trial: 51. Best value: 0.150567:  55%|█████▌    | 55/100 [02:51<02:02,  2.72s/it]Best trial: 51. Best value: 0.150567:  56%|█████▌    | 56/100 [02:51<01:55,  2.62s/it]Best trial: 51. Best value: 0.150567:  56%|█████▌    | 56/100 [02:55<01:55,  2.62s/it]Best trial: 51. Best value: 0.150567:  57%|█████▋    | 57/100 [02:55<02:11,  3.05s/it]Best trial: 51. Best value: 0.150567:  57%|█████▋    | 57/100 [02:58<02:11,  3.05s/it]Best trial: 51. Best value: 0.150567:  58%|█████▊    | 58/100 [02:58<02:04,  2.97s/it]Best trial: 51. Best value: 0.150567:  58%|█████▊    | 58/100 [03:02<02:04,  2.97s/it]Best trial: 51. Best value: 0.150567:  59%|█████▉    | 59/100 [03:02<02:16,  3.33s/it]Best trial: 59. Best value: 0.163483:  59%|█████▉    | 59/100 [03:04<02:16,  3.33s/it]Best trial: 59. Best value: 0.163483:  60%|██████    | 60/100 [03:04<01:57,  2.94s/it]Best trial: 59. Best value: 0.163483:  60%|██████    | 60/100 [03:06<01:57,  2.94s/it]Best trial: 59. Best value: 0.163483:  61%|██████    | 61/100 [03:06<01:41,  2.61s/it]Best trial: 59. Best value: 0.163483:  61%|██████    | 61/100 [03:08<01:41,  2.61s/it]Best trial: 59. Best value: 0.163483:  62%|██████▏   | 62/100 [03:08<01:35,  2.52s/it]Best trial: 59. Best value: 0.163483:  62%|██████▏   | 62/100 [03:10<01:35,  2.52s/it]Best trial: 59. Best value: 0.163483:  63%|██████▎   | 63/100 [03:10<01:28,  2.39s/it]Best trial: 59. Best value: 0.163483:  63%|██████▎   | 63/100 [03:13<01:28,  2.39s/it]Best trial: 59. Best value: 0.163483:  64%|██████▍   | 64/100 [03:13<01:29,  2.48s/it]Best trial: 59. Best value: 0.163483:  64%|██████▍   | 64/100 [03:16<01:29,  2.48s/it]Best trial: 59. Best value: 0.163483:  65%|██████▌   | 65/100 [03:16<01:27,  2.51s/it]Best trial: 59. Best value: 0.163483:  65%|██████▌   | 65/100 [03:18<01:27,  2.51s/it]Best trial: 59. Best value: 0.163483:  66%|██████▌   | 66/100 [03:18<01:20,  2.36s/it]Best trial: 59. Best value: 0.163483:  66%|██████▌   | 66/100 [03:20<01:20,  2.36s/it]Best trial: 59. Best value: 0.163483:  67%|██████▋   | 67/100 [03:20<01:16,  2.32s/it]Best trial: 59. Best value: 0.163483:  67%|██████▋   | 67/100 [03:21<01:16,  2.32s/it]Best trial: 59. Best value: 0.163483:  68%|██████▊   | 68/100 [03:21<01:07,  2.11s/it]Best trial: 59. Best value: 0.163483:  68%|██████▊   | 68/100 [03:23<01:07,  2.11s/it]Best trial: 59. Best value: 0.163483:  69%|██████▉   | 69/100 [03:23<01:02,  2.02s/it]Best trial: 59. Best value: 0.163483:  69%|██████▉   | 69/100 [03:25<01:02,  2.02s/it]Best trial: 59. Best value: 0.163483:  70%|███████   | 70/100 [03:25<01:02,  2.07s/it]Best trial: 59. Best value: 0.163483:  70%|███████   | 70/100 [03:28<01:02,  2.07s/it]Best trial: 59. Best value: 0.163483:  71%|███████   | 71/100 [03:28<01:05,  2.27s/it]Best trial: 59. Best value: 0.163483:  71%|███████   | 71/100 [03:31<01:05,  2.27s/it]Best trial: 59. Best value: 0.163483:  72%|███████▏  | 72/100 [03:31<01:04,  2.31s/it]Best trial: 59. Best value: 0.163483:  72%|███████▏  | 72/100 [03:34<01:04,  2.31s/it]Best trial: 59. Best value: 0.163483:  73%|███████▎  | 73/100 [03:34<01:13,  2.72s/it]Best trial: 59. Best value: 0.163483:  73%|███████▎  | 73/100 [03:36<01:13,  2.72s/it]Best trial: 59. Best value: 0.163483:  74%|███████▍  | 74/100 [03:36<01:06,  2.57s/it]Best trial: 59. Best value: 0.163483:  74%|███████▍  | 74/100 [03:39<01:06,  2.57s/it]Best trial: 59. Best value: 0.163483:  75%|███████▌  | 75/100 [03:39<01:00,  2.43s/it]Best trial: 59. Best value: 0.163483:  75%|███████▌  | 75/100 [03:41<01:00,  2.43s/it]Best trial: 59. Best value: 0.163483:  76%|███████▌  | 76/100 [03:41<00:57,  2.39s/it]Best trial: 59. Best value: 0.163483:  76%|███████▌  | 76/100 [03:44<00:57,  2.39s/it]Best trial: 59. Best value: 0.163483:  77%|███████▋  | 77/100 [03:44<00:57,  2.50s/it]Best trial: 59. Best value: 0.163483:  77%|███████▋  | 77/100 [03:46<00:57,  2.50s/it]Best trial: 59. Best value: 0.163483:  78%|███████▊  | 78/100 [03:46<00:52,  2.37s/it]Best trial: 59. Best value: 0.163483:  78%|███████▊  | 78/100 [03:48<00:52,  2.37s/it]Best trial: 59. Best value: 0.163483:  79%|███████▉  | 79/100 [03:48<00:49,  2.37s/it]Best trial: 59. Best value: 0.163483:  79%|███████▉  | 79/100 [03:50<00:49,  2.37s/it]Best trial: 59. Best value: 0.163483:  80%|████████  | 80/100 [03:50<00:47,  2.35s/it]Best trial: 59. Best value: 0.163483:  80%|████████  | 80/100 [03:53<00:47,  2.35s/it]Best trial: 59. Best value: 0.163483:  81%|████████  | 81/100 [03:53<00:43,  2.30s/it]Best trial: 59. Best value: 0.163483:  81%|████████  | 81/100 [03:54<00:43,  2.30s/it]Best trial: 59. Best value: 0.163483:  82%|████████▏ | 82/100 [03:54<00:38,  2.14s/it]Best trial: 59. Best value: 0.163483:  82%|████████▏ | 82/100 [03:57<00:38,  2.14s/it]Best trial: 59. Best value: 0.163483:  83%|████████▎ | 83/100 [03:57<00:37,  2.20s/it]Best trial: 59. Best value: 0.163483:  83%|████████▎ | 83/100 [03:59<00:37,  2.20s/it]Best trial: 59. Best value: 0.163483:  84%|████████▍ | 84/100 [03:59<00:36,  2.26s/it]Best trial: 59. Best value: 0.163483:  84%|████████▍ | 84/100 [04:02<00:36,  2.26s/it]Best trial: 59. Best value: 0.163483:  85%|████████▌ | 85/100 [04:02<00:35,  2.35s/it]Best trial: 59. Best value: 0.163483:  85%|████████▌ | 85/100 [04:04<00:35,  2.35s/it]Best trial: 59. Best value: 0.163483:  86%|████████▌ | 86/100 [04:04<00:33,  2.38s/it]Best trial: 59. Best value: 0.163483:  86%|████████▌ | 86/100 [04:06<00:33,  2.38s/it]Best trial: 59. Best value: 0.163483:  87%|████████▋ | 87/100 [04:06<00:30,  2.37s/it]Best trial: 59. Best value: 0.163483:  87%|████████▋ | 87/100 [04:09<00:30,  2.37s/it]Best trial: 59. Best value: 0.163483:  88%|████████▊ | 88/100 [04:09<00:29,  2.49s/it]Best trial: 59. Best value: 0.163483:  88%|████████▊ | 88/100 [04:12<00:29,  2.49s/it]Best trial: 59. Best value: 0.163483:  89%|████████▉ | 89/100 [04:12<00:28,  2.56s/it]Best trial: 59. Best value: 0.163483:  89%|████████▉ | 89/100 [04:14<00:28,  2.56s/it]Best trial: 59. Best value: 0.163483:  90%|█████████ | 90/100 [04:14<00:24,  2.46s/it]Best trial: 59. Best value: 0.163483:  90%|█████████ | 90/100 [04:17<00:24,  2.46s/it]Best trial: 59. Best value: 0.163483:  91%|█████████ | 91/100 [04:17<00:22,  2.52s/it]Best trial: 59. Best value: 0.163483:  91%|█████████ | 91/100 [04:19<00:22,  2.52s/it]Best trial: 59. Best value: 0.163483:  92%|█████████▏| 92/100 [04:19<00:19,  2.45s/it]Best trial: 59. Best value: 0.163483:  92%|█████████▏| 92/100 [04:21<00:19,  2.45s/it]Best trial: 59. Best value: 0.163483:  93%|█████████▎| 93/100 [04:21<00:16,  2.35s/it]Best trial: 59. Best value: 0.163483:  93%|█████████▎| 93/100 [04:23<00:16,  2.35s/it]Best trial: 59. Best value: 0.163483:  94%|█████████▍| 94/100 [04:23<00:13,  2.27s/it]Best trial: 59. Best value: 0.163483:  94%|█████████▍| 94/100 [04:26<00:13,  2.27s/it]Best trial: 59. Best value: 0.163483:  95%|█████████▌| 95/100 [04:26<00:11,  2.32s/it]Best trial: 59. Best value: 0.163483:  95%|█████████▌| 95/100 [04:28<00:11,  2.32s/it]Best trial: 59. Best value: 0.163483:  96%|█████████▌| 96/100 [04:28<00:08,  2.17s/it]Best trial: 59. Best value: 0.163483:  96%|█████████▌| 96/100 [04:31<00:08,  2.17s/it]Best trial: 59. Best value: 0.163483:  97%|█████████▋| 97/100 [04:31<00:07,  2.47s/it]Best trial: 59. Best value: 0.163483:  97%|█████████▋| 97/100 [04:33<00:07,  2.47s/it]Best trial: 59. Best value: 0.163483:  98%|█████████▊| 98/100 [04:33<00:04,  2.46s/it]Best trial: 59. Best value: 0.163483:  98%|█████████▊| 98/100 [04:35<00:04,  2.46s/it]Best trial: 59. Best value: 0.163483:  99%|█████████▉| 99/100 [04:35<00:02,  2.42s/it]Best trial: 59. Best value: 0.163483:  99%|█████████▉| 99/100 [04:37<00:02,  2.42s/it]Best trial: 59. Best value: 0.163483: 100%|██████████| 100/100 [04:37<00:00,  2.28s/it]Best trial: 59. Best value: 0.163483: 100%|██████████| 100/100 [04:37<00:00,  2.78s/it]
2025-11-30 08:53:49,411 - INFO - HPO Complete. Best AUPRC: 0.1635
2025-11-30 08:53:49,411 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.07930630756804562, 'max_depth': 5, 'subsample': 0.9054913360433564, 'colsample_bytree': 0.8197052515908791, 'gamma': 3.146429722687669, 'reg_lambda': 1.2647434321987257e-08, 'reg_alpha': 1.9228873035555332e-08}
2025-11-30 08:53:49,412 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:53:51,226 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: ecg_only
2025-11-30 08:53:51,226 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:53:51,424 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:53:51,446 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:53:51,450 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:53:51,450 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:53:51,450 - INFO - Training model...
2025-11-30 08:53:54,161 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:53:59,327 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:53:59,327 - INFO - AUROC: 0.5964 (0.5040 - 0.6484)
2025-11-30 08:53:59,327 - INFO - AUPRC: 0.0886 (0.0516 - 0.1329)
2025-11-30 08:53:59,327 - INFO - Brier Score: 0.0536 (0.0424 - 0.0671)
2025-11-30 08:53:59,327 - INFO - Accuracy: 0.8671 (0.5503 - 0.9098)
2025-11-30 08:53:59,327 - INFO - Precision: 0.1410 (0.0634 - 0.2401)
2025-11-30 08:53:59,327 - INFO - Sensitivity (Recall): 0.3056 (0.1959 - 0.6368)
2025-11-30 08:53:59,327 - INFO - F1-Score: 0.1930 (0.1056 - 0.2744)
2025-11-30 08:53:59,327 - INFO - Best Threshold: 0.1200 (0.0400 - 0.2000)
2025-11-30 08:53:59,327 - INFO - Specificity: 0.8979 (0.5445 - 0.9447)
2025-11-30 08:53:59,343 - INFO - Calculating SHAP values...
2025-11-30 08:54:00,533 - INFO - SHAP plots saved.
2025-11-30 08:54:00,534 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:54:01,891 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: co2_only
2025-11-30 08:54:01,891 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:54:02,124 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:54:02,151 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:54:02,156 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:54:02,157 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.135883:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.135883:   1%|          | 1/100 [00:03<06:02,  3.66s/it]Best trial: 1. Best value: 0.160138:   1%|          | 1/100 [00:05<06:02,  3.66s/it]Best trial: 1. Best value: 0.160138:   2%|▏         | 2/100 [00:05<04:27,  2.73s/it]Best trial: 2. Best value: 0.163163:   2%|▏         | 2/100 [00:08<04:27,  2.73s/it]Best trial: 2. Best value: 0.163163:   3%|▎         | 3/100 [00:08<04:32,  2.81s/it]Best trial: 2. Best value: 0.163163:   3%|▎         | 3/100 [00:10<04:32,  2.81s/it]Best trial: 2. Best value: 0.163163:   4%|▍         | 4/100 [00:10<03:58,  2.48s/it]Best trial: 2. Best value: 0.163163:   4%|▍         | 4/100 [00:12<03:58,  2.48s/it]Best trial: 2. Best value: 0.163163:   5%|▌         | 5/100 [00:12<03:40,  2.32s/it]Best trial: 2. Best value: 0.163163:   5%|▌         | 5/100 [00:14<03:40,  2.32s/it]Best trial: 2. Best value: 0.163163:   6%|▌         | 6/100 [00:14<03:35,  2.29s/it]Best trial: 2. Best value: 0.163163:   6%|▌         | 6/100 [00:16<03:35,  2.29s/it]Best trial: 2. Best value: 0.163163:   7%|▋         | 7/100 [00:16<03:12,  2.07s/it]Best trial: 2. Best value: 0.163163:   7%|▋         | 7/100 [00:18<03:12,  2.07s/it]Best trial: 2. Best value: 0.163163:   8%|▊         | 8/100 [00:18<02:59,  1.95s/it]Best trial: 2. Best value: 0.163163:   8%|▊         | 8/100 [00:19<02:59,  1.95s/it]Best trial: 2. Best value: 0.163163:   9%|▉         | 9/100 [00:19<02:41,  1.78s/it]Best trial: 9. Best value: 0.178035:   9%|▉         | 9/100 [00:22<02:41,  1.78s/it]Best trial: 9. Best value: 0.178035:  10%|█         | 10/100 [00:22<03:00,  2.01s/it]Best trial: 9. Best value: 0.178035:  10%|█         | 10/100 [00:25<03:00,  2.01s/it]Best trial: 9. Best value: 0.178035:  11%|█         | 11/100 [00:25<03:40,  2.48s/it]Best trial: 9. Best value: 0.178035:  11%|█         | 11/100 [00:28<03:40,  2.48s/it]Best trial: 9. Best value: 0.178035:  12%|█▏        | 12/100 [00:28<03:42,  2.53s/it]Best trial: 9. Best value: 0.178035:  12%|█▏        | 12/100 [00:31<03:42,  2.53s/it]Best trial: 9. Best value: 0.178035:  13%|█▎        | 13/100 [00:31<04:05,  2.83s/it]Best trial: 9. Best value: 0.178035:  13%|█▎        | 13/100 [00:35<04:05,  2.83s/it]Best trial: 9. Best value: 0.178035:  14%|█▍        | 14/100 [00:35<04:28,  3.13s/it]Best trial: 9. Best value: 0.178035:  14%|█▍        | 14/100 [00:39<04:28,  3.13s/it]Best trial: 9. Best value: 0.178035:  15%|█▌        | 15/100 [00:39<04:33,  3.22s/it]Best trial: 9. Best value: 0.178035:  15%|█▌        | 15/100 [00:41<04:33,  3.22s/it]Best trial: 9. Best value: 0.178035:  16%|█▌        | 16/100 [00:41<04:13,  3.02s/it]Best trial: 9. Best value: 0.178035:  16%|█▌        | 16/100 [00:44<04:13,  3.02s/it]Best trial: 9. Best value: 0.178035:  17%|█▋        | 17/100 [00:44<04:18,  3.11s/it]Best trial: 9. Best value: 0.178035:  17%|█▋        | 17/100 [00:48<04:18,  3.11s/it]Best trial: 9. Best value: 0.178035:  18%|█▊        | 18/100 [00:48<04:18,  3.15s/it]Best trial: 9. Best value: 0.178035:  18%|█▊        | 18/100 [00:50<04:18,  3.15s/it]Best trial: 9. Best value: 0.178035:  19%|█▉        | 19/100 [00:50<03:54,  2.90s/it]Best trial: 9. Best value: 0.178035:  19%|█▉        | 19/100 [00:54<03:54,  2.90s/it]Best trial: 9. Best value: 0.178035:  20%|██        | 20/100 [00:54<04:16,  3.21s/it]Best trial: 9. Best value: 0.178035:  20%|██        | 20/100 [00:56<04:16,  3.21s/it]Best trial: 9. Best value: 0.178035:  21%|██        | 21/100 [00:56<03:41,  2.80s/it]Best trial: 9. Best value: 0.178035:  21%|██        | 21/100 [00:58<03:41,  2.80s/it]Best trial: 9. Best value: 0.178035:  22%|██▏       | 22/100 [00:58<03:27,  2.65s/it]Best trial: 9. Best value: 0.178035:  22%|██▏       | 22/100 [01:00<03:27,  2.65s/it]Best trial: 9. Best value: 0.178035:  23%|██▎       | 23/100 [01:00<03:16,  2.56s/it]Best trial: 9. Best value: 0.178035:  23%|██▎       | 23/100 [01:03<03:16,  2.56s/it]Best trial: 9. Best value: 0.178035:  24%|██▍       | 24/100 [01:03<03:20,  2.63s/it]Best trial: 9. Best value: 0.178035:  24%|██▍       | 24/100 [01:05<03:20,  2.63s/it]Best trial: 9. Best value: 0.178035:  25%|██▌       | 25/100 [01:05<02:56,  2.35s/it]Best trial: 9. Best value: 0.178035:  25%|██▌       | 25/100 [01:07<02:56,  2.35s/it]Best trial: 9. Best value: 0.178035:  26%|██▌       | 26/100 [01:07<02:56,  2.39s/it]Best trial: 9. Best value: 0.178035:  26%|██▌       | 26/100 [01:09<02:56,  2.39s/it]Best trial: 9. Best value: 0.178035:  27%|██▋       | 27/100 [01:09<02:42,  2.22s/it]Best trial: 9. Best value: 0.178035:  27%|██▋       | 27/100 [01:11<02:42,  2.22s/it]Best trial: 9. Best value: 0.178035:  28%|██▊       | 28/100 [01:11<02:33,  2.14s/it]Best trial: 9. Best value: 0.178035:  28%|██▊       | 28/100 [01:13<02:33,  2.14s/it]Best trial: 9. Best value: 0.178035:  29%|██▉       | 29/100 [01:13<02:33,  2.16s/it]Best trial: 9. Best value: 0.178035:  29%|██▉       | 29/100 [01:15<02:33,  2.16s/it]Best trial: 9. Best value: 0.178035:  30%|███       | 30/100 [01:15<02:25,  2.08s/it]Best trial: 9. Best value: 0.178035:  30%|███       | 30/100 [01:18<02:25,  2.08s/it]Best trial: 9. Best value: 0.178035:  31%|███       | 31/100 [01:18<02:30,  2.18s/it]Best trial: 9. Best value: 0.178035:  31%|███       | 31/100 [01:19<02:30,  2.18s/it]Best trial: 9. Best value: 0.178035:  32%|███▏      | 32/100 [01:19<02:17,  2.02s/it]Best trial: 9. Best value: 0.178035:  32%|███▏      | 32/100 [01:21<02:17,  2.02s/it]Best trial: 9. Best value: 0.178035:  33%|███▎      | 33/100 [01:21<02:15,  2.02s/it]Best trial: 9. Best value: 0.178035:  33%|███▎      | 33/100 [01:23<02:15,  2.02s/it]Best trial: 9. Best value: 0.178035:  34%|███▍      | 34/100 [01:23<02:13,  2.02s/it]Best trial: 9. Best value: 0.178035:  34%|███▍      | 34/100 [01:25<02:13,  2.02s/it]Best trial: 9. Best value: 0.178035:  35%|███▌      | 35/100 [01:25<02:11,  2.02s/it]Best trial: 9. Best value: 0.178035:  35%|███▌      | 35/100 [01:28<02:11,  2.02s/it]Best trial: 9. Best value: 0.178035:  36%|███▌      | 36/100 [01:28<02:16,  2.13s/it]Best trial: 9. Best value: 0.178035:  36%|███▌      | 36/100 [01:30<02:16,  2.13s/it]Best trial: 9. Best value: 0.178035:  37%|███▋      | 37/100 [01:30<02:13,  2.12s/it]Best trial: 9. Best value: 0.178035:  37%|███▋      | 37/100 [01:33<02:13,  2.12s/it]Best trial: 9. Best value: 0.178035:  38%|███▊      | 38/100 [01:33<02:23,  2.31s/it]Best trial: 9. Best value: 0.178035:  38%|███▊      | 38/100 [01:35<02:23,  2.31s/it]Best trial: 9. Best value: 0.178035:  39%|███▉      | 39/100 [01:35<02:16,  2.23s/it]Best trial: 9. Best value: 0.178035:  39%|███▉      | 39/100 [01:37<02:16,  2.23s/it]Best trial: 9. Best value: 0.178035:  40%|████      | 40/100 [01:37<02:12,  2.20s/it]Best trial: 9. Best value: 0.178035:  40%|████      | 40/100 [01:39<02:12,  2.20s/it]Best trial: 9. Best value: 0.178035:  41%|████      | 41/100 [01:39<02:10,  2.21s/it]Best trial: 9. Best value: 0.178035:  41%|████      | 41/100 [01:42<02:10,  2.21s/it]Best trial: 9. Best value: 0.178035:  42%|████▏     | 42/100 [01:42<02:22,  2.45s/it]Best trial: 9. Best value: 0.178035:  42%|████▏     | 42/100 [01:44<02:22,  2.45s/it]Best trial: 9. Best value: 0.178035:  43%|████▎     | 43/100 [01:44<02:16,  2.40s/it]Best trial: 9. Best value: 0.178035:  43%|████▎     | 43/100 [01:47<02:16,  2.40s/it]Best trial: 9. Best value: 0.178035:  44%|████▍     | 44/100 [01:47<02:12,  2.36s/it]Best trial: 9. Best value: 0.178035:  44%|████▍     | 44/100 [01:49<02:12,  2.36s/it]Best trial: 9. Best value: 0.178035:  45%|████▌     | 45/100 [01:49<02:05,  2.28s/it]Best trial: 9. Best value: 0.178035:  45%|████▌     | 45/100 [01:52<02:05,  2.28s/it]Best trial: 9. Best value: 0.178035:  46%|████▌     | 46/100 [01:52<02:11,  2.44s/it]Best trial: 9. Best value: 0.178035:  46%|████▌     | 46/100 [01:54<02:11,  2.44s/it]Best trial: 9. Best value: 0.178035:  47%|████▋     | 47/100 [01:54<02:02,  2.31s/it]Best trial: 9. Best value: 0.178035:  47%|████▋     | 47/100 [01:56<02:02,  2.31s/it]Best trial: 9. Best value: 0.178035:  48%|████▊     | 48/100 [01:56<02:02,  2.36s/it]Best trial: 9. Best value: 0.178035:  48%|████▊     | 48/100 [01:58<02:02,  2.36s/it]Best trial: 9. Best value: 0.178035:  49%|████▉     | 49/100 [01:58<01:55,  2.27s/it]Best trial: 9. Best value: 0.178035:  49%|████▉     | 49/100 [02:01<01:55,  2.27s/it]Best trial: 9. Best value: 0.178035:  50%|█████     | 50/100 [02:01<02:10,  2.60s/it]Best trial: 9. Best value: 0.178035:  50%|█████     | 50/100 [02:04<02:10,  2.60s/it]Best trial: 9. Best value: 0.178035:  51%|█████     | 51/100 [02:04<02:09,  2.65s/it]Best trial: 9. Best value: 0.178035:  51%|█████     | 51/100 [02:07<02:09,  2.65s/it]Best trial: 9. Best value: 0.178035:  52%|█████▏    | 52/100 [02:07<02:04,  2.59s/it]Best trial: 9. Best value: 0.178035:  52%|█████▏    | 52/100 [02:09<02:04,  2.59s/it]Best trial: 9. Best value: 0.178035:  53%|█████▎    | 53/100 [02:09<01:57,  2.50s/it]Best trial: 9. Best value: 0.178035:  53%|█████▎    | 53/100 [02:12<01:57,  2.50s/it]Best trial: 9. Best value: 0.178035:  54%|█████▍    | 54/100 [02:12<02:01,  2.64s/it]Best trial: 9. Best value: 0.178035:  54%|█████▍    | 54/100 [02:15<02:01,  2.64s/it]Best trial: 9. Best value: 0.178035:  55%|█████▌    | 55/100 [02:15<02:03,  2.74s/it]Best trial: 9. Best value: 0.178035:  55%|█████▌    | 55/100 [02:17<02:03,  2.74s/it]Best trial: 9. Best value: 0.178035:  56%|█████▌    | 56/100 [02:17<01:50,  2.52s/it]Best trial: 9. Best value: 0.178035:  56%|█████▌    | 56/100 [02:19<01:50,  2.52s/it]Best trial: 9. Best value: 0.178035:  57%|█████▋    | 57/100 [02:19<01:40,  2.33s/it]Best trial: 9. Best value: 0.178035:  57%|█████▋    | 57/100 [02:21<01:40,  2.33s/it]Best trial: 9. Best value: 0.178035:  58%|█████▊    | 58/100 [02:21<01:34,  2.24s/it]Best trial: 9. Best value: 0.178035:  58%|█████▊    | 58/100 [02:24<01:34,  2.24s/it]Best trial: 9. Best value: 0.178035:  59%|█████▉    | 59/100 [02:24<01:39,  2.43s/it]Best trial: 9. Best value: 0.178035:  59%|█████▉    | 59/100 [02:26<01:39,  2.43s/it]Best trial: 9. Best value: 0.178035:  60%|██████    | 60/100 [02:26<01:32,  2.32s/it]Best trial: 9. Best value: 0.178035:  60%|██████    | 60/100 [02:28<01:32,  2.32s/it]Best trial: 9. Best value: 0.178035:  61%|██████    | 61/100 [02:28<01:27,  2.24s/it]Best trial: 9. Best value: 0.178035:  61%|██████    | 61/100 [02:30<01:27,  2.24s/it]Best trial: 9. Best value: 0.178035:  62%|██████▏   | 62/100 [02:30<01:25,  2.24s/it]Best trial: 9. Best value: 0.178035:  62%|██████▏   | 62/100 [02:32<01:25,  2.24s/it]Best trial: 9. Best value: 0.178035:  63%|██████▎   | 63/100 [02:32<01:21,  2.22s/it]Best trial: 9. Best value: 0.178035:  63%|██████▎   | 63/100 [02:34<01:21,  2.22s/it]Best trial: 9. Best value: 0.178035:  64%|██████▍   | 64/100 [02:34<01:20,  2.24s/it]Best trial: 9. Best value: 0.178035:  64%|██████▍   | 64/100 [02:37<01:20,  2.24s/it]Best trial: 9. Best value: 0.178035:  65%|██████▌   | 65/100 [02:37<01:17,  2.20s/it]Best trial: 9. Best value: 0.178035:  65%|██████▌   | 65/100 [02:40<01:17,  2.20s/it]Best trial: 9. Best value: 0.178035:  66%|██████▌   | 66/100 [02:40<01:29,  2.64s/it]Best trial: 9. Best value: 0.178035:  66%|██████▌   | 66/100 [02:43<01:29,  2.64s/it]Best trial: 9. Best value: 0.178035:  67%|██████▋   | 67/100 [02:43<01:28,  2.68s/it]Best trial: 9. Best value: 0.178035:  67%|██████▋   | 67/100 [02:46<01:28,  2.68s/it]Best trial: 9. Best value: 0.178035:  68%|██████▊   | 68/100 [02:46<01:29,  2.80s/it]Best trial: 9. Best value: 0.178035:  68%|██████▊   | 68/100 [02:49<01:29,  2.80s/it]Best trial: 9. Best value: 0.178035:  69%|██████▉   | 69/100 [02:49<01:23,  2.70s/it]Best trial: 9. Best value: 0.178035:  69%|██████▉   | 69/100 [02:52<01:23,  2.70s/it]Best trial: 9. Best value: 0.178035:  70%|███████   | 70/100 [02:52<01:30,  3.00s/it]Best trial: 9. Best value: 0.178035:  70%|███████   | 70/100 [02:55<01:30,  3.00s/it]Best trial: 9. Best value: 0.178035:  71%|███████   | 71/100 [02:55<01:26,  2.98s/it]Best trial: 9. Best value: 0.178035:  71%|███████   | 71/100 [02:58<01:26,  2.98s/it]Best trial: 9. Best value: 0.178035:  72%|███████▏  | 72/100 [02:58<01:18,  2.81s/it]Best trial: 9. Best value: 0.178035:  72%|███████▏  | 72/100 [03:00<01:18,  2.81s/it]Best trial: 9. Best value: 0.178035:  73%|███████▎  | 73/100 [03:00<01:09,  2.57s/it]Best trial: 9. Best value: 0.178035:  73%|███████▎  | 73/100 [03:03<01:09,  2.57s/it]Best trial: 9. Best value: 0.178035:  74%|███████▍  | 74/100 [03:03<01:10,  2.71s/it]Best trial: 9. Best value: 0.178035:  74%|███████▍  | 74/100 [03:06<01:10,  2.71s/it]Best trial: 9. Best value: 0.178035:  75%|███████▌  | 75/100 [03:06<01:11,  2.85s/it]Best trial: 9. Best value: 0.178035:  75%|███████▌  | 75/100 [03:09<01:11,  2.85s/it]Best trial: 9. Best value: 0.178035:  76%|███████▌  | 76/100 [03:09<01:10,  2.94s/it]Best trial: 9. Best value: 0.178035:  76%|███████▌  | 76/100 [03:13<01:10,  2.94s/it]Best trial: 9. Best value: 0.178035:  77%|███████▋  | 77/100 [03:13<01:17,  3.39s/it]Best trial: 9. Best value: 0.178035:  77%|███████▋  | 77/100 [03:17<01:17,  3.39s/it]Best trial: 9. Best value: 0.178035:  78%|███████▊  | 78/100 [03:17<01:14,  3.38s/it]Best trial: 9. Best value: 0.178035:  78%|███████▊  | 78/100 [03:20<01:14,  3.38s/it]Best trial: 9. Best value: 0.178035:  79%|███████▉  | 79/100 [03:20<01:11,  3.39s/it]Best trial: 9. Best value: 0.178035:  79%|███████▉  | 79/100 [03:23<01:11,  3.39s/it]Best trial: 9. Best value: 0.178035:  80%|████████  | 80/100 [03:23<01:04,  3.23s/it]Best trial: 9. Best value: 0.178035:  80%|████████  | 80/100 [03:26<01:04,  3.23s/it]Best trial: 9. Best value: 0.178035:  81%|████████  | 81/100 [03:26<01:01,  3.24s/it]Best trial: 9. Best value: 0.178035:  81%|████████  | 81/100 [03:28<01:01,  3.24s/it]Best trial: 9. Best value: 0.178035:  82%|████████▏ | 82/100 [03:28<00:51,  2.84s/it]Best trial: 9. Best value: 0.178035:  82%|████████▏ | 82/100 [03:32<00:51,  2.84s/it]Best trial: 9. Best value: 0.178035:  83%|████████▎ | 83/100 [03:32<00:50,  2.97s/it]Best trial: 9. Best value: 0.178035:  83%|████████▎ | 83/100 [03:34<00:50,  2.97s/it]Best trial: 9. Best value: 0.178035:  84%|████████▍ | 84/100 [03:34<00:47,  2.94s/it]Best trial: 9. Best value: 0.178035:  84%|████████▍ | 84/100 [03:36<00:47,  2.94s/it]Best trial: 9. Best value: 0.178035:  85%|████████▌ | 85/100 [03:36<00:38,  2.59s/it]Best trial: 9. Best value: 0.178035:  85%|████████▌ | 85/100 [03:39<00:38,  2.59s/it]Best trial: 9. Best value: 0.178035:  86%|████████▌ | 86/100 [03:39<00:35,  2.55s/it]Best trial: 9. Best value: 0.178035:  86%|████████▌ | 86/100 [03:41<00:35,  2.55s/it]Best trial: 9. Best value: 0.178035:  87%|████████▋ | 87/100 [03:41<00:33,  2.57s/it]Best trial: 9. Best value: 0.178035:  87%|████████▋ | 87/100 [03:44<00:33,  2.57s/it]Best trial: 9. Best value: 0.178035:  88%|████████▊ | 88/100 [03:44<00:32,  2.75s/it]Best trial: 9. Best value: 0.178035:  88%|████████▊ | 88/100 [03:47<00:32,  2.75s/it]Best trial: 9. Best value: 0.178035:  89%|████████▉ | 89/100 [03:47<00:29,  2.70s/it]Best trial: 9. Best value: 0.178035:  89%|████████▉ | 89/100 [03:50<00:29,  2.70s/it]Best trial: 9. Best value: 0.178035:  90%|█████████ | 90/100 [03:50<00:27,  2.74s/it]Best trial: 9. Best value: 0.178035:  90%|█████████ | 90/100 [03:53<00:27,  2.74s/it]Best trial: 9. Best value: 0.178035:  91%|█████████ | 91/100 [03:53<00:26,  2.90s/it]Best trial: 9. Best value: 0.178035:  91%|█████████ | 91/100 [03:57<00:26,  2.90s/it]Best trial: 9. Best value: 0.178035:  92%|█████████▏| 92/100 [03:57<00:24,  3.07s/it]Best trial: 9. Best value: 0.178035:  92%|█████████▏| 92/100 [04:00<00:24,  3.07s/it]Best trial: 9. Best value: 0.178035:  93%|█████████▎| 93/100 [04:00<00:21,  3.03s/it]Best trial: 9. Best value: 0.178035:  93%|█████████▎| 93/100 [04:02<00:21,  3.03s/it]Best trial: 9. Best value: 0.178035:  94%|█████████▍| 94/100 [04:02<00:17,  2.84s/it]Best trial: 9. Best value: 0.178035:  94%|█████████▍| 94/100 [04:04<00:17,  2.84s/it]Best trial: 9. Best value: 0.178035:  95%|█████████▌| 95/100 [04:04<00:13,  2.69s/it]Best trial: 9. Best value: 0.178035:  95%|█████████▌| 95/100 [04:07<00:13,  2.69s/it]Best trial: 9. Best value: 0.178035:  96%|█████████▌| 96/100 [04:07<00:10,  2.74s/it]Best trial: 9. Best value: 0.178035:  96%|█████████▌| 96/100 [04:09<00:10,  2.74s/it]Best trial: 9. Best value: 0.178035:  97%|█████████▋| 97/100 [04:09<00:07,  2.61s/it]Best trial: 9. Best value: 0.178035:  97%|█████████▋| 97/100 [04:12<00:07,  2.61s/it]Best trial: 9. Best value: 0.178035:  98%|█████████▊| 98/100 [04:12<00:04,  2.46s/it]Best trial: 9. Best value: 0.178035:  98%|█████████▊| 98/100 [04:14<00:04,  2.46s/it]Best trial: 9. Best value: 0.178035:  99%|█████████▉| 99/100 [04:14<00:02,  2.54s/it]Best trial: 9. Best value: 0.178035:  99%|█████████▉| 99/100 [04:17<00:02,  2.54s/it]Best trial: 9. Best value: 0.178035: 100%|██████████| 100/100 [04:17<00:00,  2.69s/it]Best trial: 9. Best value: 0.178035: 100%|██████████| 100/100 [04:17<00:00,  2.58s/it]
2025-11-30 08:58:19,981 - INFO - HPO Complete. Best AUPRC: 0.1780
2025-11-30 08:58:19,981 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.0008301395063091369, 'max_depth': 6, 'subsample': 0.6771072213260456, 'colsample_bytree': 0.8495280694771962, 'gamma': 3.5860489892732916, 'reg_lambda': 0.00014229980234276452, 'reg_alpha': 6.47733125356184e-07}
2025-11-30 08:58:19,982 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 08:58:22,203 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: co2_only
2025-11-30 08:58:22,203 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:58:22,432 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:58:22,455 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:58:22,460 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:58:22,460 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 08:58:22,460 - INFO - Training model...
2025-11-30 08:58:23,760 - INFO - Evaluating model with bootstrapping...
2025-11-30 08:58:28,700 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 08:58:28,700 - INFO - AUROC: 0.6590 (0.5663 - 0.7372)
2025-11-30 08:58:28,700 - INFO - AUPRC: 0.1447 (0.0633 - 0.2444)
2025-11-30 08:58:28,700 - INFO - Brier Score: 0.2161 (0.2152 - 0.2186)
2025-11-30 08:58:28,700 - INFO - Accuracy: 0.8338 (0.7798 - 0.9549)
2025-11-30 08:58:28,700 - INFO - Precision: 0.1376 (0.0754 - 0.7500)
2025-11-30 08:58:28,700 - INFO - Sensitivity (Recall): 0.4167 (0.1550 - 0.5725)
2025-11-30 08:58:28,701 - INFO - F1-Score: 0.2069 (0.1209 - 0.2888)
2025-11-30 08:58:28,701 - INFO - Best Threshold: 0.4900 (0.4800 - 0.5340)
2025-11-30 08:58:28,701 - INFO - Specificity: 0.8567 (0.8066 - 0.9954)
2025-11-30 08:58:28,712 - INFO - Calculating SHAP values...
2025-11-30 08:58:29,931 - INFO - SHAP plots saved.
2025-11-30 08:58:29,932 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 08:58:31,439 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: awp_only
2025-11-30 08:58:31,439 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 08:58:31,642 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 08:58:31,663 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 08:58:31,668 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 08:58:31,668 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.145019:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.145019:   1%|          | 1/100 [00:02<04:09,  2.52s/it]Best trial: 1. Best value: 0.177952:   1%|          | 1/100 [00:05<04:09,  2.52s/it]Best trial: 1. Best value: 0.177952:   2%|▏         | 2/100 [00:05<04:46,  2.93s/it]Best trial: 1. Best value: 0.177952:   2%|▏         | 2/100 [00:09<04:46,  2.93s/it]Best trial: 1. Best value: 0.177952:   3%|▎         | 3/100 [00:09<05:06,  3.16s/it]Best trial: 1. Best value: 0.177952:   3%|▎         | 3/100 [00:12<05:06,  3.16s/it]Best trial: 1. Best value: 0.177952:   4%|▍         | 4/100 [00:12<05:18,  3.32s/it]Best trial: 1. Best value: 0.177952:   4%|▍         | 4/100 [00:16<05:18,  3.32s/it]Best trial: 1. Best value: 0.177952:   5%|▌         | 5/100 [00:16<05:41,  3.60s/it]Best trial: 1. Best value: 0.177952:   5%|▌         | 5/100 [00:20<05:41,  3.60s/it]Best trial: 1. Best value: 0.177952:   6%|▌         | 6/100 [00:20<05:48,  3.71s/it]Best trial: 1. Best value: 0.177952:   6%|▌         | 6/100 [00:25<05:48,  3.71s/it]Best trial: 1. Best value: 0.177952:   7%|▋         | 7/100 [00:25<06:23,  4.13s/it]Best trial: 1. Best value: 0.177952:   7%|▋         | 7/100 [00:28<06:23,  4.13s/it]Best trial: 1. Best value: 0.177952:   8%|▊         | 8/100 [00:28<05:32,  3.61s/it]Best trial: 1. Best value: 0.177952:   8%|▊         | 8/100 [00:31<05:32,  3.61s/it]Best trial: 1. Best value: 0.177952:   9%|▉         | 9/100 [00:31<05:10,  3.42s/it]Best trial: 1. Best value: 0.177952:   9%|▉         | 9/100 [00:34<05:10,  3.42s/it]Best trial: 1. Best value: 0.177952:  10%|█         | 10/100 [00:34<04:54,  3.27s/it]Best trial: 1. Best value: 0.177952:  10%|█         | 10/100 [00:37<04:54,  3.27s/it]Best trial: 1. Best value: 0.177952:  11%|█         | 11/100 [00:37<04:56,  3.33s/it]Best trial: 1. Best value: 0.177952:  11%|█         | 11/100 [00:41<04:56,  3.33s/it]Best trial: 1. Best value: 0.177952:  12%|█▏        | 12/100 [00:41<05:09,  3.51s/it]Best trial: 1. Best value: 0.177952:  12%|█▏        | 12/100 [00:44<05:09,  3.51s/it]Best trial: 1. Best value: 0.177952:  13%|█▎        | 13/100 [00:44<04:45,  3.28s/it]Best trial: 1. Best value: 0.177952:  13%|█▎        | 13/100 [00:46<04:45,  3.28s/it]Best trial: 1. Best value: 0.177952:  14%|█▍        | 14/100 [00:46<04:09,  2.90s/it]Best trial: 1. Best value: 0.177952:  14%|█▍        | 14/100 [00:48<04:09,  2.90s/it]Best trial: 1. Best value: 0.177952:  15%|█▌        | 15/100 [00:48<03:48,  2.68s/it]Best trial: 1. Best value: 0.177952:  15%|█▌        | 15/100 [00:51<03:48,  2.68s/it]Best trial: 1. Best value: 0.177952:  16%|█▌        | 16/100 [00:51<03:59,  2.85s/it]Best trial: 1. Best value: 0.177952:  16%|█▌        | 16/100 [00:54<03:59,  2.85s/it]Best trial: 1. Best value: 0.177952:  17%|█▋        | 17/100 [00:54<04:01,  2.91s/it]Best trial: 1. Best value: 0.177952:  17%|█▋        | 17/100 [00:57<04:01,  2.91s/it]Best trial: 1. Best value: 0.177952:  18%|█▊        | 18/100 [00:57<03:49,  2.80s/it]Best trial: 1. Best value: 0.177952:  18%|█▊        | 18/100 [01:00<03:49,  2.80s/it]Best trial: 1. Best value: 0.177952:  19%|█▉        | 19/100 [01:00<03:44,  2.77s/it]Best trial: 1. Best value: 0.177952:  19%|█▉        | 19/100 [01:03<03:44,  2.77s/it]Best trial: 1. Best value: 0.177952:  20%|██        | 20/100 [01:03<04:02,  3.03s/it]Best trial: 1. Best value: 0.177952:  20%|██        | 20/100 [01:06<04:02,  3.03s/it]Best trial: 1. Best value: 0.177952:  21%|██        | 21/100 [01:06<03:57,  3.01s/it]Best trial: 1. Best value: 0.177952:  21%|██        | 21/100 [01:09<03:57,  3.01s/it]Best trial: 1. Best value: 0.177952:  22%|██▏       | 22/100 [01:09<04:01,  3.09s/it]Best trial: 1. Best value: 0.177952:  22%|██▏       | 22/100 [01:12<04:01,  3.09s/it]Best trial: 1. Best value: 0.177952:  23%|██▎       | 23/100 [01:12<03:38,  2.84s/it]Best trial: 1. Best value: 0.177952:  23%|██▎       | 23/100 [01:15<03:38,  2.84s/it]Best trial: 1. Best value: 0.177952:  24%|██▍       | 24/100 [01:15<03:47,  2.99s/it]Best trial: 1. Best value: 0.177952:  24%|██▍       | 24/100 [01:20<03:47,  2.99s/it]Best trial: 1. Best value: 0.177952:  25%|██▌       | 25/100 [01:20<04:21,  3.48s/it]Best trial: 1. Best value: 0.177952:  25%|██▌       | 25/100 [01:23<04:21,  3.48s/it]Best trial: 1. Best value: 0.177952:  26%|██▌       | 26/100 [01:23<04:18,  3.50s/it]Best trial: 1. Best value: 0.177952:  26%|██▌       | 26/100 [01:27<04:18,  3.50s/it]Best trial: 1. Best value: 0.177952:  27%|██▋       | 27/100 [01:27<04:16,  3.52s/it]Best trial: 1. Best value: 0.177952:  27%|██▋       | 27/100 [01:33<04:16,  3.52s/it]Best trial: 1. Best value: 0.177952:  28%|██▊       | 28/100 [01:33<05:08,  4.29s/it]Best trial: 1. Best value: 0.177952:  28%|██▊       | 28/100 [01:36<05:08,  4.29s/it]Best trial: 1. Best value: 0.177952:  29%|██▉       | 29/100 [01:36<04:35,  3.88s/it]Best trial: 1. Best value: 0.177952:  29%|██▉       | 29/100 [01:39<04:35,  3.88s/it]Best trial: 1. Best value: 0.177952:  30%|███       | 30/100 [01:39<04:27,  3.83s/it]Best trial: 30. Best value: 0.194626:  30%|███       | 30/100 [01:43<04:27,  3.83s/it]Best trial: 30. Best value: 0.194626:  31%|███       | 31/100 [01:43<04:21,  3.79s/it]Best trial: 30. Best value: 0.194626:  31%|███       | 31/100 [01:46<04:21,  3.79s/it]Best trial: 30. Best value: 0.194626:  32%|███▏      | 32/100 [01:46<04:06,  3.63s/it]Best trial: 30. Best value: 0.194626:  32%|███▏      | 32/100 [01:49<04:06,  3.63s/it]Best trial: 30. Best value: 0.194626:  33%|███▎      | 33/100 [01:49<03:47,  3.40s/it]Best trial: 30. Best value: 0.194626:  33%|███▎      | 33/100 [01:54<03:47,  3.40s/it]Best trial: 30. Best value: 0.194626:  34%|███▍      | 34/100 [01:54<04:04,  3.70s/it]Best trial: 30. Best value: 0.194626:  34%|███▍      | 34/100 [01:58<04:04,  3.70s/it]Best trial: 30. Best value: 0.194626:  35%|███▌      | 35/100 [01:58<04:15,  3.93s/it]Best trial: 30. Best value: 0.194626:  35%|███▌      | 35/100 [02:02<04:15,  3.93s/it]Best trial: 30. Best value: 0.194626:  36%|███▌      | 36/100 [02:02<04:00,  3.75s/it]Best trial: 30. Best value: 0.194626:  36%|███▌      | 36/100 [02:06<04:00,  3.75s/it]Best trial: 30. Best value: 0.194626:  37%|███▋      | 37/100 [02:06<04:09,  3.96s/it]Best trial: 30. Best value: 0.194626:  37%|███▋      | 37/100 [02:09<04:09,  3.96s/it]Best trial: 30. Best value: 0.194626:  38%|███▊      | 38/100 [02:09<03:47,  3.67s/it]Best trial: 30. Best value: 0.194626:  38%|███▊      | 38/100 [02:12<03:47,  3.67s/it]Best trial: 30. Best value: 0.194626:  39%|███▉      | 39/100 [02:12<03:36,  3.55s/it]Best trial: 30. Best value: 0.194626:  39%|███▉      | 39/100 [02:15<03:36,  3.55s/it]Best trial: 30. Best value: 0.194626:  40%|████      | 40/100 [02:15<03:21,  3.36s/it]Best trial: 30. Best value: 0.194626:  40%|████      | 40/100 [02:19<03:21,  3.36s/it]Best trial: 30. Best value: 0.194626:  41%|████      | 41/100 [02:19<03:28,  3.54s/it]Best trial: 30. Best value: 0.194626:  41%|████      | 41/100 [02:22<03:28,  3.54s/it]Best trial: 30. Best value: 0.194626:  42%|████▏     | 42/100 [02:22<03:08,  3.25s/it]Best trial: 30. Best value: 0.194626:  42%|████▏     | 42/100 [02:25<03:08,  3.25s/it]Best trial: 30. Best value: 0.194626:  43%|████▎     | 43/100 [02:25<03:13,  3.40s/it]Best trial: 30. Best value: 0.194626:  43%|████▎     | 43/100 [02:28<03:13,  3.40s/it]Best trial: 30. Best value: 0.194626:  44%|████▍     | 44/100 [02:28<02:54,  3.12s/it]Best trial: 30. Best value: 0.194626:  44%|████▍     | 44/100 [02:31<02:54,  3.12s/it]Best trial: 30. Best value: 0.194626:  45%|████▌     | 45/100 [02:31<02:54,  3.18s/it]Best trial: 30. Best value: 0.194626:  45%|████▌     | 45/100 [02:35<02:54,  3.18s/it]Best trial: 30. Best value: 0.194626:  46%|████▌     | 46/100 [02:35<03:02,  3.38s/it]Best trial: 30. Best value: 0.194626:  46%|████▌     | 46/100 [02:37<03:02,  3.38s/it]Best trial: 30. Best value: 0.194626:  47%|████▋     | 47/100 [02:37<02:34,  2.92s/it]Best trial: 30. Best value: 0.194626:  47%|████▋     | 47/100 [02:40<02:34,  2.92s/it]Best trial: 30. Best value: 0.194626:  48%|████▊     | 48/100 [02:40<02:30,  2.90s/it]Best trial: 30. Best value: 0.194626:  48%|████▊     | 48/100 [02:43<02:30,  2.90s/it]Best trial: 30. Best value: 0.194626:  49%|████▉     | 49/100 [02:43<02:32,  2.98s/it]Best trial: 30. Best value: 0.194626:  49%|████▉     | 49/100 [02:45<02:32,  2.98s/it]Best trial: 30. Best value: 0.194626:  50%|█████     | 50/100 [02:45<02:19,  2.80s/it]Best trial: 30. Best value: 0.194626:  50%|█████     | 50/100 [02:48<02:19,  2.80s/it]Best trial: 30. Best value: 0.194626:  51%|█████     | 51/100 [02:48<02:10,  2.67s/it]Best trial: 30. Best value: 0.194626:  51%|█████     | 51/100 [02:51<02:10,  2.67s/it]Best trial: 30. Best value: 0.194626:  52%|█████▏    | 52/100 [02:51<02:18,  2.88s/it]Best trial: 30. Best value: 0.194626:  52%|█████▏    | 52/100 [02:53<02:18,  2.88s/it]Best trial: 30. Best value: 0.194626:  53%|█████▎    | 53/100 [02:53<02:04,  2.65s/it]Best trial: 30. Best value: 0.194626:  53%|█████▎    | 53/100 [02:56<02:04,  2.65s/it]Best trial: 30. Best value: 0.194626:  54%|█████▍    | 54/100 [02:56<01:59,  2.61s/it]Best trial: 30. Best value: 0.194626:  54%|█████▍    | 54/100 [02:59<01:59,  2.61s/it]Best trial: 30. Best value: 0.194626:  55%|█████▌    | 55/100 [02:59<02:04,  2.77s/it]Best trial: 30. Best value: 0.194626:  55%|█████▌    | 55/100 [03:02<02:04,  2.77s/it]Best trial: 30. Best value: 0.194626:  56%|█████▌    | 56/100 [03:02<02:07,  2.89s/it]Best trial: 30. Best value: 0.194626:  56%|█████▌    | 56/100 [03:06<02:07,  2.89s/it]Best trial: 30. Best value: 0.194626:  57%|█████▋    | 57/100 [03:06<02:12,  3.09s/it]Best trial: 30. Best value: 0.194626:  57%|█████▋    | 57/100 [03:09<02:12,  3.09s/it]Best trial: 30. Best value: 0.194626:  58%|█████▊    | 58/100 [03:09<02:14,  3.20s/it]Best trial: 30. Best value: 0.194626:  58%|█████▊    | 58/100 [03:13<02:14,  3.20s/it]Best trial: 30. Best value: 0.194626:  59%|█████▉    | 59/100 [03:13<02:24,  3.54s/it]Best trial: 30. Best value: 0.194626:  59%|█████▉    | 59/100 [03:18<02:24,  3.54s/it]Best trial: 30. Best value: 0.194626:  60%|██████    | 60/100 [03:18<02:30,  3.76s/it]Best trial: 30. Best value: 0.194626:  60%|██████    | 60/100 [03:20<02:30,  3.76s/it]Best trial: 30. Best value: 0.194626:  61%|██████    | 61/100 [03:20<02:09,  3.33s/it]Best trial: 30. Best value: 0.194626:  61%|██████    | 61/100 [03:24<02:09,  3.33s/it]Best trial: 30. Best value: 0.194626:  62%|██████▏   | 62/100 [03:24<02:09,  3.41s/it]Best trial: 30. Best value: 0.194626:  62%|██████▏   | 62/100 [03:26<02:09,  3.41s/it]Best trial: 30. Best value: 0.194626:  63%|██████▎   | 63/100 [03:26<01:55,  3.13s/it]Best trial: 30. Best value: 0.194626:  63%|██████▎   | 63/100 [03:29<01:55,  3.13s/it]Best trial: 30. Best value: 0.194626:  64%|██████▍   | 64/100 [03:29<01:46,  2.96s/it]Best trial: 30. Best value: 0.194626:  64%|██████▍   | 64/100 [03:31<01:46,  2.96s/it]Best trial: 30. Best value: 0.194626:  65%|██████▌   | 65/100 [03:31<01:36,  2.76s/it]Best trial: 30. Best value: 0.194626:  65%|██████▌   | 65/100 [03:33<01:36,  2.76s/it]Best trial: 30. Best value: 0.194626:  66%|██████▌   | 66/100 [03:33<01:25,  2.52s/it]Best trial: 30. Best value: 0.194626:  66%|██████▌   | 66/100 [03:35<01:25,  2.52s/it]Best trial: 30. Best value: 0.194626:  67%|██████▋   | 67/100 [03:35<01:24,  2.55s/it]Best trial: 30. Best value: 0.194626:  67%|██████▋   | 67/100 [03:38<01:24,  2.55s/it]Best trial: 30. Best value: 0.194626:  68%|██████▊   | 68/100 [03:38<01:25,  2.68s/it]Best trial: 30. Best value: 0.194626:  68%|██████▊   | 68/100 [03:42<01:25,  2.68s/it]Best trial: 30. Best value: 0.194626:  69%|██████▉   | 69/100 [03:42<01:34,  3.06s/it]Best trial: 30. Best value: 0.194626:  69%|██████▉   | 69/100 [03:46<01:34,  3.06s/it]Best trial: 30. Best value: 0.194626:  70%|███████   | 70/100 [03:46<01:38,  3.29s/it]Best trial: 30. Best value: 0.194626:  70%|███████   | 70/100 [03:49<01:38,  3.29s/it]Best trial: 30. Best value: 0.194626:  71%|███████   | 71/100 [03:49<01:32,  3.21s/it]Best trial: 30. Best value: 0.194626:  71%|███████   | 71/100 [03:53<01:32,  3.21s/it]Best trial: 30. Best value: 0.194626:  72%|███████▏  | 72/100 [03:53<01:31,  3.26s/it]Best trial: 30. Best value: 0.194626:  72%|███████▏  | 72/100 [03:55<01:31,  3.26s/it]Best trial: 30. Best value: 0.194626:  73%|███████▎  | 73/100 [03:55<01:23,  3.08s/it]Best trial: 30. Best value: 0.194626:  73%|███████▎  | 73/100 [03:58<01:23,  3.08s/it]Best trial: 30. Best value: 0.194626:  74%|███████▍  | 74/100 [03:58<01:15,  2.91s/it]Best trial: 30. Best value: 0.194626:  74%|███████▍  | 74/100 [04:00<01:15,  2.91s/it]Best trial: 30. Best value: 0.194626:  75%|███████▌  | 75/100 [04:00<01:07,  2.70s/it]Best trial: 30. Best value: 0.194626:  75%|███████▌  | 75/100 [04:04<01:07,  2.70s/it]Best trial: 30. Best value: 0.194626:  76%|███████▌  | 76/100 [04:04<01:14,  3.11s/it]Best trial: 30. Best value: 0.194626:  76%|███████▌  | 76/100 [04:08<01:14,  3.11s/it]Best trial: 30. Best value: 0.194626:  77%|███████▋  | 77/100 [04:08<01:16,  3.33s/it]Best trial: 30. Best value: 0.194626:  77%|███████▋  | 77/100 [04:11<01:16,  3.33s/it]Best trial: 30. Best value: 0.194626:  78%|███████▊  | 78/100 [04:11<01:10,  3.19s/it]Best trial: 30. Best value: 0.194626:  78%|███████▊  | 78/100 [04:14<01:10,  3.19s/it]Best trial: 30. Best value: 0.194626:  79%|███████▉  | 79/100 [04:14<01:06,  3.15s/it]Best trial: 30. Best value: 0.194626:  79%|███████▉  | 79/100 [04:18<01:06,  3.15s/it]Best trial: 30. Best value: 0.194626:  80%|████████  | 80/100 [04:18<01:12,  3.61s/it]Best trial: 30. Best value: 0.194626:  80%|████████  | 80/100 [04:22<01:12,  3.61s/it]Best trial: 30. Best value: 0.194626:  81%|████████  | 81/100 [04:22<01:05,  3.46s/it]Best trial: 30. Best value: 0.194626:  81%|████████  | 81/100 [04:25<01:05,  3.46s/it]Best trial: 30. Best value: 0.194626:  82%|████████▏ | 82/100 [04:25<00:59,  3.32s/it]Best trial: 30. Best value: 0.194626:  82%|████████▏ | 82/100 [04:27<00:59,  3.32s/it]Best trial: 30. Best value: 0.194626:  83%|████████▎ | 83/100 [04:27<00:52,  3.10s/it]Best trial: 30. Best value: 0.194626:  83%|████████▎ | 83/100 [04:31<00:52,  3.10s/it]Best trial: 30. Best value: 0.194626:  84%|████████▍ | 84/100 [04:31<00:53,  3.32s/it]Best trial: 30. Best value: 0.194626:  84%|████████▍ | 84/100 [04:33<00:53,  3.32s/it]Best trial: 30. Best value: 0.194626:  85%|████████▌ | 85/100 [04:33<00:45,  3.02s/it]Best trial: 30. Best value: 0.194626:  85%|████████▌ | 85/100 [04:38<00:45,  3.02s/it]Best trial: 30. Best value: 0.194626:  86%|████████▌ | 86/100 [04:38<00:48,  3.49s/it]Best trial: 30. Best value: 0.194626:  86%|████████▌ | 86/100 [04:42<00:48,  3.49s/it]Best trial: 30. Best value: 0.194626:  87%|████████▋ | 87/100 [04:42<00:46,  3.54s/it]Best trial: 30. Best value: 0.194626:  87%|████████▋ | 87/100 [04:45<00:46,  3.54s/it]Best trial: 30. Best value: 0.194626:  88%|████████▊ | 88/100 [04:45<00:41,  3.50s/it]Best trial: 30. Best value: 0.194626:  88%|████████▊ | 88/100 [04:48<00:41,  3.50s/it]Best trial: 30. Best value: 0.194626:  89%|████████▉ | 89/100 [04:48<00:36,  3.34s/it]Best trial: 30. Best value: 0.194626:  89%|████████▉ | 89/100 [04:51<00:36,  3.34s/it]Best trial: 30. Best value: 0.194626:  90%|█████████ | 90/100 [04:51<00:32,  3.24s/it]Best trial: 30. Best value: 0.194626:  90%|█████████ | 90/100 [04:55<00:32,  3.24s/it]Best trial: 30. Best value: 0.194626:  91%|█████████ | 91/100 [04:55<00:31,  3.52s/it]Best trial: 30. Best value: 0.194626:  91%|█████████ | 91/100 [04:59<00:31,  3.52s/it]Best trial: 30. Best value: 0.194626:  92%|█████████▏| 92/100 [04:59<00:28,  3.62s/it]Best trial: 30. Best value: 0.194626:  92%|█████████▏| 92/100 [05:02<00:28,  3.62s/it]Best trial: 30. Best value: 0.194626:  93%|█████████▎| 93/100 [05:02<00:24,  3.56s/it]Best trial: 30. Best value: 0.194626:  93%|█████████▎| 93/100 [05:06<00:24,  3.56s/it]Best trial: 30. Best value: 0.194626:  94%|█████████▍| 94/100 [05:06<00:21,  3.58s/it]Best trial: 30. Best value: 0.194626:  94%|█████████▍| 94/100 [05:10<00:21,  3.58s/it]Best trial: 30. Best value: 0.194626:  95%|█████████▌| 95/100 [05:10<00:18,  3.66s/it]Best trial: 30. Best value: 0.194626:  95%|█████████▌| 95/100 [05:12<00:18,  3.66s/it]Best trial: 30. Best value: 0.194626:  96%|█████████▌| 96/100 [05:12<00:13,  3.33s/it]Best trial: 30. Best value: 0.194626:  96%|█████████▌| 96/100 [05:16<00:13,  3.33s/it]Best trial: 30. Best value: 0.194626:  97%|█████████▋| 97/100 [05:16<00:09,  3.32s/it]Best trial: 30. Best value: 0.194626:  97%|█████████▋| 97/100 [05:18<00:09,  3.32s/it]Best trial: 30. Best value: 0.194626:  98%|█████████▊| 98/100 [05:18<00:06,  3.12s/it]Best trial: 30. Best value: 0.194626:  98%|█████████▊| 98/100 [05:22<00:06,  3.12s/it]Best trial: 30. Best value: 0.194626:  99%|█████████▉| 99/100 [05:22<00:03,  3.29s/it]Best trial: 30. Best value: 0.194626:  99%|█████████▉| 99/100 [05:27<00:03,  3.29s/it]Best trial: 30. Best value: 0.194626: 100%|██████████| 100/100 [05:27<00:00,  3.70s/it]Best trial: 30. Best value: 0.194626: 100%|██████████| 100/100 [05:27<00:00,  3.27s/it]
2025-11-30 09:03:58,931 - INFO - HPO Complete. Best AUPRC: 0.1946
2025-11-30 09:03:58,931 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.05472451272910459, 'max_depth': 8, 'subsample': 0.737367022968886, 'colsample_bytree': 0.6098852221608368, 'gamma': 1.9393049846250974, 'reg_lambda': 5.5395351275563026e-06, 'reg_alpha': 1.294232255044683e-06}
2025-11-30 09:03:58,932 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 09:04:00,933 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: awp_only
2025-11-30 09:04:00,934 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:04:01,128 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:04:01,149 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:04:01,153 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 09:04:01,153 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 09:04:01,153 - INFO - Training model...
2025-11-30 09:04:02,784 - INFO - Evaluating model with bootstrapping...
2025-11-30 09:04:07,751 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 09:04:07,751 - INFO - AUROC: 0.6621 (0.5642 - 0.7483)
2025-11-30 09:04:07,751 - INFO - AUPRC: 0.1454 (0.0693 - 0.2646)
2025-11-30 09:04:07,751 - INFO - Brier Score: 0.0505 (0.0360 - 0.0663)
2025-11-30 09:04:07,751 - INFO - Accuracy: 0.9017 (0.4306 - 0.9471)
2025-11-30 09:04:07,751 - INFO - Precision: 0.1800 (0.0696 - 0.6033)
2025-11-30 09:04:07,751 - INFO - Sensitivity (Recall): 0.2500 (0.1409 - 0.7867)
2025-11-30 09:04:07,751 - INFO - F1-Score: 0.2093 (0.1268 - 0.3006)
2025-11-30 09:04:07,751 - INFO - Best Threshold: 0.1600 (0.0100 - 0.5020)
2025-11-30 09:04:07,751 - INFO - Specificity: 0.9375 (0.4087 - 0.9911)
2025-11-30 09:04:07,763 - INFO - Calculating SHAP values...
2025-11-30 09:04:08,893 - INFO - SHAP plots saved.
2025-11-30 09:04:08,895 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 09:04:10,160 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: all_waveforms
2025-11-30 09:04:10,160 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:04:10,398 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:04:10,473 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:04:10,488 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 09:04:10,488 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.163326:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.163326:   1%|          | 1/100 [00:05<09:33,  5.79s/it]Best trial: 1. Best value: 0.164443:   1%|          | 1/100 [00:23<09:33,  5.79s/it]Best trial: 1. Best value: 0.164443:   2%|▏         | 2/100 [00:23<20:48, 12.74s/it]Best trial: 2. Best value: 0.165862:   2%|▏         | 2/100 [00:27<20:48, 12.74s/it]Best trial: 2. Best value: 0.165862:   3%|▎         | 3/100 [00:27<14:23,  8.91s/it]Best trial: 3. Best value: 0.182082:   3%|▎         | 3/100 [00:49<14:23,  8.91s/it]Best trial: 3. Best value: 0.182082:   4%|▍         | 4/100 [00:49<22:38, 14.15s/it]Best trial: 3. Best value: 0.182082:   4%|▍         | 4/100 [01:04<22:38, 14.15s/it]Best trial: 3. Best value: 0.182082:   5%|▌         | 5/100 [01:04<22:22, 14.13s/it]Best trial: 3. Best value: 0.182082:   5%|▌         | 5/100 [01:15<22:22, 14.13s/it]Best trial: 3. Best value: 0.182082:   6%|▌         | 6/100 [01:15<20:33, 13.12s/it]Best trial: 6. Best value: 0.192506:   6%|▌         | 6/100 [01:27<20:33, 13.12s/it]Best trial: 6. Best value: 0.192506:   7%|▋         | 7/100 [01:27<19:53, 12.83s/it]Best trial: 6. Best value: 0.192506:   7%|▋         | 7/100 [01:41<19:53, 12.83s/it]Best trial: 6. Best value: 0.192506:   8%|▊         | 8/100 [01:41<20:30, 13.37s/it]Best trial: 6. Best value: 0.192506:   8%|▊         | 8/100 [01:51<20:30, 13.37s/it]Best trial: 6. Best value: 0.192506:   9%|▉         | 9/100 [01:51<18:14, 12.02s/it]Best trial: 6. Best value: 0.192506:   9%|▉         | 9/100 [02:04<18:14, 12.02s/it]Best trial: 6. Best value: 0.192506:  10%|█         | 10/100 [02:04<18:42, 12.47s/it]Best trial: 6. Best value: 0.192506:  10%|█         | 10/100 [02:20<18:42, 12.47s/it]Best trial: 6. Best value: 0.192506:  11%|█         | 11/100 [02:20<19:54, 13.42s/it]Best trial: 11. Best value: 0.195449:  11%|█         | 11/100 [02:27<19:54, 13.42s/it]Best trial: 11. Best value: 0.195449:  12%|█▏        | 12/100 [02:27<17:01, 11.61s/it]Best trial: 11. Best value: 0.195449:  12%|█▏        | 12/100 [02:34<17:01, 11.61s/it]Best trial: 11. Best value: 0.195449:  13%|█▎        | 13/100 [02:34<14:47, 10.21s/it]Best trial: 11. Best value: 0.195449:  13%|█▎        | 13/100 [02:45<14:47, 10.21s/it]Best trial: 11. Best value: 0.195449:  14%|█▍        | 14/100 [02:45<14:51, 10.36s/it]Best trial: 11. Best value: 0.195449:  14%|█▍        | 14/100 [02:51<14:51, 10.36s/it]Best trial: 11. Best value: 0.195449:  15%|█▌        | 15/100 [02:51<13:01,  9.19s/it]Best trial: 11. Best value: 0.195449:  15%|█▌        | 15/100 [02:56<13:01,  9.19s/it]Best trial: 11. Best value: 0.195449:  16%|█▌        | 16/100 [02:56<11:07,  7.95s/it]Best trial: 11. Best value: 0.195449:  16%|█▌        | 16/100 [03:11<11:07,  7.95s/it]Best trial: 11. Best value: 0.195449:  17%|█▋        | 17/100 [03:11<13:48,  9.98s/it]Best trial: 11. Best value: 0.195449:  17%|█▋        | 17/100 [03:19<13:48,  9.98s/it]Best trial: 11. Best value: 0.195449:  18%|█▊        | 18/100 [03:19<12:46,  9.35s/it]Best trial: 11. Best value: 0.195449:  18%|█▊        | 18/100 [03:33<12:46,  9.35s/it]Best trial: 11. Best value: 0.195449:  19%|█▉        | 19/100 [03:33<14:33, 10.78s/it]Best trial: 11. Best value: 0.195449:  19%|█▉        | 19/100 [03:46<14:33, 10.78s/it]Best trial: 11. Best value: 0.195449:  20%|██        | 20/100 [03:46<15:14, 11.43s/it]Best trial: 11. Best value: 0.195449:  20%|██        | 20/100 [03:52<15:14, 11.43s/it]Best trial: 11. Best value: 0.195449:  21%|██        | 21/100 [03:52<12:59,  9.87s/it]Best trial: 11. Best value: 0.195449:  21%|██        | 21/100 [03:58<12:59,  9.87s/it]Best trial: 11. Best value: 0.195449:  22%|██▏       | 22/100 [03:58<11:20,  8.72s/it]Best trial: 11. Best value: 0.195449:  22%|██▏       | 22/100 [04:08<11:20,  8.72s/it]Best trial: 11. Best value: 0.195449:  23%|██▎       | 23/100 [04:08<11:28,  8.94s/it]Best trial: 11. Best value: 0.195449:  23%|██▎       | 23/100 [04:15<11:28,  8.94s/it]Best trial: 11. Best value: 0.195449:  24%|██▍       | 24/100 [04:15<10:40,  8.43s/it]Best trial: 11. Best value: 0.195449:  24%|██▍       | 24/100 [04:25<10:40,  8.43s/it]Best trial: 11. Best value: 0.195449:  25%|██▌       | 25/100 [04:25<11:02,  8.83s/it]Best trial: 25. Best value: 0.196394:  25%|██▌       | 25/100 [04:36<11:02,  8.83s/it]Best trial: 25. Best value: 0.196394:  26%|██▌       | 26/100 [04:36<11:50,  9.60s/it]Best trial: 25. Best value: 0.196394:  26%|██▌       | 26/100 [04:45<11:50,  9.60s/it]Best trial: 25. Best value: 0.196394:  27%|██▋       | 27/100 [04:45<11:16,  9.27s/it]Best trial: 25. Best value: 0.196394:  27%|██▋       | 27/100 [04:59<11:16,  9.27s/it]Best trial: 25. Best value: 0.196394:  28%|██▊       | 28/100 [04:59<13:04, 10.90s/it]Best trial: 25. Best value: 0.196394:  28%|██▊       | 28/100 [05:09<13:04, 10.90s/it]Best trial: 25. Best value: 0.196394:  29%|██▉       | 29/100 [05:09<12:27, 10.53s/it]Best trial: 25. Best value: 0.196394:  29%|██▉       | 29/100 [05:14<12:27, 10.53s/it]Best trial: 25. Best value: 0.196394:  30%|███       | 30/100 [05:14<10:26,  8.94s/it]Best trial: 25. Best value: 0.196394:  30%|███       | 30/100 [05:20<10:26,  8.94s/it]Best trial: 25. Best value: 0.196394:  31%|███       | 31/100 [05:20<09:18,  8.10s/it]Best trial: 25. Best value: 0.196394:  31%|███       | 31/100 [05:29<09:18,  8.10s/it]Best trial: 25. Best value: 0.196394:  32%|███▏      | 32/100 [05:29<09:22,  8.27s/it]Best trial: 25. Best value: 0.196394:  32%|███▏      | 32/100 [05:40<09:22,  8.27s/it]Best trial: 25. Best value: 0.196394:  33%|███▎      | 33/100 [05:40<10:02,  8.99s/it]Best trial: 25. Best value: 0.196394:  33%|███▎      | 33/100 [05:52<10:02,  8.99s/it]Best trial: 25. Best value: 0.196394:  34%|███▍      | 34/100 [05:52<10:51,  9.87s/it]Best trial: 25. Best value: 0.196394:  34%|███▍      | 34/100 [05:59<10:51,  9.87s/it]Best trial: 25. Best value: 0.196394:  35%|███▌      | 35/100 [05:59<10:00,  9.23s/it]Best trial: 25. Best value: 0.196394:  35%|███▌      | 35/100 [06:10<10:00,  9.23s/it]Best trial: 25. Best value: 0.196394:  36%|███▌      | 36/100 [06:10<10:24,  9.76s/it]Best trial: 25. Best value: 0.196394:  36%|███▌      | 36/100 [06:16<10:24,  9.76s/it]Best trial: 25. Best value: 0.196394:  37%|███▋      | 37/100 [06:16<08:59,  8.56s/it]Best trial: 25. Best value: 0.196394:  37%|███▋      | 37/100 [06:28<08:59,  8.56s/it]Best trial: 25. Best value: 0.196394:  38%|███▊      | 38/100 [06:28<10:02,  9.71s/it]Best trial: 25. Best value: 0.196394:  38%|███▊      | 38/100 [06:40<10:02,  9.71s/it]Best trial: 25. Best value: 0.196394:  39%|███▉      | 39/100 [06:40<10:34, 10.40s/it]Best trial: 25. Best value: 0.196394:  39%|███▉      | 39/100 [06:48<10:34, 10.40s/it]Best trial: 25. Best value: 0.196394:  40%|████      | 40/100 [06:48<09:38,  9.64s/it]Best trial: 25. Best value: 0.196394:  40%|████      | 40/100 [07:01<09:38,  9.64s/it]Best trial: 25. Best value: 0.196394:  41%|████      | 41/100 [07:01<10:24, 10.58s/it]Best trial: 25. Best value: 0.196394:  41%|████      | 41/100 [07:11<10:24, 10.58s/it]Best trial: 25. Best value: 0.196394:  42%|████▏     | 42/100 [07:11<10:01, 10.37s/it]Best trial: 25. Best value: 0.196394:  42%|████▏     | 42/100 [07:21<10:01, 10.37s/it]Best trial: 25. Best value: 0.196394:  43%|████▎     | 43/100 [07:21<09:46, 10.29s/it]Best trial: 43. Best value: 0.202258:  43%|████▎     | 43/100 [07:31<09:46, 10.29s/it]Best trial: 43. Best value: 0.202258:  44%|████▍     | 44/100 [07:31<09:35, 10.29s/it]Best trial: 44. Best value: 0.206406:  44%|████▍     | 44/100 [07:48<09:35, 10.29s/it]Best trial: 44. Best value: 0.206406:  45%|████▌     | 45/100 [07:48<11:09, 12.18s/it]Best trial: 44. Best value: 0.206406:  45%|████▌     | 45/100 [08:00<11:09, 12.18s/it]Best trial: 44. Best value: 0.206406:  46%|████▌     | 46/100 [08:00<10:50, 12.05s/it]Best trial: 44. Best value: 0.206406:  46%|████▌     | 46/100 [08:10<10:50, 12.05s/it]Best trial: 44. Best value: 0.206406:  47%|████▋     | 47/100 [08:10<10:11, 11.53s/it]Best trial: 44. Best value: 0.206406:  47%|████▋     | 47/100 [08:18<10:11, 11.53s/it]Best trial: 44. Best value: 0.206406:  48%|████▊     | 48/100 [08:18<09:06, 10.52s/it]Best trial: 44. Best value: 0.206406:  48%|████▊     | 48/100 [08:26<09:06, 10.52s/it]Best trial: 44. Best value: 0.206406:  49%|████▉     | 49/100 [08:26<08:13,  9.68s/it]Best trial: 44. Best value: 0.206406:  49%|████▉     | 49/100 [08:38<08:13,  9.68s/it]Best trial: 44. Best value: 0.206406:  50%|█████     | 50/100 [08:38<08:41, 10.43s/it]Best trial: 44. Best value: 0.206406:  50%|█████     | 50/100 [08:48<08:41, 10.43s/it]Best trial: 44. Best value: 0.206406:  51%|█████     | 51/100 [08:48<08:22, 10.26s/it]Best trial: 44. Best value: 0.206406:  51%|█████     | 51/100 [08:56<08:22, 10.26s/it]Best trial: 44. Best value: 0.206406:  52%|█████▏    | 52/100 [08:56<07:43,  9.66s/it]Best trial: 44. Best value: 0.206406:  52%|█████▏    | 52/100 [09:05<07:43,  9.66s/it]Best trial: 44. Best value: 0.206406:  53%|█████▎    | 53/100 [09:05<07:23,  9.43s/it]Best trial: 44. Best value: 0.206406:  53%|█████▎    | 53/100 [09:15<07:23,  9.43s/it]Best trial: 44. Best value: 0.206406:  54%|█████▍    | 54/100 [09:15<07:19,  9.56s/it]Best trial: 44. Best value: 0.206406:  54%|█████▍    | 54/100 [09:26<07:19,  9.56s/it]Best trial: 44. Best value: 0.206406:  55%|█████▌    | 55/100 [09:26<07:33, 10.08s/it]Best trial: 44. Best value: 0.206406:  55%|█████▌    | 55/100 [09:36<07:33, 10.08s/it]Best trial: 44. Best value: 0.206406:  56%|█████▌    | 56/100 [09:36<07:23, 10.09s/it]Best trial: 44. Best value: 0.206406:  56%|█████▌    | 56/100 [09:44<07:23, 10.09s/it]Best trial: 44. Best value: 0.206406:  57%|█████▋    | 57/100 [09:44<06:37,  9.25s/it]Best trial: 44. Best value: 0.206406:  57%|█████▋    | 57/100 [09:50<06:37,  9.25s/it]Best trial: 44. Best value: 0.206406:  58%|█████▊    | 58/100 [09:50<05:55,  8.46s/it]Best trial: 44. Best value: 0.206406:  58%|█████▊    | 58/100 [10:00<05:55,  8.46s/it]Best trial: 44. Best value: 0.206406:  59%|█████▉    | 59/100 [10:00<06:05,  8.92s/it]Best trial: 44. Best value: 0.206406:  59%|█████▉    | 59/100 [10:07<06:05,  8.92s/it]Best trial: 44. Best value: 0.206406:  60%|██████    | 60/100 [10:07<05:31,  8.28s/it]Best trial: 44. Best value: 0.206406:  60%|██████    | 60/100 [10:14<05:31,  8.28s/it]Best trial: 44. Best value: 0.206406:  61%|██████    | 61/100 [10:14<05:07,  7.87s/it]Best trial: 44. Best value: 0.206406:  61%|██████    | 61/100 [10:20<05:07,  7.87s/it]Best trial: 44. Best value: 0.206406:  62%|██████▏   | 62/100 [10:20<04:40,  7.38s/it]Best trial: 44. Best value: 0.206406:  62%|██████▏   | 62/100 [10:26<04:40,  7.38s/it]Best trial: 44. Best value: 0.206406:  63%|██████▎   | 63/100 [10:26<04:19,  7.01s/it]Best trial: 44. Best value: 0.206406:  63%|██████▎   | 63/100 [10:31<04:19,  7.01s/it]Best trial: 44. Best value: 0.206406:  64%|██████▍   | 64/100 [10:31<03:43,  6.20s/it]Best trial: 44. Best value: 0.206406:  64%|██████▍   | 64/100 [10:38<03:43,  6.20s/it]Best trial: 44. Best value: 0.206406:  65%|██████▌   | 65/100 [10:38<03:48,  6.54s/it]Best trial: 44. Best value: 0.206406:  65%|██████▌   | 65/100 [10:46<03:48,  6.54s/it]Best trial: 44. Best value: 0.206406:  66%|██████▌   | 66/100 [10:46<03:54,  6.89s/it]Best trial: 44. Best value: 0.206406:  66%|██████▌   | 66/100 [10:54<03:54,  6.89s/it]Best trial: 44. Best value: 0.206406:  67%|██████▋   | 67/100 [10:54<04:02,  7.36s/it]Best trial: 44. Best value: 0.206406:  67%|██████▋   | 67/100 [10:59<04:02,  7.36s/it]Best trial: 44. Best value: 0.206406:  68%|██████▊   | 68/100 [10:59<03:34,  6.72s/it]Best trial: 44. Best value: 0.206406:  68%|██████▊   | 68/100 [11:04<03:34,  6.72s/it]Best trial: 44. Best value: 0.206406:  69%|██████▉   | 69/100 [11:04<03:07,  6.04s/it]Best trial: 44. Best value: 0.206406:  69%|██████▉   | 69/100 [11:11<03:07,  6.04s/it]Best trial: 44. Best value: 0.206406:  70%|███████   | 70/100 [11:11<03:10,  6.34s/it]Best trial: 44. Best value: 0.206406:  70%|███████   | 70/100 [11:18<03:10,  6.34s/it]Best trial: 44. Best value: 0.206406:  71%|███████   | 71/100 [11:18<03:09,  6.52s/it]Best trial: 44. Best value: 0.206406:  71%|███████   | 71/100 [11:25<03:09,  6.52s/it]Best trial: 44. Best value: 0.206406:  72%|███████▏  | 72/100 [11:25<03:06,  6.67s/it]Best trial: 44. Best value: 0.206406:  72%|███████▏  | 72/100 [11:32<03:06,  6.67s/it]Best trial: 44. Best value: 0.206406:  73%|███████▎  | 73/100 [11:32<03:04,  6.84s/it]Best trial: 44. Best value: 0.206406:  73%|███████▎  | 73/100 [11:40<03:04,  6.84s/it]Best trial: 44. Best value: 0.206406:  74%|███████▍  | 74/100 [11:40<03:10,  7.32s/it]Best trial: 44. Best value: 0.206406:  74%|███████▍  | 74/100 [11:46<03:10,  7.32s/it]Best trial: 44. Best value: 0.206406:  75%|███████▌  | 75/100 [11:46<02:50,  6.84s/it]Best trial: 44. Best value: 0.206406:  75%|███████▌  | 75/100 [11:51<02:50,  6.84s/it]Best trial: 44. Best value: 0.206406:  76%|███████▌  | 76/100 [11:51<02:32,  6.37s/it]Best trial: 44. Best value: 0.206406:  76%|███████▌  | 76/100 [11:56<02:32,  6.37s/it]Best trial: 44. Best value: 0.206406:  77%|███████▋  | 77/100 [11:56<02:14,  5.84s/it]Best trial: 44. Best value: 0.206406:  77%|███████▋  | 77/100 [12:01<02:14,  5.84s/it]Best trial: 44. Best value: 0.206406:  78%|███████▊  | 78/100 [12:01<02:02,  5.55s/it]Best trial: 44. Best value: 0.206406:  78%|███████▊  | 78/100 [12:07<02:02,  5.55s/it]Best trial: 44. Best value: 0.206406:  79%|███████▉  | 79/100 [12:07<01:59,  5.70s/it]Best trial: 79. Best value: 0.206589:  79%|███████▉  | 79/100 [12:15<01:59,  5.70s/it]Best trial: 79. Best value: 0.206589:  80%|████████  | 80/100 [12:15<02:06,  6.30s/it]Best trial: 79. Best value: 0.206589:  80%|████████  | 80/100 [12:22<02:06,  6.30s/it]Best trial: 79. Best value: 0.206589:  81%|████████  | 81/100 [12:22<02:05,  6.62s/it]Best trial: 79. Best value: 0.206589:  81%|████████  | 81/100 [12:30<02:05,  6.62s/it]Best trial: 79. Best value: 0.206589:  82%|████████▏ | 82/100 [12:30<02:08,  7.14s/it]Best trial: 82. Best value: 0.207864:  82%|████████▏ | 82/100 [12:38<02:08,  7.14s/it]Best trial: 82. Best value: 0.207864:  83%|████████▎ | 83/100 [12:38<02:05,  7.40s/it]Best trial: 82. Best value: 0.207864:  83%|████████▎ | 83/100 [12:50<02:05,  7.40s/it]Best trial: 82. Best value: 0.207864:  84%|████████▍ | 84/100 [12:50<02:20,  8.80s/it]Best trial: 82. Best value: 0.207864:  84%|████████▍ | 84/100 [13:04<02:20,  8.80s/it]Best trial: 82. Best value: 0.207864:  85%|████████▌ | 85/100 [13:04<02:34, 10.33s/it]Best trial: 82. Best value: 0.207864:  85%|████████▌ | 85/100 [13:17<02:34, 10.33s/it]Best trial: 82. Best value: 0.207864:  86%|████████▌ | 86/100 [13:17<02:33, 10.99s/it]Best trial: 82. Best value: 0.207864:  86%|████████▌ | 86/100 [13:21<02:33, 10.99s/it]Best trial: 82. Best value: 0.207864:  87%|████████▋ | 87/100 [13:21<01:56,  8.93s/it]Best trial: 82. Best value: 0.207864:  87%|████████▋ | 87/100 [13:26<01:56,  8.93s/it]Best trial: 82. Best value: 0.207864:  88%|████████▊ | 88/100 [13:26<01:33,  7.82s/it]Best trial: 82. Best value: 0.207864:  88%|████████▊ | 88/100 [13:40<01:33,  7.82s/it]Best trial: 82. Best value: 0.207864:  89%|████████▉ | 89/100 [13:40<01:44,  9.49s/it]Best trial: 82. Best value: 0.207864:  89%|████████▉ | 89/100 [13:45<01:44,  9.49s/it]Best trial: 82. Best value: 0.207864:  90%|█████████ | 90/100 [13:45<01:22,  8.23s/it]Best trial: 82. Best value: 0.207864:  90%|█████████ | 90/100 [13:50<01:22,  8.23s/it]Best trial: 82. Best value: 0.207864:  91%|█████████ | 91/100 [13:50<01:04,  7.17s/it]Best trial: 91. Best value: 0.208026:  91%|█████████ | 91/100 [13:56<01:04,  7.17s/it]Best trial: 91. Best value: 0.208026:  92%|█████████▏| 92/100 [13:56<00:55,  6.97s/it]Best trial: 92. Best value: 0.209758:  92%|█████████▏| 92/100 [14:10<00:55,  6.97s/it]Best trial: 92. Best value: 0.209758:  93%|█████████▎| 93/100 [14:10<01:02,  8.99s/it]Best trial: 92. Best value: 0.209758:  93%|█████████▎| 93/100 [14:30<01:02,  8.99s/it]Best trial: 92. Best value: 0.209758:  94%|█████████▍| 94/100 [14:30<01:13, 12.26s/it]Best trial: 92. Best value: 0.209758:  94%|█████████▍| 94/100 [14:41<01:13, 12.26s/it]Best trial: 92. Best value: 0.209758:  95%|█████████▌| 95/100 [14:41<00:59, 11.87s/it]Best trial: 92. Best value: 0.209758:  95%|█████████▌| 95/100 [14:52<00:59, 11.87s/it]Best trial: 92. Best value: 0.209758:  96%|█████████▌| 96/100 [14:52<00:47, 11.75s/it]Best trial: 92. Best value: 0.209758:  96%|█████████▌| 96/100 [15:15<00:47, 11.75s/it]Best trial: 92. Best value: 0.209758:  97%|█████████▋| 97/100 [15:15<00:44, 14.98s/it]Best trial: 92. Best value: 0.209758:  97%|█████████▋| 97/100 [15:28<00:44, 14.98s/it]Best trial: 92. Best value: 0.209758:  98%|█████████▊| 98/100 [15:28<00:29, 14.59s/it]Best trial: 92. Best value: 0.209758:  98%|█████████▊| 98/100 [15:40<00:29, 14.59s/it]Best trial: 92. Best value: 0.209758:  99%|█████████▉| 99/100 [15:40<00:13, 13.62s/it]Best trial: 92. Best value: 0.209758:  99%|█████████▉| 99/100 [15:55<00:13, 13.62s/it]Best trial: 92. Best value: 0.209758: 100%|██████████| 100/100 [15:55<00:00, 14.25s/it]Best trial: 92. Best value: 0.209758: 100%|██████████| 100/100 [15:55<00:00,  9.56s/it]
2025-11-30 09:20:06,435 - INFO - HPO Complete. Best AUPRC: 0.2098
2025-11-30 09:20:06,435 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.05082573244978739, 'max_depth': 9, 'subsample': 0.7152998789907538, 'colsample_bytree': 0.6940017553574238, 'gamma': 0.8519781639038706, 'reg_lambda': 2.501928404243547e-07, 'reg_alpha': 2.7749571139457526e-07}
2025-11-30 09:20:06,436 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 09:20:08,704 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: all_waveforms
2025-11-30 09:20:08,705 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:20:08,953 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:20:09,025 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:20:09,039 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 09:20:09,040 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 09:20:09,040 - INFO - Training model...
2025-11-30 09:20:15,316 - INFO - Evaluating model with bootstrapping...
2025-11-30 09:20:21,942 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 09:20:21,942 - INFO - AUROC: 0.6960 (0.5683 - 0.7609)
2025-11-30 09:20:21,942 - INFO - AUPRC: 0.2699 (0.0923 - 0.3766)
2025-11-30 09:20:21,942 - INFO - Brier Score: 0.0439 (0.0329 - 0.0577)
2025-11-30 09:20:21,943 - INFO - Accuracy: 0.9523 (0.8503 - 0.9668)
2025-11-30 09:20:21,943 - INFO - Precision: 0.6154 (0.1556 - 0.8743)
2025-11-30 09:20:21,943 - INFO - Sensitivity (Recall): 0.2222 (0.1376 - 0.5505)
2025-11-30 09:20:21,943 - INFO - F1-Score: 0.3265 (0.1535 - 0.4767)
2025-11-30 09:20:21,943 - INFO - Best Threshold: 0.2300 (0.0360 - 0.2860)
2025-11-30 09:20:21,943 - INFO - Specificity: 0.9924 (0.8758 - 0.9985)
2025-11-30 09:20:21,960 - INFO - Calculating SHAP values...
2025-11-30 09:20:23,250 - INFO - SHAP plots saved.
2025-11-30 09:20:23,252 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 09:20:24,878 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 09:20:24,878 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:20:25,105 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:20:25,191 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:20:25,222 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 09:20:25,223 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.46712:   0%|          | 0/100 [00:14<?, ?it/s]Best trial: 0. Best value: 0.46712:   1%|          | 1/100 [00:14<24:01, 14.56s/it]Best trial: 0. Best value: 0.46712:   1%|          | 1/100 [00:19<24:01, 14.56s/it]Best trial: 0. Best value: 0.46712:   2%|▏         | 2/100 [00:19<14:31,  8.90s/it]Best trial: 0. Best value: 0.46712:   2%|▏         | 2/100 [00:27<14:31,  8.90s/it]Best trial: 0. Best value: 0.46712:   3%|▎         | 3/100 [00:27<13:39,  8.45s/it]Best trial: 3. Best value: 0.486282:   3%|▎         | 3/100 [00:42<13:39,  8.45s/it]Best trial: 3. Best value: 0.486282:   4%|▍         | 4/100 [00:42<17:59, 11.25s/it]Best trial: 3. Best value: 0.486282:   4%|▍         | 4/100 [00:57<17:59, 11.25s/it]Best trial: 3. Best value: 0.486282:   5%|▌         | 5/100 [00:57<19:33, 12.35s/it]Best trial: 3. Best value: 0.486282:   5%|▌         | 5/100 [01:10<19:33, 12.35s/it]Best trial: 3. Best value: 0.486282:   6%|▌         | 6/100 [01:10<20:03, 12.80s/it]Best trial: 3. Best value: 0.486282:   6%|▌         | 6/100 [01:23<20:03, 12.80s/it]Best trial: 3. Best value: 0.486282:   7%|▋         | 7/100 [01:23<19:38, 12.67s/it]Best trial: 3. Best value: 0.486282:   7%|▋         | 7/100 [01:38<19:38, 12.67s/it]Best trial: 3. Best value: 0.486282:   8%|▊         | 8/100 [01:38<20:41, 13.49s/it]Best trial: 3. Best value: 0.486282:   8%|▊         | 8/100 [01:53<20:41, 13.49s/it]Best trial: 3. Best value: 0.486282:   9%|▉         | 9/100 [01:53<21:13, 13.99s/it]Best trial: 3. Best value: 0.486282:   9%|▉         | 9/100 [02:08<21:13, 13.99s/it]Best trial: 3. Best value: 0.486282:  10%|█         | 10/100 [02:08<21:19, 14.22s/it]Best trial: 3. Best value: 0.486282:  10%|█         | 10/100 [02:21<21:19, 14.22s/it]Best trial: 3. Best value: 0.486282:  11%|█         | 11/100 [02:21<20:32, 13.85s/it]Best trial: 3. Best value: 0.486282:  11%|█         | 11/100 [02:37<20:32, 13.85s/it]Best trial: 3. Best value: 0.486282:  12%|█▏        | 12/100 [02:37<21:05, 14.38s/it]Best trial: 3. Best value: 0.486282:  12%|█▏        | 12/100 [02:55<21:05, 14.38s/it]Best trial: 3. Best value: 0.486282:  13%|█▎        | 13/100 [02:55<22:34, 15.57s/it]Best trial: 3. Best value: 0.486282:  13%|█▎        | 13/100 [03:03<22:34, 15.57s/it]Best trial: 3. Best value: 0.486282:  14%|█▍        | 14/100 [03:03<19:18, 13.47s/it]Best trial: 3. Best value: 0.486282:  14%|█▍        | 14/100 [03:14<19:18, 13.47s/it]Best trial: 3. Best value: 0.486282:  15%|█▌        | 15/100 [03:14<17:44, 12.53s/it]Best trial: 3. Best value: 0.486282:  15%|█▌        | 15/100 [03:26<17:44, 12.53s/it]Best trial: 3. Best value: 0.486282:  16%|█▌        | 16/100 [03:26<17:12, 12.29s/it]Best trial: 3. Best value: 0.486282:  16%|█▌        | 16/100 [03:41<17:12, 12.29s/it]Best trial: 3. Best value: 0.486282:  17%|█▋        | 17/100 [03:41<18:08, 13.11s/it]Best trial: 3. Best value: 0.486282:  17%|█▋        | 17/100 [03:55<18:08, 13.11s/it]Best trial: 3. Best value: 0.486282:  18%|█▊        | 18/100 [03:55<18:34, 13.59s/it]Best trial: 3. Best value: 0.486282:  18%|█▊        | 18/100 [04:07<18:34, 13.59s/it]Best trial: 3. Best value: 0.486282:  19%|█▉        | 19/100 [04:07<17:33, 13.01s/it]Best trial: 3. Best value: 0.486282:  19%|█▉        | 19/100 [04:25<17:33, 13.01s/it]Best trial: 3. Best value: 0.486282:  20%|██        | 20/100 [04:25<19:18, 14.48s/it]Best trial: 3. Best value: 0.486282:  20%|██        | 20/100 [04:37<19:18, 14.48s/it]Best trial: 3. Best value: 0.486282:  21%|██        | 21/100 [04:37<18:03, 13.71s/it]Best trial: 3. Best value: 0.486282:  21%|██        | 21/100 [04:48<18:03, 13.71s/it]Best trial: 3. Best value: 0.486282:  22%|██▏       | 22/100 [04:48<16:50, 12.96s/it]Best trial: 3. Best value: 0.486282:  22%|██▏       | 22/100 [05:01<16:50, 12.96s/it]Best trial: 3. Best value: 0.486282:  23%|██▎       | 23/100 [05:01<16:37, 12.95s/it]Best trial: 3. Best value: 0.486282:  23%|██▎       | 23/100 [05:24<16:37, 12.95s/it]Best trial: 3. Best value: 0.486282:  24%|██▍       | 24/100 [05:24<20:16, 16.00s/it]Best trial: 3. Best value: 0.486282:  24%|██▍       | 24/100 [05:41<20:16, 16.00s/it]Best trial: 3. Best value: 0.486282:  25%|██▌       | 25/100 [05:41<20:11, 16.16s/it]Best trial: 3. Best value: 0.486282:  25%|██▌       | 25/100 [06:00<20:11, 16.16s/it]Best trial: 3. Best value: 0.486282:  26%|██▌       | 26/100 [06:00<21:03, 17.08s/it]Best trial: 3. Best value: 0.486282:  26%|██▌       | 26/100 [06:15<21:03, 17.08s/it]Best trial: 3. Best value: 0.486282:  27%|██▋       | 27/100 [06:15<20:03, 16.48s/it]Best trial: 3. Best value: 0.486282:  27%|██▋       | 27/100 [06:29<20:03, 16.48s/it]Best trial: 3. Best value: 0.486282:  28%|██▊       | 28/100 [06:29<18:49, 15.69s/it]Best trial: 3. Best value: 0.486282:  28%|██▊       | 28/100 [06:41<18:49, 15.69s/it]Best trial: 3. Best value: 0.486282:  29%|██▉       | 29/100 [06:41<17:28, 14.77s/it]Best trial: 3. Best value: 0.486282:  29%|██▉       | 29/100 [06:55<17:28, 14.77s/it]Best trial: 3. Best value: 0.486282:  30%|███       | 30/100 [06:55<17:00, 14.58s/it]Best trial: 3. Best value: 0.486282:  30%|███       | 30/100 [07:06<17:00, 14.58s/it]Best trial: 3. Best value: 0.486282:  31%|███       | 31/100 [07:06<15:21, 13.35s/it]Best trial: 3. Best value: 0.486282:  31%|███       | 31/100 [07:22<15:21, 13.35s/it]Best trial: 3. Best value: 0.486282:  32%|███▏      | 32/100 [07:22<16:05, 14.20s/it]Best trial: 3. Best value: 0.486282:  32%|███▏      | 32/100 [07:38<16:05, 14.20s/it]Best trial: 3. Best value: 0.486282:  33%|███▎      | 33/100 [07:38<16:20, 14.63s/it]Best trial: 3. Best value: 0.486282:  33%|███▎      | 33/100 [07:55<16:20, 14.63s/it]Best trial: 3. Best value: 0.486282:  34%|███▍      | 34/100 [07:55<16:58, 15.42s/it]Best trial: 3. Best value: 0.486282:  34%|███▍      | 34/100 [08:13<16:58, 15.42s/it]Best trial: 3. Best value: 0.486282:  35%|███▌      | 35/100 [08:13<17:37, 16.27s/it]Best trial: 3. Best value: 0.486282:  35%|███▌      | 35/100 [08:58<17:37, 16.27s/it]Best trial: 3. Best value: 0.486282:  36%|███▌      | 36/100 [08:58<26:23, 24.74s/it]Best trial: 3. Best value: 0.486282:  36%|███▌      | 36/100 [09:09<26:23, 24.74s/it]Best trial: 3. Best value: 0.486282:  37%|███▋      | 37/100 [09:09<21:52, 20.83s/it]Best trial: 3. Best value: 0.486282:  37%|███▋      | 37/100 [09:34<21:52, 20.83s/it]Best trial: 3. Best value: 0.486282:  38%|███▊      | 38/100 [09:34<22:36, 21.87s/it]Best trial: 38. Best value: 0.495142:  38%|███▊      | 38/100 [09:41<22:36, 21.87s/it]Best trial: 38. Best value: 0.495142:  39%|███▉      | 39/100 [09:41<17:43, 17.44s/it]Best trial: 38. Best value: 0.495142:  39%|███▉      | 39/100 [09:46<17:43, 17.44s/it]Best trial: 38. Best value: 0.495142:  40%|████      | 40/100 [09:46<13:43, 13.73s/it]Best trial: 38. Best value: 0.495142:  40%|████      | 40/100 [09:57<13:43, 13.73s/it]Best trial: 38. Best value: 0.495142:  41%|████      | 41/100 [09:57<12:39, 12.87s/it]Best trial: 38. Best value: 0.495142:  41%|████      | 41/100 [10:08<12:39, 12.87s/it]Best trial: 38. Best value: 0.495142:  42%|████▏     | 42/100 [10:08<12:02, 12.46s/it]Best trial: 38. Best value: 0.495142:  42%|████▏     | 42/100 [10:13<12:02, 12.46s/it]Best trial: 38. Best value: 0.495142:  43%|████▎     | 43/100 [10:13<09:44, 10.25s/it]Best trial: 38. Best value: 0.495142:  43%|████▎     | 43/100 [10:27<09:44, 10.25s/it]Best trial: 38. Best value: 0.495142:  44%|████▍     | 44/100 [10:27<10:31, 11.27s/it]Best trial: 38. Best value: 0.495142:  44%|████▍     | 44/100 [10:37<10:31, 11.27s/it]Best trial: 38. Best value: 0.495142:  45%|████▌     | 45/100 [10:37<09:55, 10.83s/it]Best trial: 38. Best value: 0.495142:  45%|████▌     | 45/100 [10:49<09:55, 10.83s/it]Best trial: 38. Best value: 0.495142:  46%|████▌     | 46/100 [10:49<10:07, 11.24s/it]Best trial: 38. Best value: 0.495142:  46%|████▌     | 46/100 [10:59<10:07, 11.24s/it]Best trial: 38. Best value: 0.495142:  47%|████▋     | 47/100 [10:59<09:27, 10.71s/it]Best trial: 38. Best value: 0.495142:  47%|████▋     | 47/100 [11:13<09:27, 10.71s/it]Best trial: 38. Best value: 0.495142:  48%|████▊     | 48/100 [11:13<10:15, 11.83s/it]Best trial: 38. Best value: 0.495142:  48%|████▊     | 48/100 [11:24<10:15, 11.83s/it]Best trial: 38. Best value: 0.495142:  49%|████▉     | 49/100 [11:24<09:55, 11.68s/it]Best trial: 38. Best value: 0.495142:  49%|████▉     | 49/100 [11:38<09:55, 11.68s/it]Best trial: 38. Best value: 0.495142:  50%|█████     | 50/100 [11:38<10:13, 12.28s/it]Best trial: 38. Best value: 0.495142:  50%|█████     | 50/100 [11:51<10:13, 12.28s/it]Best trial: 38. Best value: 0.495142:  51%|█████     | 51/100 [11:51<10:12, 12.49s/it]Best trial: 38. Best value: 0.495142:  51%|█████     | 51/100 [11:57<10:12, 12.49s/it]Best trial: 38. Best value: 0.495142:  52%|█████▏    | 52/100 [11:57<08:32, 10.68s/it]Best trial: 38. Best value: 0.495142:  52%|█████▏    | 52/100 [12:09<08:32, 10.68s/it]Best trial: 38. Best value: 0.495142:  53%|█████▎    | 53/100 [12:09<08:41, 11.09s/it]Best trial: 38. Best value: 0.495142:  53%|█████▎    | 53/100 [12:20<08:41, 11.09s/it]Best trial: 38. Best value: 0.495142:  54%|█████▍    | 54/100 [12:20<08:21, 10.91s/it]Best trial: 38. Best value: 0.495142:  54%|█████▍    | 54/100 [12:26<08:21, 10.91s/it]Best trial: 38. Best value: 0.495142:  55%|█████▌    | 55/100 [12:26<07:07,  9.50s/it]Best trial: 38. Best value: 0.495142:  55%|█████▌    | 55/100 [12:37<07:07,  9.50s/it]Best trial: 38. Best value: 0.495142:  56%|█████▌    | 56/100 [12:37<07:11,  9.81s/it]Best trial: 38. Best value: 0.495142:  56%|█████▌    | 56/100 [12:44<07:11,  9.81s/it]Best trial: 38. Best value: 0.495142:  57%|█████▋    | 57/100 [12:44<06:32,  9.13s/it]Best trial: 38. Best value: 0.495142:  57%|█████▋    | 57/100 [12:57<06:32,  9.13s/it]Best trial: 38. Best value: 0.495142:  58%|█████▊    | 58/100 [12:57<07:12, 10.29s/it]Best trial: 38. Best value: 0.495142:  58%|█████▊    | 58/100 [13:32<07:12, 10.29s/it]Best trial: 38. Best value: 0.495142:  59%|█████▉    | 59/100 [13:32<12:06, 17.71s/it]Best trial: 38. Best value: 0.495142:  59%|█████▉    | 59/100 [13:46<12:06, 17.71s/it]Best trial: 38. Best value: 0.495142:  60%|██████    | 60/100 [13:46<11:05, 16.64s/it]Best trial: 38. Best value: 0.495142:  60%|██████    | 60/100 [13:55<11:05, 16.64s/it]Best trial: 38. Best value: 0.495142:  61%|██████    | 61/100 [13:55<09:10, 14.11s/it]Best trial: 38. Best value: 0.495142:  61%|██████    | 61/100 [14:02<09:10, 14.11s/it]Best trial: 38. Best value: 0.495142:  62%|██████▏   | 62/100 [14:02<07:36, 12.00s/it]Best trial: 38. Best value: 0.495142:  62%|██████▏   | 62/100 [14:08<07:36, 12.00s/it]Best trial: 38. Best value: 0.495142:  63%|██████▎   | 63/100 [14:08<06:19, 10.26s/it]Best trial: 38. Best value: 0.495142:  63%|██████▎   | 63/100 [14:19<06:19, 10.26s/it]Best trial: 38. Best value: 0.495142:  64%|██████▍   | 64/100 [14:19<06:15, 10.42s/it]Best trial: 38. Best value: 0.495142:  64%|██████▍   | 64/100 [14:26<06:15, 10.42s/it]Best trial: 38. Best value: 0.495142:  65%|██████▌   | 65/100 [14:26<05:33,  9.52s/it]Best trial: 38. Best value: 0.495142:  65%|██████▌   | 65/100 [14:33<05:33,  9.52s/it]Best trial: 38. Best value: 0.495142:  66%|██████▌   | 66/100 [14:33<04:57,  8.74s/it]Best trial: 66. Best value: 0.505089:  66%|██████▌   | 66/100 [14:41<04:57,  8.74s/it]Best trial: 66. Best value: 0.505089:  67%|██████▋   | 67/100 [14:41<04:37,  8.41s/it]Best trial: 66. Best value: 0.505089:  67%|██████▋   | 67/100 [14:49<04:37,  8.41s/it]Best trial: 66. Best value: 0.505089:  68%|██████▊   | 68/100 [14:49<04:27,  8.36s/it]Best trial: 66. Best value: 0.505089:  68%|██████▊   | 68/100 [14:58<04:27,  8.36s/it]Best trial: 66. Best value: 0.505089:  69%|██████▉   | 69/100 [14:58<04:23,  8.50s/it]Best trial: 66. Best value: 0.505089:  69%|██████▉   | 69/100 [15:05<04:23,  8.50s/it]Best trial: 66. Best value: 0.505089:  70%|███████   | 70/100 [15:05<04:03,  8.13s/it]Best trial: 66. Best value: 0.505089:  70%|███████   | 70/100 [15:14<04:03,  8.13s/it]Best trial: 66. Best value: 0.505089:  71%|███████   | 71/100 [15:14<03:59,  8.25s/it]Best trial: 66. Best value: 0.505089:  71%|███████   | 71/100 [15:22<03:59,  8.25s/it]Best trial: 66. Best value: 0.505089:  72%|███████▏  | 72/100 [15:22<03:50,  8.25s/it]Best trial: 66. Best value: 0.505089:  72%|███████▏  | 72/100 [15:30<03:50,  8.25s/it]Best trial: 66. Best value: 0.505089:  73%|███████▎  | 73/100 [15:30<03:43,  8.28s/it]Best trial: 66. Best value: 0.505089:  73%|███████▎  | 73/100 [15:37<03:43,  8.28s/it]Best trial: 66. Best value: 0.505089:  74%|███████▍  | 74/100 [15:37<03:25,  7.92s/it]Best trial: 66. Best value: 0.505089:  74%|███████▍  | 74/100 [15:44<03:25,  7.92s/it]Best trial: 66. Best value: 0.505089:  75%|███████▌  | 75/100 [15:44<03:13,  7.72s/it]Best trial: 66. Best value: 0.505089:  75%|███████▌  | 75/100 [15:54<03:13,  7.72s/it]Best trial: 66. Best value: 0.505089:  76%|███████▌  | 76/100 [15:54<03:15,  8.16s/it]Best trial: 66. Best value: 0.505089:  76%|███████▌  | 76/100 [16:01<03:15,  8.16s/it]Best trial: 66. Best value: 0.505089:  77%|███████▋  | 77/100 [16:01<03:04,  8.03s/it]Best trial: 66. Best value: 0.505089:  77%|███████▋  | 77/100 [16:10<03:04,  8.03s/it]Best trial: 66. Best value: 0.505089:  78%|███████▊  | 78/100 [16:10<03:00,  8.20s/it]Best trial: 66. Best value: 0.505089:  78%|███████▊  | 78/100 [16:16<03:00,  8.20s/it]Best trial: 66. Best value: 0.505089:  79%|███████▉  | 79/100 [16:16<02:41,  7.67s/it]Best trial: 66. Best value: 0.505089:  79%|███████▉  | 79/100 [16:25<02:41,  7.67s/it]Best trial: 66. Best value: 0.505089:  80%|████████  | 80/100 [16:25<02:41,  8.09s/it]Best trial: 66. Best value: 0.505089:  80%|████████  | 80/100 [16:36<02:41,  8.09s/it]Best trial: 66. Best value: 0.505089:  81%|████████  | 81/100 [16:36<02:49,  8.94s/it]Best trial: 66. Best value: 0.505089:  81%|████████  | 81/100 [16:44<02:49,  8.94s/it]Best trial: 66. Best value: 0.505089:  82%|████████▏ | 82/100 [16:44<02:32,  8.49s/it]Best trial: 66. Best value: 0.505089:  82%|████████▏ | 82/100 [16:51<02:32,  8.49s/it]Best trial: 66. Best value: 0.505089:  83%|████████▎ | 83/100 [16:51<02:18,  8.15s/it]Best trial: 66. Best value: 0.505089:  83%|████████▎ | 83/100 [16:59<02:18,  8.15s/it]Best trial: 66. Best value: 0.505089:  84%|████████▍ | 84/100 [16:59<02:07,  7.98s/it]Best trial: 66. Best value: 0.505089:  84%|████████▍ | 84/100 [17:06<02:07,  7.98s/it]Best trial: 66. Best value: 0.505089:  85%|████████▌ | 85/100 [17:06<01:54,  7.61s/it]Best trial: 66. Best value: 0.505089:  85%|████████▌ | 85/100 [17:14<01:54,  7.61s/it]Best trial: 66. Best value: 0.505089:  86%|████████▌ | 86/100 [17:14<01:51,  7.95s/it]Best trial: 66. Best value: 0.505089:  86%|████████▌ | 86/100 [17:27<01:51,  7.95s/it]Best trial: 66. Best value: 0.505089:  87%|████████▋ | 87/100 [17:27<02:00,  9.27s/it]Best trial: 66. Best value: 0.505089:  87%|████████▋ | 87/100 [17:36<02:00,  9.27s/it]Best trial: 66. Best value: 0.505089:  88%|████████▊ | 88/100 [17:36<01:50,  9.20s/it]Best trial: 66. Best value: 0.505089:  88%|████████▊ | 88/100 [17:42<01:50,  9.20s/it]Best trial: 66. Best value: 0.505089:  89%|████████▉ | 89/100 [17:42<01:32,  8.44s/it]Best trial: 66. Best value: 0.505089:  89%|████████▉ | 89/100 [17:52<01:32,  8.44s/it]Best trial: 66. Best value: 0.505089:  90%|█████████ | 90/100 [17:52<01:28,  8.85s/it]Best trial: 66. Best value: 0.505089:  90%|█████████ | 90/100 [18:02<01:28,  8.85s/it]Best trial: 66. Best value: 0.505089:  91%|█████████ | 91/100 [18:02<01:21,  9.02s/it]Best trial: 66. Best value: 0.505089:  91%|█████████ | 91/100 [18:09<01:21,  9.02s/it]Best trial: 66. Best value: 0.505089:  92%|█████████▏| 92/100 [18:09<01:09,  8.65s/it]Best trial: 66. Best value: 0.505089:  92%|█████████▏| 92/100 [18:19<01:09,  8.65s/it]Best trial: 66. Best value: 0.505089:  93%|█████████▎| 93/100 [18:19<01:03,  9.04s/it]Best trial: 66. Best value: 0.505089:  93%|█████████▎| 93/100 [18:29<01:03,  9.04s/it]Best trial: 66. Best value: 0.505089:  94%|█████████▍| 94/100 [18:29<00:55,  9.21s/it]Best trial: 66. Best value: 0.505089:  94%|█████████▍| 94/100 [18:37<00:55,  9.21s/it]Best trial: 66. Best value: 0.505089:  95%|█████████▌| 95/100 [18:37<00:43,  8.75s/it]Best trial: 66. Best value: 0.505089:  95%|█████████▌| 95/100 [18:46<00:43,  8.75s/it]Best trial: 66. Best value: 0.505089:  96%|█████████▌| 96/100 [18:46<00:35,  8.91s/it]Best trial: 66. Best value: 0.505089:  96%|█████████▌| 96/100 [18:54<00:35,  8.91s/it]Best trial: 66. Best value: 0.505089:  97%|█████████▋| 97/100 [18:54<00:25,  8.64s/it]Best trial: 66. Best value: 0.505089:  97%|█████████▋| 97/100 [19:05<00:25,  8.64s/it]Best trial: 66. Best value: 0.505089:  98%|█████████▊| 98/100 [19:05<00:18,  9.48s/it]Best trial: 66. Best value: 0.505089:  98%|█████████▊| 98/100 [19:11<00:18,  9.48s/it]Best trial: 66. Best value: 0.505089:  99%|█████████▉| 99/100 [19:11<00:08,  8.48s/it]Best trial: 66. Best value: 0.505089:  99%|█████████▉| 99/100 [19:19<00:08,  8.48s/it]Best trial: 66. Best value: 0.505089: 100%|██████████| 100/100 [19:19<00:00,  8.21s/it]Best trial: 66. Best value: 0.505089: 100%|██████████| 100/100 [19:19<00:00, 11.60s/it]
2025-11-30 09:39:44,745 - INFO - HPO Complete. Best AUPRC: 0.5051
2025-11-30 09:39:44,745 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.035522927987866826, 'max_depth': 3, 'subsample': 0.878288949463839, 'colsample_bytree': 0.9998193092219895, 'gamma': 1.928791411911833, 'reg_lambda': 1.234237853825567e-05, 'reg_alpha': 0.9197488206900323}
2025-11-30 09:39:44,746 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 09:39:46,913 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 09:39:46,913 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:39:47,142 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:39:47,232 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:39:47,262 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 09:39:47,262 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 09:39:47,262 - INFO - Training model...
2025-11-30 09:39:50,196 - INFO - Evaluating model with bootstrapping...
2025-11-30 09:39:57,597 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 09:39:57,597 - INFO - AUROC: 0.7760 (0.6820 - 0.8550)
2025-11-30 09:39:57,597 - INFO - AUPRC: 0.4073 (0.2035 - 0.5639)
2025-11-30 09:39:57,597 - INFO - Brier Score: 0.0521 (0.0415 - 0.0628)
2025-11-30 09:39:57,597 - INFO - Accuracy: 0.9595 (0.9009 - 0.9731)
2025-11-30 09:39:57,597 - INFO - Precision: 0.7500 (0.2639 - 1.0000)
2025-11-30 09:39:57,597 - INFO - Sensitivity (Recall): 0.3333 (0.2343 - 0.5226)
2025-11-30 09:39:57,597 - INFO - F1-Score: 0.4615 (0.3079 - 0.6143)
2025-11-30 09:39:57,597 - INFO - Best Threshold: 0.6900 (0.3340 - 0.8400)
2025-11-30 09:39:57,597 - INFO - Specificity: 0.9939 (0.9282 - 1.0000)
2025-11-30 09:39:57,610 - INFO - Calculating SHAP values...
2025-11-30 09:39:58,643 - INFO - SHAP plots saved.
2025-11-30 09:39:58,644 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 09:40:00,050 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: ventilator_only
2025-11-30 09:40:00,050 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:40:00,249 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:40:00,285 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:40:00,292 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 09:40:00,293 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.153079:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.153079:   1%|          | 1/100 [00:06<09:59,  6.05s/it]Best trial: 1. Best value: 0.159275:   1%|          | 1/100 [00:10<09:59,  6.05s/it]Best trial: 1. Best value: 0.159275:   2%|▏         | 2/100 [00:10<08:17,  5.08s/it]Best trial: 1. Best value: 0.159275:   2%|▏         | 2/100 [00:14<08:17,  5.08s/it]Best trial: 1. Best value: 0.159275:   3%|▎         | 3/100 [00:14<07:40,  4.75s/it]Best trial: 1. Best value: 0.159275:   3%|▎         | 3/100 [00:22<07:40,  4.75s/it]Best trial: 1. Best value: 0.159275:   4%|▍         | 4/100 [00:22<09:17,  5.81s/it]Best trial: 4. Best value: 0.175158:   4%|▍         | 4/100 [00:29<09:17,  5.81s/it]Best trial: 4. Best value: 0.175158:   5%|▌         | 5/100 [00:29<09:48,  6.20s/it]Best trial: 4. Best value: 0.175158:   5%|▌         | 5/100 [00:32<09:48,  6.20s/it]Best trial: 4. Best value: 0.175158:   6%|▌         | 6/100 [00:32<08:18,  5.30s/it]Best trial: 4. Best value: 0.175158:   6%|▌         | 6/100 [00:35<08:18,  5.30s/it]Best trial: 4. Best value: 0.175158:   7%|▋         | 7/100 [00:35<06:54,  4.46s/it]Best trial: 4. Best value: 0.175158:   7%|▋         | 7/100 [00:38<06:54,  4.46s/it]Best trial: 4. Best value: 0.175158:   8%|▊         | 8/100 [00:38<06:15,  4.08s/it]Best trial: 4. Best value: 0.175158:   8%|▊         | 8/100 [00:53<06:15,  4.08s/it]Best trial: 4. Best value: 0.175158:   9%|▉         | 9/100 [00:53<11:26,  7.55s/it]Best trial: 4. Best value: 0.175158:   9%|▉         | 9/100 [00:56<11:26,  7.55s/it]Best trial: 4. Best value: 0.175158:  10%|█         | 10/100 [00:56<09:12,  6.14s/it]Best trial: 4. Best value: 0.175158:  10%|█         | 10/100 [01:02<09:12,  6.14s/it]Best trial: 4. Best value: 0.175158:  11%|█         | 11/100 [01:02<08:48,  5.93s/it]Best trial: 4. Best value: 0.175158:  11%|█         | 11/100 [01:09<08:48,  5.93s/it]Best trial: 4. Best value: 0.175158:  12%|█▏        | 12/100 [01:09<09:23,  6.41s/it]Best trial: 12. Best value: 0.178778:  12%|█▏        | 12/100 [01:15<09:23,  6.41s/it]Best trial: 12. Best value: 0.178778:  13%|█▎        | 13/100 [01:15<08:52,  6.12s/it]Best trial: 12. Best value: 0.178778:  13%|█▎        | 13/100 [01:20<08:52,  6.12s/it]Best trial: 12. Best value: 0.178778:  14%|█▍        | 14/100 [01:20<08:26,  5.89s/it]Best trial: 14. Best value: 0.18743:  14%|█▍        | 14/100 [01:27<08:26,  5.89s/it] Best trial: 14. Best value: 0.18743:  15%|█▌        | 15/100 [01:27<08:33,  6.04s/it]Best trial: 14. Best value: 0.18743:  15%|█▌        | 15/100 [01:34<08:33,  6.04s/it]Best trial: 14. Best value: 0.18743:  16%|█▌        | 16/100 [01:34<08:58,  6.41s/it]Best trial: 14. Best value: 0.18743:  16%|█▌        | 16/100 [01:39<08:58,  6.41s/it]Best trial: 14. Best value: 0.18743:  17%|█▋        | 17/100 [01:39<08:20,  6.04s/it]Best trial: 14. Best value: 0.18743:  17%|█▋        | 17/100 [01:46<08:20,  6.04s/it]Best trial: 14. Best value: 0.18743:  18%|█▊        | 18/100 [01:46<08:29,  6.21s/it]Best trial: 14. Best value: 0.18743:  18%|█▊        | 18/100 [01:53<08:29,  6.21s/it]Best trial: 14. Best value: 0.18743:  19%|█▉        | 19/100 [01:53<08:55,  6.61s/it]Best trial: 14. Best value: 0.18743:  19%|█▉        | 19/100 [01:58<08:55,  6.61s/it]Best trial: 14. Best value: 0.18743:  20%|██        | 20/100 [01:58<08:07,  6.10s/it]Best trial: 14. Best value: 0.18743:  20%|██        | 20/100 [02:02<08:07,  6.10s/it]Best trial: 14. Best value: 0.18743:  21%|██        | 21/100 [02:02<07:17,  5.54s/it]Best trial: 14. Best value: 0.18743:  21%|██        | 21/100 [02:09<07:17,  5.54s/it]Best trial: 14. Best value: 0.18743:  22%|██▏       | 22/100 [02:09<07:48,  6.01s/it]Best trial: 14. Best value: 0.18743:  22%|██▏       | 22/100 [02:15<07:48,  6.01s/it]Best trial: 14. Best value: 0.18743:  23%|██▎       | 23/100 [02:15<07:28,  5.83s/it]Best trial: 14. Best value: 0.18743:  23%|██▎       | 23/100 [02:21<07:28,  5.83s/it]Best trial: 14. Best value: 0.18743:  24%|██▍       | 24/100 [02:21<07:37,  6.02s/it]Best trial: 14. Best value: 0.18743:  24%|██▍       | 24/100 [02:26<07:37,  6.02s/it]Best trial: 14. Best value: 0.18743:  25%|██▌       | 25/100 [02:26<06:58,  5.57s/it]Best trial: 14. Best value: 0.18743:  25%|██▌       | 25/100 [02:32<06:58,  5.57s/it]Best trial: 14. Best value: 0.18743:  26%|██▌       | 26/100 [02:32<07:07,  5.77s/it]Best trial: 14. Best value: 0.18743:  26%|██▌       | 26/100 [02:38<07:07,  5.77s/it]Best trial: 14. Best value: 0.18743:  27%|██▋       | 27/100 [02:38<07:08,  5.88s/it]Best trial: 14. Best value: 0.18743:  27%|██▋       | 27/100 [02:45<07:08,  5.88s/it]Best trial: 14. Best value: 0.18743:  28%|██▊       | 28/100 [02:45<07:15,  6.05s/it]Best trial: 14. Best value: 0.18743:  28%|██▊       | 28/100 [02:52<07:15,  6.05s/it]Best trial: 14. Best value: 0.18743:  29%|██▉       | 29/100 [02:52<07:34,  6.39s/it]Best trial: 14. Best value: 0.18743:  29%|██▉       | 29/100 [02:57<07:34,  6.39s/it]Best trial: 14. Best value: 0.18743:  30%|███       | 30/100 [02:57<06:58,  5.98s/it]Best trial: 14. Best value: 0.18743:  30%|███       | 30/100 [03:04<06:58,  5.98s/it]Best trial: 14. Best value: 0.18743:  31%|███       | 31/100 [03:04<07:17,  6.34s/it]Best trial: 14. Best value: 0.18743:  31%|███       | 31/100 [03:10<07:17,  6.34s/it]Best trial: 14. Best value: 0.18743:  32%|███▏      | 32/100 [03:10<06:59,  6.17s/it]Best trial: 14. Best value: 0.18743:  32%|███▏      | 32/100 [03:15<06:59,  6.17s/it]Best trial: 14. Best value: 0.18743:  33%|███▎      | 33/100 [03:15<06:41,  6.00s/it]Best trial: 14. Best value: 0.18743:  33%|███▎      | 33/100 [03:19<06:41,  6.00s/it]Best trial: 14. Best value: 0.18743:  34%|███▍      | 34/100 [03:19<05:50,  5.31s/it]Best trial: 14. Best value: 0.18743:  34%|███▍      | 34/100 [03:24<05:50,  5.31s/it]Best trial: 14. Best value: 0.18743:  35%|███▌      | 35/100 [03:24<05:37,  5.19s/it]Best trial: 14. Best value: 0.18743:  35%|███▌      | 35/100 [03:30<05:37,  5.19s/it]Best trial: 14. Best value: 0.18743:  36%|███▌      | 36/100 [03:30<05:39,  5.31s/it]Best trial: 14. Best value: 0.18743:  36%|███▌      | 36/100 [03:36<05:39,  5.31s/it]Best trial: 14. Best value: 0.18743:  37%|███▋      | 37/100 [03:36<06:02,  5.75s/it]Best trial: 14. Best value: 0.18743:  37%|███▋      | 37/100 [03:42<06:02,  5.75s/it]Best trial: 14. Best value: 0.18743:  38%|███▊      | 38/100 [03:42<05:58,  5.79s/it]Best trial: 14. Best value: 0.18743:  38%|███▊      | 38/100 [03:50<05:58,  5.79s/it]Best trial: 14. Best value: 0.18743:  39%|███▉      | 39/100 [03:50<06:26,  6.34s/it]Best trial: 14. Best value: 0.18743:  39%|███▉      | 39/100 [03:58<06:26,  6.34s/it]Best trial: 14. Best value: 0.18743:  40%|████      | 40/100 [03:58<07:00,  7.01s/it]Best trial: 14. Best value: 0.18743:  40%|████      | 40/100 [04:07<07:00,  7.01s/it]Best trial: 14. Best value: 0.18743:  41%|████      | 41/100 [04:07<07:29,  7.62s/it]Best trial: 14. Best value: 0.18743:  41%|████      | 41/100 [04:17<07:29,  7.62s/it]Best trial: 14. Best value: 0.18743:  42%|████▏     | 42/100 [04:17<07:54,  8.17s/it]Best trial: 14. Best value: 0.18743:  42%|████▏     | 42/100 [04:23<07:54,  8.17s/it]Best trial: 14. Best value: 0.18743:  43%|████▎     | 43/100 [04:23<07:13,  7.60s/it]Best trial: 14. Best value: 0.18743:  43%|████▎     | 43/100 [04:26<07:13,  7.60s/it]Best trial: 14. Best value: 0.18743:  44%|████▍     | 44/100 [04:26<05:50,  6.26s/it]Best trial: 14. Best value: 0.18743:  44%|████▍     | 44/100 [04:34<05:50,  6.26s/it]Best trial: 14. Best value: 0.18743:  45%|████▌     | 45/100 [04:34<06:13,  6.78s/it]Best trial: 14. Best value: 0.18743:  45%|████▌     | 45/100 [04:40<06:13,  6.78s/it]Best trial: 14. Best value: 0.18743:  46%|████▌     | 46/100 [04:40<05:53,  6.54s/it]Best trial: 14. Best value: 0.18743:  46%|████▌     | 46/100 [04:47<05:53,  6.54s/it]Best trial: 14. Best value: 0.18743:  47%|████▋     | 47/100 [04:47<05:56,  6.72s/it]Best trial: 14. Best value: 0.18743:  47%|████▋     | 47/100 [04:55<05:56,  6.72s/it]Best trial: 14. Best value: 0.18743:  48%|████▊     | 48/100 [04:55<05:55,  6.84s/it]Best trial: 14. Best value: 0.18743:  48%|████▊     | 48/100 [05:01<05:55,  6.84s/it]Best trial: 14. Best value: 0.18743:  49%|████▉     | 49/100 [05:01<05:38,  6.64s/it]Best trial: 14. Best value: 0.18743:  49%|████▉     | 49/100 [05:04<05:38,  6.64s/it]Best trial: 14. Best value: 0.18743:  50%|█████     | 50/100 [05:04<04:36,  5.53s/it]Best trial: 14. Best value: 0.18743:  50%|█████     | 50/100 [05:12<04:36,  5.53s/it]Best trial: 14. Best value: 0.18743:  51%|█████     | 51/100 [05:12<05:09,  6.31s/it]Best trial: 14. Best value: 0.18743:  51%|█████     | 51/100 [05:20<05:09,  6.31s/it]Best trial: 14. Best value: 0.18743:  52%|█████▏    | 52/100 [05:20<05:25,  6.79s/it]Best trial: 14. Best value: 0.18743:  52%|█████▏    | 52/100 [05:26<05:25,  6.79s/it]Best trial: 14. Best value: 0.18743:  53%|█████▎    | 53/100 [05:26<05:13,  6.67s/it]Best trial: 14. Best value: 0.18743:  53%|█████▎    | 53/100 [05:34<05:13,  6.67s/it]Best trial: 14. Best value: 0.18743:  54%|█████▍    | 54/100 [05:34<05:18,  6.93s/it]Best trial: 14. Best value: 0.18743:  54%|█████▍    | 54/100 [05:41<05:18,  6.93s/it]Best trial: 14. Best value: 0.18743:  55%|█████▌    | 55/100 [05:41<05:21,  7.13s/it]Best trial: 14. Best value: 0.18743:  55%|█████▌    | 55/100 [05:48<05:21,  7.13s/it]Best trial: 14. Best value: 0.18743:  56%|█████▌    | 56/100 [05:48<05:07,  6.98s/it]Best trial: 14. Best value: 0.18743:  56%|█████▌    | 56/100 [05:53<05:07,  6.98s/it]Best trial: 14. Best value: 0.18743:  57%|█████▋    | 57/100 [05:53<04:37,  6.46s/it]Best trial: 14. Best value: 0.18743:  57%|█████▋    | 57/100 [06:01<04:37,  6.46s/it]Best trial: 14. Best value: 0.18743:  58%|█████▊    | 58/100 [06:01<04:46,  6.82s/it]Best trial: 14. Best value: 0.18743:  58%|█████▊    | 58/100 [06:10<04:46,  6.82s/it]Best trial: 14. Best value: 0.18743:  59%|█████▉    | 59/100 [06:10<05:06,  7.48s/it]Best trial: 14. Best value: 0.18743:  59%|█████▉    | 59/100 [06:16<05:06,  7.48s/it]Best trial: 14. Best value: 0.18743:  60%|██████    | 60/100 [06:16<04:46,  7.16s/it]Best trial: 14. Best value: 0.18743:  60%|██████    | 60/100 [06:22<04:46,  7.16s/it]Best trial: 14. Best value: 0.18743:  61%|██████    | 61/100 [06:22<04:21,  6.70s/it]Best trial: 14. Best value: 0.18743:  61%|██████    | 61/100 [06:28<04:21,  6.70s/it]Best trial: 14. Best value: 0.18743:  62%|██████▏   | 62/100 [06:28<04:04,  6.43s/it]Best trial: 14. Best value: 0.18743:  62%|██████▏   | 62/100 [06:36<04:04,  6.43s/it]Best trial: 14. Best value: 0.18743:  63%|██████▎   | 63/100 [06:36<04:20,  7.05s/it]Best trial: 14. Best value: 0.18743:  63%|██████▎   | 63/100 [06:43<04:20,  7.05s/it]Best trial: 14. Best value: 0.18743:  64%|██████▍   | 64/100 [06:43<04:16,  7.13s/it]Best trial: 14. Best value: 0.18743:  64%|██████▍   | 64/100 [06:51<04:16,  7.13s/it]Best trial: 14. Best value: 0.18743:  65%|██████▌   | 65/100 [06:51<04:09,  7.14s/it]Best trial: 14. Best value: 0.18743:  65%|██████▌   | 65/100 [06:58<04:09,  7.14s/it]Best trial: 14. Best value: 0.18743:  66%|██████▌   | 66/100 [06:58<04:05,  7.23s/it]Best trial: 14. Best value: 0.18743:  66%|██████▌   | 66/100 [07:04<04:05,  7.23s/it]Best trial: 14. Best value: 0.18743:  67%|██████▋   | 67/100 [07:04<03:43,  6.76s/it]Best trial: 14. Best value: 0.18743:  67%|██████▋   | 67/100 [07:09<03:43,  6.76s/it]Best trial: 14. Best value: 0.18743:  68%|██████▊   | 68/100 [07:09<03:25,  6.42s/it]Best trial: 14. Best value: 0.18743:  68%|██████▊   | 68/100 [07:15<03:25,  6.42s/it]Best trial: 14. Best value: 0.18743:  69%|██████▉   | 69/100 [07:15<03:15,  6.31s/it]Best trial: 14. Best value: 0.18743:  69%|██████▉   | 69/100 [07:23<03:15,  6.31s/it]Best trial: 14. Best value: 0.18743:  70%|███████   | 70/100 [07:23<03:19,  6.66s/it]Best trial: 14. Best value: 0.18743:  70%|███████   | 70/100 [07:30<03:19,  6.66s/it]Best trial: 14. Best value: 0.18743:  71%|███████   | 71/100 [07:30<03:15,  6.74s/it]Best trial: 14. Best value: 0.18743:  71%|███████   | 71/100 [07:36<03:15,  6.74s/it]Best trial: 14. Best value: 0.18743:  72%|███████▏  | 72/100 [07:36<03:07,  6.70s/it]Best trial: 14. Best value: 0.18743:  72%|███████▏  | 72/100 [07:44<03:07,  6.70s/it]Best trial: 14. Best value: 0.18743:  73%|███████▎  | 73/100 [07:44<03:06,  6.90s/it]Best trial: 14. Best value: 0.18743:  73%|███████▎  | 73/100 [07:52<03:06,  6.90s/it]Best trial: 14. Best value: 0.18743:  74%|███████▍  | 74/100 [07:52<03:11,  7.36s/it]Best trial: 14. Best value: 0.18743:  74%|███████▍  | 74/100 [07:58<03:11,  7.36s/it]Best trial: 14. Best value: 0.18743:  75%|███████▌  | 75/100 [07:58<02:49,  6.76s/it]Best trial: 14. Best value: 0.18743:  75%|███████▌  | 75/100 [08:03<02:49,  6.76s/it]Best trial: 14. Best value: 0.18743:  76%|███████▌  | 76/100 [08:03<02:29,  6.23s/it]Best trial: 14. Best value: 0.18743:  76%|███████▌  | 76/100 [08:09<02:29,  6.23s/it]Best trial: 14. Best value: 0.18743:  77%|███████▋  | 77/100 [08:09<02:24,  6.27s/it]Best trial: 14. Best value: 0.18743:  77%|███████▋  | 77/100 [08:16<02:24,  6.27s/it]Best trial: 14. Best value: 0.18743:  78%|███████▊  | 78/100 [08:16<02:20,  6.38s/it]Best trial: 14. Best value: 0.18743:  78%|███████▊  | 78/100 [08:19<02:20,  6.38s/it]Best trial: 14. Best value: 0.18743:  79%|███████▉  | 79/100 [08:19<01:58,  5.65s/it]Best trial: 14. Best value: 0.18743:  79%|███████▉  | 79/100 [08:25<01:58,  5.65s/it]Best trial: 14. Best value: 0.18743:  80%|████████  | 80/100 [08:25<01:52,  5.63s/it]Best trial: 14. Best value: 0.18743:  80%|████████  | 80/100 [08:30<01:52,  5.63s/it]Best trial: 14. Best value: 0.18743:  81%|████████  | 81/100 [08:30<01:45,  5.55s/it]Best trial: 14. Best value: 0.18743:  81%|████████  | 81/100 [08:38<01:45,  5.55s/it]Best trial: 14. Best value: 0.18743:  82%|████████▏ | 82/100 [08:38<01:50,  6.14s/it]Best trial: 14. Best value: 0.18743:  82%|████████▏ | 82/100 [08:45<01:50,  6.14s/it]Best trial: 14. Best value: 0.18743:  83%|████████▎ | 83/100 [08:45<01:51,  6.54s/it]Best trial: 14. Best value: 0.18743:  83%|████████▎ | 83/100 [08:51<01:51,  6.54s/it]Best trial: 14. Best value: 0.18743:  84%|████████▍ | 84/100 [08:51<01:42,  6.40s/it]Best trial: 14. Best value: 0.18743:  84%|████████▍ | 84/100 [08:58<01:42,  6.40s/it]Best trial: 14. Best value: 0.18743:  85%|████████▌ | 85/100 [08:58<01:37,  6.50s/it]Best trial: 14. Best value: 0.18743:  85%|████████▌ | 85/100 [09:06<01:37,  6.50s/it]Best trial: 14. Best value: 0.18743:  86%|████████▌ | 86/100 [09:06<01:38,  7.02s/it]Best trial: 14. Best value: 0.18743:  86%|████████▌ | 86/100 [09:15<01:38,  7.02s/it]Best trial: 14. Best value: 0.18743:  87%|████████▋ | 87/100 [09:15<01:37,  7.47s/it]Best trial: 14. Best value: 0.18743:  87%|████████▋ | 87/100 [09:24<01:37,  7.47s/it]Best trial: 14. Best value: 0.18743:  88%|████████▊ | 88/100 [09:24<01:36,  8.06s/it]Best trial: 14. Best value: 0.18743:  88%|████████▊ | 88/100 [09:34<01:36,  8.06s/it]Best trial: 14. Best value: 0.18743:  89%|████████▉ | 89/100 [09:34<01:32,  8.39s/it]Best trial: 14. Best value: 0.18743:  89%|████████▉ | 89/100 [09:42<01:32,  8.39s/it]Best trial: 14. Best value: 0.18743:  90%|█████████ | 90/100 [09:42<01:22,  8.29s/it]Best trial: 14. Best value: 0.18743:  90%|█████████ | 90/100 [09:49<01:22,  8.29s/it]Best trial: 14. Best value: 0.18743:  91%|█████████ | 91/100 [09:49<01:11,  7.99s/it]Best trial: 14. Best value: 0.18743:  91%|█████████ | 91/100 [09:56<01:11,  7.99s/it]Best trial: 14. Best value: 0.18743:  92%|█████████▏| 92/100 [09:56<01:02,  7.77s/it]Best trial: 14. Best value: 0.18743:  92%|█████████▏| 92/100 [10:04<01:02,  7.77s/it]Best trial: 14. Best value: 0.18743:  93%|█████████▎| 93/100 [10:04<00:54,  7.74s/it]Best trial: 14. Best value: 0.18743:  93%|█████████▎| 93/100 [10:11<00:54,  7.74s/it]Best trial: 14. Best value: 0.18743:  94%|█████████▍| 94/100 [10:11<00:44,  7.48s/it]Best trial: 14. Best value: 0.18743:  94%|█████████▍| 94/100 [10:18<00:44,  7.48s/it]Best trial: 14. Best value: 0.18743:  95%|█████████▌| 95/100 [10:18<00:37,  7.52s/it]Best trial: 14. Best value: 0.18743:  95%|█████████▌| 95/100 [10:26<00:37,  7.52s/it]Best trial: 14. Best value: 0.18743:  96%|█████████▌| 96/100 [10:26<00:30,  7.58s/it]Best trial: 14. Best value: 0.18743:  96%|█████████▌| 96/100 [10:32<00:30,  7.58s/it]Best trial: 14. Best value: 0.18743:  97%|█████████▋| 97/100 [10:32<00:21,  7.22s/it]Best trial: 14. Best value: 0.18743:  97%|█████████▋| 97/100 [10:35<00:21,  7.22s/it]Best trial: 14. Best value: 0.18743:  98%|█████████▊| 98/100 [10:35<00:11,  5.95s/it]Best trial: 14. Best value: 0.18743:  98%|█████████▊| 98/100 [10:41<00:11,  5.95s/it]Best trial: 14. Best value: 0.18743:  99%|█████████▉| 99/100 [10:41<00:05,  5.72s/it]Best trial: 14. Best value: 0.18743:  99%|█████████▉| 99/100 [10:46<00:05,  5.72s/it]Best trial: 14. Best value: 0.18743: 100%|██████████| 100/100 [10:46<00:00,  5.66s/it]Best trial: 14. Best value: 0.18743: 100%|██████████| 100/100 [10:46<00:00,  6.47s/it]
2025-11-30 09:50:46,920 - INFO - HPO Complete. Best AUPRC: 0.1874
2025-11-30 09:50:46,920 - INFO - Best Params: {'n_estimators': 100, 'learning_rate': 0.025406255620892187, 'max_depth': 10, 'subsample': 0.8968802703600137, 'colsample_bytree': 0.7630013127336402, 'gamma': 2.8864781736310587, 'reg_lambda': 0.0029898566143982345, 'reg_alpha': 0.6418297695470165}
2025-11-30 09:50:46,921 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 09:50:48,894 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: ventilator_only
2025-11-30 09:50:48,894 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:50:49,112 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:50:49,148 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:50:49,156 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 09:50:49,156 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 09:50:49,156 - INFO - Training model...
2025-11-30 09:50:51,216 - INFO - Evaluating model with bootstrapping...
2025-11-30 09:50:56,593 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 09:50:56,593 - INFO - AUROC: 0.6815 (0.5847 - 0.7659)
2025-11-30 09:50:56,593 - INFO - AUPRC: 0.2128 (0.0900 - 0.3447)
2025-11-30 09:50:56,593 - INFO - Brier Score: 0.0543 (0.0462 - 0.0678)
2025-11-30 09:50:56,593 - INFO - Accuracy: 0.9364 (0.7000 - 0.9592)
2025-11-30 09:50:56,593 - INFO - Precision: 0.3182 (0.0966 - 0.5000)
2025-11-30 09:50:56,593 - INFO - Sensitivity (Recall): 0.1944 (0.1075 - 0.5444)
2025-11-30 09:50:56,593 - INFO - F1-Score: 0.2414 (0.1498 - 0.3953)
2025-11-30 09:50:56,593 - INFO - Best Threshold: 0.3700 (0.1260 - 0.5620)
2025-11-30 09:50:56,593 - INFO - Specificity: 0.9771 (0.7091 - 0.9946)
2025-11-30 09:50:56,603 - INFO - Calculating SHAP values...
2025-11-30 09:50:57,729 - INFO - SHAP plots saved.
2025-11-30 09:50:57,730 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 09:50:59,061 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: monitors_only
2025-11-30 09:50:59,061 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:50:59,312 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:50:59,353 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:50:59,362 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 09:50:59,362 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.103377:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.103377:   1%|          | 1/100 [00:03<05:46,  3.50s/it]Best trial: 1. Best value: 0.150444:   1%|          | 1/100 [00:07<05:46,  3.50s/it]Best trial: 1. Best value: 0.150444:   2%|▏         | 2/100 [00:07<06:06,  3.74s/it]Best trial: 1. Best value: 0.150444:   2%|▏         | 2/100 [00:09<06:06,  3.74s/it]Best trial: 1. Best value: 0.150444:   3%|▎         | 3/100 [00:09<04:56,  3.06s/it]Best trial: 1. Best value: 0.150444:   3%|▎         | 3/100 [00:12<04:56,  3.06s/it]Best trial: 1. Best value: 0.150444:   4%|▍         | 4/100 [00:12<04:31,  2.83s/it]Best trial: 1. Best value: 0.150444:   4%|▍         | 4/100 [00:18<04:31,  2.83s/it]Best trial: 1. Best value: 0.150444:   5%|▌         | 5/100 [00:18<06:26,  4.07s/it]Best trial: 1. Best value: 0.150444:   5%|▌         | 5/100 [00:24<06:26,  4.07s/it]Best trial: 1. Best value: 0.150444:   6%|▌         | 6/100 [00:24<07:34,  4.83s/it]Best trial: 1. Best value: 0.150444:   6%|▌         | 6/100 [00:27<07:34,  4.83s/it]Best trial: 1. Best value: 0.150444:   7%|▋         | 7/100 [00:27<06:13,  4.02s/it]Best trial: 1. Best value: 0.150444:   7%|▋         | 7/100 [00:32<06:13,  4.02s/it]Best trial: 1. Best value: 0.150444:   8%|▊         | 8/100 [00:32<06:46,  4.41s/it]Best trial: 1. Best value: 0.150444:   8%|▊         | 8/100 [00:34<06:46,  4.41s/it]Best trial: 1. Best value: 0.150444:   9%|▉         | 9/100 [00:34<05:45,  3.80s/it]Best trial: 1. Best value: 0.150444:   9%|▉         | 9/100 [00:37<05:45,  3.80s/it]Best trial: 1. Best value: 0.150444:  10%|█         | 10/100 [00:37<05:16,  3.52s/it]Best trial: 1. Best value: 0.150444:  10%|█         | 10/100 [00:45<05:16,  3.52s/it]Best trial: 1. Best value: 0.150444:  11%|█         | 11/100 [00:45<07:07,  4.80s/it]Best trial: 1. Best value: 0.150444:  11%|█         | 11/100 [00:49<07:07,  4.80s/it]Best trial: 1. Best value: 0.150444:  12%|█▏        | 12/100 [00:49<06:35,  4.49s/it]Best trial: 1. Best value: 0.150444:  12%|█▏        | 12/100 [00:53<06:35,  4.49s/it]Best trial: 1. Best value: 0.150444:  13%|█▎        | 13/100 [00:53<06:34,  4.54s/it]Best trial: 1. Best value: 0.150444:  13%|█▎        | 13/100 [00:57<06:34,  4.54s/it]Best trial: 1. Best value: 0.150444:  14%|█▍        | 14/100 [00:57<06:08,  4.28s/it]Best trial: 1. Best value: 0.150444:  14%|█▍        | 14/100 [01:04<06:08,  4.28s/it]Best trial: 1. Best value: 0.150444:  15%|█▌        | 15/100 [01:04<07:10,  5.07s/it]Best trial: 15. Best value: 0.159112:  15%|█▌        | 15/100 [01:08<07:10,  5.07s/it]Best trial: 15. Best value: 0.159112:  16%|█▌        | 16/100 [01:08<06:47,  4.85s/it]Best trial: 15. Best value: 0.159112:  16%|█▌        | 16/100 [01:11<06:47,  4.85s/it]Best trial: 15. Best value: 0.159112:  17%|█▋        | 17/100 [01:11<06:00,  4.35s/it]Best trial: 15. Best value: 0.159112:  17%|█▋        | 17/100 [01:16<06:00,  4.35s/it]Best trial: 15. Best value: 0.159112:  18%|█▊        | 18/100 [01:16<06:13,  4.56s/it]Best trial: 15. Best value: 0.159112:  18%|█▊        | 18/100 [01:25<06:13,  4.56s/it]Best trial: 15. Best value: 0.159112:  19%|█▉        | 19/100 [01:25<07:40,  5.68s/it]Best trial: 15. Best value: 0.159112:  19%|█▉        | 19/100 [01:28<07:40,  5.68s/it]Best trial: 15. Best value: 0.159112:  20%|██        | 20/100 [01:28<06:37,  4.97s/it]Best trial: 15. Best value: 0.159112:  20%|██        | 20/100 [01:33<06:37,  4.97s/it]Best trial: 15. Best value: 0.159112:  21%|██        | 21/100 [01:33<06:23,  4.86s/it]Best trial: 15. Best value: 0.159112:  21%|██        | 21/100 [01:38<06:23,  4.86s/it]Best trial: 15. Best value: 0.159112:  22%|██▏       | 22/100 [01:38<06:36,  5.08s/it]Best trial: 15. Best value: 0.159112:  22%|██▏       | 22/100 [01:44<06:36,  5.08s/it]Best trial: 15. Best value: 0.159112:  23%|██▎       | 23/100 [01:44<06:38,  5.17s/it]Best trial: 15. Best value: 0.159112:  23%|██▎       | 23/100 [01:48<06:38,  5.17s/it]Best trial: 15. Best value: 0.159112:  24%|██▍       | 24/100 [01:48<06:19,  5.00s/it]Best trial: 15. Best value: 0.159112:  24%|██▍       | 24/100 [01:58<06:19,  5.00s/it]Best trial: 15. Best value: 0.159112:  25%|██▌       | 25/100 [01:58<08:10,  6.54s/it]Best trial: 15. Best value: 0.159112:  25%|██▌       | 25/100 [02:03<08:10,  6.54s/it]Best trial: 15. Best value: 0.159112:  26%|██▌       | 26/100 [02:03<07:16,  5.89s/it]Best trial: 15. Best value: 0.159112:  26%|██▌       | 26/100 [02:07<07:16,  5.89s/it]Best trial: 15. Best value: 0.159112:  27%|██▋       | 27/100 [02:07<06:40,  5.48s/it]Best trial: 15. Best value: 0.159112:  27%|██▋       | 27/100 [02:13<06:40,  5.48s/it]Best trial: 15. Best value: 0.159112:  28%|██▊       | 28/100 [02:13<06:46,  5.64s/it]Best trial: 15. Best value: 0.159112:  28%|██▊       | 28/100 [02:16<06:46,  5.64s/it]Best trial: 15. Best value: 0.159112:  29%|██▉       | 29/100 [02:16<05:48,  4.91s/it]Best trial: 15. Best value: 0.159112:  29%|██▉       | 29/100 [02:19<05:48,  4.91s/it]Best trial: 15. Best value: 0.159112:  30%|███       | 30/100 [02:19<04:54,  4.20s/it]Best trial: 15. Best value: 0.159112:  30%|███       | 30/100 [02:24<04:54,  4.20s/it]Best trial: 15. Best value: 0.159112:  31%|███       | 31/100 [02:24<04:56,  4.29s/it]Best trial: 15. Best value: 0.159112:  31%|███       | 31/100 [02:27<04:56,  4.29s/it]Best trial: 15. Best value: 0.159112:  32%|███▏      | 32/100 [02:27<04:27,  3.93s/it]Best trial: 15. Best value: 0.159112:  32%|███▏      | 32/100 [02:29<04:27,  3.93s/it]Best trial: 15. Best value: 0.159112:  33%|███▎      | 33/100 [02:29<03:52,  3.47s/it]Best trial: 15. Best value: 0.159112:  33%|███▎      | 33/100 [02:31<03:52,  3.47s/it]Best trial: 15. Best value: 0.159112:  34%|███▍      | 34/100 [02:31<03:21,  3.06s/it]Best trial: 15. Best value: 0.159112:  34%|███▍      | 34/100 [02:34<03:21,  3.06s/it]Best trial: 15. Best value: 0.159112:  35%|███▌      | 35/100 [02:34<03:22,  3.12s/it]Best trial: 15. Best value: 0.159112:  35%|███▌      | 35/100 [02:39<03:22,  3.12s/it]Best trial: 15. Best value: 0.159112:  36%|███▌      | 36/100 [02:39<03:53,  3.65s/it]Best trial: 15. Best value: 0.159112:  36%|███▌      | 36/100 [02:42<03:53,  3.65s/it]Best trial: 15. Best value: 0.159112:  37%|███▋      | 37/100 [02:42<03:33,  3.40s/it]Best trial: 15. Best value: 0.159112:  37%|███▋      | 37/100 [02:47<03:33,  3.40s/it]Best trial: 15. Best value: 0.159112:  38%|███▊      | 38/100 [02:47<03:57,  3.84s/it]Best trial: 15. Best value: 0.159112:  38%|███▊      | 38/100 [02:54<03:57,  3.84s/it]Best trial: 15. Best value: 0.159112:  39%|███▉      | 39/100 [02:54<04:44,  4.66s/it]Best trial: 15. Best value: 0.159112:  39%|███▉      | 39/100 [02:58<04:44,  4.66s/it]Best trial: 15. Best value: 0.159112:  40%|████      | 40/100 [02:58<04:32,  4.53s/it]Best trial: 15. Best value: 0.159112:  40%|████      | 40/100 [03:03<04:32,  4.53s/it]Best trial: 15. Best value: 0.159112:  41%|████      | 41/100 [03:03<04:36,  4.69s/it]Best trial: 15. Best value: 0.159112:  41%|████      | 41/100 [03:07<04:36,  4.69s/it]Best trial: 15. Best value: 0.159112:  42%|████▏     | 42/100 [03:07<04:29,  4.64s/it]Best trial: 15. Best value: 0.159112:  42%|████▏     | 42/100 [03:13<04:29,  4.64s/it]Best trial: 15. Best value: 0.159112:  43%|████▎     | 43/100 [03:13<04:41,  4.94s/it]Best trial: 15. Best value: 0.159112:  43%|████▎     | 43/100 [03:19<04:41,  4.94s/it]Best trial: 15. Best value: 0.159112:  44%|████▍     | 44/100 [03:19<04:48,  5.15s/it]Best trial: 15. Best value: 0.159112:  44%|████▍     | 44/100 [03:24<04:48,  5.15s/it]Best trial: 15. Best value: 0.159112:  45%|████▌     | 45/100 [03:24<04:41,  5.11s/it]Best trial: 15. Best value: 0.159112:  45%|████▌     | 45/100 [03:29<04:41,  5.11s/it]Best trial: 15. Best value: 0.159112:  46%|████▌     | 46/100 [03:29<04:43,  5.25s/it]Best trial: 15. Best value: 0.159112:  46%|████▌     | 46/100 [03:34<04:43,  5.25s/it]Best trial: 15. Best value: 0.159112:  47%|████▋     | 47/100 [03:34<04:27,  5.04s/it]Best trial: 15. Best value: 0.159112:  47%|████▋     | 47/100 [03:39<04:27,  5.04s/it]Best trial: 15. Best value: 0.159112:  48%|████▊     | 48/100 [03:39<04:23,  5.06s/it]Best trial: 15. Best value: 0.159112:  48%|████▊     | 48/100 [03:44<04:23,  5.06s/it]Best trial: 15. Best value: 0.159112:  49%|████▉     | 49/100 [03:44<04:19,  5.08s/it]Best trial: 15. Best value: 0.159112:  49%|████▉     | 49/100 [03:51<04:19,  5.08s/it]Best trial: 15. Best value: 0.159112:  50%|█████     | 50/100 [03:51<04:47,  5.75s/it]Best trial: 15. Best value: 0.159112:  50%|█████     | 50/100 [03:55<04:47,  5.75s/it]Best trial: 15. Best value: 0.159112:  51%|█████     | 51/100 [03:55<04:14,  5.19s/it]Best trial: 15. Best value: 0.159112:  51%|█████     | 51/100 [04:00<04:14,  5.19s/it]Best trial: 15. Best value: 0.159112:  52%|█████▏    | 52/100 [04:00<04:07,  5.15s/it]Best trial: 15. Best value: 0.159112:  52%|█████▏    | 52/100 [04:06<04:07,  5.15s/it]Best trial: 15. Best value: 0.159112:  53%|█████▎    | 53/100 [04:06<04:11,  5.35s/it]Best trial: 15. Best value: 0.159112:  53%|█████▎    | 53/100 [04:11<04:11,  5.35s/it]Best trial: 15. Best value: 0.159112:  54%|█████▍    | 54/100 [04:11<04:04,  5.32s/it]Best trial: 15. Best value: 0.159112:  54%|█████▍    | 54/100 [04:17<04:04,  5.32s/it]Best trial: 15. Best value: 0.159112:  55%|█████▌    | 55/100 [04:17<04:00,  5.34s/it]Best trial: 15. Best value: 0.159112:  55%|█████▌    | 55/100 [04:25<04:00,  5.34s/it]Best trial: 15. Best value: 0.159112:  56%|█████▌    | 56/100 [04:25<04:34,  6.24s/it]Best trial: 15. Best value: 0.159112:  56%|█████▌    | 56/100 [04:29<04:34,  6.24s/it]Best trial: 15. Best value: 0.159112:  57%|█████▋    | 57/100 [04:29<04:01,  5.62s/it]Best trial: 15. Best value: 0.159112:  57%|█████▋    | 57/100 [04:34<04:01,  5.62s/it]Best trial: 15. Best value: 0.159112:  58%|█████▊    | 58/100 [04:34<03:44,  5.35s/it]Best trial: 15. Best value: 0.159112:  58%|█████▊    | 58/100 [04:38<03:44,  5.35s/it]Best trial: 15. Best value: 0.159112:  59%|█████▉    | 59/100 [04:38<03:17,  4.83s/it]Best trial: 15. Best value: 0.159112:  59%|█████▉    | 59/100 [04:42<03:17,  4.83s/it]Best trial: 15. Best value: 0.159112:  60%|██████    | 60/100 [04:42<03:02,  4.56s/it]Best trial: 15. Best value: 0.159112:  60%|██████    | 60/100 [04:47<03:02,  4.56s/it]Best trial: 15. Best value: 0.159112:  61%|██████    | 61/100 [04:47<03:07,  4.82s/it]Best trial: 61. Best value: 0.159632:  61%|██████    | 61/100 [04:54<03:07,  4.82s/it]Best trial: 61. Best value: 0.159632:  62%|██████▏   | 62/100 [04:54<03:25,  5.41s/it]Best trial: 61. Best value: 0.159632:  62%|██████▏   | 62/100 [04:59<03:25,  5.41s/it]Best trial: 61. Best value: 0.159632:  63%|██████▎   | 63/100 [04:59<03:24,  5.51s/it]Best trial: 61. Best value: 0.159632:  63%|██████▎   | 63/100 [05:05<03:24,  5.51s/it]Best trial: 61. Best value: 0.159632:  64%|██████▍   | 64/100 [05:05<03:17,  5.49s/it]Best trial: 61. Best value: 0.159632:  64%|██████▍   | 64/100 [05:11<03:17,  5.49s/it]Best trial: 61. Best value: 0.159632:  65%|██████▌   | 65/100 [05:11<03:16,  5.62s/it]Best trial: 61. Best value: 0.159632:  65%|██████▌   | 65/100 [05:16<03:16,  5.62s/it]Best trial: 61. Best value: 0.159632:  66%|██████▌   | 66/100 [05:16<03:02,  5.37s/it]Best trial: 61. Best value: 0.159632:  66%|██████▌   | 66/100 [05:20<03:02,  5.37s/it]Best trial: 61. Best value: 0.159632:  67%|██████▋   | 67/100 [05:20<02:48,  5.11s/it]Best trial: 61. Best value: 0.159632:  67%|██████▋   | 67/100 [05:25<02:48,  5.11s/it]Best trial: 61. Best value: 0.159632:  68%|██████▊   | 68/100 [05:25<02:45,  5.16s/it]Best trial: 61. Best value: 0.159632:  68%|██████▊   | 68/100 [05:30<02:45,  5.16s/it]Best trial: 61. Best value: 0.159632:  69%|██████▉   | 69/100 [05:30<02:38,  5.11s/it]Best trial: 61. Best value: 0.159632:  69%|██████▉   | 69/100 [05:38<02:38,  5.11s/it]Best trial: 61. Best value: 0.159632:  70%|███████   | 70/100 [05:38<02:55,  5.86s/it]Best trial: 61. Best value: 0.159632:  70%|███████   | 70/100 [05:46<02:55,  5.86s/it]Best trial: 61. Best value: 0.159632:  71%|███████   | 71/100 [05:46<03:11,  6.59s/it]Best trial: 61. Best value: 0.159632:  71%|███████   | 71/100 [05:53<03:11,  6.59s/it]Best trial: 61. Best value: 0.159632:  72%|███████▏  | 72/100 [05:53<03:01,  6.50s/it]Best trial: 61. Best value: 0.159632:  72%|███████▏  | 72/100 [05:57<03:01,  6.50s/it]Best trial: 61. Best value: 0.159632:  73%|███████▎  | 73/100 [05:57<02:38,  5.86s/it]Best trial: 61. Best value: 0.159632:  73%|███████▎  | 73/100 [06:01<02:38,  5.86s/it]Best trial: 61. Best value: 0.159632:  74%|███████▍  | 74/100 [06:01<02:21,  5.43s/it]Best trial: 61. Best value: 0.159632:  74%|███████▍  | 74/100 [06:06<02:21,  5.43s/it]Best trial: 61. Best value: 0.159632:  75%|███████▌  | 75/100 [06:06<02:07,  5.10s/it]Best trial: 61. Best value: 0.159632:  75%|███████▌  | 75/100 [06:12<02:07,  5.10s/it]Best trial: 61. Best value: 0.159632:  76%|███████▌  | 76/100 [06:12<02:11,  5.49s/it]Best trial: 61. Best value: 0.159632:  76%|███████▌  | 76/100 [06:16<02:11,  5.49s/it]Best trial: 61. Best value: 0.159632:  77%|███████▋  | 77/100 [06:16<01:53,  4.94s/it]Best trial: 61. Best value: 0.159632:  77%|███████▋  | 77/100 [06:23<01:53,  4.94s/it]Best trial: 61. Best value: 0.159632:  78%|███████▊  | 78/100 [06:23<02:03,  5.61s/it]Best trial: 61. Best value: 0.159632:  78%|███████▊  | 78/100 [06:29<02:03,  5.61s/it]Best trial: 61. Best value: 0.159632:  79%|███████▉  | 79/100 [06:29<01:57,  5.61s/it]Best trial: 61. Best value: 0.159632:  79%|███████▉  | 79/100 [06:38<01:57,  5.61s/it]Best trial: 61. Best value: 0.159632:  80%|████████  | 80/100 [06:38<02:15,  6.80s/it]Best trial: 61. Best value: 0.159632:  80%|████████  | 80/100 [06:43<02:15,  6.80s/it]Best trial: 61. Best value: 0.159632:  81%|████████  | 81/100 [06:43<01:57,  6.20s/it]Best trial: 61. Best value: 0.159632:  81%|████████  | 81/100 [06:48<01:57,  6.20s/it]Best trial: 61. Best value: 0.159632:  82%|████████▏ | 82/100 [06:48<01:45,  5.85s/it]Best trial: 61. Best value: 0.159632:  82%|████████▏ | 82/100 [06:53<01:45,  5.85s/it]Best trial: 61. Best value: 0.159632:  83%|████████▎ | 83/100 [06:53<01:33,  5.48s/it]Best trial: 61. Best value: 0.159632:  83%|████████▎ | 83/100 [06:56<01:33,  5.48s/it]Best trial: 61. Best value: 0.159632:  84%|████████▍ | 84/100 [06:56<01:17,  4.87s/it]Best trial: 61. Best value: 0.159632:  84%|████████▍ | 84/100 [07:00<01:17,  4.87s/it]Best trial: 61. Best value: 0.159632:  85%|████████▌ | 85/100 [07:00<01:11,  4.75s/it]Best trial: 61. Best value: 0.159632:  85%|████████▌ | 85/100 [07:06<01:11,  4.75s/it]Best trial: 61. Best value: 0.159632:  86%|████████▌ | 86/100 [07:06<01:09,  4.95s/it]Best trial: 61. Best value: 0.159632:  86%|████████▌ | 86/100 [07:10<01:09,  4.95s/it]Best trial: 61. Best value: 0.159632:  87%|████████▋ | 87/100 [07:10<01:01,  4.73s/it]Best trial: 61. Best value: 0.159632:  87%|████████▋ | 87/100 [07:14<01:01,  4.73s/it]Best trial: 61. Best value: 0.159632:  88%|████████▊ | 88/100 [07:14<00:54,  4.56s/it]Best trial: 61. Best value: 0.159632:  88%|████████▊ | 88/100 [07:18<00:54,  4.56s/it]Best trial: 61. Best value: 0.159632:  89%|████████▉ | 89/100 [07:18<00:46,  4.19s/it]Best trial: 61. Best value: 0.159632:  89%|████████▉ | 89/100 [07:20<00:46,  4.19s/it]Best trial: 61. Best value: 0.159632:  90%|█████████ | 90/100 [07:20<00:36,  3.70s/it]Best trial: 61. Best value: 0.159632:  90%|█████████ | 90/100 [07:23<00:36,  3.70s/it]Best trial: 61. Best value: 0.159632:  91%|█████████ | 91/100 [07:23<00:29,  3.32s/it]Best trial: 61. Best value: 0.159632:  91%|█████████ | 91/100 [07:25<00:29,  3.32s/it]Best trial: 61. Best value: 0.159632:  92%|█████████▏| 92/100 [07:25<00:25,  3.13s/it]Best trial: 61. Best value: 0.159632:  92%|█████████▏| 92/100 [07:28<00:25,  3.13s/it]Best trial: 61. Best value: 0.159632:  93%|█████████▎| 93/100 [07:28<00:20,  2.90s/it]Best trial: 61. Best value: 0.159632:  93%|█████████▎| 93/100 [07:31<00:20,  2.90s/it]Best trial: 61. Best value: 0.159632:  94%|█████████▍| 94/100 [07:31<00:19,  3.17s/it]Best trial: 61. Best value: 0.159632:  94%|█████████▍| 94/100 [07:34<00:19,  3.17s/it]Best trial: 61. Best value: 0.159632:  95%|█████████▌| 95/100 [07:34<00:15,  3.03s/it]Best trial: 61. Best value: 0.159632:  95%|█████████▌| 95/100 [07:38<00:15,  3.03s/it]Best trial: 61. Best value: 0.159632:  96%|█████████▌| 96/100 [07:38<00:12,  3.24s/it]Best trial: 61. Best value: 0.159632:  96%|█████████▌| 96/100 [07:42<00:12,  3.24s/it]Best trial: 61. Best value: 0.159632:  97%|█████████▋| 97/100 [07:42<00:10,  3.50s/it]Best trial: 61. Best value: 0.159632:  97%|█████████▋| 97/100 [07:46<00:10,  3.50s/it]Best trial: 61. Best value: 0.159632:  98%|█████████▊| 98/100 [07:46<00:07,  3.52s/it]Best trial: 61. Best value: 0.159632:  98%|█████████▊| 98/100 [07:51<00:07,  3.52s/it]Best trial: 61. Best value: 0.159632:  99%|█████████▉| 99/100 [07:51<00:03,  3.99s/it]Best trial: 61. Best value: 0.159632:  99%|█████████▉| 99/100 [07:54<00:03,  3.99s/it]Best trial: 61. Best value: 0.159632: 100%|██████████| 100/100 [07:54<00:00,  3.95s/it]Best trial: 61. Best value: 0.159632: 100%|██████████| 100/100 [07:54<00:00,  4.75s/it]
2025-11-30 09:58:54,333 - INFO - HPO Complete. Best AUPRC: 0.1596
2025-11-30 09:58:54,333 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.05550238961458044, 'max_depth': 9, 'subsample': 0.8497296871969175, 'colsample_bytree': 0.6625714467653478, 'gamma': 1.866575867349678, 'reg_lambda': 0.048958854871028676, 'reg_alpha': 0.6619554489570196}
2025-11-30 09:58:54,334 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 09:58:56,257 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: monitors_only
2025-11-30 09:58:56,257 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:58:56,464 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:58:56,501 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:58:56,508 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 09:58:56,508 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 09:58:56,508 - INFO - Training model...
2025-11-30 09:58:59,863 - INFO - Evaluating model with bootstrapping...
2025-11-30 09:59:05,265 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 09:59:05,265 - INFO - AUROC: 0.6287 (0.5313 - 0.7127)
2025-11-30 09:59:05,265 - INFO - AUPRC: 0.0901 (0.0562 - 0.1403)
2025-11-30 09:59:05,265 - INFO - Brier Score: 0.0520 (0.0401 - 0.0667)
2025-11-30 09:59:05,265 - INFO - Accuracy: 0.8006 (0.6740 - 0.9460)
2025-11-30 09:59:05,265 - INFO - Precision: 0.1077 (0.0738 - 0.2978)
2025-11-30 09:59:05,265 - INFO - Sensitivity (Recall): 0.3889 (0.1075 - 0.5698)
2025-11-30 09:59:05,265 - INFO - F1-Score: 0.1687 (0.1130 - 0.2448)
2025-11-30 09:59:05,265 - INFO - Best Threshold: 0.0600 (0.0360 - 0.3360)
2025-11-30 09:59:05,265 - INFO - Specificity: 0.8232 (0.6848 - 0.9789)
2025-11-30 09:59:05,279 - INFO - Calculating SHAP values...
2025-11-30 09:59:06,460 - INFO - SHAP plots saved.
2025-11-30 09:59:06,462 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 09:59:07,794 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 09:59:07,795 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 09:59:08,032 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 09:59:08,069 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 09:59:08,083 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 09:59:08,083 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.485626:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.485626:   1%|          | 1/100 [00:05<09:09,  5.56s/it]Best trial: 1. Best value: 0.490294:   1%|          | 1/100 [00:08<09:09,  5.56s/it]Best trial: 1. Best value: 0.490294:   2%|▏         | 2/100 [00:08<06:33,  4.02s/it]Best trial: 1. Best value: 0.490294:   2%|▏         | 2/100 [00:11<06:33,  4.02s/it]Best trial: 1. Best value: 0.490294:   3%|▎         | 3/100 [00:11<05:34,  3.44s/it]Best trial: 1. Best value: 0.490294:   3%|▎         | 3/100 [00:13<05:34,  3.44s/it]Best trial: 1. Best value: 0.490294:   4%|▍         | 4/100 [00:13<04:57,  3.09s/it]Best trial: 1. Best value: 0.490294:   4%|▍         | 4/100 [00:16<04:57,  3.09s/it]Best trial: 1. Best value: 0.490294:   5%|▌         | 5/100 [00:16<04:30,  2.85s/it]Best trial: 5. Best value: 0.499201:   5%|▌         | 5/100 [00:22<04:30,  2.85s/it]Best trial: 5. Best value: 0.499201:   6%|▌         | 6/100 [00:22<06:30,  4.16s/it]Best trial: 5. Best value: 0.499201:   6%|▌         | 6/100 [00:26<06:30,  4.16s/it]Best trial: 5. Best value: 0.499201:   7%|▋         | 7/100 [00:26<06:13,  4.02s/it]Best trial: 5. Best value: 0.499201:   7%|▋         | 7/100 [00:30<06:13,  4.02s/it]Best trial: 5. Best value: 0.499201:   8%|▊         | 8/100 [00:30<05:56,  3.87s/it]Best trial: 5. Best value: 0.499201:   8%|▊         | 8/100 [00:34<05:56,  3.87s/it]Best trial: 5. Best value: 0.499201:   9%|▉         | 9/100 [00:34<06:00,  3.96s/it]Best trial: 5. Best value: 0.499201:   9%|▉         | 9/100 [00:41<06:00,  3.96s/it]Best trial: 5. Best value: 0.499201:  10%|█         | 10/100 [00:41<07:25,  4.95s/it]Best trial: 10. Best value: 0.509658:  10%|█         | 10/100 [00:47<07:25,  4.95s/it]Best trial: 10. Best value: 0.509658:  11%|█         | 11/100 [00:47<07:35,  5.11s/it]Best trial: 10. Best value: 0.509658:  11%|█         | 11/100 [00:52<07:35,  5.11s/it]Best trial: 10. Best value: 0.509658:  12%|█▏        | 12/100 [00:52<07:41,  5.24s/it]Best trial: 12. Best value: 0.51176:  12%|█▏        | 12/100 [00:57<07:41,  5.24s/it] Best trial: 12. Best value: 0.51176:  13%|█▎        | 13/100 [00:57<07:22,  5.08s/it]Best trial: 13. Best value: 0.521257:  13%|█▎        | 13/100 [01:02<07:22,  5.08s/it]Best trial: 13. Best value: 0.521257:  14%|█▍        | 14/100 [01:02<07:26,  5.19s/it]Best trial: 13. Best value: 0.521257:  14%|█▍        | 14/100 [01:08<07:26,  5.19s/it]Best trial: 13. Best value: 0.521257:  15%|█▌        | 15/100 [01:08<07:38,  5.39s/it]Best trial: 13. Best value: 0.521257:  15%|█▌        | 15/100 [01:13<07:38,  5.39s/it]Best trial: 13. Best value: 0.521257:  16%|█▌        | 16/100 [01:13<07:24,  5.29s/it]Best trial: 13. Best value: 0.521257:  16%|█▌        | 16/100 [01:21<07:24,  5.29s/it]Best trial: 13. Best value: 0.521257:  17%|█▋        | 17/100 [01:21<08:11,  5.92s/it]Best trial: 13. Best value: 0.521257:  17%|█▋        | 17/100 [01:25<08:11,  5.92s/it]Best trial: 13. Best value: 0.521257:  18%|█▊        | 18/100 [01:25<07:42,  5.64s/it]Best trial: 13. Best value: 0.521257:  18%|█▊        | 18/100 [01:30<07:42,  5.64s/it]Best trial: 13. Best value: 0.521257:  19%|█▉        | 19/100 [01:30<06:57,  5.15s/it]Best trial: 13. Best value: 0.521257:  19%|█▉        | 19/100 [01:36<06:57,  5.15s/it]Best trial: 13. Best value: 0.521257:  20%|██        | 20/100 [01:36<07:17,  5.47s/it]Best trial: 13. Best value: 0.521257:  20%|██        | 20/100 [01:42<07:17,  5.47s/it]Best trial: 13. Best value: 0.521257:  21%|██        | 21/100 [01:42<07:24,  5.63s/it]Best trial: 21. Best value: 0.527134:  21%|██        | 21/100 [01:47<07:24,  5.63s/it]Best trial: 21. Best value: 0.527134:  22%|██▏       | 22/100 [01:47<07:01,  5.40s/it]Best trial: 21. Best value: 0.527134:  22%|██▏       | 22/100 [01:54<07:01,  5.40s/it]Best trial: 21. Best value: 0.527134:  23%|██▎       | 23/100 [01:54<07:32,  5.88s/it]Best trial: 21. Best value: 0.527134:  23%|██▎       | 23/100 [02:00<07:32,  5.88s/it]Best trial: 21. Best value: 0.527134:  24%|██▍       | 24/100 [02:00<07:49,  6.17s/it]Best trial: 21. Best value: 0.527134:  24%|██▍       | 24/100 [02:06<07:49,  6.17s/it]Best trial: 21. Best value: 0.527134:  25%|██▌       | 25/100 [02:06<07:39,  6.13s/it]Best trial: 21. Best value: 0.527134:  25%|██▌       | 25/100 [02:11<07:39,  6.13s/it]Best trial: 21. Best value: 0.527134:  26%|██▌       | 26/100 [02:11<07:00,  5.68s/it]Best trial: 21. Best value: 0.527134:  26%|██▌       | 26/100 [02:16<07:00,  5.68s/it]Best trial: 21. Best value: 0.527134:  27%|██▋       | 27/100 [02:16<06:34,  5.40s/it]Best trial: 21. Best value: 0.527134:  27%|██▋       | 27/100 [02:23<06:34,  5.40s/it]Best trial: 21. Best value: 0.527134:  28%|██▊       | 28/100 [02:23<06:59,  5.83s/it]Best trial: 21. Best value: 0.527134:  28%|██▊       | 28/100 [02:29<06:59,  5.83s/it]Best trial: 21. Best value: 0.527134:  29%|██▉       | 29/100 [02:29<06:53,  5.83s/it]Best trial: 21. Best value: 0.527134:  29%|██▉       | 29/100 [02:33<06:53,  5.83s/it]Best trial: 21. Best value: 0.527134:  30%|███       | 30/100 [02:33<06:13,  5.34s/it]Best trial: 21. Best value: 0.527134:  30%|███       | 30/100 [02:36<06:13,  5.34s/it]Best trial: 21. Best value: 0.527134:  31%|███       | 31/100 [02:36<05:25,  4.71s/it]Best trial: 21. Best value: 0.527134:  31%|███       | 31/100 [02:41<05:25,  4.71s/it]Best trial: 21. Best value: 0.527134:  32%|███▏      | 32/100 [02:41<05:21,  4.73s/it]Best trial: 21. Best value: 0.527134:  32%|███▏      | 32/100 [02:45<05:21,  4.73s/it]Best trial: 21. Best value: 0.527134:  33%|███▎      | 33/100 [02:45<05:13,  4.69s/it]Best trial: 21. Best value: 0.527134:  33%|███▎      | 33/100 [02:52<05:13,  4.69s/it]Best trial: 21. Best value: 0.527134:  34%|███▍      | 34/100 [02:52<05:45,  5.23s/it]Best trial: 21. Best value: 0.527134:  34%|███▍      | 34/100 [02:57<05:45,  5.23s/it]Best trial: 21. Best value: 0.527134:  35%|███▌      | 35/100 [02:57<05:44,  5.30s/it]Best trial: 21. Best value: 0.527134:  35%|███▌      | 35/100 [03:01<05:44,  5.30s/it]Best trial: 21. Best value: 0.527134:  36%|███▌      | 36/100 [03:01<05:16,  4.94s/it]Best trial: 21. Best value: 0.527134:  36%|███▌      | 36/100 [03:06<05:16,  4.94s/it]Best trial: 21. Best value: 0.527134:  37%|███▋      | 37/100 [03:06<05:09,  4.91s/it]Best trial: 21. Best value: 0.527134:  37%|███▋      | 37/100 [03:11<05:09,  4.91s/it]Best trial: 21. Best value: 0.527134:  38%|███▊      | 38/100 [03:11<04:53,  4.74s/it]Best trial: 21. Best value: 0.527134:  38%|███▊      | 38/100 [03:18<04:53,  4.74s/it]Best trial: 21. Best value: 0.527134:  39%|███▉      | 39/100 [03:18<05:30,  5.42s/it]Best trial: 21. Best value: 0.527134:  39%|███▉      | 39/100 [03:20<05:30,  5.42s/it]Best trial: 21. Best value: 0.527134:  40%|████      | 40/100 [03:20<04:35,  4.60s/it]Best trial: 21. Best value: 0.527134:  40%|████      | 40/100 [03:27<04:35,  4.60s/it]Best trial: 21. Best value: 0.527134:  41%|████      | 41/100 [03:27<05:11,  5.28s/it]Best trial: 21. Best value: 0.527134:  41%|████      | 41/100 [03:31<05:11,  5.28s/it]Best trial: 21. Best value: 0.527134:  42%|████▏     | 42/100 [03:31<04:48,  4.98s/it]Best trial: 21. Best value: 0.527134:  42%|████▏     | 42/100 [03:36<04:48,  4.98s/it]Best trial: 21. Best value: 0.527134:  43%|████▎     | 43/100 [03:36<04:32,  4.78s/it]Best trial: 21. Best value: 0.527134:  43%|████▎     | 43/100 [03:40<04:32,  4.78s/it]Best trial: 21. Best value: 0.527134:  44%|████▍     | 44/100 [03:40<04:17,  4.60s/it]Best trial: 21. Best value: 0.527134:  44%|████▍     | 44/100 [03:45<04:17,  4.60s/it]Best trial: 21. Best value: 0.527134:  45%|████▌     | 45/100 [03:45<04:13,  4.62s/it]Best trial: 21. Best value: 0.527134:  45%|████▌     | 45/100 [03:49<04:13,  4.62s/it]Best trial: 21. Best value: 0.527134:  46%|████▌     | 46/100 [03:49<04:10,  4.64s/it]Best trial: 21. Best value: 0.527134:  46%|████▌     | 46/100 [03:55<04:10,  4.64s/it]Best trial: 21. Best value: 0.527134:  47%|████▋     | 47/100 [03:55<04:16,  4.84s/it]Best trial: 21. Best value: 0.527134:  47%|████▋     | 47/100 [04:01<04:16,  4.84s/it]Best trial: 21. Best value: 0.527134:  48%|████▊     | 48/100 [04:01<04:41,  5.42s/it]Best trial: 21. Best value: 0.527134:  48%|████▊     | 48/100 [04:06<04:41,  5.42s/it]Best trial: 21. Best value: 0.527134:  49%|████▉     | 49/100 [04:06<04:29,  5.28s/it]Best trial: 21. Best value: 0.527134:  49%|████▉     | 49/100 [04:11<04:29,  5.28s/it]Best trial: 21. Best value: 0.527134:  50%|█████     | 50/100 [04:11<04:19,  5.19s/it]Best trial: 21. Best value: 0.527134:  50%|█████     | 50/100 [04:16<04:19,  5.19s/it]Best trial: 21. Best value: 0.527134:  51%|█████     | 51/100 [04:16<04:09,  5.09s/it]Best trial: 21. Best value: 0.527134:  51%|█████     | 51/100 [04:21<04:09,  5.09s/it]Best trial: 21. Best value: 0.527134:  52%|█████▏    | 52/100 [04:21<04:00,  5.01s/it]Best trial: 21. Best value: 0.527134:  52%|█████▏    | 52/100 [04:26<04:00,  5.01s/it]Best trial: 21. Best value: 0.527134:  53%|█████▎    | 53/100 [04:26<03:50,  4.91s/it]Best trial: 21. Best value: 0.527134:  53%|█████▎    | 53/100 [04:31<03:50,  4.91s/it]Best trial: 21. Best value: 0.527134:  54%|█████▍    | 54/100 [04:31<03:47,  4.95s/it]Best trial: 21. Best value: 0.527134:  54%|█████▍    | 54/100 [04:36<03:47,  4.95s/it]Best trial: 21. Best value: 0.527134:  55%|█████▌    | 55/100 [04:36<03:48,  5.07s/it]Best trial: 21. Best value: 0.527134:  55%|█████▌    | 55/100 [04:42<03:48,  5.07s/it]Best trial: 21. Best value: 0.527134:  56%|█████▌    | 56/100 [04:42<04:00,  5.47s/it]Best trial: 21. Best value: 0.527134:  56%|█████▌    | 56/100 [04:47<04:00,  5.47s/it]Best trial: 21. Best value: 0.527134:  57%|█████▋    | 57/100 [04:47<03:49,  5.33s/it]Best trial: 21. Best value: 0.527134:  57%|█████▋    | 57/100 [04:51<03:49,  5.33s/it]Best trial: 21. Best value: 0.527134:  58%|█████▊    | 58/100 [04:51<03:16,  4.68s/it]Best trial: 58. Best value: 0.533328:  58%|█████▊    | 58/100 [04:56<03:16,  4.68s/it]Best trial: 58. Best value: 0.533328:  59%|█████▉    | 59/100 [04:56<03:22,  4.94s/it]Best trial: 58. Best value: 0.533328:  59%|█████▉    | 59/100 [05:02<03:22,  4.94s/it]Best trial: 58. Best value: 0.533328:  60%|██████    | 60/100 [05:02<03:26,  5.17s/it]Best trial: 58. Best value: 0.533328:  60%|██████    | 60/100 [05:07<03:26,  5.17s/it]Best trial: 58. Best value: 0.533328:  61%|██████    | 61/100 [05:07<03:21,  5.17s/it]Best trial: 58. Best value: 0.533328:  61%|██████    | 61/100 [05:12<03:21,  5.17s/it]Best trial: 58. Best value: 0.533328:  62%|██████▏   | 62/100 [05:12<03:13,  5.10s/it]Best trial: 58. Best value: 0.533328:  62%|██████▏   | 62/100 [05:17<03:13,  5.10s/it]Best trial: 58. Best value: 0.533328:  63%|██████▎   | 63/100 [05:17<03:13,  5.24s/it]Best trial: 58. Best value: 0.533328:  63%|██████▎   | 63/100 [05:22<03:13,  5.24s/it]Best trial: 58. Best value: 0.533328:  64%|██████▍   | 64/100 [05:22<03:04,  5.12s/it]Best trial: 58. Best value: 0.533328:  64%|██████▍   | 64/100 [05:27<03:04,  5.12s/it]Best trial: 58. Best value: 0.533328:  65%|██████▌   | 65/100 [05:27<02:57,  5.06s/it]Best trial: 58. Best value: 0.533328:  65%|██████▌   | 65/100 [05:32<02:57,  5.06s/it]Best trial: 58. Best value: 0.533328:  66%|██████▌   | 66/100 [05:32<02:48,  4.97s/it]Best trial: 58. Best value: 0.533328:  66%|██████▌   | 66/100 [05:36<02:48,  4.97s/it]Best trial: 58. Best value: 0.533328:  67%|██████▋   | 67/100 [05:36<02:35,  4.73s/it]Best trial: 58. Best value: 0.533328:  67%|██████▋   | 67/100 [05:44<02:35,  4.73s/it]Best trial: 58. Best value: 0.533328:  68%|██████▊   | 68/100 [05:44<02:58,  5.57s/it]Best trial: 58. Best value: 0.533328:  68%|██████▊   | 68/100 [05:49<02:58,  5.57s/it]Best trial: 58. Best value: 0.533328:  69%|██████▉   | 69/100 [05:49<02:54,  5.64s/it]Best trial: 58. Best value: 0.533328:  69%|██████▉   | 69/100 [05:54<02:54,  5.64s/it]Best trial: 58. Best value: 0.533328:  70%|███████   | 70/100 [05:54<02:41,  5.37s/it]Best trial: 58. Best value: 0.533328:  70%|███████   | 70/100 [06:00<02:41,  5.37s/it]Best trial: 58. Best value: 0.533328:  71%|███████   | 71/100 [06:00<02:36,  5.40s/it]Best trial: 58. Best value: 0.533328:  71%|███████   | 71/100 [06:04<02:36,  5.40s/it]Best trial: 58. Best value: 0.533328:  72%|███████▏  | 72/100 [06:04<02:24,  5.17s/it]Best trial: 58. Best value: 0.533328:  72%|███████▏  | 72/100 [06:09<02:24,  5.17s/it]Best trial: 58. Best value: 0.533328:  73%|███████▎  | 73/100 [06:09<02:15,  5.01s/it]Best trial: 58. Best value: 0.533328:  73%|███████▎  | 73/100 [06:14<02:15,  5.01s/it]Best trial: 58. Best value: 0.533328:  74%|███████▍  | 74/100 [06:14<02:07,  4.89s/it]Best trial: 58. Best value: 0.533328:  74%|███████▍  | 74/100 [06:18<02:07,  4.89s/it]Best trial: 58. Best value: 0.533328:  75%|███████▌  | 75/100 [06:18<01:58,  4.75s/it]Best trial: 58. Best value: 0.533328:  75%|███████▌  | 75/100 [06:23<01:58,  4.75s/it]Best trial: 58. Best value: 0.533328:  76%|███████▌  | 76/100 [06:23<01:54,  4.79s/it]Best trial: 58. Best value: 0.533328:  76%|███████▌  | 76/100 [06:28<01:54,  4.79s/it]Best trial: 58. Best value: 0.533328:  77%|███████▋  | 77/100 [06:28<01:52,  4.91s/it]Best trial: 58. Best value: 0.533328:  77%|███████▋  | 77/100 [06:33<01:52,  4.91s/it]Best trial: 58. Best value: 0.533328:  78%|███████▊  | 78/100 [06:33<01:49,  4.99s/it]Best trial: 58. Best value: 0.533328:  78%|███████▊  | 78/100 [06:39<01:49,  4.99s/it]Best trial: 58. Best value: 0.533328:  79%|███████▉  | 79/100 [06:39<01:51,  5.29s/it]Best trial: 58. Best value: 0.533328:  79%|███████▉  | 79/100 [06:45<01:51,  5.29s/it]Best trial: 58. Best value: 0.533328:  80%|████████  | 80/100 [06:45<01:47,  5.39s/it]Best trial: 58. Best value: 0.533328:  80%|████████  | 80/100 [06:51<01:47,  5.39s/it]Best trial: 58. Best value: 0.533328:  81%|████████  | 81/100 [06:51<01:47,  5.64s/it]Best trial: 58. Best value: 0.533328:  81%|████████  | 81/100 [06:57<01:47,  5.64s/it]Best trial: 58. Best value: 0.533328:  82%|████████▏ | 82/100 [06:57<01:44,  5.79s/it]Best trial: 58. Best value: 0.533328:  82%|████████▏ | 82/100 [07:03<01:44,  5.79s/it]Best trial: 58. Best value: 0.533328:  83%|████████▎ | 83/100 [07:03<01:36,  5.68s/it]Best trial: 58. Best value: 0.533328:  83%|████████▎ | 83/100 [07:08<01:36,  5.68s/it]Best trial: 58. Best value: 0.533328:  84%|████████▍ | 84/100 [07:08<01:28,  5.51s/it]Best trial: 58. Best value: 0.533328:  84%|████████▍ | 84/100 [07:13<01:28,  5.51s/it]Best trial: 58. Best value: 0.533328:  85%|████████▌ | 85/100 [07:13<01:20,  5.38s/it]Best trial: 58. Best value: 0.533328:  85%|████████▌ | 85/100 [07:19<01:20,  5.38s/it]Best trial: 58. Best value: 0.533328:  86%|████████▌ | 86/100 [07:19<01:18,  5.64s/it]Best trial: 58. Best value: 0.533328:  86%|████████▌ | 86/100 [07:25<01:18,  5.64s/it]Best trial: 58. Best value: 0.533328:  87%|████████▋ | 87/100 [07:25<01:13,  5.66s/it]Best trial: 58. Best value: 0.533328:  87%|████████▋ | 87/100 [07:30<01:13,  5.66s/it]Best trial: 58. Best value: 0.533328:  88%|████████▊ | 88/100 [07:30<01:05,  5.42s/it]Best trial: 58. Best value: 0.533328:  88%|████████▊ | 88/100 [07:34<01:05,  5.42s/it]Best trial: 58. Best value: 0.533328:  89%|████████▉ | 89/100 [07:34<00:57,  5.23s/it]Best trial: 58. Best value: 0.533328:  89%|████████▉ | 89/100 [07:40<00:57,  5.23s/it]Best trial: 58. Best value: 0.533328:  90%|█████████ | 90/100 [07:40<00:52,  5.27s/it]Best trial: 58. Best value: 0.533328:  90%|█████████ | 90/100 [07:46<00:52,  5.27s/it]Best trial: 58. Best value: 0.533328:  91%|█████████ | 91/100 [07:46<00:49,  5.45s/it]Best trial: 58. Best value: 0.533328:  91%|█████████ | 91/100 [07:50<00:49,  5.45s/it]Best trial: 58. Best value: 0.533328:  92%|█████████▏| 92/100 [07:50<00:41,  5.17s/it]Best trial: 58. Best value: 0.533328:  92%|█████████▏| 92/100 [07:56<00:41,  5.17s/it]Best trial: 58. Best value: 0.533328:  93%|█████████▎| 93/100 [07:56<00:38,  5.49s/it]Best trial: 58. Best value: 0.533328:  93%|█████████▎| 93/100 [08:02<00:38,  5.49s/it]Best trial: 58. Best value: 0.533328:  94%|█████████▍| 94/100 [08:02<00:32,  5.46s/it]Best trial: 58. Best value: 0.533328:  94%|█████████▍| 94/100 [08:07<00:32,  5.46s/it]Best trial: 58. Best value: 0.533328:  95%|█████████▌| 95/100 [08:07<00:27,  5.52s/it]Best trial: 58. Best value: 0.533328:  95%|█████████▌| 95/100 [08:12<00:27,  5.52s/it]Best trial: 58. Best value: 0.533328:  96%|█████████▌| 96/100 [08:12<00:21,  5.36s/it]Best trial: 58. Best value: 0.533328:  96%|█████████▌| 96/100 [08:17<00:21,  5.36s/it]Best trial: 58. Best value: 0.533328:  97%|█████████▋| 97/100 [08:17<00:15,  5.24s/it]Best trial: 58. Best value: 0.533328:  97%|█████████▋| 97/100 [08:23<00:15,  5.24s/it]Best trial: 58. Best value: 0.533328:  98%|█████████▊| 98/100 [08:23<00:10,  5.44s/it]Best trial: 58. Best value: 0.533328:  98%|█████████▊| 98/100 [08:31<00:10,  5.44s/it]Best trial: 58. Best value: 0.533328:  99%|█████████▉| 99/100 [08:31<00:06,  6.01s/it]Best trial: 58. Best value: 0.533328:  99%|█████████▉| 99/100 [08:33<00:06,  6.01s/it]Best trial: 58. Best value: 0.533328: 100%|██████████| 100/100 [08:33<00:00,  5.04s/it]Best trial: 58. Best value: 0.533328: 100%|██████████| 100/100 [08:33<00:00,  5.14s/it]
2025-11-30 10:07:42,026 - INFO - HPO Complete. Best AUPRC: 0.5333
2025-11-30 10:07:42,027 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0009098402611003727, 'max_depth': 9, 'subsample': 0.637670113055809, 'colsample_bytree': 0.6667435134092828, 'gamma': 1.4650256736473852, 'reg_lambda': 0.09048558450790803, 'reg_alpha': 9.292098713225973e-05}
2025-11-30 10:07:42,027 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:07:43,998 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 10:07:43,998 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:07:44,216 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:07:44,250 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:07:44,258 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:07:44,258 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:07:44,259 - INFO - Training model...
2025-11-30 10:07:49,244 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:07:54,866 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:07:54,866 - INFO - AUROC: 0.7987 (0.7262 - 0.8678)
2025-11-30 10:07:54,866 - INFO - AUPRC: 0.4101 (0.2787 - 0.5497)
2025-11-30 10:07:54,866 - INFO - Brier Score: 0.1338 (0.1302 - 0.1371)
2025-11-30 10:07:54,866 - INFO - Accuracy: 0.9595 (0.9338 - 0.9731)
2025-11-30 10:07:54,866 - INFO - Precision: 0.7222 (0.3791 - 0.9667)
2025-11-30 10:07:54,867 - INFO - Sensitivity (Recall): 0.3611 (0.2480 - 0.5871)
2025-11-30 10:07:54,867 - INFO - F1-Score: 0.4815 (0.3457 - 0.6546)
2025-11-30 10:07:54,867 - INFO - Best Threshold: 0.4800 (0.4200 - 0.5000)
2025-11-30 10:07:54,867 - INFO - Specificity: 0.9924 (0.9649 - 0.9991)
2025-11-30 10:07:54,895 - INFO - Calculating SHAP values...
2025-11-30 10:07:56,260 - INFO - SHAP plots saved.
2025-11-30 10:07:56,261 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:07:57,579 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 10:07:57,579 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:07:57,822 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:07:57,859 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:07:57,868 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:07:57,868 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.505769:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.505769:   1%|          | 1/100 [00:05<09:24,  5.70s/it]Best trial: 1. Best value: 0.516085:   1%|          | 1/100 [00:08<09:24,  5.70s/it]Best trial: 1. Best value: 0.516085:   2%|▏         | 2/100 [00:08<06:35,  4.04s/it]Best trial: 1. Best value: 0.516085:   2%|▏         | 2/100 [00:13<06:35,  4.04s/it]Best trial: 1. Best value: 0.516085:   3%|▎         | 3/100 [00:13<07:31,  4.65s/it]Best trial: 1. Best value: 0.516085:   3%|▎         | 3/100 [00:18<07:31,  4.65s/it]Best trial: 1. Best value: 0.516085:   4%|▍         | 4/100 [00:18<07:16,  4.55s/it]Best trial: 1. Best value: 0.516085:   4%|▍         | 4/100 [00:22<07:16,  4.55s/it]Best trial: 1. Best value: 0.516085:   5%|▌         | 5/100 [00:22<06:42,  4.24s/it]Best trial: 1. Best value: 0.516085:   5%|▌         | 5/100 [00:26<06:42,  4.24s/it]Best trial: 1. Best value: 0.516085:   6%|▌         | 6/100 [00:26<06:45,  4.31s/it]Best trial: 1. Best value: 0.516085:   6%|▌         | 6/100 [00:33<06:45,  4.31s/it]Best trial: 1. Best value: 0.516085:   7%|▋         | 7/100 [00:33<08:01,  5.17s/it]Best trial: 7. Best value: 0.545887:   7%|▋         | 7/100 [00:38<08:01,  5.17s/it]Best trial: 7. Best value: 0.545887:   8%|▊         | 8/100 [00:38<07:40,  5.01s/it]Best trial: 7. Best value: 0.545887:   8%|▊         | 8/100 [00:45<07:40,  5.01s/it]Best trial: 7. Best value: 0.545887:   9%|▉         | 9/100 [00:45<08:41,  5.73s/it]Best trial: 7. Best value: 0.545887:   9%|▉         | 9/100 [00:51<08:41,  5.73s/it]Best trial: 7. Best value: 0.545887:  10%|█         | 10/100 [00:51<08:50,  5.89s/it]Best trial: 7. Best value: 0.545887:  10%|█         | 10/100 [00:54<08:50,  5.89s/it]Best trial: 7. Best value: 0.545887:  11%|█         | 11/100 [00:54<07:25,  5.01s/it]Best trial: 7. Best value: 0.545887:  11%|█         | 11/100 [00:57<07:25,  5.01s/it]Best trial: 7. Best value: 0.545887:  12%|█▏        | 12/100 [00:57<06:29,  4.43s/it]Best trial: 7. Best value: 0.545887:  12%|█▏        | 12/100 [01:01<06:29,  4.43s/it]Best trial: 7. Best value: 0.545887:  13%|█▎        | 13/100 [01:01<06:10,  4.26s/it]Best trial: 7. Best value: 0.545887:  13%|█▎        | 13/100 [01:05<06:10,  4.26s/it]Best trial: 7. Best value: 0.545887:  14%|█▍        | 14/100 [01:05<05:53,  4.11s/it]Best trial: 7. Best value: 0.545887:  14%|█▍        | 14/100 [01:08<05:53,  4.11s/it]Best trial: 7. Best value: 0.545887:  15%|█▌        | 15/100 [01:08<05:26,  3.85s/it]Best trial: 7. Best value: 0.545887:  15%|█▌        | 15/100 [01:13<05:26,  3.85s/it]Best trial: 7. Best value: 0.545887:  16%|█▌        | 16/100 [01:13<05:43,  4.09s/it]Best trial: 7. Best value: 0.545887:  16%|█▌        | 16/100 [01:18<05:43,  4.09s/it]Best trial: 7. Best value: 0.545887:  17%|█▋        | 17/100 [01:18<05:58,  4.32s/it]Best trial: 7. Best value: 0.545887:  17%|█▋        | 17/100 [01:21<05:58,  4.32s/it]Best trial: 7. Best value: 0.545887:  18%|█▊        | 18/100 [01:21<05:20,  3.90s/it]Best trial: 7. Best value: 0.545887:  18%|█▊        | 18/100 [01:25<05:20,  3.90s/it]Best trial: 7. Best value: 0.545887:  19%|█▉        | 19/100 [01:25<05:38,  4.18s/it]Best trial: 7. Best value: 0.545887:  19%|█▉        | 19/100 [01:28<05:38,  4.18s/it]Best trial: 7. Best value: 0.545887:  20%|██        | 20/100 [01:28<05:04,  3.81s/it]Best trial: 7. Best value: 0.545887:  20%|██        | 20/100 [01:32<05:04,  3.81s/it]Best trial: 7. Best value: 0.545887:  21%|██        | 21/100 [01:32<04:52,  3.70s/it]Best trial: 7. Best value: 0.545887:  21%|██        | 21/100 [01:35<04:52,  3.70s/it]Best trial: 7. Best value: 0.545887:  22%|██▏       | 22/100 [01:35<04:43,  3.64s/it]Best trial: 7. Best value: 0.545887:  22%|██▏       | 22/100 [01:40<04:43,  3.64s/it]Best trial: 7. Best value: 0.545887:  23%|██▎       | 23/100 [01:40<04:57,  3.87s/it]Best trial: 7. Best value: 0.545887:  23%|██▎       | 23/100 [01:43<04:57,  3.87s/it]Best trial: 7. Best value: 0.545887:  24%|██▍       | 24/100 [01:43<04:33,  3.60s/it]Best trial: 7. Best value: 0.545887:  24%|██▍       | 24/100 [01:49<04:33,  3.60s/it]Best trial: 7. Best value: 0.545887:  25%|██▌       | 25/100 [01:49<05:34,  4.46s/it]Best trial: 7. Best value: 0.545887:  25%|██▌       | 25/100 [01:54<05:34,  4.46s/it]Best trial: 7. Best value: 0.545887:  26%|██▌       | 26/100 [01:54<05:36,  4.55s/it]Best trial: 7. Best value: 0.545887:  26%|██▌       | 26/100 [01:57<05:36,  4.55s/it]Best trial: 7. Best value: 0.545887:  27%|██▋       | 27/100 [01:57<05:03,  4.16s/it]Best trial: 7. Best value: 0.545887:  27%|██▋       | 27/100 [02:01<05:03,  4.16s/it]Best trial: 7. Best value: 0.545887:  28%|██▊       | 28/100 [02:01<05:00,  4.17s/it]Best trial: 7. Best value: 0.545887:  28%|██▊       | 28/100 [02:05<05:00,  4.17s/it]Best trial: 7. Best value: 0.545887:  29%|██▉       | 29/100 [02:05<04:48,  4.06s/it]Best trial: 7. Best value: 0.545887:  29%|██▉       | 29/100 [02:09<04:48,  4.06s/it]Best trial: 7. Best value: 0.545887:  30%|███       | 30/100 [02:09<04:41,  4.02s/it]Best trial: 7. Best value: 0.545887:  30%|███       | 30/100 [02:13<04:41,  4.02s/it]Best trial: 7. Best value: 0.545887:  31%|███       | 31/100 [02:13<04:31,  3.94s/it]Best trial: 7. Best value: 0.545887:  31%|███       | 31/100 [02:16<04:31,  3.94s/it]Best trial: 7. Best value: 0.545887:  32%|███▏      | 32/100 [02:16<04:16,  3.78s/it]Best trial: 7. Best value: 0.545887:  32%|███▏      | 32/100 [02:20<04:16,  3.78s/it]Best trial: 7. Best value: 0.545887:  33%|███▎      | 33/100 [02:20<04:11,  3.75s/it]Best trial: 7. Best value: 0.545887:  33%|███▎      | 33/100 [02:23<04:11,  3.75s/it]Best trial: 7. Best value: 0.545887:  34%|███▍      | 34/100 [02:23<03:58,  3.62s/it]Best trial: 7. Best value: 0.545887:  34%|███▍      | 34/100 [02:27<03:58,  3.62s/it]Best trial: 7. Best value: 0.545887:  35%|███▌      | 35/100 [02:27<03:51,  3.56s/it]Best trial: 7. Best value: 0.545887:  35%|███▌      | 35/100 [02:30<03:51,  3.56s/it]Best trial: 7. Best value: 0.545887:  36%|███▌      | 36/100 [02:30<03:34,  3.35s/it]Best trial: 7. Best value: 0.545887:  36%|███▌      | 36/100 [02:32<03:34,  3.35s/it]Best trial: 7. Best value: 0.545887:  37%|███▋      | 37/100 [02:32<03:22,  3.22s/it]Best trial: 7. Best value: 0.545887:  37%|███▋      | 37/100 [02:37<03:22,  3.22s/it]Best trial: 7. Best value: 0.545887:  38%|███▊      | 38/100 [02:37<03:44,  3.63s/it]Best trial: 7. Best value: 0.545887:  38%|███▊      | 38/100 [02:43<03:44,  3.63s/it]Best trial: 7. Best value: 0.545887:  39%|███▉      | 39/100 [02:43<04:21,  4.28s/it]Best trial: 7. Best value: 0.545887:  39%|███▉      | 39/100 [02:47<04:21,  4.28s/it]Best trial: 7. Best value: 0.545887:  40%|████      | 40/100 [02:47<04:15,  4.25s/it]Best trial: 7. Best value: 0.545887:  40%|████      | 40/100 [02:52<04:15,  4.25s/it]Best trial: 7. Best value: 0.545887:  41%|████      | 41/100 [02:52<04:24,  4.49s/it]Best trial: 7. Best value: 0.545887:  41%|████      | 41/100 [02:56<04:24,  4.49s/it]Best trial: 7. Best value: 0.545887:  42%|████▏     | 42/100 [02:56<04:16,  4.42s/it]Best trial: 7. Best value: 0.545887:  42%|████▏     | 42/100 [03:01<04:16,  4.42s/it]Best trial: 7. Best value: 0.545887:  43%|████▎     | 43/100 [03:01<04:09,  4.38s/it]Best trial: 7. Best value: 0.545887:  43%|████▎     | 43/100 [03:04<04:09,  4.38s/it]Best trial: 7. Best value: 0.545887:  44%|████▍     | 44/100 [03:04<03:47,  4.06s/it]Best trial: 44. Best value: 0.546416:  44%|████▍     | 44/100 [03:07<03:47,  4.06s/it]Best trial: 44. Best value: 0.546416:  45%|████▌     | 45/100 [03:07<03:29,  3.81s/it]Best trial: 44. Best value: 0.546416:  45%|████▌     | 45/100 [03:11<03:29,  3.81s/it]Best trial: 44. Best value: 0.546416:  46%|████▌     | 46/100 [03:11<03:26,  3.82s/it]Best trial: 44. Best value: 0.546416:  46%|████▌     | 46/100 [03:14<03:26,  3.82s/it]Best trial: 44. Best value: 0.546416:  47%|████▋     | 47/100 [03:14<03:12,  3.64s/it]Best trial: 44. Best value: 0.546416:  47%|████▋     | 47/100 [03:17<03:12,  3.64s/it]Best trial: 44. Best value: 0.546416:  48%|████▊     | 48/100 [03:17<03:01,  3.49s/it]Best trial: 44. Best value: 0.546416:  48%|████▊     | 48/100 [03:21<03:01,  3.49s/it]Best trial: 44. Best value: 0.546416:  49%|████▉     | 49/100 [03:21<03:03,  3.60s/it]Best trial: 44. Best value: 0.546416:  49%|████▉     | 49/100 [03:27<03:03,  3.60s/it]Best trial: 44. Best value: 0.546416:  50%|█████     | 50/100 [03:27<03:32,  4.24s/it]Best trial: 44. Best value: 0.546416:  50%|█████     | 50/100 [03:33<03:32,  4.24s/it]Best trial: 44. Best value: 0.546416:  51%|█████     | 51/100 [03:33<03:48,  4.67s/it]Best trial: 44. Best value: 0.546416:  51%|█████     | 51/100 [03:36<03:48,  4.67s/it]Best trial: 44. Best value: 0.546416:  52%|█████▏    | 52/100 [03:36<03:27,  4.33s/it]Best trial: 44. Best value: 0.546416:  52%|█████▏    | 52/100 [03:40<03:27,  4.33s/it]Best trial: 44. Best value: 0.546416:  53%|█████▎    | 53/100 [03:40<03:15,  4.16s/it]Best trial: 44. Best value: 0.546416:  53%|█████▎    | 53/100 [03:43<03:15,  4.16s/it]Best trial: 44. Best value: 0.546416:  54%|█████▍    | 54/100 [03:43<02:54,  3.80s/it]Best trial: 44. Best value: 0.546416:  54%|█████▍    | 54/100 [03:47<02:54,  3.80s/it]Best trial: 44. Best value: 0.546416:  55%|█████▌    | 55/100 [03:47<02:54,  3.88s/it]Best trial: 44. Best value: 0.546416:  55%|█████▌    | 55/100 [03:52<02:54,  3.88s/it]Best trial: 44. Best value: 0.546416:  56%|█████▌    | 56/100 [03:52<03:02,  4.14s/it]Best trial: 44. Best value: 0.546416:  56%|█████▌    | 56/100 [03:55<03:02,  4.14s/it]Best trial: 44. Best value: 0.546416:  57%|█████▋    | 57/100 [03:55<02:41,  3.77s/it]Best trial: 44. Best value: 0.546416:  57%|█████▋    | 57/100 [03:59<02:41,  3.77s/it]Best trial: 44. Best value: 0.546416:  58%|█████▊    | 58/100 [03:59<02:51,  4.09s/it]Best trial: 44. Best value: 0.546416:  58%|█████▊    | 58/100 [04:03<02:51,  4.09s/it]Best trial: 44. Best value: 0.546416:  59%|█████▉    | 59/100 [04:03<02:44,  4.02s/it]Best trial: 44. Best value: 0.546416:  59%|█████▉    | 59/100 [04:07<02:44,  4.02s/it]Best trial: 44. Best value: 0.546416:  60%|██████    | 60/100 [04:07<02:37,  3.93s/it]Best trial: 44. Best value: 0.546416:  60%|██████    | 60/100 [04:10<02:37,  3.93s/it]Best trial: 44. Best value: 0.546416:  61%|██████    | 61/100 [04:10<02:25,  3.73s/it]Best trial: 44. Best value: 0.546416:  61%|██████    | 61/100 [04:14<02:25,  3.73s/it]Best trial: 44. Best value: 0.546416:  62%|██████▏   | 62/100 [04:14<02:21,  3.72s/it]Best trial: 44. Best value: 0.546416:  62%|██████▏   | 62/100 [04:17<02:21,  3.72s/it]Best trial: 44. Best value: 0.546416:  63%|██████▎   | 63/100 [04:17<02:15,  3.66s/it]Best trial: 44. Best value: 0.546416:  63%|██████▎   | 63/100 [04:21<02:15,  3.66s/it]Best trial: 44. Best value: 0.546416:  64%|██████▍   | 64/100 [04:21<02:07,  3.55s/it]Best trial: 44. Best value: 0.546416:  64%|██████▍   | 64/100 [04:25<02:07,  3.55s/it]Best trial: 44. Best value: 0.546416:  65%|██████▌   | 65/100 [04:25<02:09,  3.69s/it]Best trial: 44. Best value: 0.546416:  65%|██████▌   | 65/100 [04:29<02:09,  3.69s/it]Best trial: 44. Best value: 0.546416:  66%|██████▌   | 66/100 [04:29<02:09,  3.79s/it]Best trial: 44. Best value: 0.546416:  66%|██████▌   | 66/100 [04:33<02:09,  3.79s/it]Best trial: 44. Best value: 0.546416:  67%|██████▋   | 67/100 [04:33<02:07,  3.85s/it]Best trial: 44. Best value: 0.546416:  67%|██████▋   | 67/100 [04:37<02:07,  3.85s/it]Best trial: 44. Best value: 0.546416:  68%|██████▊   | 68/100 [04:37<02:06,  3.94s/it]Best trial: 44. Best value: 0.546416:  68%|██████▊   | 68/100 [04:41<02:06,  3.94s/it]Best trial: 44. Best value: 0.546416:  69%|██████▉   | 69/100 [04:41<01:59,  3.86s/it]Best trial: 44. Best value: 0.546416:  69%|██████▉   | 69/100 [04:44<01:59,  3.86s/it]Best trial: 44. Best value: 0.546416:  70%|███████   | 70/100 [04:44<01:50,  3.67s/it]Best trial: 44. Best value: 0.546416:  70%|███████   | 70/100 [04:48<01:50,  3.67s/it]Best trial: 44. Best value: 0.546416:  71%|███████   | 71/100 [04:48<01:49,  3.77s/it]Best trial: 44. Best value: 0.546416:  71%|███████   | 71/100 [04:51<01:49,  3.77s/it]Best trial: 44. Best value: 0.546416:  72%|███████▏  | 72/100 [04:51<01:40,  3.59s/it]Best trial: 44. Best value: 0.546416:  72%|███████▏  | 72/100 [04:55<01:40,  3.59s/it]Best trial: 44. Best value: 0.546416:  73%|███████▎  | 73/100 [04:55<01:38,  3.65s/it]Best trial: 44. Best value: 0.546416:  73%|███████▎  | 73/100 [04:59<01:38,  3.65s/it]Best trial: 44. Best value: 0.546416:  74%|███████▍  | 74/100 [04:59<01:37,  3.74s/it]Best trial: 44. Best value: 0.546416:  74%|███████▍  | 74/100 [05:02<01:37,  3.74s/it]Best trial: 44. Best value: 0.546416:  75%|███████▌  | 75/100 [05:02<01:32,  3.71s/it]Best trial: 44. Best value: 0.546416:  75%|███████▌  | 75/100 [05:07<01:32,  3.71s/it]Best trial: 44. Best value: 0.546416:  76%|███████▌  | 76/100 [05:07<01:35,  3.96s/it]Best trial: 44. Best value: 0.546416:  76%|███████▌  | 76/100 [05:11<01:35,  3.96s/it]Best trial: 44. Best value: 0.546416:  77%|███████▋  | 77/100 [05:11<01:30,  3.93s/it]Best trial: 44. Best value: 0.546416:  77%|███████▋  | 77/100 [05:14<01:30,  3.93s/it]Best trial: 44. Best value: 0.546416:  78%|███████▊  | 78/100 [05:14<01:22,  3.76s/it]Best trial: 44. Best value: 0.546416:  78%|███████▊  | 78/100 [05:19<01:22,  3.76s/it]Best trial: 44. Best value: 0.546416:  79%|███████▉  | 79/100 [05:19<01:23,  3.99s/it]Best trial: 44. Best value: 0.546416:  79%|███████▉  | 79/100 [05:23<01:23,  3.99s/it]Best trial: 44. Best value: 0.546416:  80%|████████  | 80/100 [05:23<01:21,  4.09s/it]Best trial: 44. Best value: 0.546416:  80%|████████  | 80/100 [05:26<01:21,  4.09s/it]Best trial: 44. Best value: 0.546416:  81%|████████  | 81/100 [05:26<01:10,  3.72s/it]Best trial: 44. Best value: 0.546416:  81%|████████  | 81/100 [05:29<01:10,  3.72s/it]Best trial: 44. Best value: 0.546416:  82%|████████▏ | 82/100 [05:29<01:05,  3.65s/it]Best trial: 44. Best value: 0.546416:  82%|████████▏ | 82/100 [05:33<01:05,  3.65s/it]Best trial: 44. Best value: 0.546416:  83%|████████▎ | 83/100 [05:33<00:59,  3.53s/it]Best trial: 44. Best value: 0.546416:  83%|████████▎ | 83/100 [05:36<00:59,  3.53s/it]Best trial: 44. Best value: 0.546416:  84%|████████▍ | 84/100 [05:36<00:55,  3.47s/it]Best trial: 44. Best value: 0.546416:  84%|████████▍ | 84/100 [05:40<00:55,  3.47s/it]Best trial: 44. Best value: 0.546416:  85%|████████▌ | 85/100 [05:40<00:52,  3.51s/it]Best trial: 44. Best value: 0.546416:  85%|████████▌ | 85/100 [05:43<00:52,  3.51s/it]Best trial: 44. Best value: 0.546416:  86%|████████▌ | 86/100 [05:43<00:48,  3.47s/it]Best trial: 44. Best value: 0.546416:  86%|████████▌ | 86/100 [05:47<00:48,  3.47s/it]Best trial: 44. Best value: 0.546416:  87%|████████▋ | 87/100 [05:47<00:47,  3.69s/it]Best trial: 44. Best value: 0.546416:  87%|████████▋ | 87/100 [05:50<00:47,  3.69s/it]Best trial: 44. Best value: 0.546416:  88%|████████▊ | 88/100 [05:50<00:42,  3.52s/it]Best trial: 44. Best value: 0.546416:  88%|████████▊ | 88/100 [05:55<00:42,  3.52s/it]Best trial: 44. Best value: 0.546416:  89%|████████▉ | 89/100 [05:55<00:42,  3.90s/it]Best trial: 44. Best value: 0.546416:  89%|████████▉ | 89/100 [05:58<00:42,  3.90s/it]Best trial: 44. Best value: 0.546416:  90%|█████████ | 90/100 [05:58<00:35,  3.58s/it]Best trial: 44. Best value: 0.546416:  90%|█████████ | 90/100 [06:02<00:35,  3.58s/it]Best trial: 44. Best value: 0.546416:  91%|█████████ | 91/100 [06:02<00:34,  3.79s/it]Best trial: 44. Best value: 0.546416:  91%|█████████ | 91/100 [06:07<00:34,  3.79s/it]Best trial: 44. Best value: 0.546416:  92%|█████████▏| 92/100 [06:07<00:32,  4.03s/it]Best trial: 44. Best value: 0.546416:  92%|█████████▏| 92/100 [06:11<00:32,  4.03s/it]Best trial: 44. Best value: 0.546416:  93%|█████████▎| 93/100 [06:11<00:29,  4.25s/it]Best trial: 44. Best value: 0.546416:  93%|█████████▎| 93/100 [06:16<00:29,  4.25s/it]Best trial: 44. Best value: 0.546416:  94%|█████████▍| 94/100 [06:16<00:26,  4.37s/it]Best trial: 44. Best value: 0.546416:  94%|█████████▍| 94/100 [06:20<00:26,  4.37s/it]Best trial: 44. Best value: 0.546416:  95%|█████████▌| 95/100 [06:20<00:21,  4.26s/it]Best trial: 44. Best value: 0.546416:  95%|█████████▌| 95/100 [06:23<00:21,  4.26s/it]Best trial: 44. Best value: 0.546416:  96%|█████████▌| 96/100 [06:23<00:15,  3.88s/it]Best trial: 44. Best value: 0.546416:  96%|█████████▌| 96/100 [06:27<00:15,  3.88s/it]Best trial: 44. Best value: 0.546416:  97%|█████████▋| 97/100 [06:27<00:11,  3.76s/it]Best trial: 44. Best value: 0.546416:  97%|█████████▋| 97/100 [06:31<00:11,  3.76s/it]Best trial: 44. Best value: 0.546416:  98%|█████████▊| 98/100 [06:31<00:07,  3.97s/it]Best trial: 44. Best value: 0.546416:  98%|█████████▊| 98/100 [06:35<00:07,  3.97s/it]Best trial: 44. Best value: 0.546416:  99%|█████████▉| 99/100 [06:35<00:03,  3.96s/it]Best trial: 44. Best value: 0.546416:  99%|█████████▉| 99/100 [06:40<00:03,  3.96s/it]Best trial: 44. Best value: 0.546416: 100%|██████████| 100/100 [06:40<00:00,  4.23s/it]Best trial: 44. Best value: 0.546416: 100%|██████████| 100/100 [06:40<00:00,  4.00s/it]
2025-11-30 10:14:38,228 - INFO - HPO Complete. Best AUPRC: 0.5464
2025-11-30 10:14:38,228 - INFO - Best Params: {'n_estimators': 100, 'learning_rate': 0.0002481829370427883, 'max_depth': 3, 'subsample': 0.6174723275033882, 'colsample_bytree': 0.6525460379450806, 'gamma': 3.6121307934425606, 'reg_lambda': 5.81442913925291e-06, 'reg_alpha': 0.010205361427011964}
2025-11-30 10:14:38,229 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:14:40,254 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 10:14:40,255 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:14:40,452 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:14:40,486 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:14:40,494 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:14:40,494 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:14:40,494 - INFO - Training model...
2025-11-30 10:14:41,120 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:14:46,691 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:14:46,692 - INFO - AUROC: 0.8073 (0.7272 - 0.8679)
2025-11-30 10:14:46,692 - INFO - AUPRC: 0.3999 (0.2956 - 0.5408)
2025-11-30 10:14:46,692 - INFO - Brier Score: 0.2455 (0.2452 - 0.2458)
2025-11-30 10:14:46,692 - INFO - Accuracy: 0.9118 (0.8939 - 0.9289)
2025-11-30 10:14:46,692 - INFO - Precision: 0.3077 (0.2044 - 0.3973)
2025-11-30 10:14:46,692 - INFO - Sensitivity (Recall): 0.5556 (0.3956 - 0.6774)
2025-11-30 10:14:46,692 - INFO - F1-Score: 0.3960 (0.2846 - 0.4612)
2025-11-30 10:14:46,692 - INFO - Best Threshold: 0.5000 (0.5000 - 0.5000)
2025-11-30 10:14:46,692 - INFO - Specificity: 0.9314 (0.9149 - 0.9496)
2025-11-30 10:14:46,697 - INFO - Calculating SHAP values...
2025-11-30 10:14:47,607 - INFO - SHAP plots saved.
2025-11-30 10:14:47,608 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:14:49,035 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 10:14:49,035 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:14:49,244 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:14:49,279 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:14:49,287 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:14:49,287 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.47192:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.47192:   1%|          | 1/100 [00:03<06:14,  3.78s/it]Best trial: 1. Best value: 0.516157:   1%|          | 1/100 [00:06<06:14,  3.78s/it]Best trial: 1. Best value: 0.516157:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]Best trial: 1. Best value: 0.516157:   2%|▏         | 2/100 [00:09<05:05,  3.12s/it]Best trial: 1. Best value: 0.516157:   3%|▎         | 3/100 [00:09<05:17,  3.28s/it]Best trial: 1. Best value: 0.516157:   3%|▎         | 3/100 [00:14<05:17,  3.28s/it]Best trial: 1. Best value: 0.516157:   4%|▍         | 4/100 [00:14<06:20,  3.97s/it]Best trial: 1. Best value: 0.516157:   4%|▍         | 4/100 [00:19<06:20,  3.97s/it]Best trial: 1. Best value: 0.516157:   5%|▌         | 5/100 [00:19<06:42,  4.23s/it]Best trial: 1. Best value: 0.516157:   5%|▌         | 5/100 [00:24<06:42,  4.23s/it]Best trial: 1. Best value: 0.516157:   6%|▌         | 6/100 [00:24<07:07,  4.54s/it]Best trial: 1. Best value: 0.516157:   6%|▌         | 6/100 [00:28<07:07,  4.54s/it]Best trial: 1. Best value: 0.516157:   7%|▋         | 7/100 [00:28<06:45,  4.36s/it]Best trial: 1. Best value: 0.516157:   7%|▋         | 7/100 [00:31<06:45,  4.36s/it]Best trial: 1. Best value: 0.516157:   8%|▊         | 8/100 [00:31<06:07,  4.00s/it]Best trial: 1. Best value: 0.516157:   8%|▊         | 8/100 [00:35<06:07,  4.00s/it]Best trial: 1. Best value: 0.516157:   9%|▉         | 9/100 [00:35<05:52,  3.88s/it]Best trial: 1. Best value: 0.516157:   9%|▉         | 9/100 [00:44<05:52,  3.88s/it]Best trial: 1. Best value: 0.516157:  10%|█         | 10/100 [00:44<07:59,  5.33s/it]Best trial: 1. Best value: 0.516157:  10%|█         | 10/100 [00:47<07:59,  5.33s/it]Best trial: 1. Best value: 0.516157:  11%|█         | 11/100 [00:47<07:10,  4.83s/it]Best trial: 1. Best value: 0.516157:  11%|█         | 11/100 [00:50<07:10,  4.83s/it]Best trial: 1. Best value: 0.516157:  12%|█▏        | 12/100 [00:50<06:06,  4.16s/it]Best trial: 1. Best value: 0.516157:  12%|█▏        | 12/100 [00:53<06:06,  4.16s/it]Best trial: 1. Best value: 0.516157:  13%|█▎        | 13/100 [00:53<05:22,  3.71s/it]Best trial: 1. Best value: 0.516157:  13%|█▎        | 13/100 [00:56<05:22,  3.71s/it]Best trial: 1. Best value: 0.516157:  14%|█▍        | 14/100 [00:56<05:09,  3.60s/it]Best trial: 1. Best value: 0.516157:  14%|█▍        | 14/100 [00:59<05:09,  3.60s/it]Best trial: 1. Best value: 0.516157:  15%|█▌        | 15/100 [00:59<04:59,  3.52s/it]Best trial: 1. Best value: 0.516157:  15%|█▌        | 15/100 [01:02<04:59,  3.52s/it]Best trial: 1. Best value: 0.516157:  16%|█▌        | 16/100 [01:02<04:41,  3.35s/it]Best trial: 1. Best value: 0.516157:  16%|█▌        | 16/100 [01:07<04:41,  3.35s/it]Best trial: 1. Best value: 0.516157:  17%|█▋        | 17/100 [01:07<05:00,  3.61s/it]Best trial: 1. Best value: 0.516157:  17%|█▋        | 17/100 [01:11<05:00,  3.61s/it]Best trial: 1. Best value: 0.516157:  18%|█▊        | 18/100 [01:11<05:13,  3.83s/it]Best trial: 1. Best value: 0.516157:  18%|█▊        | 18/100 [01:14<05:13,  3.83s/it]Best trial: 1. Best value: 0.516157:  19%|█▉        | 19/100 [01:14<05:02,  3.73s/it]Best trial: 1. Best value: 0.516157:  19%|█▉        | 19/100 [01:17<05:02,  3.73s/it]Best trial: 1. Best value: 0.516157:  20%|██        | 20/100 [01:17<04:29,  3.37s/it]Best trial: 1. Best value: 0.516157:  20%|██        | 20/100 [01:22<04:29,  3.37s/it]Best trial: 1. Best value: 0.516157:  21%|██        | 21/100 [01:22<05:01,  3.82s/it]Best trial: 1. Best value: 0.516157:  21%|██        | 21/100 [01:25<05:01,  3.82s/it]Best trial: 1. Best value: 0.516157:  22%|██▏       | 22/100 [01:25<04:36,  3.55s/it]Best trial: 1. Best value: 0.516157:  22%|██▏       | 22/100 [01:28<04:36,  3.55s/it]Best trial: 1. Best value: 0.516157:  23%|██▎       | 23/100 [01:28<04:30,  3.52s/it]Best trial: 1. Best value: 0.516157:  23%|██▎       | 23/100 [01:31<04:30,  3.52s/it]Best trial: 1. Best value: 0.516157:  24%|██▍       | 24/100 [01:31<04:09,  3.29s/it]Best trial: 1. Best value: 0.516157:  24%|██▍       | 24/100 [01:34<04:09,  3.29s/it]Best trial: 1. Best value: 0.516157:  25%|██▌       | 25/100 [01:34<04:06,  3.28s/it]Best trial: 1. Best value: 0.516157:  25%|██▌       | 25/100 [01:38<04:06,  3.28s/it]Best trial: 1. Best value: 0.516157:  26%|██▌       | 26/100 [01:38<04:05,  3.32s/it]Best trial: 1. Best value: 0.516157:  26%|██▌       | 26/100 [01:41<04:05,  3.32s/it]Best trial: 1. Best value: 0.516157:  27%|██▋       | 27/100 [01:41<03:56,  3.24s/it]Best trial: 1. Best value: 0.516157:  27%|██▋       | 27/100 [01:43<03:56,  3.24s/it]Best trial: 1. Best value: 0.516157:  28%|██▊       | 28/100 [01:43<03:43,  3.10s/it]Best trial: 1. Best value: 0.516157:  28%|██▊       | 28/100 [01:48<03:43,  3.10s/it]Best trial: 1. Best value: 0.516157:  29%|██▉       | 29/100 [01:48<04:03,  3.44s/it]Best trial: 1. Best value: 0.516157:  29%|██▉       | 29/100 [01:52<04:03,  3.44s/it]Best trial: 1. Best value: 0.516157:  30%|███       | 30/100 [01:52<04:28,  3.83s/it]Best trial: 1. Best value: 0.516157:  30%|███       | 30/100 [01:56<04:28,  3.83s/it]Best trial: 1. Best value: 0.516157:  31%|███       | 31/100 [01:56<04:17,  3.73s/it]Best trial: 1. Best value: 0.516157:  31%|███       | 31/100 [01:59<04:17,  3.73s/it]Best trial: 1. Best value: 0.516157:  32%|███▏      | 32/100 [01:59<03:57,  3.49s/it]Best trial: 1. Best value: 0.516157:  32%|███▏      | 32/100 [02:02<03:57,  3.49s/it]Best trial: 1. Best value: 0.516157:  33%|███▎      | 33/100 [02:02<03:45,  3.37s/it]Best trial: 1. Best value: 0.516157:  33%|███▎      | 33/100 [02:06<03:45,  3.37s/it]Best trial: 1. Best value: 0.516157:  34%|███▍      | 34/100 [02:06<03:51,  3.51s/it]Best trial: 1. Best value: 0.516157:  34%|███▍      | 34/100 [02:09<03:51,  3.51s/it]Best trial: 1. Best value: 0.516157:  35%|███▌      | 35/100 [02:09<03:35,  3.32s/it]Best trial: 1. Best value: 0.516157:  35%|███▌      | 35/100 [02:12<03:35,  3.32s/it]Best trial: 1. Best value: 0.516157:  36%|███▌      | 36/100 [02:12<03:39,  3.44s/it]Best trial: 1. Best value: 0.516157:  36%|███▌      | 36/100 [02:15<03:39,  3.44s/it]Best trial: 1. Best value: 0.516157:  37%|███▋      | 37/100 [02:15<03:30,  3.35s/it]Best trial: 1. Best value: 0.516157:  37%|███▋      | 37/100 [02:21<03:30,  3.35s/it]Best trial: 1. Best value: 0.516157:  38%|███▊      | 38/100 [02:21<04:14,  4.10s/it]Best trial: 1. Best value: 0.516157:  38%|███▊      | 38/100 [02:24<04:14,  4.10s/it]Best trial: 1. Best value: 0.516157:  39%|███▉      | 39/100 [02:24<03:50,  3.78s/it]Best trial: 1. Best value: 0.516157:  39%|███▉      | 39/100 [02:28<03:50,  3.78s/it]Best trial: 1. Best value: 0.516157:  40%|████      | 40/100 [02:28<03:52,  3.88s/it]Best trial: 1. Best value: 0.516157:  40%|████      | 40/100 [02:31<03:52,  3.88s/it]Best trial: 1. Best value: 0.516157:  41%|████      | 41/100 [02:31<03:33,  3.62s/it]Best trial: 1. Best value: 0.516157:  41%|████      | 41/100 [02:35<03:33,  3.62s/it]Best trial: 1. Best value: 0.516157:  42%|████▏     | 42/100 [02:35<03:29,  3.61s/it]Best trial: 1. Best value: 0.516157:  42%|████▏     | 42/100 [02:39<03:29,  3.61s/it]Best trial: 1. Best value: 0.516157:  43%|████▎     | 43/100 [02:39<03:26,  3.63s/it]Best trial: 1. Best value: 0.516157:  43%|████▎     | 43/100 [02:43<03:26,  3.63s/it]Best trial: 1. Best value: 0.516157:  44%|████▍     | 44/100 [02:43<03:28,  3.72s/it]Best trial: 1. Best value: 0.516157:  44%|████▍     | 44/100 [02:46<03:28,  3.72s/it]Best trial: 1. Best value: 0.516157:  45%|████▌     | 45/100 [02:46<03:22,  3.68s/it]Best trial: 1. Best value: 0.516157:  45%|████▌     | 45/100 [02:52<03:22,  3.68s/it]Best trial: 1. Best value: 0.516157:  46%|████▌     | 46/100 [02:52<03:47,  4.21s/it]Best trial: 1. Best value: 0.516157:  46%|████▌     | 46/100 [02:55<03:47,  4.21s/it]Best trial: 1. Best value: 0.516157:  47%|████▋     | 47/100 [02:55<03:29,  3.95s/it]Best trial: 1. Best value: 0.516157:  47%|████▋     | 47/100 [02:59<03:29,  3.95s/it]Best trial: 1. Best value: 0.516157:  48%|████▊     | 48/100 [02:59<03:22,  3.89s/it]Best trial: 1. Best value: 0.516157:  48%|████▊     | 48/100 [03:02<03:22,  3.89s/it]Best trial: 1. Best value: 0.516157:  49%|████▉     | 49/100 [03:02<03:04,  3.63s/it]Best trial: 1. Best value: 0.516157:  49%|████▉     | 49/100 [03:04<03:04,  3.63s/it]Best trial: 1. Best value: 0.516157:  50%|█████     | 50/100 [03:04<02:45,  3.31s/it]Best trial: 1. Best value: 0.516157:  50%|█████     | 50/100 [03:08<02:45,  3.31s/it]Best trial: 1. Best value: 0.516157:  51%|█████     | 51/100 [03:08<02:42,  3.31s/it]Best trial: 1. Best value: 0.516157:  51%|█████     | 51/100 [03:11<02:42,  3.31s/it]Best trial: 1. Best value: 0.516157:  52%|█████▏    | 52/100 [03:11<02:38,  3.30s/it]Best trial: 1. Best value: 0.516157:  52%|█████▏    | 52/100 [03:15<02:38,  3.30s/it]Best trial: 1. Best value: 0.516157:  53%|█████▎    | 53/100 [03:15<02:43,  3.48s/it]Best trial: 1. Best value: 0.516157:  53%|█████▎    | 53/100 [03:18<02:43,  3.48s/it]Best trial: 1. Best value: 0.516157:  54%|█████▍    | 54/100 [03:18<02:32,  3.32s/it]Best trial: 1. Best value: 0.516157:  54%|█████▍    | 54/100 [03:22<02:32,  3.32s/it]Best trial: 1. Best value: 0.516157:  55%|█████▌    | 55/100 [03:22<02:46,  3.70s/it]Best trial: 1. Best value: 0.516157:  55%|█████▌    | 55/100 [03:26<02:46,  3.70s/it]Best trial: 1. Best value: 0.516157:  56%|█████▌    | 56/100 [03:26<02:39,  3.61s/it]Best trial: 56. Best value: 0.519013:  56%|█████▌    | 56/100 [03:30<02:39,  3.61s/it]Best trial: 56. Best value: 0.519013:  57%|█████▋    | 57/100 [03:30<02:45,  3.84s/it]Best trial: 56. Best value: 0.519013:  57%|█████▋    | 57/100 [03:34<02:45,  3.84s/it]Best trial: 56. Best value: 0.519013:  58%|█████▊    | 58/100 [03:34<02:38,  3.78s/it]Best trial: 56. Best value: 0.519013:  58%|█████▊    | 58/100 [03:39<02:38,  3.78s/it]Best trial: 56. Best value: 0.519013:  59%|█████▉    | 59/100 [03:39<02:50,  4.15s/it]Best trial: 56. Best value: 0.519013:  59%|█████▉    | 59/100 [03:42<02:50,  4.15s/it]Best trial: 56. Best value: 0.519013:  60%|██████    | 60/100 [03:42<02:33,  3.83s/it]Best trial: 56. Best value: 0.519013:  60%|██████    | 60/100 [03:48<02:33,  3.83s/it]Best trial: 56. Best value: 0.519013:  61%|██████    | 61/100 [03:48<02:59,  4.61s/it]Best trial: 56. Best value: 0.519013:  61%|██████    | 61/100 [03:52<02:59,  4.61s/it]Best trial: 56. Best value: 0.519013:  62%|██████▏   | 62/100 [03:52<02:45,  4.35s/it]Best trial: 56. Best value: 0.519013:  62%|██████▏   | 62/100 [03:56<02:45,  4.35s/it]Best trial: 56. Best value: 0.519013:  63%|██████▎   | 63/100 [03:56<02:33,  4.15s/it]Best trial: 56. Best value: 0.519013:  63%|██████▎   | 63/100 [03:59<02:33,  4.15s/it]Best trial: 56. Best value: 0.519013:  64%|██████▍   | 64/100 [03:59<02:22,  3.96s/it]Best trial: 56. Best value: 0.519013:  64%|██████▍   | 64/100 [04:03<02:22,  3.96s/it]Best trial: 56. Best value: 0.519013:  65%|██████▌   | 65/100 [04:03<02:11,  3.77s/it]Best trial: 56. Best value: 0.519013:  65%|██████▌   | 65/100 [04:05<02:11,  3.77s/it]Best trial: 56. Best value: 0.519013:  66%|██████▌   | 66/100 [04:05<01:57,  3.46s/it]Best trial: 56. Best value: 0.519013:  66%|██████▌   | 66/100 [04:09<01:57,  3.46s/it]Best trial: 56. Best value: 0.519013:  67%|██████▋   | 67/100 [04:09<01:51,  3.38s/it]Best trial: 56. Best value: 0.519013:  67%|██████▋   | 67/100 [04:11<01:51,  3.38s/it]Best trial: 56. Best value: 0.519013:  68%|██████▊   | 68/100 [04:11<01:40,  3.14s/it]Best trial: 56. Best value: 0.519013:  68%|██████▊   | 68/100 [04:14<01:40,  3.14s/it]Best trial: 56. Best value: 0.519013:  69%|██████▉   | 69/100 [04:14<01:36,  3.10s/it]Best trial: 56. Best value: 0.519013:  69%|██████▉   | 69/100 [04:18<01:36,  3.10s/it]Best trial: 56. Best value: 0.519013:  70%|███████   | 70/100 [04:18<01:35,  3.19s/it]Best trial: 56. Best value: 0.519013:  70%|███████   | 70/100 [04:21<01:35,  3.19s/it]Best trial: 56. Best value: 0.519013:  71%|███████   | 71/100 [04:21<01:38,  3.39s/it]Best trial: 56. Best value: 0.519013:  71%|███████   | 71/100 [04:24<01:38,  3.39s/it]Best trial: 56. Best value: 0.519013:  72%|███████▏  | 72/100 [04:24<01:25,  3.07s/it]Best trial: 56. Best value: 0.519013:  72%|███████▏  | 72/100 [04:26<01:25,  3.07s/it]Best trial: 56. Best value: 0.519013:  73%|███████▎  | 73/100 [04:26<01:16,  2.84s/it]Best trial: 56. Best value: 0.519013:  73%|███████▎  | 73/100 [04:29<01:16,  2.84s/it]Best trial: 56. Best value: 0.519013:  74%|███████▍  | 74/100 [04:29<01:12,  2.80s/it]Best trial: 56. Best value: 0.519013:  74%|███████▍  | 74/100 [04:31<01:12,  2.80s/it]Best trial: 56. Best value: 0.519013:  75%|███████▌  | 75/100 [04:31<01:08,  2.72s/it]Best trial: 56. Best value: 0.519013:  75%|███████▌  | 75/100 [04:34<01:08,  2.72s/it]Best trial: 56. Best value: 0.519013:  76%|███████▌  | 76/100 [04:34<01:06,  2.76s/it]Best trial: 56. Best value: 0.519013:  76%|███████▌  | 76/100 [04:38<01:06,  2.76s/it]Best trial: 56. Best value: 0.519013:  77%|███████▋  | 77/100 [04:38<01:11,  3.09s/it]Best trial: 56. Best value: 0.519013:  77%|███████▋  | 77/100 [04:42<01:11,  3.09s/it]Best trial: 56. Best value: 0.519013:  78%|███████▊  | 78/100 [04:42<01:13,  3.32s/it]Best trial: 56. Best value: 0.519013:  78%|███████▊  | 78/100 [04:44<01:13,  3.32s/it]Best trial: 56. Best value: 0.519013:  79%|███████▉  | 79/100 [04:44<01:04,  3.08s/it]Best trial: 56. Best value: 0.519013:  79%|███████▉  | 79/100 [04:48<01:04,  3.08s/it]Best trial: 56. Best value: 0.519013:  80%|████████  | 80/100 [04:48<01:04,  3.21s/it]Best trial: 80. Best value: 0.52625:  80%|████████  | 80/100 [04:51<01:04,  3.21s/it] Best trial: 80. Best value: 0.52625:  81%|████████  | 81/100 [04:51<00:58,  3.05s/it]Best trial: 81. Best value: 0.534963:  81%|████████  | 81/100 [04:54<00:58,  3.05s/it]Best trial: 81. Best value: 0.534963:  82%|████████▏ | 82/100 [04:54<00:58,  3.24s/it]Best trial: 81. Best value: 0.534963:  82%|████████▏ | 82/100 [04:57<00:58,  3.24s/it]Best trial: 81. Best value: 0.534963:  83%|████████▎ | 83/100 [04:57<00:53,  3.15s/it]Best trial: 81. Best value: 0.534963:  83%|████████▎ | 83/100 [05:02<00:53,  3.15s/it]Best trial: 81. Best value: 0.534963:  84%|████████▍ | 84/100 [05:02<00:58,  3.64s/it]Best trial: 81. Best value: 0.534963:  84%|████████▍ | 84/100 [05:06<00:58,  3.64s/it]Best trial: 81. Best value: 0.534963:  85%|████████▌ | 85/100 [05:06<00:54,  3.63s/it]Best trial: 81. Best value: 0.534963:  85%|████████▌ | 85/100 [05:09<00:54,  3.63s/it]Best trial: 81. Best value: 0.534963:  86%|████████▌ | 86/100 [05:09<00:49,  3.54s/it]Best trial: 81. Best value: 0.534963:  86%|████████▌ | 86/100 [05:13<00:49,  3.54s/it]Best trial: 81. Best value: 0.534963:  87%|████████▋ | 87/100 [05:13<00:48,  3.73s/it]Best trial: 81. Best value: 0.534963:  87%|████████▋ | 87/100 [05:16<00:48,  3.73s/it]Best trial: 81. Best value: 0.534963:  88%|████████▊ | 88/100 [05:16<00:41,  3.42s/it]Best trial: 81. Best value: 0.534963:  88%|████████▊ | 88/100 [05:20<00:41,  3.42s/it]Best trial: 81. Best value: 0.534963:  89%|████████▉ | 89/100 [05:20<00:38,  3.54s/it]Best trial: 81. Best value: 0.534963:  89%|████████▉ | 89/100 [05:22<00:38,  3.54s/it]Best trial: 81. Best value: 0.534963:  90%|█████████ | 90/100 [05:22<00:32,  3.24s/it]Best trial: 81. Best value: 0.534963:  90%|█████████ | 90/100 [05:26<00:32,  3.24s/it]Best trial: 81. Best value: 0.534963:  91%|█████████ | 91/100 [05:26<00:30,  3.34s/it]Best trial: 81. Best value: 0.534963:  91%|█████████ | 91/100 [05:28<00:30,  3.34s/it]Best trial: 81. Best value: 0.534963:  92%|█████████▏| 92/100 [05:28<00:25,  3.13s/it]Best trial: 81. Best value: 0.534963:  92%|█████████▏| 92/100 [05:31<00:25,  3.13s/it]Best trial: 81. Best value: 0.534963:  93%|█████████▎| 93/100 [05:31<00:21,  3.09s/it]Best trial: 81. Best value: 0.534963:  93%|█████████▎| 93/100 [05:33<00:21,  3.09s/it]Best trial: 81. Best value: 0.534963:  94%|█████████▍| 94/100 [05:33<00:16,  2.70s/it]Best trial: 81. Best value: 0.534963:  94%|█████████▍| 94/100 [05:36<00:16,  2.70s/it]Best trial: 81. Best value: 0.534963:  95%|█████████▌| 95/100 [05:36<00:13,  2.79s/it]Best trial: 81. Best value: 0.534963:  95%|█████████▌| 95/100 [05:39<00:13,  2.79s/it]Best trial: 81. Best value: 0.534963:  96%|█████████▌| 96/100 [05:39<00:11,  2.82s/it]Best trial: 81. Best value: 0.534963:  96%|█████████▌| 96/100 [05:41<00:11,  2.82s/it]Best trial: 81. Best value: 0.534963:  97%|█████████▋| 97/100 [05:41<00:07,  2.58s/it]Best trial: 81. Best value: 0.534963:  97%|█████████▋| 97/100 [05:44<00:07,  2.58s/it]Best trial: 81. Best value: 0.534963:  98%|█████████▊| 98/100 [05:44<00:05,  2.77s/it]Best trial: 81. Best value: 0.534963:  98%|█████████▊| 98/100 [05:49<00:05,  2.77s/it]Best trial: 81. Best value: 0.534963:  99%|█████████▉| 99/100 [05:49<00:03,  3.41s/it]Best trial: 81. Best value: 0.534963:  99%|█████████▉| 99/100 [05:52<00:03,  3.41s/it]Best trial: 81. Best value: 0.534963: 100%|██████████| 100/100 [05:52<00:00,  3.37s/it]Best trial: 81. Best value: 0.534963: 100%|██████████| 100/100 [05:52<00:00,  3.53s/it]
2025-11-30 10:20:42,202 - INFO - HPO Complete. Best AUPRC: 0.5350
2025-11-30 10:20:42,203 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.06366760833217935, 'max_depth': 3, 'subsample': 0.7540361781138761, 'colsample_bytree': 0.6764963304588085, 'gamma': 2.105676203908999, 'reg_lambda': 0.5974880679407161, 'reg_alpha': 0.003624581820697554}
2025-11-30 10:20:42,203 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:20:44,139 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 10:20:44,139 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:20:44,340 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:20:44,375 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:20:44,383 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:20:44,383 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:20:44,383 - INFO - Training model...
2025-11-30 10:20:46,505 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:20:52,068 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:20:52,069 - INFO - AUROC: 0.7999 (0.7153 - 0.8557)
2025-11-30 10:20:52,069 - INFO - AUPRC: 0.4385 (0.2989 - 0.5531)
2025-11-30 10:20:52,069 - INFO - Brier Score: 0.0396 (0.0293 - 0.0522)
2025-11-30 10:20:52,069 - INFO - Accuracy: 0.9509 (0.9390 - 0.9728)
2025-11-30 10:20:52,069 - INFO - Precision: 0.5312 (0.4450 - 0.9667)
2025-11-30 10:20:52,069 - INFO - Sensitivity (Recall): 0.4722 (0.2650 - 0.5874)
2025-11-30 10:20:52,069 - INFO - F1-Score: 0.5000 (0.3797 - 0.6205)
2025-11-30 10:20:52,069 - INFO - Best Threshold: 0.2900 (0.2820 - 0.7960)
2025-11-30 10:20:52,069 - INFO - Specificity: 0.9771 (0.9709 - 0.9991)
2025-11-30 10:20:52,079 - INFO - Calculating SHAP values...
2025-11-30 10:20:53,080 - INFO - SHAP plots saved.
2025-11-30 10:20:53,081 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:20:54,262 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 10:20:54,262 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:20:54,457 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:20:54,492 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:20:54,500 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:20:54,500 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.475912:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.475912:   1%|          | 1/100 [00:03<05:33,  3.37s/it]Best trial: 0. Best value: 0.475912:   1%|          | 1/100 [00:09<05:33,  3.37s/it]Best trial: 0. Best value: 0.475912:   2%|▏         | 2/100 [00:09<07:43,  4.72s/it]Best trial: 0. Best value: 0.475912:   2%|▏         | 2/100 [00:14<07:43,  4.72s/it]Best trial: 0. Best value: 0.475912:   3%|▎         | 3/100 [00:14<07:54,  4.90s/it]Best trial: 0. Best value: 0.475912:   3%|▎         | 3/100 [00:17<07:54,  4.90s/it]Best trial: 0. Best value: 0.475912:   4%|▍         | 4/100 [00:17<06:38,  4.15s/it]Best trial: 0. Best value: 0.475912:   4%|▍         | 4/100 [00:21<06:38,  4.15s/it]Best trial: 0. Best value: 0.475912:   5%|▌         | 5/100 [00:21<06:32,  4.13s/it]Best trial: 0. Best value: 0.475912:   5%|▌         | 5/100 [00:24<06:32,  4.13s/it]Best trial: 0. Best value: 0.475912:   6%|▌         | 6/100 [00:24<06:04,  3.88s/it]Best trial: 0. Best value: 0.475912:   6%|▌         | 6/100 [00:31<06:04,  3.88s/it]Best trial: 0. Best value: 0.475912:   7%|▋         | 7/100 [00:31<07:26,  4.81s/it]Best trial: 0. Best value: 0.475912:   7%|▋         | 7/100 [00:35<07:26,  4.81s/it]Best trial: 0. Best value: 0.475912:   8%|▊         | 8/100 [00:35<06:57,  4.54s/it]Best trial: 8. Best value: 0.485112:   8%|▊         | 8/100 [00:39<06:57,  4.54s/it]Best trial: 8. Best value: 0.485112:   9%|▉         | 9/100 [00:39<06:35,  4.35s/it]Best trial: 8. Best value: 0.485112:   9%|▉         | 9/100 [00:45<06:35,  4.35s/it]Best trial: 8. Best value: 0.485112:  10%|█         | 10/100 [00:45<07:23,  4.93s/it]Best trial: 10. Best value: 0.49842:  10%|█         | 10/100 [00:48<07:23,  4.93s/it]Best trial: 10. Best value: 0.49842:  11%|█         | 11/100 [00:48<06:32,  4.41s/it]Best trial: 10. Best value: 0.49842:  11%|█         | 11/100 [00:51<06:32,  4.41s/it]Best trial: 10. Best value: 0.49842:  12%|█▏        | 12/100 [00:51<05:53,  4.02s/it]Best trial: 12. Best value: 0.507311:  12%|█▏        | 12/100 [00:56<05:53,  4.02s/it]Best trial: 12. Best value: 0.507311:  13%|█▎        | 13/100 [00:56<05:55,  4.09s/it]Best trial: 13. Best value: 0.509194:  13%|█▎        | 13/100 [00:58<05:55,  4.09s/it]Best trial: 13. Best value: 0.509194:  14%|█▍        | 14/100 [00:58<05:21,  3.73s/it]Best trial: 13. Best value: 0.509194:  14%|█▍        | 14/100 [01:02<05:21,  3.73s/it]Best trial: 13. Best value: 0.509194:  15%|█▌        | 15/100 [01:02<05:00,  3.54s/it]Best trial: 13. Best value: 0.509194:  15%|█▌        | 15/100 [01:07<05:00,  3.54s/it]Best trial: 13. Best value: 0.509194:  16%|█▌        | 16/100 [01:07<05:37,  4.02s/it]Best trial: 13. Best value: 0.509194:  16%|█▌        | 16/100 [01:17<05:37,  4.02s/it]Best trial: 13. Best value: 0.509194:  17%|█▋        | 17/100 [01:17<08:12,  5.94s/it]Best trial: 13. Best value: 0.509194:  17%|█▋        | 17/100 [01:22<08:12,  5.94s/it]Best trial: 13. Best value: 0.509194:  18%|█▊        | 18/100 [01:22<07:43,  5.66s/it]Best trial: 13. Best value: 0.509194:  18%|█▊        | 18/100 [01:26<07:43,  5.66s/it]Best trial: 13. Best value: 0.509194:  19%|█▉        | 19/100 [01:26<06:45,  5.01s/it]Best trial: 13. Best value: 0.509194:  19%|█▉        | 19/100 [01:29<06:45,  5.01s/it]Best trial: 13. Best value: 0.509194:  20%|██        | 20/100 [01:29<05:55,  4.44s/it]Best trial: 13. Best value: 0.509194:  20%|██        | 20/100 [01:33<05:55,  4.44s/it]Best trial: 13. Best value: 0.509194:  21%|██        | 21/100 [01:33<05:55,  4.50s/it]Best trial: 13. Best value: 0.509194:  21%|██        | 21/100 [01:38<05:55,  4.50s/it]Best trial: 13. Best value: 0.509194:  22%|██▏       | 22/100 [01:38<05:54,  4.55s/it]Best trial: 13. Best value: 0.509194:  22%|██▏       | 22/100 [01:42<05:54,  4.55s/it]Best trial: 13. Best value: 0.509194:  23%|██▎       | 23/100 [01:42<05:46,  4.50s/it]Best trial: 13. Best value: 0.509194:  23%|██▎       | 23/100 [01:46<05:46,  4.50s/it]Best trial: 13. Best value: 0.509194:  24%|██▍       | 24/100 [01:46<05:25,  4.28s/it]Best trial: 13. Best value: 0.509194:  24%|██▍       | 24/100 [01:50<05:25,  4.28s/it]Best trial: 13. Best value: 0.509194:  25%|██▌       | 25/100 [01:50<05:10,  4.14s/it]Best trial: 13. Best value: 0.509194:  25%|██▌       | 25/100 [01:54<05:10,  4.14s/it]Best trial: 13. Best value: 0.509194:  26%|██▌       | 26/100 [01:54<04:52,  3.96s/it]Best trial: 13. Best value: 0.509194:  26%|██▌       | 26/100 [01:58<04:52,  3.96s/it]Best trial: 13. Best value: 0.509194:  27%|██▋       | 27/100 [01:58<05:02,  4.15s/it]Best trial: 13. Best value: 0.509194:  27%|██▋       | 27/100 [02:02<05:02,  4.15s/it]Best trial: 13. Best value: 0.509194:  28%|██▊       | 28/100 [02:02<04:53,  4.08s/it]Best trial: 13. Best value: 0.509194:  28%|██▊       | 28/100 [02:07<04:53,  4.08s/it]Best trial: 13. Best value: 0.509194:  29%|██▉       | 29/100 [02:07<05:08,  4.34s/it]Best trial: 13. Best value: 0.509194:  29%|██▉       | 29/100 [02:10<05:08,  4.34s/it]Best trial: 13. Best value: 0.509194:  30%|███       | 30/100 [02:10<04:40,  4.01s/it]Best trial: 13. Best value: 0.509194:  30%|███       | 30/100 [02:13<04:40,  4.01s/it]Best trial: 13. Best value: 0.509194:  31%|███       | 31/100 [02:13<04:13,  3.68s/it]Best trial: 13. Best value: 0.509194:  31%|███       | 31/100 [02:16<04:13,  3.68s/it]Best trial: 13. Best value: 0.509194:  32%|███▏      | 32/100 [02:16<03:56,  3.48s/it]Best trial: 32. Best value: 0.511954:  32%|███▏      | 32/100 [02:20<03:56,  3.48s/it]Best trial: 32. Best value: 0.511954:  33%|███▎      | 33/100 [02:20<04:03,  3.63s/it]Best trial: 32. Best value: 0.511954:  33%|███▎      | 33/100 [02:24<04:03,  3.63s/it]Best trial: 32. Best value: 0.511954:  34%|███▍      | 34/100 [02:24<04:07,  3.75s/it]Best trial: 32. Best value: 0.511954:  34%|███▍      | 34/100 [02:27<04:07,  3.75s/it]Best trial: 32. Best value: 0.511954:  35%|███▌      | 35/100 [02:27<03:53,  3.60s/it]Best trial: 32. Best value: 0.511954:  35%|███▌      | 35/100 [02:30<03:53,  3.60s/it]Best trial: 32. Best value: 0.511954:  36%|███▌      | 36/100 [02:30<03:37,  3.39s/it]Best trial: 32. Best value: 0.511954:  36%|███▌      | 36/100 [02:34<03:37,  3.39s/it]Best trial: 32. Best value: 0.511954:  37%|███▋      | 37/100 [02:34<03:41,  3.51s/it]Best trial: 32. Best value: 0.511954:  37%|███▋      | 37/100 [02:37<03:41,  3.51s/it]Best trial: 32. Best value: 0.511954:  38%|███▊      | 38/100 [02:37<03:34,  3.47s/it]Best trial: 32. Best value: 0.511954:  38%|███▊      | 38/100 [02:41<03:34,  3.47s/it]Best trial: 32. Best value: 0.511954:  39%|███▉      | 39/100 [02:41<03:41,  3.63s/it]Best trial: 32. Best value: 0.511954:  39%|███▉      | 39/100 [02:47<03:41,  3.63s/it]Best trial: 32. Best value: 0.511954:  40%|████      | 40/100 [02:47<04:08,  4.15s/it]Best trial: 32. Best value: 0.511954:  40%|████      | 40/100 [02:52<04:08,  4.15s/it]Best trial: 32. Best value: 0.511954:  41%|████      | 41/100 [02:52<04:17,  4.36s/it]Best trial: 32. Best value: 0.511954:  41%|████      | 41/100 [02:55<04:17,  4.36s/it]Best trial: 32. Best value: 0.511954:  42%|████▏     | 42/100 [02:55<03:52,  4.01s/it]Best trial: 42. Best value: 0.515811:  42%|████▏     | 42/100 [02:59<03:52,  4.01s/it]Best trial: 42. Best value: 0.515811:  43%|████▎     | 43/100 [02:59<03:55,  4.13s/it]Best trial: 42. Best value: 0.515811:  43%|████▎     | 43/100 [03:02<03:55,  4.13s/it]Best trial: 42. Best value: 0.515811:  44%|████▍     | 44/100 [03:02<03:28,  3.72s/it]Best trial: 42. Best value: 0.515811:  44%|████▍     | 44/100 [03:05<03:28,  3.72s/it]Best trial: 42. Best value: 0.515811:  45%|████▌     | 45/100 [03:05<03:13,  3.51s/it]Best trial: 42. Best value: 0.515811:  45%|████▌     | 45/100 [03:08<03:13,  3.51s/it]Best trial: 42. Best value: 0.515811:  46%|████▌     | 46/100 [03:08<03:05,  3.43s/it]Best trial: 42. Best value: 0.515811:  46%|████▌     | 46/100 [03:13<03:05,  3.43s/it]Best trial: 42. Best value: 0.515811:  47%|████▋     | 47/100 [03:13<03:25,  3.88s/it]Best trial: 42. Best value: 0.515811:  47%|████▋     | 47/100 [03:16<03:25,  3.88s/it]Best trial: 42. Best value: 0.515811:  48%|████▊     | 48/100 [03:16<03:08,  3.62s/it]Best trial: 42. Best value: 0.515811:  48%|████▊     | 48/100 [03:21<03:08,  3.62s/it]Best trial: 42. Best value: 0.515811:  49%|████▉     | 49/100 [03:21<03:21,  3.95s/it]Best trial: 42. Best value: 0.515811:  49%|████▉     | 49/100 [03:24<03:21,  3.95s/it]Best trial: 42. Best value: 0.515811:  50%|█████     | 50/100 [03:24<03:02,  3.66s/it]Best trial: 42. Best value: 0.515811:  50%|█████     | 50/100 [03:29<03:02,  3.66s/it]Best trial: 42. Best value: 0.515811:  51%|█████     | 51/100 [03:29<03:21,  4.12s/it]Best trial: 42. Best value: 0.515811:  51%|█████     | 51/100 [03:32<03:21,  4.12s/it]Best trial: 42. Best value: 0.515811:  52%|█████▏    | 52/100 [03:32<03:06,  3.88s/it]Best trial: 42. Best value: 0.515811:  52%|█████▏    | 52/100 [03:36<03:06,  3.88s/it]Best trial: 42. Best value: 0.515811:  53%|█████▎    | 53/100 [03:36<02:54,  3.72s/it]Best trial: 42. Best value: 0.515811:  53%|█████▎    | 53/100 [03:39<02:54,  3.72s/it]Best trial: 42. Best value: 0.515811:  54%|█████▍    | 54/100 [03:39<02:44,  3.57s/it]Best trial: 42. Best value: 0.515811:  54%|█████▍    | 54/100 [03:42<02:44,  3.57s/it]Best trial: 42. Best value: 0.515811:  55%|█████▌    | 55/100 [03:42<02:38,  3.52s/it]Best trial: 42. Best value: 0.515811:  55%|█████▌    | 55/100 [03:46<02:38,  3.52s/it]Best trial: 42. Best value: 0.515811:  56%|█████▌    | 56/100 [03:46<02:40,  3.65s/it]Best trial: 42. Best value: 0.515811:  56%|█████▌    | 56/100 [03:50<02:40,  3.65s/it]Best trial: 42. Best value: 0.515811:  57%|█████▋    | 57/100 [03:50<02:36,  3.63s/it]Best trial: 42. Best value: 0.515811:  57%|█████▋    | 57/100 [03:54<02:36,  3.63s/it]Best trial: 42. Best value: 0.515811:  58%|█████▊    | 58/100 [03:54<02:32,  3.63s/it]Best trial: 42. Best value: 0.515811:  58%|█████▊    | 58/100 [03:57<02:32,  3.63s/it]Best trial: 42. Best value: 0.515811:  59%|█████▉    | 59/100 [03:57<02:29,  3.65s/it]Best trial: 42. Best value: 0.515811:  59%|█████▉    | 59/100 [04:00<02:29,  3.65s/it]Best trial: 42. Best value: 0.515811:  60%|██████    | 60/100 [04:00<02:14,  3.36s/it]Best trial: 42. Best value: 0.515811:  60%|██████    | 60/100 [04:03<02:14,  3.36s/it]Best trial: 42. Best value: 0.515811:  61%|██████    | 61/100 [04:03<02:03,  3.17s/it]Best trial: 42. Best value: 0.515811:  61%|██████    | 61/100 [04:06<02:03,  3.17s/it]Best trial: 42. Best value: 0.515811:  62%|██████▏   | 62/100 [04:06<02:03,  3.25s/it]Best trial: 42. Best value: 0.515811:  62%|██████▏   | 62/100 [04:09<02:03,  3.25s/it]Best trial: 42. Best value: 0.515811:  63%|██████▎   | 63/100 [04:09<01:58,  3.21s/it]Best trial: 42. Best value: 0.515811:  63%|██████▎   | 63/100 [04:12<01:58,  3.21s/it]Best trial: 42. Best value: 0.515811:  64%|██████▍   | 64/100 [04:12<01:50,  3.06s/it]Best trial: 42. Best value: 0.515811:  64%|██████▍   | 64/100 [04:16<01:50,  3.06s/it]Best trial: 42. Best value: 0.515811:  65%|██████▌   | 65/100 [04:16<02:00,  3.45s/it]Best trial: 42. Best value: 0.515811:  65%|██████▌   | 65/100 [04:19<02:00,  3.45s/it]Best trial: 42. Best value: 0.515811:  66%|██████▌   | 66/100 [04:19<01:53,  3.33s/it]Best trial: 42. Best value: 0.515811:  66%|██████▌   | 66/100 [04:22<01:53,  3.33s/it]Best trial: 42. Best value: 0.515811:  67%|██████▋   | 67/100 [04:22<01:44,  3.17s/it]Best trial: 42. Best value: 0.515811:  67%|██████▋   | 67/100 [04:25<01:44,  3.17s/it]Best trial: 42. Best value: 0.515811:  68%|██████▊   | 68/100 [04:25<01:42,  3.19s/it]Best trial: 42. Best value: 0.515811:  68%|██████▊   | 68/100 [04:29<01:42,  3.19s/it]Best trial: 42. Best value: 0.515811:  69%|██████▉   | 69/100 [04:29<01:40,  3.23s/it]Best trial: 42. Best value: 0.515811:  69%|██████▉   | 69/100 [04:32<01:40,  3.23s/it]Best trial: 42. Best value: 0.515811:  70%|███████   | 70/100 [04:32<01:37,  3.25s/it]Best trial: 42. Best value: 0.515811:  70%|███████   | 70/100 [04:35<01:37,  3.25s/it]Best trial: 42. Best value: 0.515811:  71%|███████   | 71/100 [04:35<01:33,  3.22s/it]Best trial: 42. Best value: 0.515811:  71%|███████   | 71/100 [04:38<01:33,  3.22s/it]Best trial: 42. Best value: 0.515811:  72%|███████▏  | 72/100 [04:38<01:27,  3.11s/it]Best trial: 42. Best value: 0.515811:  72%|███████▏  | 72/100 [04:42<01:27,  3.11s/it]Best trial: 42. Best value: 0.515811:  73%|███████▎  | 73/100 [04:42<01:29,  3.32s/it]Best trial: 42. Best value: 0.515811:  73%|███████▎  | 73/100 [04:45<01:29,  3.32s/it]Best trial: 42. Best value: 0.515811:  74%|███████▍  | 74/100 [04:45<01:28,  3.41s/it]Best trial: 42. Best value: 0.515811:  74%|███████▍  | 74/100 [04:51<01:28,  3.41s/it]Best trial: 42. Best value: 0.515811:  75%|███████▌  | 75/100 [04:51<01:39,  3.99s/it]Best trial: 42. Best value: 0.515811:  75%|███████▌  | 75/100 [04:56<01:39,  3.99s/it]Best trial: 42. Best value: 0.515811:  76%|███████▌  | 76/100 [04:56<01:45,  4.39s/it]Best trial: 42. Best value: 0.515811:  76%|███████▌  | 76/100 [05:01<01:45,  4.39s/it]Best trial: 42. Best value: 0.515811:  77%|███████▋  | 77/100 [05:01<01:45,  4.59s/it]Best trial: 42. Best value: 0.515811:  77%|███████▋  | 77/100 [05:06<01:45,  4.59s/it]Best trial: 42. Best value: 0.515811:  78%|███████▊  | 78/100 [05:06<01:40,  4.57s/it]Best trial: 42. Best value: 0.515811:  78%|███████▊  | 78/100 [05:10<01:40,  4.57s/it]Best trial: 42. Best value: 0.515811:  79%|███████▉  | 79/100 [05:10<01:33,  4.44s/it]Best trial: 42. Best value: 0.515811:  79%|███████▉  | 79/100 [05:13<01:33,  4.44s/it]Best trial: 42. Best value: 0.515811:  80%|████████  | 80/100 [05:13<01:19,  3.95s/it]Best trial: 42. Best value: 0.515811:  80%|████████  | 80/100 [05:17<01:19,  3.95s/it]Best trial: 42. Best value: 0.515811:  81%|████████  | 81/100 [05:17<01:15,  3.99s/it]Best trial: 42. Best value: 0.515811:  81%|████████  | 81/100 [05:20<01:15,  3.99s/it]Best trial: 42. Best value: 0.515811:  82%|████████▏ | 82/100 [05:20<01:06,  3.69s/it]Best trial: 42. Best value: 0.515811:  82%|████████▏ | 82/100 [05:25<01:06,  3.69s/it]Best trial: 42. Best value: 0.515811:  83%|████████▎ | 83/100 [05:25<01:10,  4.16s/it]Best trial: 42. Best value: 0.515811:  83%|████████▎ | 83/100 [05:30<01:10,  4.16s/it]Best trial: 42. Best value: 0.515811:  84%|████████▍ | 84/100 [05:30<01:09,  4.37s/it]Best trial: 42. Best value: 0.515811:  84%|████████▍ | 84/100 [05:34<01:09,  4.37s/it]Best trial: 42. Best value: 0.515811:  85%|████████▌ | 85/100 [05:34<01:06,  4.44s/it]Best trial: 42. Best value: 0.515811:  85%|████████▌ | 85/100 [05:39<01:06,  4.44s/it]Best trial: 42. Best value: 0.515811:  86%|████████▌ | 86/100 [05:39<01:03,  4.53s/it]Best trial: 42. Best value: 0.515811:  86%|████████▌ | 86/100 [05:43<01:03,  4.53s/it]Best trial: 42. Best value: 0.515811:  87%|████████▋ | 87/100 [05:43<00:55,  4.27s/it]Best trial: 42. Best value: 0.515811:  87%|████████▋ | 87/100 [05:46<00:55,  4.27s/it]Best trial: 42. Best value: 0.515811:  88%|████████▊ | 88/100 [05:46<00:48,  4.03s/it]Best trial: 42. Best value: 0.515811:  88%|████████▊ | 88/100 [05:49<00:48,  4.03s/it]Best trial: 42. Best value: 0.515811:  89%|████████▉ | 89/100 [05:49<00:39,  3.55s/it]Best trial: 42. Best value: 0.515811:  89%|████████▉ | 89/100 [05:54<00:39,  3.55s/it]Best trial: 42. Best value: 0.515811:  90%|█████████ | 90/100 [05:54<00:40,  4.00s/it]Best trial: 42. Best value: 0.515811:  90%|█████████ | 90/100 [06:00<00:40,  4.00s/it]Best trial: 42. Best value: 0.515811:  91%|█████████ | 91/100 [06:00<00:40,  4.52s/it]Best trial: 42. Best value: 0.515811:  91%|█████████ | 91/100 [06:04<00:40,  4.52s/it]Best trial: 42. Best value: 0.515811:  92%|█████████▏| 92/100 [06:04<00:34,  4.37s/it]Best trial: 42. Best value: 0.515811:  92%|█████████▏| 92/100 [06:07<00:34,  4.37s/it]Best trial: 42. Best value: 0.515811:  93%|█████████▎| 93/100 [06:07<00:28,  4.01s/it]Best trial: 42. Best value: 0.515811:  93%|█████████▎| 93/100 [06:09<00:28,  4.01s/it]Best trial: 42. Best value: 0.515811:  94%|█████████▍| 94/100 [06:09<00:21,  3.57s/it]Best trial: 42. Best value: 0.515811:  94%|█████████▍| 94/100 [06:13<00:21,  3.57s/it]Best trial: 42. Best value: 0.515811:  95%|█████████▌| 95/100 [06:13<00:18,  3.62s/it]Best trial: 42. Best value: 0.515811:  95%|█████████▌| 95/100 [06:16<00:18,  3.62s/it]Best trial: 42. Best value: 0.515811:  96%|█████████▌| 96/100 [06:16<00:14,  3.54s/it]Best trial: 42. Best value: 0.515811:  96%|█████████▌| 96/100 [06:21<00:14,  3.54s/it]Best trial: 42. Best value: 0.515811:  97%|█████████▋| 97/100 [06:21<00:11,  3.87s/it]Best trial: 42. Best value: 0.515811:  97%|█████████▋| 97/100 [06:25<00:11,  3.87s/it]Best trial: 42. Best value: 0.515811:  98%|█████████▊| 98/100 [06:25<00:07,  3.77s/it]Best trial: 42. Best value: 0.515811:  98%|█████████▊| 98/100 [06:27<00:07,  3.77s/it]Best trial: 42. Best value: 0.515811:  99%|█████████▉| 99/100 [06:27<00:03,  3.36s/it]Best trial: 42. Best value: 0.515811:  99%|█████████▉| 99/100 [06:30<00:03,  3.36s/it]Best trial: 42. Best value: 0.515811: 100%|██████████| 100/100 [06:30<00:00,  3.39s/it]Best trial: 42. Best value: 0.515811: 100%|██████████| 100/100 [06:30<00:00,  3.91s/it]
2025-11-30 10:27:25,428 - INFO - HPO Complete. Best AUPRC: 0.5158
2025-11-30 10:27:25,428 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.07019783022040457, 'max_depth': 4, 'subsample': 0.8933390910538943, 'colsample_bytree': 0.7903368526332216, 'gamma': 2.066672349574834, 'reg_lambda': 0.001148074280232774, 'reg_alpha': 2.0377876740942943e-08}
2025-11-30 10:27:25,429 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:27:27,597 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 10:27:27,597 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:27:27,825 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:27:27,864 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:27:27,873 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 10:27:27,873 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:27:27,873 - INFO - Training model...
2025-11-30 10:27:29,481 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:27:35,255 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:27:35,256 - INFO - AUROC: 0.7846 (0.7181 - 0.8577)
2025-11-30 10:27:35,256 - INFO - AUPRC: 0.3519 (0.1920 - 0.5476)
2025-11-30 10:27:35,256 - INFO - Brier Score: 0.0420 (0.0298 - 0.0538)
2025-11-30 10:27:35,256 - INFO - Accuracy: 0.9566 (0.9046 - 0.9711)
2025-11-30 10:27:35,256 - INFO - Precision: 0.6667 (0.2435 - 0.9368)
2025-11-30 10:27:35,256 - INFO - Sensitivity (Recall): 0.3333 (0.2343 - 0.4710)
2025-11-30 10:27:35,256 - INFO - F1-Score: 0.4444 (0.2872 - 0.5886)
2025-11-30 10:27:35,256 - INFO - Best Threshold: 0.5200 (0.1340 - 0.7900)
2025-11-30 10:27:35,256 - INFO - Specificity: 0.9909 (0.9359 - 0.9982)
2025-11-30 10:27:35,266 - INFO - Calculating SHAP values...
2025-11-30 10:27:36,348 - INFO - SHAP plots saved.
2025-11-30 10:27:36,350 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:27:37,914 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 10:27:37,914 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:27:38,169 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:27:38,237 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:27:38,249 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 10:27:38,250 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.467803:   0%|          | 0/100 [00:17<?, ?it/s]Best trial: 0. Best value: 0.467803:   1%|          | 1/100 [00:17<28:34, 17.32s/it]Best trial: 0. Best value: 0.467803:   1%|          | 1/100 [00:23<28:34, 17.32s/it]Best trial: 0. Best value: 0.467803:   2%|▏         | 2/100 [00:23<17:08, 10.50s/it]Best trial: 0. Best value: 0.467803:   2%|▏         | 2/100 [00:28<17:08, 10.50s/it]Best trial: 0. Best value: 0.467803:   3%|▎         | 3/100 [00:28<13:03,  8.07s/it]Best trial: 0. Best value: 0.467803:   3%|▎         | 3/100 [00:36<13:03,  8.07s/it]Best trial: 0. Best value: 0.467803:   4%|▍         | 4/100 [00:36<13:17,  8.30s/it]Best trial: 0. Best value: 0.467803:   4%|▍         | 4/100 [00:53<13:17,  8.30s/it]Best trial: 0. Best value: 0.467803:   5%|▌         | 5/100 [00:53<18:10, 11.48s/it]Best trial: 0. Best value: 0.467803:   5%|▌         | 5/100 [00:59<18:10, 11.48s/it]Best trial: 0. Best value: 0.467803:   6%|▌         | 6/100 [00:59<14:46,  9.43s/it]Best trial: 0. Best value: 0.467803:   6%|▌         | 6/100 [01:06<14:46,  9.43s/it]Best trial: 0. Best value: 0.467803:   7%|▋         | 7/100 [01:06<13:10,  8.50s/it]Best trial: 0. Best value: 0.467803:   7%|▋         | 7/100 [01:24<13:10,  8.50s/it]Best trial: 0. Best value: 0.467803:   8%|▊         | 8/100 [01:24<17:54, 11.68s/it]Best trial: 8. Best value: 0.490569:   8%|▊         | 8/100 [01:33<17:54, 11.68s/it]Best trial: 8. Best value: 0.490569:   9%|▉         | 9/100 [01:33<16:20, 10.78s/it]Best trial: 8. Best value: 0.490569:   9%|▉         | 9/100 [01:51<16:20, 10.78s/it]Best trial: 8. Best value: 0.490569:  10%|█         | 10/100 [01:51<19:25, 12.95s/it]Best trial: 8. Best value: 0.490569:  10%|█         | 10/100 [01:58<19:25, 12.95s/it]Best trial: 8. Best value: 0.490569:  11%|█         | 11/100 [01:58<16:47, 11.32s/it]Best trial: 8. Best value: 0.490569:  11%|█         | 11/100 [02:05<16:47, 11.32s/it]Best trial: 8. Best value: 0.490569:  12%|█▏        | 12/100 [02:05<14:43, 10.04s/it]Best trial: 8. Best value: 0.490569:  12%|█▏        | 12/100 [02:15<14:43, 10.04s/it]Best trial: 8. Best value: 0.490569:  13%|█▎        | 13/100 [02:15<14:18,  9.86s/it]Best trial: 8. Best value: 0.490569:  13%|█▎        | 13/100 [02:23<14:18,  9.86s/it]Best trial: 8. Best value: 0.490569:  14%|█▍        | 14/100 [02:23<13:19,  9.30s/it]Best trial: 8. Best value: 0.490569:  14%|█▍        | 14/100 [02:30<13:19,  9.30s/it]Best trial: 8. Best value: 0.490569:  15%|█▌        | 15/100 [02:30<12:28,  8.81s/it]Best trial: 8. Best value: 0.490569:  15%|█▌        | 15/100 [02:41<12:28,  8.81s/it]Best trial: 8. Best value: 0.490569:  16%|█▌        | 16/100 [02:41<13:11,  9.42s/it]Best trial: 8. Best value: 0.490569:  16%|█▌        | 16/100 [02:49<13:11,  9.42s/it]Best trial: 8. Best value: 0.490569:  17%|█▋        | 17/100 [02:49<12:23,  8.96s/it]Best trial: 8. Best value: 0.490569:  17%|█▋        | 17/100 [03:02<12:23,  8.96s/it]Best trial: 8. Best value: 0.490569:  18%|█▊        | 18/100 [03:02<13:44, 10.05s/it]Best trial: 8. Best value: 0.490569:  18%|█▊        | 18/100 [03:14<13:44, 10.05s/it]Best trial: 8. Best value: 0.490569:  19%|█▉        | 19/100 [03:14<14:19, 10.61s/it]Best trial: 8. Best value: 0.490569:  19%|█▉        | 19/100 [03:29<14:19, 10.61s/it]Best trial: 8. Best value: 0.490569:  20%|██        | 20/100 [03:29<16:06, 12.08s/it]Best trial: 8. Best value: 0.490569:  20%|██        | 20/100 [03:46<16:06, 12.08s/it]Best trial: 8. Best value: 0.490569:  21%|██        | 21/100 [03:46<17:42, 13.45s/it]Best trial: 8. Best value: 0.490569:  21%|██        | 21/100 [03:59<17:42, 13.45s/it]Best trial: 8. Best value: 0.490569:  22%|██▏       | 22/100 [03:59<17:18, 13.31s/it]Best trial: 8. Best value: 0.490569:  22%|██▏       | 22/100 [04:10<17:18, 13.31s/it]Best trial: 8. Best value: 0.490569:  23%|██▎       | 23/100 [04:10<16:12, 12.63s/it]Best trial: 8. Best value: 0.490569:  23%|██▎       | 23/100 [04:23<16:12, 12.63s/it]Best trial: 8. Best value: 0.490569:  24%|██▍       | 24/100 [04:23<16:19, 12.88s/it]Best trial: 8. Best value: 0.490569:  24%|██▍       | 24/100 [04:37<16:19, 12.88s/it]Best trial: 8. Best value: 0.490569:  25%|██▌       | 25/100 [04:37<16:21, 13.08s/it]Best trial: 8. Best value: 0.490569:  25%|██▌       | 25/100 [04:49<16:21, 13.08s/it]Best trial: 8. Best value: 0.490569:  26%|██▌       | 26/100 [04:49<15:50, 12.85s/it]Best trial: 8. Best value: 0.490569:  26%|██▌       | 26/100 [04:53<15:50, 12.85s/it]Best trial: 8. Best value: 0.490569:  27%|██▋       | 27/100 [04:53<12:16, 10.09s/it]Best trial: 8. Best value: 0.490569:  27%|██▋       | 27/100 [05:05<12:16, 10.09s/it]Best trial: 8. Best value: 0.490569:  28%|██▊       | 28/100 [05:05<12:53, 10.75s/it]Best trial: 8. Best value: 0.490569:  28%|██▊       | 28/100 [05:16<12:53, 10.75s/it]Best trial: 8. Best value: 0.490569:  29%|██▉       | 29/100 [05:16<12:39, 10.69s/it]Best trial: 8. Best value: 0.490569:  29%|██▉       | 29/100 [05:24<12:39, 10.69s/it]Best trial: 8. Best value: 0.490569:  30%|███       | 30/100 [05:24<11:27,  9.81s/it]Best trial: 8. Best value: 0.490569:  30%|███       | 30/100 [05:29<11:27,  9.81s/it]Best trial: 8. Best value: 0.490569:  31%|███       | 31/100 [05:29<09:47,  8.51s/it]Best trial: 8. Best value: 0.490569:  31%|███       | 31/100 [05:40<09:47,  8.51s/it]Best trial: 8. Best value: 0.490569:  32%|███▏      | 32/100 [05:40<10:36,  9.35s/it]Best trial: 8. Best value: 0.490569:  32%|███▏      | 32/100 [05:54<10:36,  9.35s/it]Best trial: 8. Best value: 0.490569:  33%|███▎      | 33/100 [05:54<11:52, 10.63s/it]Best trial: 8. Best value: 0.490569:  33%|███▎      | 33/100 [06:07<11:52, 10.63s/it]Best trial: 8. Best value: 0.490569:  34%|███▍      | 34/100 [06:07<12:32, 11.40s/it]Best trial: 8. Best value: 0.490569:  34%|███▍      | 34/100 [06:17<12:32, 11.40s/it]Best trial: 8. Best value: 0.490569:  35%|███▌      | 35/100 [06:17<11:51, 10.94s/it]Best trial: 8. Best value: 0.490569:  35%|███▌      | 35/100 [06:29<11:51, 10.94s/it]Best trial: 8. Best value: 0.490569:  36%|███▌      | 36/100 [06:29<11:55, 11.17s/it]Best trial: 8. Best value: 0.490569:  36%|███▌      | 36/100 [06:38<11:55, 11.17s/it]Best trial: 8. Best value: 0.490569:  37%|███▋      | 37/100 [06:38<11:09, 10.62s/it]Best trial: 8. Best value: 0.490569:  37%|███▋      | 37/100 [06:48<11:09, 10.62s/it]Best trial: 8. Best value: 0.490569:  38%|███▊      | 38/100 [06:48<10:36, 10.27s/it]Best trial: 8. Best value: 0.490569:  38%|███▊      | 38/100 [06:59<10:36, 10.27s/it]Best trial: 8. Best value: 0.490569:  39%|███▉      | 39/100 [06:59<10:57, 10.78s/it]Best trial: 8. Best value: 0.490569:  39%|███▉      | 39/100 [07:14<10:57, 10.78s/it]Best trial: 8. Best value: 0.490569:  40%|████      | 40/100 [07:14<11:53, 11.89s/it]Best trial: 8. Best value: 0.490569:  40%|████      | 40/100 [07:28<11:53, 11.89s/it]Best trial: 8. Best value: 0.490569:  41%|████      | 41/100 [07:28<12:14, 12.44s/it]Best trial: 8. Best value: 0.490569:  41%|████      | 41/100 [07:38<12:14, 12.44s/it]Best trial: 8. Best value: 0.490569:  42%|████▏     | 42/100 [07:38<11:24, 11.80s/it]Best trial: 42. Best value: 0.494518:  42%|████▏     | 42/100 [07:57<11:24, 11.80s/it]Best trial: 42. Best value: 0.494518:  43%|████▎     | 43/100 [07:57<13:16, 13.98s/it]Best trial: 42. Best value: 0.494518:  43%|████▎     | 43/100 [08:14<13:16, 13.98s/it]Best trial: 42. Best value: 0.494518:  44%|████▍     | 44/100 [08:14<13:52, 14.86s/it]Best trial: 42. Best value: 0.494518:  44%|████▍     | 44/100 [08:26<13:52, 14.86s/it]Best trial: 42. Best value: 0.494518:  45%|████▌     | 45/100 [08:26<12:51, 14.03s/it]Best trial: 42. Best value: 0.494518:  45%|████▌     | 45/100 [08:40<12:51, 14.03s/it]Best trial: 42. Best value: 0.494518:  46%|████▌     | 46/100 [08:40<12:36, 14.00s/it]Best trial: 42. Best value: 0.494518:  46%|████▌     | 46/100 [08:55<12:36, 14.00s/it]Best trial: 42. Best value: 0.494518:  47%|████▋     | 47/100 [08:55<12:35, 14.26s/it]Best trial: 42. Best value: 0.494518:  47%|████▋     | 47/100 [09:04<12:35, 14.26s/it]Best trial: 42. Best value: 0.494518:  48%|████▊     | 48/100 [09:04<10:58, 12.67s/it]Best trial: 42. Best value: 0.494518:  48%|████▊     | 48/100 [09:18<10:58, 12.67s/it]Best trial: 42. Best value: 0.494518:  49%|████▉     | 49/100 [09:18<11:02, 12.99s/it]Best trial: 42. Best value: 0.494518:  49%|████▉     | 49/100 [09:32<11:02, 12.99s/it]Best trial: 42. Best value: 0.494518:  50%|█████     | 50/100 [09:32<11:15, 13.50s/it]Best trial: 42. Best value: 0.494518:  50%|█████     | 50/100 [09:39<11:15, 13.50s/it]Best trial: 42. Best value: 0.494518:  51%|█████     | 51/100 [09:39<09:16, 11.36s/it]Best trial: 42. Best value: 0.494518:  51%|█████     | 51/100 [09:51<09:16, 11.36s/it]Best trial: 42. Best value: 0.494518:  52%|█████▏    | 52/100 [09:51<09:18, 11.63s/it]Best trial: 42. Best value: 0.494518:  52%|█████▏    | 52/100 [10:04<09:18, 11.63s/it]Best trial: 42. Best value: 0.494518:  53%|█████▎    | 53/100 [10:04<09:34, 12.22s/it]Best trial: 42. Best value: 0.494518:  53%|█████▎    | 53/100 [10:20<09:34, 12.22s/it]Best trial: 42. Best value: 0.494518:  54%|█████▍    | 54/100 [10:20<10:07, 13.20s/it]Best trial: 42. Best value: 0.494518:  54%|█████▍    | 54/100 [10:30<10:07, 13.20s/it]Best trial: 42. Best value: 0.494518:  55%|█████▌    | 55/100 [10:30<09:05, 12.13s/it]Best trial: 42. Best value: 0.494518:  55%|█████▌    | 55/100 [10:44<09:05, 12.13s/it]Best trial: 42. Best value: 0.494518:  56%|█████▌    | 56/100 [10:44<09:21, 12.76s/it]Best trial: 42. Best value: 0.494518:  56%|█████▌    | 56/100 [10:54<09:21, 12.76s/it]Best trial: 42. Best value: 0.494518:  57%|█████▋    | 57/100 [10:54<08:36, 12.01s/it]Best trial: 42. Best value: 0.494518:  57%|█████▋    | 57/100 [11:05<08:36, 12.01s/it]Best trial: 42. Best value: 0.494518:  58%|█████▊    | 58/100 [11:05<08:06, 11.57s/it]Best trial: 42. Best value: 0.494518:  58%|█████▊    | 58/100 [11:16<08:06, 11.57s/it]Best trial: 42. Best value: 0.494518:  59%|█████▉    | 59/100 [11:16<07:55, 11.61s/it]Best trial: 42. Best value: 0.494518:  59%|█████▉    | 59/100 [11:26<07:55, 11.61s/it]Best trial: 42. Best value: 0.494518:  60%|██████    | 60/100 [11:26<07:18, 10.97s/it]Best trial: 42. Best value: 0.494518:  60%|██████    | 60/100 [11:36<07:18, 10.97s/it]Best trial: 42. Best value: 0.494518:  61%|██████    | 61/100 [11:36<07:04, 10.88s/it]Best trial: 42. Best value: 0.494518:  61%|██████    | 61/100 [11:46<07:04, 10.88s/it]Best trial: 42. Best value: 0.494518:  62%|██████▏   | 62/100 [11:46<06:36, 10.45s/it]Best trial: 42. Best value: 0.494518:  62%|██████▏   | 62/100 [11:58<06:36, 10.45s/it]Best trial: 42. Best value: 0.494518:  63%|██████▎   | 63/100 [11:58<06:41, 10.85s/it]Best trial: 42. Best value: 0.494518:  63%|██████▎   | 63/100 [12:10<06:41, 10.85s/it]Best trial: 42. Best value: 0.494518:  64%|██████▍   | 64/100 [12:10<06:51, 11.43s/it]Best trial: 42. Best value: 0.494518:  64%|██████▍   | 64/100 [12:23<06:51, 11.43s/it]Best trial: 42. Best value: 0.494518:  65%|██████▌   | 65/100 [12:23<06:55, 11.88s/it]Best trial: 42. Best value: 0.494518:  65%|██████▌   | 65/100 [12:34<06:55, 11.88s/it]Best trial: 42. Best value: 0.494518:  66%|██████▌   | 66/100 [12:34<06:30, 11.48s/it]Best trial: 42. Best value: 0.494518:  66%|██████▌   | 66/100 [12:43<06:30, 11.48s/it]Best trial: 42. Best value: 0.494518:  67%|██████▋   | 67/100 [12:43<05:50, 10.61s/it]Best trial: 42. Best value: 0.494518:  67%|██████▋   | 67/100 [12:52<05:50, 10.61s/it]Best trial: 42. Best value: 0.494518:  68%|██████▊   | 68/100 [12:52<05:32, 10.38s/it]Best trial: 42. Best value: 0.494518:  68%|██████▊   | 68/100 [13:00<05:32, 10.38s/it]Best trial: 42. Best value: 0.494518:  69%|██████▉   | 69/100 [13:00<04:54,  9.49s/it]Best trial: 69. Best value: 0.495974:  69%|██████▉   | 69/100 [13:09<04:54,  9.49s/it]Best trial: 69. Best value: 0.495974:  70%|███████   | 70/100 [13:09<04:37,  9.27s/it]Best trial: 69. Best value: 0.495974:  70%|███████   | 70/100 [13:16<04:37,  9.27s/it]Best trial: 69. Best value: 0.495974:  71%|███████   | 71/100 [13:16<04:16,  8.86s/it]Best trial: 69. Best value: 0.495974:  71%|███████   | 71/100 [13:22<04:16,  8.86s/it]Best trial: 69. Best value: 0.495974:  72%|███████▏  | 72/100 [13:22<03:39,  7.86s/it]Best trial: 72. Best value: 0.497647:  72%|███████▏  | 72/100 [13:28<03:39,  7.86s/it]Best trial: 72. Best value: 0.497647:  73%|███████▎  | 73/100 [13:28<03:21,  7.46s/it]Best trial: 73. Best value: 0.500147:  73%|███████▎  | 73/100 [13:35<03:21,  7.46s/it]Best trial: 73. Best value: 0.500147:  74%|███████▍  | 74/100 [13:35<03:06,  7.16s/it]Best trial: 73. Best value: 0.500147:  74%|███████▍  | 74/100 [13:41<03:06,  7.16s/it]Best trial: 73. Best value: 0.500147:  75%|███████▌  | 75/100 [13:41<02:50,  6.83s/it]Best trial: 73. Best value: 0.500147:  75%|███████▌  | 75/100 [13:47<02:50,  6.83s/it]Best trial: 73. Best value: 0.500147:  76%|███████▌  | 76/100 [13:47<02:36,  6.54s/it]Best trial: 73. Best value: 0.500147:  76%|███████▌  | 76/100 [13:53<02:36,  6.54s/it]Best trial: 73. Best value: 0.500147:  77%|███████▋  | 77/100 [13:53<02:25,  6.32s/it]Best trial: 73. Best value: 0.500147:  77%|███████▋  | 77/100 [13:59<02:25,  6.32s/it]Best trial: 73. Best value: 0.500147:  78%|███████▊  | 78/100 [13:59<02:19,  6.32s/it]Best trial: 73. Best value: 0.500147:  78%|███████▊  | 78/100 [14:03<02:19,  6.32s/it]Best trial: 73. Best value: 0.500147:  79%|███████▉  | 79/100 [14:03<01:59,  5.70s/it]Best trial: 73. Best value: 0.500147:  79%|███████▉  | 79/100 [14:09<01:59,  5.70s/it]Best trial: 73. Best value: 0.500147:  80%|████████  | 80/100 [14:09<01:55,  5.78s/it]Best trial: 73. Best value: 0.500147:  80%|████████  | 80/100 [14:14<01:55,  5.78s/it]Best trial: 73. Best value: 0.500147:  81%|████████  | 81/100 [14:14<01:42,  5.41s/it]Best trial: 73. Best value: 0.500147:  81%|████████  | 81/100 [14:19<01:42,  5.41s/it]Best trial: 73. Best value: 0.500147:  82%|████████▏ | 82/100 [14:19<01:33,  5.21s/it]Best trial: 73. Best value: 0.500147:  82%|████████▏ | 82/100 [14:24<01:33,  5.21s/it]Best trial: 73. Best value: 0.500147:  83%|████████▎ | 83/100 [14:24<01:27,  5.16s/it]Best trial: 83. Best value: 0.500481:  83%|████████▎ | 83/100 [14:30<01:27,  5.16s/it]Best trial: 83. Best value: 0.500481:  84%|████████▍ | 84/100 [14:30<01:26,  5.42s/it]Best trial: 84. Best value: 0.501621:  84%|████████▍ | 84/100 [14:34<01:26,  5.42s/it]Best trial: 84. Best value: 0.501621:  85%|████████▌ | 85/100 [14:34<01:18,  5.21s/it]Best trial: 85. Best value: 0.502796:  85%|████████▌ | 85/100 [14:39<01:18,  5.21s/it]Best trial: 85. Best value: 0.502796:  86%|████████▌ | 86/100 [14:39<01:11,  5.11s/it]Best trial: 85. Best value: 0.502796:  86%|████████▌ | 86/100 [14:44<01:11,  5.11s/it]Best trial: 85. Best value: 0.502796:  87%|████████▋ | 87/100 [14:44<01:06,  5.14s/it]Best trial: 85. Best value: 0.502796:  87%|████████▋ | 87/100 [14:50<01:06,  5.14s/it]Best trial: 85. Best value: 0.502796:  88%|████████▊ | 88/100 [14:50<01:01,  5.15s/it]Best trial: 85. Best value: 0.502796:  88%|████████▊ | 88/100 [14:55<01:01,  5.15s/it]Best trial: 85. Best value: 0.502796:  89%|████████▉ | 89/100 [14:55<00:58,  5.29s/it]Best trial: 85. Best value: 0.502796:  89%|████████▉ | 89/100 [15:00<00:58,  5.29s/it]Best trial: 85. Best value: 0.502796:  90%|█████████ | 90/100 [15:00<00:50,  5.03s/it]Best trial: 85. Best value: 0.502796:  90%|█████████ | 90/100 [15:06<00:50,  5.03s/it]Best trial: 85. Best value: 0.502796:  91%|█████████ | 91/100 [15:06<00:49,  5.47s/it]Best trial: 85. Best value: 0.502796:  91%|█████████ | 91/100 [15:11<00:49,  5.47s/it]Best trial: 85. Best value: 0.502796:  92%|█████████▏| 92/100 [15:11<00:43,  5.39s/it]Best trial: 85. Best value: 0.502796:  92%|█████████▏| 92/100 [15:17<00:43,  5.39s/it]Best trial: 85. Best value: 0.502796:  93%|█████████▎| 93/100 [15:17<00:37,  5.35s/it]Best trial: 85. Best value: 0.502796:  93%|█████████▎| 93/100 [15:22<00:37,  5.35s/it]Best trial: 85. Best value: 0.502796:  94%|█████████▍| 94/100 [15:22<00:31,  5.24s/it]Best trial: 85. Best value: 0.502796:  94%|█████████▍| 94/100 [15:27<00:31,  5.24s/it]Best trial: 85. Best value: 0.502796:  95%|█████████▌| 95/100 [15:27<00:26,  5.38s/it]Best trial: 85. Best value: 0.502796:  95%|█████████▌| 95/100 [15:32<00:26,  5.38s/it]Best trial: 85. Best value: 0.502796:  96%|█████████▌| 96/100 [15:32<00:20,  5.20s/it]Best trial: 85. Best value: 0.502796:  96%|█████████▌| 96/100 [15:37<00:20,  5.20s/it]Best trial: 85. Best value: 0.502796:  97%|█████████▋| 97/100 [15:37<00:15,  5.16s/it]Best trial: 85. Best value: 0.502796:  97%|█████████▋| 97/100 [15:42<00:15,  5.16s/it]Best trial: 85. Best value: 0.502796:  98%|█████████▊| 98/100 [15:42<00:10,  5.14s/it]Best trial: 85. Best value: 0.502796:  98%|█████████▊| 98/100 [15:47<00:10,  5.14s/it]Best trial: 85. Best value: 0.502796:  99%|█████████▉| 99/100 [15:47<00:04,  4.96s/it]Best trial: 85. Best value: 0.502796:  99%|█████████▉| 99/100 [15:52<00:04,  4.96s/it]Best trial: 85. Best value: 0.502796: 100%|██████████| 100/100 [15:52<00:00,  4.91s/it]Best trial: 85. Best value: 0.502796: 100%|██████████| 100/100 [15:52<00:00,  9.52s/it]
2025-11-30 10:43:30,280 - INFO - HPO Complete. Best AUPRC: 0.5028
2025-11-30 10:43:30,281 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.00012775021288868022, 'max_depth': 3, 'subsample': 0.6714924035906512, 'colsample_bytree': 0.6807551273789366, 'gamma': 1.9784986572544718, 'reg_lambda': 1.1132187240183524e-08, 'reg_alpha': 0.36461159259400344}
2025-11-30 10:43:30,281 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:43:32,521 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 10:43:32,521 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:43:32,729 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:43:32,797 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:43:32,811 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 10:43:32,811 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:43:32,811 - INFO - Training model...
2025-11-30 10:43:38,262 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:43:44,791 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:43:44,791 - INFO - AUROC: 0.8056 (0.7062 - 0.8719)
2025-11-30 10:43:44,791 - INFO - AUPRC: 0.4460 (0.3206 - 0.5693)
2025-11-30 10:43:44,792 - INFO - Brier Score: 0.2279 (0.2269 - 0.2292)
2025-11-30 10:43:44,792 - INFO - Accuracy: 0.9494 (0.9332 - 0.9694)
2025-11-30 10:43:44,792 - INFO - Precision: 0.5152 (0.3786 - 0.9667)
2025-11-30 10:43:44,792 - INFO - Sensitivity (Recall): 0.4722 (0.2401 - 0.6452)
2025-11-30 10:43:44,792 - INFO - F1-Score: 0.4928 (0.3622 - 0.6224)
2025-11-30 10:43:44,792 - INFO - Best Threshold: 0.5100 (0.5100 - 0.5400)
2025-11-30 10:43:44,792 - INFO - Specificity: 0.9756 (0.9633 - 0.9991)
2025-11-30 10:43:44,812 - INFO - Calculating SHAP values...
2025-11-30 10:43:45,939 - INFO - SHAP plots saved.
2025-11-30 10:43:45,941 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:43:47,281 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 10:43:47,281 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:43:47,519 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:43:47,590 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:43:47,604 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 10:43:47,604 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.454341:   0%|          | 0/100 [00:08<?, ?it/s]Best trial: 0. Best value: 0.454341:   1%|          | 1/100 [00:08<14:43,  8.93s/it]Best trial: 0. Best value: 0.454341:   1%|          | 1/100 [00:14<14:43,  8.93s/it]Best trial: 0. Best value: 0.454341:   2%|▏         | 2/100 [00:14<11:30,  7.04s/it]Best trial: 2. Best value: 0.462118:   2%|▏         | 2/100 [00:28<11:30,  7.04s/it]Best trial: 2. Best value: 0.462118:   3%|▎         | 3/100 [00:28<16:16, 10.07s/it]Best trial: 2. Best value: 0.462118:   3%|▎         | 3/100 [00:43<16:16, 10.07s/it]Best trial: 2. Best value: 0.462118:   4%|▍         | 4/100 [00:43<19:18, 12.07s/it]Best trial: 2. Best value: 0.462118:   4%|▍         | 4/100 [00:53<19:18, 12.07s/it]Best trial: 2. Best value: 0.462118:   5%|▌         | 5/100 [00:53<18:07, 11.44s/it]Best trial: 5. Best value: 0.465279:   5%|▌         | 5/100 [01:08<18:07, 11.44s/it]Best trial: 5. Best value: 0.465279:   6%|▌         | 6/100 [01:08<19:33, 12.49s/it]Best trial: 6. Best value: 0.473692:   6%|▌         | 6/100 [01:12<19:33, 12.49s/it]Best trial: 6. Best value: 0.473692:   7%|▋         | 7/100 [01:12<15:07,  9.75s/it]Best trial: 6. Best value: 0.473692:   7%|▋         | 7/100 [01:21<15:07,  9.75s/it]Best trial: 6. Best value: 0.473692:   8%|▊         | 8/100 [01:21<14:38,  9.55s/it]Best trial: 6. Best value: 0.473692:   8%|▊         | 8/100 [01:29<14:38,  9.55s/it]Best trial: 6. Best value: 0.473692:   9%|▉         | 9/100 [01:29<13:38,  8.99s/it]Best trial: 6. Best value: 0.473692:   9%|▉         | 9/100 [01:33<13:38,  8.99s/it]Best trial: 6. Best value: 0.473692:  10%|█         | 10/100 [01:33<11:07,  7.42s/it]Best trial: 6. Best value: 0.473692:  10%|█         | 10/100 [01:36<11:07,  7.42s/it]Best trial: 6. Best value: 0.473692:  11%|█         | 11/100 [01:36<09:21,  6.31s/it]Best trial: 6. Best value: 0.473692:  11%|█         | 11/100 [01:49<09:21,  6.31s/it]Best trial: 6. Best value: 0.473692:  12%|█▏        | 12/100 [01:49<12:13,  8.34s/it]Best trial: 6. Best value: 0.473692:  12%|█▏        | 12/100 [02:06<12:13,  8.34s/it]Best trial: 6. Best value: 0.473692:  13%|█▎        | 13/100 [02:06<15:42, 10.83s/it]Best trial: 6. Best value: 0.473692:  13%|█▎        | 13/100 [02:17<15:42, 10.83s/it]Best trial: 6. Best value: 0.473692:  14%|█▍        | 14/100 [02:17<15:46, 11.01s/it]Best trial: 6. Best value: 0.473692:  14%|█▍        | 14/100 [02:24<15:46, 11.01s/it]Best trial: 6. Best value: 0.473692:  15%|█▌        | 15/100 [02:24<13:38,  9.63s/it]Best trial: 6. Best value: 0.473692:  15%|█▌        | 15/100 [02:40<13:38,  9.63s/it]Best trial: 6. Best value: 0.473692:  16%|█▌        | 16/100 [02:40<16:06, 11.50s/it]Best trial: 6. Best value: 0.473692:  16%|█▌        | 16/100 [02:52<16:06, 11.50s/it]Best trial: 6. Best value: 0.473692:  17%|█▋        | 17/100 [02:52<16:23, 11.85s/it]Best trial: 6. Best value: 0.473692:  17%|█▋        | 17/100 [03:04<16:23, 11.85s/it]Best trial: 6. Best value: 0.473692:  18%|█▊        | 18/100 [03:04<15:59, 11.70s/it]Best trial: 6. Best value: 0.473692:  18%|█▊        | 18/100 [03:10<15:59, 11.70s/it]Best trial: 6. Best value: 0.473692:  19%|█▉        | 19/100 [03:10<13:39, 10.12s/it]Best trial: 6. Best value: 0.473692:  19%|█▉        | 19/100 [03:16<13:39, 10.12s/it]Best trial: 6. Best value: 0.473692:  20%|██        | 20/100 [03:16<11:45,  8.82s/it]Best trial: 6. Best value: 0.473692:  20%|██        | 20/100 [03:22<11:45,  8.82s/it]Best trial: 6. Best value: 0.473692:  21%|██        | 21/100 [03:22<10:22,  7.88s/it]Best trial: 6. Best value: 0.473692:  21%|██        | 21/100 [03:26<10:22,  7.88s/it]Best trial: 6. Best value: 0.473692:  22%|██▏       | 22/100 [03:26<08:45,  6.74s/it]Best trial: 6. Best value: 0.473692:  22%|██▏       | 22/100 [03:32<08:45,  6.74s/it]Best trial: 6. Best value: 0.473692:  23%|██▎       | 23/100 [03:32<08:39,  6.74s/it]Best trial: 6. Best value: 0.473692:  23%|██▎       | 23/100 [03:38<08:39,  6.74s/it]Best trial: 6. Best value: 0.473692:  24%|██▍       | 24/100 [03:38<07:54,  6.24s/it]Best trial: 6. Best value: 0.473692:  24%|██▍       | 24/100 [03:41<07:54,  6.24s/it]Best trial: 6. Best value: 0.473692:  25%|██▌       | 25/100 [03:41<06:49,  5.45s/it]Best trial: 6. Best value: 0.473692:  25%|██▌       | 25/100 [03:49<06:49,  5.45s/it]Best trial: 6. Best value: 0.473692:  26%|██▌       | 26/100 [03:49<07:44,  6.27s/it]Best trial: 6. Best value: 0.473692:  26%|██▌       | 26/100 [04:04<07:44,  6.27s/it]Best trial: 6. Best value: 0.473692:  27%|██▋       | 27/100 [04:04<10:32,  8.66s/it]Best trial: 6. Best value: 0.473692:  27%|██▋       | 27/100 [04:13<10:32,  8.66s/it]Best trial: 6. Best value: 0.473692:  28%|██▊       | 28/100 [04:13<10:44,  8.95s/it]Best trial: 6. Best value: 0.473692:  28%|██▊       | 28/100 [04:19<10:44,  8.95s/it]Best trial: 6. Best value: 0.473692:  29%|██▉       | 29/100 [04:19<09:31,  8.05s/it]Best trial: 6. Best value: 0.473692:  29%|██▉       | 29/100 [04:27<09:31,  8.05s/it]Best trial: 6. Best value: 0.473692:  30%|███       | 30/100 [04:27<09:13,  7.90s/it]Best trial: 6. Best value: 0.473692:  30%|███       | 30/100 [04:36<09:13,  7.90s/it]Best trial: 6. Best value: 0.473692:  31%|███       | 31/100 [04:36<09:30,  8.26s/it]Best trial: 6. Best value: 0.473692:  31%|███       | 31/100 [04:46<09:30,  8.26s/it]Best trial: 6. Best value: 0.473692:  32%|███▏      | 32/100 [04:46<10:01,  8.84s/it]Best trial: 6. Best value: 0.473692:  32%|███▏      | 32/100 [04:59<10:01,  8.84s/it]Best trial: 6. Best value: 0.473692:  33%|███▎      | 33/100 [04:59<11:18, 10.13s/it]Best trial: 6. Best value: 0.473692:  33%|███▎      | 33/100 [05:11<11:18, 10.13s/it]Best trial: 6. Best value: 0.473692:  34%|███▍      | 34/100 [05:11<11:36, 10.56s/it]Best trial: 6. Best value: 0.473692:  34%|███▍      | 34/100 [05:23<11:36, 10.56s/it]Best trial: 6. Best value: 0.473692:  35%|███▌      | 35/100 [05:23<11:56, 11.03s/it]Best trial: 6. Best value: 0.473692:  35%|███▌      | 35/100 [05:36<11:56, 11.03s/it]Best trial: 6. Best value: 0.473692:  36%|███▌      | 36/100 [05:36<12:28, 11.70s/it]Best trial: 6. Best value: 0.473692:  36%|███▌      | 36/100 [05:52<12:28, 11.70s/it]Best trial: 6. Best value: 0.473692:  37%|███▋      | 37/100 [05:52<13:42, 13.06s/it]Best trial: 6. Best value: 0.473692:  37%|███▋      | 37/100 [05:58<13:42, 13.06s/it]Best trial: 6. Best value: 0.473692:  38%|███▊      | 38/100 [05:58<11:05, 10.74s/it]Best trial: 38. Best value: 0.476964:  38%|███▊      | 38/100 [06:03<11:05, 10.74s/it]Best trial: 38. Best value: 0.476964:  39%|███▉      | 39/100 [06:03<09:14,  9.09s/it]Best trial: 38. Best value: 0.476964:  39%|███▉      | 39/100 [06:07<09:14,  9.09s/it]Best trial: 38. Best value: 0.476964:  40%|████      | 40/100 [06:07<07:36,  7.60s/it]Best trial: 38. Best value: 0.476964:  40%|████      | 40/100 [06:14<07:36,  7.60s/it]Best trial: 38. Best value: 0.476964:  41%|████      | 41/100 [06:14<07:23,  7.52s/it]Best trial: 38. Best value: 0.476964:  41%|████      | 41/100 [06:19<07:23,  7.52s/it]Best trial: 38. Best value: 0.476964:  42%|████▏     | 42/100 [06:19<06:24,  6.62s/it]Best trial: 38. Best value: 0.476964:  42%|████▏     | 42/100 [06:25<06:24,  6.62s/it]Best trial: 38. Best value: 0.476964:  43%|████▎     | 43/100 [06:25<06:06,  6.42s/it]Best trial: 38. Best value: 0.476964:  43%|████▎     | 43/100 [06:33<06:06,  6.42s/it]Best trial: 38. Best value: 0.476964:  44%|████▍     | 44/100 [06:33<06:20,  6.80s/it]Best trial: 38. Best value: 0.476964:  44%|████▍     | 44/100 [06:36<06:20,  6.80s/it]Best trial: 38. Best value: 0.476964:  45%|████▌     | 45/100 [06:36<05:23,  5.89s/it]Best trial: 38. Best value: 0.476964:  45%|████▌     | 45/100 [06:43<05:23,  5.89s/it]Best trial: 38. Best value: 0.476964:  46%|████▌     | 46/100 [06:43<05:28,  6.08s/it]Best trial: 38. Best value: 0.476964:  46%|████▌     | 46/100 [06:46<05:28,  6.08s/it]Best trial: 38. Best value: 0.476964:  47%|████▋     | 47/100 [06:46<04:43,  5.35s/it]Best trial: 47. Best value: 0.478211:  47%|████▋     | 47/100 [06:51<04:43,  5.35s/it]Best trial: 47. Best value: 0.478211:  48%|████▊     | 48/100 [06:51<04:27,  5.15s/it]Best trial: 47. Best value: 0.478211:  48%|████▊     | 48/100 [06:55<04:27,  5.15s/it]Best trial: 47. Best value: 0.478211:  49%|████▉     | 49/100 [06:55<04:06,  4.84s/it]Best trial: 49. Best value: 0.478613:  49%|████▉     | 49/100 [06:59<04:06,  4.84s/it]Best trial: 49. Best value: 0.478613:  50%|█████     | 50/100 [06:59<03:47,  4.54s/it]Best trial: 49. Best value: 0.478613:  50%|█████     | 50/100 [07:05<03:47,  4.54s/it]Best trial: 49. Best value: 0.478613:  51%|█████     | 51/100 [07:05<04:08,  5.08s/it]Best trial: 49. Best value: 0.478613:  51%|█████     | 51/100 [07:09<04:08,  5.08s/it]Best trial: 49. Best value: 0.478613:  52%|█████▏    | 52/100 [07:09<03:46,  4.72s/it]Best trial: 52. Best value: 0.479342:  52%|█████▏    | 52/100 [07:13<03:46,  4.72s/it]Best trial: 52. Best value: 0.479342:  53%|█████▎    | 53/100 [07:13<03:26,  4.39s/it]Best trial: 52. Best value: 0.479342:  53%|█████▎    | 53/100 [07:17<03:26,  4.39s/it]Best trial: 52. Best value: 0.479342:  54%|█████▍    | 54/100 [07:17<03:16,  4.28s/it]Best trial: 52. Best value: 0.479342:  54%|█████▍    | 54/100 [07:22<03:16,  4.28s/it]Best trial: 52. Best value: 0.479342:  55%|█████▌    | 55/100 [07:22<03:17,  4.39s/it]Best trial: 52. Best value: 0.479342:  55%|█████▌    | 55/100 [07:26<03:17,  4.39s/it]Best trial: 52. Best value: 0.479342:  56%|█████▌    | 56/100 [07:26<03:09,  4.31s/it]Best trial: 52. Best value: 0.479342:  56%|█████▌    | 56/100 [07:30<03:09,  4.31s/it]Best trial: 52. Best value: 0.479342:  57%|█████▋    | 57/100 [07:30<03:00,  4.19s/it]Best trial: 52. Best value: 0.479342:  57%|█████▋    | 57/100 [07:36<03:00,  4.19s/it]Best trial: 52. Best value: 0.479342:  58%|█████▊    | 58/100 [07:36<03:25,  4.89s/it]Best trial: 58. Best value: 0.49078:  58%|█████▊    | 58/100 [07:41<03:25,  4.89s/it] Best trial: 58. Best value: 0.49078:  59%|█████▉    | 59/100 [07:41<03:19,  4.86s/it]Best trial: 58. Best value: 0.49078:  59%|█████▉    | 59/100 [07:47<03:19,  4.86s/it]Best trial: 58. Best value: 0.49078:  60%|██████    | 60/100 [07:47<03:27,  5.18s/it]Best trial: 58. Best value: 0.49078:  60%|██████    | 60/100 [07:52<03:27,  5.18s/it]Best trial: 58. Best value: 0.49078:  61%|██████    | 61/100 [07:52<03:17,  5.06s/it]Best trial: 58. Best value: 0.49078:  61%|██████    | 61/100 [07:56<03:17,  5.06s/it]Best trial: 58. Best value: 0.49078:  62%|██████▏   | 62/100 [07:56<03:06,  4.91s/it]Best trial: 58. Best value: 0.49078:  62%|██████▏   | 62/100 [08:01<03:06,  4.91s/it]Best trial: 58. Best value: 0.49078:  63%|██████▎   | 63/100 [08:01<02:55,  4.75s/it]Best trial: 58. Best value: 0.49078:  63%|██████▎   | 63/100 [08:07<02:55,  4.75s/it]Best trial: 58. Best value: 0.49078:  64%|██████▍   | 64/100 [08:07<03:03,  5.10s/it]Best trial: 58. Best value: 0.49078:  64%|██████▍   | 64/100 [08:12<03:03,  5.10s/it]Best trial: 58. Best value: 0.49078:  65%|██████▌   | 65/100 [08:12<03:02,  5.21s/it]Best trial: 58. Best value: 0.49078:  65%|██████▌   | 65/100 [08:18<03:02,  5.21s/it]Best trial: 58. Best value: 0.49078:  66%|██████▌   | 66/100 [08:18<03:02,  5.36s/it]Best trial: 58. Best value: 0.49078:  66%|██████▌   | 66/100 [08:22<03:02,  5.36s/it]Best trial: 58. Best value: 0.49078:  67%|██████▋   | 67/100 [08:22<02:51,  5.18s/it]Best trial: 67. Best value: 0.492891:  67%|██████▋   | 67/100 [08:28<02:51,  5.18s/it]Best trial: 67. Best value: 0.492891:  68%|██████▊   | 68/100 [08:28<02:49,  5.30s/it]Best trial: 67. Best value: 0.492891:  68%|██████▊   | 68/100 [08:35<02:49,  5.30s/it]Best trial: 67. Best value: 0.492891:  69%|██████▉   | 69/100 [08:35<03:04,  5.94s/it]Best trial: 67. Best value: 0.492891:  69%|██████▉   | 69/100 [08:40<03:04,  5.94s/it]Best trial: 67. Best value: 0.492891:  70%|███████   | 70/100 [08:40<02:44,  5.47s/it]Best trial: 67. Best value: 0.492891:  70%|███████   | 70/100 [08:49<02:44,  5.47s/it]Best trial: 67. Best value: 0.492891:  71%|███████   | 71/100 [08:49<03:11,  6.60s/it]Best trial: 67. Best value: 0.492891:  71%|███████   | 71/100 [08:54<03:11,  6.60s/it]Best trial: 67. Best value: 0.492891:  72%|███████▏  | 72/100 [08:54<02:47,  5.99s/it]Best trial: 72. Best value: 0.497188:  72%|███████▏  | 72/100 [08:58<02:47,  5.99s/it]Best trial: 72. Best value: 0.497188:  73%|███████▎  | 73/100 [08:58<02:30,  5.57s/it]Best trial: 72. Best value: 0.497188:  73%|███████▎  | 73/100 [09:03<02:30,  5.57s/it]Best trial: 72. Best value: 0.497188:  74%|███████▍  | 74/100 [09:03<02:15,  5.21s/it]Best trial: 72. Best value: 0.497188:  74%|███████▍  | 74/100 [09:07<02:15,  5.21s/it]Best trial: 72. Best value: 0.497188:  75%|███████▌  | 75/100 [09:07<02:02,  4.89s/it]Best trial: 72. Best value: 0.497188:  75%|███████▌  | 75/100 [09:11<02:02,  4.89s/it]Best trial: 72. Best value: 0.497188:  76%|███████▌  | 76/100 [09:11<01:50,  4.58s/it]Best trial: 72. Best value: 0.497188:  76%|███████▌  | 76/100 [09:16<01:50,  4.58s/it]Best trial: 72. Best value: 0.497188:  77%|███████▋  | 77/100 [09:16<01:51,  4.84s/it]Best trial: 72. Best value: 0.497188:  77%|███████▋  | 77/100 [09:21<01:51,  4.84s/it]Best trial: 72. Best value: 0.497188:  78%|███████▊  | 78/100 [09:21<01:50,  5.01s/it]Best trial: 72. Best value: 0.497188:  78%|███████▊  | 78/100 [09:28<01:50,  5.01s/it]Best trial: 72. Best value: 0.497188:  79%|███████▉  | 79/100 [09:28<01:55,  5.50s/it]Best trial: 72. Best value: 0.497188:  79%|███████▉  | 79/100 [09:33<01:55,  5.50s/it]Best trial: 72. Best value: 0.497188:  80%|████████  | 80/100 [09:33<01:46,  5.33s/it]Best trial: 72. Best value: 0.497188:  80%|████████  | 80/100 [09:38<01:46,  5.33s/it]Best trial: 72. Best value: 0.497188:  81%|████████  | 81/100 [09:38<01:36,  5.10s/it]Best trial: 72. Best value: 0.497188:  81%|████████  | 81/100 [09:42<01:36,  5.10s/it]Best trial: 72. Best value: 0.497188:  82%|████████▏ | 82/100 [09:42<01:28,  4.90s/it]Best trial: 72. Best value: 0.497188:  82%|████████▏ | 82/100 [09:47<01:28,  4.90s/it]Best trial: 72. Best value: 0.497188:  83%|████████▎ | 83/100 [09:47<01:21,  4.77s/it]Best trial: 72. Best value: 0.497188:  83%|████████▎ | 83/100 [09:51<01:21,  4.77s/it]Best trial: 72. Best value: 0.497188:  84%|████████▍ | 84/100 [09:51<01:15,  4.73s/it]Best trial: 84. Best value: 0.499629:  84%|████████▍ | 84/100 [09:57<01:15,  4.73s/it]Best trial: 84. Best value: 0.499629:  85%|████████▌ | 85/100 [09:57<01:15,  5.03s/it]Best trial: 84. Best value: 0.499629:  85%|████████▌ | 85/100 [10:04<01:15,  5.03s/it]Best trial: 84. Best value: 0.499629:  86%|████████▌ | 86/100 [10:04<01:20,  5.74s/it]Best trial: 86. Best value: 0.50039:  86%|████████▌ | 86/100 [10:10<01:20,  5.74s/it] Best trial: 86. Best value: 0.50039:  87%|████████▋ | 87/100 [10:10<01:15,  5.84s/it]Best trial: 86. Best value: 0.50039:  87%|████████▋ | 87/100 [10:15<01:15,  5.84s/it]Best trial: 86. Best value: 0.50039:  88%|████████▊ | 88/100 [10:15<01:05,  5.49s/it]Best trial: 86. Best value: 0.50039:  88%|████████▊ | 88/100 [10:21<01:05,  5.49s/it]Best trial: 86. Best value: 0.50039:  89%|████████▉ | 89/100 [10:21<01:02,  5.71s/it]Best trial: 86. Best value: 0.50039:  89%|████████▉ | 89/100 [10:27<01:02,  5.71s/it]Best trial: 86. Best value: 0.50039:  90%|█████████ | 90/100 [10:27<00:57,  5.77s/it]Best trial: 86. Best value: 0.50039:  90%|█████████ | 90/100 [10:33<00:57,  5.77s/it]Best trial: 86. Best value: 0.50039:  91%|█████████ | 91/100 [10:33<00:51,  5.73s/it]Best trial: 86. Best value: 0.50039:  91%|█████████ | 91/100 [10:37<00:51,  5.73s/it]Best trial: 86. Best value: 0.50039:  92%|█████████▏| 92/100 [10:37<00:42,  5.30s/it]Best trial: 86. Best value: 0.50039:  92%|█████████▏| 92/100 [10:42<00:42,  5.30s/it]Best trial: 86. Best value: 0.50039:  93%|█████████▎| 93/100 [10:42<00:36,  5.16s/it]Best trial: 86. Best value: 0.50039:  93%|█████████▎| 93/100 [10:46<00:36,  5.16s/it]Best trial: 86. Best value: 0.50039:  94%|█████████▍| 94/100 [10:46<00:28,  4.75s/it]Best trial: 86. Best value: 0.50039:  94%|█████████▍| 94/100 [10:50<00:28,  4.75s/it]Best trial: 86. Best value: 0.50039:  95%|█████████▌| 95/100 [10:50<00:22,  4.56s/it]Best trial: 86. Best value: 0.50039:  95%|█████████▌| 95/100 [10:56<00:22,  4.56s/it]Best trial: 86. Best value: 0.50039:  96%|█████████▌| 96/100 [10:56<00:19,  4.92s/it]Best trial: 86. Best value: 0.50039:  96%|█████████▌| 96/100 [11:01<00:19,  4.92s/it]Best trial: 86. Best value: 0.50039:  97%|█████████▋| 97/100 [11:01<00:15,  5.02s/it]Best trial: 86. Best value: 0.50039:  97%|█████████▋| 97/100 [11:08<00:15,  5.02s/it]Best trial: 86. Best value: 0.50039:  98%|█████████▊| 98/100 [11:08<00:11,  5.60s/it]Best trial: 86. Best value: 0.50039:  98%|█████████▊| 98/100 [11:11<00:11,  5.60s/it]Best trial: 86. Best value: 0.50039:  99%|█████████▉| 99/100 [11:11<00:04,  4.98s/it]Best trial: 86. Best value: 0.50039:  99%|█████████▉| 99/100 [11:16<00:04,  4.98s/it]Best trial: 86. Best value: 0.50039: 100%|██████████| 100/100 [11:16<00:00,  4.91s/it]Best trial: 86. Best value: 0.50039: 100%|██████████| 100/100 [11:16<00:00,  6.77s/it]
2025-11-30 10:55:04,226 - INFO - HPO Complete. Best AUPRC: 0.5004
2025-11-30 10:55:04,226 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.04250443398982288, 'max_depth': 3, 'subsample': 0.9555503344841356, 'colsample_bytree': 0.7407436400048059, 'gamma': 2.6784051075431483, 'reg_lambda': 0.9227531762055282, 'reg_alpha': 0.8478845243916151}
2025-11-30 10:55:04,226 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 10:55:06,166 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 10:55:06,167 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:55:06,369 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:55:06,432 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:55:06,446 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 10:55:06,446 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 10:55:06,446 - INFO - Training model...
2025-11-30 10:55:08,315 - INFO - Evaluating model with bootstrapping...
2025-11-30 10:55:14,756 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 10:55:14,756 - INFO - AUROC: 0.7708 (0.6777 - 0.8548)
2025-11-30 10:55:14,756 - INFO - AUPRC: 0.4066 (0.2158 - 0.5693)
2025-11-30 10:55:14,756 - INFO - Brier Score: 0.0519 (0.0408 - 0.0632)
2025-11-30 10:55:14,757 - INFO - Accuracy: 0.9523 (0.9382 - 0.9731)
2025-11-30 10:55:14,757 - INFO - Precision: 0.5600 (0.4181 - 1.0000)
2025-11-30 10:55:14,757 - INFO - Sensitivity (Recall): 0.3889 (0.2108 - 0.5419)
2025-11-30 10:55:14,757 - INFO - F1-Score: 0.4590 (0.3154 - 0.6067)
2025-11-30 10:55:14,757 - INFO - Best Threshold: 0.5200 (0.4600 - 0.8000)
2025-11-30 10:55:14,757 - INFO - Specificity: 0.9832 (0.9751 - 1.0000)
2025-11-30 10:55:14,764 - INFO - Calculating SHAP values...
2025-11-30 10:55:15,791 - INFO - SHAP plots saved.
2025-11-30 10:55:15,792 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 10:55:17,059 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 10:55:17,059 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 10:55:17,298 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 10:55:17,369 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 10:55:17,382 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 10:55:17,382 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.47214:   0%|          | 0/100 [00:09<?, ?it/s]Best trial: 0. Best value: 0.47214:   1%|          | 1/100 [00:09<14:57,  9.06s/it]Best trial: 1. Best value: 0.473024:   1%|          | 1/100 [00:24<14:57,  9.06s/it]Best trial: 1. Best value: 0.473024:   2%|▏         | 2/100 [00:24<21:04, 12.90s/it]Best trial: 1. Best value: 0.473024:   2%|▏         | 2/100 [00:41<21:04, 12.90s/it]Best trial: 1. Best value: 0.473024:   3%|▎         | 3/100 [00:41<23:52, 14.76s/it]Best trial: 1. Best value: 0.473024:   3%|▎         | 3/100 [00:51<23:52, 14.76s/it]Best trial: 1. Best value: 0.473024:   4%|▍         | 4/100 [00:51<20:49, 13.01s/it]Best trial: 4. Best value: 0.479953:   4%|▍         | 4/100 [00:56<20:49, 13.01s/it]Best trial: 4. Best value: 0.479953:   5%|▌         | 5/100 [00:56<15:55, 10.06s/it]Best trial: 4. Best value: 0.479953:   5%|▌         | 5/100 [01:01<15:55, 10.06s/it]Best trial: 4. Best value: 0.479953:   6%|▌         | 6/100 [01:01<13:00,  8.30s/it]Best trial: 4. Best value: 0.479953:   6%|▌         | 6/100 [01:09<13:00,  8.30s/it]Best trial: 4. Best value: 0.479953:   7%|▋         | 7/100 [01:09<12:36,  8.13s/it]Best trial: 4. Best value: 0.479953:   7%|▋         | 7/100 [01:23<12:36,  8.13s/it]Best trial: 4. Best value: 0.479953:   8%|▊         | 8/100 [01:23<15:21, 10.02s/it]Best trial: 4. Best value: 0.479953:   8%|▊         | 8/100 [01:36<15:21, 10.02s/it]Best trial: 4. Best value: 0.479953:   9%|▉         | 9/100 [01:36<16:26, 10.84s/it]Best trial: 9. Best value: 0.498136:   9%|▉         | 9/100 [01:40<16:26, 10.84s/it]Best trial: 9. Best value: 0.498136:  10%|█         | 10/100 [01:40<13:09,  8.77s/it]Best trial: 9. Best value: 0.498136:  10%|█         | 10/100 [01:44<13:09,  8.77s/it]Best trial: 9. Best value: 0.498136:  11%|█         | 11/100 [01:44<10:55,  7.37s/it]Best trial: 9. Best value: 0.498136:  11%|█         | 11/100 [01:48<10:55,  7.37s/it]Best trial: 9. Best value: 0.498136:  12%|█▏        | 12/100 [01:48<09:16,  6.32s/it]Best trial: 9. Best value: 0.498136:  12%|█▏        | 12/100 [01:55<09:16,  6.32s/it]Best trial: 9. Best value: 0.498136:  13%|█▎        | 13/100 [01:55<09:23,  6.48s/it]Best trial: 9. Best value: 0.498136:  13%|█▎        | 13/100 [02:00<09:23,  6.48s/it]Best trial: 9. Best value: 0.498136:  14%|█▍        | 14/100 [02:00<08:46,  6.12s/it]Best trial: 9. Best value: 0.498136:  14%|█▍        | 14/100 [02:05<08:46,  6.12s/it]Best trial: 9. Best value: 0.498136:  15%|█▌        | 15/100 [02:05<08:05,  5.72s/it]Best trial: 9. Best value: 0.498136:  15%|█▌        | 15/100 [02:13<08:05,  5.72s/it]Best trial: 9. Best value: 0.498136:  16%|█▌        | 16/100 [02:13<08:58,  6.41s/it]Best trial: 9. Best value: 0.498136:  16%|█▌        | 16/100 [02:29<08:58,  6.41s/it]Best trial: 9. Best value: 0.498136:  17%|█▋        | 17/100 [02:29<12:42,  9.19s/it]Best trial: 9. Best value: 0.498136:  17%|█▋        | 17/100 [02:36<12:42,  9.19s/it]Best trial: 9. Best value: 0.498136:  18%|█▊        | 18/100 [02:36<11:57,  8.75s/it]Best trial: 9. Best value: 0.498136:  18%|█▊        | 18/100 [02:52<11:57,  8.75s/it]Best trial: 9. Best value: 0.498136:  19%|█▉        | 19/100 [02:52<14:30, 10.75s/it]Best trial: 9. Best value: 0.498136:  19%|█▉        | 19/100 [02:56<14:30, 10.75s/it]Best trial: 9. Best value: 0.498136:  20%|██        | 20/100 [02:56<11:37,  8.72s/it]Best trial: 9. Best value: 0.498136:  20%|██        | 20/100 [03:00<11:37,  8.72s/it]Best trial: 9. Best value: 0.498136:  21%|██        | 21/100 [03:00<09:52,  7.50s/it]Best trial: 9. Best value: 0.498136:  21%|██        | 21/100 [03:04<09:52,  7.50s/it]Best trial: 9. Best value: 0.498136:  22%|██▏       | 22/100 [03:04<08:25,  6.48s/it]Best trial: 9. Best value: 0.498136:  22%|██▏       | 22/100 [03:09<08:25,  6.48s/it]Best trial: 9. Best value: 0.498136:  23%|██▎       | 23/100 [03:09<07:33,  5.89s/it]Best trial: 9. Best value: 0.498136:  23%|██▎       | 23/100 [03:14<07:33,  5.89s/it]Best trial: 9. Best value: 0.498136:  24%|██▍       | 24/100 [03:14<07:09,  5.65s/it]Best trial: 9. Best value: 0.498136:  24%|██▍       | 24/100 [03:21<07:09,  5.65s/it]Best trial: 9. Best value: 0.498136:  25%|██▌       | 25/100 [03:21<07:36,  6.09s/it]Best trial: 9. Best value: 0.498136:  25%|██▌       | 25/100 [03:25<07:36,  6.09s/it]Best trial: 9. Best value: 0.498136:  26%|██▌       | 26/100 [03:25<06:47,  5.50s/it]Best trial: 9. Best value: 0.498136:  26%|██▌       | 26/100 [03:30<06:47,  5.50s/it]Best trial: 9. Best value: 0.498136:  27%|██▋       | 27/100 [03:30<06:25,  5.28s/it]Best trial: 9. Best value: 0.498136:  27%|██▋       | 27/100 [03:38<06:25,  5.28s/it]Best trial: 9. Best value: 0.498136:  28%|██▊       | 28/100 [03:38<07:11,  5.99s/it]Best trial: 9. Best value: 0.498136:  28%|██▊       | 28/100 [03:42<07:11,  5.99s/it]Best trial: 9. Best value: 0.498136:  29%|██▉       | 29/100 [03:42<06:29,  5.49s/it]Best trial: 9. Best value: 0.498136:  29%|██▉       | 29/100 [03:48<06:29,  5.49s/it]Best trial: 9. Best value: 0.498136:  30%|███       | 30/100 [03:48<06:45,  5.79s/it]Best trial: 9. Best value: 0.498136:  30%|███       | 30/100 [03:57<06:45,  5.79s/it]Best trial: 9. Best value: 0.498136:  31%|███       | 31/100 [03:57<07:46,  6.76s/it]Best trial: 9. Best value: 0.498136:  31%|███       | 31/100 [04:04<07:46,  6.76s/it]Best trial: 9. Best value: 0.498136:  32%|███▏      | 32/100 [04:04<07:29,  6.61s/it]Best trial: 9. Best value: 0.498136:  32%|███▏      | 32/100 [04:09<07:29,  6.61s/it]Best trial: 9. Best value: 0.498136:  33%|███▎      | 33/100 [04:09<07:02,  6.30s/it]Best trial: 9. Best value: 0.498136:  33%|███▎      | 33/100 [04:13<07:02,  6.30s/it]Best trial: 9. Best value: 0.498136:  34%|███▍      | 34/100 [04:13<06:10,  5.61s/it]Best trial: 9. Best value: 0.498136:  34%|███▍      | 34/100 [04:20<06:10,  5.61s/it]Best trial: 9. Best value: 0.498136:  35%|███▌      | 35/100 [04:20<06:19,  5.84s/it]Best trial: 9. Best value: 0.498136:  35%|███▌      | 35/100 [04:24<06:19,  5.84s/it]Best trial: 9. Best value: 0.498136:  36%|███▌      | 36/100 [04:24<05:37,  5.27s/it]Best trial: 9. Best value: 0.498136:  36%|███▌      | 36/100 [04:35<05:37,  5.27s/it]Best trial: 9. Best value: 0.498136:  37%|███▋      | 37/100 [04:35<07:29,  7.14s/it]Best trial: 9. Best value: 0.498136:  37%|███▋      | 37/100 [04:41<07:29,  7.14s/it]Best trial: 9. Best value: 0.498136:  38%|███▊      | 38/100 [04:41<06:53,  6.67s/it]Best trial: 9. Best value: 0.498136:  38%|███▊      | 38/100 [04:45<06:53,  6.67s/it]Best trial: 9. Best value: 0.498136:  39%|███▉      | 39/100 [04:45<06:09,  6.06s/it]Best trial: 39. Best value: 0.499403:  39%|███▉      | 39/100 [04:50<06:09,  6.06s/it]Best trial: 39. Best value: 0.499403:  40%|████      | 40/100 [04:50<05:35,  5.59s/it]Best trial: 39. Best value: 0.499403:  40%|████      | 40/100 [04:55<05:35,  5.59s/it]Best trial: 39. Best value: 0.499403:  41%|████      | 41/100 [04:55<05:22,  5.47s/it]Best trial: 39. Best value: 0.499403:  41%|████      | 41/100 [05:01<05:22,  5.47s/it]Best trial: 39. Best value: 0.499403:  42%|████▏     | 42/100 [05:01<05:18,  5.50s/it]Best trial: 39. Best value: 0.499403:  42%|████▏     | 42/100 [05:05<05:18,  5.50s/it]Best trial: 39. Best value: 0.499403:  43%|████▎     | 43/100 [05:05<05:00,  5.28s/it]Best trial: 39. Best value: 0.499403:  43%|████▎     | 43/100 [05:10<05:00,  5.28s/it]Best trial: 39. Best value: 0.499403:  44%|████▍     | 44/100 [05:10<04:42,  5.04s/it]Best trial: 39. Best value: 0.499403:  44%|████▍     | 44/100 [05:23<04:42,  5.04s/it]Best trial: 39. Best value: 0.499403:  45%|████▌     | 45/100 [05:23<06:47,  7.41s/it]Best trial: 39. Best value: 0.499403:  45%|████▌     | 45/100 [05:28<06:47,  7.41s/it]Best trial: 39. Best value: 0.499403:  46%|████▌     | 46/100 [05:28<05:59,  6.66s/it]Best trial: 39. Best value: 0.499403:  46%|████▌     | 46/100 [05:32<05:59,  6.66s/it]Best trial: 39. Best value: 0.499403:  47%|████▋     | 47/100 [05:32<05:20,  6.05s/it]Best trial: 39. Best value: 0.499403:  47%|████▋     | 47/100 [05:38<05:20,  6.05s/it]Best trial: 39. Best value: 0.499403:  48%|████▊     | 48/100 [05:38<05:11,  5.99s/it]Best trial: 48. Best value: 0.501834:  48%|████▊     | 48/100 [05:43<05:11,  5.99s/it]Best trial: 48. Best value: 0.501834:  49%|████▉     | 49/100 [05:43<04:42,  5.54s/it]Best trial: 48. Best value: 0.501834:  49%|████▉     | 49/100 [05:47<04:42,  5.54s/it]Best trial: 48. Best value: 0.501834:  50%|█████     | 50/100 [05:47<04:17,  5.16s/it]Best trial: 48. Best value: 0.501834:  50%|█████     | 50/100 [05:53<04:17,  5.16s/it]Best trial: 48. Best value: 0.501834:  51%|█████     | 51/100 [05:53<04:30,  5.51s/it]Best trial: 48. Best value: 0.501834:  51%|█████     | 51/100 [05:57<04:30,  5.51s/it]Best trial: 48. Best value: 0.501834:  52%|█████▏    | 52/100 [05:57<04:04,  5.09s/it]Best trial: 48. Best value: 0.501834:  52%|█████▏    | 52/100 [06:02<04:04,  5.09s/it]Best trial: 48. Best value: 0.501834:  53%|█████▎    | 53/100 [06:02<03:53,  4.97s/it]Best trial: 48. Best value: 0.501834:  53%|█████▎    | 53/100 [06:06<03:53,  4.97s/it]Best trial: 48. Best value: 0.501834:  54%|█████▍    | 54/100 [06:06<03:34,  4.67s/it]Best trial: 48. Best value: 0.501834:  54%|█████▍    | 54/100 [06:12<03:34,  4.67s/it]Best trial: 48. Best value: 0.501834:  55%|█████▌    | 55/100 [06:12<03:49,  5.09s/it]Best trial: 48. Best value: 0.501834:  55%|█████▌    | 55/100 [06:17<03:49,  5.09s/it]Best trial: 48. Best value: 0.501834:  56%|█████▌    | 56/100 [06:17<03:36,  4.92s/it]Best trial: 48. Best value: 0.501834:  56%|█████▌    | 56/100 [06:22<03:36,  4.92s/it]Best trial: 48. Best value: 0.501834:  57%|█████▋    | 57/100 [06:22<03:38,  5.09s/it]Best trial: 48. Best value: 0.501834:  57%|█████▋    | 57/100 [06:28<03:38,  5.09s/it]Best trial: 48. Best value: 0.501834:  58%|█████▊    | 58/100 [06:28<03:41,  5.27s/it]Best trial: 48. Best value: 0.501834:  58%|█████▊    | 58/100 [06:33<03:41,  5.27s/it]Best trial: 48. Best value: 0.501834:  59%|█████▉    | 59/100 [06:33<03:40,  5.38s/it]Best trial: 48. Best value: 0.501834:  59%|█████▉    | 59/100 [06:38<03:40,  5.38s/it]Best trial: 48. Best value: 0.501834:  60%|██████    | 60/100 [06:38<03:28,  5.22s/it]Best trial: 48. Best value: 0.501834:  60%|██████    | 60/100 [06:43<03:28,  5.22s/it]Best trial: 48. Best value: 0.501834:  61%|██████    | 61/100 [06:43<03:11,  4.91s/it]Best trial: 48. Best value: 0.501834:  61%|██████    | 61/100 [06:47<03:11,  4.91s/it]Best trial: 48. Best value: 0.501834:  62%|██████▏   | 62/100 [06:47<03:02,  4.80s/it]Best trial: 48. Best value: 0.501834:  62%|██████▏   | 62/100 [06:51<03:02,  4.80s/it]Best trial: 48. Best value: 0.501834:  63%|██████▎   | 63/100 [06:51<02:52,  4.65s/it]Best trial: 48. Best value: 0.501834:  63%|██████▎   | 63/100 [06:57<02:52,  4.65s/it]Best trial: 48. Best value: 0.501834:  64%|██████▍   | 64/100 [06:57<03:00,  5.00s/it]Best trial: 64. Best value: 0.502305:  64%|██████▍   | 64/100 [07:02<03:00,  5.00s/it]Best trial: 64. Best value: 0.502305:  65%|██████▌   | 65/100 [07:02<02:52,  4.92s/it]Best trial: 64. Best value: 0.502305:  65%|██████▌   | 65/100 [07:06<02:52,  4.92s/it]Best trial: 64. Best value: 0.502305:  66%|██████▌   | 66/100 [07:06<02:40,  4.72s/it]Best trial: 64. Best value: 0.502305:  66%|██████▌   | 66/100 [07:11<02:40,  4.72s/it]Best trial: 64. Best value: 0.502305:  67%|██████▋   | 67/100 [07:11<02:38,  4.80s/it]Best trial: 64. Best value: 0.502305:  67%|██████▋   | 67/100 [07:25<02:38,  4.80s/it]Best trial: 64. Best value: 0.502305:  68%|██████▊   | 68/100 [07:25<03:58,  7.45s/it]Best trial: 64. Best value: 0.502305:  68%|██████▊   | 68/100 [07:36<03:58,  7.45s/it]Best trial: 64. Best value: 0.502305:  69%|██████▉   | 69/100 [07:36<04:25,  8.55s/it]Best trial: 64. Best value: 0.502305:  69%|██████▉   | 69/100 [07:49<04:25,  8.55s/it]Best trial: 64. Best value: 0.502305:  70%|███████   | 70/100 [07:49<05:01, 10.06s/it]Best trial: 64. Best value: 0.502305:  70%|███████   | 70/100 [08:01<05:01, 10.06s/it]Best trial: 64. Best value: 0.502305:  71%|███████   | 71/100 [08:01<05:07, 10.61s/it]Best trial: 71. Best value: 0.505915:  71%|███████   | 71/100 [08:06<05:07, 10.61s/it]Best trial: 71. Best value: 0.505915:  72%|███████▏  | 72/100 [08:06<04:07,  8.84s/it]Best trial: 71. Best value: 0.505915:  72%|███████▏  | 72/100 [08:10<04:07,  8.84s/it]Best trial: 71. Best value: 0.505915:  73%|███████▎  | 73/100 [08:10<03:18,  7.36s/it]Best trial: 71. Best value: 0.505915:  73%|███████▎  | 73/100 [08:15<03:18,  7.36s/it]Best trial: 71. Best value: 0.505915:  74%|███████▍  | 74/100 [08:15<02:52,  6.64s/it]Best trial: 71. Best value: 0.505915:  74%|███████▍  | 74/100 [08:19<02:52,  6.64s/it]Best trial: 71. Best value: 0.505915:  75%|███████▌  | 75/100 [08:19<02:26,  5.88s/it]Best trial: 71. Best value: 0.505915:  75%|███████▌  | 75/100 [08:23<02:26,  5.88s/it]Best trial: 71. Best value: 0.505915:  76%|███████▌  | 76/100 [08:23<02:06,  5.27s/it]Best trial: 71. Best value: 0.505915:  76%|███████▌  | 76/100 [08:28<02:06,  5.27s/it]Best trial: 71. Best value: 0.505915:  77%|███████▋  | 77/100 [08:28<02:02,  5.32s/it]Best trial: 71. Best value: 0.505915:  77%|███████▋  | 77/100 [08:35<02:02,  5.32s/it]Best trial: 71. Best value: 0.505915:  78%|███████▊  | 78/100 [08:35<02:04,  5.65s/it]Best trial: 71. Best value: 0.505915:  78%|███████▊  | 78/100 [08:39<02:04,  5.65s/it]Best trial: 71. Best value: 0.505915:  79%|███████▉  | 79/100 [08:39<01:51,  5.29s/it]Best trial: 71. Best value: 0.505915:  79%|███████▉  | 79/100 [08:45<01:51,  5.29s/it]Best trial: 71. Best value: 0.505915:  80%|████████  | 80/100 [08:45<01:50,  5.52s/it]Best trial: 71. Best value: 0.505915:  80%|████████  | 80/100 [08:50<01:50,  5.52s/it]Best trial: 71. Best value: 0.505915:  81%|████████  | 81/100 [08:50<01:38,  5.18s/it]Best trial: 71. Best value: 0.505915:  81%|████████  | 81/100 [08:54<01:38,  5.18s/it]Best trial: 71. Best value: 0.505915:  82%|████████▏ | 82/100 [08:54<01:28,  4.93s/it]Best trial: 71. Best value: 0.505915:  82%|████████▏ | 82/100 [08:59<01:28,  4.93s/it]Best trial: 71. Best value: 0.505915:  83%|████████▎ | 83/100 [08:59<01:22,  4.87s/it]Best trial: 71. Best value: 0.505915:  83%|████████▎ | 83/100 [09:04<01:22,  4.87s/it]Best trial: 71. Best value: 0.505915:  84%|████████▍ | 84/100 [09:04<01:17,  4.87s/it]Best trial: 71. Best value: 0.505915:  84%|████████▍ | 84/100 [09:08<01:17,  4.87s/it]Best trial: 71. Best value: 0.505915:  85%|████████▌ | 85/100 [09:08<01:11,  4.80s/it]Best trial: 71. Best value: 0.505915:  85%|████████▌ | 85/100 [09:15<01:11,  4.80s/it]Best trial: 71. Best value: 0.505915:  86%|████████▌ | 86/100 [09:15<01:15,  5.38s/it]Best trial: 86. Best value: 0.508558:  86%|████████▌ | 86/100 [09:20<01:15,  5.38s/it]Best trial: 86. Best value: 0.508558:  87%|████████▋ | 87/100 [09:20<01:07,  5.23s/it]Best trial: 86. Best value: 0.508558:  87%|████████▋ | 87/100 [09:24<01:07,  5.23s/it]Best trial: 86. Best value: 0.508558:  88%|████████▊ | 88/100 [09:24<01:00,  5.00s/it]Best trial: 86. Best value: 0.508558:  88%|████████▊ | 88/100 [09:30<01:00,  5.00s/it]Best trial: 86. Best value: 0.508558:  89%|████████▉ | 89/100 [09:30<00:56,  5.12s/it]Best trial: 86. Best value: 0.508558:  89%|████████▉ | 89/100 [09:36<00:56,  5.12s/it]Best trial: 86. Best value: 0.508558:  90%|█████████ | 90/100 [09:36<00:54,  5.47s/it]Best trial: 86. Best value: 0.508558:  90%|█████████ | 90/100 [09:42<00:54,  5.47s/it]Best trial: 86. Best value: 0.508558:  91%|█████████ | 91/100 [09:42<00:50,  5.59s/it]Best trial: 86. Best value: 0.508558:  91%|█████████ | 91/100 [09:47<00:50,  5.59s/it]Best trial: 86. Best value: 0.508558:  92%|█████████▏| 92/100 [09:47<00:42,  5.36s/it]Best trial: 86. Best value: 0.508558:  92%|█████████▏| 92/100 [09:51<00:42,  5.36s/it]Best trial: 86. Best value: 0.508558:  93%|█████████▎| 93/100 [09:51<00:35,  5.12s/it]Best trial: 86. Best value: 0.508558:  93%|█████████▎| 93/100 [10:00<00:35,  5.12s/it]Best trial: 86. Best value: 0.508558:  94%|█████████▍| 94/100 [10:00<00:37,  6.20s/it]Best trial: 86. Best value: 0.508558:  94%|█████████▍| 94/100 [10:05<00:37,  6.20s/it]Best trial: 86. Best value: 0.508558:  95%|█████████▌| 95/100 [10:05<00:28,  5.77s/it]Best trial: 86. Best value: 0.508558:  95%|█████████▌| 95/100 [10:10<00:28,  5.77s/it]Best trial: 86. Best value: 0.508558:  96%|█████████▌| 96/100 [10:10<00:22,  5.56s/it]Best trial: 86. Best value: 0.508558:  96%|█████████▌| 96/100 [10:15<00:22,  5.56s/it]Best trial: 86. Best value: 0.508558:  97%|█████████▋| 97/100 [10:15<00:15,  5.33s/it]Best trial: 86. Best value: 0.508558:  97%|█████████▋| 97/100 [10:19<00:15,  5.33s/it]Best trial: 86. Best value: 0.508558:  98%|█████████▊| 98/100 [10:19<00:10,  5.07s/it]Best trial: 86. Best value: 0.508558:  98%|█████████▊| 98/100 [10:26<00:10,  5.07s/it]Best trial: 86. Best value: 0.508558:  99%|█████████▉| 99/100 [10:26<00:05,  5.52s/it]Best trial: 86. Best value: 0.508558:  99%|█████████▉| 99/100 [10:31<00:05,  5.52s/it]Best trial: 86. Best value: 0.508558: 100%|██████████| 100/100 [10:31<00:00,  5.35s/it]Best trial: 86. Best value: 0.508558: 100%|██████████| 100/100 [10:31<00:00,  6.31s/it]
2025-11-30 11:05:48,511 - INFO - HPO Complete. Best AUPRC: 0.5086
2025-11-30 11:05:48,511 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.0005813887046533846, 'max_depth': 3, 'subsample': 0.6697944307044422, 'colsample_bytree': 0.8102139694195544, 'gamma': 0.5712824525203075, 'reg_lambda': 1.5033658057521736e-05, 'reg_alpha': 0.00013571548279017322}
2025-11-30 11:05:48,512 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:05:50,703 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 11:05:50,703 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 11:05:50,938 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 11:05:51,005 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:05:51,023 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 11:05:51,023 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 11:05:51,024 - INFO - Training model...
2025-11-30 11:05:54,939 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:06:01,410 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:06:01,410 - INFO - AUROC: 0.7923 (0.6985 - 0.8625)
2025-11-30 11:06:01,410 - INFO - AUPRC: 0.3931 (0.2818 - 0.5364)
2025-11-30 11:06:01,410 - INFO - Brier Score: 0.1890 (0.1859 - 0.1922)
2025-11-30 11:06:01,410 - INFO - Accuracy: 0.9566 (0.9347 - 0.9728)
2025-11-30 11:06:01,410 - INFO - Precision: 0.6364 (0.3302 - 0.8921)
2025-11-30 11:06:01,410 - INFO - Sensitivity (Recall): 0.3889 (0.2773 - 0.5871)
2025-11-30 11:06:01,410 - INFO - F1-Score: 0.4828 (0.3543 - 0.6359)
2025-11-30 11:06:01,410 - INFO - Best Threshold: 0.5500 (0.5160 - 0.6040)
2025-11-30 11:06:01,410 - INFO - Specificity: 0.9878 (0.9661 - 0.9976)
2025-11-30 11:06:01,424 - INFO - Calculating SHAP values...
2025-11-30 11:06:02,511 - INFO - SHAP plots saved.
2025-11-30 11:06:02,512 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=any_aki | Branch=windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:06:03,664 - INFO - Starting HPO for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 11:06:03,664 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 11:06:03,854 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 11:06:03,919 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:06:03,948 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 11:06:03,948 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.464405:   0%|          | 0/100 [00:11<?, ?it/s]Best trial: 0. Best value: 0.464405:   1%|          | 1/100 [00:11<18:14, 11.06s/it]Best trial: 1. Best value: 0.474607:   1%|          | 1/100 [00:26<18:14, 11.06s/it]Best trial: 1. Best value: 0.474607:   2%|▏         | 2/100 [00:26<22:37, 13.85s/it]Best trial: 2. Best value: 0.480816:   2%|▏         | 2/100 [00:36<22:37, 13.85s/it]Best trial: 2. Best value: 0.480816:   3%|▎         | 3/100 [00:36<19:14, 11.90s/it]Best trial: 3. Best value: 0.495672:   3%|▎         | 3/100 [00:47<19:14, 11.90s/it]Best trial: 3. Best value: 0.495672:   4%|▍         | 4/100 [00:47<18:41, 11.68s/it]Best trial: 3. Best value: 0.495672:   4%|▍         | 4/100 [00:52<18:41, 11.68s/it]Best trial: 3. Best value: 0.495672:   5%|▌         | 5/100 [00:52<14:40,  9.27s/it]Best trial: 3. Best value: 0.495672:   5%|▌         | 5/100 [01:00<14:40,  9.27s/it]Best trial: 3. Best value: 0.495672:   6%|▌         | 6/100 [01:00<13:26,  8.58s/it]Best trial: 3. Best value: 0.495672:   6%|▌         | 6/100 [01:08<13:26,  8.58s/it]Best trial: 3. Best value: 0.495672:   7%|▋         | 7/100 [01:08<13:07,  8.47s/it]Best trial: 3. Best value: 0.495672:   7%|▋         | 7/100 [01:17<13:07,  8.47s/it]Best trial: 3. Best value: 0.495672:   8%|▊         | 8/100 [01:17<13:14,  8.64s/it]Best trial: 3. Best value: 0.495672:   8%|▊         | 8/100 [01:24<13:14,  8.64s/it]Best trial: 3. Best value: 0.495672:   9%|▉         | 9/100 [01:24<12:30,  8.25s/it]Best trial: 3. Best value: 0.495672:   9%|▉         | 9/100 [01:34<12:30,  8.25s/it]Best trial: 3. Best value: 0.495672:  10%|█         | 10/100 [01:34<13:06,  8.74s/it]Best trial: 3. Best value: 0.495672:  10%|█         | 10/100 [01:54<13:06,  8.74s/it]Best trial: 3. Best value: 0.495672:  11%|█         | 11/100 [01:54<17:52, 12.05s/it]Best trial: 3. Best value: 0.495672:  11%|█         | 11/100 [02:02<17:52, 12.05s/it]Best trial: 3. Best value: 0.495672:  12%|█▏        | 12/100 [02:02<16:08, 11.00s/it]Best trial: 3. Best value: 0.495672:  12%|█▏        | 12/100 [02:10<16:08, 11.00s/it]Best trial: 3. Best value: 0.495672:  13%|█▎        | 13/100 [02:10<14:32, 10.02s/it]Best trial: 3. Best value: 0.495672:  13%|█▎        | 13/100 [02:16<14:32, 10.02s/it]Best trial: 3. Best value: 0.495672:  14%|█▍        | 14/100 [02:16<12:35,  8.78s/it]Best trial: 3. Best value: 0.495672:  14%|█▍        | 14/100 [02:25<12:35,  8.78s/it]Best trial: 3. Best value: 0.495672:  15%|█▌        | 15/100 [02:25<12:36,  8.90s/it]Best trial: 3. Best value: 0.495672:  15%|█▌        | 15/100 [02:39<12:36,  8.90s/it]Best trial: 3. Best value: 0.495672:  16%|█▌        | 16/100 [02:39<14:25, 10.31s/it]Best trial: 3. Best value: 0.495672:  16%|█▌        | 16/100 [02:45<14:25, 10.31s/it]Best trial: 3. Best value: 0.495672:  17%|█▋        | 17/100 [02:45<12:38,  9.14s/it]Best trial: 3. Best value: 0.495672:  17%|█▋        | 17/100 [02:50<12:38,  9.14s/it]Best trial: 3. Best value: 0.495672:  18%|█▊        | 18/100 [02:50<10:36,  7.76s/it]Best trial: 3. Best value: 0.495672:  18%|█▊        | 18/100 [03:01<10:36,  7.76s/it]Best trial: 3. Best value: 0.495672:  19%|█▉        | 19/100 [03:01<12:06,  8.97s/it]Best trial: 3. Best value: 0.495672:  19%|█▉        | 19/100 [03:15<12:06,  8.97s/it]Best trial: 3. Best value: 0.495672:  20%|██        | 20/100 [03:15<13:40, 10.26s/it]Best trial: 3. Best value: 0.495672:  20%|██        | 20/100 [03:29<13:40, 10.26s/it]Best trial: 3. Best value: 0.495672:  21%|██        | 21/100 [03:29<15:00, 11.40s/it]Best trial: 3. Best value: 0.495672:  21%|██        | 21/100 [03:36<15:00, 11.40s/it]Best trial: 3. Best value: 0.495672:  22%|██▏       | 22/100 [03:36<13:22, 10.28s/it]Best trial: 3. Best value: 0.495672:  22%|██▏       | 22/100 [03:49<13:22, 10.28s/it]Best trial: 3. Best value: 0.495672:  23%|██▎       | 23/100 [03:49<14:15, 11.12s/it]Best trial: 3. Best value: 0.495672:  23%|██▎       | 23/100 [04:02<14:15, 11.12s/it]Best trial: 3. Best value: 0.495672:  24%|██▍       | 24/100 [04:02<14:27, 11.42s/it]Best trial: 3. Best value: 0.495672:  24%|██▍       | 24/100 [04:12<14:27, 11.42s/it]Best trial: 3. Best value: 0.495672:  25%|██▌       | 25/100 [04:12<14:02, 11.23s/it]Best trial: 3. Best value: 0.495672:  25%|██▌       | 25/100 [04:18<14:02, 11.23s/it]Best trial: 3. Best value: 0.495672:  26%|██▌       | 26/100 [04:18<11:47,  9.56s/it]Best trial: 3. Best value: 0.495672:  26%|██▌       | 26/100 [04:36<11:47,  9.56s/it]Best trial: 3. Best value: 0.495672:  27%|██▋       | 27/100 [04:36<14:38, 12.03s/it]Best trial: 3. Best value: 0.495672:  27%|██▋       | 27/100 [04:45<14:38, 12.03s/it]Best trial: 3. Best value: 0.495672:  28%|██▊       | 28/100 [04:45<13:19, 11.10s/it]Best trial: 3. Best value: 0.495672:  28%|██▊       | 28/100 [04:51<13:19, 11.10s/it]Best trial: 3. Best value: 0.495672:  29%|██▉       | 29/100 [04:51<11:16,  9.54s/it]Best trial: 3. Best value: 0.495672:  29%|██▉       | 29/100 [05:04<11:16,  9.54s/it]Best trial: 3. Best value: 0.495672:  30%|███       | 30/100 [05:04<12:27, 10.67s/it]Best trial: 3. Best value: 0.495672:  30%|███       | 30/100 [05:16<12:27, 10.67s/it]Best trial: 3. Best value: 0.495672:  31%|███       | 31/100 [05:16<12:55, 11.24s/it]Best trial: 3. Best value: 0.495672:  31%|███       | 31/100 [05:24<12:55, 11.24s/it]Best trial: 3. Best value: 0.495672:  32%|███▏      | 32/100 [05:24<11:34, 10.21s/it]Best trial: 3. Best value: 0.495672:  32%|███▏      | 32/100 [05:33<11:34, 10.21s/it]Best trial: 3. Best value: 0.495672:  33%|███▎      | 33/100 [05:33<10:51,  9.73s/it]Best trial: 3. Best value: 0.495672:  33%|███▎      | 33/100 [05:43<10:51,  9.73s/it]Best trial: 3. Best value: 0.495672:  34%|███▍      | 34/100 [05:43<10:57,  9.97s/it]Best trial: 3. Best value: 0.495672:  34%|███▍      | 34/100 [05:58<10:57,  9.97s/it]Best trial: 3. Best value: 0.495672:  35%|███▌      | 35/100 [05:58<12:19, 11.37s/it]Best trial: 3. Best value: 0.495672:  35%|███▌      | 35/100 [06:04<12:19, 11.37s/it]Best trial: 3. Best value: 0.495672:  36%|███▌      | 36/100 [06:04<10:23,  9.74s/it]Best trial: 3. Best value: 0.495672:  36%|███▌      | 36/100 [06:11<10:23,  9.74s/it]Best trial: 3. Best value: 0.495672:  37%|███▋      | 37/100 [06:11<09:13,  8.79s/it]Best trial: 3. Best value: 0.495672:  37%|███▋      | 37/100 [06:15<09:13,  8.79s/it]Best trial: 3. Best value: 0.495672:  38%|███▊      | 38/100 [06:15<07:40,  7.43s/it]Best trial: 3. Best value: 0.495672:  38%|███▊      | 38/100 [06:25<07:40,  7.43s/it]Best trial: 3. Best value: 0.495672:  39%|███▉      | 39/100 [06:25<08:28,  8.33s/it]Best trial: 3. Best value: 0.495672:  39%|███▉      | 39/100 [06:31<08:28,  8.33s/it]Best trial: 3. Best value: 0.495672:  40%|████      | 40/100 [06:31<07:30,  7.52s/it]Best trial: 3. Best value: 0.495672:  40%|████      | 40/100 [06:40<07:30,  7.52s/it]Best trial: 3. Best value: 0.495672:  41%|████      | 41/100 [06:40<07:47,  7.93s/it]Best trial: 3. Best value: 0.495672:  41%|████      | 41/100 [06:51<07:47,  7.93s/it]Best trial: 3. Best value: 0.495672:  42%|████▏     | 42/100 [06:51<08:32,  8.84s/it]Best trial: 3. Best value: 0.495672:  42%|████▏     | 42/100 [07:02<08:32,  8.84s/it]Best trial: 3. Best value: 0.495672:  43%|████▎     | 43/100 [07:02<09:12,  9.69s/it]Best trial: 43. Best value: 0.501232:  43%|████▎     | 43/100 [07:16<09:12,  9.69s/it]Best trial: 43. Best value: 0.501232:  44%|████▍     | 44/100 [07:16<10:09, 10.88s/it]Best trial: 43. Best value: 0.501232:  44%|████▍     | 44/100 [07:32<10:09, 10.88s/it]Best trial: 43. Best value: 0.501232:  45%|████▌     | 45/100 [07:32<11:29, 12.53s/it]Best trial: 43. Best value: 0.501232:  45%|████▌     | 45/100 [07:47<11:29, 12.53s/it]Best trial: 43. Best value: 0.501232:  46%|████▌     | 46/100 [07:47<11:47, 13.10s/it]Best trial: 43. Best value: 0.501232:  46%|████▌     | 46/100 [07:59<11:47, 13.10s/it]Best trial: 43. Best value: 0.501232:  47%|████▋     | 47/100 [07:59<11:22, 12.88s/it]Best trial: 43. Best value: 0.501232:  47%|████▋     | 47/100 [08:12<11:22, 12.88s/it]Best trial: 43. Best value: 0.501232:  48%|████▊     | 48/100 [08:12<11:06, 12.82s/it]Best trial: 43. Best value: 0.501232:  48%|████▊     | 48/100 [08:25<11:06, 12.82s/it]Best trial: 43. Best value: 0.501232:  49%|████▉     | 49/100 [08:25<10:58, 12.91s/it]Best trial: 43. Best value: 0.501232:  49%|████▉     | 49/100 [08:36<10:58, 12.91s/it]Best trial: 43. Best value: 0.501232:  50%|█████     | 50/100 [08:36<10:09, 12.20s/it]Best trial: 43. Best value: 0.501232:  50%|█████     | 50/100 [08:50<10:09, 12.20s/it]Best trial: 43. Best value: 0.501232:  51%|█████     | 51/100 [08:50<10:26, 12.79s/it]Best trial: 43. Best value: 0.501232:  51%|█████     | 51/100 [09:04<10:26, 12.79s/it]Best trial: 43. Best value: 0.501232:  52%|█████▏    | 52/100 [09:04<10:34, 13.23s/it]Best trial: 43. Best value: 0.501232:  52%|█████▏    | 52/100 [09:18<10:34, 13.23s/it]Best trial: 43. Best value: 0.501232:  53%|█████▎    | 53/100 [09:18<10:34, 13.50s/it]Best trial: 43. Best value: 0.501232:  53%|█████▎    | 53/100 [09:31<10:34, 13.50s/it]Best trial: 43. Best value: 0.501232:  54%|█████▍    | 54/100 [09:31<10:08, 13.22s/it]Best trial: 43. Best value: 0.501232:  54%|█████▍    | 54/100 [09:48<10:08, 13.22s/it]Best trial: 43. Best value: 0.501232:  55%|█████▌    | 55/100 [09:48<10:42, 14.28s/it]Best trial: 55. Best value: 0.503686:  55%|█████▌    | 55/100 [09:56<10:42, 14.28s/it]Best trial: 55. Best value: 0.503686:  56%|█████▌    | 56/100 [09:56<09:16, 12.64s/it]Best trial: 55. Best value: 0.503686:  56%|█████▌    | 56/100 [10:06<09:16, 12.64s/it]Best trial: 55. Best value: 0.503686:  57%|█████▋    | 57/100 [10:06<08:26, 11.78s/it]Best trial: 55. Best value: 0.503686:  57%|█████▋    | 57/100 [10:17<08:26, 11.78s/it]Best trial: 55. Best value: 0.503686:  58%|█████▊    | 58/100 [10:17<08:07, 11.61s/it]Best trial: 55. Best value: 0.503686:  58%|█████▊    | 58/100 [10:26<08:07, 11.61s/it]Best trial: 55. Best value: 0.503686:  59%|█████▉    | 59/100 [10:26<07:14, 10.60s/it]Best trial: 55. Best value: 0.503686:  59%|█████▉    | 59/100 [10:37<07:14, 10.60s/it]Best trial: 55. Best value: 0.503686:  60%|██████    | 60/100 [10:37<07:08, 10.72s/it]Best trial: 55. Best value: 0.503686:  60%|██████    | 60/100 [10:47<07:08, 10.72s/it]Best trial: 55. Best value: 0.503686:  61%|██████    | 61/100 [10:47<06:59, 10.75s/it]Best trial: 61. Best value: 0.5064:  61%|██████    | 61/100 [10:58<06:59, 10.75s/it]  Best trial: 61. Best value: 0.5064:  62%|██████▏   | 62/100 [10:58<06:47, 10.72s/it]Best trial: 61. Best value: 0.5064:  62%|██████▏   | 62/100 [11:08<06:47, 10.72s/it]Best trial: 61. Best value: 0.5064:  63%|██████▎   | 63/100 [11:08<06:30, 10.56s/it]Best trial: 61. Best value: 0.5064:  63%|██████▎   | 63/100 [11:18<06:30, 10.56s/it]Best trial: 61. Best value: 0.5064:  64%|██████▍   | 64/100 [11:18<06:08, 10.24s/it]Best trial: 61. Best value: 0.5064:  64%|██████▍   | 64/100 [11:28<06:08, 10.24s/it]Best trial: 61. Best value: 0.5064:  65%|██████▌   | 65/100 [11:28<05:58, 10.24s/it]Best trial: 61. Best value: 0.5064:  65%|██████▌   | 65/100 [11:37<05:58, 10.24s/it]Best trial: 61. Best value: 0.5064:  66%|██████▌   | 66/100 [11:37<05:38,  9.96s/it]Best trial: 61. Best value: 0.5064:  66%|██████▌   | 66/100 [11:46<05:38,  9.96s/it]Best trial: 61. Best value: 0.5064:  67%|██████▋   | 67/100 [11:46<05:12,  9.48s/it]Best trial: 61. Best value: 0.5064:  67%|██████▋   | 67/100 [11:53<05:12,  9.48s/it]Best trial: 61. Best value: 0.5064:  68%|██████▊   | 68/100 [11:53<04:42,  8.83s/it]Best trial: 61. Best value: 0.5064:  68%|██████▊   | 68/100 [12:02<04:42,  8.83s/it]Best trial: 61. Best value: 0.5064:  69%|██████▉   | 69/100 [12:02<04:34,  8.87s/it]Best trial: 61. Best value: 0.5064:  69%|██████▉   | 69/100 [12:09<04:34,  8.87s/it]Best trial: 61. Best value: 0.5064:  70%|███████   | 70/100 [12:09<04:14,  8.48s/it]Best trial: 61. Best value: 0.5064:  70%|███████   | 70/100 [12:21<04:14,  8.48s/it]Best trial: 61. Best value: 0.5064:  71%|███████   | 71/100 [12:21<04:30,  9.31s/it]Best trial: 61. Best value: 0.5064:  71%|███████   | 71/100 [12:31<04:30,  9.31s/it]Best trial: 61. Best value: 0.5064:  72%|███████▏  | 72/100 [12:31<04:25,  9.49s/it]Best trial: 61. Best value: 0.5064:  72%|███████▏  | 72/100 [12:41<04:25,  9.49s/it]Best trial: 61. Best value: 0.5064:  73%|███████▎  | 73/100 [12:41<04:19,  9.61s/it]Best trial: 61. Best value: 0.5064:  73%|███████▎  | 73/100 [12:49<04:19,  9.61s/it]Best trial: 61. Best value: 0.5064:  74%|███████▍  | 74/100 [12:49<03:58,  9.18s/it]Best trial: 61. Best value: 0.5064:  74%|███████▍  | 74/100 [13:00<03:58,  9.18s/it]Best trial: 61. Best value: 0.5064:  75%|███████▌  | 75/100 [13:00<04:06,  9.87s/it]Best trial: 61. Best value: 0.5064:  75%|███████▌  | 75/100 [13:10<04:06,  9.87s/it]Best trial: 61. Best value: 0.5064:  76%|███████▌  | 76/100 [13:10<03:56,  9.85s/it]Best trial: 61. Best value: 0.5064:  76%|███████▌  | 76/100 [13:21<03:56,  9.85s/it]Best trial: 61. Best value: 0.5064:  77%|███████▋  | 77/100 [13:21<03:53, 10.14s/it]Best trial: 61. Best value: 0.5064:  77%|███████▋  | 77/100 [13:30<03:53, 10.14s/it]Best trial: 61. Best value: 0.5064:  78%|███████▊  | 78/100 [13:30<03:34,  9.74s/it]Best trial: 61. Best value: 0.5064:  78%|███████▊  | 78/100 [13:44<03:34,  9.74s/it]Best trial: 61. Best value: 0.5064:  79%|███████▉  | 79/100 [13:44<03:52, 11.07s/it]Best trial: 61. Best value: 0.5064:  79%|███████▉  | 79/100 [14:04<03:52, 11.07s/it]Best trial: 61. Best value: 0.5064:  80%|████████  | 80/100 [14:04<04:37, 13.89s/it]Best trial: 61. Best value: 0.5064:  80%|████████  | 80/100 [14:13<04:37, 13.89s/it]Best trial: 61. Best value: 0.5064:  81%|████████  | 81/100 [14:13<03:56, 12.45s/it]Best trial: 61. Best value: 0.5064:  81%|████████  | 81/100 [14:23<03:56, 12.45s/it]Best trial: 61. Best value: 0.5064:  82%|████████▏ | 82/100 [14:23<03:31, 11.75s/it]Best trial: 61. Best value: 0.5064:  82%|████████▏ | 82/100 [14:36<03:31, 11.75s/it]Best trial: 61. Best value: 0.5064:  83%|████████▎ | 83/100 [14:36<03:23, 11.97s/it]Best trial: 61. Best value: 0.5064:  83%|████████▎ | 83/100 [14:47<03:23, 11.97s/it]Best trial: 61. Best value: 0.5064:  84%|████████▍ | 84/100 [14:47<03:09, 11.85s/it]Best trial: 61. Best value: 0.5064:  84%|████████▍ | 84/100 [14:59<03:09, 11.85s/it]Best trial: 61. Best value: 0.5064:  85%|████████▌ | 85/100 [14:59<02:56, 11.77s/it]Best trial: 61. Best value: 0.5064:  85%|████████▌ | 85/100 [15:13<02:56, 11.77s/it]Best trial: 61. Best value: 0.5064:  86%|████████▌ | 86/100 [15:13<02:54, 12.50s/it]Best trial: 61. Best value: 0.5064:  86%|████████▌ | 86/100 [15:22<02:54, 12.50s/it]Best trial: 61. Best value: 0.5064:  87%|████████▋ | 87/100 [15:22<02:29, 11.51s/it]Best trial: 61. Best value: 0.5064:  87%|████████▋ | 87/100 [15:29<02:29, 11.51s/it]Best trial: 61. Best value: 0.5064:  88%|████████▊ | 88/100 [15:29<02:00, 10.07s/it]Best trial: 61. Best value: 0.5064:  88%|████████▊ | 88/100 [15:40<02:00, 10.07s/it]Best trial: 61. Best value: 0.5064:  89%|████████▉ | 89/100 [15:40<01:54, 10.37s/it]Best trial: 61. Best value: 0.5064:  89%|████████▉ | 89/100 [15:50<01:54, 10.37s/it]Best trial: 61. Best value: 0.5064:  90%|█████████ | 90/100 [15:50<01:42, 10.29s/it]Best trial: 61. Best value: 0.5064:  90%|█████████ | 90/100 [16:07<01:42, 10.29s/it]Best trial: 61. Best value: 0.5064:  91%|█████████ | 91/100 [16:07<01:50, 12.33s/it]Best trial: 61. Best value: 0.5064:  91%|█████████ | 91/100 [16:17<01:50, 12.33s/it]Best trial: 61. Best value: 0.5064:  92%|█████████▏| 92/100 [16:17<01:31, 11.43s/it]Best trial: 61. Best value: 0.5064:  92%|█████████▏| 92/100 [16:26<01:31, 11.43s/it]Best trial: 61. Best value: 0.5064:  93%|█████████▎| 93/100 [16:26<01:16, 10.87s/it]Best trial: 61. Best value: 0.5064:  93%|█████████▎| 93/100 [16:35<01:16, 10.87s/it]Best trial: 61. Best value: 0.5064:  94%|█████████▍| 94/100 [16:35<01:02, 10.34s/it]Best trial: 61. Best value: 0.5064:  94%|█████████▍| 94/100 [16:45<01:02, 10.34s/it]Best trial: 61. Best value: 0.5064:  95%|█████████▌| 95/100 [16:45<00:50, 10.18s/it]Best trial: 61. Best value: 0.5064:  95%|█████████▌| 95/100 [16:56<00:50, 10.18s/it]Best trial: 61. Best value: 0.5064:  96%|█████████▌| 96/100 [16:56<00:40, 10.24s/it]Best trial: 61. Best value: 0.5064:  96%|█████████▌| 96/100 [17:08<00:40, 10.24s/it]Best trial: 61. Best value: 0.5064:  97%|█████████▋| 97/100 [17:08<00:32, 10.75s/it]Best trial: 61. Best value: 0.5064:  97%|█████████▋| 97/100 [17:18<00:32, 10.75s/it]Best trial: 61. Best value: 0.5064:  98%|█████████▊| 98/100 [17:18<00:21, 10.52s/it]Best trial: 61. Best value: 0.5064:  98%|█████████▊| 98/100 [17:29<00:21, 10.52s/it]Best trial: 61. Best value: 0.5064:  99%|█████████▉| 99/100 [17:29<00:10, 10.66s/it]Best trial: 61. Best value: 0.5064:  99%|█████████▉| 99/100 [17:42<00:10, 10.66s/it]Best trial: 61. Best value: 0.5064: 100%|██████████| 100/100 [17:42<00:00, 11.65s/it]Best trial: 61. Best value: 0.5064: 100%|██████████| 100/100 [17:42<00:00, 10.63s/it]
2025-11-30 11:23:46,944 - INFO - HPO Complete. Best AUPRC: 0.5064
2025-11-30 11:23:46,944 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.00014205604607911442, 'max_depth': 7, 'subsample': 0.8388958056717277, 'colsample_bytree': 0.6230678295040303, 'gamma': 2.650782466423418, 'reg_lambda': 0.6900971309276026, 'reg_alpha': 0.002026794331148321}
2025-11-30 11:23:46,945 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/any_aki/windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:23:48,935 - INFO - Starting Training/Evaluation for Outcome: any_aki, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 11:23:48,936 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 11:23:49,151 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 11:23:49,218 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:23:49,232 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 11:23:49,232 - INFO - Positive samples in train: 149, Negative: 2612, Scale Pos Weight: 17.5302
2025-11-30 11:23:49,232 - INFO - Training model...
2025-11-30 11:23:53,650 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:24:00,157 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:24:00,157 - INFO - AUROC: 0.8034 (0.7212 - 0.8708)
2025-11-30 11:24:00,157 - INFO - AUPRC: 0.4492 (0.3116 - 0.5902)
2025-11-30 11:24:00,157 - INFO - Brier Score: 0.2409 (0.2406 - 0.2411)
2025-11-30 11:24:00,157 - INFO - Accuracy: 0.9566 (0.8205 - 0.9708)
2025-11-30 11:24:00,157 - INFO - Precision: 0.6875 (0.3691 - 0.9400)
2025-11-30 11:24:00,157 - INFO - Sensitivity (Recall): 0.3056 (0.2082 - 0.6078)
2025-11-30 11:24:00,157 - INFO - F1-Score: 0.4231 (0.2524 - 0.5900)
2025-11-30 11:24:00,157 - INFO - Best Threshold: 0.5000 (0.4960 - 0.5000)
2025-11-30 11:24:00,157 - INFO - Specificity: 0.9924 (0.8423 - 0.9991)
2025-11-30 11:24:00,170 - INFO - Calculating SHAP values...
2025-11-30 11:24:01,287 - INFO - SHAP plots saved.
2025-11-30 11:24:01,287 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/any_aki/windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:24:02,619 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 11:24:02,619 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:24:02,725 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:24:02,745 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:24:02,749 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 11:24:02,750 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.382961:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.382961:   1%|          | 1/100 [00:03<05:31,  3.35s/it]Best trial: 1. Best value: 0.412458:   1%|          | 1/100 [00:07<05:31,  3.35s/it]Best trial: 1. Best value: 0.412458:   2%|▏         | 2/100 [00:07<06:34,  4.02s/it]Best trial: 1. Best value: 0.412458:   2%|▏         | 2/100 [00:10<06:34,  4.02s/it]Best trial: 1. Best value: 0.412458:   3%|▎         | 3/100 [00:10<05:21,  3.32s/it]Best trial: 3. Best value: 0.453582:   3%|▎         | 3/100 [00:13<05:21,  3.32s/it]Best trial: 3. Best value: 0.453582:   4%|▍         | 4/100 [00:13<05:18,  3.32s/it]Best trial: 3. Best value: 0.453582:   4%|▍         | 4/100 [00:15<05:18,  3.32s/it]Best trial: 3. Best value: 0.453582:   5%|▌         | 5/100 [00:15<04:30,  2.85s/it]Best trial: 3. Best value: 0.453582:   5%|▌         | 5/100 [00:17<04:30,  2.85s/it]Best trial: 3. Best value: 0.453582:   6%|▌         | 6/100 [00:17<03:47,  2.42s/it]Best trial: 3. Best value: 0.453582:   6%|▌         | 6/100 [00:19<03:47,  2.42s/it]Best trial: 3. Best value: 0.453582:   7%|▋         | 7/100 [00:19<03:53,  2.51s/it]Best trial: 7. Best value: 0.513583:   7%|▋         | 7/100 [00:23<03:53,  2.51s/it]Best trial: 7. Best value: 0.513583:   8%|▊         | 8/100 [00:23<04:14,  2.77s/it]Best trial: 7. Best value: 0.513583:   8%|▊         | 8/100 [00:25<04:14,  2.77s/it]Best trial: 7. Best value: 0.513583:   9%|▉         | 9/100 [00:25<03:43,  2.45s/it]Best trial: 7. Best value: 0.513583:   9%|▉         | 9/100 [00:28<03:43,  2.45s/it]Best trial: 7. Best value: 0.513583:  10%|█         | 10/100 [00:28<04:03,  2.71s/it]Best trial: 7. Best value: 0.513583:  10%|█         | 10/100 [00:30<04:03,  2.71s/it]Best trial: 7. Best value: 0.513583:  11%|█         | 11/100 [00:30<03:44,  2.52s/it]Best trial: 7. Best value: 0.513583:  11%|█         | 11/100 [00:32<03:44,  2.52s/it]Best trial: 7. Best value: 0.513583:  12%|█▏        | 12/100 [00:32<03:25,  2.34s/it]Best trial: 7. Best value: 0.513583:  12%|█▏        | 12/100 [00:34<03:25,  2.34s/it]Best trial: 7. Best value: 0.513583:  13%|█▎        | 13/100 [00:34<03:25,  2.36s/it]Best trial: 7. Best value: 0.513583:  13%|█▎        | 13/100 [00:38<03:25,  2.36s/it]Best trial: 7. Best value: 0.513583:  14%|█▍        | 14/100 [00:38<04:03,  2.83s/it]Best trial: 7. Best value: 0.513583:  14%|█▍        | 14/100 [00:42<04:03,  2.83s/it]Best trial: 7. Best value: 0.513583:  15%|█▌        | 15/100 [00:42<04:35,  3.24s/it]Best trial: 7. Best value: 0.513583:  15%|█▌        | 15/100 [00:44<04:35,  3.24s/it]Best trial: 7. Best value: 0.513583:  16%|█▌        | 16/100 [00:44<03:58,  2.84s/it]Best trial: 7. Best value: 0.513583:  16%|█▌        | 16/100 [00:49<03:58,  2.84s/it]Best trial: 7. Best value: 0.513583:  17%|█▋        | 17/100 [00:49<04:34,  3.31s/it]Best trial: 7. Best value: 0.513583:  17%|█▋        | 17/100 [00:51<04:34,  3.31s/it]Best trial: 7. Best value: 0.513583:  18%|█▊        | 18/100 [00:51<04:17,  3.15s/it]Best trial: 7. Best value: 0.513583:  18%|█▊        | 18/100 [00:55<04:17,  3.15s/it]Best trial: 7. Best value: 0.513583:  19%|█▉        | 19/100 [00:55<04:18,  3.19s/it]Best trial: 7. Best value: 0.513583:  19%|█▉        | 19/100 [00:57<04:18,  3.19s/it]Best trial: 7. Best value: 0.513583:  20%|██        | 20/100 [00:57<03:48,  2.85s/it]Best trial: 7. Best value: 0.513583:  20%|██        | 20/100 [00:59<03:48,  2.85s/it]Best trial: 7. Best value: 0.513583:  21%|██        | 21/100 [00:59<03:29,  2.65s/it]Best trial: 7. Best value: 0.513583:  21%|██        | 21/100 [01:02<03:29,  2.65s/it]Best trial: 7. Best value: 0.513583:  22%|██▏       | 22/100 [01:02<03:42,  2.86s/it]Best trial: 7. Best value: 0.513583:  22%|██▏       | 22/100 [01:05<03:42,  2.86s/it]Best trial: 7. Best value: 0.513583:  23%|██▎       | 23/100 [01:05<03:31,  2.74s/it]Best trial: 7. Best value: 0.513583:  23%|██▎       | 23/100 [01:08<03:31,  2.74s/it]Best trial: 7. Best value: 0.513583:  24%|██▍       | 24/100 [01:08<03:34,  2.82s/it]Best trial: 7. Best value: 0.513583:  24%|██▍       | 24/100 [01:11<03:34,  2.82s/it]Best trial: 7. Best value: 0.513583:  25%|██▌       | 25/100 [01:11<03:37,  2.90s/it]Best trial: 7. Best value: 0.513583:  25%|██▌       | 25/100 [01:14<03:37,  2.90s/it]Best trial: 7. Best value: 0.513583:  26%|██▌       | 26/100 [01:14<03:30,  2.85s/it]Best trial: 7. Best value: 0.513583:  26%|██▌       | 26/100 [01:19<03:30,  2.85s/it]Best trial: 7. Best value: 0.513583:  27%|██▋       | 27/100 [01:19<04:20,  3.57s/it]Best trial: 7. Best value: 0.513583:  27%|██▋       | 27/100 [01:21<04:20,  3.57s/it]Best trial: 7. Best value: 0.513583:  28%|██▊       | 28/100 [01:21<03:52,  3.23s/it]Best trial: 7. Best value: 0.513583:  28%|██▊       | 28/100 [01:24<03:52,  3.23s/it]Best trial: 7. Best value: 0.513583:  29%|██▉       | 29/100 [01:24<03:28,  2.93s/it]Best trial: 7. Best value: 0.513583:  29%|██▉       | 29/100 [01:27<03:28,  2.93s/it]Best trial: 7. Best value: 0.513583:  30%|███       | 30/100 [01:27<03:45,  3.23s/it]Best trial: 7. Best value: 0.513583:  30%|███       | 30/100 [01:31<03:45,  3.23s/it]Best trial: 7. Best value: 0.513583:  31%|███       | 31/100 [01:31<03:52,  3.36s/it]Best trial: 7. Best value: 0.513583:  31%|███       | 31/100 [01:34<03:52,  3.36s/it]Best trial: 7. Best value: 0.513583:  32%|███▏      | 32/100 [01:34<03:34,  3.15s/it]Best trial: 7. Best value: 0.513583:  32%|███▏      | 32/100 [01:37<03:34,  3.15s/it]Best trial: 7. Best value: 0.513583:  33%|███▎      | 33/100 [01:37<03:22,  3.03s/it]Best trial: 7. Best value: 0.513583:  33%|███▎      | 33/100 [01:39<03:22,  3.03s/it]Best trial: 7. Best value: 0.513583:  34%|███▍      | 34/100 [01:39<03:18,  3.01s/it]Best trial: 7. Best value: 0.513583:  34%|███▍      | 34/100 [01:43<03:18,  3.01s/it]Best trial: 7. Best value: 0.513583:  35%|███▌      | 35/100 [01:43<03:33,  3.28s/it]Best trial: 7. Best value: 0.513583:  35%|███▌      | 35/100 [01:46<03:33,  3.28s/it]Best trial: 7. Best value: 0.513583:  36%|███▌      | 36/100 [01:46<03:11,  2.99s/it]Best trial: 7. Best value: 0.513583:  36%|███▌      | 36/100 [01:49<03:11,  2.99s/it]Best trial: 7. Best value: 0.513583:  37%|███▋      | 37/100 [01:49<03:11,  3.04s/it]Best trial: 7. Best value: 0.513583:  37%|███▋      | 37/100 [01:52<03:11,  3.04s/it]Best trial: 7. Best value: 0.513583:  38%|███▊      | 38/100 [01:52<03:08,  3.04s/it]Best trial: 7. Best value: 0.513583:  38%|███▊      | 38/100 [01:55<03:08,  3.04s/it]Best trial: 7. Best value: 0.513583:  39%|███▉      | 39/100 [01:55<03:07,  3.07s/it]Best trial: 7. Best value: 0.513583:  39%|███▉      | 39/100 [01:57<03:07,  3.07s/it]Best trial: 7. Best value: 0.513583:  40%|████      | 40/100 [01:57<02:47,  2.79s/it]Best trial: 7. Best value: 0.513583:  40%|████      | 40/100 [02:00<02:47,  2.79s/it]Best trial: 7. Best value: 0.513583:  41%|████      | 41/100 [02:00<02:45,  2.80s/it]Best trial: 7. Best value: 0.513583:  41%|████      | 41/100 [02:04<02:45,  2.80s/it]Best trial: 7. Best value: 0.513583:  42%|████▏     | 42/100 [02:04<02:57,  3.06s/it]Best trial: 7. Best value: 0.513583:  42%|████▏     | 42/100 [02:07<02:57,  3.06s/it]Best trial: 7. Best value: 0.513583:  43%|████▎     | 43/100 [02:07<03:02,  3.21s/it]Best trial: 7. Best value: 0.513583:  43%|████▎     | 43/100 [02:10<03:02,  3.21s/it]Best trial: 7. Best value: 0.513583:  44%|████▍     | 44/100 [02:10<02:52,  3.08s/it]Best trial: 7. Best value: 0.513583:  44%|████▍     | 44/100 [02:13<02:52,  3.08s/it]Best trial: 7. Best value: 0.513583:  45%|████▌     | 45/100 [02:13<02:54,  3.17s/it]Best trial: 7. Best value: 0.513583:  45%|████▌     | 45/100 [02:17<02:54,  3.17s/it]Best trial: 7. Best value: 0.513583:  46%|████▌     | 46/100 [02:17<02:58,  3.31s/it]Best trial: 7. Best value: 0.513583:  46%|████▌     | 46/100 [02:20<02:58,  3.31s/it]Best trial: 7. Best value: 0.513583:  47%|████▋     | 47/100 [02:20<02:47,  3.16s/it]Best trial: 7. Best value: 0.513583:  47%|████▋     | 47/100 [02:22<02:47,  3.16s/it]Best trial: 7. Best value: 0.513583:  48%|████▊     | 48/100 [02:22<02:31,  2.91s/it]Best trial: 7. Best value: 0.513583:  48%|████▊     | 48/100 [02:27<02:31,  2.91s/it]Best trial: 7. Best value: 0.513583:  49%|████▉     | 49/100 [02:27<03:01,  3.56s/it]Best trial: 7. Best value: 0.513583:  49%|████▉     | 49/100 [02:29<03:01,  3.56s/it]Best trial: 7. Best value: 0.513583:  50%|█████     | 50/100 [02:29<02:37,  3.16s/it]Best trial: 7. Best value: 0.513583:  50%|█████     | 50/100 [02:32<02:37,  3.16s/it]Best trial: 7. Best value: 0.513583:  51%|█████     | 51/100 [02:32<02:22,  2.92s/it]Best trial: 7. Best value: 0.513583:  51%|█████     | 51/100 [02:36<02:22,  2.92s/it]Best trial: 7. Best value: 0.513583:  52%|█████▏    | 52/100 [02:36<02:35,  3.24s/it]Best trial: 7. Best value: 0.513583:  52%|█████▏    | 52/100 [02:40<02:35,  3.24s/it]Best trial: 7. Best value: 0.513583:  53%|█████▎    | 53/100 [02:40<02:43,  3.48s/it]Best trial: 7. Best value: 0.513583:  53%|█████▎    | 53/100 [02:42<02:43,  3.48s/it]Best trial: 7. Best value: 0.513583:  54%|█████▍    | 54/100 [02:42<02:21,  3.08s/it]Best trial: 7. Best value: 0.513583:  54%|█████▍    | 54/100 [02:45<02:21,  3.08s/it]Best trial: 7. Best value: 0.513583:  55%|█████▌    | 55/100 [02:45<02:16,  3.04s/it]Best trial: 7. Best value: 0.513583:  55%|█████▌    | 55/100 [02:49<02:16,  3.04s/it]Best trial: 7. Best value: 0.513583:  56%|█████▌    | 56/100 [02:49<02:21,  3.21s/it]Best trial: 7. Best value: 0.513583:  56%|█████▌    | 56/100 [02:50<02:21,  3.21s/it]Best trial: 7. Best value: 0.513583:  57%|█████▋    | 57/100 [02:50<01:58,  2.76s/it]Best trial: 7. Best value: 0.513583:  57%|█████▋    | 57/100 [02:53<01:58,  2.76s/it]Best trial: 7. Best value: 0.513583:  58%|█████▊    | 58/100 [02:53<01:53,  2.71s/it]Best trial: 7. Best value: 0.513583:  58%|█████▊    | 58/100 [02:55<01:53,  2.71s/it]Best trial: 7. Best value: 0.513583:  59%|█████▉    | 59/100 [02:55<01:48,  2.65s/it]Best trial: 7. Best value: 0.513583:  59%|█████▉    | 59/100 [02:59<01:48,  2.65s/it]Best trial: 7. Best value: 0.513583:  60%|██████    | 60/100 [02:59<01:55,  2.88s/it]Best trial: 7. Best value: 0.513583:  60%|██████    | 60/100 [03:02<01:55,  2.88s/it]Best trial: 7. Best value: 0.513583:  61%|██████    | 61/100 [03:02<01:50,  2.84s/it]Best trial: 7. Best value: 0.513583:  61%|██████    | 61/100 [03:05<01:50,  2.84s/it]Best trial: 7. Best value: 0.513583:  62%|██████▏   | 62/100 [03:05<02:00,  3.17s/it]Best trial: 7. Best value: 0.513583:  62%|██████▏   | 62/100 [03:09<02:00,  3.17s/it]Best trial: 7. Best value: 0.513583:  63%|██████▎   | 63/100 [03:09<02:06,  3.42s/it]Best trial: 7. Best value: 0.513583:  63%|██████▎   | 63/100 [03:13<02:06,  3.42s/it]Best trial: 7. Best value: 0.513583:  64%|██████▍   | 64/100 [03:13<02:09,  3.59s/it]Best trial: 7. Best value: 0.513583:  64%|██████▍   | 64/100 [03:16<02:09,  3.59s/it]Best trial: 7. Best value: 0.513583:  65%|██████▌   | 65/100 [03:16<01:53,  3.25s/it]Best trial: 7. Best value: 0.513583:  65%|██████▌   | 65/100 [03:19<01:53,  3.25s/it]Best trial: 7. Best value: 0.513583:  66%|██████▌   | 66/100 [03:19<01:44,  3.07s/it]Best trial: 7. Best value: 0.513583:  66%|██████▌   | 66/100 [03:21<01:44,  3.07s/it]Best trial: 7. Best value: 0.513583:  67%|██████▋   | 67/100 [03:21<01:33,  2.85s/it]Best trial: 7. Best value: 0.513583:  67%|██████▋   | 67/100 [03:24<01:33,  2.85s/it]Best trial: 7. Best value: 0.513583:  68%|██████▊   | 68/100 [03:24<01:37,  3.04s/it]Best trial: 7. Best value: 0.513583:  68%|██████▊   | 68/100 [03:27<01:37,  3.04s/it]Best trial: 7. Best value: 0.513583:  69%|██████▉   | 69/100 [03:27<01:28,  2.86s/it]Best trial: 7. Best value: 0.513583:  69%|██████▉   | 69/100 [03:30<01:28,  2.86s/it]Best trial: 7. Best value: 0.513583:  70%|███████   | 70/100 [03:30<01:30,  3.01s/it]Best trial: 7. Best value: 0.513583:  70%|███████   | 70/100 [03:33<01:30,  3.01s/it]Best trial: 7. Best value: 0.513583:  71%|███████   | 71/100 [03:33<01:26,  2.97s/it]Best trial: 7. Best value: 0.513583:  71%|███████   | 71/100 [03:37<01:26,  2.97s/it]Best trial: 7. Best value: 0.513583:  72%|███████▏  | 72/100 [03:37<01:28,  3.15s/it]Best trial: 7. Best value: 0.513583:  72%|███████▏  | 72/100 [03:41<01:28,  3.15s/it]Best trial: 7. Best value: 0.513583:  73%|███████▎  | 73/100 [03:41<01:38,  3.64s/it]Best trial: 7. Best value: 0.513583:  73%|███████▎  | 73/100 [03:45<01:38,  3.64s/it]Best trial: 7. Best value: 0.513583:  74%|███████▍  | 74/100 [03:45<01:31,  3.52s/it]Best trial: 74. Best value: 0.51425:  74%|███████▍  | 74/100 [03:49<01:31,  3.52s/it]Best trial: 74. Best value: 0.51425:  75%|███████▌  | 75/100 [03:49<01:36,  3.87s/it]Best trial: 74. Best value: 0.51425:  75%|███████▌  | 75/100 [03:53<01:36,  3.87s/it]Best trial: 74. Best value: 0.51425:  76%|███████▌  | 76/100 [03:53<01:28,  3.68s/it]Best trial: 74. Best value: 0.51425:  76%|███████▌  | 76/100 [03:56<01:28,  3.68s/it]Best trial: 74. Best value: 0.51425:  77%|███████▋  | 77/100 [03:56<01:25,  3.70s/it]Best trial: 74. Best value: 0.51425:  77%|███████▋  | 77/100 [03:59<01:25,  3.70s/it]Best trial: 74. Best value: 0.51425:  78%|███████▊  | 78/100 [03:59<01:17,  3.53s/it]Best trial: 74. Best value: 0.51425:  78%|███████▊  | 78/100 [04:03<01:17,  3.53s/it]Best trial: 74. Best value: 0.51425:  79%|███████▉  | 79/100 [04:03<01:12,  3.47s/it]Best trial: 74. Best value: 0.51425:  79%|███████▉  | 79/100 [04:07<01:12,  3.47s/it]Best trial: 74. Best value: 0.51425:  80%|████████  | 80/100 [04:07<01:12,  3.62s/it]Best trial: 74. Best value: 0.51425:  80%|████████  | 80/100 [04:11<01:12,  3.62s/it]Best trial: 74. Best value: 0.51425:  81%|████████  | 81/100 [04:11<01:11,  3.76s/it]Best trial: 74. Best value: 0.51425:  81%|████████  | 81/100 [04:15<01:11,  3.76s/it]Best trial: 74. Best value: 0.51425:  82%|████████▏ | 82/100 [04:15<01:09,  3.84s/it]Best trial: 74. Best value: 0.51425:  82%|████████▏ | 82/100 [04:19<01:09,  3.84s/it]Best trial: 74. Best value: 0.51425:  83%|████████▎ | 83/100 [04:19<01:06,  3.94s/it]Best trial: 74. Best value: 0.51425:  83%|████████▎ | 83/100 [04:22<01:06,  3.94s/it]Best trial: 74. Best value: 0.51425:  84%|████████▍ | 84/100 [04:22<01:00,  3.77s/it]Best trial: 74. Best value: 0.51425:  84%|████████▍ | 84/100 [04:28<01:00,  3.77s/it]Best trial: 74. Best value: 0.51425:  85%|████████▌ | 85/100 [04:28<01:03,  4.24s/it]Best trial: 74. Best value: 0.51425:  85%|████████▌ | 85/100 [04:32<01:03,  4.24s/it]Best trial: 74. Best value: 0.51425:  86%|████████▌ | 86/100 [04:32<00:57,  4.11s/it]Best trial: 74. Best value: 0.51425:  86%|████████▌ | 86/100 [04:36<00:57,  4.11s/it]Best trial: 74. Best value: 0.51425:  87%|████████▋ | 87/100 [04:36<00:52,  4.07s/it]Best trial: 87. Best value: 0.518514:  87%|████████▋ | 87/100 [04:39<00:52,  4.07s/it]Best trial: 87. Best value: 0.518514:  88%|████████▊ | 88/100 [04:39<00:47,  3.94s/it]Best trial: 87. Best value: 0.518514:  88%|████████▊ | 88/100 [04:43<00:47,  3.94s/it]Best trial: 87. Best value: 0.518514:  89%|████████▉ | 89/100 [04:43<00:42,  3.83s/it]Best trial: 89. Best value: 0.533647:  89%|████████▉ | 89/100 [04:46<00:42,  3.83s/it]Best trial: 89. Best value: 0.533647:  90%|█████████ | 90/100 [04:46<00:37,  3.77s/it]Best trial: 89. Best value: 0.533647:  90%|█████████ | 90/100 [04:49<00:37,  3.77s/it]Best trial: 89. Best value: 0.533647:  91%|█████████ | 91/100 [04:49<00:31,  3.50s/it]Best trial: 89. Best value: 0.533647:  91%|█████████ | 91/100 [04:52<00:31,  3.50s/it]Best trial: 89. Best value: 0.533647:  92%|█████████▏| 92/100 [04:52<00:26,  3.31s/it]Best trial: 89. Best value: 0.533647:  92%|█████████▏| 92/100 [04:55<00:26,  3.31s/it]Best trial: 89. Best value: 0.533647:  93%|█████████▎| 93/100 [04:55<00:22,  3.16s/it]Best trial: 89. Best value: 0.533647:  93%|█████████▎| 93/100 [04:58<00:22,  3.16s/it]Best trial: 89. Best value: 0.533647:  94%|█████████▍| 94/100 [04:58<00:18,  3.12s/it]Best trial: 89. Best value: 0.533647:  94%|█████████▍| 94/100 [05:01<00:18,  3.12s/it]Best trial: 89. Best value: 0.533647:  95%|█████████▌| 95/100 [05:01<00:15,  3.00s/it]Best trial: 89. Best value: 0.533647:  95%|█████████▌| 95/100 [05:04<00:15,  3.00s/it]Best trial: 89. Best value: 0.533647:  96%|█████████▌| 96/100 [05:04<00:11,  2.99s/it]Best trial: 89. Best value: 0.533647:  96%|█████████▌| 96/100 [05:07<00:11,  2.99s/it]Best trial: 89. Best value: 0.533647:  97%|█████████▋| 97/100 [05:07<00:08,  2.97s/it]Best trial: 89. Best value: 0.533647:  97%|█████████▋| 97/100 [05:09<00:08,  2.97s/it]Best trial: 89. Best value: 0.533647:  98%|█████████▊| 98/100 [05:09<00:05,  2.81s/it]Best trial: 89. Best value: 0.533647:  98%|█████████▊| 98/100 [05:13<00:05,  2.81s/it]Best trial: 89. Best value: 0.533647:  99%|█████████▉| 99/100 [05:13<00:03,  3.12s/it]Best trial: 89. Best value: 0.533647:  99%|█████████▉| 99/100 [05:16<00:03,  3.12s/it]Best trial: 89. Best value: 0.533647: 100%|██████████| 100/100 [05:16<00:00,  3.07s/it]Best trial: 89. Best value: 0.533647: 100%|██████████| 100/100 [05:16<00:00,  3.16s/it]
2025-11-30 11:29:19,039 - INFO - HPO Complete. Best AUPRC: 0.5336
2025-11-30 11:29:19,039 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.08735307508690372, 'max_depth': 10, 'subsample': 0.7761440899141193, 'colsample_bytree': 0.7647217563230354, 'gamma': 0.24693202509760193, 'reg_lambda': 5.2166363376957156e-08, 'reg_alpha': 6.783949371447409e-05}
2025-11-30 11:29:19,041 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:29:21,045 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_only
2025-11-30 11:29:21,045 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:29:21,130 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:29:21,147 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:29:21,152 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 11:29:21,152 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:29:21,152 - INFO - Training model...
2025-11-30 11:29:21,778 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:29:26,933 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:29:26,933 - INFO - AUROC: 0.7488 (0.6141 - 0.9035)
2025-11-30 11:29:26,934 - INFO - AUPRC: 0.1448 (0.0259 - 0.4123)
2025-11-30 11:29:26,934 - INFO - Brier Score: 0.0163 (0.0109 - 0.0259)
2025-11-30 11:29:26,934 - INFO - Accuracy: 0.9841 (0.9422 - 0.9922)
2025-11-30 11:29:26,934 - INFO - Precision: 0.4000 (0.0600 - 1.0000)
2025-11-30 11:29:26,934 - INFO - Sensitivity (Recall): 0.2000 (0.0462 - 0.6000)
2025-11-30 11:29:26,934 - INFO - F1-Score: 0.2667 (0.0706 - 0.5490)
2025-11-30 11:29:26,934 - INFO - Best Threshold: 0.4900 (0.0220 - 0.9400)
2025-11-30 11:29:26,934 - INFO - Specificity: 0.9956 (0.9496 - 1.0000)
2025-11-30 11:29:26,940 - INFO - Calculating SHAP values...
2025-11-30 11:29:27,908 - INFO - SHAP plots saved.
2025-11-30 11:29:27,908 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:29:29,095 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 11:29:29,095 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:29:29,182 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:29:29,190 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:29:29,192 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:29:29,192 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0675924:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0675924:   1%|          | 1/100 [00:01<01:46,  1.08s/it]Best trial: 0. Best value: 0.0675924:   1%|          | 1/100 [00:02<01:46,  1.08s/it]Best trial: 0. Best value: 0.0675924:   2%|▏         | 2/100 [00:02<02:02,  1.25s/it]Best trial: 0. Best value: 0.0675924:   2%|▏         | 2/100 [00:03<02:02,  1.25s/it]Best trial: 0. Best value: 0.0675924:   3%|▎         | 3/100 [00:03<01:46,  1.09s/it]Best trial: 0. Best value: 0.0675924:   3%|▎         | 3/100 [00:04<01:46,  1.09s/it]Best trial: 0. Best value: 0.0675924:   4%|▍         | 4/100 [00:04<01:36,  1.00s/it]Best trial: 0. Best value: 0.0675924:   4%|▍         | 4/100 [00:05<01:36,  1.00s/it]Best trial: 0. Best value: 0.0675924:   5%|▌         | 5/100 [00:05<01:37,  1.02s/it]Best trial: 0. Best value: 0.0675924:   5%|▌         | 5/100 [00:06<01:37,  1.02s/it]Best trial: 0. Best value: 0.0675924:   6%|▌         | 6/100 [00:06<01:42,  1.09s/it]Best trial: 0. Best value: 0.0675924:   6%|▌         | 6/100 [00:07<01:42,  1.09s/it]Best trial: 0. Best value: 0.0675924:   7%|▋         | 7/100 [00:07<01:46,  1.14s/it]Best trial: 7. Best value: 0.0877641:   7%|▋         | 7/100 [00:08<01:46,  1.14s/it]Best trial: 7. Best value: 0.0877641:   8%|▊         | 8/100 [00:08<01:30,  1.02it/s]Best trial: 7. Best value: 0.0877641:   8%|▊         | 8/100 [00:09<01:30,  1.02it/s]Best trial: 7. Best value: 0.0877641:   9%|▉         | 9/100 [00:09<01:35,  1.05s/it]Best trial: 7. Best value: 0.0877641:   9%|▉         | 9/100 [00:10<01:35,  1.05s/it]Best trial: 7. Best value: 0.0877641:  10%|█         | 10/100 [00:10<01:44,  1.16s/it]Best trial: 7. Best value: 0.0877641:  10%|█         | 10/100 [00:11<01:44,  1.16s/it]Best trial: 7. Best value: 0.0877641:  11%|█         | 11/100 [00:11<01:33,  1.05s/it]Best trial: 7. Best value: 0.0877641:  11%|█         | 11/100 [00:12<01:33,  1.05s/it]Best trial: 7. Best value: 0.0877641:  12%|█▏        | 12/100 [00:12<01:26,  1.01it/s]Best trial: 12. Best value: 0.0878959:  12%|█▏        | 12/100 [00:13<01:26,  1.01it/s]Best trial: 12. Best value: 0.0878959:  13%|█▎        | 13/100 [00:13<01:20,  1.07it/s]Best trial: 12. Best value: 0.0878959:  13%|█▎        | 13/100 [00:14<01:20,  1.07it/s]Best trial: 12. Best value: 0.0878959:  14%|█▍        | 14/100 [00:14<01:18,  1.10it/s]Best trial: 12. Best value: 0.0878959:  14%|█▍        | 14/100 [00:15<01:18,  1.10it/s]Best trial: 12. Best value: 0.0878959:  15%|█▌        | 15/100 [00:15<01:14,  1.14it/s]Best trial: 12. Best value: 0.0878959:  15%|█▌        | 15/100 [00:16<01:14,  1.14it/s]Best trial: 12. Best value: 0.0878959:  16%|█▌        | 16/100 [00:16<01:15,  1.11it/s]Best trial: 12. Best value: 0.0878959:  16%|█▌        | 16/100 [00:16<01:15,  1.11it/s]Best trial: 12. Best value: 0.0878959:  17%|█▋        | 17/100 [00:16<01:10,  1.18it/s]Best trial: 12. Best value: 0.0878959:  17%|█▋        | 17/100 [00:17<01:10,  1.18it/s]Best trial: 12. Best value: 0.0878959:  18%|█▊        | 18/100 [00:17<01:07,  1.21it/s]Best trial: 12. Best value: 0.0878959:  18%|█▊        | 18/100 [00:19<01:07,  1.21it/s]Best trial: 12. Best value: 0.0878959:  19%|█▉        | 19/100 [00:19<01:23,  1.03s/it]Best trial: 12. Best value: 0.0878959:  19%|█▉        | 19/100 [00:20<01:23,  1.03s/it]Best trial: 12. Best value: 0.0878959:  20%|██        | 20/100 [00:20<01:25,  1.07s/it]Best trial: 12. Best value: 0.0878959:  20%|██        | 20/100 [00:21<01:25,  1.07s/it]Best trial: 12. Best value: 0.0878959:  21%|██        | 21/100 [00:21<01:24,  1.07s/it]Best trial: 12. Best value: 0.0878959:  21%|██        | 21/100 [00:22<01:24,  1.07s/it]Best trial: 12. Best value: 0.0878959:  22%|██▏       | 22/100 [00:22<01:17,  1.00it/s]Best trial: 12. Best value: 0.0878959:  22%|██▏       | 22/100 [00:22<01:17,  1.00it/s]Best trial: 12. Best value: 0.0878959:  23%|██▎       | 23/100 [00:22<01:13,  1.04it/s]Best trial: 12. Best value: 0.0878959:  23%|██▎       | 23/100 [00:23<01:13,  1.04it/s]Best trial: 12. Best value: 0.0878959:  24%|██▍       | 24/100 [00:23<01:10,  1.08it/s]Best trial: 24. Best value: 0.09683:  24%|██▍       | 24/100 [00:24<01:10,  1.08it/s]  Best trial: 24. Best value: 0.09683:  25%|██▌       | 25/100 [00:24<01:05,  1.14it/s]Best trial: 24. Best value: 0.09683:  25%|██▌       | 25/100 [00:25<01:05,  1.14it/s]Best trial: 24. Best value: 0.09683:  26%|██▌       | 26/100 [00:25<01:08,  1.08it/s]Best trial: 24. Best value: 0.09683:  26%|██▌       | 26/100 [00:26<01:08,  1.08it/s]Best trial: 24. Best value: 0.09683:  27%|██▋       | 27/100 [00:26<01:03,  1.15it/s]Best trial: 24. Best value: 0.09683:  27%|██▋       | 27/100 [00:27<01:03,  1.15it/s]Best trial: 24. Best value: 0.09683:  28%|██▊       | 28/100 [00:27<01:04,  1.12it/s]Best trial: 24. Best value: 0.09683:  28%|██▊       | 28/100 [00:28<01:04,  1.12it/s]Best trial: 24. Best value: 0.09683:  29%|██▉       | 29/100 [00:28<01:01,  1.15it/s]Best trial: 24. Best value: 0.09683:  29%|██▉       | 29/100 [00:29<01:01,  1.15it/s]Best trial: 24. Best value: 0.09683:  30%|███       | 30/100 [00:29<01:08,  1.02it/s]Best trial: 24. Best value: 0.09683:  30%|███       | 30/100 [00:30<01:08,  1.02it/s]Best trial: 24. Best value: 0.09683:  31%|███       | 31/100 [00:30<01:08,  1.01it/s]Best trial: 24. Best value: 0.09683:  31%|███       | 31/100 [00:31<01:08,  1.01it/s]Best trial: 24. Best value: 0.09683:  32%|███▏      | 32/100 [00:31<01:00,  1.12it/s]Best trial: 24. Best value: 0.09683:  32%|███▏      | 32/100 [00:31<01:00,  1.12it/s]Best trial: 24. Best value: 0.09683:  33%|███▎      | 33/100 [00:31<00:58,  1.15it/s]Best trial: 24. Best value: 0.09683:  33%|███▎      | 33/100 [00:32<00:58,  1.15it/s]Best trial: 24. Best value: 0.09683:  34%|███▍      | 34/100 [00:32<01:00,  1.10it/s]Best trial: 24. Best value: 0.09683:  34%|███▍      | 34/100 [00:33<01:00,  1.10it/s]Best trial: 24. Best value: 0.09683:  35%|███▌      | 35/100 [00:33<00:56,  1.16it/s]Best trial: 24. Best value: 0.09683:  35%|███▌      | 35/100 [00:34<00:56,  1.16it/s]Best trial: 24. Best value: 0.09683:  36%|███▌      | 36/100 [00:34<01:01,  1.04it/s]Best trial: 24. Best value: 0.09683:  36%|███▌      | 36/100 [00:35<01:01,  1.04it/s]Best trial: 24. Best value: 0.09683:  37%|███▋      | 37/100 [00:35<01:00,  1.05it/s]Best trial: 24. Best value: 0.09683:  37%|███▋      | 37/100 [00:36<01:00,  1.05it/s]Best trial: 24. Best value: 0.09683:  38%|███▊      | 38/100 [00:36<01:00,  1.03it/s]Best trial: 24. Best value: 0.09683:  38%|███▊      | 38/100 [00:37<01:00,  1.03it/s]Best trial: 24. Best value: 0.09683:  39%|███▉      | 39/100 [00:37<01:02,  1.03s/it]Best trial: 24. Best value: 0.09683:  39%|███▉      | 39/100 [00:39<01:02,  1.03s/it]Best trial: 24. Best value: 0.09683:  40%|████      | 40/100 [00:39<01:12,  1.20s/it]Best trial: 24. Best value: 0.09683:  40%|████      | 40/100 [00:40<01:12,  1.20s/it]Best trial: 24. Best value: 0.09683:  41%|████      | 41/100 [00:40<01:06,  1.12s/it]Best trial: 24. Best value: 0.09683:  41%|████      | 41/100 [00:41<01:06,  1.12s/it]Best trial: 24. Best value: 0.09683:  42%|████▏     | 42/100 [00:41<01:02,  1.08s/it]Best trial: 24. Best value: 0.09683:  42%|████▏     | 42/100 [00:42<01:02,  1.08s/it]Best trial: 24. Best value: 0.09683:  43%|████▎     | 43/100 [00:42<01:00,  1.06s/it]Best trial: 24. Best value: 0.09683:  43%|████▎     | 43/100 [00:44<01:00,  1.06s/it]Best trial: 24. Best value: 0.09683:  44%|████▍     | 44/100 [00:44<01:12,  1.30s/it]Best trial: 24. Best value: 0.09683:  44%|████▍     | 44/100 [00:45<01:12,  1.30s/it]Best trial: 24. Best value: 0.09683:  45%|████▌     | 45/100 [00:45<01:17,  1.40s/it]Best trial: 24. Best value: 0.09683:  45%|████▌     | 45/100 [00:46<01:17,  1.40s/it]Best trial: 24. Best value: 0.09683:  46%|████▌     | 46/100 [00:46<01:04,  1.20s/it]Best trial: 46. Best value: 0.100181:  46%|████▌     | 46/100 [00:48<01:04,  1.20s/it]Best trial: 46. Best value: 0.100181:  47%|████▋     | 47/100 [00:48<01:07,  1.27s/it]Best trial: 46. Best value: 0.100181:  47%|████▋     | 47/100 [00:49<01:07,  1.27s/it]Best trial: 46. Best value: 0.100181:  48%|████▊     | 48/100 [00:49<00:59,  1.15s/it]Best trial: 46. Best value: 0.100181:  48%|████▊     | 48/100 [00:50<00:59,  1.15s/it]Best trial: 46. Best value: 0.100181:  49%|████▉     | 49/100 [00:50<00:59,  1.16s/it]Best trial: 46. Best value: 0.100181:  49%|████▉     | 49/100 [00:51<00:59,  1.16s/it]Best trial: 46. Best value: 0.100181:  50%|█████     | 50/100 [00:51<01:01,  1.23s/it]Best trial: 46. Best value: 0.100181:  50%|█████     | 50/100 [00:53<01:01,  1.23s/it]Best trial: 46. Best value: 0.100181:  51%|█████     | 51/100 [00:53<01:02,  1.29s/it]Best trial: 46. Best value: 0.100181:  51%|█████     | 51/100 [00:53<01:02,  1.29s/it]Best trial: 46. Best value: 0.100181:  52%|█████▏    | 52/100 [00:53<00:52,  1.10s/it]Best trial: 46. Best value: 0.100181:  52%|█████▏    | 52/100 [00:54<00:52,  1.10s/it]Best trial: 46. Best value: 0.100181:  53%|█████▎    | 53/100 [00:54<00:46,  1.00it/s]Best trial: 46. Best value: 0.100181:  53%|█████▎    | 53/100 [00:55<00:46,  1.00it/s]Best trial: 46. Best value: 0.100181:  54%|█████▍    | 54/100 [00:55<00:47,  1.04s/it]Best trial: 46. Best value: 0.100181:  54%|█████▍    | 54/100 [00:56<00:47,  1.04s/it]Best trial: 46. Best value: 0.100181:  55%|█████▌    | 55/100 [00:56<00:46,  1.03s/it]Best trial: 46. Best value: 0.100181:  55%|█████▌    | 55/100 [00:57<00:46,  1.03s/it]Best trial: 46. Best value: 0.100181:  56%|█████▌    | 56/100 [00:57<00:42,  1.03it/s]Best trial: 46. Best value: 0.100181:  56%|█████▌    | 56/100 [00:58<00:42,  1.03it/s]Best trial: 46. Best value: 0.100181:  57%|█████▋    | 57/100 [00:58<00:41,  1.05it/s]Best trial: 46. Best value: 0.100181:  57%|█████▋    | 57/100 [00:59<00:41,  1.05it/s]Best trial: 46. Best value: 0.100181:  58%|█████▊    | 58/100 [00:59<00:41,  1.02it/s]Best trial: 46. Best value: 0.100181:  58%|█████▊    | 58/100 [01:00<00:41,  1.02it/s]Best trial: 46. Best value: 0.100181:  59%|█████▉    | 59/100 [01:00<00:46,  1.14s/it]Best trial: 46. Best value: 0.100181:  59%|█████▉    | 59/100 [01:01<00:46,  1.14s/it]Best trial: 46. Best value: 0.100181:  60%|██████    | 60/100 [01:01<00:41,  1.03s/it]Best trial: 46. Best value: 0.100181:  60%|██████    | 60/100 [01:02<00:41,  1.03s/it]Best trial: 46. Best value: 0.100181:  61%|██████    | 61/100 [01:02<00:40,  1.04s/it]Best trial: 46. Best value: 0.100181:  61%|██████    | 61/100 [01:03<00:40,  1.04s/it]Best trial: 46. Best value: 0.100181:  62%|██████▏   | 62/100 [01:03<00:36,  1.04it/s]Best trial: 46. Best value: 0.100181:  62%|██████▏   | 62/100 [01:04<00:36,  1.04it/s]Best trial: 46. Best value: 0.100181:  63%|██████▎   | 63/100 [01:04<00:35,  1.05it/s]Best trial: 46. Best value: 0.100181:  63%|██████▎   | 63/100 [01:05<00:35,  1.05it/s]Best trial: 46. Best value: 0.100181:  64%|██████▍   | 64/100 [01:05<00:34,  1.06it/s]Best trial: 46. Best value: 0.100181:  64%|██████▍   | 64/100 [01:06<00:34,  1.06it/s]Best trial: 46. Best value: 0.100181:  65%|██████▌   | 65/100 [01:06<00:34,  1.02it/s]Best trial: 46. Best value: 0.100181:  65%|██████▌   | 65/100 [01:07<00:34,  1.02it/s]Best trial: 46. Best value: 0.100181:  66%|██████▌   | 66/100 [01:07<00:33,  1.02it/s]Best trial: 46. Best value: 0.100181:  66%|██████▌   | 66/100 [01:08<00:33,  1.02it/s]Best trial: 46. Best value: 0.100181:  67%|██████▋   | 67/100 [01:08<00:34,  1.05s/it]Best trial: 67. Best value: 0.102226:  67%|██████▋   | 67/100 [01:09<00:34,  1.05s/it]Best trial: 67. Best value: 0.102226:  68%|██████▊   | 68/100 [01:09<00:32,  1.02s/it]Best trial: 67. Best value: 0.102226:  68%|██████▊   | 68/100 [01:10<00:32,  1.02s/it]Best trial: 67. Best value: 0.102226:  69%|██████▉   | 69/100 [01:10<00:30,  1.02it/s]Best trial: 67. Best value: 0.102226:  69%|██████▉   | 69/100 [01:11<00:30,  1.02it/s]Best trial: 67. Best value: 0.102226:  70%|███████   | 70/100 [01:11<00:29,  1.01it/s]Best trial: 67. Best value: 0.102226:  70%|███████   | 70/100 [01:12<00:29,  1.01it/s]Best trial: 67. Best value: 0.102226:  71%|███████   | 71/100 [01:12<00:28,  1.03it/s]Best trial: 67. Best value: 0.102226:  71%|███████   | 71/100 [01:13<00:28,  1.03it/s]Best trial: 67. Best value: 0.102226:  72%|███████▏  | 72/100 [01:13<00:26,  1.06it/s]Best trial: 67. Best value: 0.102226:  72%|███████▏  | 72/100 [01:14<00:26,  1.06it/s]Best trial: 67. Best value: 0.102226:  73%|███████▎  | 73/100 [01:14<00:25,  1.05it/s]Best trial: 67. Best value: 0.102226:  73%|███████▎  | 73/100 [01:15<00:25,  1.05it/s]Best trial: 67. Best value: 0.102226:  74%|███████▍  | 74/100 [01:15<00:23,  1.08it/s]Best trial: 67. Best value: 0.102226:  74%|███████▍  | 74/100 [01:15<00:23,  1.08it/s]Best trial: 67. Best value: 0.102226:  75%|███████▌  | 75/100 [01:15<00:22,  1.11it/s]Best trial: 67. Best value: 0.102226:  75%|███████▌  | 75/100 [01:16<00:22,  1.11it/s]Best trial: 67. Best value: 0.102226:  76%|███████▌  | 76/100 [01:16<00:21,  1.12it/s]Best trial: 67. Best value: 0.102226:  76%|███████▌  | 76/100 [01:18<00:21,  1.12it/s]Best trial: 67. Best value: 0.102226:  77%|███████▋  | 77/100 [01:18<00:23,  1.03s/it]Best trial: 67. Best value: 0.102226:  77%|███████▋  | 77/100 [01:19<00:23,  1.03s/it]Best trial: 67. Best value: 0.102226:  78%|███████▊  | 78/100 [01:19<00:22,  1.04s/it]Best trial: 67. Best value: 0.102226:  78%|███████▊  | 78/100 [01:20<00:22,  1.04s/it]Best trial: 67. Best value: 0.102226:  79%|███████▉  | 79/100 [01:20<00:21,  1.05s/it]Best trial: 67. Best value: 0.102226:  79%|███████▉  | 79/100 [01:21<00:21,  1.05s/it]Best trial: 67. Best value: 0.102226:  80%|████████  | 80/100 [01:21<00:19,  1.01it/s]Best trial: 67. Best value: 0.102226:  80%|████████  | 80/100 [01:22<00:19,  1.01it/s]Best trial: 67. Best value: 0.102226:  81%|████████  | 81/100 [01:22<00:19,  1.04s/it]Best trial: 67. Best value: 0.102226:  81%|████████  | 81/100 [01:23<00:19,  1.04s/it]Best trial: 67. Best value: 0.102226:  82%|████████▏ | 82/100 [01:23<00:17,  1.04it/s]Best trial: 67. Best value: 0.102226:  82%|████████▏ | 82/100 [01:24<00:17,  1.04it/s]Best trial: 67. Best value: 0.102226:  83%|████████▎ | 83/100 [01:24<00:16,  1.04it/s]Best trial: 67. Best value: 0.102226:  83%|████████▎ | 83/100 [01:24<00:16,  1.04it/s]Best trial: 67. Best value: 0.102226:  84%|████████▍ | 84/100 [01:24<00:15,  1.06it/s]Best trial: 67. Best value: 0.102226:  84%|████████▍ | 84/100 [01:26<00:15,  1.06it/s]Best trial: 67. Best value: 0.102226:  85%|████████▌ | 85/100 [01:26<00:16,  1.10s/it]Best trial: 67. Best value: 0.102226:  85%|████████▌ | 85/100 [01:27<00:16,  1.10s/it]Best trial: 67. Best value: 0.102226:  86%|████████▌ | 86/100 [01:27<00:14,  1.02s/it]Best trial: 67. Best value: 0.102226:  86%|████████▌ | 86/100 [01:28<00:14,  1.02s/it]Best trial: 67. Best value: 0.102226:  87%|████████▋ | 87/100 [01:28<00:14,  1.13s/it]Best trial: 67. Best value: 0.102226:  87%|████████▋ | 87/100 [01:29<00:14,  1.13s/it]Best trial: 67. Best value: 0.102226:  88%|████████▊ | 88/100 [01:29<00:12,  1.03s/it]Best trial: 67. Best value: 0.102226:  88%|████████▊ | 88/100 [01:30<00:12,  1.03s/it]Best trial: 67. Best value: 0.102226:  89%|████████▉ | 89/100 [01:30<00:12,  1.09s/it]Best trial: 67. Best value: 0.102226:  89%|████████▉ | 89/100 [01:31<00:12,  1.09s/it]Best trial: 67. Best value: 0.102226:  90%|█████████ | 90/100 [01:31<00:09,  1.02it/s]Best trial: 67. Best value: 0.102226:  90%|█████████ | 90/100 [01:32<00:09,  1.02it/s]Best trial: 67. Best value: 0.102226:  91%|█████████ | 91/100 [01:32<00:08,  1.08it/s]Best trial: 67. Best value: 0.102226:  91%|█████████ | 91/100 [01:33<00:08,  1.08it/s]Best trial: 67. Best value: 0.102226:  92%|█████████▏| 92/100 [01:33<00:07,  1.07it/s]Best trial: 67. Best value: 0.102226:  92%|█████████▏| 92/100 [01:34<00:07,  1.07it/s]Best trial: 67. Best value: 0.102226:  93%|█████████▎| 93/100 [01:34<00:06,  1.06it/s]Best trial: 67. Best value: 0.102226:  93%|█████████▎| 93/100 [01:34<00:06,  1.06it/s]Best trial: 67. Best value: 0.102226:  94%|█████████▍| 94/100 [01:34<00:05,  1.09it/s]Best trial: 67. Best value: 0.102226:  94%|█████████▍| 94/100 [01:35<00:05,  1.09it/s]Best trial: 67. Best value: 0.102226:  95%|█████████▌| 95/100 [01:35<00:04,  1.06it/s]Best trial: 67. Best value: 0.102226:  95%|█████████▌| 95/100 [01:36<00:04,  1.06it/s]Best trial: 67. Best value: 0.102226:  96%|█████████▌| 96/100 [01:36<00:03,  1.06it/s]Best trial: 67. Best value: 0.102226:  96%|█████████▌| 96/100 [01:38<00:03,  1.06it/s]Best trial: 67. Best value: 0.102226:  97%|█████████▋| 97/100 [01:38<00:03,  1.03s/it]Best trial: 67. Best value: 0.102226:  97%|█████████▋| 97/100 [01:38<00:03,  1.03s/it]Best trial: 67. Best value: 0.102226:  98%|█████████▊| 98/100 [01:38<00:01,  1.05it/s]Best trial: 67. Best value: 0.102226:  98%|█████████▊| 98/100 [01:39<00:01,  1.05it/s]Best trial: 67. Best value: 0.102226:  99%|█████████▉| 99/100 [01:39<00:00,  1.09it/s]Best trial: 67. Best value: 0.102226:  99%|█████████▉| 99/100 [01:40<00:00,  1.09it/s]Best trial: 67. Best value: 0.102226: 100%|██████████| 100/100 [01:40<00:00,  1.13it/s]Best trial: 67. Best value: 0.102226: 100%|██████████| 100/100 [01:40<00:00,  1.01s/it]
2025-11-30 11:31:09,748 - INFO - HPO Complete. Best AUPRC: 0.1022
2025-11-30 11:31:09,748 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.06147364173137843, 'max_depth': 3, 'subsample': 0.8153181427559806, 'colsample_bytree': 0.6567251658350235, 'gamma': 4.176506792779999, 'reg_lambda': 0.9384459555624749, 'reg_alpha': 0.0001689696064266864}
2025-11-30 11:31:09,749 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:31:11,960 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 11:31:11,960 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:31:12,067 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:31:12,075 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:31:12,077 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:31:12,077 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:31:12,078 - INFO - Training model...
2025-11-30 11:31:12,581 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:31:17,292 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:31:17,293 - INFO - AUROC: 0.6468 (0.5248 - 0.7942)
2025-11-30 11:31:17,293 - INFO - AUPRC: 0.0425 (0.0163 - 0.1285)
2025-11-30 11:31:17,293 - INFO - Brier Score: 0.0285 (0.0213 - 0.0382)
2025-11-30 11:31:17,293 - INFO - Accuracy: 0.9798 (0.7601 - 0.9850)
2025-11-30 11:31:17,293 - INFO - Precision: 0.1667 (0.0161 - 0.4400)
2025-11-30 11:31:17,293 - INFO - Sensitivity (Recall): 0.1000 (0.0747 - 0.5000)
2025-11-30 11:31:17,293 - INFO - F1-Score: 0.1250 (0.0290 - 0.3133)
2025-11-30 11:31:17,293 - INFO - Best Threshold: 0.6400 (0.0740 - 0.6400)
2025-11-30 11:31:17,293 - INFO - Specificity: 0.9927 (0.7674 - 0.9976)
2025-11-30 11:31:17,300 - INFO - Calculating SHAP values...
2025-11-30 11:31:18,479 - INFO - SHAP plots saved.
2025-11-30 11:31:18,481 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:31:20,084 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 11:31:20,084 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:31:20,190 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:31:20,200 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:31:20,202 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:31:20,202 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0823631:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0823631:   1%|          | 1/100 [00:01<02:44,  1.66s/it]Best trial: 1. Best value: 0.118925:   1%|          | 1/100 [00:03<02:44,  1.66s/it] Best trial: 1. Best value: 0.118925:   2%|▏         | 2/100 [00:03<02:32,  1.56s/it]Best trial: 2. Best value: 0.176822:   2%|▏         | 2/100 [00:03<02:32,  1.56s/it]Best trial: 2. Best value: 0.176822:   3%|▎         | 3/100 [00:03<01:53,  1.17s/it]Best trial: 2. Best value: 0.176822:   3%|▎         | 3/100 [00:05<01:53,  1.17s/it]Best trial: 2. Best value: 0.176822:   4%|▍         | 4/100 [00:05<01:53,  1.18s/it]Best trial: 2. Best value: 0.176822:   4%|▍         | 4/100 [00:06<01:53,  1.18s/it]Best trial: 2. Best value: 0.176822:   5%|▌         | 5/100 [00:06<02:17,  1.45s/it]Best trial: 2. Best value: 0.176822:   5%|▌         | 5/100 [00:08<02:17,  1.45s/it]Best trial: 2. Best value: 0.176822:   6%|▌         | 6/100 [00:08<02:13,  1.42s/it]Best trial: 2. Best value: 0.176822:   6%|▌         | 6/100 [00:09<02:13,  1.42s/it]Best trial: 2. Best value: 0.176822:   7%|▋         | 7/100 [00:09<02:16,  1.46s/it]Best trial: 2. Best value: 0.176822:   7%|▋         | 7/100 [00:10<02:16,  1.46s/it]Best trial: 2. Best value: 0.176822:   8%|▊         | 8/100 [00:10<02:03,  1.34s/it]Best trial: 2. Best value: 0.176822:   8%|▊         | 8/100 [00:12<02:03,  1.34s/it]Best trial: 2. Best value: 0.176822:   9%|▉         | 9/100 [00:12<02:09,  1.42s/it]Best trial: 2. Best value: 0.176822:   9%|▉         | 9/100 [00:14<02:09,  1.42s/it]Best trial: 2. Best value: 0.176822:  10%|█         | 10/100 [00:14<02:30,  1.67s/it]Best trial: 2. Best value: 0.176822:  10%|█         | 10/100 [00:16<02:30,  1.67s/it]Best trial: 2. Best value: 0.176822:  11%|█         | 11/100 [00:16<02:16,  1.53s/it]Best trial: 2. Best value: 0.176822:  11%|█         | 11/100 [00:17<02:16,  1.53s/it]Best trial: 2. Best value: 0.176822:  12%|█▏        | 12/100 [00:17<02:01,  1.38s/it]Best trial: 2. Best value: 0.176822:  12%|█▏        | 12/100 [00:18<02:01,  1.38s/it]Best trial: 2. Best value: 0.176822:  13%|█▎        | 13/100 [00:18<01:50,  1.27s/it]Best trial: 2. Best value: 0.176822:  13%|█▎        | 13/100 [00:19<01:50,  1.27s/it]Best trial: 2. Best value: 0.176822:  14%|█▍        | 14/100 [00:19<02:03,  1.43s/it]Best trial: 2. Best value: 0.176822:  14%|█▍        | 14/100 [00:21<02:03,  1.43s/it]Best trial: 2. Best value: 0.176822:  15%|█▌        | 15/100 [00:21<02:06,  1.49s/it]Best trial: 2. Best value: 0.176822:  15%|█▌        | 15/100 [00:22<02:06,  1.49s/it]Best trial: 2. Best value: 0.176822:  16%|█▌        | 16/100 [00:22<01:56,  1.38s/it]Best trial: 16. Best value: 0.179068:  16%|█▌        | 16/100 [00:23<01:56,  1.38s/it]Best trial: 16. Best value: 0.179068:  17%|█▋        | 17/100 [00:23<01:48,  1.30s/it]Best trial: 16. Best value: 0.179068:  17%|█▋        | 17/100 [00:24<01:48,  1.30s/it]Best trial: 16. Best value: 0.179068:  18%|█▊        | 18/100 [00:24<01:42,  1.25s/it]Best trial: 16. Best value: 0.179068:  18%|█▊        | 18/100 [00:25<01:42,  1.25s/it]Best trial: 16. Best value: 0.179068:  19%|█▉        | 19/100 [00:25<01:27,  1.08s/it]Best trial: 16. Best value: 0.179068:  19%|█▉        | 19/100 [00:26<01:27,  1.08s/it]Best trial: 16. Best value: 0.179068:  20%|██        | 20/100 [00:26<01:28,  1.11s/it]Best trial: 16. Best value: 0.179068:  20%|██        | 20/100 [00:28<01:28,  1.11s/it]Best trial: 16. Best value: 0.179068:  21%|██        | 21/100 [00:28<01:34,  1.19s/it]Best trial: 16. Best value: 0.179068:  21%|██        | 21/100 [00:29<01:34,  1.19s/it]Best trial: 16. Best value: 0.179068:  22%|██▏       | 22/100 [00:29<01:36,  1.24s/it]Best trial: 16. Best value: 0.179068:  22%|██▏       | 22/100 [00:30<01:36,  1.24s/it]Best trial: 16. Best value: 0.179068:  23%|██▎       | 23/100 [00:30<01:33,  1.21s/it]Best trial: 16. Best value: 0.179068:  23%|██▎       | 23/100 [00:32<01:33,  1.21s/it]Best trial: 16. Best value: 0.179068:  24%|██▍       | 24/100 [00:32<01:36,  1.27s/it]Best trial: 16. Best value: 0.179068:  24%|██▍       | 24/100 [00:33<01:36,  1.27s/it]Best trial: 16. Best value: 0.179068:  25%|██▌       | 25/100 [00:33<01:29,  1.19s/it]Best trial: 16. Best value: 0.179068:  25%|██▌       | 25/100 [00:34<01:29,  1.19s/it]Best trial: 16. Best value: 0.179068:  26%|██▌       | 26/100 [00:34<01:27,  1.18s/it]Best trial: 16. Best value: 0.179068:  26%|██▌       | 26/100 [00:35<01:27,  1.18s/it]Best trial: 16. Best value: 0.179068:  27%|██▋       | 27/100 [00:35<01:31,  1.26s/it]Best trial: 16. Best value: 0.179068:  27%|██▋       | 27/100 [00:37<01:31,  1.26s/it]Best trial: 16. Best value: 0.179068:  28%|██▊       | 28/100 [00:37<01:41,  1.40s/it]Best trial: 16. Best value: 0.179068:  28%|██▊       | 28/100 [00:38<01:41,  1.40s/it]Best trial: 16. Best value: 0.179068:  29%|██▉       | 29/100 [00:38<01:43,  1.46s/it]Best trial: 16. Best value: 0.179068:  29%|██▉       | 29/100 [00:41<01:43,  1.46s/it]Best trial: 16. Best value: 0.179068:  30%|███       | 30/100 [00:41<02:02,  1.75s/it]Best trial: 16. Best value: 0.179068:  30%|███       | 30/100 [00:42<02:02,  1.75s/it]Best trial: 16. Best value: 0.179068:  31%|███       | 31/100 [00:42<01:45,  1.54s/it]Best trial: 16. Best value: 0.179068:  31%|███       | 31/100 [00:43<01:45,  1.54s/it]Best trial: 16. Best value: 0.179068:  32%|███▏      | 32/100 [00:43<01:41,  1.49s/it]Best trial: 16. Best value: 0.179068:  32%|███▏      | 32/100 [00:45<01:41,  1.49s/it]Best trial: 16. Best value: 0.179068:  33%|███▎      | 33/100 [00:45<01:39,  1.48s/it]Best trial: 16. Best value: 0.179068:  33%|███▎      | 33/100 [00:46<01:39,  1.48s/it]Best trial: 16. Best value: 0.179068:  34%|███▍      | 34/100 [00:46<01:37,  1.47s/it]Best trial: 16. Best value: 0.179068:  34%|███▍      | 34/100 [00:48<01:37,  1.47s/it]Best trial: 16. Best value: 0.179068:  35%|███▌      | 35/100 [00:48<01:33,  1.44s/it]Best trial: 16. Best value: 0.179068:  35%|███▌      | 35/100 [00:49<01:33,  1.44s/it]Best trial: 16. Best value: 0.179068:  36%|███▌      | 36/100 [00:49<01:36,  1.51s/it]Best trial: 16. Best value: 0.179068:  36%|███▌      | 36/100 [00:51<01:36,  1.51s/it]Best trial: 16. Best value: 0.179068:  37%|███▋      | 37/100 [00:51<01:38,  1.56s/it]Best trial: 16. Best value: 0.179068:  37%|███▋      | 37/100 [00:52<01:38,  1.56s/it]Best trial: 16. Best value: 0.179068:  38%|███▊      | 38/100 [00:52<01:28,  1.43s/it]Best trial: 16. Best value: 0.179068:  38%|███▊      | 38/100 [00:53<01:28,  1.43s/it]Best trial: 16. Best value: 0.179068:  39%|███▉      | 39/100 [00:53<01:26,  1.42s/it]Best trial: 16. Best value: 0.179068:  39%|███▉      | 39/100 [00:55<01:26,  1.42s/it]Best trial: 16. Best value: 0.179068:  40%|████      | 40/100 [00:55<01:28,  1.48s/it]Best trial: 16. Best value: 0.179068:  40%|████      | 40/100 [00:56<01:28,  1.48s/it]Best trial: 16. Best value: 0.179068:  41%|████      | 41/100 [00:56<01:24,  1.42s/it]Best trial: 16. Best value: 0.179068:  41%|████      | 41/100 [00:58<01:24,  1.42s/it]Best trial: 16. Best value: 0.179068:  42%|████▏     | 42/100 [00:58<01:23,  1.44s/it]Best trial: 16. Best value: 0.179068:  42%|████▏     | 42/100 [00:59<01:23,  1.44s/it]Best trial: 16. Best value: 0.179068:  43%|████▎     | 43/100 [00:59<01:22,  1.44s/it]Best trial: 16. Best value: 0.179068:  43%|████▎     | 43/100 [01:01<01:22,  1.44s/it]Best trial: 16. Best value: 0.179068:  44%|████▍     | 44/100 [01:01<01:19,  1.42s/it]Best trial: 16. Best value: 0.179068:  44%|████▍     | 44/100 [01:02<01:19,  1.42s/it]Best trial: 16. Best value: 0.179068:  45%|████▌     | 45/100 [01:02<01:12,  1.33s/it]Best trial: 16. Best value: 0.179068:  45%|████▌     | 45/100 [01:04<01:12,  1.33s/it]Best trial: 16. Best value: 0.179068:  46%|████▌     | 46/100 [01:04<01:18,  1.45s/it]Best trial: 16. Best value: 0.179068:  46%|████▌     | 46/100 [01:05<01:18,  1.45s/it]Best trial: 16. Best value: 0.179068:  47%|████▋     | 47/100 [01:05<01:15,  1.42s/it]Best trial: 16. Best value: 0.179068:  47%|████▋     | 47/100 [01:06<01:15,  1.42s/it]Best trial: 16. Best value: 0.179068:  48%|████▊     | 48/100 [01:06<01:10,  1.35s/it]Best trial: 16. Best value: 0.179068:  48%|████▊     | 48/100 [01:07<01:10,  1.35s/it]Best trial: 16. Best value: 0.179068:  49%|████▉     | 49/100 [01:07<01:08,  1.34s/it]Best trial: 16. Best value: 0.179068:  49%|████▉     | 49/100 [01:09<01:08,  1.34s/it]Best trial: 16. Best value: 0.179068:  50%|█████     | 50/100 [01:09<01:05,  1.31s/it]Best trial: 16. Best value: 0.179068:  50%|█████     | 50/100 [01:11<01:05,  1.31s/it]Best trial: 16. Best value: 0.179068:  51%|█████     | 51/100 [01:11<01:25,  1.75s/it]Best trial: 51. Best value: 0.18901:  51%|█████     | 51/100 [01:13<01:25,  1.75s/it] Best trial: 51. Best value: 0.18901:  52%|█████▏    | 52/100 [01:13<01:16,  1.59s/it]Best trial: 51. Best value: 0.18901:  52%|█████▏    | 52/100 [01:14<01:16,  1.59s/it]Best trial: 51. Best value: 0.18901:  53%|█████▎    | 53/100 [01:14<01:07,  1.43s/it]Best trial: 51. Best value: 0.18901:  53%|█████▎    | 53/100 [01:15<01:07,  1.43s/it]Best trial: 51. Best value: 0.18901:  54%|█████▍    | 54/100 [01:15<01:02,  1.36s/it]Best trial: 51. Best value: 0.18901:  54%|█████▍    | 54/100 [01:16<01:02,  1.36s/it]Best trial: 51. Best value: 0.18901:  55%|█████▌    | 55/100 [01:16<00:56,  1.26s/it]Best trial: 51. Best value: 0.18901:  55%|█████▌    | 55/100 [01:17<00:56,  1.26s/it]Best trial: 51. Best value: 0.18901:  56%|█████▌    | 56/100 [01:17<00:53,  1.22s/it]Best trial: 51. Best value: 0.18901:  56%|█████▌    | 56/100 [01:18<00:53,  1.22s/it]Best trial: 51. Best value: 0.18901:  57%|█████▋    | 57/100 [01:18<00:49,  1.14s/it]Best trial: 51. Best value: 0.18901:  57%|█████▋    | 57/100 [01:19<00:49,  1.14s/it]Best trial: 51. Best value: 0.18901:  58%|█████▊    | 58/100 [01:19<00:48,  1.16s/it]Best trial: 51. Best value: 0.18901:  58%|█████▊    | 58/100 [01:20<00:48,  1.16s/it]Best trial: 51. Best value: 0.18901:  59%|█████▉    | 59/100 [01:20<00:49,  1.20s/it]Best trial: 51. Best value: 0.18901:  59%|█████▉    | 59/100 [01:22<00:49,  1.20s/it]Best trial: 51. Best value: 0.18901:  60%|██████    | 60/100 [01:22<00:49,  1.23s/it]Best trial: 51. Best value: 0.18901:  60%|██████    | 60/100 [01:23<00:49,  1.23s/it]Best trial: 51. Best value: 0.18901:  61%|██████    | 61/100 [01:23<00:46,  1.20s/it]Best trial: 51. Best value: 0.18901:  61%|██████    | 61/100 [01:24<00:46,  1.20s/it]Best trial: 51. Best value: 0.18901:  62%|██████▏   | 62/100 [01:24<00:44,  1.17s/it]Best trial: 51. Best value: 0.18901:  62%|██████▏   | 62/100 [01:25<00:44,  1.17s/it]Best trial: 51. Best value: 0.18901:  63%|██████▎   | 63/100 [01:25<00:45,  1.24s/it]Best trial: 51. Best value: 0.18901:  63%|██████▎   | 63/100 [01:26<00:45,  1.24s/it]Best trial: 51. Best value: 0.18901:  64%|██████▍   | 64/100 [01:26<00:40,  1.13s/it]Best trial: 51. Best value: 0.18901:  64%|██████▍   | 64/100 [01:28<00:40,  1.13s/it]Best trial: 51. Best value: 0.18901:  65%|██████▌   | 65/100 [01:28<00:49,  1.41s/it]Best trial: 51. Best value: 0.18901:  65%|██████▌   | 65/100 [01:31<00:49,  1.41s/it]Best trial: 51. Best value: 0.18901:  66%|██████▌   | 66/100 [01:31<00:55,  1.64s/it]Best trial: 51. Best value: 0.18901:  66%|██████▌   | 66/100 [01:33<00:55,  1.64s/it]Best trial: 51. Best value: 0.18901:  67%|██████▋   | 67/100 [01:33<01:00,  1.84s/it]Best trial: 51. Best value: 0.18901:  67%|██████▋   | 67/100 [01:35<01:00,  1.84s/it]Best trial: 51. Best value: 0.18901:  68%|██████▊   | 68/100 [01:35<01:01,  1.92s/it]Best trial: 51. Best value: 0.18901:  68%|██████▊   | 68/100 [01:37<01:01,  1.92s/it]Best trial: 51. Best value: 0.18901:  69%|██████▉   | 69/100 [01:37<00:58,  1.89s/it]Best trial: 51. Best value: 0.18901:  69%|██████▉   | 69/100 [01:39<00:58,  1.89s/it]Best trial: 51. Best value: 0.18901:  70%|███████   | 70/100 [01:39<00:57,  1.93s/it]Best trial: 51. Best value: 0.18901:  70%|███████   | 70/100 [01:40<00:57,  1.93s/it]Best trial: 51. Best value: 0.18901:  71%|███████   | 71/100 [01:40<00:47,  1.65s/it]Best trial: 51. Best value: 0.18901:  71%|███████   | 71/100 [01:41<00:47,  1.65s/it]Best trial: 51. Best value: 0.18901:  72%|███████▏  | 72/100 [01:41<00:42,  1.53s/it]Best trial: 72. Best value: 0.189119:  72%|███████▏  | 72/100 [01:42<00:42,  1.53s/it]Best trial: 72. Best value: 0.189119:  73%|███████▎  | 73/100 [01:42<00:37,  1.39s/it]Best trial: 72. Best value: 0.189119:  73%|███████▎  | 73/100 [01:43<00:37,  1.39s/it]Best trial: 72. Best value: 0.189119:  74%|███████▍  | 74/100 [01:43<00:33,  1.30s/it]Best trial: 72. Best value: 0.189119:  74%|███████▍  | 74/100 [01:44<00:33,  1.30s/it]Best trial: 72. Best value: 0.189119:  75%|███████▌  | 75/100 [01:44<00:31,  1.25s/it]Best trial: 72. Best value: 0.189119:  75%|███████▌  | 75/100 [01:45<00:31,  1.25s/it]Best trial: 72. Best value: 0.189119:  76%|███████▌  | 76/100 [01:45<00:29,  1.22s/it]Best trial: 72. Best value: 0.189119:  76%|███████▌  | 76/100 [01:46<00:29,  1.22s/it]Best trial: 72. Best value: 0.189119:  77%|███████▋  | 77/100 [01:46<00:26,  1.14s/it]Best trial: 72. Best value: 0.189119:  77%|███████▋  | 77/100 [01:48<00:26,  1.14s/it]Best trial: 72. Best value: 0.189119:  78%|███████▊  | 78/100 [01:48<00:29,  1.35s/it]Best trial: 72. Best value: 0.189119:  78%|███████▊  | 78/100 [01:49<00:29,  1.35s/it]Best trial: 72. Best value: 0.189119:  79%|███████▉  | 79/100 [01:49<00:27,  1.30s/it]Best trial: 72. Best value: 0.189119:  79%|███████▉  | 79/100 [01:50<00:27,  1.30s/it]Best trial: 72. Best value: 0.189119:  80%|████████  | 80/100 [01:50<00:24,  1.22s/it]Best trial: 72. Best value: 0.189119:  80%|████████  | 80/100 [01:52<00:24,  1.22s/it]Best trial: 72. Best value: 0.189119:  81%|████████  | 81/100 [01:52<00:23,  1.23s/it]Best trial: 72. Best value: 0.189119:  81%|████████  | 81/100 [01:53<00:23,  1.23s/it]Best trial: 72. Best value: 0.189119:  82%|████████▏ | 82/100 [01:53<00:23,  1.28s/it]Best trial: 72. Best value: 0.189119:  82%|████████▏ | 82/100 [01:55<00:23,  1.28s/it]Best trial: 72. Best value: 0.189119:  83%|████████▎ | 83/100 [01:55<00:22,  1.33s/it]Best trial: 72. Best value: 0.189119:  83%|████████▎ | 83/100 [01:56<00:22,  1.33s/it]Best trial: 72. Best value: 0.189119:  84%|████████▍ | 84/100 [01:56<00:20,  1.25s/it]Best trial: 72. Best value: 0.189119:  84%|████████▍ | 84/100 [01:57<00:20,  1.25s/it]Best trial: 72. Best value: 0.189119:  85%|████████▌ | 85/100 [01:57<00:19,  1.30s/it]Best trial: 72. Best value: 0.189119:  85%|████████▌ | 85/100 [01:59<00:19,  1.30s/it]Best trial: 72. Best value: 0.189119:  86%|████████▌ | 86/100 [01:59<00:20,  1.47s/it]Best trial: 72. Best value: 0.189119:  86%|████████▌ | 86/100 [02:01<00:20,  1.47s/it]Best trial: 72. Best value: 0.189119:  87%|████████▋ | 87/100 [02:01<00:21,  1.67s/it]Best trial: 72. Best value: 0.189119:  87%|████████▋ | 87/100 [02:02<00:21,  1.67s/it]Best trial: 72. Best value: 0.189119:  88%|████████▊ | 88/100 [02:02<00:18,  1.54s/it]Best trial: 72. Best value: 0.189119:  88%|████████▊ | 88/100 [02:04<00:18,  1.54s/it]Best trial: 72. Best value: 0.189119:  89%|████████▉ | 89/100 [02:04<00:17,  1.57s/it]Best trial: 72. Best value: 0.189119:  89%|████████▉ | 89/100 [02:05<00:17,  1.57s/it]Best trial: 72. Best value: 0.189119:  90%|█████████ | 90/100 [02:05<00:14,  1.44s/it]Best trial: 72. Best value: 0.189119:  90%|█████████ | 90/100 [02:07<00:14,  1.44s/it]Best trial: 72. Best value: 0.189119:  91%|█████████ | 91/100 [02:07<00:12,  1.44s/it]Best trial: 72. Best value: 0.189119:  91%|█████████ | 91/100 [02:08<00:12,  1.44s/it]Best trial: 72. Best value: 0.189119:  92%|█████████▏| 92/100 [02:08<00:11,  1.40s/it]Best trial: 72. Best value: 0.189119:  92%|█████████▏| 92/100 [02:09<00:11,  1.40s/it]Best trial: 72. Best value: 0.189119:  93%|█████████▎| 93/100 [02:09<00:09,  1.30s/it]Best trial: 72. Best value: 0.189119:  93%|█████████▎| 93/100 [02:10<00:09,  1.30s/it]Best trial: 72. Best value: 0.189119:  94%|█████████▍| 94/100 [02:10<00:07,  1.22s/it]Best trial: 72. Best value: 0.189119:  94%|█████████▍| 94/100 [02:11<00:07,  1.22s/it]Best trial: 72. Best value: 0.189119:  95%|█████████▌| 95/100 [02:11<00:05,  1.14s/it]Best trial: 72. Best value: 0.189119:  95%|█████████▌| 95/100 [02:12<00:05,  1.14s/it]Best trial: 72. Best value: 0.189119:  96%|█████████▌| 96/100 [02:12<00:04,  1.17s/it]Best trial: 72. Best value: 0.189119:  96%|█████████▌| 96/100 [02:13<00:04,  1.17s/it]Best trial: 72. Best value: 0.189119:  97%|█████████▋| 97/100 [02:13<00:03,  1.16s/it]Best trial: 72. Best value: 0.189119:  97%|█████████▋| 97/100 [02:15<00:03,  1.16s/it]Best trial: 72. Best value: 0.189119:  98%|█████████▊| 98/100 [02:15<00:02,  1.24s/it]Best trial: 72. Best value: 0.189119:  98%|█████████▊| 98/100 [02:16<00:02,  1.24s/it]Best trial: 72. Best value: 0.189119:  99%|█████████▉| 99/100 [02:16<00:01,  1.15s/it]Best trial: 72. Best value: 0.189119:  99%|█████████▉| 99/100 [02:17<00:01,  1.15s/it]Best trial: 72. Best value: 0.189119: 100%|██████████| 100/100 [02:17<00:00,  1.23s/it]Best trial: 72. Best value: 0.189119: 100%|██████████| 100/100 [02:17<00:00,  1.38s/it]
2025-11-30 11:33:37,736 - INFO - HPO Complete. Best AUPRC: 0.1891
2025-11-30 11:33:37,737 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.0014556194711321379, 'max_depth': 4, 'subsample': 0.7964815930155906, 'colsample_bytree': 0.7942809361164006, 'gamma': 0.836703378950596, 'reg_lambda': 4.2004029777472725e-08, 'reg_alpha': 0.9857166614222885}
2025-11-30 11:33:37,737 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:33:39,643 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 11:33:39,643 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:33:39,726 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:33:39,732 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:33:39,734 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:33:39,734 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:33:39,734 - INFO - Training model...
2025-11-30 11:33:40,496 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:33:45,200 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:33:45,200 - INFO - AUROC: 0.6133 (0.4465 - 0.7356)
2025-11-30 11:33:45,200 - INFO - AUPRC: 0.0216 (0.0140 - 0.0412)
2025-11-30 11:33:45,200 - INFO - Brier Score: 0.1631 (0.1599 - 0.1666)
2025-11-30 11:33:45,200 - INFO - Accuracy: 0.7616 (0.3428 - 0.9017)
2025-11-30 11:33:45,200 - INFO - Precision: 0.0245 (0.0162 - 0.0522)
2025-11-30 11:33:45,200 - INFO - Sensitivity (Recall): 0.4000 (0.2423 - 1.0000)
2025-11-30 11:33:45,200 - INFO - F1-Score: 0.0462 (0.0317 - 0.0900)
2025-11-30 11:33:45,200 - INFO - Best Threshold: 0.4200 (0.3700 - 0.4700)
2025-11-30 11:33:45,200 - INFO - Specificity: 0.7669 (0.3355 - 0.9116)
2025-11-30 11:33:45,209 - INFO - Calculating SHAP values...
2025-11-30 11:33:46,263 - INFO - SHAP plots saved.
2025-11-30 11:33:46,264 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:33:47,417 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 11:33:47,417 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:33:47,501 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:33:47,509 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:33:47,511 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:33:47,511 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0602867:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0602867:   1%|          | 1/100 [00:01<01:46,  1.07s/it]Best trial: 1. Best value: 0.065461:   1%|          | 1/100 [00:02<01:46,  1.07s/it] Best trial: 1. Best value: 0.065461:   2%|▏         | 2/100 [00:02<01:42,  1.05s/it]Best trial: 1. Best value: 0.065461:   2%|▏         | 2/100 [00:02<01:42,  1.05s/it]Best trial: 1. Best value: 0.065461:   3%|▎         | 3/100 [00:02<01:23,  1.16it/s]Best trial: 1. Best value: 0.065461:   3%|▎         | 3/100 [00:04<01:23,  1.16it/s]Best trial: 1. Best value: 0.065461:   4%|▍         | 4/100 [00:04<01:41,  1.06s/it]Best trial: 1. Best value: 0.065461:   4%|▍         | 4/100 [00:05<01:41,  1.06s/it]Best trial: 1. Best value: 0.065461:   5%|▌         | 5/100 [00:05<01:46,  1.12s/it]Best trial: 1. Best value: 0.065461:   5%|▌         | 5/100 [00:06<01:46,  1.12s/it]Best trial: 1. Best value: 0.065461:   6%|▌         | 6/100 [00:06<01:49,  1.16s/it]Best trial: 1. Best value: 0.065461:   6%|▌         | 6/100 [00:07<01:49,  1.16s/it]Best trial: 1. Best value: 0.065461:   7%|▋         | 7/100 [00:07<01:46,  1.15s/it]Best trial: 1. Best value: 0.065461:   7%|▋         | 7/100 [00:09<01:46,  1.15s/it]Best trial: 1. Best value: 0.065461:   8%|▊         | 8/100 [00:09<01:55,  1.26s/it]Best trial: 1. Best value: 0.065461:   8%|▊         | 8/100 [00:10<01:55,  1.26s/it]Best trial: 1. Best value: 0.065461:   9%|▉         | 9/100 [00:10<02:01,  1.33s/it]Best trial: 9. Best value: 0.0771909:   9%|▉         | 9/100 [00:11<02:01,  1.33s/it]Best trial: 9. Best value: 0.0771909:  10%|█         | 10/100 [00:11<01:57,  1.31s/it]Best trial: 9. Best value: 0.0771909:  10%|█         | 10/100 [00:12<01:57,  1.31s/it]Best trial: 9. Best value: 0.0771909:  11%|█         | 11/100 [00:12<01:47,  1.21s/it]Best trial: 9. Best value: 0.0771909:  11%|█         | 11/100 [00:13<01:47,  1.21s/it]Best trial: 9. Best value: 0.0771909:  12%|█▏        | 12/100 [00:13<01:40,  1.14s/it]Best trial: 9. Best value: 0.0771909:  12%|█▏        | 12/100 [00:15<01:40,  1.14s/it]Best trial: 9. Best value: 0.0771909:  13%|█▎        | 13/100 [00:15<01:39,  1.14s/it]Best trial: 9. Best value: 0.0771909:  13%|█▎        | 13/100 [00:16<01:39,  1.14s/it]Best trial: 9. Best value: 0.0771909:  14%|█▍        | 14/100 [00:16<01:40,  1.16s/it]Best trial: 9. Best value: 0.0771909:  14%|█▍        | 14/100 [00:17<01:40,  1.16s/it]Best trial: 9. Best value: 0.0771909:  15%|█▌        | 15/100 [00:17<01:39,  1.17s/it]Best trial: 9. Best value: 0.0771909:  15%|█▌        | 15/100 [00:18<01:39,  1.17s/it]Best trial: 9. Best value: 0.0771909:  16%|█▌        | 16/100 [00:18<01:26,  1.03s/it]Best trial: 16. Best value: 0.0793945:  16%|█▌        | 16/100 [00:19<01:26,  1.03s/it]Best trial: 16. Best value: 0.0793945:  17%|█▋        | 17/100 [00:19<01:38,  1.19s/it]Best trial: 16. Best value: 0.0793945:  17%|█▋        | 17/100 [00:21<01:38,  1.19s/it]Best trial: 16. Best value: 0.0793945:  18%|█▊        | 18/100 [00:21<01:39,  1.22s/it]Best trial: 16. Best value: 0.0793945:  18%|█▊        | 18/100 [00:22<01:39,  1.22s/it]Best trial: 16. Best value: 0.0793945:  19%|█▉        | 19/100 [00:22<01:56,  1.43s/it]Best trial: 16. Best value: 0.0793945:  19%|█▉        | 19/100 [00:24<01:56,  1.43s/it]Best trial: 16. Best value: 0.0793945:  20%|██        | 20/100 [00:24<01:50,  1.38s/it]Best trial: 16. Best value: 0.0793945:  20%|██        | 20/100 [00:26<01:50,  1.38s/it]Best trial: 16. Best value: 0.0793945:  21%|██        | 21/100 [00:26<01:59,  1.51s/it]Best trial: 16. Best value: 0.0793945:  21%|██        | 21/100 [00:27<01:59,  1.51s/it]Best trial: 16. Best value: 0.0793945:  22%|██▏       | 22/100 [00:27<01:47,  1.38s/it]Best trial: 16. Best value: 0.0793945:  22%|██▏       | 22/100 [00:27<01:47,  1.38s/it]Best trial: 16. Best value: 0.0793945:  23%|██▎       | 23/100 [00:27<01:32,  1.20s/it]Best trial: 16. Best value: 0.0793945:  23%|██▎       | 23/100 [00:29<01:32,  1.20s/it]Best trial: 16. Best value: 0.0793945:  24%|██▍       | 24/100 [00:29<01:32,  1.21s/it]Best trial: 16. Best value: 0.0793945:  24%|██▍       | 24/100 [00:30<01:32,  1.21s/it]Best trial: 16. Best value: 0.0793945:  25%|██▌       | 25/100 [00:30<01:33,  1.25s/it]Best trial: 16. Best value: 0.0793945:  25%|██▌       | 25/100 [00:31<01:33,  1.25s/it]Best trial: 16. Best value: 0.0793945:  26%|██▌       | 26/100 [00:31<01:26,  1.17s/it]Best trial: 16. Best value: 0.0793945:  26%|██▌       | 26/100 [00:32<01:26,  1.17s/it]Best trial: 16. Best value: 0.0793945:  27%|██▋       | 27/100 [00:32<01:20,  1.11s/it]Best trial: 16. Best value: 0.0793945:  27%|██▋       | 27/100 [00:33<01:20,  1.11s/it]Best trial: 16. Best value: 0.0793945:  28%|██▊       | 28/100 [00:33<01:21,  1.13s/it]Best trial: 16. Best value: 0.0793945:  28%|██▊       | 28/100 [00:34<01:21,  1.13s/it]Best trial: 16. Best value: 0.0793945:  29%|██▉       | 29/100 [00:34<01:22,  1.17s/it]Best trial: 16. Best value: 0.0793945:  29%|██▉       | 29/100 [00:36<01:22,  1.17s/it]Best trial: 16. Best value: 0.0793945:  30%|███       | 30/100 [00:36<01:23,  1.19s/it]Best trial: 16. Best value: 0.0793945:  30%|███       | 30/100 [00:37<01:23,  1.19s/it]Best trial: 16. Best value: 0.0793945:  31%|███       | 31/100 [00:37<01:31,  1.32s/it]Best trial: 16. Best value: 0.0793945:  31%|███       | 31/100 [00:38<01:31,  1.32s/it]Best trial: 16. Best value: 0.0793945:  32%|███▏      | 32/100 [00:38<01:21,  1.21s/it]Best trial: 16. Best value: 0.0793945:  32%|███▏      | 32/100 [00:39<01:21,  1.21s/it]Best trial: 16. Best value: 0.0793945:  33%|███▎      | 33/100 [00:39<01:16,  1.14s/it]Best trial: 16. Best value: 0.0793945:  33%|███▎      | 33/100 [00:41<01:16,  1.14s/it]Best trial: 16. Best value: 0.0793945:  34%|███▍      | 34/100 [00:41<01:24,  1.28s/it]Best trial: 16. Best value: 0.0793945:  34%|███▍      | 34/100 [00:42<01:24,  1.28s/it]Best trial: 16. Best value: 0.0793945:  35%|███▌      | 35/100 [00:42<01:19,  1.22s/it]Best trial: 16. Best value: 0.0793945:  35%|███▌      | 35/100 [00:43<01:19,  1.22s/it]Best trial: 16. Best value: 0.0793945:  36%|███▌      | 36/100 [00:43<01:20,  1.25s/it]Best trial: 16. Best value: 0.0793945:  36%|███▌      | 36/100 [00:44<01:20,  1.25s/it]Best trial: 16. Best value: 0.0793945:  37%|███▋      | 37/100 [00:44<01:09,  1.10s/it]Best trial: 16. Best value: 0.0793945:  37%|███▋      | 37/100 [00:45<01:09,  1.10s/it]Best trial: 16. Best value: 0.0793945:  38%|███▊      | 38/100 [00:45<01:07,  1.08s/it]Best trial: 16. Best value: 0.0793945:  38%|███▊      | 38/100 [00:46<01:07,  1.08s/it]Best trial: 16. Best value: 0.0793945:  39%|███▉      | 39/100 [00:46<01:09,  1.14s/it]Best trial: 16. Best value: 0.0793945:  39%|███▉      | 39/100 [00:48<01:09,  1.14s/it]Best trial: 16. Best value: 0.0793945:  40%|████      | 40/100 [00:48<01:24,  1.40s/it]Best trial: 16. Best value: 0.0793945:  40%|████      | 40/100 [00:50<01:24,  1.40s/it]Best trial: 16. Best value: 0.0793945:  41%|████      | 41/100 [00:50<01:22,  1.40s/it]Best trial: 16. Best value: 0.0793945:  41%|████      | 41/100 [00:51<01:22,  1.40s/it]Best trial: 16. Best value: 0.0793945:  42%|████▏     | 42/100 [00:51<01:18,  1.35s/it]Best trial: 16. Best value: 0.0793945:  42%|████▏     | 42/100 [00:52<01:18,  1.35s/it]Best trial: 16. Best value: 0.0793945:  43%|████▎     | 43/100 [00:52<01:14,  1.31s/it]Best trial: 16. Best value: 0.0793945:  43%|████▎     | 43/100 [00:54<01:14,  1.31s/it]Best trial: 16. Best value: 0.0793945:  44%|████▍     | 44/100 [00:54<01:16,  1.37s/it]Best trial: 16. Best value: 0.0793945:  44%|████▍     | 44/100 [00:55<01:16,  1.37s/it]Best trial: 16. Best value: 0.0793945:  45%|████▌     | 45/100 [00:55<01:11,  1.29s/it]Best trial: 16. Best value: 0.0793945:  45%|████▌     | 45/100 [00:56<01:11,  1.29s/it]Best trial: 16. Best value: 0.0793945:  46%|████▌     | 46/100 [00:56<01:15,  1.40s/it]Best trial: 16. Best value: 0.0793945:  46%|████▌     | 46/100 [00:58<01:15,  1.40s/it]Best trial: 16. Best value: 0.0793945:  47%|████▋     | 47/100 [00:58<01:18,  1.48s/it]Best trial: 47. Best value: 0.0887322:  47%|████▋     | 47/100 [00:59<01:18,  1.48s/it]Best trial: 47. Best value: 0.0887322:  48%|████▊     | 48/100 [00:59<01:10,  1.36s/it]Best trial: 47. Best value: 0.0887322:  48%|████▊     | 48/100 [01:01<01:10,  1.36s/it]Best trial: 47. Best value: 0.0887322:  49%|████▉     | 49/100 [01:01<01:24,  1.65s/it]Best trial: 47. Best value: 0.0887322:  49%|████▉     | 49/100 [01:03<01:24,  1.65s/it]Best trial: 47. Best value: 0.0887322:  50%|█████     | 50/100 [01:03<01:18,  1.57s/it]Best trial: 47. Best value: 0.0887322:  50%|█████     | 50/100 [01:04<01:18,  1.57s/it]Best trial: 47. Best value: 0.0887322:  51%|█████     | 51/100 [01:04<01:14,  1.52s/it]Best trial: 47. Best value: 0.0887322:  51%|█████     | 51/100 [01:05<01:14,  1.52s/it]Best trial: 47. Best value: 0.0887322:  52%|█████▏    | 52/100 [01:05<01:08,  1.42s/it]Best trial: 47. Best value: 0.0887322:  52%|█████▏    | 52/100 [01:07<01:08,  1.42s/it]Best trial: 47. Best value: 0.0887322:  53%|█████▎    | 53/100 [01:07<01:05,  1.39s/it]Best trial: 47. Best value: 0.0887322:  53%|█████▎    | 53/100 [01:08<01:05,  1.39s/it]Best trial: 47. Best value: 0.0887322:  54%|█████▍    | 54/100 [01:08<01:01,  1.33s/it]Best trial: 47. Best value: 0.0887322:  54%|█████▍    | 54/100 [01:09<01:01,  1.33s/it]Best trial: 47. Best value: 0.0887322:  55%|█████▌    | 55/100 [01:09<01:02,  1.40s/it]Best trial: 47. Best value: 0.0887322:  55%|█████▌    | 55/100 [01:11<01:02,  1.40s/it]Best trial: 47. Best value: 0.0887322:  56%|█████▌    | 56/100 [01:11<01:02,  1.41s/it]Best trial: 47. Best value: 0.0887322:  56%|█████▌    | 56/100 [01:12<01:02,  1.41s/it]Best trial: 47. Best value: 0.0887322:  57%|█████▋    | 57/100 [01:12<00:58,  1.36s/it]Best trial: 47. Best value: 0.0887322:  57%|█████▋    | 57/100 [01:14<00:58,  1.36s/it]Best trial: 47. Best value: 0.0887322:  58%|█████▊    | 58/100 [01:14<00:57,  1.38s/it]Best trial: 47. Best value: 0.0887322:  58%|█████▊    | 58/100 [01:15<00:57,  1.38s/it]Best trial: 47. Best value: 0.0887322:  59%|█████▉    | 59/100 [01:15<01:01,  1.49s/it]Best trial: 47. Best value: 0.0887322:  59%|█████▉    | 59/100 [01:17<01:01,  1.49s/it]Best trial: 47. Best value: 0.0887322:  60%|██████    | 60/100 [01:17<01:06,  1.66s/it]Best trial: 47. Best value: 0.0887322:  60%|██████    | 60/100 [01:19<01:06,  1.66s/it]Best trial: 47. Best value: 0.0887322:  61%|██████    | 61/100 [01:19<01:01,  1.57s/it]Best trial: 47. Best value: 0.0887322:  61%|██████    | 61/100 [01:20<01:01,  1.57s/it]Best trial: 47. Best value: 0.0887322:  62%|██████▏   | 62/100 [01:20<01:00,  1.58s/it]Best trial: 47. Best value: 0.0887322:  62%|██████▏   | 62/100 [01:21<01:00,  1.58s/it]Best trial: 47. Best value: 0.0887322:  63%|██████▎   | 63/100 [01:21<00:52,  1.42s/it]Best trial: 47. Best value: 0.0887322:  63%|██████▎   | 63/100 [01:23<00:52,  1.42s/it]Best trial: 47. Best value: 0.0887322:  64%|██████▍   | 64/100 [01:23<00:49,  1.38s/it]Best trial: 47. Best value: 0.0887322:  64%|██████▍   | 64/100 [01:24<00:49,  1.38s/it]Best trial: 47. Best value: 0.0887322:  65%|██████▌   | 65/100 [01:24<00:48,  1.37s/it]Best trial: 47. Best value: 0.0887322:  65%|██████▌   | 65/100 [01:26<00:48,  1.37s/it]Best trial: 47. Best value: 0.0887322:  66%|██████▌   | 66/100 [01:26<00:53,  1.57s/it]Best trial: 47. Best value: 0.0887322:  66%|██████▌   | 66/100 [01:27<00:53,  1.57s/it]Best trial: 47. Best value: 0.0887322:  67%|██████▋   | 67/100 [01:27<00:47,  1.44s/it]Best trial: 47. Best value: 0.0887322:  67%|██████▋   | 67/100 [01:28<00:47,  1.44s/it]Best trial: 47. Best value: 0.0887322:  68%|██████▊   | 68/100 [01:28<00:42,  1.32s/it]Best trial: 47. Best value: 0.0887322:  68%|██████▊   | 68/100 [01:29<00:42,  1.32s/it]Best trial: 47. Best value: 0.0887322:  69%|██████▉   | 69/100 [01:29<00:38,  1.24s/it]Best trial: 47. Best value: 0.0887322:  69%|██████▉   | 69/100 [01:30<00:38,  1.24s/it]Best trial: 47. Best value: 0.0887322:  70%|███████   | 70/100 [01:30<00:35,  1.17s/it]Best trial: 47. Best value: 0.0887322:  70%|███████   | 70/100 [01:31<00:35,  1.17s/it]Best trial: 47. Best value: 0.0887322:  71%|███████   | 71/100 [01:31<00:32,  1.14s/it]Best trial: 47. Best value: 0.0887322:  71%|███████   | 71/100 [01:32<00:32,  1.14s/it]Best trial: 47. Best value: 0.0887322:  72%|███████▏  | 72/100 [01:32<00:31,  1.12s/it]Best trial: 72. Best value: 0.0932323:  72%|███████▏  | 72/100 [01:34<00:31,  1.12s/it]Best trial: 72. Best value: 0.0932323:  73%|███████▎  | 73/100 [01:34<00:31,  1.15s/it]Best trial: 72. Best value: 0.0932323:  73%|███████▎  | 73/100 [01:35<00:31,  1.15s/it]Best trial: 72. Best value: 0.0932323:  74%|███████▍  | 74/100 [01:35<00:29,  1.15s/it]Best trial: 72. Best value: 0.0932323:  74%|███████▍  | 74/100 [01:36<00:29,  1.15s/it]Best trial: 72. Best value: 0.0932323:  75%|███████▌  | 75/100 [01:36<00:30,  1.22s/it]Best trial: 72. Best value: 0.0932323:  75%|███████▌  | 75/100 [01:38<00:30,  1.22s/it]Best trial: 72. Best value: 0.0932323:  76%|███████▌  | 76/100 [01:38<00:30,  1.26s/it]Best trial: 76. Best value: 0.104285:  76%|███████▌  | 76/100 [01:39<00:30,  1.26s/it] Best trial: 76. Best value: 0.104285:  77%|███████▋  | 77/100 [01:39<00:30,  1.35s/it]Best trial: 76. Best value: 0.104285:  77%|███████▋  | 77/100 [01:41<00:30,  1.35s/it]Best trial: 76. Best value: 0.104285:  78%|███████▊  | 78/100 [01:41<00:30,  1.40s/it]Best trial: 76. Best value: 0.104285:  78%|███████▊  | 78/100 [01:42<00:30,  1.40s/it]Best trial: 76. Best value: 0.104285:  79%|███████▉  | 79/100 [01:42<00:29,  1.42s/it]Best trial: 76. Best value: 0.104285:  79%|███████▉  | 79/100 [01:43<00:29,  1.42s/it]Best trial: 76. Best value: 0.104285:  80%|████████  | 80/100 [01:43<00:27,  1.35s/it]Best trial: 80. Best value: 0.115969:  80%|████████  | 80/100 [01:45<00:27,  1.35s/it]Best trial: 80. Best value: 0.115969:  81%|████████  | 81/100 [01:45<00:26,  1.39s/it]Best trial: 80. Best value: 0.115969:  81%|████████  | 81/100 [01:46<00:26,  1.39s/it]Best trial: 80. Best value: 0.115969:  82%|████████▏ | 82/100 [01:46<00:25,  1.42s/it]Best trial: 80. Best value: 0.115969:  82%|████████▏ | 82/100 [01:48<00:25,  1.42s/it]Best trial: 80. Best value: 0.115969:  83%|████████▎ | 83/100 [01:48<00:24,  1.44s/it]Best trial: 80. Best value: 0.115969:  83%|████████▎ | 83/100 [01:49<00:24,  1.44s/it]Best trial: 80. Best value: 0.115969:  84%|████████▍ | 84/100 [01:49<00:22,  1.43s/it]Best trial: 80. Best value: 0.115969:  84%|████████▍ | 84/100 [01:51<00:22,  1.43s/it]Best trial: 80. Best value: 0.115969:  85%|████████▌ | 85/100 [01:51<00:21,  1.46s/it]Best trial: 80. Best value: 0.115969:  85%|████████▌ | 85/100 [01:52<00:21,  1.46s/it]Best trial: 80. Best value: 0.115969:  86%|████████▌ | 86/100 [01:52<00:19,  1.39s/it]Best trial: 80. Best value: 0.115969:  86%|████████▌ | 86/100 [01:53<00:19,  1.39s/it]Best trial: 80. Best value: 0.115969:  87%|████████▋ | 87/100 [01:53<00:17,  1.34s/it]Best trial: 80. Best value: 0.115969:  87%|████████▋ | 87/100 [01:55<00:17,  1.34s/it]Best trial: 80. Best value: 0.115969:  88%|████████▊ | 88/100 [01:55<00:16,  1.40s/it]Best trial: 80. Best value: 0.115969:  88%|████████▊ | 88/100 [01:56<00:16,  1.40s/it]Best trial: 80. Best value: 0.115969:  89%|████████▉ | 89/100 [01:56<00:15,  1.40s/it]Best trial: 80. Best value: 0.115969:  89%|████████▉ | 89/100 [01:57<00:15,  1.40s/it]Best trial: 80. Best value: 0.115969:  90%|█████████ | 90/100 [01:57<00:13,  1.33s/it]Best trial: 80. Best value: 0.115969:  90%|█████████ | 90/100 [01:58<00:13,  1.33s/it]Best trial: 80. Best value: 0.115969:  91%|█████████ | 91/100 [01:58<00:11,  1.28s/it]Best trial: 80. Best value: 0.115969:  91%|█████████ | 91/100 [02:00<00:11,  1.28s/it]Best trial: 80. Best value: 0.115969:  92%|█████████▏| 92/100 [02:00<00:09,  1.25s/it]Best trial: 80. Best value: 0.115969:  92%|█████████▏| 92/100 [02:01<00:09,  1.25s/it]Best trial: 80. Best value: 0.115969:  93%|█████████▎| 93/100 [02:01<00:09,  1.32s/it]Best trial: 80. Best value: 0.115969:  93%|█████████▎| 93/100 [02:02<00:09,  1.32s/it]Best trial: 80. Best value: 0.115969:  94%|█████████▍| 94/100 [02:02<00:08,  1.35s/it]Best trial: 80. Best value: 0.115969:  94%|█████████▍| 94/100 [02:04<00:08,  1.35s/it]Best trial: 80. Best value: 0.115969:  95%|█████████▌| 95/100 [02:04<00:06,  1.30s/it]Best trial: 80. Best value: 0.115969:  95%|█████████▌| 95/100 [02:05<00:06,  1.30s/it]Best trial: 80. Best value: 0.115969:  96%|█████████▌| 96/100 [02:05<00:05,  1.30s/it]Best trial: 80. Best value: 0.115969:  96%|█████████▌| 96/100 [02:06<00:05,  1.30s/it]Best trial: 80. Best value: 0.115969:  97%|█████████▋| 97/100 [02:06<00:03,  1.32s/it]Best trial: 80. Best value: 0.115969:  97%|█████████▋| 97/100 [02:08<00:03,  1.32s/it]Best trial: 80. Best value: 0.115969:  98%|█████████▊| 98/100 [02:08<00:02,  1.33s/it]Best trial: 80. Best value: 0.115969:  98%|█████████▊| 98/100 [02:09<00:02,  1.33s/it]Best trial: 80. Best value: 0.115969:  99%|█████████▉| 99/100 [02:09<00:01,  1.33s/it]Best trial: 80. Best value: 0.115969:  99%|█████████▉| 99/100 [02:11<00:01,  1.33s/it]Best trial: 80. Best value: 0.115969: 100%|██████████| 100/100 [02:11<00:00,  1.39s/it]Best trial: 80. Best value: 0.115969: 100%|██████████| 100/100 [02:11<00:00,  1.31s/it]
2025-11-30 11:35:58,535 - INFO - HPO Complete. Best AUPRC: 0.1160
2025-11-30 11:35:58,536 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.05258415684030885, 'max_depth': 10, 'subsample': 0.6004073257800533, 'colsample_bytree': 0.8110844093451741, 'gamma': 4.495255485787481, 'reg_lambda': 0.0011818254586666132, 'reg_alpha': 0.0010317787788307392}
2025-11-30 11:35:58,536 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:36:00,621 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: co2_only
2025-11-30 11:36:00,622 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:36:00,724 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:36:00,731 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:36:00,733 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:36:00,733 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:36:00,733 - INFO - Training model...
2025-11-30 11:36:01,693 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:36:06,353 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:36:06,353 - INFO - AUROC: 0.5509 (0.3388 - 0.7680)
2025-11-30 11:36:06,353 - INFO - AUPRC: 0.0307 (0.0115 - 0.1063)
2025-11-30 11:36:06,353 - INFO - Brier Score: 0.0171 (0.0108 - 0.0285)
2025-11-30 11:36:06,353 - INFO - Accuracy: 0.9754 (0.6772 - 0.9838)
2025-11-30 11:36:06,353 - INFO - Precision: 0.1111 (0.0094 - 0.3400)
2025-11-30 11:36:06,353 - INFO - Sensitivity (Recall): 0.1000 (0.0786 - 0.5909)
2025-11-30 11:36:06,353 - INFO - F1-Score: 0.1053 (0.0181 - 0.2612)
2025-11-30 11:36:06,353 - INFO - Best Threshold: 0.2400 (0.0100 - 0.2400)
2025-11-30 11:36:06,353 - INFO - Specificity: 0.9883 (0.6826 - 0.9939)
2025-11-30 11:36:06,362 - INFO - Calculating SHAP values...
2025-11-30 11:36:07,484 - INFO - SHAP plots saved.
2025-11-30 11:36:07,485 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:36:08,944 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 11:36:08,944 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:36:09,046 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:36:09,055 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:36:09,058 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:36:09,058 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0495119:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0495119:   1%|          | 1/100 [00:01<02:12,  1.34s/it]Best trial: 1. Best value: 0.0690046:   1%|          | 1/100 [00:03<02:12,  1.34s/it]Best trial: 1. Best value: 0.0690046:   2%|▏         | 2/100 [00:03<02:37,  1.61s/it]Best trial: 2. Best value: 0.0840584:   2%|▏         | 2/100 [00:05<02:37,  1.61s/it]Best trial: 2. Best value: 0.0840584:   3%|▎         | 3/100 [00:05<02:50,  1.76s/it]Best trial: 3. Best value: 0.110438:   3%|▎         | 3/100 [00:06<02:50,  1.76s/it] Best trial: 3. Best value: 0.110438:   4%|▍         | 4/100 [00:06<02:20,  1.47s/it]Best trial: 3. Best value: 0.110438:   4%|▍         | 4/100 [00:08<02:20,  1.47s/it]Best trial: 3. Best value: 0.110438:   5%|▌         | 5/100 [00:08<02:54,  1.84s/it]Best trial: 3. Best value: 0.110438:   5%|▌         | 5/100 [00:09<02:54,  1.84s/it]Best trial: 3. Best value: 0.110438:   6%|▌         | 6/100 [00:09<02:23,  1.52s/it]Best trial: 3. Best value: 0.110438:   6%|▌         | 6/100 [00:11<02:23,  1.52s/it]Best trial: 3. Best value: 0.110438:   7%|▋         | 7/100 [00:11<02:39,  1.71s/it]Best trial: 3. Best value: 0.110438:   7%|▋         | 7/100 [00:13<02:39,  1.71s/it]Best trial: 3. Best value: 0.110438:   8%|▊         | 8/100 [00:13<02:32,  1.65s/it]Best trial: 3. Best value: 0.110438:   8%|▊         | 8/100 [00:15<02:32,  1.65s/it]Best trial: 3. Best value: 0.110438:   9%|▉         | 9/100 [00:15<03:01,  1.99s/it]Best trial: 9. Best value: 0.113556:   9%|▉         | 9/100 [00:17<03:01,  1.99s/it]Best trial: 9. Best value: 0.113556:  10%|█         | 10/100 [00:17<02:40,  1.78s/it]Best trial: 10. Best value: 0.1344:  10%|█         | 10/100 [00:18<02:40,  1.78s/it] Best trial: 10. Best value: 0.1344:  11%|█         | 11/100 [00:18<02:34,  1.73s/it]Best trial: 10. Best value: 0.1344:  11%|█         | 11/100 [00:19<02:34,  1.73s/it]Best trial: 10. Best value: 0.1344:  12%|█▏        | 12/100 [00:19<02:12,  1.51s/it]Best trial: 10. Best value: 0.1344:  12%|█▏        | 12/100 [00:21<02:12,  1.51s/it]Best trial: 10. Best value: 0.1344:  13%|█▎        | 13/100 [00:21<02:03,  1.42s/it]Best trial: 10. Best value: 0.1344:  13%|█▎        | 13/100 [00:22<02:03,  1.42s/it]Best trial: 10. Best value: 0.1344:  14%|█▍        | 14/100 [00:22<01:58,  1.38s/it]Best trial: 10. Best value: 0.1344:  14%|█▍        | 14/100 [00:23<01:58,  1.38s/it]Best trial: 10. Best value: 0.1344:  15%|█▌        | 15/100 [00:23<01:45,  1.24s/it]Best trial: 10. Best value: 0.1344:  15%|█▌        | 15/100 [00:24<01:45,  1.24s/it]Best trial: 10. Best value: 0.1344:  16%|█▌        | 16/100 [00:24<01:49,  1.30s/it]Best trial: 10. Best value: 0.1344:  16%|█▌        | 16/100 [00:25<01:49,  1.30s/it]Best trial: 10. Best value: 0.1344:  17%|█▋        | 17/100 [00:25<01:38,  1.19s/it]Best trial: 10. Best value: 0.1344:  17%|█▋        | 17/100 [00:27<01:38,  1.19s/it]Best trial: 10. Best value: 0.1344:  18%|█▊        | 18/100 [00:27<01:46,  1.30s/it]Best trial: 10. Best value: 0.1344:  18%|█▊        | 18/100 [00:27<01:46,  1.30s/it]Best trial: 10. Best value: 0.1344:  19%|█▉        | 19/100 [00:27<01:33,  1.15s/it]Best trial: 10. Best value: 0.1344:  19%|█▉        | 19/100 [00:29<01:33,  1.15s/it]Best trial: 10. Best value: 0.1344:  20%|██        | 20/100 [00:29<01:34,  1.18s/it]Best trial: 10. Best value: 0.1344:  20%|██        | 20/100 [00:30<01:34,  1.18s/it]Best trial: 10. Best value: 0.1344:  21%|██        | 21/100 [00:30<01:37,  1.24s/it]Best trial: 10. Best value: 0.1344:  21%|██        | 21/100 [00:31<01:37,  1.24s/it]Best trial: 10. Best value: 0.1344:  22%|██▏       | 22/100 [00:31<01:31,  1.18s/it]Best trial: 10. Best value: 0.1344:  22%|██▏       | 22/100 [00:32<01:31,  1.18s/it]Best trial: 10. Best value: 0.1344:  23%|██▎       | 23/100 [00:32<01:29,  1.17s/it]Best trial: 10. Best value: 0.1344:  23%|██▎       | 23/100 [00:33<01:29,  1.17s/it]Best trial: 10. Best value: 0.1344:  24%|██▍       | 24/100 [00:33<01:21,  1.08s/it]Best trial: 10. Best value: 0.1344:  24%|██▍       | 24/100 [00:34<01:21,  1.08s/it]Best trial: 10. Best value: 0.1344:  25%|██▌       | 25/100 [00:34<01:24,  1.13s/it]Best trial: 10. Best value: 0.1344:  25%|██▌       | 25/100 [00:36<01:24,  1.13s/it]Best trial: 10. Best value: 0.1344:  26%|██▌       | 26/100 [00:36<01:31,  1.23s/it]Best trial: 10. Best value: 0.1344:  26%|██▌       | 26/100 [00:37<01:31,  1.23s/it]Best trial: 10. Best value: 0.1344:  27%|██▋       | 27/100 [00:37<01:27,  1.21s/it]Best trial: 10. Best value: 0.1344:  27%|██▋       | 27/100 [00:38<01:27,  1.21s/it]Best trial: 10. Best value: 0.1344:  28%|██▊       | 28/100 [00:38<01:22,  1.14s/it]Best trial: 10. Best value: 0.1344:  28%|██▊       | 28/100 [00:39<01:22,  1.14s/it]Best trial: 10. Best value: 0.1344:  29%|██▉       | 29/100 [00:39<01:26,  1.21s/it]Best trial: 10. Best value: 0.1344:  29%|██▉       | 29/100 [00:41<01:26,  1.21s/it]Best trial: 10. Best value: 0.1344:  30%|███       | 30/100 [00:41<01:36,  1.38s/it]Best trial: 10. Best value: 0.1344:  30%|███       | 30/100 [00:42<01:36,  1.38s/it]Best trial: 10. Best value: 0.1344:  31%|███       | 31/100 [00:42<01:24,  1.23s/it]Best trial: 31. Best value: 0.144686:  31%|███       | 31/100 [00:43<01:24,  1.23s/it]Best trial: 31. Best value: 0.144686:  32%|███▏      | 32/100 [00:43<01:18,  1.16s/it]Best trial: 31. Best value: 0.144686:  32%|███▏      | 32/100 [00:44<01:18,  1.16s/it]Best trial: 31. Best value: 0.144686:  33%|███▎      | 33/100 [00:44<01:13,  1.10s/it]Best trial: 31. Best value: 0.144686:  33%|███▎      | 33/100 [00:45<01:13,  1.10s/it]Best trial: 31. Best value: 0.144686:  34%|███▍      | 34/100 [00:45<01:12,  1.10s/it]Best trial: 31. Best value: 0.144686:  34%|███▍      | 34/100 [00:46<01:12,  1.10s/it]Best trial: 31. Best value: 0.144686:  35%|███▌      | 35/100 [00:46<01:14,  1.14s/it]Best trial: 31. Best value: 0.144686:  35%|███▌      | 35/100 [00:47<01:14,  1.14s/it]Best trial: 31. Best value: 0.144686:  36%|███▌      | 36/100 [00:47<01:06,  1.04s/it]Best trial: 31. Best value: 0.144686:  36%|███▌      | 36/100 [00:49<01:06,  1.04s/it]Best trial: 31. Best value: 0.144686:  37%|███▋      | 37/100 [00:49<01:12,  1.14s/it]Best trial: 31. Best value: 0.144686:  37%|███▋      | 37/100 [00:49<01:12,  1.14s/it]Best trial: 31. Best value: 0.144686:  38%|███▊      | 38/100 [00:49<01:05,  1.06s/it]Best trial: 31. Best value: 0.144686:  38%|███▊      | 38/100 [00:52<01:05,  1.06s/it]Best trial: 31. Best value: 0.144686:  39%|███▉      | 39/100 [00:52<01:26,  1.41s/it]Best trial: 31. Best value: 0.144686:  39%|███▉      | 39/100 [00:53<01:26,  1.41s/it]Best trial: 31. Best value: 0.144686:  40%|████      | 40/100 [00:53<01:18,  1.31s/it]Best trial: 31. Best value: 0.144686:  40%|████      | 40/100 [00:54<01:18,  1.31s/it]Best trial: 31. Best value: 0.144686:  41%|████      | 41/100 [00:54<01:10,  1.19s/it]Best trial: 31. Best value: 0.144686:  41%|████      | 41/100 [00:55<01:10,  1.19s/it]Best trial: 31. Best value: 0.144686:  42%|████▏     | 42/100 [00:55<01:07,  1.16s/it]Best trial: 31. Best value: 0.144686:  42%|████▏     | 42/100 [00:56<01:07,  1.16s/it]Best trial: 31. Best value: 0.144686:  43%|████▎     | 43/100 [00:56<01:03,  1.11s/it]Best trial: 31. Best value: 0.144686:  43%|████▎     | 43/100 [00:57<01:03,  1.11s/it]Best trial: 31. Best value: 0.144686:  44%|████▍     | 44/100 [00:57<01:02,  1.12s/it]Best trial: 31. Best value: 0.144686:  44%|████▍     | 44/100 [00:58<01:02,  1.12s/it]Best trial: 31. Best value: 0.144686:  45%|████▌     | 45/100 [00:58<01:07,  1.22s/it]Best trial: 31. Best value: 0.144686:  45%|████▌     | 45/100 [00:59<01:07,  1.22s/it]Best trial: 31. Best value: 0.144686:  46%|████▌     | 46/100 [00:59<01:04,  1.19s/it]Best trial: 31. Best value: 0.144686:  46%|████▌     | 46/100 [01:01<01:04,  1.19s/it]Best trial: 31. Best value: 0.144686:  47%|████▋     | 47/100 [01:01<01:14,  1.40s/it]Best trial: 31. Best value: 0.144686:  47%|████▋     | 47/100 [01:03<01:14,  1.40s/it]Best trial: 31. Best value: 0.144686:  48%|████▊     | 48/100 [01:03<01:12,  1.39s/it]Best trial: 31. Best value: 0.144686:  48%|████▊     | 48/100 [01:04<01:12,  1.39s/it]Best trial: 31. Best value: 0.144686:  49%|████▉     | 49/100 [01:04<01:13,  1.44s/it]Best trial: 31. Best value: 0.144686:  49%|████▉     | 49/100 [01:06<01:13,  1.44s/it]Best trial: 31. Best value: 0.144686:  50%|█████     | 50/100 [01:06<01:13,  1.47s/it]Best trial: 31. Best value: 0.144686:  50%|█████     | 50/100 [01:07<01:13,  1.47s/it]Best trial: 31. Best value: 0.144686:  51%|█████     | 51/100 [01:07<01:03,  1.29s/it]Best trial: 31. Best value: 0.144686:  51%|█████     | 51/100 [01:08<01:03,  1.29s/it]Best trial: 31. Best value: 0.144686:  52%|█████▏    | 52/100 [01:08<00:57,  1.21s/it]Best trial: 31. Best value: 0.144686:  52%|█████▏    | 52/100 [01:09<00:57,  1.21s/it]Best trial: 31. Best value: 0.144686:  53%|█████▎    | 53/100 [01:09<00:52,  1.12s/it]Best trial: 31. Best value: 0.144686:  53%|█████▎    | 53/100 [01:09<00:52,  1.12s/it]Best trial: 31. Best value: 0.144686:  54%|█████▍    | 54/100 [01:09<00:48,  1.05s/it]Best trial: 54. Best value: 0.145135:  54%|█████▍    | 54/100 [01:10<00:48,  1.05s/it]Best trial: 54. Best value: 0.145135:  55%|█████▌    | 55/100 [01:10<00:45,  1.02s/it]Best trial: 54. Best value: 0.145135:  55%|█████▌    | 55/100 [01:11<00:45,  1.02s/it]Best trial: 54. Best value: 0.145135:  56%|█████▌    | 56/100 [01:11<00:45,  1.02s/it]Best trial: 56. Best value: 0.158019:  56%|█████▌    | 56/100 [01:12<00:45,  1.02s/it]Best trial: 56. Best value: 0.158019:  57%|█████▋    | 57/100 [01:12<00:42,  1.02it/s]Best trial: 56. Best value: 0.158019:  57%|█████▋    | 57/100 [01:14<00:42,  1.02it/s]Best trial: 56. Best value: 0.158019:  58%|█████▊    | 58/100 [01:14<00:51,  1.22s/it]Best trial: 58. Best value: 0.174245:  58%|█████▊    | 58/100 [01:15<00:51,  1.22s/it]Best trial: 58. Best value: 0.174245:  59%|█████▉    | 59/100 [01:15<00:47,  1.16s/it]Best trial: 58. Best value: 0.174245:  59%|█████▉    | 59/100 [01:16<00:47,  1.16s/it]Best trial: 58. Best value: 0.174245:  60%|██████    | 60/100 [01:16<00:44,  1.10s/it]Best trial: 58. Best value: 0.174245:  60%|██████    | 60/100 [01:17<00:44,  1.10s/it]Best trial: 58. Best value: 0.174245:  61%|██████    | 61/100 [01:17<00:41,  1.07s/it]Best trial: 58. Best value: 0.174245:  61%|██████    | 61/100 [01:18<00:41,  1.07s/it]Best trial: 58. Best value: 0.174245:  62%|██████▏   | 62/100 [01:18<00:38,  1.02s/it]Best trial: 58. Best value: 0.174245:  62%|██████▏   | 62/100 [01:19<00:38,  1.02s/it]Best trial: 58. Best value: 0.174245:  63%|██████▎   | 63/100 [01:19<00:37,  1.00s/it]Best trial: 58. Best value: 0.174245:  63%|██████▎   | 63/100 [01:20<00:37,  1.00s/it]Best trial: 58. Best value: 0.174245:  64%|██████▍   | 64/100 [01:20<00:36,  1.01s/it]Best trial: 58. Best value: 0.174245:  64%|██████▍   | 64/100 [01:21<00:36,  1.01s/it]Best trial: 58. Best value: 0.174245:  65%|██████▌   | 65/100 [01:21<00:33,  1.03it/s]Best trial: 58. Best value: 0.174245:  65%|██████▌   | 65/100 [01:22<00:33,  1.03it/s]Best trial: 58. Best value: 0.174245:  66%|██████▌   | 66/100 [01:22<00:30,  1.12it/s]Best trial: 58. Best value: 0.174245:  66%|██████▌   | 66/100 [01:23<00:30,  1.12it/s]Best trial: 58. Best value: 0.174245:  67%|██████▋   | 67/100 [01:23<00:31,  1.06it/s]Best trial: 58. Best value: 0.174245:  67%|██████▋   | 67/100 [01:24<00:31,  1.06it/s]Best trial: 58. Best value: 0.174245:  68%|██████▊   | 68/100 [01:24<00:30,  1.05it/s]Best trial: 58. Best value: 0.174245:  68%|██████▊   | 68/100 [01:24<00:30,  1.05it/s]Best trial: 58. Best value: 0.174245:  69%|██████▉   | 69/100 [01:24<00:29,  1.06it/s]Best trial: 58. Best value: 0.174245:  69%|██████▉   | 69/100 [01:25<00:29,  1.06it/s]Best trial: 58. Best value: 0.174245:  70%|███████   | 70/100 [01:25<00:28,  1.06it/s]Best trial: 58. Best value: 0.174245:  70%|███████   | 70/100 [01:27<00:28,  1.06it/s]Best trial: 58. Best value: 0.174245:  71%|███████   | 71/100 [01:27<00:29,  1.00s/it]Best trial: 58. Best value: 0.174245:  71%|███████   | 71/100 [01:28<00:29,  1.00s/it]Best trial: 58. Best value: 0.174245:  72%|███████▏  | 72/100 [01:28<00:28,  1.00s/it]Best trial: 58. Best value: 0.174245:  72%|███████▏  | 72/100 [01:29<00:28,  1.00s/it]Best trial: 58. Best value: 0.174245:  73%|███████▎  | 73/100 [01:29<00:26,  1.01it/s]Best trial: 58. Best value: 0.174245:  73%|███████▎  | 73/100 [01:29<00:26,  1.01it/s]Best trial: 58. Best value: 0.174245:  74%|███████▍  | 74/100 [01:29<00:24,  1.06it/s]Best trial: 58. Best value: 0.174245:  74%|███████▍  | 74/100 [01:30<00:24,  1.06it/s]Best trial: 58. Best value: 0.174245:  75%|███████▌  | 75/100 [01:30<00:23,  1.05it/s]Best trial: 58. Best value: 0.174245:  75%|███████▌  | 75/100 [01:31<00:23,  1.05it/s]Best trial: 58. Best value: 0.174245:  76%|███████▌  | 76/100 [01:31<00:22,  1.06it/s]Best trial: 58. Best value: 0.174245:  76%|███████▌  | 76/100 [01:32<00:22,  1.06it/s]Best trial: 58. Best value: 0.174245:  77%|███████▋  | 77/100 [01:32<00:22,  1.01it/s]Best trial: 58. Best value: 0.174245:  77%|███████▋  | 77/100 [01:34<00:22,  1.01it/s]Best trial: 58. Best value: 0.174245:  78%|███████▊  | 78/100 [01:34<00:22,  1.04s/it]Best trial: 58. Best value: 0.174245:  78%|███████▊  | 78/100 [01:34<00:22,  1.04s/it]Best trial: 58. Best value: 0.174245:  79%|███████▉  | 79/100 [01:34<00:21,  1.02s/it]Best trial: 58. Best value: 0.174245:  79%|███████▉  | 79/100 [01:36<00:21,  1.02s/it]Best trial: 58. Best value: 0.174245:  80%|████████  | 80/100 [01:36<00:21,  1.07s/it]Best trial: 80. Best value: 0.175594:  80%|████████  | 80/100 [01:37<00:21,  1.07s/it]Best trial: 80. Best value: 0.175594:  81%|████████  | 81/100 [01:37<00:19,  1.01s/it]Best trial: 80. Best value: 0.175594:  81%|████████  | 81/100 [01:37<00:19,  1.01s/it]Best trial: 80. Best value: 0.175594:  82%|████████▏ | 82/100 [01:37<00:16,  1.07it/s]Best trial: 80. Best value: 0.175594:  82%|████████▏ | 82/100 [01:38<00:16,  1.07it/s]Best trial: 80. Best value: 0.175594:  83%|████████▎ | 83/100 [01:38<00:15,  1.09it/s]Best trial: 80. Best value: 0.175594:  83%|████████▎ | 83/100 [01:39<00:15,  1.09it/s]Best trial: 80. Best value: 0.175594:  84%|████████▍ | 84/100 [01:39<00:14,  1.11it/s]Best trial: 80. Best value: 0.175594:  84%|████████▍ | 84/100 [01:41<00:14,  1.11it/s]Best trial: 80. Best value: 0.175594:  85%|████████▌ | 85/100 [01:41<00:16,  1.08s/it]Best trial: 80. Best value: 0.175594:  85%|████████▌ | 85/100 [01:42<00:16,  1.08s/it]Best trial: 80. Best value: 0.175594:  86%|████████▌ | 86/100 [01:42<00:14,  1.06s/it]Best trial: 80. Best value: 0.175594:  86%|████████▌ | 86/100 [01:43<00:14,  1.06s/it]Best trial: 80. Best value: 0.175594:  87%|████████▋ | 87/100 [01:43<00:13,  1.05s/it]Best trial: 80. Best value: 0.175594:  87%|████████▋ | 87/100 [01:43<00:13,  1.05s/it]Best trial: 80. Best value: 0.175594:  88%|████████▊ | 88/100 [01:43<00:11,  1.02it/s]Best trial: 80. Best value: 0.175594:  88%|████████▊ | 88/100 [01:44<00:11,  1.02it/s]Best trial: 80. Best value: 0.175594:  89%|████████▉ | 89/100 [01:44<00:11,  1.00s/it]Best trial: 80. Best value: 0.175594:  89%|████████▉ | 89/100 [01:45<00:11,  1.00s/it]Best trial: 80. Best value: 0.175594:  90%|█████████ | 90/100 [01:45<00:09,  1.03it/s]Best trial: 80. Best value: 0.175594:  90%|█████████ | 90/100 [01:46<00:09,  1.03it/s]Best trial: 80. Best value: 0.175594:  91%|█████████ | 91/100 [01:46<00:08,  1.02it/s]Best trial: 80. Best value: 0.175594:  91%|█████████ | 91/100 [01:47<00:08,  1.02it/s]Best trial: 80. Best value: 0.175594:  92%|█████████▏| 92/100 [01:47<00:07,  1.04it/s]Best trial: 80. Best value: 0.175594:  92%|█████████▏| 92/100 [01:48<00:07,  1.04it/s]Best trial: 80. Best value: 0.175594:  93%|█████████▎| 93/100 [01:48<00:06,  1.05it/s]Best trial: 80. Best value: 0.175594:  93%|█████████▎| 93/100 [01:49<00:06,  1.05it/s]Best trial: 80. Best value: 0.175594:  94%|█████████▍| 94/100 [01:49<00:05,  1.04it/s]Best trial: 80. Best value: 0.175594:  94%|█████████▍| 94/100 [01:50<00:05,  1.04it/s]Best trial: 80. Best value: 0.175594:  95%|█████████▌| 95/100 [01:50<00:04,  1.06it/s]Best trial: 80. Best value: 0.175594:  95%|█████████▌| 95/100 [01:51<00:04,  1.06it/s]Best trial: 80. Best value: 0.175594:  96%|█████████▌| 96/100 [01:51<00:03,  1.01it/s]Best trial: 80. Best value: 0.175594:  96%|█████████▌| 96/100 [01:52<00:03,  1.01it/s]Best trial: 80. Best value: 0.175594:  97%|█████████▋| 97/100 [01:52<00:02,  1.04it/s]Best trial: 80. Best value: 0.175594:  97%|█████████▋| 97/100 [01:53<00:02,  1.04it/s]Best trial: 80. Best value: 0.175594:  98%|█████████▊| 98/100 [01:53<00:01,  1.02it/s]Best trial: 80. Best value: 0.175594:  98%|█████████▊| 98/100 [01:54<00:01,  1.02it/s]Best trial: 80. Best value: 0.175594:  99%|█████████▉| 99/100 [01:54<00:00,  1.07it/s]Best trial: 80. Best value: 0.175594:  99%|█████████▉| 99/100 [01:55<00:00,  1.07it/s]Best trial: 80. Best value: 0.175594: 100%|██████████| 100/100 [01:55<00:00,  1.02it/s]Best trial: 80. Best value: 0.175594: 100%|██████████| 100/100 [01:55<00:00,  1.15s/it]
2025-11-30 11:38:04,538 - INFO - HPO Complete. Best AUPRC: 0.1756
2025-11-30 11:38:04,538 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.01713687031108889, 'max_depth': 3, 'subsample': 0.6509488656395189, 'colsample_bytree': 0.9643563811493463, 'gamma': 2.0187762396860367, 'reg_lambda': 0.001118233229020068, 'reg_alpha': 0.9897416585176296}
2025-11-30 11:38:04,539 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:38:06,457 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: awp_only
2025-11-30 11:38:06,458 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:38:06,541 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:38:06,547 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:38:06,549 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 11:38:06,549 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:38:06,549 - INFO - Training model...
2025-11-30 11:38:07,116 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:38:11,717 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:38:11,717 - INFO - AUROC: 0.5867 (0.4098 - 0.7627)
2025-11-30 11:38:11,717 - INFO - AUPRC: 0.0871 (0.0269 - 0.2637)
2025-11-30 11:38:11,717 - INFO - Brier Score: 0.0474 (0.0429 - 0.0563)
2025-11-30 11:38:11,717 - INFO - Accuracy: 0.9841 (0.8633 - 0.9910)
2025-11-30 11:38:11,717 - INFO - Precision: 0.4000 (0.0549 - 0.7286)
2025-11-30 11:38:11,717 - INFO - Sensitivity (Recall): 0.2000 (0.0833 - 0.6111)
2025-11-30 11:38:11,717 - INFO - F1-Score: 0.2667 (0.0892 - 0.4951)
2025-11-30 11:38:11,717 - INFO - Best Threshold: 0.5900 (0.3100 - 0.5900)
2025-11-30 11:38:11,717 - INFO - Specificity: 0.9956 (0.8715 - 0.9985)
2025-11-30 11:38:11,724 - INFO - Calculating SHAP values...
2025-11-30 11:38:12,752 - INFO - SHAP plots saved.
2025-11-30 11:38:12,753 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:38:13,951 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 11:38:13,951 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:38:14,036 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:38:14,056 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:38:14,060 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 11:38:14,060 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0884303:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.0884303:   1%|          | 1/100 [00:03<06:18,  3.83s/it]Best trial: 0. Best value: 0.0884303:   1%|          | 1/100 [00:06<06:18,  3.83s/it]Best trial: 0. Best value: 0.0884303:   2%|▏         | 2/100 [00:06<05:01,  3.08s/it]Best trial: 0. Best value: 0.0884303:   2%|▏         | 2/100 [00:08<05:01,  3.08s/it]Best trial: 0. Best value: 0.0884303:   3%|▎         | 3/100 [00:08<04:06,  2.54s/it]Best trial: 3. Best value: 0.0938917:   3%|▎         | 3/100 [00:10<04:06,  2.54s/it]Best trial: 3. Best value: 0.0938917:   4%|▍         | 4/100 [00:10<03:44,  2.34s/it]Best trial: 3. Best value: 0.0938917:   4%|▍         | 4/100 [00:12<03:44,  2.34s/it]Best trial: 3. Best value: 0.0938917:   5%|▌         | 5/100 [00:12<03:34,  2.26s/it]Best trial: 5. Best value: 0.136484:   5%|▌         | 5/100 [00:14<03:34,  2.26s/it] Best trial: 5. Best value: 0.136484:   6%|▌         | 6/100 [00:14<03:19,  2.13s/it]Best trial: 5. Best value: 0.136484:   6%|▌         | 6/100 [00:16<03:19,  2.13s/it]Best trial: 5. Best value: 0.136484:   7%|▋         | 7/100 [00:16<03:33,  2.30s/it]Best trial: 5. Best value: 0.136484:   7%|▋         | 7/100 [00:19<03:33,  2.30s/it]Best trial: 5. Best value: 0.136484:   8%|▊         | 8/100 [00:19<03:26,  2.24s/it]Best trial: 5. Best value: 0.136484:   8%|▊         | 8/100 [00:20<03:26,  2.24s/it]Best trial: 5. Best value: 0.136484:   9%|▉         | 9/100 [00:20<03:01,  1.99s/it]Best trial: 5. Best value: 0.136484:   9%|▉         | 9/100 [00:23<03:01,  1.99s/it]Best trial: 5. Best value: 0.136484:  10%|█         | 10/100 [00:23<03:16,  2.19s/it]Best trial: 5. Best value: 0.136484:  10%|█         | 10/100 [00:25<03:16,  2.19s/it]Best trial: 5. Best value: 0.136484:  11%|█         | 11/100 [00:25<03:24,  2.30s/it]Best trial: 11. Best value: 0.15628:  11%|█         | 11/100 [00:27<03:24,  2.30s/it]Best trial: 11. Best value: 0.15628:  12%|█▏        | 12/100 [00:27<03:11,  2.17s/it]Best trial: 11. Best value: 0.15628:  12%|█▏        | 12/100 [00:29<03:11,  2.17s/it]Best trial: 11. Best value: 0.15628:  13%|█▎        | 13/100 [00:29<02:56,  2.02s/it]Best trial: 11. Best value: 0.15628:  13%|█▎        | 13/100 [00:31<02:56,  2.02s/it]Best trial: 11. Best value: 0.15628:  14%|█▍        | 14/100 [00:31<02:46,  1.94s/it]Best trial: 11. Best value: 0.15628:  14%|█▍        | 14/100 [00:33<02:46,  1.94s/it]Best trial: 11. Best value: 0.15628:  15%|█▌        | 15/100 [00:33<02:47,  1.97s/it]Best trial: 11. Best value: 0.15628:  15%|█▌        | 15/100 [00:34<02:47,  1.97s/it]Best trial: 11. Best value: 0.15628:  16%|█▌        | 16/100 [00:34<02:39,  1.90s/it]Best trial: 11. Best value: 0.15628:  16%|█▌        | 16/100 [00:37<02:39,  1.90s/it]Best trial: 11. Best value: 0.15628:  17%|█▋        | 17/100 [00:37<02:49,  2.04s/it]Best trial: 11. Best value: 0.15628:  17%|█▋        | 17/100 [00:38<02:49,  2.04s/it]Best trial: 11. Best value: 0.15628:  18%|█▊        | 18/100 [00:38<02:37,  1.92s/it]Best trial: 11. Best value: 0.15628:  18%|█▊        | 18/100 [00:41<02:37,  1.92s/it]Best trial: 11. Best value: 0.15628:  19%|█▉        | 19/100 [00:41<03:00,  2.23s/it]Best trial: 11. Best value: 0.15628:  19%|█▉        | 19/100 [00:43<03:00,  2.23s/it]Best trial: 11. Best value: 0.15628:  20%|██        | 20/100 [00:43<02:47,  2.10s/it]Best trial: 11. Best value: 0.15628:  20%|██        | 20/100 [00:45<02:47,  2.10s/it]Best trial: 11. Best value: 0.15628:  21%|██        | 21/100 [00:45<02:40,  2.03s/it]Best trial: 11. Best value: 0.15628:  21%|██        | 21/100 [00:48<02:40,  2.03s/it]Best trial: 11. Best value: 0.15628:  22%|██▏       | 22/100 [00:48<03:04,  2.36s/it]Best trial: 11. Best value: 0.15628:  22%|██▏       | 22/100 [00:50<03:04,  2.36s/it]Best trial: 11. Best value: 0.15628:  23%|██▎       | 23/100 [00:50<02:41,  2.10s/it]Best trial: 11. Best value: 0.15628:  23%|██▎       | 23/100 [00:52<02:41,  2.10s/it]Best trial: 11. Best value: 0.15628:  24%|██▍       | 24/100 [00:52<02:40,  2.11s/it]Best trial: 11. Best value: 0.15628:  24%|██▍       | 24/100 [00:53<02:40,  2.11s/it]Best trial: 11. Best value: 0.15628:  25%|██▌       | 25/100 [00:53<02:21,  1.89s/it]Best trial: 11. Best value: 0.15628:  25%|██▌       | 25/100 [00:55<02:21,  1.89s/it]Best trial: 11. Best value: 0.15628:  26%|██▌       | 26/100 [00:55<02:21,  1.91s/it]Best trial: 11. Best value: 0.15628:  26%|██▌       | 26/100 [00:57<02:21,  1.91s/it]Best trial: 11. Best value: 0.15628:  27%|██▋       | 27/100 [00:57<02:17,  1.89s/it]Best trial: 11. Best value: 0.15628:  27%|██▋       | 27/100 [00:59<02:17,  1.89s/it]Best trial: 11. Best value: 0.15628:  28%|██▊       | 28/100 [00:59<02:32,  2.12s/it]Best trial: 11. Best value: 0.15628:  28%|██▊       | 28/100 [01:02<02:32,  2.12s/it]Best trial: 11. Best value: 0.15628:  29%|██▉       | 29/100 [01:02<02:44,  2.32s/it]Best trial: 11. Best value: 0.15628:  29%|██▉       | 29/100 [01:06<02:44,  2.32s/it]Best trial: 11. Best value: 0.15628:  30%|███       | 30/100 [01:06<03:16,  2.80s/it]Best trial: 11. Best value: 0.15628:  30%|███       | 30/100 [01:10<03:16,  2.80s/it]Best trial: 11. Best value: 0.15628:  31%|███       | 31/100 [01:10<03:41,  3.21s/it]Best trial: 11. Best value: 0.15628:  31%|███       | 31/100 [01:12<03:41,  3.21s/it]Best trial: 11. Best value: 0.15628:  32%|███▏      | 32/100 [01:12<03:03,  2.70s/it]Best trial: 11. Best value: 0.15628:  32%|███▏      | 32/100 [01:14<03:03,  2.70s/it]Best trial: 11. Best value: 0.15628:  33%|███▎      | 33/100 [01:14<02:41,  2.41s/it]Best trial: 11. Best value: 0.15628:  33%|███▎      | 33/100 [01:15<02:41,  2.41s/it]Best trial: 11. Best value: 0.15628:  34%|███▍      | 34/100 [01:15<02:24,  2.20s/it]Best trial: 11. Best value: 0.15628:  34%|███▍      | 34/100 [01:17<02:24,  2.20s/it]Best trial: 11. Best value: 0.15628:  35%|███▌      | 35/100 [01:17<02:12,  2.04s/it]Best trial: 11. Best value: 0.15628:  35%|███▌      | 35/100 [01:19<02:12,  2.04s/it]Best trial: 11. Best value: 0.15628:  36%|███▌      | 36/100 [01:19<02:05,  1.96s/it]Best trial: 11. Best value: 0.15628:  36%|███▌      | 36/100 [01:21<02:05,  1.96s/it]Best trial: 11. Best value: 0.15628:  37%|███▋      | 37/100 [01:21<02:15,  2.16s/it]Best trial: 11. Best value: 0.15628:  37%|███▋      | 37/100 [01:23<02:15,  2.16s/it]Best trial: 11. Best value: 0.15628:  38%|███▊      | 38/100 [01:23<02:08,  2.07s/it]Best trial: 11. Best value: 0.15628:  38%|███▊      | 38/100 [01:25<02:08,  2.07s/it]Best trial: 11. Best value: 0.15628:  39%|███▉      | 39/100 [01:25<01:59,  1.95s/it]Best trial: 11. Best value: 0.15628:  39%|███▉      | 39/100 [01:27<01:59,  1.95s/it]Best trial: 11. Best value: 0.15628:  40%|████      | 40/100 [01:27<02:05,  2.09s/it]Best trial: 11. Best value: 0.15628:  40%|████      | 40/100 [01:30<02:05,  2.09s/it]Best trial: 11. Best value: 0.15628:  41%|████      | 41/100 [01:30<02:06,  2.15s/it]Best trial: 11. Best value: 0.15628:  41%|████      | 41/100 [01:31<02:06,  2.15s/it]Best trial: 11. Best value: 0.15628:  42%|████▏     | 42/100 [01:31<01:58,  2.05s/it]Best trial: 11. Best value: 0.15628:  42%|████▏     | 42/100 [01:34<01:58,  2.05s/it]Best trial: 11. Best value: 0.15628:  43%|████▎     | 43/100 [01:34<01:58,  2.08s/it]Best trial: 11. Best value: 0.15628:  43%|████▎     | 43/100 [01:35<01:58,  2.08s/it]Best trial: 11. Best value: 0.15628:  44%|████▍     | 44/100 [01:35<01:47,  1.92s/it]Best trial: 11. Best value: 0.15628:  44%|████▍     | 44/100 [01:38<01:47,  1.92s/it]Best trial: 11. Best value: 0.15628:  45%|████▌     | 45/100 [01:38<01:56,  2.12s/it]Best trial: 11. Best value: 0.15628:  45%|████▌     | 45/100 [01:40<01:56,  2.12s/it]Best trial: 11. Best value: 0.15628:  46%|████▌     | 46/100 [01:40<01:50,  2.04s/it]Best trial: 11. Best value: 0.15628:  46%|████▌     | 46/100 [01:42<01:50,  2.04s/it]Best trial: 11. Best value: 0.15628:  47%|████▋     | 47/100 [01:42<01:48,  2.05s/it]Best trial: 11. Best value: 0.15628:  47%|████▋     | 47/100 [01:44<01:48,  2.05s/it]Best trial: 11. Best value: 0.15628:  48%|████▊     | 48/100 [01:44<01:46,  2.05s/it]Best trial: 11. Best value: 0.15628:  48%|████▊     | 48/100 [01:45<01:46,  2.05s/it]Best trial: 11. Best value: 0.15628:  49%|████▉     | 49/100 [01:45<01:39,  1.95s/it]Best trial: 11. Best value: 0.15628:  49%|████▉     | 49/100 [01:47<01:39,  1.95s/it]Best trial: 11. Best value: 0.15628:  50%|█████     | 50/100 [01:47<01:37,  1.94s/it]Best trial: 11. Best value: 0.15628:  50%|█████     | 50/100 [01:50<01:37,  1.94s/it]Best trial: 11. Best value: 0.15628:  51%|█████     | 51/100 [01:50<01:41,  2.06s/it]Best trial: 11. Best value: 0.15628:  51%|█████     | 51/100 [01:52<01:41,  2.06s/it]Best trial: 11. Best value: 0.15628:  52%|█████▏    | 52/100 [01:52<01:38,  2.04s/it]Best trial: 11. Best value: 0.15628:  52%|█████▏    | 52/100 [01:54<01:38,  2.04s/it]Best trial: 11. Best value: 0.15628:  53%|█████▎    | 53/100 [01:54<01:40,  2.14s/it]Best trial: 11. Best value: 0.15628:  53%|█████▎    | 53/100 [01:56<01:40,  2.14s/it]Best trial: 11. Best value: 0.15628:  54%|█████▍    | 54/100 [01:56<01:36,  2.10s/it]Best trial: 11. Best value: 0.15628:  54%|█████▍    | 54/100 [01:59<01:36,  2.10s/it]Best trial: 11. Best value: 0.15628:  55%|█████▌    | 55/100 [01:59<01:42,  2.28s/it]Best trial: 11. Best value: 0.15628:  55%|█████▌    | 55/100 [02:01<01:42,  2.28s/it]Best trial: 11. Best value: 0.15628:  56%|█████▌    | 56/100 [02:01<01:40,  2.29s/it]Best trial: 11. Best value: 0.15628:  56%|█████▌    | 56/100 [02:03<01:40,  2.29s/it]Best trial: 11. Best value: 0.15628:  57%|█████▋    | 57/100 [02:03<01:37,  2.27s/it]Best trial: 11. Best value: 0.15628:  57%|█████▋    | 57/100 [02:05<01:37,  2.27s/it]Best trial: 11. Best value: 0.15628:  58%|█████▊    | 58/100 [02:05<01:29,  2.12s/it]Best trial: 11. Best value: 0.15628:  58%|█████▊    | 58/100 [02:07<01:29,  2.12s/it]Best trial: 11. Best value: 0.15628:  59%|█████▉    | 59/100 [02:07<01:25,  2.08s/it]Best trial: 11. Best value: 0.15628:  59%|█████▉    | 59/100 [02:09<01:25,  2.08s/it]Best trial: 11. Best value: 0.15628:  60%|██████    | 60/100 [02:09<01:26,  2.17s/it]Best trial: 11. Best value: 0.15628:  60%|██████    | 60/100 [02:12<01:26,  2.17s/it]Best trial: 11. Best value: 0.15628:  61%|██████    | 61/100 [02:12<01:27,  2.25s/it]Best trial: 11. Best value: 0.15628:  61%|██████    | 61/100 [02:14<01:27,  2.25s/it]Best trial: 11. Best value: 0.15628:  62%|██████▏   | 62/100 [02:14<01:22,  2.17s/it]Best trial: 11. Best value: 0.15628:  62%|██████▏   | 62/100 [02:16<01:22,  2.17s/it]Best trial: 11. Best value: 0.15628:  63%|██████▎   | 63/100 [02:16<01:22,  2.24s/it]Best trial: 11. Best value: 0.15628:  63%|██████▎   | 63/100 [02:19<01:22,  2.24s/it]Best trial: 11. Best value: 0.15628:  64%|██████▍   | 64/100 [02:19<01:21,  2.27s/it]Best trial: 11. Best value: 0.15628:  64%|██████▍   | 64/100 [02:20<01:21,  2.27s/it]Best trial: 11. Best value: 0.15628:  65%|██████▌   | 65/100 [02:20<01:15,  2.16s/it]Best trial: 65. Best value: 0.15647:  65%|██████▌   | 65/100 [02:22<01:15,  2.16s/it]Best trial: 65. Best value: 0.15647:  66%|██████▌   | 66/100 [02:22<01:11,  2.12s/it]Best trial: 65. Best value: 0.15647:  66%|██████▌   | 66/100 [02:24<01:11,  2.12s/it]Best trial: 65. Best value: 0.15647:  67%|██████▋   | 67/100 [02:24<01:07,  2.06s/it]Best trial: 65. Best value: 0.15647:  67%|██████▋   | 67/100 [02:28<01:07,  2.06s/it]Best trial: 65. Best value: 0.15647:  68%|██████▊   | 68/100 [02:28<01:17,  2.41s/it]Best trial: 65. Best value: 0.15647:  68%|██████▊   | 68/100 [02:30<01:17,  2.41s/it]Best trial: 65. Best value: 0.15647:  69%|██████▉   | 69/100 [02:30<01:10,  2.26s/it]Best trial: 65. Best value: 0.15647:  69%|██████▉   | 69/100 [02:32<01:10,  2.26s/it]Best trial: 65. Best value: 0.15647:  70%|███████   | 70/100 [02:32<01:11,  2.38s/it]Best trial: 65. Best value: 0.15647:  70%|███████   | 70/100 [02:34<01:11,  2.38s/it]Best trial: 65. Best value: 0.15647:  71%|███████   | 71/100 [02:34<01:05,  2.26s/it]Best trial: 65. Best value: 0.15647:  71%|███████   | 71/100 [02:36<01:05,  2.26s/it]Best trial: 65. Best value: 0.15647:  72%|███████▏  | 72/100 [02:36<01:00,  2.15s/it]Best trial: 65. Best value: 0.15647:  72%|███████▏  | 72/100 [02:39<01:00,  2.15s/it]Best trial: 65. Best value: 0.15647:  73%|███████▎  | 73/100 [02:39<01:01,  2.27s/it]Best trial: 73. Best value: 0.161908:  73%|███████▎  | 73/100 [02:42<01:01,  2.27s/it]Best trial: 73. Best value: 0.161908:  74%|███████▍  | 74/100 [02:42<01:08,  2.64s/it]Best trial: 73. Best value: 0.161908:  74%|███████▍  | 74/100 [02:45<01:08,  2.64s/it]Best trial: 73. Best value: 0.161908:  75%|███████▌  | 75/100 [02:45<01:10,  2.81s/it]Best trial: 73. Best value: 0.161908:  75%|███████▌  | 75/100 [02:49<01:10,  2.81s/it]Best trial: 73. Best value: 0.161908:  76%|███████▌  | 76/100 [02:49<01:10,  2.94s/it]Best trial: 73. Best value: 0.161908:  76%|███████▌  | 76/100 [02:51<01:10,  2.94s/it]Best trial: 73. Best value: 0.161908:  77%|███████▋  | 77/100 [02:51<01:01,  2.68s/it]Best trial: 73. Best value: 0.161908:  77%|███████▋  | 77/100 [02:53<01:01,  2.68s/it]Best trial: 73. Best value: 0.161908:  78%|███████▊  | 78/100 [02:53<00:56,  2.55s/it]Best trial: 73. Best value: 0.161908:  78%|███████▊  | 78/100 [02:55<00:56,  2.55s/it]Best trial: 73. Best value: 0.161908:  79%|███████▉  | 79/100 [02:55<00:52,  2.50s/it]Best trial: 73. Best value: 0.161908:  79%|███████▉  | 79/100 [02:58<00:52,  2.50s/it]Best trial: 73. Best value: 0.161908:  80%|████████  | 80/100 [02:58<00:48,  2.42s/it]Best trial: 73. Best value: 0.161908:  80%|████████  | 80/100 [03:00<00:48,  2.42s/it]Best trial: 73. Best value: 0.161908:  81%|████████  | 81/100 [03:00<00:44,  2.34s/it]Best trial: 73. Best value: 0.161908:  81%|████████  | 81/100 [03:02<00:44,  2.34s/it]Best trial: 73. Best value: 0.161908:  82%|████████▏ | 82/100 [03:02<00:39,  2.19s/it]Best trial: 73. Best value: 0.161908:  82%|████████▏ | 82/100 [03:03<00:39,  2.19s/it]Best trial: 73. Best value: 0.161908:  83%|████████▎ | 83/100 [03:03<00:34,  2.05s/it]Best trial: 73. Best value: 0.161908:  83%|████████▎ | 83/100 [03:05<00:34,  2.05s/it]Best trial: 73. Best value: 0.161908:  84%|████████▍ | 84/100 [03:05<00:32,  2.06s/it]Best trial: 73. Best value: 0.161908:  84%|████████▍ | 84/100 [03:08<00:32,  2.06s/it]Best trial: 73. Best value: 0.161908:  85%|████████▌ | 85/100 [03:08<00:31,  2.10s/it]Best trial: 73. Best value: 0.161908:  85%|████████▌ | 85/100 [03:10<00:31,  2.10s/it]Best trial: 73. Best value: 0.161908:  86%|████████▌ | 86/100 [03:10<00:30,  2.17s/it]Best trial: 73. Best value: 0.161908:  86%|████████▌ | 86/100 [03:12<00:30,  2.17s/it]Best trial: 73. Best value: 0.161908:  87%|████████▋ | 87/100 [03:12<00:27,  2.08s/it]Best trial: 73. Best value: 0.161908:  87%|████████▋ | 87/100 [03:14<00:27,  2.08s/it]Best trial: 73. Best value: 0.161908:  88%|████████▊ | 88/100 [03:14<00:24,  2.00s/it]Best trial: 73. Best value: 0.161908:  88%|████████▊ | 88/100 [03:16<00:24,  2.00s/it]Best trial: 73. Best value: 0.161908:  89%|████████▉ | 89/100 [03:16<00:24,  2.22s/it]Best trial: 73. Best value: 0.161908:  89%|████████▉ | 89/100 [03:18<00:24,  2.22s/it]Best trial: 73. Best value: 0.161908:  90%|█████████ | 90/100 [03:18<00:21,  2.12s/it]Best trial: 73. Best value: 0.161908:  90%|█████████ | 90/100 [03:20<00:21,  2.12s/it]Best trial: 73. Best value: 0.161908:  91%|█████████ | 91/100 [03:20<00:18,  2.07s/it]Best trial: 73. Best value: 0.161908:  91%|█████████ | 91/100 [03:22<00:18,  2.07s/it]Best trial: 73. Best value: 0.161908:  92%|█████████▏| 92/100 [03:22<00:15,  1.99s/it]Best trial: 73. Best value: 0.161908:  92%|█████████▏| 92/100 [03:24<00:15,  1.99s/it]Best trial: 73. Best value: 0.161908:  93%|█████████▎| 93/100 [03:24<00:13,  1.99s/it]Best trial: 73. Best value: 0.161908:  93%|█████████▎| 93/100 [03:26<00:13,  1.99s/it]Best trial: 73. Best value: 0.161908:  94%|█████████▍| 94/100 [03:26<00:12,  2.13s/it]Best trial: 73. Best value: 0.161908:  94%|█████████▍| 94/100 [03:28<00:12,  2.13s/it]Best trial: 73. Best value: 0.161908:  95%|█████████▌| 95/100 [03:28<00:10,  2.02s/it]Best trial: 73. Best value: 0.161908:  95%|█████████▌| 95/100 [03:30<00:10,  2.02s/it]Best trial: 73. Best value: 0.161908:  96%|█████████▌| 96/100 [03:30<00:07,  1.89s/it]Best trial: 73. Best value: 0.161908:  96%|█████████▌| 96/100 [03:31<00:07,  1.89s/it]Best trial: 73. Best value: 0.161908:  97%|█████████▋| 97/100 [03:31<00:05,  1.80s/it]Best trial: 73. Best value: 0.161908:  97%|█████████▋| 97/100 [03:33<00:05,  1.80s/it]Best trial: 73. Best value: 0.161908:  98%|█████████▊| 98/100 [03:33<00:03,  1.89s/it]Best trial: 73. Best value: 0.161908:  98%|█████████▊| 98/100 [03:35<00:03,  1.89s/it]Best trial: 73. Best value: 0.161908:  99%|█████████▉| 99/100 [03:35<00:01,  1.79s/it]Best trial: 73. Best value: 0.161908:  99%|█████████▉| 99/100 [03:37<00:01,  1.79s/it]Best trial: 73. Best value: 0.161908: 100%|██████████| 100/100 [03:37<00:00,  1.83s/it]Best trial: 73. Best value: 0.161908: 100%|██████████| 100/100 [03:37<00:00,  2.17s/it]
2025-11-30 11:41:51,428 - INFO - HPO Complete. Best AUPRC: 0.1619
2025-11-30 11:41:51,429 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.004012057290968359, 'max_depth': 6, 'subsample': 0.6099099501984808, 'colsample_bytree': 0.9429088222926636, 'gamma': 1.5559396443647497, 'reg_lambda': 0.00030373045279628256, 'reg_alpha': 0.04665261899658713}
2025-11-30 11:41:51,430 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:41:53,369 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 11:41:53,369 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:41:53,454 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:41:53,473 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:41:53,477 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 11:41:53,477 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:41:53,477 - INFO - Training model...
2025-11-30 11:41:56,412 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:42:01,409 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:42:01,409 - INFO - AUROC: 0.6257 (0.5046 - 0.7573)
2025-11-30 11:42:01,409 - INFO - AUPRC: 0.0523 (0.0167 - 0.1742)
2025-11-30 11:42:01,409 - INFO - Brier Score: 0.0183 (0.0130 - 0.0275)
2025-11-30 11:42:01,409 - INFO - Accuracy: 0.9827 (0.7549 - 0.9910)
2025-11-30 11:42:01,409 - INFO - Precision: 0.2500 (0.0217 - 0.8000)
2025-11-30 11:42:01,409 - INFO - Sensitivity (Recall): 0.1000 (0.0808 - 0.6000)
2025-11-30 11:42:01,409 - INFO - F1-Score: 0.1429 (0.0388 - 0.3179)
2025-11-30 11:42:01,409 - INFO - Best Threshold: 0.3700 (0.1060 - 0.3700)
2025-11-30 11:42:01,409 - INFO - Specificity: 0.9956 (0.7607 - 0.9991)
2025-11-30 11:42:01,431 - INFO - Calculating SHAP values...
2025-11-30 11:42:02,631 - INFO - SHAP plots saved.
2025-11-30 11:42:02,633 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:42:03,914 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 11:42:03,915 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:42:04,021 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:42:04,065 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:42:04,078 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 11:42:04,078 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.25077:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.25077:   1%|          | 1/100 [00:02<04:48,  2.92s/it]Best trial: 1. Best value: 0.308974:   1%|          | 1/100 [00:05<04:48,  2.92s/it]Best trial: 1. Best value: 0.308974:   2%|▏         | 2/100 [00:05<04:31,  2.77s/it]Best trial: 1. Best value: 0.308974:   2%|▏         | 2/100 [00:08<04:31,  2.77s/it]Best trial: 1. Best value: 0.308974:   3%|▎         | 3/100 [00:08<04:21,  2.70s/it]Best trial: 3. Best value: 0.323978:   3%|▎         | 3/100 [00:10<04:21,  2.70s/it]Best trial: 3. Best value: 0.323978:   4%|▍         | 4/100 [00:10<04:16,  2.67s/it]Best trial: 3. Best value: 0.323978:   4%|▍         | 4/100 [00:13<04:16,  2.67s/it]Best trial: 3. Best value: 0.323978:   5%|▌         | 5/100 [00:13<04:24,  2.78s/it]Best trial: 3. Best value: 0.323978:   5%|▌         | 5/100 [00:18<04:24,  2.78s/it]Best trial: 3. Best value: 0.323978:   6%|▌         | 6/100 [00:18<05:08,  3.29s/it]Best trial: 3. Best value: 0.323978:   6%|▌         | 6/100 [00:20<05:08,  3.29s/it]Best trial: 3. Best value: 0.323978:   7%|▋         | 7/100 [00:20<04:39,  3.01s/it]Best trial: 3. Best value: 0.323978:   7%|▋         | 7/100 [00:23<04:39,  3.01s/it]Best trial: 3. Best value: 0.323978:   8%|▊         | 8/100 [00:23<04:29,  2.93s/it]Best trial: 3. Best value: 0.323978:   8%|▊         | 8/100 [00:25<04:29,  2.93s/it]Best trial: 3. Best value: 0.323978:   9%|▉         | 9/100 [00:25<04:12,  2.77s/it]Best trial: 3. Best value: 0.323978:   9%|▉         | 9/100 [00:27<04:12,  2.77s/it]Best trial: 3. Best value: 0.323978:  10%|█         | 10/100 [00:27<03:56,  2.63s/it]Best trial: 3. Best value: 0.323978:  10%|█         | 10/100 [00:32<03:56,  2.63s/it]Best trial: 3. Best value: 0.323978:  11%|█         | 11/100 [00:32<04:37,  3.12s/it]Best trial: 11. Best value: 0.365913:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]Best trial: 11. Best value: 0.365913:  12%|█▏        | 12/100 [00:34<04:19,  2.95s/it]Best trial: 11. Best value: 0.365913:  12%|█▏        | 12/100 [00:37<04:19,  2.95s/it]Best trial: 11. Best value: 0.365913:  13%|█▎        | 13/100 [00:37<04:05,  2.82s/it]Best trial: 11. Best value: 0.365913:  13%|█▎        | 13/100 [00:39<04:05,  2.82s/it]Best trial: 11. Best value: 0.365913:  14%|█▍        | 14/100 [00:39<03:43,  2.60s/it]Best trial: 11. Best value: 0.365913:  14%|█▍        | 14/100 [00:41<03:43,  2.60s/it]Best trial: 11. Best value: 0.365913:  15%|█▌        | 15/100 [00:41<03:39,  2.58s/it]Best trial: 11. Best value: 0.365913:  15%|█▌        | 15/100 [00:44<03:39,  2.58s/it]Best trial: 11. Best value: 0.365913:  16%|█▌        | 16/100 [00:44<03:38,  2.61s/it]Best trial: 11. Best value: 0.365913:  16%|█▌        | 16/100 [00:48<03:38,  2.61s/it]Best trial: 11. Best value: 0.365913:  17%|█▋        | 17/100 [00:48<04:08,  3.00s/it]Best trial: 11. Best value: 0.365913:  17%|█▋        | 17/100 [00:53<04:08,  3.00s/it]Best trial: 11. Best value: 0.365913:  18%|█▊        | 18/100 [00:53<04:46,  3.49s/it]Best trial: 11. Best value: 0.365913:  18%|█▊        | 18/100 [00:57<04:46,  3.49s/it]Best trial: 11. Best value: 0.365913:  19%|█▉        | 19/100 [00:57<04:58,  3.68s/it]Best trial: 11. Best value: 0.365913:  19%|█▉        | 19/100 [01:00<04:58,  3.68s/it]Best trial: 11. Best value: 0.365913:  20%|██        | 20/100 [01:00<04:52,  3.66s/it]Best trial: 11. Best value: 0.365913:  20%|██        | 20/100 [01:05<04:52,  3.66s/it]Best trial: 11. Best value: 0.365913:  21%|██        | 21/100 [01:05<05:00,  3.81s/it]Best trial: 11. Best value: 0.365913:  21%|██        | 21/100 [01:08<05:00,  3.81s/it]Best trial: 11. Best value: 0.365913:  22%|██▏       | 22/100 [01:08<04:42,  3.63s/it]Best trial: 11. Best value: 0.365913:  22%|██▏       | 22/100 [01:12<04:42,  3.63s/it]Best trial: 11. Best value: 0.365913:  23%|██▎       | 23/100 [01:12<04:54,  3.82s/it]Best trial: 11. Best value: 0.365913:  23%|██▎       | 23/100 [01:16<04:54,  3.82s/it]Best trial: 11. Best value: 0.365913:  24%|██▍       | 24/100 [01:16<04:48,  3.79s/it]Best trial: 11. Best value: 0.365913:  24%|██▍       | 24/100 [01:18<04:48,  3.79s/it]Best trial: 11. Best value: 0.365913:  25%|██▌       | 25/100 [01:18<04:16,  3.42s/it]Best trial: 11. Best value: 0.365913:  25%|██▌       | 25/100 [01:22<04:16,  3.42s/it]Best trial: 11. Best value: 0.365913:  26%|██▌       | 26/100 [01:22<04:09,  3.37s/it]Best trial: 11. Best value: 0.365913:  26%|██▌       | 26/100 [01:24<04:09,  3.37s/it]Best trial: 11. Best value: 0.365913:  27%|██▋       | 27/100 [01:24<03:45,  3.10s/it]Best trial: 11. Best value: 0.365913:  27%|██▋       | 27/100 [01:27<03:45,  3.10s/it]Best trial: 11. Best value: 0.365913:  28%|██▊       | 28/100 [01:27<03:35,  2.99s/it]Best trial: 11. Best value: 0.365913:  28%|██▊       | 28/100 [01:30<03:35,  2.99s/it]Best trial: 11. Best value: 0.365913:  29%|██▉       | 29/100 [01:30<03:33,  3.01s/it]Best trial: 11. Best value: 0.365913:  29%|██▉       | 29/100 [01:33<03:33,  3.01s/it]Best trial: 11. Best value: 0.365913:  30%|███       | 30/100 [01:33<03:30,  3.00s/it]Best trial: 11. Best value: 0.365913:  30%|███       | 30/100 [01:36<03:30,  3.00s/it]Best trial: 11. Best value: 0.365913:  31%|███       | 31/100 [01:36<03:26,  2.99s/it]Best trial: 11. Best value: 0.365913:  31%|███       | 31/100 [01:38<03:26,  2.99s/it]Best trial: 11. Best value: 0.365913:  32%|███▏      | 32/100 [01:38<03:11,  2.81s/it]Best trial: 11. Best value: 0.365913:  32%|███▏      | 32/100 [01:42<03:11,  2.81s/it]Best trial: 11. Best value: 0.365913:  33%|███▎      | 33/100 [01:42<03:19,  2.98s/it]Best trial: 11. Best value: 0.365913:  33%|███▎      | 33/100 [01:44<03:19,  2.98s/it]Best trial: 11. Best value: 0.365913:  34%|███▍      | 34/100 [01:44<03:04,  2.80s/it]Best trial: 34. Best value: 0.396997:  34%|███▍      | 34/100 [01:47<03:04,  2.80s/it]Best trial: 34. Best value: 0.396997:  35%|███▌      | 35/100 [01:47<03:11,  2.95s/it]Best trial: 34. Best value: 0.396997:  35%|███▌      | 35/100 [01:51<03:11,  2.95s/it]Best trial: 34. Best value: 0.396997:  36%|███▌      | 36/100 [01:51<03:18,  3.10s/it]Best trial: 34. Best value: 0.396997:  36%|███▌      | 36/100 [01:54<03:18,  3.10s/it]Best trial: 34. Best value: 0.396997:  37%|███▋      | 37/100 [01:54<03:17,  3.14s/it]Best trial: 34. Best value: 0.396997:  37%|███▋      | 37/100 [01:57<03:17,  3.14s/it]Best trial: 34. Best value: 0.396997:  38%|███▊      | 38/100 [01:57<03:13,  3.11s/it]Best trial: 34. Best value: 0.396997:  38%|███▊      | 38/100 [02:00<03:13,  3.11s/it]Best trial: 34. Best value: 0.396997:  39%|███▉      | 39/100 [02:00<03:11,  3.14s/it]Best trial: 34. Best value: 0.396997:  39%|███▉      | 39/100 [02:03<03:11,  3.14s/it]Best trial: 34. Best value: 0.396997:  40%|████      | 40/100 [02:03<03:12,  3.21s/it]Best trial: 34. Best value: 0.396997:  40%|████      | 40/100 [02:06<03:12,  3.21s/it]Best trial: 34. Best value: 0.396997:  41%|████      | 41/100 [02:06<03:05,  3.14s/it]Best trial: 34. Best value: 0.396997:  41%|████      | 41/100 [02:09<03:05,  3.14s/it]Best trial: 34. Best value: 0.396997:  42%|████▏     | 42/100 [02:09<02:49,  2.92s/it]Best trial: 34. Best value: 0.396997:  42%|████▏     | 42/100 [02:11<02:49,  2.92s/it]Best trial: 34. Best value: 0.396997:  43%|████▎     | 43/100 [02:11<02:39,  2.80s/it]Best trial: 34. Best value: 0.396997:  43%|████▎     | 43/100 [02:14<02:39,  2.80s/it]Best trial: 34. Best value: 0.396997:  44%|████▍     | 44/100 [02:14<02:36,  2.79s/it]Best trial: 34. Best value: 0.396997:  44%|████▍     | 44/100 [02:17<02:36,  2.79s/it]Best trial: 34. Best value: 0.396997:  45%|████▌     | 45/100 [02:17<02:27,  2.68s/it]Best trial: 34. Best value: 0.396997:  45%|████▌     | 45/100 [02:19<02:27,  2.68s/it]Best trial: 34. Best value: 0.396997:  46%|████▌     | 46/100 [02:19<02:25,  2.70s/it]Best trial: 34. Best value: 0.396997:  46%|████▌     | 46/100 [02:22<02:25,  2.70s/it]Best trial: 34. Best value: 0.396997:  47%|████▋     | 47/100 [02:22<02:21,  2.66s/it]Best trial: 34. Best value: 0.396997:  47%|████▋     | 47/100 [02:25<02:21,  2.66s/it]Best trial: 34. Best value: 0.396997:  48%|████▊     | 48/100 [02:25<02:28,  2.85s/it]Best trial: 34. Best value: 0.396997:  48%|████▊     | 48/100 [02:28<02:28,  2.85s/it]Best trial: 34. Best value: 0.396997:  49%|████▉     | 49/100 [02:28<02:30,  2.95s/it]Best trial: 34. Best value: 0.396997:  49%|████▉     | 49/100 [02:32<02:30,  2.95s/it]Best trial: 34. Best value: 0.396997:  50%|█████     | 50/100 [02:32<02:39,  3.19s/it]Best trial: 34. Best value: 0.396997:  50%|█████     | 50/100 [02:35<02:39,  3.19s/it]Best trial: 34. Best value: 0.396997:  51%|█████     | 51/100 [02:35<02:36,  3.20s/it]Best trial: 34. Best value: 0.396997:  51%|█████     | 51/100 [02:38<02:36,  3.20s/it]Best trial: 34. Best value: 0.396997:  52%|█████▏    | 52/100 [02:38<02:21,  2.94s/it]Best trial: 34. Best value: 0.396997:  52%|█████▏    | 52/100 [02:40<02:21,  2.94s/it]Best trial: 34. Best value: 0.396997:  53%|█████▎    | 53/100 [02:40<02:12,  2.81s/it]Best trial: 34. Best value: 0.396997:  53%|█████▎    | 53/100 [02:42<02:12,  2.81s/it]Best trial: 34. Best value: 0.396997:  54%|█████▍    | 54/100 [02:42<02:01,  2.64s/it]Best trial: 34. Best value: 0.396997:  54%|█████▍    | 54/100 [02:45<02:01,  2.64s/it]Best trial: 34. Best value: 0.396997:  55%|█████▌    | 55/100 [02:45<01:58,  2.63s/it]Best trial: 34. Best value: 0.396997:  55%|█████▌    | 55/100 [02:48<01:58,  2.63s/it]Best trial: 34. Best value: 0.396997:  56%|█████▌    | 56/100 [02:48<01:56,  2.65s/it]Best trial: 34. Best value: 0.396997:  56%|█████▌    | 56/100 [02:50<01:56,  2.65s/it]Best trial: 34. Best value: 0.396997:  57%|█████▋    | 57/100 [02:50<01:53,  2.65s/it]Best trial: 34. Best value: 0.396997:  57%|█████▋    | 57/100 [02:53<01:53,  2.65s/it]Best trial: 34. Best value: 0.396997:  58%|█████▊    | 58/100 [02:53<01:46,  2.54s/it]Best trial: 34. Best value: 0.396997:  58%|█████▊    | 58/100 [02:56<01:46,  2.54s/it]Best trial: 34. Best value: 0.396997:  59%|█████▉    | 59/100 [02:56<01:55,  2.81s/it]Best trial: 34. Best value: 0.396997:  59%|█████▉    | 59/100 [03:00<01:55,  2.81s/it]Best trial: 34. Best value: 0.396997:  60%|██████    | 60/100 [03:00<02:02,  3.07s/it]Best trial: 34. Best value: 0.396997:  60%|██████    | 60/100 [03:03<02:02,  3.07s/it]Best trial: 34. Best value: 0.396997:  61%|██████    | 61/100 [03:03<02:01,  3.10s/it]Best trial: 34. Best value: 0.396997:  61%|██████    | 61/100 [03:06<02:01,  3.10s/it]Best trial: 34. Best value: 0.396997:  62%|██████▏   | 62/100 [03:06<01:52,  2.95s/it]Best trial: 34. Best value: 0.396997:  62%|██████▏   | 62/100 [03:09<01:52,  2.95s/it]Best trial: 34. Best value: 0.396997:  63%|██████▎   | 63/100 [03:09<01:49,  2.96s/it]Best trial: 34. Best value: 0.396997:  63%|██████▎   | 63/100 [03:13<01:49,  2.96s/it]Best trial: 34. Best value: 0.396997:  64%|██████▍   | 64/100 [03:13<02:00,  3.36s/it]Best trial: 34. Best value: 0.396997:  64%|██████▍   | 64/100 [03:17<02:00,  3.36s/it]Best trial: 34. Best value: 0.396997:  65%|██████▌   | 65/100 [03:17<02:00,  3.45s/it]Best trial: 34. Best value: 0.396997:  65%|██████▌   | 65/100 [03:21<02:00,  3.45s/it]Best trial: 34. Best value: 0.396997:  66%|██████▌   | 66/100 [03:21<02:05,  3.68s/it]Best trial: 34. Best value: 0.396997:  66%|██████▌   | 66/100 [03:23<02:05,  3.68s/it]Best trial: 34. Best value: 0.396997:  67%|██████▋   | 67/100 [03:23<01:49,  3.33s/it]Best trial: 34. Best value: 0.396997:  67%|██████▋   | 67/100 [03:27<01:49,  3.33s/it]Best trial: 34. Best value: 0.396997:  68%|██████▊   | 68/100 [03:27<01:50,  3.45s/it]Best trial: 34. Best value: 0.396997:  68%|██████▊   | 68/100 [03:30<01:50,  3.45s/it]Best trial: 34. Best value: 0.396997:  69%|██████▉   | 69/100 [03:30<01:41,  3.26s/it]Best trial: 34. Best value: 0.396997:  69%|██████▉   | 69/100 [03:33<01:41,  3.26s/it]Best trial: 34. Best value: 0.396997:  70%|███████   | 70/100 [03:33<01:38,  3.28s/it]Best trial: 34. Best value: 0.396997:  70%|███████   | 70/100 [03:37<01:38,  3.28s/it]Best trial: 34. Best value: 0.396997:  71%|███████   | 71/100 [03:37<01:40,  3.48s/it]Best trial: 34. Best value: 0.396997:  71%|███████   | 71/100 [03:42<01:40,  3.48s/it]Best trial: 34. Best value: 0.396997:  72%|███████▏  | 72/100 [03:42<01:49,  3.90s/it]Best trial: 34. Best value: 0.396997:  72%|███████▏  | 72/100 [03:47<01:49,  3.90s/it]Best trial: 34. Best value: 0.396997:  73%|███████▎  | 73/100 [03:47<01:55,  4.29s/it]Best trial: 34. Best value: 0.396997:  73%|███████▎  | 73/100 [03:52<01:55,  4.29s/it]Best trial: 34. Best value: 0.396997:  74%|███████▍  | 74/100 [03:52<01:55,  4.44s/it]Best trial: 34. Best value: 0.396997:  74%|███████▍  | 74/100 [03:55<01:55,  4.44s/it]Best trial: 34. Best value: 0.396997:  75%|███████▌  | 75/100 [03:55<01:42,  4.12s/it]Best trial: 34. Best value: 0.396997:  75%|███████▌  | 75/100 [03:58<01:42,  4.12s/it]Best trial: 34. Best value: 0.396997:  76%|███████▌  | 76/100 [03:58<01:28,  3.68s/it]Best trial: 34. Best value: 0.396997:  76%|███████▌  | 76/100 [04:01<01:28,  3.68s/it]Best trial: 34. Best value: 0.396997:  77%|███████▋  | 77/100 [04:01<01:19,  3.44s/it]Best trial: 34. Best value: 0.396997:  77%|███████▋  | 77/100 [04:04<01:19,  3.44s/it]Best trial: 34. Best value: 0.396997:  78%|███████▊  | 78/100 [04:04<01:15,  3.44s/it]Best trial: 34. Best value: 0.396997:  78%|███████▊  | 78/100 [04:10<01:15,  3.44s/it]Best trial: 34. Best value: 0.396997:  79%|███████▉  | 79/100 [04:10<01:25,  4.08s/it]Best trial: 34. Best value: 0.396997:  79%|███████▉  | 79/100 [04:14<01:25,  4.08s/it]Best trial: 34. Best value: 0.396997:  80%|████████  | 80/100 [04:14<01:24,  4.22s/it]Best trial: 34. Best value: 0.396997:  80%|████████  | 80/100 [04:21<01:24,  4.22s/it]Best trial: 34. Best value: 0.396997:  81%|████████  | 81/100 [04:21<01:32,  4.86s/it]Best trial: 34. Best value: 0.396997:  81%|████████  | 81/100 [04:25<01:32,  4.86s/it]Best trial: 34. Best value: 0.396997:  82%|████████▏ | 82/100 [04:25<01:21,  4.54s/it]Best trial: 34. Best value: 0.396997:  82%|████████▏ | 82/100 [04:28<01:21,  4.54s/it]Best trial: 34. Best value: 0.396997:  83%|████████▎ | 83/100 [04:28<01:14,  4.36s/it]Best trial: 34. Best value: 0.396997:  83%|████████▎ | 83/100 [04:33<01:14,  4.36s/it]Best trial: 34. Best value: 0.396997:  84%|████████▍ | 84/100 [04:33<01:11,  4.47s/it]Best trial: 34. Best value: 0.396997:  84%|████████▍ | 84/100 [04:38<01:11,  4.47s/it]Best trial: 34. Best value: 0.396997:  85%|████████▌ | 85/100 [04:38<01:07,  4.53s/it]Best trial: 34. Best value: 0.396997:  85%|████████▌ | 85/100 [04:41<01:07,  4.53s/it]Best trial: 34. Best value: 0.396997:  86%|████████▌ | 86/100 [04:41<00:59,  4.22s/it]Best trial: 34. Best value: 0.396997:  86%|████████▌ | 86/100 [04:45<00:59,  4.22s/it]Best trial: 34. Best value: 0.396997:  87%|████████▋ | 87/100 [04:45<00:52,  4.05s/it]Best trial: 34. Best value: 0.396997:  87%|████████▋ | 87/100 [04:48<00:52,  4.05s/it]Best trial: 34. Best value: 0.396997:  88%|████████▊ | 88/100 [04:48<00:43,  3.61s/it]Best trial: 34. Best value: 0.396997:  88%|████████▊ | 88/100 [04:51<00:43,  3.61s/it]Best trial: 34. Best value: 0.396997:  89%|████████▉ | 89/100 [04:51<00:39,  3.62s/it]Best trial: 34. Best value: 0.396997:  89%|████████▉ | 89/100 [04:55<00:39,  3.62s/it]Best trial: 34. Best value: 0.396997:  90%|█████████ | 90/100 [04:55<00:35,  3.56s/it]Best trial: 34. Best value: 0.396997:  90%|█████████ | 90/100 [04:59<00:35,  3.56s/it]Best trial: 34. Best value: 0.396997:  91%|█████████ | 91/100 [04:59<00:34,  3.81s/it]Best trial: 34. Best value: 0.396997:  91%|█████████ | 91/100 [05:02<00:34,  3.81s/it]Best trial: 34. Best value: 0.396997:  92%|█████████▏| 92/100 [05:02<00:29,  3.68s/it]Best trial: 34. Best value: 0.396997:  92%|█████████▏| 92/100 [05:06<00:29,  3.68s/it]Best trial: 34. Best value: 0.396997:  93%|█████████▎| 93/100 [05:06<00:25,  3.58s/it]Best trial: 34. Best value: 0.396997:  93%|█████████▎| 93/100 [05:11<00:25,  3.58s/it]Best trial: 34. Best value: 0.396997:  94%|█████████▍| 94/100 [05:11<00:23,  3.99s/it]Best trial: 34. Best value: 0.396997:  94%|█████████▍| 94/100 [05:15<00:23,  3.99s/it]Best trial: 34. Best value: 0.396997:  95%|█████████▌| 95/100 [05:15<00:19,  3.98s/it]Best trial: 34. Best value: 0.396997:  95%|█████████▌| 95/100 [05:19<00:19,  3.98s/it]Best trial: 34. Best value: 0.396997:  96%|█████████▌| 96/100 [05:19<00:16,  4.03s/it]Best trial: 34. Best value: 0.396997:  96%|█████████▌| 96/100 [05:22<00:16,  4.03s/it]Best trial: 34. Best value: 0.396997:  97%|█████████▋| 97/100 [05:22<00:11,  3.74s/it]Best trial: 34. Best value: 0.396997:  97%|█████████▋| 97/100 [05:27<00:11,  3.74s/it]Best trial: 34. Best value: 0.396997:  98%|█████████▊| 98/100 [05:27<00:08,  4.18s/it]Best trial: 34. Best value: 0.396997:  98%|█████████▊| 98/100 [05:31<00:08,  4.18s/it]Best trial: 34. Best value: 0.396997:  99%|█████████▉| 99/100 [05:31<00:04,  4.15s/it]Best trial: 34. Best value: 0.396997:  99%|█████████▉| 99/100 [05:37<00:04,  4.15s/it]Best trial: 34. Best value: 0.396997: 100%|██████████| 100/100 [05:37<00:00,  4.64s/it]Best trial: 34. Best value: 0.396997: 100%|██████████| 100/100 [05:37<00:00,  3.37s/it]
2025-11-30 11:47:41,553 - INFO - HPO Complete. Best AUPRC: 0.3970
2025-11-30 11:47:41,554 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.09803577345758956, 'max_depth': 8, 'subsample': 0.6023094140130821, 'colsample_bytree': 0.8188025100649159, 'gamma': 2.382851645632021, 'reg_lambda': 0.2049849107443057, 'reg_alpha': 5.507122539174193e-06}
2025-11-30 11:47:41,555 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:47:43,754 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 11:47:43,754 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:47:43,854 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:47:43,894 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:47:43,907 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 11:47:43,907 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:47:43,907 - INFO - Training model...
2025-11-30 11:47:45,896 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:47:51,502 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:47:51,503 - INFO - AUROC: 0.6922 (0.5453 - 0.8275)
2025-11-30 11:47:51,503 - INFO - AUPRC: 0.2408 (0.0189 - 0.4838)
2025-11-30 11:47:51,503 - INFO - Brier Score: 0.0150 (0.0103 - 0.0263)
2025-11-30 11:47:51,503 - INFO - Accuracy: 0.9884 (0.8997 - 0.9948)
2025-11-30 11:47:51,503 - INFO - Precision: 1.0000 (0.0130 - 1.0000)
2025-11-30 11:47:51,503 - INFO - Sensitivity (Recall): 0.2000 (0.0462 - 0.5000)
2025-11-30 11:47:51,503 - INFO - F1-Score: 0.3333 (0.0226 - 0.6267)
2025-11-30 11:47:51,503 - INFO - Best Threshold: 0.8100 (0.0160 - 0.8100)
2025-11-30 11:47:51,503 - INFO - Specificity: 1.0000 (0.9085 - 1.0000)
2025-11-30 11:47:51,518 - INFO - Calculating SHAP values...
2025-11-30 11:47:52,673 - INFO - SHAP plots saved.
2025-11-30 11:47:52,676 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:47:54,059 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 11:47:54,059 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:47:54,151 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:47:54,162 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:47:54,165 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 11:47:54,165 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0503786:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0503786:   1%|          | 1/100 [00:02<03:25,  2.07s/it]Best trial: 0. Best value: 0.0503786:   1%|          | 1/100 [00:04<03:25,  2.07s/it]Best trial: 0. Best value: 0.0503786:   2%|▏         | 2/100 [00:04<03:43,  2.28s/it]Best trial: 2. Best value: 0.0578866:   2%|▏         | 2/100 [00:05<03:43,  2.28s/it]Best trial: 2. Best value: 0.0578866:   3%|▎         | 3/100 [00:05<03:01,  1.87s/it]Best trial: 2. Best value: 0.0578866:   3%|▎         | 3/100 [00:07<03:01,  1.87s/it]Best trial: 2. Best value: 0.0578866:   4%|▍         | 4/100 [00:07<03:04,  1.92s/it]Best trial: 2. Best value: 0.0578866:   4%|▍         | 4/100 [00:09<03:04,  1.92s/it]Best trial: 2. Best value: 0.0578866:   5%|▌         | 5/100 [00:09<02:45,  1.74s/it]Best trial: 5. Best value: 0.085126:   5%|▌         | 5/100 [00:10<02:45,  1.74s/it] Best trial: 5. Best value: 0.085126:   6%|▌         | 6/100 [00:10<02:23,  1.53s/it]Best trial: 5. Best value: 0.085126:   6%|▌         | 6/100 [00:12<02:23,  1.53s/it]Best trial: 5. Best value: 0.085126:   7%|▋         | 7/100 [00:12<02:42,  1.74s/it]Best trial: 5. Best value: 0.085126:   7%|▋         | 7/100 [00:16<02:42,  1.74s/it]Best trial: 5. Best value: 0.085126:   8%|▊         | 8/100 [00:16<03:37,  2.36s/it]Best trial: 5. Best value: 0.085126:   8%|▊         | 8/100 [00:18<03:37,  2.36s/it]Best trial: 5. Best value: 0.085126:   9%|▉         | 9/100 [00:18<03:23,  2.23s/it]Best trial: 5. Best value: 0.085126:   9%|▉         | 9/100 [00:20<03:23,  2.23s/it]Best trial: 5. Best value: 0.085126:  10%|█         | 10/100 [00:20<03:30,  2.33s/it]Best trial: 5. Best value: 0.085126:  10%|█         | 10/100 [00:21<03:30,  2.33s/it]Best trial: 5. Best value: 0.085126:  11%|█         | 11/100 [00:21<02:56,  1.98s/it]Best trial: 5. Best value: 0.085126:  11%|█         | 11/100 [00:24<02:56,  1.98s/it]Best trial: 5. Best value: 0.085126:  12%|█▏        | 12/100 [00:24<03:06,  2.12s/it]Best trial: 5. Best value: 0.085126:  12%|█▏        | 12/100 [00:26<03:06,  2.12s/it]Best trial: 5. Best value: 0.085126:  13%|█▎        | 13/100 [00:26<03:10,  2.18s/it]Best trial: 5. Best value: 0.085126:  13%|█▎        | 13/100 [00:28<03:10,  2.18s/it]Best trial: 5. Best value: 0.085126:  14%|█▍        | 14/100 [00:28<02:46,  1.93s/it]Best trial: 5. Best value: 0.085126:  14%|█▍        | 14/100 [00:30<02:46,  1.93s/it]Best trial: 5. Best value: 0.085126:  15%|█▌        | 15/100 [00:30<02:48,  1.99s/it]Best trial: 5. Best value: 0.085126:  15%|█▌        | 15/100 [00:32<02:48,  1.99s/it]Best trial: 5. Best value: 0.085126:  16%|█▌        | 16/100 [00:32<02:42,  1.94s/it]Best trial: 5. Best value: 0.085126:  16%|█▌        | 16/100 [00:33<02:42,  1.94s/it]Best trial: 5. Best value: 0.085126:  17%|█▋        | 17/100 [00:33<02:22,  1.72s/it]Best trial: 5. Best value: 0.085126:  17%|█▋        | 17/100 [00:34<02:22,  1.72s/it]Best trial: 5. Best value: 0.085126:  18%|█▊        | 18/100 [00:34<02:14,  1.64s/it]Best trial: 5. Best value: 0.085126:  18%|█▊        | 18/100 [00:36<02:14,  1.64s/it]Best trial: 5. Best value: 0.085126:  19%|█▉        | 19/100 [00:36<02:15,  1.67s/it]Best trial: 5. Best value: 0.085126:  19%|█▉        | 19/100 [00:38<02:15,  1.67s/it]Best trial: 5. Best value: 0.085126:  20%|██        | 20/100 [00:38<02:21,  1.77s/it]Best trial: 5. Best value: 0.085126:  20%|██        | 20/100 [00:41<02:21,  1.77s/it]Best trial: 5. Best value: 0.085126:  21%|██        | 21/100 [00:41<02:58,  2.25s/it]Best trial: 5. Best value: 0.085126:  21%|██        | 21/100 [00:43<02:58,  2.25s/it]Best trial: 5. Best value: 0.085126:  22%|██▏       | 22/100 [00:43<02:43,  2.09s/it]Best trial: 5. Best value: 0.085126:  22%|██▏       | 22/100 [00:44<02:43,  2.09s/it]Best trial: 5. Best value: 0.085126:  23%|██▎       | 23/100 [00:44<02:23,  1.86s/it]Best trial: 5. Best value: 0.085126:  23%|██▎       | 23/100 [00:47<02:23,  1.86s/it]Best trial: 5. Best value: 0.085126:  24%|██▍       | 24/100 [00:47<02:32,  2.00s/it]Best trial: 5. Best value: 0.085126:  24%|██▍       | 24/100 [00:49<02:32,  2.00s/it]Best trial: 5. Best value: 0.085126:  25%|██▌       | 25/100 [00:49<02:29,  1.99s/it]Best trial: 5. Best value: 0.085126:  25%|██▌       | 25/100 [00:50<02:29,  1.99s/it]Best trial: 5. Best value: 0.085126:  26%|██▌       | 26/100 [00:50<02:19,  1.88s/it]Best trial: 5. Best value: 0.085126:  26%|██▌       | 26/100 [00:54<02:19,  1.88s/it]Best trial: 5. Best value: 0.085126:  27%|██▋       | 27/100 [00:54<02:52,  2.36s/it]Best trial: 5. Best value: 0.085126:  27%|██▋       | 27/100 [00:55<02:52,  2.36s/it]Best trial: 5. Best value: 0.085126:  28%|██▊       | 28/100 [00:55<02:30,  2.09s/it]Best trial: 5. Best value: 0.085126:  28%|██▊       | 28/100 [00:57<02:30,  2.09s/it]Best trial: 5. Best value: 0.085126:  29%|██▉       | 29/100 [00:57<02:21,  2.00s/it]Best trial: 5. Best value: 0.085126:  29%|██▉       | 29/100 [00:59<02:21,  2.00s/it]Best trial: 5. Best value: 0.085126:  30%|███       | 30/100 [00:59<02:25,  2.07s/it]Best trial: 5. Best value: 0.085126:  30%|███       | 30/100 [01:02<02:25,  2.07s/it]Best trial: 5. Best value: 0.085126:  31%|███       | 31/100 [01:02<02:28,  2.16s/it]Best trial: 5. Best value: 0.085126:  31%|███       | 31/100 [01:03<02:28,  2.16s/it]Best trial: 5. Best value: 0.085126:  32%|███▏      | 32/100 [01:03<02:06,  1.87s/it]Best trial: 5. Best value: 0.085126:  32%|███▏      | 32/100 [01:04<02:06,  1.87s/it]Best trial: 5. Best value: 0.085126:  33%|███▎      | 33/100 [01:04<01:58,  1.77s/it]Best trial: 5. Best value: 0.085126:  33%|███▎      | 33/100 [01:06<01:58,  1.77s/it]Best trial: 5. Best value: 0.085126:  34%|███▍      | 34/100 [01:06<01:44,  1.59s/it]Best trial: 5. Best value: 0.085126:  34%|███▍      | 34/100 [01:08<01:44,  1.59s/it]Best trial: 5. Best value: 0.085126:  35%|███▌      | 35/100 [01:08<01:56,  1.80s/it]Best trial: 5. Best value: 0.085126:  35%|███▌      | 35/100 [01:10<01:56,  1.80s/it]Best trial: 5. Best value: 0.085126:  36%|███▌      | 36/100 [01:10<01:59,  1.86s/it]Best trial: 5. Best value: 0.085126:  36%|███▌      | 36/100 [01:11<01:59,  1.86s/it]Best trial: 5. Best value: 0.085126:  37%|███▋      | 37/100 [01:11<01:45,  1.67s/it]Best trial: 37. Best value: 0.0902512:  37%|███▋      | 37/100 [01:12<01:45,  1.67s/it]Best trial: 37. Best value: 0.0902512:  38%|███▊      | 38/100 [01:12<01:36,  1.56s/it]Best trial: 37. Best value: 0.0902512:  38%|███▊      | 38/100 [01:15<01:36,  1.56s/it]Best trial: 37. Best value: 0.0902512:  39%|███▉      | 39/100 [01:15<01:49,  1.79s/it]Best trial: 37. Best value: 0.0902512:  39%|███▉      | 39/100 [01:17<01:49,  1.79s/it]Best trial: 37. Best value: 0.0902512:  40%|████      | 40/100 [01:17<01:50,  1.84s/it]Best trial: 37. Best value: 0.0902512:  40%|████      | 40/100 [01:19<01:50,  1.84s/it]Best trial: 37. Best value: 0.0902512:  41%|████      | 41/100 [01:19<01:57,  2.00s/it]Best trial: 37. Best value: 0.0902512:  41%|████      | 41/100 [01:21<01:57,  2.00s/it]Best trial: 37. Best value: 0.0902512:  42%|████▏     | 42/100 [01:21<01:55,  2.00s/it]Best trial: 42. Best value: 0.0958266:  42%|████▏     | 42/100 [01:22<01:55,  2.00s/it]Best trial: 42. Best value: 0.0958266:  43%|████▎     | 43/100 [01:22<01:36,  1.69s/it]Best trial: 42. Best value: 0.0958266:  43%|████▎     | 43/100 [01:23<01:36,  1.69s/it]Best trial: 42. Best value: 0.0958266:  44%|████▍     | 44/100 [01:23<01:25,  1.53s/it]Best trial: 42. Best value: 0.0958266:  44%|████▍     | 44/100 [01:24<01:25,  1.53s/it]Best trial: 42. Best value: 0.0958266:  45%|████▌     | 45/100 [01:24<01:14,  1.35s/it]Best trial: 42. Best value: 0.0958266:  45%|████▌     | 45/100 [01:26<01:14,  1.35s/it]Best trial: 42. Best value: 0.0958266:  46%|████▌     | 46/100 [01:26<01:28,  1.63s/it]Best trial: 42. Best value: 0.0958266:  46%|████▌     | 46/100 [01:27<01:28,  1.63s/it]Best trial: 42. Best value: 0.0958266:  47%|████▋     | 47/100 [01:27<01:16,  1.45s/it]Best trial: 42. Best value: 0.0958266:  47%|████▋     | 47/100 [01:30<01:16,  1.45s/it]Best trial: 42. Best value: 0.0958266:  48%|████▊     | 48/100 [01:30<01:29,  1.71s/it]Best trial: 42. Best value: 0.0958266:  48%|████▊     | 48/100 [01:31<01:29,  1.71s/it]Best trial: 42. Best value: 0.0958266:  49%|████▉     | 49/100 [01:31<01:14,  1.46s/it]Best trial: 42. Best value: 0.0958266:  49%|████▉     | 49/100 [01:33<01:14,  1.46s/it]Best trial: 42. Best value: 0.0958266:  50%|█████     | 50/100 [01:33<01:26,  1.72s/it]Best trial: 42. Best value: 0.0958266:  50%|█████     | 50/100 [01:34<01:26,  1.72s/it]Best trial: 42. Best value: 0.0958266:  51%|█████     | 51/100 [01:34<01:15,  1.54s/it]Best trial: 42. Best value: 0.0958266:  51%|█████     | 51/100 [01:35<01:15,  1.54s/it]Best trial: 42. Best value: 0.0958266:  52%|█████▏    | 52/100 [01:35<01:12,  1.51s/it]Best trial: 42. Best value: 0.0958266:  52%|█████▏    | 52/100 [01:37<01:12,  1.51s/it]Best trial: 42. Best value: 0.0958266:  53%|█████▎    | 53/100 [01:37<01:08,  1.46s/it]Best trial: 42. Best value: 0.0958266:  53%|█████▎    | 53/100 [01:38<01:08,  1.46s/it]Best trial: 42. Best value: 0.0958266:  54%|█████▍    | 54/100 [01:38<01:01,  1.34s/it]Best trial: 54. Best value: 0.11475:  54%|█████▍    | 54/100 [01:40<01:01,  1.34s/it]  Best trial: 54. Best value: 0.11475:  55%|█████▌    | 55/100 [01:40<01:17,  1.71s/it]Best trial: 54. Best value: 0.11475:  55%|█████▌    | 55/100 [01:42<01:17,  1.71s/it]Best trial: 54. Best value: 0.11475:  56%|█████▌    | 56/100 [01:42<01:14,  1.70s/it]Best trial: 54. Best value: 0.11475:  56%|█████▌    | 56/100 [01:44<01:14,  1.70s/it]Best trial: 54. Best value: 0.11475:  57%|█████▋    | 57/100 [01:44<01:11,  1.67s/it]Best trial: 54. Best value: 0.11475:  57%|█████▋    | 57/100 [01:45<01:11,  1.67s/it]Best trial: 54. Best value: 0.11475:  58%|█████▊    | 58/100 [01:45<01:01,  1.46s/it]Best trial: 54. Best value: 0.11475:  58%|█████▊    | 58/100 [01:46<01:01,  1.46s/it]Best trial: 54. Best value: 0.11475:  59%|█████▉    | 59/100 [01:46<00:54,  1.32s/it]Best trial: 54. Best value: 0.11475:  59%|█████▉    | 59/100 [01:48<00:54,  1.32s/it]Best trial: 54. Best value: 0.11475:  60%|██████    | 60/100 [01:48<01:01,  1.53s/it]Best trial: 54. Best value: 0.11475:  60%|██████    | 60/100 [01:49<01:01,  1.53s/it]Best trial: 54. Best value: 0.11475:  61%|██████    | 61/100 [01:49<00:52,  1.35s/it]Best trial: 54. Best value: 0.11475:  61%|██████    | 61/100 [01:50<00:52,  1.35s/it]Best trial: 54. Best value: 0.11475:  62%|██████▏   | 62/100 [01:50<00:47,  1.24s/it]Best trial: 54. Best value: 0.11475:  62%|██████▏   | 62/100 [01:51<00:47,  1.24s/it]Best trial: 54. Best value: 0.11475:  63%|██████▎   | 63/100 [01:51<00:42,  1.15s/it]Best trial: 54. Best value: 0.11475:  63%|██████▎   | 63/100 [01:51<00:42,  1.15s/it]Best trial: 54. Best value: 0.11475:  64%|██████▍   | 64/100 [01:51<00:39,  1.09s/it]Best trial: 54. Best value: 0.11475:  64%|██████▍   | 64/100 [01:53<00:39,  1.09s/it]Best trial: 54. Best value: 0.11475:  65%|██████▌   | 65/100 [01:53<00:38,  1.11s/it]Best trial: 54. Best value: 0.11475:  65%|██████▌   | 65/100 [01:54<00:38,  1.11s/it]Best trial: 54. Best value: 0.11475:  66%|██████▌   | 66/100 [01:54<00:35,  1.05s/it]Best trial: 54. Best value: 0.11475:  66%|██████▌   | 66/100 [01:55<00:35,  1.05s/it]Best trial: 54. Best value: 0.11475:  67%|██████▋   | 67/100 [01:55<00:39,  1.19s/it]Best trial: 54. Best value: 0.11475:  67%|██████▋   | 67/100 [01:58<00:39,  1.19s/it]Best trial: 54. Best value: 0.11475:  68%|██████▊   | 68/100 [01:58<00:52,  1.65s/it]Best trial: 54. Best value: 0.11475:  68%|██████▊   | 68/100 [01:59<00:52,  1.65s/it]Best trial: 54. Best value: 0.11475:  69%|██████▉   | 69/100 [01:59<00:45,  1.47s/it]Best trial: 54. Best value: 0.11475:  69%|██████▉   | 69/100 [02:00<00:45,  1.47s/it]Best trial: 54. Best value: 0.11475:  70%|███████   | 70/100 [02:00<00:42,  1.41s/it]Best trial: 54. Best value: 0.11475:  70%|███████   | 70/100 [02:02<00:42,  1.41s/it]Best trial: 54. Best value: 0.11475:  71%|███████   | 71/100 [02:02<00:45,  1.58s/it]Best trial: 54. Best value: 0.11475:  71%|███████   | 71/100 [02:03<00:45,  1.58s/it]Best trial: 54. Best value: 0.11475:  72%|███████▏  | 72/100 [02:03<00:38,  1.36s/it]Best trial: 54. Best value: 0.11475:  72%|███████▏  | 72/100 [02:05<00:38,  1.36s/it]Best trial: 54. Best value: 0.11475:  73%|███████▎  | 73/100 [02:05<00:39,  1.46s/it]Best trial: 54. Best value: 0.11475:  73%|███████▎  | 73/100 [02:06<00:39,  1.46s/it]Best trial: 54. Best value: 0.11475:  74%|███████▍  | 74/100 [02:06<00:34,  1.32s/it]Best trial: 74. Best value: 0.114973:  74%|███████▍  | 74/100 [02:07<00:34,  1.32s/it]Best trial: 74. Best value: 0.114973:  75%|███████▌  | 75/100 [02:07<00:34,  1.39s/it]Best trial: 74. Best value: 0.114973:  75%|███████▌  | 75/100 [02:09<00:34,  1.39s/it]Best trial: 74. Best value: 0.114973:  76%|███████▌  | 76/100 [02:09<00:35,  1.47s/it]Best trial: 74. Best value: 0.114973:  76%|███████▌  | 76/100 [02:10<00:35,  1.47s/it]Best trial: 74. Best value: 0.114973:  77%|███████▋  | 77/100 [02:10<00:30,  1.33s/it]Best trial: 77. Best value: 0.137255:  77%|███████▋  | 77/100 [02:12<00:30,  1.33s/it]Best trial: 77. Best value: 0.137255:  78%|███████▊  | 78/100 [02:12<00:32,  1.49s/it]Best trial: 77. Best value: 0.137255:  78%|███████▊  | 78/100 [02:13<00:32,  1.49s/it]Best trial: 77. Best value: 0.137255:  79%|███████▉  | 79/100 [02:13<00:31,  1.48s/it]Best trial: 77. Best value: 0.137255:  79%|███████▉  | 79/100 [02:15<00:31,  1.48s/it]Best trial: 77. Best value: 0.137255:  80%|████████  | 80/100 [02:15<00:32,  1.61s/it]Best trial: 77. Best value: 0.137255:  80%|████████  | 80/100 [02:17<00:32,  1.61s/it]Best trial: 77. Best value: 0.137255:  81%|████████  | 81/100 [02:17<00:32,  1.70s/it]Best trial: 77. Best value: 0.137255:  81%|████████  | 81/100 [02:18<00:32,  1.70s/it]Best trial: 77. Best value: 0.137255:  82%|████████▏ | 82/100 [02:18<00:26,  1.48s/it]Best trial: 77. Best value: 0.137255:  82%|████████▏ | 82/100 [02:19<00:26,  1.48s/it]Best trial: 77. Best value: 0.137255:  83%|████████▎ | 83/100 [02:19<00:24,  1.44s/it]Best trial: 77. Best value: 0.137255:  83%|████████▎ | 83/100 [02:21<00:24,  1.44s/it]Best trial: 77. Best value: 0.137255:  84%|████████▍ | 84/100 [02:21<00:23,  1.44s/it]Best trial: 77. Best value: 0.137255:  84%|████████▍ | 84/100 [02:23<00:23,  1.44s/it]Best trial: 77. Best value: 0.137255:  85%|████████▌ | 85/100 [02:23<00:23,  1.55s/it]Best trial: 77. Best value: 0.137255:  85%|████████▌ | 85/100 [02:24<00:23,  1.55s/it]Best trial: 77. Best value: 0.137255:  86%|████████▌ | 86/100 [02:24<00:21,  1.55s/it]Best trial: 77. Best value: 0.137255:  86%|████████▌ | 86/100 [02:26<00:21,  1.55s/it]Best trial: 77. Best value: 0.137255:  87%|████████▋ | 87/100 [02:26<00:22,  1.69s/it]Best trial: 77. Best value: 0.137255:  87%|████████▋ | 87/100 [02:30<00:22,  1.69s/it]Best trial: 77. Best value: 0.137255:  88%|████████▊ | 88/100 [02:30<00:28,  2.36s/it]Best trial: 77. Best value: 0.137255:  88%|████████▊ | 88/100 [02:31<00:28,  2.36s/it]Best trial: 77. Best value: 0.137255:  89%|████████▉ | 89/100 [02:31<00:21,  1.92s/it]Best trial: 77. Best value: 0.137255:  89%|████████▉ | 89/100 [02:33<00:21,  1.92s/it]Best trial: 77. Best value: 0.137255:  90%|█████████ | 90/100 [02:33<00:20,  2.05s/it]Best trial: 77. Best value: 0.137255:  90%|█████████ | 90/100 [02:34<00:20,  2.05s/it]Best trial: 77. Best value: 0.137255:  91%|█████████ | 91/100 [02:34<00:15,  1.73s/it]Best trial: 77. Best value: 0.137255:  91%|█████████ | 91/100 [02:37<00:15,  1.73s/it]Best trial: 77. Best value: 0.137255:  92%|█████████▏| 92/100 [02:37<00:15,  1.94s/it]Best trial: 77. Best value: 0.137255:  92%|█████████▏| 92/100 [02:38<00:15,  1.94s/it]Best trial: 77. Best value: 0.137255:  93%|█████████▎| 93/100 [02:38<00:13,  1.86s/it]Best trial: 77. Best value: 0.137255:  93%|█████████▎| 93/100 [02:39<00:13,  1.86s/it]Best trial: 77. Best value: 0.137255:  94%|█████████▍| 94/100 [02:39<00:09,  1.58s/it]Best trial: 77. Best value: 0.137255:  94%|█████████▍| 94/100 [02:41<00:09,  1.58s/it]Best trial: 77. Best value: 0.137255:  95%|█████████▌| 95/100 [02:41<00:07,  1.54s/it]Best trial: 77. Best value: 0.137255:  95%|█████████▌| 95/100 [02:42<00:07,  1.54s/it]Best trial: 77. Best value: 0.137255:  96%|█████████▌| 96/100 [02:42<00:06,  1.60s/it]Best trial: 77. Best value: 0.137255:  96%|█████████▌| 96/100 [02:44<00:06,  1.60s/it]Best trial: 77. Best value: 0.137255:  97%|█████████▋| 97/100 [02:44<00:04,  1.58s/it]Best trial: 77. Best value: 0.137255:  97%|█████████▋| 97/100 [02:47<00:04,  1.58s/it]Best trial: 77. Best value: 0.137255:  98%|█████████▊| 98/100 [02:47<00:03,  1.93s/it]Best trial: 77. Best value: 0.137255:  98%|█████████▊| 98/100 [02:49<00:03,  1.93s/it]Best trial: 77. Best value: 0.137255:  99%|█████████▉| 99/100 [02:49<00:01,  1.95s/it]Best trial: 77. Best value: 0.137255:  99%|█████████▉| 99/100 [02:51<00:01,  1.95s/it]Best trial: 77. Best value: 0.137255: 100%|██████████| 100/100 [02:51<00:00,  1.89s/it]Best trial: 77. Best value: 0.137255: 100%|██████████| 100/100 [02:51<00:00,  1.71s/it]
2025-11-30 11:50:45,200 - INFO - HPO Complete. Best AUPRC: 0.1373
2025-11-30 11:50:45,201 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.07635073202017553, 'max_depth': 3, 'subsample': 0.8406100338025396, 'colsample_bytree': 0.9304937818195775, 'gamma': 2.8715161923173325, 'reg_lambda': 7.748224830370062e-07, 'reg_alpha': 0.01684905561735998}
2025-11-30 11:50:45,201 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:50:47,000 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 11:50:47,000 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:50:47,083 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:50:47,094 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:50:47,096 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 11:50:47,097 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:50:47,097 - INFO - Training model...
2025-11-30 11:50:47,902 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:50:52,752 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:50:52,753 - INFO - AUROC: 0.6031 (0.3944 - 0.7893)
2025-11-30 11:50:52,753 - INFO - AUPRC: 0.0507 (0.0140 - 0.1549)
2025-11-30 11:50:52,753 - INFO - Brier Score: 0.0153 (0.0097 - 0.0265)
2025-11-30 11:50:52,753 - INFO - Accuracy: 0.9639 (0.8829 - 0.9827)
2025-11-30 11:50:52,753 - INFO - Precision: 0.1053 (0.0171 - 0.3850)
2025-11-30 11:50:52,753 - INFO - Sensitivity (Recall): 0.2000 (0.0462 - 0.5619)
2025-11-30 11:50:52,753 - INFO - F1-Score: 0.1379 (0.0273 - 0.3208)
2025-11-30 11:50:52,753 - INFO - Best Threshold: 0.1300 (0.0520 - 0.2600)
2025-11-30 11:50:52,753 - INFO - Specificity: 0.9751 (0.8923 - 0.9947)
2025-11-30 11:50:52,762 - INFO - Calculating SHAP values...
2025-11-30 11:50:53,814 - INFO - SHAP plots saved.
2025-11-30 11:50:53,815 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:50:54,965 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 11:50:54,966 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:50:55,067 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:50:55,081 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:50:55,084 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 11:50:55,084 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0436197:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0436197:   1%|          | 1/100 [00:01<02:38,  1.60s/it]Best trial: 0. Best value: 0.0436197:   1%|          | 1/100 [00:02<02:38,  1.60s/it]Best trial: 0. Best value: 0.0436197:   2%|▏         | 2/100 [00:02<02:23,  1.47s/it]Best trial: 2. Best value: 0.0526498:   2%|▏         | 2/100 [00:04<02:23,  1.47s/it]Best trial: 2. Best value: 0.0526498:   3%|▎         | 3/100 [00:04<02:11,  1.35s/it]Best trial: 3. Best value: 0.063821:   3%|▎         | 3/100 [00:05<02:11,  1.35s/it] Best trial: 3. Best value: 0.063821:   4%|▍         | 4/100 [00:05<02:06,  1.32s/it]Best trial: 4. Best value: 0.0660378:   4%|▍         | 4/100 [00:07<02:06,  1.32s/it]Best trial: 4. Best value: 0.0660378:   5%|▌         | 5/100 [00:07<02:22,  1.50s/it]Best trial: 4. Best value: 0.0660378:   5%|▌         | 5/100 [00:08<02:22,  1.50s/it]Best trial: 4. Best value: 0.0660378:   6%|▌         | 6/100 [00:08<02:12,  1.41s/it]Best trial: 6. Best value: 0.0700384:   6%|▌         | 6/100 [00:10<02:12,  1.41s/it]Best trial: 6. Best value: 0.0700384:   7%|▋         | 7/100 [00:10<02:30,  1.62s/it]Best trial: 6. Best value: 0.0700384:   7%|▋         | 7/100 [00:13<02:30,  1.62s/it]Best trial: 6. Best value: 0.0700384:   8%|▊         | 8/100 [00:13<03:01,  1.97s/it]Best trial: 6. Best value: 0.0700384:   8%|▊         | 8/100 [00:14<03:01,  1.97s/it]Best trial: 6. Best value: 0.0700384:   9%|▉         | 9/100 [00:14<02:36,  1.72s/it]Best trial: 6. Best value: 0.0700384:   9%|▉         | 9/100 [00:17<02:36,  1.72s/it]Best trial: 6. Best value: 0.0700384:  10%|█         | 10/100 [00:17<03:03,  2.04s/it]Best trial: 10. Best value: 0.0938867:  10%|█         | 10/100 [00:20<03:03,  2.04s/it]Best trial: 10. Best value: 0.0938867:  11%|█         | 11/100 [00:20<03:31,  2.38s/it]Best trial: 11. Best value: 0.123267:  11%|█         | 11/100 [00:22<03:31,  2.38s/it] Best trial: 11. Best value: 0.123267:  12%|█▏        | 12/100 [00:22<03:31,  2.40s/it]Best trial: 11. Best value: 0.123267:  12%|█▏        | 12/100 [00:25<03:31,  2.40s/it]Best trial: 11. Best value: 0.123267:  13%|█▎        | 13/100 [00:25<03:29,  2.40s/it]Best trial: 13. Best value: 0.136831:  13%|█▎        | 13/100 [00:27<03:29,  2.40s/it]Best trial: 13. Best value: 0.136831:  14%|█▍        | 14/100 [00:27<03:23,  2.37s/it]Best trial: 13. Best value: 0.136831:  14%|█▍        | 14/100 [00:29<03:23,  2.37s/it]Best trial: 13. Best value: 0.136831:  15%|█▌        | 15/100 [00:29<03:13,  2.27s/it]Best trial: 13. Best value: 0.136831:  15%|█▌        | 15/100 [00:31<03:13,  2.27s/it]Best trial: 13. Best value: 0.136831:  16%|█▌        | 16/100 [00:31<03:10,  2.26s/it]Best trial: 13. Best value: 0.136831:  16%|█▌        | 16/100 [00:33<03:10,  2.26s/it]Best trial: 13. Best value: 0.136831:  17%|█▋        | 17/100 [00:33<03:03,  2.21s/it]Best trial: 13. Best value: 0.136831:  17%|█▋        | 17/100 [00:36<03:03,  2.21s/it]Best trial: 13. Best value: 0.136831:  18%|█▊        | 18/100 [00:36<02:59,  2.20s/it]Best trial: 13. Best value: 0.136831:  18%|█▊        | 18/100 [00:38<02:59,  2.20s/it]Best trial: 13. Best value: 0.136831:  19%|█▉        | 19/100 [00:38<02:59,  2.21s/it]Best trial: 13. Best value: 0.136831:  19%|█▉        | 19/100 [00:40<02:59,  2.21s/it]Best trial: 13. Best value: 0.136831:  20%|██        | 20/100 [00:40<03:02,  2.28s/it]Best trial: 13. Best value: 0.136831:  20%|██        | 20/100 [00:43<03:02,  2.28s/it]Best trial: 13. Best value: 0.136831:  21%|██        | 21/100 [00:43<03:03,  2.33s/it]Best trial: 21. Best value: 0.155768:  21%|██        | 21/100 [00:45<03:03,  2.33s/it]Best trial: 21. Best value: 0.155768:  22%|██▏       | 22/100 [00:45<03:02,  2.34s/it]Best trial: 21. Best value: 0.155768:  22%|██▏       | 22/100 [00:48<03:02,  2.34s/it]Best trial: 21. Best value: 0.155768:  23%|██▎       | 23/100 [00:48<03:03,  2.39s/it]Best trial: 21. Best value: 0.155768:  23%|██▎       | 23/100 [00:50<03:03,  2.39s/it]Best trial: 21. Best value: 0.155768:  24%|██▍       | 24/100 [00:50<03:01,  2.39s/it]Best trial: 24. Best value: 0.199967:  24%|██▍       | 24/100 [00:52<03:01,  2.39s/it]Best trial: 24. Best value: 0.199967:  25%|██▌       | 25/100 [00:52<02:50,  2.27s/it]Best trial: 24. Best value: 0.199967:  25%|██▌       | 25/100 [00:54<02:50,  2.27s/it]Best trial: 24. Best value: 0.199967:  26%|██▌       | 26/100 [00:54<02:41,  2.19s/it]Best trial: 24. Best value: 0.199967:  26%|██▌       | 26/100 [00:57<02:41,  2.19s/it]Best trial: 24. Best value: 0.199967:  27%|██▋       | 27/100 [00:57<02:48,  2.31s/it]Best trial: 24. Best value: 0.199967:  27%|██▋       | 27/100 [00:59<02:48,  2.31s/it]Best trial: 24. Best value: 0.199967:  28%|██▊       | 28/100 [00:59<02:42,  2.25s/it]Best trial: 24. Best value: 0.199967:  28%|██▊       | 28/100 [01:01<02:42,  2.25s/it]Best trial: 24. Best value: 0.199967:  29%|██▉       | 29/100 [01:01<02:40,  2.26s/it]Best trial: 24. Best value: 0.199967:  29%|██▉       | 29/100 [01:04<02:40,  2.26s/it]Best trial: 24. Best value: 0.199967:  30%|███       | 30/100 [01:04<02:52,  2.47s/it]Best trial: 24. Best value: 0.199967:  30%|███       | 30/100 [01:07<02:52,  2.47s/it]Best trial: 24. Best value: 0.199967:  31%|███       | 31/100 [01:07<02:58,  2.59s/it]Best trial: 24. Best value: 0.199967:  31%|███       | 31/100 [01:09<02:58,  2.59s/it]Best trial: 24. Best value: 0.199967:  32%|███▏      | 32/100 [01:09<02:51,  2.52s/it]Best trial: 24. Best value: 0.199967:  32%|███▏      | 32/100 [01:11<02:51,  2.52s/it]Best trial: 24. Best value: 0.199967:  33%|███▎      | 33/100 [01:11<02:46,  2.48s/it]Best trial: 24. Best value: 0.199967:  33%|███▎      | 33/100 [01:13<02:46,  2.48s/it]Best trial: 24. Best value: 0.199967:  34%|███▍      | 34/100 [01:13<02:33,  2.33s/it]Best trial: 24. Best value: 0.199967:  34%|███▍      | 34/100 [01:16<02:33,  2.33s/it]Best trial: 24. Best value: 0.199967:  35%|███▌      | 35/100 [01:16<02:38,  2.44s/it]Best trial: 24. Best value: 0.199967:  35%|███▌      | 35/100 [01:19<02:38,  2.44s/it]Best trial: 24. Best value: 0.199967:  36%|███▌      | 36/100 [01:19<02:41,  2.53s/it]Best trial: 24. Best value: 0.199967:  36%|███▌      | 36/100 [01:20<02:41,  2.53s/it]Best trial: 24. Best value: 0.199967:  37%|███▋      | 37/100 [01:20<02:15,  2.15s/it]Best trial: 24. Best value: 0.199967:  37%|███▋      | 37/100 [01:23<02:15,  2.15s/it]Best trial: 24. Best value: 0.199967:  38%|███▊      | 38/100 [01:23<02:25,  2.35s/it]Best trial: 24. Best value: 0.199967:  38%|███▊      | 38/100 [01:25<02:25,  2.35s/it]Best trial: 24. Best value: 0.199967:  39%|███▉      | 39/100 [01:25<02:12,  2.17s/it]Best trial: 24. Best value: 0.199967:  39%|███▉      | 39/100 [01:27<02:12,  2.17s/it]Best trial: 24. Best value: 0.199967:  40%|████      | 40/100 [01:27<02:05,  2.09s/it]Best trial: 24. Best value: 0.199967:  40%|████      | 40/100 [01:29<02:05,  2.09s/it]Best trial: 24. Best value: 0.199967:  41%|████      | 41/100 [01:29<02:11,  2.22s/it]Best trial: 24. Best value: 0.199967:  41%|████      | 41/100 [01:32<02:11,  2.22s/it]Best trial: 24. Best value: 0.199967:  42%|████▏     | 42/100 [01:32<02:13,  2.31s/it]Best trial: 24. Best value: 0.199967:  42%|████▏     | 42/100 [01:34<02:13,  2.31s/it]Best trial: 24. Best value: 0.199967:  43%|████▎     | 43/100 [01:34<02:06,  2.23s/it]Best trial: 24. Best value: 0.199967:  43%|████▎     | 43/100 [01:36<02:06,  2.23s/it]Best trial: 24. Best value: 0.199967:  44%|████▍     | 44/100 [01:36<02:00,  2.15s/it]Best trial: 24. Best value: 0.199967:  44%|████▍     | 44/100 [01:38<02:00,  2.15s/it]Best trial: 24. Best value: 0.199967:  45%|████▌     | 45/100 [01:38<01:54,  2.09s/it]Best trial: 24. Best value: 0.199967:  45%|████▌     | 45/100 [01:40<01:54,  2.09s/it]Best trial: 24. Best value: 0.199967:  46%|████▌     | 46/100 [01:40<02:04,  2.31s/it]Best trial: 24. Best value: 0.199967:  46%|████▌     | 46/100 [01:43<02:04,  2.31s/it]Best trial: 24. Best value: 0.199967:  47%|████▋     | 47/100 [01:43<01:58,  2.24s/it]Best trial: 24. Best value: 0.199967:  47%|████▋     | 47/100 [01:45<01:58,  2.24s/it]Best trial: 24. Best value: 0.199967:  48%|████▊     | 48/100 [01:45<01:53,  2.19s/it]Best trial: 24. Best value: 0.199967:  48%|████▊     | 48/100 [01:46<01:53,  2.19s/it]Best trial: 24. Best value: 0.199967:  49%|████▉     | 49/100 [01:46<01:42,  2.01s/it]Best trial: 24. Best value: 0.199967:  49%|████▉     | 49/100 [01:49<01:42,  2.01s/it]Best trial: 24. Best value: 0.199967:  50%|█████     | 50/100 [01:49<01:47,  2.16s/it]Best trial: 24. Best value: 0.199967:  50%|█████     | 50/100 [01:51<01:47,  2.16s/it]Best trial: 24. Best value: 0.199967:  51%|█████     | 51/100 [01:51<01:48,  2.21s/it]Best trial: 24. Best value: 0.199967:  51%|█████     | 51/100 [01:53<01:48,  2.21s/it]Best trial: 24. Best value: 0.199967:  52%|█████▏    | 52/100 [01:53<01:42,  2.14s/it]Best trial: 24. Best value: 0.199967:  52%|█████▏    | 52/100 [01:54<01:42,  2.14s/it]Best trial: 24. Best value: 0.199967:  53%|█████▎    | 53/100 [01:54<01:31,  1.94s/it]Best trial: 24. Best value: 0.199967:  53%|█████▎    | 53/100 [01:57<01:31,  1.94s/it]Best trial: 24. Best value: 0.199967:  54%|█████▍    | 54/100 [01:57<01:33,  2.03s/it]Best trial: 24. Best value: 0.199967:  54%|█████▍    | 54/100 [01:59<01:33,  2.03s/it]Best trial: 24. Best value: 0.199967:  55%|█████▌    | 55/100 [01:59<01:37,  2.17s/it]Best trial: 24. Best value: 0.199967:  55%|█████▌    | 55/100 [02:02<01:37,  2.17s/it]Best trial: 24. Best value: 0.199967:  56%|█████▌    | 56/100 [02:02<01:43,  2.35s/it]Best trial: 24. Best value: 0.199967:  56%|█████▌    | 56/100 [02:05<01:43,  2.35s/it]Best trial: 24. Best value: 0.199967:  57%|█████▋    | 57/100 [02:05<01:47,  2.50s/it]Best trial: 24. Best value: 0.199967:  57%|█████▋    | 57/100 [02:07<01:47,  2.50s/it]Best trial: 24. Best value: 0.199967:  58%|█████▊    | 58/100 [02:07<01:46,  2.54s/it]Best trial: 24. Best value: 0.199967:  58%|█████▊    | 58/100 [02:10<01:46,  2.54s/it]Best trial: 24. Best value: 0.199967:  59%|█████▉    | 59/100 [02:10<01:39,  2.43s/it]Best trial: 24. Best value: 0.199967:  59%|█████▉    | 59/100 [02:11<01:39,  2.43s/it]Best trial: 24. Best value: 0.199967:  60%|██████    | 60/100 [02:11<01:26,  2.17s/it]Best trial: 24. Best value: 0.199967:  60%|██████    | 60/100 [02:13<01:26,  2.17s/it]Best trial: 24. Best value: 0.199967:  61%|██████    | 61/100 [02:13<01:22,  2.12s/it]Best trial: 24. Best value: 0.199967:  61%|██████    | 61/100 [02:15<01:22,  2.12s/it]Best trial: 24. Best value: 0.199967:  62%|██████▏   | 62/100 [02:15<01:15,  1.99s/it]Best trial: 24. Best value: 0.199967:  62%|██████▏   | 62/100 [02:17<01:15,  1.99s/it]Best trial: 24. Best value: 0.199967:  63%|██████▎   | 63/100 [02:17<01:14,  2.02s/it]Best trial: 24. Best value: 0.199967:  63%|██████▎   | 63/100 [02:19<01:14,  2.02s/it]Best trial: 24. Best value: 0.199967:  64%|██████▍   | 64/100 [02:19<01:11,  1.98s/it]Best trial: 24. Best value: 0.199967:  64%|██████▍   | 64/100 [02:21<01:11,  1.98s/it]Best trial: 24. Best value: 0.199967:  65%|██████▌   | 65/100 [02:21<01:10,  2.00s/it]Best trial: 24. Best value: 0.199967:  65%|██████▌   | 65/100 [02:23<01:10,  2.00s/it]Best trial: 24. Best value: 0.199967:  66%|██████▌   | 66/100 [02:23<01:04,  1.89s/it]Best trial: 24. Best value: 0.199967:  66%|██████▌   | 66/100 [02:24<01:04,  1.89s/it]Best trial: 24. Best value: 0.199967:  67%|██████▋   | 67/100 [02:24<01:01,  1.85s/it]Best trial: 24. Best value: 0.199967:  67%|██████▋   | 67/100 [02:26<01:01,  1.85s/it]Best trial: 24. Best value: 0.199967:  68%|██████▊   | 68/100 [02:26<00:56,  1.76s/it]Best trial: 24. Best value: 0.199967:  68%|██████▊   | 68/100 [02:28<00:56,  1.76s/it]Best trial: 24. Best value: 0.199967:  69%|██████▉   | 69/100 [02:28<00:54,  1.75s/it]Best trial: 24. Best value: 0.199967:  69%|██████▉   | 69/100 [02:29<00:54,  1.75s/it]Best trial: 24. Best value: 0.199967:  70%|███████   | 70/100 [02:29<00:46,  1.55s/it]Best trial: 24. Best value: 0.199967:  70%|███████   | 70/100 [02:30<00:46,  1.55s/it]Best trial: 24. Best value: 0.199967:  71%|███████   | 71/100 [02:30<00:46,  1.61s/it]Best trial: 24. Best value: 0.199967:  71%|███████   | 71/100 [02:32<00:46,  1.61s/it]Best trial: 24. Best value: 0.199967:  72%|███████▏  | 72/100 [02:32<00:47,  1.70s/it]Best trial: 24. Best value: 0.199967:  72%|███████▏  | 72/100 [02:34<00:47,  1.70s/it]Best trial: 24. Best value: 0.199967:  73%|███████▎  | 73/100 [02:34<00:48,  1.79s/it]Best trial: 24. Best value: 0.199967:  73%|███████▎  | 73/100 [02:36<00:48,  1.79s/it]Best trial: 24. Best value: 0.199967:  74%|███████▍  | 74/100 [02:36<00:47,  1.83s/it]Best trial: 24. Best value: 0.199967:  74%|███████▍  | 74/100 [02:38<00:47,  1.83s/it]Best trial: 24. Best value: 0.199967:  75%|███████▌  | 75/100 [02:38<00:48,  1.92s/it]Best trial: 75. Best value: 0.203672:  75%|███████▌  | 75/100 [02:40<00:48,  1.92s/it]Best trial: 75. Best value: 0.203672:  76%|███████▌  | 76/100 [02:40<00:45,  1.91s/it]Best trial: 75. Best value: 0.203672:  76%|███████▌  | 76/100 [02:42<00:45,  1.91s/it]Best trial: 75. Best value: 0.203672:  77%|███████▋  | 77/100 [02:42<00:43,  1.90s/it]Best trial: 75. Best value: 0.203672:  77%|███████▋  | 77/100 [02:44<00:43,  1.90s/it]Best trial: 75. Best value: 0.203672:  78%|███████▊  | 78/100 [02:44<00:42,  1.94s/it]Best trial: 75. Best value: 0.203672:  78%|███████▊  | 78/100 [02:46<00:42,  1.94s/it]Best trial: 75. Best value: 0.203672:  79%|███████▉  | 79/100 [02:46<00:39,  1.89s/it]Best trial: 75. Best value: 0.203672:  79%|███████▉  | 79/100 [02:48<00:39,  1.89s/it]Best trial: 75. Best value: 0.203672:  80%|████████  | 80/100 [02:48<00:36,  1.83s/it]Best trial: 75. Best value: 0.203672:  80%|████████  | 80/100 [02:50<00:36,  1.83s/it]Best trial: 75. Best value: 0.203672:  81%|████████  | 81/100 [02:50<00:36,  1.91s/it]Best trial: 75. Best value: 0.203672:  81%|████████  | 81/100 [02:52<00:36,  1.91s/it]Best trial: 75. Best value: 0.203672:  82%|████████▏ | 82/100 [02:52<00:33,  1.88s/it]Best trial: 75. Best value: 0.203672:  82%|████████▏ | 82/100 [02:54<00:33,  1.88s/it]Best trial: 75. Best value: 0.203672:  83%|████████▎ | 83/100 [02:54<00:33,  1.99s/it]Best trial: 75. Best value: 0.203672:  83%|████████▎ | 83/100 [02:56<00:33,  1.99s/it]Best trial: 75. Best value: 0.203672:  84%|████████▍ | 84/100 [02:56<00:33,  2.07s/it]Best trial: 75. Best value: 0.203672:  84%|████████▍ | 84/100 [02:58<00:33,  2.07s/it]Best trial: 75. Best value: 0.203672:  85%|████████▌ | 85/100 [02:58<00:29,  1.95s/it]Best trial: 75. Best value: 0.203672:  85%|████████▌ | 85/100 [03:00<00:29,  1.95s/it]Best trial: 75. Best value: 0.203672:  86%|████████▌ | 86/100 [03:00<00:28,  2.00s/it]Best trial: 75. Best value: 0.203672:  86%|████████▌ | 86/100 [03:01<00:28,  2.00s/it]Best trial: 75. Best value: 0.203672:  87%|████████▋ | 87/100 [03:01<00:24,  1.86s/it]Best trial: 75. Best value: 0.203672:  87%|████████▋ | 87/100 [03:04<00:24,  1.86s/it]Best trial: 75. Best value: 0.203672:  88%|████████▊ | 88/100 [03:04<00:23,  1.99s/it]Best trial: 75. Best value: 0.203672:  88%|████████▊ | 88/100 [03:06<00:23,  1.99s/it]Best trial: 75. Best value: 0.203672:  89%|████████▉ | 89/100 [03:06<00:21,  1.99s/it]Best trial: 75. Best value: 0.203672:  89%|████████▉ | 89/100 [03:08<00:21,  1.99s/it]Best trial: 75. Best value: 0.203672:  90%|█████████ | 90/100 [03:08<00:20,  2.05s/it]Best trial: 75. Best value: 0.203672:  90%|█████████ | 90/100 [03:09<00:20,  2.05s/it]Best trial: 75. Best value: 0.203672:  91%|█████████ | 91/100 [03:09<00:16,  1.86s/it]Best trial: 75. Best value: 0.203672:  91%|█████████ | 91/100 [03:11<00:16,  1.86s/it]Best trial: 75. Best value: 0.203672:  92%|█████████▏| 92/100 [03:11<00:14,  1.81s/it]Best trial: 75. Best value: 0.203672:  92%|█████████▏| 92/100 [03:13<00:14,  1.81s/it]Best trial: 75. Best value: 0.203672:  93%|█████████▎| 93/100 [03:13<00:13,  1.88s/it]Best trial: 75. Best value: 0.203672:  93%|█████████▎| 93/100 [03:15<00:13,  1.88s/it]Best trial: 75. Best value: 0.203672:  94%|█████████▍| 94/100 [03:15<00:11,  1.85s/it]Best trial: 75. Best value: 0.203672:  94%|█████████▍| 94/100 [03:17<00:11,  1.85s/it]Best trial: 75. Best value: 0.203672:  95%|█████████▌| 95/100 [03:17<00:09,  1.85s/it]Best trial: 75. Best value: 0.203672:  95%|█████████▌| 95/100 [03:18<00:09,  1.85s/it]Best trial: 75. Best value: 0.203672:  96%|█████████▌| 96/100 [03:18<00:07,  1.84s/it]Best trial: 75. Best value: 0.203672:  96%|█████████▌| 96/100 [03:21<00:07,  1.84s/it]Best trial: 75. Best value: 0.203672:  97%|█████████▋| 97/100 [03:21<00:06,  2.00s/it]Best trial: 75. Best value: 0.203672:  97%|█████████▋| 97/100 [03:23<00:06,  2.00s/it]Best trial: 75. Best value: 0.203672:  98%|█████████▊| 98/100 [03:23<00:03,  1.95s/it]Best trial: 75. Best value: 0.203672:  98%|█████████▊| 98/100 [03:25<00:03,  1.95s/it]Best trial: 75. Best value: 0.203672:  99%|█████████▉| 99/100 [03:25<00:01,  1.91s/it]Best trial: 75. Best value: 0.203672:  99%|█████████▉| 99/100 [03:26<00:01,  1.91s/it]Best trial: 75. Best value: 0.203672: 100%|██████████| 100/100 [03:26<00:00,  1.84s/it]Best trial: 75. Best value: 0.203672: 100%|██████████| 100/100 [03:26<00:00,  2.07s/it]
2025-11-30 11:54:21,762 - INFO - HPO Complete. Best AUPRC: 0.2037
2025-11-30 11:54:21,762 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.0036917190207518234, 'max_depth': 10, 'subsample': 0.7807370900020472, 'colsample_bytree': 0.6000026301044692, 'gamma': 0.32270863339294525, 'reg_lambda': 0.04621514418220176, 'reg_alpha': 3.54634595320294e-08}
2025-11-30 11:54:21,763 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:54:23,611 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 11:54:23,611 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:54:23,695 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:54:23,706 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:54:23,709 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 11:54:23,709 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:54:23,709 - INFO - Training model...
2025-11-30 11:54:26,133 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:54:30,971 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:54:30,971 - INFO - AUROC: 0.6760 (0.5416 - 0.7530)
2025-11-30 11:54:30,971 - INFO - AUPRC: 0.0250 (0.0158 - 0.0479)
2025-11-30 11:54:30,971 - INFO - Brier Score: 0.0173 (0.0121 - 0.0280)
2025-11-30 11:54:30,971 - INFO - Accuracy: 0.6792 (0.5777 - 0.9078)
2025-11-30 11:54:30,971 - INFO - Precision: 0.0310 (0.0166 - 0.0545)
2025-11-30 11:54:30,971 - INFO - Sensitivity (Recall): 0.7000 (0.1905 - 0.8429)
2025-11-30 11:54:30,971 - INFO - F1-Score: 0.0593 (0.0317 - 0.1005)
2025-11-30 11:54:30,971 - INFO - Best Threshold: 0.0500 (0.0460 - 0.0900)
2025-11-30 11:54:30,971 - INFO - Specificity: 0.6789 (0.5762 - 0.9155)
2025-11-30 11:54:31,006 - INFO - Calculating SHAP values...
2025-11-30 11:54:32,427 - INFO - SHAP plots saved.
2025-11-30 11:54:32,429 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:54:33,597 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 11:54:33,597 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:54:33,681 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:54:33,704 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:54:33,711 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 11:54:33,711 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.331059:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.331059:   1%|          | 1/100 [00:03<04:58,  3.02s/it]Best trial: 0. Best value: 0.331059:   1%|          | 1/100 [00:05<04:58,  3.02s/it]Best trial: 0. Best value: 0.331059:   2%|▏         | 2/100 [00:05<03:57,  2.43s/it]Best trial: 0. Best value: 0.331059:   2%|▏         | 2/100 [00:08<03:57,  2.43s/it]Best trial: 0. Best value: 0.331059:   3%|▎         | 3/100 [00:08<04:27,  2.76s/it]Best trial: 0. Best value: 0.331059:   3%|▎         | 3/100 [00:10<04:27,  2.76s/it]Best trial: 0. Best value: 0.331059:   4%|▍         | 4/100 [00:10<04:07,  2.58s/it]Best trial: 0. Best value: 0.331059:   4%|▍         | 4/100 [00:12<04:07,  2.58s/it]Best trial: 0. Best value: 0.331059:   5%|▌         | 5/100 [00:12<03:35,  2.27s/it]Best trial: 0. Best value: 0.331059:   5%|▌         | 5/100 [00:15<03:35,  2.27s/it]Best trial: 0. Best value: 0.331059:   6%|▌         | 6/100 [00:15<03:52,  2.47s/it]Best trial: 0. Best value: 0.331059:   6%|▌         | 6/100 [00:20<03:52,  2.47s/it]Best trial: 0. Best value: 0.331059:   7%|▋         | 7/100 [00:20<05:09,  3.32s/it]Best trial: 7. Best value: 0.352113:   7%|▋         | 7/100 [00:21<05:09,  3.32s/it]Best trial: 7. Best value: 0.352113:   8%|▊         | 8/100 [00:21<04:17,  2.80s/it]Best trial: 7. Best value: 0.352113:   8%|▊         | 8/100 [00:24<04:17,  2.80s/it]Best trial: 7. Best value: 0.352113:   9%|▉         | 9/100 [00:24<04:01,  2.65s/it]Best trial: 7. Best value: 0.352113:   9%|▉         | 9/100 [00:26<04:01,  2.65s/it]Best trial: 7. Best value: 0.352113:  10%|█         | 10/100 [00:26<03:48,  2.54s/it]Best trial: 10. Best value: 0.382712:  10%|█         | 10/100 [00:28<03:48,  2.54s/it]Best trial: 10. Best value: 0.382712:  11%|█         | 11/100 [00:28<03:19,  2.24s/it]Best trial: 11. Best value: 0.384524:  11%|█         | 11/100 [00:29<03:19,  2.24s/it]Best trial: 11. Best value: 0.384524:  12%|█▏        | 12/100 [00:29<03:03,  2.09s/it]Best trial: 11. Best value: 0.384524:  12%|█▏        | 12/100 [00:31<03:03,  2.09s/it]Best trial: 11. Best value: 0.384524:  13%|█▎        | 13/100 [00:31<02:42,  1.87s/it]Best trial: 11. Best value: 0.384524:  13%|█▎        | 13/100 [00:33<02:42,  1.87s/it]Best trial: 11. Best value: 0.384524:  14%|█▍        | 14/100 [00:33<02:50,  1.98s/it]Best trial: 14. Best value: 0.395842:  14%|█▍        | 14/100 [00:34<02:50,  1.98s/it]Best trial: 14. Best value: 0.395842:  15%|█▌        | 15/100 [00:34<02:38,  1.86s/it]Best trial: 14. Best value: 0.395842:  15%|█▌        | 15/100 [00:37<02:38,  1.86s/it]Best trial: 14. Best value: 0.395842:  16%|█▌        | 16/100 [00:37<02:49,  2.02s/it]Best trial: 14. Best value: 0.395842:  16%|█▌        | 16/100 [00:39<02:49,  2.02s/it]Best trial: 14. Best value: 0.395842:  17%|█▋        | 17/100 [00:39<02:57,  2.13s/it]Best trial: 14. Best value: 0.395842:  17%|█▋        | 17/100 [00:41<02:57,  2.13s/it]Best trial: 14. Best value: 0.395842:  18%|█▊        | 18/100 [00:41<02:42,  1.98s/it]Best trial: 14. Best value: 0.395842:  18%|█▊        | 18/100 [00:44<02:42,  1.98s/it]Best trial: 14. Best value: 0.395842:  19%|█▉        | 19/100 [00:44<02:57,  2.19s/it]Best trial: 14. Best value: 0.395842:  19%|█▉        | 19/100 [00:45<02:57,  2.19s/it]Best trial: 14. Best value: 0.395842:  20%|██        | 20/100 [00:45<02:44,  2.06s/it]Best trial: 14. Best value: 0.395842:  20%|██        | 20/100 [00:47<02:44,  2.06s/it]Best trial: 14. Best value: 0.395842:  21%|██        | 21/100 [00:47<02:43,  2.07s/it]Best trial: 14. Best value: 0.395842:  21%|██        | 21/100 [00:49<02:43,  2.07s/it]Best trial: 14. Best value: 0.395842:  22%|██▏       | 22/100 [00:49<02:27,  1.90s/it]Best trial: 14. Best value: 0.395842:  22%|██▏       | 22/100 [00:50<02:27,  1.90s/it]Best trial: 14. Best value: 0.395842:  23%|██▎       | 23/100 [00:50<02:17,  1.79s/it]Best trial: 14. Best value: 0.395842:  23%|██▎       | 23/100 [00:52<02:17,  1.79s/it]Best trial: 14. Best value: 0.395842:  24%|██▍       | 24/100 [00:52<02:08,  1.69s/it]Best trial: 14. Best value: 0.395842:  24%|██▍       | 24/100 [00:54<02:08,  1.69s/it]Best trial: 14. Best value: 0.395842:  25%|██▌       | 25/100 [00:54<02:10,  1.74s/it]Best trial: 14. Best value: 0.395842:  25%|██▌       | 25/100 [00:56<02:10,  1.74s/it]Best trial: 14. Best value: 0.395842:  26%|██▌       | 26/100 [00:56<02:11,  1.78s/it]Best trial: 14. Best value: 0.395842:  26%|██▌       | 26/100 [00:57<02:11,  1.78s/it]Best trial: 14. Best value: 0.395842:  27%|██▋       | 27/100 [00:57<02:09,  1.77s/it]Best trial: 14. Best value: 0.395842:  27%|██▋       | 27/100 [01:00<02:09,  1.77s/it]Best trial: 14. Best value: 0.395842:  28%|██▊       | 28/100 [01:00<02:26,  2.03s/it]Best trial: 14. Best value: 0.395842:  28%|██▊       | 28/100 [01:02<02:26,  2.03s/it]Best trial: 14. Best value: 0.395842:  29%|██▉       | 29/100 [01:02<02:24,  2.03s/it]Best trial: 14. Best value: 0.395842:  29%|██▉       | 29/100 [01:04<02:24,  2.03s/it]Best trial: 14. Best value: 0.395842:  30%|███       | 30/100 [01:04<02:19,  1.99s/it]Best trial: 14. Best value: 0.395842:  30%|███       | 30/100 [01:07<02:19,  1.99s/it]Best trial: 14. Best value: 0.395842:  31%|███       | 31/100 [01:07<02:32,  2.20s/it]Best trial: 14. Best value: 0.395842:  31%|███       | 31/100 [01:08<02:32,  2.20s/it]Best trial: 14. Best value: 0.395842:  32%|███▏      | 32/100 [01:08<02:17,  2.03s/it]Best trial: 14. Best value: 0.395842:  32%|███▏      | 32/100 [01:10<02:17,  2.03s/it]Best trial: 14. Best value: 0.395842:  33%|███▎      | 33/100 [01:10<02:00,  1.80s/it]Best trial: 14. Best value: 0.395842:  33%|███▎      | 33/100 [01:12<02:00,  1.80s/it]Best trial: 14. Best value: 0.395842:  34%|███▍      | 34/100 [01:12<02:03,  1.87s/it]Best trial: 14. Best value: 0.395842:  34%|███▍      | 34/100 [01:13<02:03,  1.87s/it]Best trial: 14. Best value: 0.395842:  35%|███▌      | 35/100 [01:13<01:58,  1.83s/it]Best trial: 14. Best value: 0.395842:  35%|███▌      | 35/100 [01:16<01:58,  1.83s/it]Best trial: 14. Best value: 0.395842:  36%|███▌      | 36/100 [01:16<02:17,  2.15s/it]Best trial: 14. Best value: 0.395842:  36%|███▌      | 36/100 [01:18<02:17,  2.15s/it]Best trial: 14. Best value: 0.395842:  37%|███▋      | 37/100 [01:18<02:09,  2.06s/it]Best trial: 14. Best value: 0.395842:  37%|███▋      | 37/100 [01:20<02:09,  2.06s/it]Best trial: 14. Best value: 0.395842:  38%|███▊      | 38/100 [01:20<02:05,  2.02s/it]Best trial: 14. Best value: 0.395842:  38%|███▊      | 38/100 [01:21<02:05,  2.02s/it]Best trial: 14. Best value: 0.395842:  39%|███▉      | 39/100 [01:21<01:53,  1.86s/it]Best trial: 14. Best value: 0.395842:  39%|███▉      | 39/100 [01:23<01:53,  1.86s/it]Best trial: 14. Best value: 0.395842:  40%|████      | 40/100 [01:23<01:50,  1.85s/it]Best trial: 14. Best value: 0.395842:  40%|████      | 40/100 [01:27<01:50,  1.85s/it]Best trial: 14. Best value: 0.395842:  41%|████      | 41/100 [01:27<02:18,  2.35s/it]Best trial: 14. Best value: 0.395842:  41%|████      | 41/100 [01:29<02:18,  2.35s/it]Best trial: 14. Best value: 0.395842:  42%|████▏     | 42/100 [01:29<02:16,  2.35s/it]Best trial: 14. Best value: 0.395842:  42%|████▏     | 42/100 [01:32<02:16,  2.35s/it]Best trial: 14. Best value: 0.395842:  43%|████▎     | 43/100 [01:32<02:29,  2.62s/it]Best trial: 14. Best value: 0.395842:  43%|████▎     | 43/100 [01:35<02:29,  2.62s/it]Best trial: 14. Best value: 0.395842:  44%|████▍     | 44/100 [01:35<02:22,  2.54s/it]Best trial: 14. Best value: 0.395842:  44%|████▍     | 44/100 [01:38<02:22,  2.54s/it]Best trial: 14. Best value: 0.395842:  45%|████▌     | 45/100 [01:38<02:26,  2.67s/it]Best trial: 14. Best value: 0.395842:  45%|████▌     | 45/100 [01:40<02:26,  2.67s/it]Best trial: 14. Best value: 0.395842:  46%|████▌     | 46/100 [01:40<02:21,  2.62s/it]Best trial: 14. Best value: 0.395842:  46%|████▌     | 46/100 [01:42<02:21,  2.62s/it]Best trial: 14. Best value: 0.395842:  47%|████▋     | 47/100 [01:42<02:02,  2.31s/it]Best trial: 14. Best value: 0.395842:  47%|████▋     | 47/100 [01:43<02:02,  2.31s/it]Best trial: 14. Best value: 0.395842:  48%|████▊     | 48/100 [01:43<01:50,  2.12s/it]Best trial: 14. Best value: 0.395842:  48%|████▊     | 48/100 [01:46<01:50,  2.12s/it]Best trial: 14. Best value: 0.395842:  49%|████▉     | 49/100 [01:46<01:49,  2.15s/it]Best trial: 14. Best value: 0.395842:  49%|████▉     | 49/100 [01:48<01:49,  2.15s/it]Best trial: 14. Best value: 0.395842:  50%|█████     | 50/100 [01:48<01:47,  2.15s/it]Best trial: 14. Best value: 0.395842:  50%|█████     | 50/100 [01:49<01:47,  2.15s/it]Best trial: 14. Best value: 0.395842:  51%|█████     | 51/100 [01:49<01:36,  1.97s/it]Best trial: 14. Best value: 0.395842:  51%|█████     | 51/100 [01:51<01:36,  1.97s/it]Best trial: 14. Best value: 0.395842:  52%|█████▏    | 52/100 [01:51<01:25,  1.79s/it]Best trial: 14. Best value: 0.395842:  52%|█████▏    | 52/100 [01:52<01:25,  1.79s/it]Best trial: 14. Best value: 0.395842:  53%|█████▎    | 53/100 [01:52<01:18,  1.67s/it]Best trial: 14. Best value: 0.395842:  53%|█████▎    | 53/100 [01:54<01:18,  1.67s/it]Best trial: 14. Best value: 0.395842:  54%|█████▍    | 54/100 [01:54<01:17,  1.69s/it]Best trial: 14. Best value: 0.395842:  54%|█████▍    | 54/100 [01:56<01:17,  1.69s/it]Best trial: 14. Best value: 0.395842:  55%|█████▌    | 55/100 [01:56<01:15,  1.68s/it]Best trial: 14. Best value: 0.395842:  55%|█████▌    | 55/100 [01:57<01:15,  1.68s/it]Best trial: 14. Best value: 0.395842:  56%|█████▌    | 56/100 [01:57<01:12,  1.65s/it]Best trial: 14. Best value: 0.395842:  56%|█████▌    | 56/100 [01:59<01:12,  1.65s/it]Best trial: 14. Best value: 0.395842:  57%|█████▋    | 57/100 [01:59<01:09,  1.61s/it]Best trial: 14. Best value: 0.395842:  57%|█████▋    | 57/100 [02:01<01:09,  1.61s/it]Best trial: 14. Best value: 0.395842:  58%|█████▊    | 58/100 [02:01<01:15,  1.79s/it]Best trial: 14. Best value: 0.395842:  58%|█████▊    | 58/100 [02:03<01:15,  1.79s/it]Best trial: 14. Best value: 0.395842:  59%|█████▉    | 59/100 [02:03<01:16,  1.86s/it]Best trial: 14. Best value: 0.395842:  59%|█████▉    | 59/100 [02:06<01:16,  1.86s/it]Best trial: 14. Best value: 0.395842:  60%|██████    | 60/100 [02:06<01:25,  2.13s/it]Best trial: 14. Best value: 0.395842:  60%|██████    | 60/100 [02:07<01:25,  2.13s/it]Best trial: 14. Best value: 0.395842:  61%|██████    | 61/100 [02:07<01:16,  1.97s/it]Best trial: 14. Best value: 0.395842:  61%|██████    | 61/100 [02:10<01:16,  1.97s/it]Best trial: 14. Best value: 0.395842:  62%|██████▏   | 62/100 [02:10<01:18,  2.06s/it]Best trial: 14. Best value: 0.395842:  62%|██████▏   | 62/100 [02:11<01:18,  2.06s/it]Best trial: 14. Best value: 0.395842:  63%|██████▎   | 63/100 [02:11<01:15,  2.04s/it]Best trial: 14. Best value: 0.395842:  63%|██████▎   | 63/100 [02:14<01:15,  2.04s/it]Best trial: 14. Best value: 0.395842:  64%|██████▍   | 64/100 [02:14<01:18,  2.18s/it]Best trial: 64. Best value: 0.411763:  64%|██████▍   | 64/100 [02:16<01:18,  2.18s/it]Best trial: 64. Best value: 0.411763:  65%|██████▌   | 65/100 [02:16<01:15,  2.15s/it]Best trial: 64. Best value: 0.411763:  65%|██████▌   | 65/100 [02:18<01:15,  2.15s/it]Best trial: 64. Best value: 0.411763:  66%|██████▌   | 66/100 [02:18<01:08,  2.02s/it]Best trial: 64. Best value: 0.411763:  66%|██████▌   | 66/100 [02:20<01:08,  2.02s/it]Best trial: 64. Best value: 0.411763:  67%|██████▋   | 67/100 [02:20<01:08,  2.08s/it]Best trial: 64. Best value: 0.411763:  67%|██████▋   | 67/100 [02:22<01:08,  2.08s/it]Best trial: 64. Best value: 0.411763:  68%|██████▊   | 68/100 [02:22<01:02,  1.95s/it]Best trial: 64. Best value: 0.411763:  68%|██████▊   | 68/100 [02:24<01:02,  1.95s/it]Best trial: 64. Best value: 0.411763:  69%|██████▉   | 69/100 [02:24<01:06,  2.14s/it]Best trial: 64. Best value: 0.411763:  69%|██████▉   | 69/100 [02:27<01:06,  2.14s/it]Best trial: 64. Best value: 0.411763:  70%|███████   | 70/100 [02:27<01:06,  2.21s/it]Best trial: 64. Best value: 0.411763:  70%|███████   | 70/100 [02:29<01:06,  2.21s/it]Best trial: 64. Best value: 0.411763:  71%|███████   | 71/100 [02:29<01:02,  2.14s/it]Best trial: 64. Best value: 0.411763:  71%|███████   | 71/100 [02:30<01:02,  2.14s/it]Best trial: 64. Best value: 0.411763:  72%|███████▏  | 72/100 [02:30<00:54,  1.94s/it]Best trial: 64. Best value: 0.411763:  72%|███████▏  | 72/100 [02:32<00:54,  1.94s/it]Best trial: 64. Best value: 0.411763:  73%|███████▎  | 73/100 [02:32<00:50,  1.87s/it]Best trial: 64. Best value: 0.411763:  73%|███████▎  | 73/100 [02:34<00:50,  1.87s/it]Best trial: 64. Best value: 0.411763:  74%|███████▍  | 74/100 [02:34<00:51,  1.97s/it]Best trial: 64. Best value: 0.411763:  74%|███████▍  | 74/100 [02:38<00:51,  1.97s/it]Best trial: 64. Best value: 0.411763:  75%|███████▌  | 75/100 [02:38<01:01,  2.46s/it]Best trial: 64. Best value: 0.411763:  75%|███████▌  | 75/100 [02:39<01:01,  2.46s/it]Best trial: 64. Best value: 0.411763:  76%|███████▌  | 76/100 [02:39<00:54,  2.26s/it]Best trial: 64. Best value: 0.411763:  76%|███████▌  | 76/100 [02:42<00:54,  2.26s/it]Best trial: 64. Best value: 0.411763:  77%|███████▋  | 77/100 [02:42<00:53,  2.31s/it]Best trial: 64. Best value: 0.411763:  77%|███████▋  | 77/100 [02:43<00:53,  2.31s/it]Best trial: 64. Best value: 0.411763:  78%|███████▊  | 78/100 [02:43<00:44,  2.04s/it]Best trial: 64. Best value: 0.411763:  78%|███████▊  | 78/100 [02:46<00:44,  2.04s/it]Best trial: 64. Best value: 0.411763:  79%|███████▉  | 79/100 [02:46<00:44,  2.12s/it]Best trial: 64. Best value: 0.411763:  79%|███████▉  | 79/100 [02:47<00:44,  2.12s/it]Best trial: 64. Best value: 0.411763:  80%|████████  | 80/100 [02:47<00:38,  1.94s/it]Best trial: 64. Best value: 0.411763:  80%|████████  | 80/100 [02:49<00:38,  1.94s/it]Best trial: 64. Best value: 0.411763:  81%|████████  | 81/100 [02:49<00:35,  1.88s/it]Best trial: 64. Best value: 0.411763:  81%|████████  | 81/100 [02:51<00:35,  1.88s/it]Best trial: 64. Best value: 0.411763:  82%|████████▏ | 82/100 [02:51<00:33,  1.85s/it]Best trial: 64. Best value: 0.411763:  82%|████████▏ | 82/100 [02:52<00:33,  1.85s/it]Best trial: 64. Best value: 0.411763:  83%|████████▎ | 83/100 [02:52<00:28,  1.71s/it]Best trial: 64. Best value: 0.411763:  83%|████████▎ | 83/100 [02:53<00:28,  1.71s/it]Best trial: 64. Best value: 0.411763:  84%|████████▍ | 84/100 [02:53<00:26,  1.65s/it]Best trial: 64. Best value: 0.411763:  84%|████████▍ | 84/100 [02:55<00:26,  1.65s/it]Best trial: 64. Best value: 0.411763:  85%|████████▌ | 85/100 [02:55<00:25,  1.71s/it]Best trial: 64. Best value: 0.411763:  85%|████████▌ | 85/100 [02:57<00:25,  1.71s/it]Best trial: 64. Best value: 0.411763:  86%|████████▌ | 86/100 [02:57<00:23,  1.69s/it]Best trial: 64. Best value: 0.411763:  86%|████████▌ | 86/100 [02:59<00:23,  1.69s/it]Best trial: 64. Best value: 0.411763:  87%|████████▋ | 87/100 [02:59<00:21,  1.67s/it]Best trial: 64. Best value: 0.411763:  87%|████████▋ | 87/100 [03:01<00:21,  1.67s/it]Best trial: 64. Best value: 0.411763:  88%|████████▊ | 88/100 [03:01<00:23,  1.96s/it]Best trial: 64. Best value: 0.411763:  88%|████████▊ | 88/100 [03:04<00:23,  1.96s/it]Best trial: 64. Best value: 0.411763:  89%|████████▉ | 89/100 [03:04<00:22,  2.08s/it]Best trial: 64. Best value: 0.411763:  89%|████████▉ | 89/100 [03:05<00:22,  2.08s/it]Best trial: 64. Best value: 0.411763:  90%|█████████ | 90/100 [03:05<00:20,  2.03s/it]Best trial: 64. Best value: 0.411763:  90%|█████████ | 90/100 [03:08<00:20,  2.03s/it]Best trial: 64. Best value: 0.411763:  91%|█████████ | 91/100 [03:08<00:19,  2.13s/it]Best trial: 64. Best value: 0.411763:  91%|█████████ | 91/100 [03:09<00:19,  2.13s/it]Best trial: 64. Best value: 0.411763:  92%|█████████▏| 92/100 [03:09<00:15,  1.98s/it]Best trial: 64. Best value: 0.411763:  92%|█████████▏| 92/100 [03:11<00:15,  1.98s/it]Best trial: 64. Best value: 0.411763:  93%|█████████▎| 93/100 [03:11<00:13,  1.89s/it]Best trial: 64. Best value: 0.411763:  93%|█████████▎| 93/100 [03:13<00:13,  1.89s/it]Best trial: 64. Best value: 0.411763:  94%|█████████▍| 94/100 [03:13<00:11,  1.94s/it]Best trial: 64. Best value: 0.411763:  94%|█████████▍| 94/100 [03:15<00:11,  1.94s/it]Best trial: 64. Best value: 0.411763:  95%|█████████▌| 95/100 [03:15<00:08,  1.78s/it]Best trial: 95. Best value: 0.412416:  95%|█████████▌| 95/100 [03:17<00:08,  1.78s/it]Best trial: 95. Best value: 0.412416:  96%|█████████▌| 96/100 [03:17<00:07,  1.89s/it]Best trial: 95. Best value: 0.412416:  96%|█████████▌| 96/100 [03:21<00:07,  1.89s/it]Best trial: 95. Best value: 0.412416:  97%|█████████▋| 97/100 [03:21<00:07,  2.46s/it]Best trial: 95. Best value: 0.412416:  97%|█████████▋| 97/100 [03:23<00:07,  2.46s/it]Best trial: 95. Best value: 0.412416:  98%|█████████▊| 98/100 [03:23<00:04,  2.32s/it]Best trial: 95. Best value: 0.412416:  98%|█████████▊| 98/100 [03:25<00:04,  2.32s/it]Best trial: 95. Best value: 0.412416:  99%|█████████▉| 99/100 [03:25<00:02,  2.37s/it]Best trial: 95. Best value: 0.412416:  99%|█████████▉| 99/100 [03:28<00:02,  2.37s/it]Best trial: 95. Best value: 0.412416: 100%|██████████| 100/100 [03:28<00:00,  2.41s/it]Best trial: 95. Best value: 0.412416: 100%|██████████| 100/100 [03:28<00:00,  2.08s/it]
2025-11-30 11:58:01,741 - INFO - HPO Complete. Best AUPRC: 0.4124
2025-11-30 11:58:01,741 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.03766334805408437, 'max_depth': 3, 'subsample': 0.7196582301775694, 'colsample_bytree': 0.6202288881413204, 'gamma': 0.10905098174097366, 'reg_lambda': 5.957447586106815e-06, 'reg_alpha': 2.0415544146315796e-06}
2025-11-30 11:58:01,741 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 11:58:03,529 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 11:58:03,530 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:58:03,612 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:58:03,634 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:58:03,639 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 11:58:03,639 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 11:58:03,639 - INFO - Training model...
2025-11-30 11:58:04,692 - INFO - Evaluating model with bootstrapping...
2025-11-30 11:58:09,892 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 11:58:09,892 - INFO - AUROC: 0.7271 (0.6040 - 0.9226)
2025-11-30 11:58:09,892 - INFO - AUPRC: 0.2267 (0.0464 - 0.4866)
2025-11-30 11:58:09,892 - INFO - Brier Score: 0.0159 (0.0115 - 0.0252)
2025-11-30 11:58:09,892 - INFO - Accuracy: 0.9769 (0.9387 - 0.9939)
2025-11-30 11:58:09,892 - INFO - Precision: 0.2857 (0.1144 - 1.0000)
2025-11-30 11:58:09,893 - INFO - Sensitivity (Recall): 0.4000 (0.1302 - 0.6167)
2025-11-30 11:58:09,893 - INFO - F1-Score: 0.3333 (0.1439 - 0.6095)
2025-11-30 11:58:09,893 - INFO - Best Threshold: 0.2400 (0.0700 - 0.9600)
2025-11-30 11:58:09,893 - INFO - Specificity: 0.9853 (0.9461 - 1.0000)
2025-11-30 11:58:09,902 - INFO - Calculating SHAP values...
2025-11-30 11:58:10,844 - INFO - SHAP plots saved.
2025-11-30 11:58:10,845 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 11:58:12,162 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 11:58:12,162 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 11:58:12,272 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 11:58:12,298 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 11:58:12,305 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 11:58:12,306 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.26648:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.26648:   1%|          | 1/100 [00:02<03:21,  2.03s/it]Best trial: 1. Best value: 0.31019:   1%|          | 1/100 [00:04<03:21,  2.03s/it]Best trial: 1. Best value: 0.31019:   2%|▏         | 2/100 [00:04<03:53,  2.38s/it]Best trial: 2. Best value: 0.336693:   2%|▏         | 2/100 [00:07<03:53,  2.38s/it]Best trial: 2. Best value: 0.336693:   3%|▎         | 3/100 [00:07<04:15,  2.63s/it]Best trial: 2. Best value: 0.336693:   3%|▎         | 3/100 [00:11<04:15,  2.63s/it]Best trial: 2. Best value: 0.336693:   4%|▍         | 4/100 [00:11<05:04,  3.18s/it]Best trial: 2. Best value: 0.336693:   4%|▍         | 4/100 [00:14<05:04,  3.18s/it]Best trial: 2. Best value: 0.336693:   5%|▌         | 5/100 [00:14<04:44,  3.00s/it]Best trial: 5. Best value: 0.377239:   5%|▌         | 5/100 [00:16<04:44,  3.00s/it]Best trial: 5. Best value: 0.377239:   6%|▌         | 6/100 [00:16<04:04,  2.60s/it]Best trial: 5. Best value: 0.377239:   6%|▌         | 6/100 [00:19<04:04,  2.60s/it]Best trial: 5. Best value: 0.377239:   7%|▋         | 7/100 [00:19<04:16,  2.76s/it]Best trial: 7. Best value: 0.404565:   7%|▋         | 7/100 [00:23<04:16,  2.76s/it]Best trial: 7. Best value: 0.404565:   8%|▊         | 8/100 [00:23<04:49,  3.14s/it]Best trial: 7. Best value: 0.404565:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]Best trial: 7. Best value: 0.404565:   9%|▉         | 9/100 [00:25<04:32,  3.00s/it]Best trial: 7. Best value: 0.404565:   9%|▉         | 9/100 [00:28<04:32,  3.00s/it]Best trial: 7. Best value: 0.404565:  10%|█         | 10/100 [00:28<04:10,  2.78s/it]Best trial: 7. Best value: 0.404565:  10%|█         | 10/100 [00:30<04:10,  2.78s/it]Best trial: 7. Best value: 0.404565:  11%|█         | 11/100 [00:30<04:07,  2.78s/it]Best trial: 7. Best value: 0.404565:  11%|█         | 11/100 [00:33<04:07,  2.78s/it]Best trial: 7. Best value: 0.404565:  12%|█▏        | 12/100 [00:33<03:53,  2.66s/it]Best trial: 7. Best value: 0.404565:  12%|█▏        | 12/100 [00:36<03:53,  2.66s/it]Best trial: 7. Best value: 0.404565:  13%|█▎        | 13/100 [00:36<03:54,  2.70s/it]Best trial: 7. Best value: 0.404565:  13%|█▎        | 13/100 [00:40<03:54,  2.70s/it]Best trial: 7. Best value: 0.404565:  14%|█▍        | 14/100 [00:40<04:38,  3.24s/it]Best trial: 7. Best value: 0.404565:  14%|█▍        | 14/100 [00:44<04:38,  3.24s/it]Best trial: 7. Best value: 0.404565:  15%|█▌        | 15/100 [00:44<04:56,  3.49s/it]Best trial: 7. Best value: 0.404565:  15%|█▌        | 15/100 [00:47<04:56,  3.49s/it]Best trial: 7. Best value: 0.404565:  16%|█▌        | 16/100 [00:47<04:37,  3.30s/it]Best trial: 7. Best value: 0.404565:  16%|█▌        | 16/100 [00:50<04:37,  3.30s/it]Best trial: 7. Best value: 0.404565:  17%|█▋        | 17/100 [00:50<04:15,  3.07s/it]Best trial: 17. Best value: 0.451752:  17%|█▋        | 17/100 [00:54<04:15,  3.07s/it]Best trial: 17. Best value: 0.451752:  18%|█▊        | 18/100 [00:54<04:55,  3.61s/it]Best trial: 17. Best value: 0.451752:  18%|█▊        | 18/100 [00:58<04:55,  3.61s/it]Best trial: 17. Best value: 0.451752:  19%|█▉        | 19/100 [00:58<04:50,  3.59s/it]Best trial: 17. Best value: 0.451752:  19%|█▉        | 19/100 [01:02<04:50,  3.59s/it]Best trial: 17. Best value: 0.451752:  20%|██        | 20/100 [01:02<04:58,  3.73s/it]Best trial: 17. Best value: 0.451752:  20%|██        | 20/100 [01:05<04:58,  3.73s/it]Best trial: 17. Best value: 0.451752:  21%|██        | 21/100 [01:05<04:32,  3.45s/it]Best trial: 17. Best value: 0.451752:  21%|██        | 21/100 [01:09<04:32,  3.45s/it]Best trial: 17. Best value: 0.451752:  22%|██▏       | 22/100 [01:09<04:39,  3.58s/it]Best trial: 17. Best value: 0.451752:  22%|██▏       | 22/100 [01:13<04:39,  3.58s/it]Best trial: 17. Best value: 0.451752:  23%|██▎       | 23/100 [01:13<04:46,  3.72s/it]Best trial: 17. Best value: 0.451752:  23%|██▎       | 23/100 [01:16<04:46,  3.72s/it]Best trial: 17. Best value: 0.451752:  24%|██▍       | 24/100 [01:16<04:32,  3.58s/it]Best trial: 17. Best value: 0.451752:  24%|██▍       | 24/100 [01:20<04:32,  3.58s/it]Best trial: 17. Best value: 0.451752:  25%|██▌       | 25/100 [01:20<04:36,  3.69s/it]Best trial: 17. Best value: 0.451752:  25%|██▌       | 25/100 [01:25<04:36,  3.69s/it]Best trial: 17. Best value: 0.451752:  26%|██▌       | 26/100 [01:25<05:12,  4.22s/it]Best trial: 17. Best value: 0.451752:  26%|██▌       | 26/100 [01:28<05:12,  4.22s/it]Best trial: 17. Best value: 0.451752:  27%|██▋       | 27/100 [01:28<04:29,  3.69s/it]Best trial: 17. Best value: 0.451752:  27%|██▋       | 27/100 [01:33<04:29,  3.69s/it]Best trial: 17. Best value: 0.451752:  28%|██▊       | 28/100 [01:33<04:47,  3.99s/it]Best trial: 17. Best value: 0.451752:  28%|██▊       | 28/100 [01:37<04:47,  3.99s/it]Best trial: 17. Best value: 0.451752:  29%|██▉       | 29/100 [01:37<04:45,  4.02s/it]Best trial: 17. Best value: 0.451752:  29%|██▉       | 29/100 [01:41<04:45,  4.02s/it]Best trial: 17. Best value: 0.451752:  30%|███       | 30/100 [01:41<04:48,  4.12s/it]Best trial: 17. Best value: 0.451752:  30%|███       | 30/100 [01:44<04:48,  4.12s/it]Best trial: 17. Best value: 0.451752:  31%|███       | 31/100 [01:44<04:26,  3.86s/it]Best trial: 17. Best value: 0.451752:  31%|███       | 31/100 [01:48<04:26,  3.86s/it]Best trial: 17. Best value: 0.451752:  32%|███▏      | 32/100 [01:48<04:10,  3.68s/it]Best trial: 17. Best value: 0.451752:  32%|███▏      | 32/100 [01:51<04:10,  3.68s/it]Best trial: 17. Best value: 0.451752:  33%|███▎      | 33/100 [01:51<03:54,  3.50s/it]Best trial: 17. Best value: 0.451752:  33%|███▎      | 33/100 [01:53<03:54,  3.50s/it]Best trial: 17. Best value: 0.451752:  34%|███▍      | 34/100 [01:53<03:26,  3.12s/it]Best trial: 17. Best value: 0.451752:  34%|███▍      | 34/100 [01:56<03:26,  3.12s/it]Best trial: 17. Best value: 0.451752:  35%|███▌      | 35/100 [01:56<03:19,  3.08s/it]Best trial: 35. Best value: 0.482209:  35%|███▌      | 35/100 [02:03<03:19,  3.08s/it]Best trial: 35. Best value: 0.482209:  36%|███▌      | 36/100 [02:03<04:28,  4.20s/it]Best trial: 35. Best value: 0.482209:  36%|███▌      | 36/100 [02:09<04:28,  4.20s/it]Best trial: 35. Best value: 0.482209:  37%|███▋      | 37/100 [02:09<05:00,  4.77s/it]Best trial: 35. Best value: 0.482209:  37%|███▋      | 37/100 [02:12<05:00,  4.77s/it]Best trial: 35. Best value: 0.482209:  38%|███▊      | 38/100 [02:12<04:36,  4.46s/it]Best trial: 35. Best value: 0.482209:  38%|███▊      | 38/100 [02:15<04:36,  4.46s/it]Best trial: 35. Best value: 0.482209:  39%|███▉      | 39/100 [02:15<04:03,  3.99s/it]Best trial: 35. Best value: 0.482209:  39%|███▉      | 39/100 [02:19<04:03,  3.99s/it]Best trial: 35. Best value: 0.482209:  40%|████      | 40/100 [02:19<03:47,  3.79s/it]Best trial: 35. Best value: 0.482209:  40%|████      | 40/100 [02:23<03:47,  3.79s/it]Best trial: 35. Best value: 0.482209:  41%|████      | 41/100 [02:23<03:49,  3.90s/it]Best trial: 35. Best value: 0.482209:  41%|████      | 41/100 [02:27<03:49,  3.90s/it]Best trial: 35. Best value: 0.482209:  42%|████▏     | 42/100 [02:27<03:58,  4.12s/it]Best trial: 35. Best value: 0.482209:  42%|████▏     | 42/100 [02:33<03:58,  4.12s/it]Best trial: 35. Best value: 0.482209:  43%|████▎     | 43/100 [02:33<04:15,  4.48s/it]Best trial: 35. Best value: 0.482209:  43%|████▎     | 43/100 [02:38<04:15,  4.48s/it]Best trial: 35. Best value: 0.482209:  44%|████▍     | 44/100 [02:38<04:21,  4.67s/it]Best trial: 35. Best value: 0.482209:  44%|████▍     | 44/100 [02:41<04:21,  4.67s/it]Best trial: 35. Best value: 0.482209:  45%|████▌     | 45/100 [02:41<03:51,  4.20s/it]Best trial: 35. Best value: 0.482209:  45%|████▌     | 45/100 [02:47<03:51,  4.20s/it]Best trial: 35. Best value: 0.482209:  46%|████▌     | 46/100 [02:47<04:13,  4.69s/it]Best trial: 35. Best value: 0.482209:  46%|████▌     | 46/100 [02:50<04:13,  4.69s/it]Best trial: 35. Best value: 0.482209:  47%|████▋     | 47/100 [02:50<03:46,  4.28s/it]Best trial: 35. Best value: 0.482209:  47%|████▋     | 47/100 [02:55<03:46,  4.28s/it]Best trial: 35. Best value: 0.482209:  48%|████▊     | 48/100 [02:55<03:54,  4.51s/it]Best trial: 35. Best value: 0.482209:  48%|████▊     | 48/100 [02:59<03:54,  4.51s/it]Best trial: 35. Best value: 0.482209:  49%|████▉     | 49/100 [02:59<03:36,  4.24s/it]Best trial: 35. Best value: 0.482209:  49%|████▉     | 49/100 [03:06<03:36,  4.24s/it]Best trial: 35. Best value: 0.482209:  50%|█████     | 50/100 [03:06<04:16,  5.12s/it]Best trial: 35. Best value: 0.482209:  50%|█████     | 50/100 [03:12<04:16,  5.12s/it]Best trial: 35. Best value: 0.482209:  51%|█████     | 51/100 [03:12<04:20,  5.31s/it]Best trial: 35. Best value: 0.482209:  51%|█████     | 51/100 [03:16<04:20,  5.31s/it]Best trial: 35. Best value: 0.482209:  52%|█████▏    | 52/100 [03:16<03:56,  4.94s/it]Best trial: 35. Best value: 0.482209:  52%|█████▏    | 52/100 [03:19<03:56,  4.94s/it]Best trial: 35. Best value: 0.482209:  53%|█████▎    | 53/100 [03:19<03:33,  4.54s/it]Best trial: 35. Best value: 0.482209:  53%|█████▎    | 53/100 [03:23<03:33,  4.54s/it]Best trial: 35. Best value: 0.482209:  54%|█████▍    | 54/100 [03:23<03:09,  4.13s/it]Best trial: 35. Best value: 0.482209:  54%|█████▍    | 54/100 [03:25<03:09,  4.13s/it]Best trial: 35. Best value: 0.482209:  55%|█████▌    | 55/100 [03:25<02:44,  3.67s/it]Best trial: 35. Best value: 0.482209:  55%|█████▌    | 55/100 [03:28<02:44,  3.67s/it]Best trial: 35. Best value: 0.482209:  56%|█████▌    | 56/100 [03:28<02:27,  3.36s/it]Best trial: 35. Best value: 0.482209:  56%|█████▌    | 56/100 [03:31<02:27,  3.36s/it]Best trial: 35. Best value: 0.482209:  57%|█████▋    | 57/100 [03:31<02:21,  3.28s/it]Best trial: 35. Best value: 0.482209:  57%|█████▋    | 57/100 [03:36<02:21,  3.28s/it]Best trial: 35. Best value: 0.482209:  58%|█████▊    | 58/100 [03:36<02:43,  3.90s/it]Best trial: 35. Best value: 0.482209:  58%|█████▊    | 58/100 [03:40<02:43,  3.90s/it]Best trial: 35. Best value: 0.482209:  59%|█████▉    | 59/100 [03:40<02:43,  3.98s/it]Best trial: 35. Best value: 0.482209:  59%|█████▉    | 59/100 [03:45<02:43,  3.98s/it]Best trial: 35. Best value: 0.482209:  60%|██████    | 60/100 [03:45<02:42,  4.07s/it]Best trial: 35. Best value: 0.482209:  60%|██████    | 60/100 [03:48<02:42,  4.07s/it]Best trial: 35. Best value: 0.482209:  61%|██████    | 61/100 [03:48<02:30,  3.85s/it]Best trial: 35. Best value: 0.482209:  61%|██████    | 61/100 [03:51<02:30,  3.85s/it]Best trial: 35. Best value: 0.482209:  62%|██████▏   | 62/100 [03:51<02:18,  3.63s/it]Best trial: 35. Best value: 0.482209:  62%|██████▏   | 62/100 [03:54<02:18,  3.63s/it]Best trial: 35. Best value: 0.482209:  63%|██████▎   | 63/100 [03:54<02:01,  3.29s/it]Best trial: 35. Best value: 0.482209:  63%|██████▎   | 63/100 [03:57<02:01,  3.29s/it]Best trial: 35. Best value: 0.482209:  64%|██████▍   | 64/100 [03:57<01:59,  3.31s/it]Best trial: 35. Best value: 0.482209:  64%|██████▍   | 64/100 [03:59<01:59,  3.31s/it]Best trial: 35. Best value: 0.482209:  65%|██████▌   | 65/100 [03:59<01:43,  2.96s/it]Best trial: 35. Best value: 0.482209:  65%|██████▌   | 65/100 [04:02<01:43,  2.96s/it]Best trial: 35. Best value: 0.482209:  66%|██████▌   | 66/100 [04:02<01:36,  2.83s/it]Best trial: 35. Best value: 0.482209:  66%|██████▌   | 66/100 [04:06<01:36,  2.83s/it]Best trial: 35. Best value: 0.482209:  67%|██████▋   | 67/100 [04:06<01:45,  3.20s/it]Best trial: 35. Best value: 0.482209:  67%|██████▋   | 67/100 [04:09<01:45,  3.20s/it]Best trial: 35. Best value: 0.482209:  68%|██████▊   | 68/100 [04:09<01:44,  3.25s/it]Best trial: 35. Best value: 0.482209:  68%|██████▊   | 68/100 [04:14<01:44,  3.25s/it]Best trial: 35. Best value: 0.482209:  69%|██████▉   | 69/100 [04:14<01:54,  3.68s/it]Best trial: 35. Best value: 0.482209:  69%|██████▉   | 69/100 [04:20<01:54,  3.68s/it]Best trial: 35. Best value: 0.482209:  70%|███████   | 70/100 [04:20<02:08,  4.28s/it]Best trial: 35. Best value: 0.482209:  70%|███████   | 70/100 [04:24<02:08,  4.28s/it]Best trial: 35. Best value: 0.482209:  71%|███████   | 71/100 [04:24<02:03,  4.25s/it]Best trial: 35. Best value: 0.482209:  71%|███████   | 71/100 [04:29<02:03,  4.25s/it]Best trial: 35. Best value: 0.482209:  72%|███████▏  | 72/100 [04:29<02:06,  4.51s/it]Best trial: 35. Best value: 0.482209:  72%|███████▏  | 72/100 [04:34<02:06,  4.51s/it]Best trial: 35. Best value: 0.482209:  73%|███████▎  | 73/100 [04:34<02:05,  4.65s/it]Best trial: 35. Best value: 0.482209:  73%|███████▎  | 73/100 [04:39<02:05,  4.65s/it]Best trial: 35. Best value: 0.482209:  74%|███████▍  | 74/100 [04:39<02:06,  4.87s/it]Best trial: 35. Best value: 0.482209:  74%|███████▍  | 74/100 [04:49<02:06,  4.87s/it]Best trial: 35. Best value: 0.482209:  75%|███████▌  | 75/100 [04:49<02:35,  6.22s/it]Best trial: 35. Best value: 0.482209:  75%|███████▌  | 75/100 [04:55<02:35,  6.22s/it]Best trial: 35. Best value: 0.482209:  76%|███████▌  | 76/100 [04:55<02:29,  6.21s/it]Best trial: 35. Best value: 0.482209:  76%|███████▌  | 76/100 [05:01<02:29,  6.21s/it]Best trial: 35. Best value: 0.482209:  77%|███████▋  | 77/100 [05:01<02:20,  6.11s/it]Best trial: 35. Best value: 0.482209:  77%|███████▋  | 77/100 [05:08<02:20,  6.11s/it]Best trial: 35. Best value: 0.482209:  78%|███████▊  | 78/100 [05:08<02:24,  6.58s/it]Best trial: 35. Best value: 0.482209:  78%|███████▊  | 78/100 [05:15<02:24,  6.58s/it]Best trial: 35. Best value: 0.482209:  79%|███████▉  | 79/100 [05:15<02:16,  6.49s/it]Best trial: 35. Best value: 0.482209:  79%|███████▉  | 79/100 [05:25<02:16,  6.49s/it]Best trial: 35. Best value: 0.482209:  80%|████████  | 80/100 [05:25<02:36,  7.80s/it]Best trial: 35. Best value: 0.482209:  80%|████████  | 80/100 [05:29<02:36,  7.80s/it]Best trial: 35. Best value: 0.482209:  81%|████████  | 81/100 [05:29<02:05,  6.58s/it]Best trial: 35. Best value: 0.482209:  81%|████████  | 81/100 [05:32<02:05,  6.58s/it]Best trial: 35. Best value: 0.482209:  82%|████████▏ | 82/100 [05:32<01:35,  5.32s/it]Best trial: 35. Best value: 0.482209:  82%|████████▏ | 82/100 [05:34<01:35,  5.32s/it]Best trial: 35. Best value: 0.482209:  83%|████████▎ | 83/100 [05:34<01:17,  4.54s/it]Best trial: 35. Best value: 0.482209:  83%|████████▎ | 83/100 [05:38<01:17,  4.54s/it]Best trial: 35. Best value: 0.482209:  84%|████████▍ | 84/100 [05:38<01:07,  4.21s/it]Best trial: 35. Best value: 0.482209:  84%|████████▍ | 84/100 [05:43<01:07,  4.21s/it]Best trial: 35. Best value: 0.482209:  85%|████████▌ | 85/100 [05:43<01:07,  4.52s/it]Best trial: 35. Best value: 0.482209:  85%|████████▌ | 85/100 [05:47<01:07,  4.52s/it]Best trial: 35. Best value: 0.482209:  86%|████████▌ | 86/100 [05:47<01:02,  4.45s/it]Best trial: 35. Best value: 0.482209:  86%|████████▌ | 86/100 [05:52<01:02,  4.45s/it]Best trial: 35. Best value: 0.482209:  87%|████████▋ | 87/100 [05:52<00:58,  4.51s/it]Best trial: 35. Best value: 0.482209:  87%|████████▋ | 87/100 [05:57<00:58,  4.51s/it]Best trial: 35. Best value: 0.482209:  88%|████████▊ | 88/100 [05:57<00:55,  4.59s/it]Best trial: 35. Best value: 0.482209:  88%|████████▊ | 88/100 [06:00<00:55,  4.59s/it]Best trial: 35. Best value: 0.482209:  89%|████████▉ | 89/100 [06:00<00:45,  4.16s/it]Best trial: 35. Best value: 0.482209:  89%|████████▉ | 89/100 [06:03<00:45,  4.16s/it]Best trial: 35. Best value: 0.482209:  90%|█████████ | 90/100 [06:03<00:38,  3.82s/it]Best trial: 35. Best value: 0.482209:  90%|█████████ | 90/100 [06:06<00:38,  3.82s/it]Best trial: 35. Best value: 0.482209:  91%|█████████ | 91/100 [06:06<00:31,  3.55s/it]Best trial: 35. Best value: 0.482209:  91%|█████████ | 91/100 [06:08<00:31,  3.55s/it]Best trial: 35. Best value: 0.482209:  92%|█████████▏| 92/100 [06:08<00:25,  3.21s/it]Best trial: 35. Best value: 0.482209:  92%|█████████▏| 92/100 [06:10<00:25,  3.21s/it]Best trial: 35. Best value: 0.482209:  93%|█████████▎| 93/100 [06:10<00:19,  2.84s/it]Best trial: 93. Best value: 0.48575:  93%|█████████▎| 93/100 [06:13<00:19,  2.84s/it] Best trial: 93. Best value: 0.48575:  94%|█████████▍| 94/100 [06:13<00:17,  2.91s/it]Best trial: 93. Best value: 0.48575:  94%|█████████▍| 94/100 [06:16<00:17,  2.91s/it]Best trial: 93. Best value: 0.48575:  95%|█████████▌| 95/100 [06:16<00:14,  2.99s/it]Best trial: 93. Best value: 0.48575:  95%|█████████▌| 95/100 [06:19<00:14,  2.99s/it]Best trial: 93. Best value: 0.48575:  96%|█████████▌| 96/100 [06:19<00:12,  3.02s/it]Best trial: 93. Best value: 0.48575:  96%|█████████▌| 96/100 [06:24<00:12,  3.02s/it]Best trial: 93. Best value: 0.48575:  97%|█████████▋| 97/100 [06:24<00:10,  3.39s/it]Best trial: 93. Best value: 0.48575:  97%|█████████▋| 97/100 [06:27<00:10,  3.39s/it]Best trial: 93. Best value: 0.48575:  98%|█████████▊| 98/100 [06:27<00:06,  3.44s/it]Best trial: 93. Best value: 0.48575:  98%|█████████▊| 98/100 [06:30<00:06,  3.44s/it]Best trial: 93. Best value: 0.48575:  99%|█████████▉| 99/100 [06:30<00:03,  3.32s/it]Best trial: 93. Best value: 0.48575:  99%|█████████▉| 99/100 [06:35<00:03,  3.32s/it]Best trial: 93. Best value: 0.48575: 100%|██████████| 100/100 [06:35<00:00,  3.88s/it]Best trial: 93. Best value: 0.48575: 100%|██████████| 100/100 [06:35<00:00,  3.96s/it]
2025-11-30 12:04:48,303 - INFO - HPO Complete. Best AUPRC: 0.4858
2025-11-30 12:04:48,304 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.08585776369743876, 'max_depth': 10, 'subsample': 0.8166274479437857, 'colsample_bytree': 0.731605725110346, 'gamma': 0.22292187837120375, 'reg_lambda': 0.0004830289381316707, 'reg_alpha': 3.424753186472947e-05}
2025-11-30 12:04:48,304 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:04:50,095 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 12:04:50,095 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:04:50,182 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:04:50,205 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:04:50,210 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 12:04:50,210 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:04:50,210 - INFO - Training model...
2025-11-30 12:04:51,522 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:04:56,749 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:04:56,750 - INFO - AUROC: 0.7182 (0.5473 - 0.8388)
2025-11-30 12:04:56,750 - INFO - AUPRC: 0.2406 (0.0386 - 0.4940)
2025-11-30 12:04:56,750 - INFO - Brier Score: 0.0143 (0.0092 - 0.0243)
2025-11-30 12:04:56,750 - INFO - Accuracy: 0.9855 (0.9566 - 0.9913)
2025-11-30 12:04:56,750 - INFO - Precision: 0.5000 (0.1200 - 1.0000)
2025-11-30 12:04:56,750 - INFO - Sensitivity (Recall): 0.3000 (0.0857 - 0.5619)
2025-11-30 12:04:56,750 - INFO - F1-Score: 0.3750 (0.1000 - 0.6095)
2025-11-30 12:04:56,750 - INFO - Best Threshold: 0.3200 (0.0580 - 0.7620)
2025-11-30 12:04:56,750 - INFO - Specificity: 0.9956 (0.9704 - 1.0000)
2025-11-30 12:04:56,763 - INFO - Calculating SHAP values...
2025-11-30 12:04:57,765 - INFO - SHAP plots saved.
2025-11-30 12:04:57,767 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:04:59,152 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 12:04:59,152 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:04:59,243 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:04:59,268 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:04:59,274 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 12:04:59,274 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.234388:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.234388:   1%|          | 1/100 [00:03<05:04,  3.07s/it]Best trial: 1. Best value: 0.321169:   1%|          | 1/100 [00:06<05:04,  3.07s/it]Best trial: 1. Best value: 0.321169:   2%|▏         | 2/100 [00:06<05:13,  3.20s/it]Best trial: 1. Best value: 0.321169:   2%|▏         | 2/100 [00:08<05:13,  3.20s/it]Best trial: 1. Best value: 0.321169:   3%|▎         | 3/100 [00:08<04:39,  2.89s/it]Best trial: 1. Best value: 0.321169:   3%|▎         | 3/100 [00:10<04:39,  2.89s/it]Best trial: 1. Best value: 0.321169:   4%|▍         | 4/100 [00:10<04:04,  2.55s/it]Best trial: 4. Best value: 0.341412:   4%|▍         | 4/100 [00:15<04:04,  2.55s/it]Best trial: 4. Best value: 0.341412:   5%|▌         | 5/100 [00:15<05:03,  3.19s/it]Best trial: 4. Best value: 0.341412:   5%|▌         | 5/100 [00:18<05:03,  3.19s/it]Best trial: 4. Best value: 0.341412:   6%|▌         | 6/100 [00:18<05:10,  3.31s/it]Best trial: 4. Best value: 0.341412:   6%|▌         | 6/100 [00:20<05:10,  3.31s/it]Best trial: 4. Best value: 0.341412:   7%|▋         | 7/100 [00:20<04:09,  2.68s/it]Best trial: 4. Best value: 0.341412:   7%|▋         | 7/100 [00:22<04:09,  2.68s/it]Best trial: 4. Best value: 0.341412:   8%|▊         | 8/100 [00:22<03:43,  2.43s/it]Best trial: 4. Best value: 0.341412:   8%|▊         | 8/100 [00:24<03:43,  2.43s/it]Best trial: 4. Best value: 0.341412:   9%|▉         | 9/100 [00:24<03:50,  2.54s/it]Best trial: 4. Best value: 0.341412:   9%|▉         | 9/100 [00:26<03:50,  2.54s/it]Best trial: 4. Best value: 0.341412:  10%|█         | 10/100 [00:26<03:28,  2.31s/it]Best trial: 10. Best value: 0.37007:  10%|█         | 10/100 [00:28<03:28,  2.31s/it]Best trial: 10. Best value: 0.37007:  11%|█         | 11/100 [00:28<03:22,  2.27s/it]Best trial: 11. Best value: 0.37225:  11%|█         | 11/100 [00:31<03:22,  2.27s/it]Best trial: 11. Best value: 0.37225:  12%|█▏        | 12/100 [00:31<03:32,  2.41s/it]Best trial: 12. Best value: 0.41434:  12%|█▏        | 12/100 [00:34<03:32,  2.41s/it]Best trial: 12. Best value: 0.41434:  13%|█▎        | 13/100 [00:34<03:35,  2.47s/it]Best trial: 12. Best value: 0.41434:  13%|█▎        | 13/100 [00:36<03:35,  2.47s/it]Best trial: 12. Best value: 0.41434:  14%|█▍        | 14/100 [00:36<03:39,  2.55s/it]Best trial: 12. Best value: 0.41434:  14%|█▍        | 14/100 [00:40<03:39,  2.55s/it]Best trial: 12. Best value: 0.41434:  15%|█▌        | 15/100 [00:40<03:57,  2.80s/it]Best trial: 12. Best value: 0.41434:  15%|█▌        | 15/100 [00:42<03:57,  2.80s/it]Best trial: 12. Best value: 0.41434:  16%|█▌        | 16/100 [00:42<03:40,  2.63s/it]Best trial: 12. Best value: 0.41434:  16%|█▌        | 16/100 [00:44<03:40,  2.63s/it]Best trial: 12. Best value: 0.41434:  17%|█▋        | 17/100 [00:44<03:30,  2.54s/it]Best trial: 12. Best value: 0.41434:  17%|█▋        | 17/100 [00:46<03:30,  2.54s/it]Best trial: 12. Best value: 0.41434:  18%|█▊        | 18/100 [00:46<03:15,  2.38s/it]Best trial: 12. Best value: 0.41434:  18%|█▊        | 18/100 [00:49<03:15,  2.38s/it]Best trial: 12. Best value: 0.41434:  19%|█▉        | 19/100 [00:49<03:11,  2.36s/it]Best trial: 12. Best value: 0.41434:  19%|█▉        | 19/100 [00:51<03:11,  2.36s/it]Best trial: 12. Best value: 0.41434:  20%|██        | 20/100 [00:51<03:02,  2.28s/it]Best trial: 12. Best value: 0.41434:  20%|██        | 20/100 [00:53<03:02,  2.28s/it]Best trial: 12. Best value: 0.41434:  21%|██        | 21/100 [00:53<03:06,  2.36s/it]Best trial: 12. Best value: 0.41434:  21%|██        | 21/100 [00:55<03:06,  2.36s/it]Best trial: 12. Best value: 0.41434:  22%|██▏       | 22/100 [00:55<02:48,  2.16s/it]Best trial: 12. Best value: 0.41434:  22%|██▏       | 22/100 [00:58<02:48,  2.16s/it]Best trial: 12. Best value: 0.41434:  23%|██▎       | 23/100 [00:58<02:59,  2.33s/it]Best trial: 12. Best value: 0.41434:  23%|██▎       | 23/100 [01:00<02:59,  2.33s/it]Best trial: 12. Best value: 0.41434:  24%|██▍       | 24/100 [01:00<02:56,  2.33s/it]Best trial: 12. Best value: 0.41434:  24%|██▍       | 24/100 [01:03<02:56,  2.33s/it]Best trial: 12. Best value: 0.41434:  25%|██▌       | 25/100 [01:03<03:10,  2.54s/it]Best trial: 12. Best value: 0.41434:  25%|██▌       | 25/100 [01:06<03:10,  2.54s/it]Best trial: 12. Best value: 0.41434:  26%|██▌       | 26/100 [01:06<03:11,  2.59s/it]Best trial: 12. Best value: 0.41434:  26%|██▌       | 26/100 [01:08<03:11,  2.59s/it]Best trial: 12. Best value: 0.41434:  27%|██▋       | 27/100 [01:08<03:11,  2.62s/it]Best trial: 12. Best value: 0.41434:  27%|██▋       | 27/100 [01:11<03:11,  2.62s/it]Best trial: 12. Best value: 0.41434:  28%|██▊       | 28/100 [01:11<03:13,  2.68s/it]Best trial: 12. Best value: 0.41434:  28%|██▊       | 28/100 [01:14<03:13,  2.68s/it]Best trial: 12. Best value: 0.41434:  29%|██▉       | 29/100 [01:14<03:09,  2.68s/it]Best trial: 12. Best value: 0.41434:  29%|██▉       | 29/100 [01:16<03:09,  2.68s/it]Best trial: 12. Best value: 0.41434:  30%|███       | 30/100 [01:16<03:02,  2.60s/it]Best trial: 12. Best value: 0.41434:  30%|███       | 30/100 [01:19<03:02,  2.60s/it]Best trial: 12. Best value: 0.41434:  31%|███       | 31/100 [01:19<02:55,  2.55s/it]Best trial: 12. Best value: 0.41434:  31%|███       | 31/100 [01:22<02:55,  2.55s/it]Best trial: 12. Best value: 0.41434:  32%|███▏      | 32/100 [01:22<02:58,  2.62s/it]Best trial: 12. Best value: 0.41434:  32%|███▏      | 32/100 [01:24<02:58,  2.62s/it]Best trial: 12. Best value: 0.41434:  33%|███▎      | 33/100 [01:24<02:49,  2.53s/it]Best trial: 12. Best value: 0.41434:  33%|███▎      | 33/100 [01:27<02:49,  2.53s/it]Best trial: 12. Best value: 0.41434:  34%|███▍      | 34/100 [01:27<02:52,  2.62s/it]Best trial: 12. Best value: 0.41434:  34%|███▍      | 34/100 [01:29<02:52,  2.62s/it]Best trial: 12. Best value: 0.41434:  35%|███▌      | 35/100 [01:29<02:42,  2.50s/it]Best trial: 12. Best value: 0.41434:  35%|███▌      | 35/100 [01:31<02:42,  2.50s/it]Best trial: 12. Best value: 0.41434:  36%|███▌      | 36/100 [01:31<02:39,  2.49s/it]Best trial: 12. Best value: 0.41434:  36%|███▌      | 36/100 [01:34<02:39,  2.49s/it]Best trial: 12. Best value: 0.41434:  37%|███▋      | 37/100 [01:34<02:40,  2.54s/it]Best trial: 12. Best value: 0.41434:  37%|███▋      | 37/100 [01:36<02:40,  2.54s/it]Best trial: 12. Best value: 0.41434:  38%|███▊      | 38/100 [01:36<02:34,  2.49s/it]Best trial: 12. Best value: 0.41434:  38%|███▊      | 38/100 [01:41<02:34,  2.49s/it]Best trial: 12. Best value: 0.41434:  39%|███▉      | 39/100 [01:41<03:04,  3.02s/it]Best trial: 12. Best value: 0.41434:  39%|███▉      | 39/100 [01:43<03:04,  3.02s/it]Best trial: 12. Best value: 0.41434:  40%|████      | 40/100 [01:43<02:39,  2.66s/it]Best trial: 12. Best value: 0.41434:  40%|████      | 40/100 [01:45<02:39,  2.66s/it]Best trial: 12. Best value: 0.41434:  41%|████      | 41/100 [01:45<02:26,  2.48s/it]Best trial: 12. Best value: 0.41434:  41%|████      | 41/100 [01:47<02:26,  2.48s/it]Best trial: 12. Best value: 0.41434:  42%|████▏     | 42/100 [01:47<02:20,  2.43s/it]Best trial: 42. Best value: 0.426069:  42%|████▏     | 42/100 [01:49<02:20,  2.43s/it]Best trial: 42. Best value: 0.426069:  43%|████▎     | 43/100 [01:49<02:04,  2.19s/it]Best trial: 42. Best value: 0.426069:  43%|████▎     | 43/100 [01:50<02:04,  2.19s/it]Best trial: 42. Best value: 0.426069:  44%|████▍     | 44/100 [01:50<01:49,  1.96s/it]Best trial: 42. Best value: 0.426069:  44%|████▍     | 44/100 [01:52<01:49,  1.96s/it]Best trial: 42. Best value: 0.426069:  45%|████▌     | 45/100 [01:52<01:41,  1.84s/it]Best trial: 42. Best value: 0.426069:  45%|████▌     | 45/100 [01:53<01:41,  1.84s/it]Best trial: 42. Best value: 0.426069:  46%|████▌     | 46/100 [01:53<01:31,  1.69s/it]Best trial: 42. Best value: 0.426069:  46%|████▌     | 46/100 [01:55<01:31,  1.69s/it]Best trial: 42. Best value: 0.426069:  47%|████▋     | 47/100 [01:55<01:43,  1.96s/it]Best trial: 42. Best value: 0.426069:  47%|████▋     | 47/100 [02:00<01:43,  1.96s/it]Best trial: 42. Best value: 0.426069:  48%|████▊     | 48/100 [02:00<02:19,  2.68s/it]Best trial: 42. Best value: 0.426069:  48%|████▊     | 48/100 [02:02<02:19,  2.68s/it]Best trial: 42. Best value: 0.426069:  49%|████▉     | 49/100 [02:02<02:12,  2.60s/it]Best trial: 42. Best value: 0.426069:  49%|████▉     | 49/100 [02:06<02:12,  2.60s/it]Best trial: 42. Best value: 0.426069:  50%|█████     | 50/100 [02:06<02:22,  2.85s/it]Best trial: 42. Best value: 0.426069:  50%|█████     | 50/100 [02:08<02:22,  2.85s/it]Best trial: 42. Best value: 0.426069:  51%|█████     | 51/100 [02:08<02:07,  2.60s/it]Best trial: 42. Best value: 0.426069:  51%|█████     | 51/100 [02:10<02:07,  2.60s/it]Best trial: 42. Best value: 0.426069:  52%|█████▏    | 52/100 [02:10<02:00,  2.51s/it]Best trial: 52. Best value: 0.440794:  52%|█████▏    | 52/100 [02:12<02:00,  2.51s/it]Best trial: 52. Best value: 0.440794:  53%|█████▎    | 53/100 [02:12<01:44,  2.23s/it]Best trial: 53. Best value: 0.446007:  53%|█████▎    | 53/100 [02:13<01:44,  2.23s/it]Best trial: 53. Best value: 0.446007:  54%|█████▍    | 54/100 [02:13<01:36,  2.10s/it]Best trial: 53. Best value: 0.446007:  54%|█████▍    | 54/100 [02:15<01:36,  2.10s/it]Best trial: 53. Best value: 0.446007:  55%|█████▌    | 55/100 [02:15<01:26,  1.92s/it]Best trial: 53. Best value: 0.446007:  55%|█████▌    | 55/100 [02:16<01:26,  1.92s/it]Best trial: 53. Best value: 0.446007:  56%|█████▌    | 56/100 [02:16<01:20,  1.83s/it]Best trial: 53. Best value: 0.446007:  56%|█████▌    | 56/100 [02:18<01:20,  1.83s/it]Best trial: 53. Best value: 0.446007:  57%|█████▋    | 57/100 [02:18<01:16,  1.79s/it]Best trial: 53. Best value: 0.446007:  57%|█████▋    | 57/100 [02:20<01:16,  1.79s/it]Best trial: 53. Best value: 0.446007:  58%|█████▊    | 58/100 [02:20<01:12,  1.73s/it]Best trial: 53. Best value: 0.446007:  58%|█████▊    | 58/100 [02:22<01:12,  1.73s/it]Best trial: 53. Best value: 0.446007:  59%|█████▉    | 59/100 [02:22<01:11,  1.75s/it]Best trial: 53. Best value: 0.446007:  59%|█████▉    | 59/100 [02:23<01:11,  1.75s/it]Best trial: 53. Best value: 0.446007:  60%|██████    | 60/100 [02:23<01:06,  1.67s/it]Best trial: 53. Best value: 0.446007:  60%|██████    | 60/100 [02:25<01:06,  1.67s/it]Best trial: 53. Best value: 0.446007:  61%|██████    | 61/100 [02:25<01:06,  1.70s/it]Best trial: 53. Best value: 0.446007:  61%|██████    | 61/100 [02:26<01:06,  1.70s/it]Best trial: 53. Best value: 0.446007:  62%|██████▏   | 62/100 [02:26<01:02,  1.65s/it]Best trial: 53. Best value: 0.446007:  62%|██████▏   | 62/100 [02:28<01:02,  1.65s/it]Best trial: 53. Best value: 0.446007:  63%|██████▎   | 63/100 [02:28<01:00,  1.65s/it]Best trial: 53. Best value: 0.446007:  63%|██████▎   | 63/100 [02:29<01:00,  1.65s/it]Best trial: 53. Best value: 0.446007:  64%|██████▍   | 64/100 [02:29<00:57,  1.60s/it]Best trial: 53. Best value: 0.446007:  64%|██████▍   | 64/100 [02:31<00:57,  1.60s/it]Best trial: 53. Best value: 0.446007:  65%|██████▌   | 65/100 [02:31<00:56,  1.62s/it]Best trial: 53. Best value: 0.446007:  65%|██████▌   | 65/100 [02:33<00:56,  1.62s/it]Best trial: 53. Best value: 0.446007:  66%|██████▌   | 66/100 [02:33<00:53,  1.57s/it]Best trial: 53. Best value: 0.446007:  66%|██████▌   | 66/100 [02:35<00:53,  1.57s/it]Best trial: 53. Best value: 0.446007:  67%|██████▋   | 67/100 [02:35<00:59,  1.81s/it]Best trial: 53. Best value: 0.446007:  67%|██████▋   | 67/100 [02:36<00:59,  1.81s/it]Best trial: 53. Best value: 0.446007:  68%|██████▊   | 68/100 [02:36<00:54,  1.71s/it]Best trial: 53. Best value: 0.446007:  68%|██████▊   | 68/100 [02:38<00:54,  1.71s/it]Best trial: 53. Best value: 0.446007:  69%|██████▉   | 69/100 [02:38<00:55,  1.80s/it]Best trial: 53. Best value: 0.446007:  69%|██████▉   | 69/100 [02:41<00:55,  1.80s/it]Best trial: 53. Best value: 0.446007:  70%|███████   | 70/100 [02:41<01:02,  2.09s/it]Best trial: 53. Best value: 0.446007:  70%|███████   | 70/100 [02:43<01:02,  2.09s/it]Best trial: 53. Best value: 0.446007:  71%|███████   | 71/100 [02:43<00:55,  1.91s/it]Best trial: 53. Best value: 0.446007:  71%|███████   | 71/100 [02:45<00:55,  1.91s/it]Best trial: 53. Best value: 0.446007:  72%|███████▏  | 72/100 [02:45<00:53,  1.90s/it]Best trial: 53. Best value: 0.446007:  72%|███████▏  | 72/100 [02:47<00:53,  1.90s/it]Best trial: 53. Best value: 0.446007:  73%|███████▎  | 73/100 [02:47<00:52,  1.95s/it]Best trial: 53. Best value: 0.446007:  73%|███████▎  | 73/100 [02:48<00:52,  1.95s/it]Best trial: 53. Best value: 0.446007:  74%|███████▍  | 74/100 [02:48<00:46,  1.79s/it]Best trial: 53. Best value: 0.446007:  74%|███████▍  | 74/100 [02:50<00:46,  1.79s/it]Best trial: 53. Best value: 0.446007:  75%|███████▌  | 75/100 [02:50<00:46,  1.88s/it]Best trial: 53. Best value: 0.446007:  75%|███████▌  | 75/100 [02:52<00:46,  1.88s/it]Best trial: 53. Best value: 0.446007:  76%|███████▌  | 76/100 [02:52<00:42,  1.76s/it]Best trial: 53. Best value: 0.446007:  76%|███████▌  | 76/100 [02:53<00:42,  1.76s/it]Best trial: 53. Best value: 0.446007:  77%|███████▋  | 77/100 [02:53<00:39,  1.71s/it]Best trial: 53. Best value: 0.446007:  77%|███████▋  | 77/100 [02:55<00:39,  1.71s/it]Best trial: 53. Best value: 0.446007:  78%|███████▊  | 78/100 [02:55<00:36,  1.67s/it]Best trial: 53. Best value: 0.446007:  78%|███████▊  | 78/100 [02:56<00:36,  1.67s/it]Best trial: 53. Best value: 0.446007:  79%|███████▉  | 79/100 [02:56<00:35,  1.67s/it]Best trial: 53. Best value: 0.446007:  79%|███████▉  | 79/100 [02:58<00:35,  1.67s/it]Best trial: 53. Best value: 0.446007:  80%|████████  | 80/100 [02:58<00:35,  1.76s/it]Best trial: 53. Best value: 0.446007:  80%|████████  | 80/100 [03:00<00:35,  1.76s/it]Best trial: 53. Best value: 0.446007:  81%|████████  | 81/100 [03:00<00:32,  1.71s/it]Best trial: 53. Best value: 0.446007:  81%|████████  | 81/100 [03:02<00:32,  1.71s/it]Best trial: 53. Best value: 0.446007:  82%|████████▏ | 82/100 [03:02<00:33,  1.86s/it]Best trial: 53. Best value: 0.446007:  82%|████████▏ | 82/100 [03:04<00:33,  1.86s/it]Best trial: 53. Best value: 0.446007:  83%|████████▎ | 83/100 [03:04<00:32,  1.94s/it]Best trial: 53. Best value: 0.446007:  83%|████████▎ | 83/100 [03:06<00:32,  1.94s/it]Best trial: 53. Best value: 0.446007:  84%|████████▍ | 84/100 [03:06<00:31,  1.98s/it]Best trial: 53. Best value: 0.446007:  84%|████████▍ | 84/100 [03:08<00:31,  1.98s/it]Best trial: 53. Best value: 0.446007:  85%|████████▌ | 85/100 [03:08<00:27,  1.82s/it]Best trial: 53. Best value: 0.446007:  85%|████████▌ | 85/100 [03:09<00:27,  1.82s/it]Best trial: 53. Best value: 0.446007:  86%|████████▌ | 86/100 [03:09<00:23,  1.69s/it]Best trial: 53. Best value: 0.446007:  86%|████████▌ | 86/100 [03:11<00:23,  1.69s/it]Best trial: 53. Best value: 0.446007:  87%|████████▋ | 87/100 [03:11<00:21,  1.65s/it]Best trial: 53. Best value: 0.446007:  87%|████████▋ | 87/100 [03:12<00:21,  1.65s/it]Best trial: 53. Best value: 0.446007:  88%|████████▊ | 88/100 [03:12<00:18,  1.56s/it]Best trial: 53. Best value: 0.446007:  88%|████████▊ | 88/100 [03:14<00:18,  1.56s/it]Best trial: 53. Best value: 0.446007:  89%|████████▉ | 89/100 [03:14<00:16,  1.51s/it]Best trial: 53. Best value: 0.446007:  89%|████████▉ | 89/100 [03:15<00:16,  1.51s/it]Best trial: 53. Best value: 0.446007:  90%|█████████ | 90/100 [03:15<00:16,  1.61s/it]Best trial: 53. Best value: 0.446007:  90%|█████████ | 90/100 [03:17<00:16,  1.61s/it]Best trial: 53. Best value: 0.446007:  91%|█████████ | 91/100 [03:17<00:15,  1.71s/it]Best trial: 53. Best value: 0.446007:  91%|█████████ | 91/100 [03:20<00:15,  1.71s/it]Best trial: 53. Best value: 0.446007:  92%|█████████▏| 92/100 [03:20<00:14,  1.86s/it]Best trial: 53. Best value: 0.446007:  92%|█████████▏| 92/100 [03:21<00:14,  1.86s/it]Best trial: 53. Best value: 0.446007:  93%|█████████▎| 93/100 [03:21<00:12,  1.72s/it]Best trial: 53. Best value: 0.446007:  93%|█████████▎| 93/100 [03:23<00:12,  1.72s/it]Best trial: 53. Best value: 0.446007:  94%|█████████▍| 94/100 [03:23<00:10,  1.75s/it]Best trial: 53. Best value: 0.446007:  94%|█████████▍| 94/100 [03:24<00:10,  1.75s/it]Best trial: 53. Best value: 0.446007:  95%|█████████▌| 95/100 [03:24<00:08,  1.72s/it]Best trial: 53. Best value: 0.446007:  95%|█████████▌| 95/100 [03:26<00:08,  1.72s/it]Best trial: 53. Best value: 0.446007:  96%|█████████▌| 96/100 [03:26<00:06,  1.61s/it]Best trial: 53. Best value: 0.446007:  96%|█████████▌| 96/100 [03:27<00:06,  1.61s/it]Best trial: 53. Best value: 0.446007:  97%|█████████▋| 97/100 [03:27<00:04,  1.60s/it]Best trial: 53. Best value: 0.446007:  97%|█████████▋| 97/100 [03:29<00:04,  1.60s/it]Best trial: 53. Best value: 0.446007:  98%|█████████▊| 98/100 [03:29<00:03,  1.61s/it]Best trial: 53. Best value: 0.446007:  98%|█████████▊| 98/100 [03:31<00:03,  1.61s/it]Best trial: 53. Best value: 0.446007:  99%|█████████▉| 99/100 [03:31<00:01,  1.61s/it]Best trial: 53. Best value: 0.446007:  99%|█████████▉| 99/100 [03:33<00:01,  1.61s/it]Best trial: 53. Best value: 0.446007: 100%|██████████| 100/100 [03:33<00:00,  1.87s/it]Best trial: 53. Best value: 0.446007: 100%|██████████| 100/100 [03:33<00:00,  2.14s/it]
2025-11-30 12:08:32,838 - INFO - HPO Complete. Best AUPRC: 0.4460
2025-11-30 12:08:32,838 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.0975911244073452, 'max_depth': 3, 'subsample': 0.7165030996686974, 'colsample_bytree': 0.6336812401964103, 'gamma': 1.1290200048558297, 'reg_lambda': 1.0222474434284778e-07, 'reg_alpha': 1.5796952663086607e-08}
2025-11-30 12:08:32,839 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:08:34,849 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 12:08:34,849 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:08:34,932 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:08:34,955 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:08:34,960 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 12:08:34,960 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:08:34,960 - INFO - Training model...
2025-11-30 12:08:36,232 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:08:41,672 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:08:41,672 - INFO - AUROC: 0.6918 (0.5354 - 0.8869)
2025-11-30 12:08:41,672 - INFO - AUPRC: 0.1632 (0.0224 - 0.4635)
2025-11-30 12:08:41,672 - INFO - Brier Score: 0.0151 (0.0091 - 0.0278)
2025-11-30 12:08:41,672 - INFO - Accuracy: 0.9870 (0.9312 - 0.9931)
2025-11-30 12:08:41,672 - INFO - Precision: 0.6667 (0.0462 - 1.0000)
2025-11-30 12:08:41,672 - INFO - Sensitivity (Recall): 0.2000 (0.0462 - 0.5667)
2025-11-30 12:08:41,672 - INFO - F1-Score: 0.3077 (0.0600 - 0.6095)
2025-11-30 12:08:41,672 - INFO - Best Threshold: 0.6800 (0.0220 - 0.6800)
2025-11-30 12:08:41,672 - INFO - Specificity: 0.9985 (0.9426 - 1.0000)
2025-11-30 12:08:41,685 - INFO - Calculating SHAP values...
2025-11-30 12:08:42,666 - INFO - SHAP plots saved.
2025-11-30 12:08:42,669 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:08:44,364 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 12:08:44,365 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:08:44,469 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:08:44,496 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:08:44,504 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 12:08:44,504 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.329456:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.329456:   1%|          | 1/100 [00:03<04:57,  3.00s/it]Best trial: 0. Best value: 0.329456:   1%|          | 1/100 [00:05<04:57,  3.00s/it]Best trial: 0. Best value: 0.329456:   2%|▏         | 2/100 [00:05<04:46,  2.92s/it]Best trial: 2. Best value: 0.341222:   2%|▏         | 2/100 [00:08<04:46,  2.92s/it]Best trial: 2. Best value: 0.341222:   3%|▎         | 3/100 [00:08<04:35,  2.84s/it]Best trial: 2. Best value: 0.341222:   3%|▎         | 3/100 [00:13<04:35,  2.84s/it]Best trial: 2. Best value: 0.341222:   4%|▍         | 4/100 [00:13<05:42,  3.57s/it]Best trial: 4. Best value: 0.352108:   4%|▍         | 4/100 [00:15<05:42,  3.57s/it]Best trial: 4. Best value: 0.352108:   5%|▌         | 5/100 [00:15<05:05,  3.22s/it]Best trial: 5. Best value: 0.440093:   5%|▌         | 5/100 [00:18<05:05,  3.22s/it]Best trial: 5. Best value: 0.440093:   6%|▌         | 6/100 [00:18<04:54,  3.14s/it]Best trial: 5. Best value: 0.440093:   6%|▌         | 6/100 [00:21<04:54,  3.14s/it]Best trial: 5. Best value: 0.440093:   7%|▋         | 7/100 [00:21<04:21,  2.81s/it]Best trial: 5. Best value: 0.440093:   7%|▋         | 7/100 [00:23<04:21,  2.81s/it]Best trial: 5. Best value: 0.440093:   8%|▊         | 8/100 [00:23<03:56,  2.57s/it]Best trial: 5. Best value: 0.440093:   8%|▊         | 8/100 [00:26<03:56,  2.57s/it]Best trial: 5. Best value: 0.440093:   9%|▉         | 9/100 [00:26<04:25,  2.92s/it]Best trial: 5. Best value: 0.440093:   9%|▉         | 9/100 [00:29<04:25,  2.92s/it]Best trial: 5. Best value: 0.440093:  10%|█         | 10/100 [00:29<04:06,  2.73s/it]Best trial: 5. Best value: 0.440093:  10%|█         | 10/100 [00:31<04:06,  2.73s/it]Best trial: 5. Best value: 0.440093:  11%|█         | 11/100 [00:31<03:43,  2.52s/it]Best trial: 5. Best value: 0.440093:  11%|█         | 11/100 [00:33<03:43,  2.52s/it]Best trial: 5. Best value: 0.440093:  12%|█▏        | 12/100 [00:33<03:30,  2.39s/it]Best trial: 5. Best value: 0.440093:  12%|█▏        | 12/100 [00:36<03:30,  2.39s/it]Best trial: 5. Best value: 0.440093:  13%|█▎        | 13/100 [00:36<03:52,  2.67s/it]Best trial: 5. Best value: 0.440093:  13%|█▎        | 13/100 [00:41<03:52,  2.67s/it]Best trial: 5. Best value: 0.440093:  14%|█▍        | 14/100 [00:41<04:51,  3.39s/it]Best trial: 5. Best value: 0.440093:  14%|█▍        | 14/100 [00:46<04:51,  3.39s/it]Best trial: 5. Best value: 0.440093:  15%|█▌        | 15/100 [00:46<05:21,  3.78s/it]Best trial: 5. Best value: 0.440093:  15%|█▌        | 15/100 [00:49<05:21,  3.78s/it]Best trial: 5. Best value: 0.440093:  16%|█▌        | 16/100 [00:49<05:12,  3.72s/it]Best trial: 5. Best value: 0.440093:  16%|█▌        | 16/100 [00:53<05:12,  3.72s/it]Best trial: 5. Best value: 0.440093:  17%|█▋        | 17/100 [00:53<05:06,  3.69s/it]Best trial: 5. Best value: 0.440093:  17%|█▋        | 17/100 [00:55<05:06,  3.69s/it]Best trial: 5. Best value: 0.440093:  18%|█▊        | 18/100 [00:55<04:29,  3.28s/it]Best trial: 5. Best value: 0.440093:  18%|█▊        | 18/100 [00:59<04:29,  3.28s/it]Best trial: 5. Best value: 0.440093:  19%|█▉        | 19/100 [00:59<04:34,  3.39s/it]Best trial: 5. Best value: 0.440093:  19%|█▉        | 19/100 [01:02<04:34,  3.39s/it]Best trial: 5. Best value: 0.440093:  20%|██        | 20/100 [01:02<04:33,  3.42s/it]Best trial: 5. Best value: 0.440093:  20%|██        | 20/100 [01:05<04:33,  3.42s/it]Best trial: 5. Best value: 0.440093:  21%|██        | 21/100 [01:05<04:20,  3.30s/it]Best trial: 5. Best value: 0.440093:  21%|██        | 21/100 [01:08<04:20,  3.30s/it]Best trial: 5. Best value: 0.440093:  22%|██▏       | 22/100 [01:08<03:49,  2.95s/it]Best trial: 5. Best value: 0.440093:  22%|██▏       | 22/100 [01:11<03:49,  2.95s/it]Best trial: 5. Best value: 0.440093:  23%|██▎       | 23/100 [01:11<03:50,  2.99s/it]Best trial: 5. Best value: 0.440093:  23%|██▎       | 23/100 [01:13<03:50,  2.99s/it]Best trial: 5. Best value: 0.440093:  24%|██▍       | 24/100 [01:13<03:26,  2.72s/it]Best trial: 5. Best value: 0.440093:  24%|██▍       | 24/100 [01:16<03:26,  2.72s/it]Best trial: 5. Best value: 0.440093:  25%|██▌       | 25/100 [01:16<03:35,  2.88s/it]Best trial: 5. Best value: 0.440093:  25%|██▌       | 25/100 [01:20<03:35,  2.88s/it]Best trial: 5. Best value: 0.440093:  26%|██▌       | 26/100 [01:20<03:47,  3.07s/it]Best trial: 5. Best value: 0.440093:  26%|██▌       | 26/100 [01:22<03:47,  3.07s/it]Best trial: 5. Best value: 0.440093:  27%|██▋       | 27/100 [01:22<03:21,  2.77s/it]Best trial: 5. Best value: 0.440093:  27%|██▋       | 27/100 [01:24<03:21,  2.77s/it]Best trial: 5. Best value: 0.440093:  28%|██▊       | 28/100 [01:24<03:11,  2.66s/it]Best trial: 5. Best value: 0.440093:  28%|██▊       | 28/100 [01:26<03:11,  2.66s/it]Best trial: 5. Best value: 0.440093:  29%|██▉       | 29/100 [01:26<02:56,  2.49s/it]Best trial: 5. Best value: 0.440093:  29%|██▉       | 29/100 [01:30<02:56,  2.49s/it]Best trial: 5. Best value: 0.440093:  30%|███       | 30/100 [01:30<03:16,  2.81s/it]Best trial: 5. Best value: 0.440093:  30%|███       | 30/100 [01:35<03:16,  2.81s/it]Best trial: 5. Best value: 0.440093:  31%|███       | 31/100 [01:35<03:59,  3.47s/it]Best trial: 5. Best value: 0.440093:  31%|███       | 31/100 [01:36<03:59,  3.47s/it]Best trial: 5. Best value: 0.440093:  32%|███▏      | 32/100 [01:36<03:20,  2.95s/it]Best trial: 5. Best value: 0.440093:  32%|███▏      | 32/100 [01:39<03:20,  2.95s/it]Best trial: 5. Best value: 0.440093:  33%|███▎      | 33/100 [01:39<03:04,  2.76s/it]Best trial: 5. Best value: 0.440093:  33%|███▎      | 33/100 [01:40<03:04,  2.76s/it]Best trial: 5. Best value: 0.440093:  34%|███▍      | 34/100 [01:40<02:42,  2.46s/it]Best trial: 5. Best value: 0.440093:  34%|███▍      | 34/100 [01:43<02:42,  2.46s/it]Best trial: 5. Best value: 0.440093:  35%|███▌      | 35/100 [01:43<02:46,  2.57s/it]Best trial: 5. Best value: 0.440093:  35%|███▌      | 35/100 [01:45<02:46,  2.57s/it]Best trial: 5. Best value: 0.440093:  36%|███▌      | 36/100 [01:45<02:26,  2.28s/it]Best trial: 5. Best value: 0.440093:  36%|███▌      | 36/100 [01:48<02:26,  2.28s/it]Best trial: 5. Best value: 0.440093:  37%|███▋      | 37/100 [01:48<02:45,  2.62s/it]Best trial: 5. Best value: 0.440093:  37%|███▋      | 37/100 [01:51<02:45,  2.62s/it]Best trial: 5. Best value: 0.440093:  38%|███▊      | 38/100 [01:51<02:45,  2.67s/it]Best trial: 5. Best value: 0.440093:  38%|███▊      | 38/100 [01:53<02:45,  2.67s/it]Best trial: 5. Best value: 0.440093:  39%|███▉      | 39/100 [01:53<02:25,  2.38s/it]Best trial: 5. Best value: 0.440093:  39%|███▉      | 39/100 [01:56<02:25,  2.38s/it]Best trial: 5. Best value: 0.440093:  40%|████      | 40/100 [01:56<02:39,  2.65s/it]Best trial: 5. Best value: 0.440093:  40%|████      | 40/100 [01:59<02:39,  2.65s/it]Best trial: 5. Best value: 0.440093:  41%|████      | 41/100 [01:59<02:35,  2.64s/it]Best trial: 5. Best value: 0.440093:  41%|████      | 41/100 [02:02<02:35,  2.64s/it]Best trial: 5. Best value: 0.440093:  42%|████▏     | 42/100 [02:02<02:39,  2.75s/it]Best trial: 5. Best value: 0.440093:  42%|████▏     | 42/100 [02:03<02:39,  2.75s/it]Best trial: 5. Best value: 0.440093:  43%|████▎     | 43/100 [02:03<02:19,  2.45s/it]Best trial: 5. Best value: 0.440093:  43%|████▎     | 43/100 [02:06<02:19,  2.45s/it]Best trial: 5. Best value: 0.440093:  44%|████▍     | 44/100 [02:06<02:13,  2.39s/it]Best trial: 5. Best value: 0.440093:  44%|████▍     | 44/100 [02:10<02:13,  2.39s/it]Best trial: 5. Best value: 0.440093:  45%|████▌     | 45/100 [02:10<02:37,  2.87s/it]Best trial: 5. Best value: 0.440093:  45%|████▌     | 45/100 [02:11<02:37,  2.87s/it]Best trial: 5. Best value: 0.440093:  46%|████▌     | 46/100 [02:11<02:17,  2.55s/it]Best trial: 5. Best value: 0.440093:  46%|████▌     | 46/100 [02:13<02:17,  2.55s/it]Best trial: 5. Best value: 0.440093:  47%|████▋     | 47/100 [02:13<02:03,  2.34s/it]Best trial: 5. Best value: 0.440093:  47%|████▋     | 47/100 [02:16<02:03,  2.34s/it]Best trial: 5. Best value: 0.440093:  48%|████▊     | 48/100 [02:16<02:12,  2.55s/it]Best trial: 5. Best value: 0.440093:  48%|████▊     | 48/100 [02:19<02:12,  2.55s/it]Best trial: 5. Best value: 0.440093:  49%|████▉     | 49/100 [02:19<02:06,  2.48s/it]Best trial: 5. Best value: 0.440093:  49%|████▉     | 49/100 [02:21<02:06,  2.48s/it]Best trial: 5. Best value: 0.440093:  50%|█████     | 50/100 [02:21<01:56,  2.32s/it]Best trial: 5. Best value: 0.440093:  50%|█████     | 50/100 [02:22<01:56,  2.32s/it]Best trial: 5. Best value: 0.440093:  51%|█████     | 51/100 [02:22<01:39,  2.04s/it]Best trial: 5. Best value: 0.440093:  51%|█████     | 51/100 [02:24<01:39,  2.04s/it]Best trial: 5. Best value: 0.440093:  52%|█████▏    | 52/100 [02:24<01:34,  1.97s/it]Best trial: 5. Best value: 0.440093:  52%|█████▏    | 52/100 [02:26<01:34,  1.97s/it]Best trial: 5. Best value: 0.440093:  53%|█████▎    | 53/100 [02:26<01:30,  1.92s/it]Best trial: 5. Best value: 0.440093:  53%|█████▎    | 53/100 [02:28<01:30,  1.92s/it]Best trial: 5. Best value: 0.440093:  54%|█████▍    | 54/100 [02:28<01:28,  1.93s/it]Best trial: 5. Best value: 0.440093:  54%|█████▍    | 54/100 [02:30<01:28,  1.93s/it]Best trial: 5. Best value: 0.440093:  55%|█████▌    | 55/100 [02:30<01:38,  2.18s/it]Best trial: 55. Best value: 0.451995:  55%|█████▌    | 55/100 [02:32<01:38,  2.18s/it]Best trial: 55. Best value: 0.451995:  56%|█████▌    | 56/100 [02:32<01:35,  2.17s/it]Best trial: 56. Best value: 0.458954:  56%|█████▌    | 56/100 [02:35<01:35,  2.17s/it]Best trial: 56. Best value: 0.458954:  57%|█████▋    | 57/100 [02:35<01:33,  2.17s/it]Best trial: 56. Best value: 0.458954:  57%|█████▋    | 57/100 [02:37<01:33,  2.17s/it]Best trial: 56. Best value: 0.458954:  58%|█████▊    | 58/100 [02:37<01:35,  2.26s/it]Best trial: 56. Best value: 0.458954:  58%|█████▊    | 58/100 [02:39<01:35,  2.26s/it]Best trial: 56. Best value: 0.458954:  59%|█████▉    | 59/100 [02:39<01:26,  2.11s/it]Best trial: 56. Best value: 0.458954:  59%|█████▉    | 59/100 [02:42<01:26,  2.11s/it]Best trial: 56. Best value: 0.458954:  60%|██████    | 60/100 [02:42<01:36,  2.41s/it]Best trial: 56. Best value: 0.458954:  60%|██████    | 60/100 [02:45<01:36,  2.41s/it]Best trial: 56. Best value: 0.458954:  61%|██████    | 61/100 [02:45<01:36,  2.49s/it]Best trial: 61. Best value: 0.466185:  61%|██████    | 61/100 [02:47<01:36,  2.49s/it]Best trial: 61. Best value: 0.466185:  62%|██████▏   | 62/100 [02:47<01:28,  2.34s/it]Best trial: 62. Best value: 0.471278:  62%|██████▏   | 62/100 [02:48<01:28,  2.34s/it]Best trial: 62. Best value: 0.471278:  63%|██████▎   | 63/100 [02:48<01:20,  2.18s/it]Best trial: 62. Best value: 0.471278:  63%|██████▎   | 63/100 [02:50<01:20,  2.18s/it]Best trial: 62. Best value: 0.471278:  64%|██████▍   | 64/100 [02:50<01:12,  2.02s/it]Best trial: 62. Best value: 0.471278:  64%|██████▍   | 64/100 [02:53<01:12,  2.02s/it]Best trial: 62. Best value: 0.471278:  65%|██████▌   | 65/100 [02:53<01:15,  2.15s/it]Best trial: 62. Best value: 0.471278:  65%|██████▌   | 65/100 [02:55<01:15,  2.15s/it]Best trial: 62. Best value: 0.471278:  66%|██████▌   | 66/100 [02:55<01:15,  2.22s/it]Best trial: 62. Best value: 0.471278:  66%|██████▌   | 66/100 [02:59<01:15,  2.22s/it]Best trial: 62. Best value: 0.471278:  67%|██████▋   | 67/100 [02:59<01:32,  2.80s/it]Best trial: 62. Best value: 0.471278:  67%|██████▋   | 67/100 [03:01<01:32,  2.80s/it]Best trial: 62. Best value: 0.471278:  68%|██████▊   | 68/100 [03:01<01:18,  2.45s/it]Best trial: 62. Best value: 0.471278:  68%|██████▊   | 68/100 [03:03<01:18,  2.45s/it]Best trial: 62. Best value: 0.471278:  69%|██████▉   | 69/100 [03:03<01:17,  2.51s/it]Best trial: 62. Best value: 0.471278:  69%|██████▉   | 69/100 [03:05<01:17,  2.51s/it]Best trial: 62. Best value: 0.471278:  70%|███████   | 70/100 [03:05<01:11,  2.39s/it]Best trial: 62. Best value: 0.471278:  70%|███████   | 70/100 [03:07<01:11,  2.39s/it]Best trial: 62. Best value: 0.471278:  71%|███████   | 71/100 [03:07<01:04,  2.24s/it]Best trial: 62. Best value: 0.471278:  71%|███████   | 71/100 [03:09<01:04,  2.24s/it]Best trial: 62. Best value: 0.471278:  72%|███████▏  | 72/100 [03:09<00:58,  2.08s/it]Best trial: 62. Best value: 0.471278:  72%|███████▏  | 72/100 [03:11<00:58,  2.08s/it]Best trial: 62. Best value: 0.471278:  73%|███████▎  | 73/100 [03:11<00:51,  1.91s/it]Best trial: 62. Best value: 0.471278:  73%|███████▎  | 73/100 [03:12<00:51,  1.91s/it]Best trial: 62. Best value: 0.471278:  74%|███████▍  | 74/100 [03:12<00:49,  1.91s/it]Best trial: 62. Best value: 0.471278:  74%|███████▍  | 74/100 [03:15<00:49,  1.91s/it]Best trial: 62. Best value: 0.471278:  75%|███████▌  | 75/100 [03:15<00:50,  2.02s/it]Best trial: 62. Best value: 0.471278:  75%|███████▌  | 75/100 [03:17<00:50,  2.02s/it]Best trial: 62. Best value: 0.471278:  76%|███████▌  | 76/100 [03:17<00:51,  2.14s/it]Best trial: 62. Best value: 0.471278:  76%|███████▌  | 76/100 [03:20<00:51,  2.14s/it]Best trial: 62. Best value: 0.471278:  77%|███████▋  | 77/100 [03:20<00:55,  2.40s/it]Best trial: 62. Best value: 0.471278:  77%|███████▋  | 77/100 [03:22<00:55,  2.40s/it]Best trial: 62. Best value: 0.471278:  78%|███████▊  | 78/100 [03:22<00:49,  2.27s/it]Best trial: 62. Best value: 0.471278:  78%|███████▊  | 78/100 [03:24<00:49,  2.27s/it]Best trial: 62. Best value: 0.471278:  79%|███████▉  | 79/100 [03:24<00:43,  2.09s/it]Best trial: 62. Best value: 0.471278:  79%|███████▉  | 79/100 [03:27<00:43,  2.09s/it]Best trial: 62. Best value: 0.471278:  80%|████████  | 80/100 [03:27<00:48,  2.41s/it]Best trial: 62. Best value: 0.471278:  80%|████████  | 80/100 [03:29<00:48,  2.41s/it]Best trial: 62. Best value: 0.471278:  81%|████████  | 81/100 [03:29<00:43,  2.26s/it]Best trial: 62. Best value: 0.471278:  81%|████████  | 81/100 [03:31<00:43,  2.26s/it]Best trial: 62. Best value: 0.471278:  82%|████████▏ | 82/100 [03:31<00:39,  2.19s/it]Best trial: 62. Best value: 0.471278:  82%|████████▏ | 82/100 [03:33<00:39,  2.19s/it]Best trial: 62. Best value: 0.471278:  83%|████████▎ | 83/100 [03:33<00:34,  2.02s/it]Best trial: 62. Best value: 0.471278:  83%|████████▎ | 83/100 [03:35<00:34,  2.02s/it]Best trial: 62. Best value: 0.471278:  84%|████████▍ | 84/100 [03:35<00:32,  2.03s/it]Best trial: 62. Best value: 0.471278:  84%|████████▍ | 84/100 [03:37<00:32,  2.03s/it]Best trial: 62. Best value: 0.471278:  85%|████████▌ | 85/100 [03:37<00:33,  2.23s/it]Best trial: 62. Best value: 0.471278:  85%|████████▌ | 85/100 [03:38<00:33,  2.23s/it]Best trial: 62. Best value: 0.471278:  86%|████████▌ | 86/100 [03:38<00:26,  1.91s/it]Best trial: 62. Best value: 0.471278:  86%|████████▌ | 86/100 [03:41<00:26,  1.91s/it]Best trial: 62. Best value: 0.471278:  87%|████████▋ | 87/100 [03:41<00:26,  2.06s/it]Best trial: 62. Best value: 0.471278:  87%|████████▋ | 87/100 [03:44<00:26,  2.06s/it]Best trial: 62. Best value: 0.471278:  88%|████████▊ | 88/100 [03:44<00:27,  2.30s/it]Best trial: 62. Best value: 0.471278:  88%|████████▊ | 88/100 [03:46<00:27,  2.30s/it]Best trial: 62. Best value: 0.471278:  89%|████████▉ | 89/100 [03:46<00:24,  2.19s/it]Best trial: 62. Best value: 0.471278:  89%|████████▉ | 89/100 [03:49<00:24,  2.19s/it]Best trial: 62. Best value: 0.471278:  90%|█████████ | 90/100 [03:49<00:24,  2.50s/it]Best trial: 62. Best value: 0.471278:  90%|█████████ | 90/100 [03:51<00:24,  2.50s/it]Best trial: 62. Best value: 0.471278:  91%|█████████ | 91/100 [03:51<00:20,  2.30s/it]Best trial: 91. Best value: 0.49523:  91%|█████████ | 91/100 [03:54<00:20,  2.30s/it] Best trial: 91. Best value: 0.49523:  92%|█████████▏| 92/100 [03:54<00:21,  2.72s/it]Best trial: 91. Best value: 0.49523:  92%|█████████▏| 92/100 [03:57<00:21,  2.72s/it]Best trial: 91. Best value: 0.49523:  93%|█████████▎| 93/100 [03:57<00:18,  2.59s/it]Best trial: 91. Best value: 0.49523:  93%|█████████▎| 93/100 [04:00<00:18,  2.59s/it]Best trial: 91. Best value: 0.49523:  94%|█████████▍| 94/100 [04:00<00:16,  2.82s/it]Best trial: 91. Best value: 0.49523:  94%|█████████▍| 94/100 [04:02<00:16,  2.82s/it]Best trial: 91. Best value: 0.49523:  95%|█████████▌| 95/100 [04:02<00:12,  2.56s/it]Best trial: 91. Best value: 0.49523:  95%|█████████▌| 95/100 [04:04<00:12,  2.56s/it]Best trial: 91. Best value: 0.49523:  96%|█████████▌| 96/100 [04:04<00:10,  2.51s/it]Best trial: 91. Best value: 0.49523:  96%|█████████▌| 96/100 [04:08<00:10,  2.51s/it]Best trial: 91. Best value: 0.49523:  97%|█████████▋| 97/100 [04:08<00:08,  2.70s/it]Best trial: 91. Best value: 0.49523:  97%|█████████▋| 97/100 [04:09<00:08,  2.70s/it]Best trial: 91. Best value: 0.49523:  98%|█████████▊| 98/100 [04:09<00:04,  2.42s/it]Best trial: 91. Best value: 0.49523:  98%|█████████▊| 98/100 [04:11<00:04,  2.42s/it]Best trial: 91. Best value: 0.49523:  99%|█████████▉| 99/100 [04:11<00:02,  2.28s/it]Best trial: 91. Best value: 0.49523:  99%|█████████▉| 99/100 [04:13<00:02,  2.28s/it]Best trial: 91. Best value: 0.49523: 100%|██████████| 100/100 [04:13<00:00,  2.22s/it]Best trial: 91. Best value: 0.49523: 100%|██████████| 100/100 [04:13<00:00,  2.54s/it]
2025-11-30 12:12:58,370 - INFO - HPO Complete. Best AUPRC: 0.4952
2025-11-30 12:12:58,370 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.06867410683096893, 'max_depth': 9, 'subsample': 0.8048692650474022, 'colsample_bytree': 0.6486478148197511, 'gamma': 0.10357784103071221, 'reg_lambda': 0.0023996172279729827, 'reg_alpha': 4.4640161557779415e-06}
2025-11-30 12:12:58,371 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:13:00,528 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 12:13:00,528 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:13:00,640 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:13:00,663 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:13:00,668 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 12:13:00,668 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:13:00,669 - INFO - Training model...
2025-11-30 12:13:01,809 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:13:07,074 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:13:07,074 - INFO - AUROC: 0.7192 (0.5674 - 0.8819)
2025-11-30 12:13:07,074 - INFO - AUPRC: 0.2190 (0.0227 - 0.4761)
2025-11-30 12:13:07,074 - INFO - Brier Score: 0.0146 (0.0092 - 0.0249)
2025-11-30 12:13:07,074 - INFO - Accuracy: 0.9798 (0.9506 - 0.9931)
2025-11-30 12:13:07,074 - INFO - Precision: 0.3000 (0.0462 - 1.0000)
2025-11-30 12:13:07,074 - INFO - Sensitivity (Recall): 0.3000 (0.0667 - 0.5000)
2025-11-30 12:13:07,075 - INFO - F1-Score: 0.3000 (0.0600 - 0.6095)
2025-11-30 12:13:07,075 - INFO - Best Threshold: 0.0800 (0.0220 - 0.9800)
2025-11-30 12:13:07,075 - INFO - Specificity: 0.9897 (0.9651 - 1.0000)
2025-11-30 12:13:07,082 - INFO - Calculating SHAP values...
2025-11-30 12:13:08,021 - INFO - SHAP plots saved.
2025-11-30 12:13:08,022 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:13:09,621 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 12:13:09,622 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:13:09,731 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:13:09,767 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:13:09,776 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:13:09,776 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.154668:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.154668:   1%|          | 1/100 [00:02<04:31,  2.74s/it]Best trial: 1. Best value: 0.310278:   1%|          | 1/100 [00:07<04:31,  2.74s/it]Best trial: 1. Best value: 0.310278:   2%|▏         | 2/100 [00:07<06:05,  3.73s/it]Best trial: 2. Best value: 0.321591:   2%|▏         | 2/100 [00:11<06:05,  3.73s/it]Best trial: 2. Best value: 0.321591:   3%|▎         | 3/100 [00:11<06:14,  3.86s/it]Best trial: 2. Best value: 0.321591:   3%|▎         | 3/100 [00:14<06:14,  3.86s/it]Best trial: 2. Best value: 0.321591:   4%|▍         | 4/100 [00:14<05:38,  3.53s/it]Best trial: 2. Best value: 0.321591:   4%|▍         | 4/100 [00:18<05:38,  3.53s/it]Best trial: 2. Best value: 0.321591:   5%|▌         | 5/100 [00:18<05:53,  3.72s/it]Best trial: 2. Best value: 0.321591:   5%|▌         | 5/100 [00:20<05:53,  3.72s/it]Best trial: 2. Best value: 0.321591:   6%|▌         | 6/100 [00:20<04:58,  3.18s/it]Best trial: 2. Best value: 0.321591:   6%|▌         | 6/100 [00:23<04:58,  3.18s/it]Best trial: 2. Best value: 0.321591:   7%|▋         | 7/100 [00:23<04:40,  3.02s/it]Best trial: 2. Best value: 0.321591:   7%|▋         | 7/100 [00:26<04:40,  3.02s/it]Best trial: 2. Best value: 0.321591:   8%|▊         | 8/100 [00:26<04:57,  3.23s/it]Best trial: 8. Best value: 0.324303:   8%|▊         | 8/100 [00:30<04:57,  3.23s/it]Best trial: 8. Best value: 0.324303:   9%|▉         | 9/100 [00:30<05:21,  3.53s/it]Best trial: 8. Best value: 0.324303:   9%|▉         | 9/100 [00:35<05:21,  3.53s/it]Best trial: 8. Best value: 0.324303:  10%|█         | 10/100 [00:35<05:43,  3.82s/it]Best trial: 8. Best value: 0.324303:  10%|█         | 10/100 [00:38<05:43,  3.82s/it]Best trial: 8. Best value: 0.324303:  11%|█         | 11/100 [00:38<05:07,  3.46s/it]Best trial: 11. Best value: 0.339018:  11%|█         | 11/100 [00:41<05:07,  3.46s/it]Best trial: 11. Best value: 0.339018:  12%|█▏        | 12/100 [00:41<04:56,  3.37s/it]Best trial: 11. Best value: 0.339018:  12%|█▏        | 12/100 [00:43<04:56,  3.37s/it]Best trial: 11. Best value: 0.339018:  13%|█▎        | 13/100 [00:43<04:33,  3.14s/it]Best trial: 11. Best value: 0.339018:  13%|█▎        | 13/100 [00:47<04:33,  3.14s/it]Best trial: 11. Best value: 0.339018:  14%|█▍        | 14/100 [00:47<04:33,  3.18s/it]Best trial: 11. Best value: 0.339018:  14%|█▍        | 14/100 [00:49<04:33,  3.18s/it]Best trial: 11. Best value: 0.339018:  15%|█▌        | 15/100 [00:49<04:21,  3.07s/it]Best trial: 11. Best value: 0.339018:  15%|█▌        | 15/100 [00:52<04:21,  3.07s/it]Best trial: 11. Best value: 0.339018:  16%|█▌        | 16/100 [00:52<04:10,  2.98s/it]Best trial: 11. Best value: 0.339018:  16%|█▌        | 16/100 [00:55<04:10,  2.98s/it]Best trial: 11. Best value: 0.339018:  17%|█▋        | 17/100 [00:55<03:57,  2.87s/it]Best trial: 11. Best value: 0.339018:  17%|█▋        | 17/100 [00:59<03:57,  2.87s/it]Best trial: 11. Best value: 0.339018:  18%|█▊        | 18/100 [00:59<04:37,  3.39s/it]Best trial: 11. Best value: 0.339018:  18%|█▊        | 18/100 [01:02<04:37,  3.39s/it]Best trial: 11. Best value: 0.339018:  19%|█▉        | 19/100 [01:02<04:15,  3.16s/it]Best trial: 11. Best value: 0.339018:  19%|█▉        | 19/100 [01:04<04:15,  3.16s/it]Best trial: 11. Best value: 0.339018:  20%|██        | 20/100 [01:04<03:43,  2.79s/it]Best trial: 11. Best value: 0.339018:  20%|██        | 20/100 [01:06<03:43,  2.79s/it]Best trial: 11. Best value: 0.339018:  21%|██        | 21/100 [01:06<03:19,  2.53s/it]Best trial: 11. Best value: 0.339018:  21%|██        | 21/100 [01:09<03:19,  2.53s/it]Best trial: 11. Best value: 0.339018:  22%|██▏       | 22/100 [01:09<03:37,  2.78s/it]Best trial: 11. Best value: 0.339018:  22%|██▏       | 22/100 [01:13<03:37,  2.78s/it]Best trial: 11. Best value: 0.339018:  23%|██▎       | 23/100 [01:13<03:49,  2.98s/it]Best trial: 23. Best value: 0.357445:  23%|██▎       | 23/100 [01:16<03:49,  2.98s/it]Best trial: 23. Best value: 0.357445:  24%|██▍       | 24/100 [01:16<03:52,  3.06s/it]Best trial: 23. Best value: 0.357445:  24%|██▍       | 24/100 [01:19<03:52,  3.06s/it]Best trial: 23. Best value: 0.357445:  25%|██▌       | 25/100 [01:19<03:45,  3.01s/it]Best trial: 23. Best value: 0.357445:  25%|██▌       | 25/100 [01:22<03:45,  3.01s/it]Best trial: 23. Best value: 0.357445:  26%|██▌       | 26/100 [01:22<03:36,  2.92s/it]Best trial: 23. Best value: 0.357445:  26%|██▌       | 26/100 [01:25<03:36,  2.92s/it]Best trial: 23. Best value: 0.357445:  27%|██▋       | 27/100 [01:25<03:53,  3.19s/it]Best trial: 23. Best value: 0.357445:  27%|██▋       | 27/100 [01:29<03:53,  3.19s/it]Best trial: 23. Best value: 0.357445:  28%|██▊       | 28/100 [01:29<03:54,  3.26s/it]Best trial: 23. Best value: 0.357445:  28%|██▊       | 28/100 [01:38<03:54,  3.26s/it]Best trial: 23. Best value: 0.357445:  29%|██▉       | 29/100 [01:38<05:56,  5.03s/it]Best trial: 23. Best value: 0.357445:  29%|██▉       | 29/100 [01:44<05:56,  5.03s/it]Best trial: 23. Best value: 0.357445:  30%|███       | 30/100 [01:44<06:10,  5.29s/it]Best trial: 23. Best value: 0.357445:  30%|███       | 30/100 [01:51<06:10,  5.29s/it]Best trial: 23. Best value: 0.357445:  31%|███       | 31/100 [01:51<06:52,  5.98s/it]Best trial: 23. Best value: 0.357445:  31%|███       | 31/100 [01:59<06:52,  5.98s/it]Best trial: 23. Best value: 0.357445:  32%|███▏      | 32/100 [01:59<07:23,  6.52s/it]Best trial: 23. Best value: 0.357445:  32%|███▏      | 32/100 [02:11<07:23,  6.52s/it]Best trial: 23. Best value: 0.357445:  33%|███▎      | 33/100 [02:11<09:11,  8.23s/it]Best trial: 23. Best value: 0.357445:  33%|███▎      | 33/100 [02:15<09:11,  8.23s/it]Best trial: 23. Best value: 0.357445:  34%|███▍      | 34/100 [02:15<07:24,  6.74s/it]Best trial: 23. Best value: 0.357445:  34%|███▍      | 34/100 [02:21<07:24,  6.74s/it]Best trial: 23. Best value: 0.357445:  35%|███▌      | 35/100 [02:21<07:12,  6.65s/it]Best trial: 23. Best value: 0.357445:  35%|███▌      | 35/100 [02:32<07:12,  6.65s/it]Best trial: 23. Best value: 0.357445:  36%|███▌      | 36/100 [02:32<08:18,  7.79s/it]Best trial: 23. Best value: 0.357445:  36%|███▌      | 36/100 [02:38<08:18,  7.79s/it]Best trial: 23. Best value: 0.357445:  37%|███▋      | 37/100 [02:38<07:50,  7.47s/it]Best trial: 23. Best value: 0.357445:  37%|███▋      | 37/100 [02:45<07:50,  7.47s/it]Best trial: 23. Best value: 0.357445:  38%|███▊      | 38/100 [02:45<07:28,  7.23s/it]Best trial: 23. Best value: 0.357445:  38%|███▊      | 38/100 [02:50<07:28,  7.23s/it]Best trial: 23. Best value: 0.357445:  39%|███▉      | 39/100 [02:50<06:47,  6.68s/it]Best trial: 23. Best value: 0.357445:  39%|███▉      | 39/100 [02:57<06:47,  6.68s/it]Best trial: 23. Best value: 0.357445:  40%|████      | 40/100 [02:57<06:38,  6.64s/it]Best trial: 23. Best value: 0.357445:  40%|████      | 40/100 [03:02<06:38,  6.64s/it]Best trial: 23. Best value: 0.357445:  41%|████      | 41/100 [03:02<05:58,  6.08s/it]Best trial: 23. Best value: 0.357445:  41%|████      | 41/100 [03:09<05:58,  6.08s/it]Best trial: 23. Best value: 0.357445:  42%|████▏     | 42/100 [03:09<06:16,  6.49s/it]Best trial: 23. Best value: 0.357445:  42%|████▏     | 42/100 [03:18<06:16,  6.49s/it]Best trial: 23. Best value: 0.357445:  43%|████▎     | 43/100 [03:18<06:51,  7.21s/it]Best trial: 23. Best value: 0.357445:  43%|████▎     | 43/100 [03:22<06:51,  7.21s/it]Best trial: 23. Best value: 0.357445:  44%|████▍     | 44/100 [03:22<05:47,  6.20s/it]Best trial: 23. Best value: 0.357445:  44%|████▍     | 44/100 [03:27<05:47,  6.20s/it]Best trial: 23. Best value: 0.357445:  45%|████▌     | 45/100 [03:27<05:25,  5.92s/it]Best trial: 23. Best value: 0.357445:  45%|████▌     | 45/100 [03:35<05:25,  5.92s/it]Best trial: 23. Best value: 0.357445:  46%|████▌     | 46/100 [03:35<05:50,  6.49s/it]Best trial: 23. Best value: 0.357445:  46%|████▌     | 46/100 [03:43<05:50,  6.49s/it]Best trial: 23. Best value: 0.357445:  47%|████▋     | 47/100 [03:43<06:01,  6.83s/it]Best trial: 23. Best value: 0.357445:  47%|████▋     | 47/100 [03:47<06:01,  6.83s/it]Best trial: 23. Best value: 0.357445:  48%|████▊     | 48/100 [03:47<05:17,  6.11s/it]Best trial: 23. Best value: 0.357445:  48%|████▊     | 48/100 [03:54<05:17,  6.11s/it]Best trial: 23. Best value: 0.357445:  49%|████▉     | 49/100 [03:54<05:20,  6.29s/it]Best trial: 23. Best value: 0.357445:  49%|████▉     | 49/100 [03:57<05:20,  6.29s/it]Best trial: 23. Best value: 0.357445:  50%|█████     | 50/100 [03:57<04:25,  5.32s/it]Best trial: 23. Best value: 0.357445:  50%|█████     | 50/100 [04:04<04:25,  5.32s/it]Best trial: 23. Best value: 0.357445:  51%|█████     | 51/100 [04:04<04:46,  5.85s/it]Best trial: 23. Best value: 0.357445:  51%|█████     | 51/100 [04:10<04:46,  5.85s/it]Best trial: 23. Best value: 0.357445:  52%|█████▏    | 52/100 [04:10<04:47,  5.99s/it]Best trial: 23. Best value: 0.357445:  52%|█████▏    | 52/100 [04:16<04:47,  5.99s/it]Best trial: 23. Best value: 0.357445:  53%|█████▎    | 53/100 [04:16<04:37,  5.91s/it]Best trial: 23. Best value: 0.357445:  53%|█████▎    | 53/100 [04:22<04:37,  5.91s/it]Best trial: 23. Best value: 0.357445:  54%|█████▍    | 54/100 [04:22<04:40,  6.09s/it]Best trial: 23. Best value: 0.357445:  54%|█████▍    | 54/100 [04:29<04:40,  6.09s/it]Best trial: 23. Best value: 0.357445:  55%|█████▌    | 55/100 [04:29<04:43,  6.31s/it]Best trial: 23. Best value: 0.357445:  55%|█████▌    | 55/100 [04:35<04:43,  6.31s/it]Best trial: 23. Best value: 0.357445:  56%|█████▌    | 56/100 [04:35<04:33,  6.21s/it]Best trial: 23. Best value: 0.357445:  56%|█████▌    | 56/100 [04:46<04:33,  6.21s/it]Best trial: 23. Best value: 0.357445:  57%|█████▋    | 57/100 [04:46<05:22,  7.50s/it]Best trial: 23. Best value: 0.357445:  57%|█████▋    | 57/100 [04:49<05:22,  7.50s/it]Best trial: 23. Best value: 0.357445:  58%|█████▊    | 58/100 [04:49<04:23,  6.26s/it]Best trial: 23. Best value: 0.357445:  58%|█████▊    | 58/100 [04:54<04:23,  6.26s/it]Best trial: 23. Best value: 0.357445:  59%|█████▉    | 59/100 [04:54<03:56,  5.77s/it]Best trial: 23. Best value: 0.357445:  59%|█████▉    | 59/100 [04:57<03:56,  5.77s/it]Best trial: 23. Best value: 0.357445:  60%|██████    | 60/100 [04:57<03:25,  5.13s/it]Best trial: 23. Best value: 0.357445:  60%|██████    | 60/100 [05:03<03:25,  5.13s/it]Best trial: 23. Best value: 0.357445:  61%|██████    | 61/100 [05:03<03:25,  5.27s/it]Best trial: 23. Best value: 0.357445:  61%|██████    | 61/100 [05:08<03:25,  5.27s/it]Best trial: 23. Best value: 0.357445:  62%|██████▏   | 62/100 [05:08<03:23,  5.35s/it]Best trial: 62. Best value: 0.383427:  62%|██████▏   | 62/100 [05:16<03:23,  5.35s/it]Best trial: 62. Best value: 0.383427:  63%|██████▎   | 63/100 [05:16<03:41,  5.98s/it]Best trial: 62. Best value: 0.383427:  63%|██████▎   | 63/100 [05:23<03:41,  5.98s/it]Best trial: 62. Best value: 0.383427:  64%|██████▍   | 64/100 [05:23<03:44,  6.24s/it]Best trial: 62. Best value: 0.383427:  64%|██████▍   | 64/100 [05:29<03:44,  6.24s/it]Best trial: 62. Best value: 0.383427:  65%|██████▌   | 65/100 [05:29<03:38,  6.24s/it]Best trial: 62. Best value: 0.383427:  65%|██████▌   | 65/100 [05:41<03:38,  6.24s/it]Best trial: 62. Best value: 0.383427:  66%|██████▌   | 66/100 [05:41<04:28,  7.90s/it]Best trial: 62. Best value: 0.383427:  66%|██████▌   | 66/100 [05:46<04:28,  7.90s/it]Best trial: 62. Best value: 0.383427:  67%|██████▋   | 67/100 [05:46<03:50,  6.98s/it]Best trial: 62. Best value: 0.383427:  67%|██████▋   | 67/100 [05:50<03:50,  6.98s/it]Best trial: 62. Best value: 0.383427:  68%|██████▊   | 68/100 [05:50<03:15,  6.10s/it]Best trial: 62. Best value: 0.383427:  68%|██████▊   | 68/100 [05:53<03:15,  6.10s/it]Best trial: 62. Best value: 0.383427:  69%|██████▉   | 69/100 [05:53<02:47,  5.40s/it]Best trial: 62. Best value: 0.383427:  69%|██████▉   | 69/100 [06:01<02:47,  5.40s/it]Best trial: 62. Best value: 0.383427:  70%|███████   | 70/100 [06:01<03:01,  6.07s/it]Best trial: 62. Best value: 0.383427:  70%|███████   | 70/100 [06:08<03:01,  6.07s/it]Best trial: 62. Best value: 0.383427:  71%|███████   | 71/100 [06:08<03:05,  6.40s/it]Best trial: 62. Best value: 0.383427:  71%|███████   | 71/100 [06:13<03:05,  6.40s/it]Best trial: 62. Best value: 0.383427:  72%|███████▏  | 72/100 [06:13<02:46,  5.96s/it]Best trial: 62. Best value: 0.383427:  72%|███████▏  | 72/100 [06:18<02:46,  5.96s/it]Best trial: 62. Best value: 0.383427:  73%|███████▎  | 73/100 [06:18<02:28,  5.52s/it]Best trial: 62. Best value: 0.383427:  73%|███████▎  | 73/100 [06:22<02:28,  5.52s/it]Best trial: 62. Best value: 0.383427:  74%|███████▍  | 74/100 [06:22<02:13,  5.15s/it]Best trial: 62. Best value: 0.383427:  74%|███████▍  | 74/100 [06:28<02:13,  5.15s/it]Best trial: 62. Best value: 0.383427:  75%|███████▌  | 75/100 [06:28<02:18,  5.53s/it]Best trial: 62. Best value: 0.383427:  75%|███████▌  | 75/100 [06:32<02:18,  5.53s/it]Best trial: 62. Best value: 0.383427:  76%|███████▌  | 76/100 [06:32<01:56,  4.87s/it]Best trial: 62. Best value: 0.383427:  76%|███████▌  | 76/100 [06:35<01:56,  4.87s/it]Best trial: 62. Best value: 0.383427:  77%|███████▋  | 77/100 [06:35<01:42,  4.44s/it]Best trial: 62. Best value: 0.383427:  77%|███████▋  | 77/100 [06:38<01:42,  4.44s/it]Best trial: 62. Best value: 0.383427:  78%|███████▊  | 78/100 [06:38<01:26,  3.93s/it]Best trial: 62. Best value: 0.383427:  78%|███████▊  | 78/100 [06:43<01:26,  3.93s/it]Best trial: 62. Best value: 0.383427:  79%|███████▉  | 79/100 [06:43<01:27,  4.18s/it]Best trial: 62. Best value: 0.383427:  79%|███████▉  | 79/100 [06:46<01:27,  4.18s/it]Best trial: 62. Best value: 0.383427:  80%|████████  | 80/100 [06:46<01:19,  3.97s/it]Best trial: 62. Best value: 0.383427:  80%|████████  | 80/100 [06:50<01:19,  3.97s/it]Best trial: 62. Best value: 0.383427:  81%|████████  | 81/100 [06:50<01:13,  3.86s/it]Best trial: 62. Best value: 0.383427:  81%|████████  | 81/100 [06:54<01:13,  3.86s/it]Best trial: 62. Best value: 0.383427:  82%|████████▏ | 82/100 [06:54<01:13,  4.06s/it]Best trial: 62. Best value: 0.383427:  82%|████████▏ | 82/100 [06:59<01:13,  4.06s/it]Best trial: 62. Best value: 0.383427:  83%|████████▎ | 83/100 [06:59<01:14,  4.39s/it]Best trial: 62. Best value: 0.383427:  83%|████████▎ | 83/100 [07:04<01:14,  4.39s/it]Best trial: 62. Best value: 0.383427:  84%|████████▍ | 84/100 [07:04<01:10,  4.40s/it]Best trial: 84. Best value: 0.39057:  84%|████████▍ | 84/100 [07:08<01:10,  4.40s/it] Best trial: 84. Best value: 0.39057:  85%|████████▌ | 85/100 [07:08<01:05,  4.39s/it]Best trial: 84. Best value: 0.39057:  85%|████████▌ | 85/100 [07:12<01:05,  4.39s/it]Best trial: 84. Best value: 0.39057:  86%|████████▌ | 86/100 [07:12<00:58,  4.14s/it]Best trial: 84. Best value: 0.39057:  86%|████████▌ | 86/100 [07:14<00:58,  4.14s/it]Best trial: 84. Best value: 0.39057:  87%|████████▋ | 87/100 [07:14<00:47,  3.65s/it]Best trial: 84. Best value: 0.39057:  87%|████████▋ | 87/100 [07:17<00:47,  3.65s/it]Best trial: 84. Best value: 0.39057:  88%|████████▊ | 88/100 [07:17<00:40,  3.42s/it]Best trial: 84. Best value: 0.39057:  88%|████████▊ | 88/100 [07:21<00:40,  3.42s/it]Best trial: 84. Best value: 0.39057:  89%|████████▉ | 89/100 [07:21<00:38,  3.47s/it]Best trial: 84. Best value: 0.39057:  89%|████████▉ | 89/100 [07:25<00:38,  3.47s/it]Best trial: 84. Best value: 0.39057:  90%|█████████ | 90/100 [07:25<00:35,  3.56s/it]Best trial: 84. Best value: 0.39057:  90%|█████████ | 90/100 [07:29<00:35,  3.56s/it]Best trial: 84. Best value: 0.39057:  91%|█████████ | 91/100 [07:29<00:34,  3.81s/it]Best trial: 84. Best value: 0.39057:  91%|█████████ | 91/100 [07:33<00:34,  3.81s/it]Best trial: 84. Best value: 0.39057:  92%|█████████▏| 92/100 [07:33<00:30,  3.83s/it]Best trial: 84. Best value: 0.39057:  92%|█████████▏| 92/100 [07:36<00:30,  3.83s/it]Best trial: 84. Best value: 0.39057:  93%|█████████▎| 93/100 [07:36<00:25,  3.68s/it]Best trial: 84. Best value: 0.39057:  93%|█████████▎| 93/100 [07:40<00:25,  3.68s/it]Best trial: 84. Best value: 0.39057:  94%|█████████▍| 94/100 [07:40<00:22,  3.79s/it]Best trial: 84. Best value: 0.39057:  94%|█████████▍| 94/100 [07:44<00:22,  3.79s/it]Best trial: 84. Best value: 0.39057:  95%|█████████▌| 95/100 [07:44<00:18,  3.69s/it]Best trial: 84. Best value: 0.39057:  95%|█████████▌| 95/100 [07:47<00:18,  3.69s/it]Best trial: 84. Best value: 0.39057:  96%|█████████▌| 96/100 [07:47<00:14,  3.53s/it]Best trial: 84. Best value: 0.39057:  96%|█████████▌| 96/100 [07:50<00:14,  3.53s/it]Best trial: 84. Best value: 0.39057:  97%|█████████▋| 97/100 [07:50<00:10,  3.34s/it]Best trial: 84. Best value: 0.39057:  97%|█████████▋| 97/100 [07:53<00:10,  3.34s/it]Best trial: 84. Best value: 0.39057:  98%|█████████▊| 98/100 [07:53<00:06,  3.27s/it]Best trial: 84. Best value: 0.39057:  98%|█████████▊| 98/100 [07:56<00:06,  3.27s/it]Best trial: 84. Best value: 0.39057:  99%|█████████▉| 99/100 [07:56<00:03,  3.19s/it]Best trial: 84. Best value: 0.39057:  99%|█████████▉| 99/100 [07:58<00:03,  3.19s/it]Best trial: 84. Best value: 0.39057: 100%|██████████| 100/100 [07:58<00:00,  2.90s/it]Best trial: 84. Best value: 0.39057: 100%|██████████| 100/100 [07:58<00:00,  4.79s/it]
2025-11-30 12:21:08,285 - INFO - HPO Complete. Best AUPRC: 0.3906
2025-11-30 12:21:08,285 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.07994140486164814, 'max_depth': 7, 'subsample': 0.9559285127874686, 'colsample_bytree': 0.6050373947620216, 'gamma': 2.3648873790977576, 'reg_lambda': 0.3107596536118396, 'reg_alpha': 0.08163659963992662}
2025-11-30 12:21:08,286 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:21:10,404 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 12:21:10,405 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:21:10,512 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:21:10,547 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:21:10,557 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:21:10,557 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:21:10,557 - INFO - Training model...
2025-11-30 12:21:11,737 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:21:17,191 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:21:17,191 - INFO - AUROC: 0.6812 (0.4963 - 0.8330)
2025-11-30 12:21:17,191 - INFO - AUPRC: 0.2312 (0.0289 - 0.4622)
2025-11-30 12:21:17,191 - INFO - Brier Score: 0.0136 (0.0087 - 0.0248)
2025-11-30 12:21:17,191 - INFO - Accuracy: 0.9769 (0.9090 - 0.9931)
2025-11-30 12:21:17,191 - INFO - Precision: 0.2857 (0.1059 - 1.0000)
2025-11-30 12:21:17,191 - INFO - Sensitivity (Recall): 0.4000 (0.0500 - 0.5667)
2025-11-30 12:21:17,191 - INFO - F1-Score: 0.3333 (0.0923 - 0.6095)
2025-11-30 12:21:17,191 - INFO - Best Threshold: 0.1200 (0.0580 - 0.9800)
2025-11-30 12:21:17,191 - INFO - Specificity: 0.9853 (0.9204 - 1.0000)
2025-11-30 12:21:17,201 - INFO - Calculating SHAP values...
2025-11-30 12:21:18,182 - INFO - SHAP plots saved.
2025-11-30 12:21:18,183 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:21:19,512 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 12:21:19,512 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:21:19,619 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:21:19,656 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:21:19,664 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:21:19,665 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.237784:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.237784:   1%|          | 1/100 [00:02<04:21,  2.64s/it]Best trial: 1. Best value: 0.282748:   1%|          | 1/100 [00:05<04:21,  2.64s/it]Best trial: 1. Best value: 0.282748:   2%|▏         | 2/100 [00:05<04:27,  2.73s/it]Best trial: 2. Best value: 0.387619:   2%|▏         | 2/100 [00:08<04:27,  2.73s/it]Best trial: 2. Best value: 0.387619:   3%|▎         | 3/100 [00:08<04:18,  2.67s/it]Best trial: 2. Best value: 0.387619:   3%|▎         | 3/100 [00:11<04:18,  2.67s/it]Best trial: 2. Best value: 0.387619:   4%|▍         | 4/100 [00:11<04:58,  3.11s/it]Best trial: 2. Best value: 0.387619:   4%|▍         | 4/100 [00:14<04:58,  3.11s/it]Best trial: 2. Best value: 0.387619:   5%|▌         | 5/100 [00:14<04:36,  2.92s/it]Best trial: 2. Best value: 0.387619:   5%|▌         | 5/100 [00:17<04:36,  2.92s/it]Best trial: 2. Best value: 0.387619:   6%|▌         | 6/100 [00:17<04:49,  3.08s/it]Best trial: 2. Best value: 0.387619:   6%|▌         | 6/100 [00:20<04:49,  3.08s/it]Best trial: 2. Best value: 0.387619:   7%|▋         | 7/100 [00:20<04:32,  2.93s/it]Best trial: 2. Best value: 0.387619:   7%|▋         | 7/100 [00:24<04:32,  2.93s/it]Best trial: 2. Best value: 0.387619:   8%|▊         | 8/100 [00:24<05:17,  3.45s/it]Best trial: 2. Best value: 0.387619:   8%|▊         | 8/100 [00:28<05:17,  3.45s/it]Best trial: 2. Best value: 0.387619:   9%|▉         | 9/100 [00:28<05:06,  3.37s/it]Best trial: 2. Best value: 0.387619:   9%|▉         | 9/100 [00:33<05:06,  3.37s/it]Best trial: 2. Best value: 0.387619:  10%|█         | 10/100 [00:33<05:50,  3.89s/it]Best trial: 2. Best value: 0.387619:  10%|█         | 10/100 [00:40<05:50,  3.89s/it]Best trial: 2. Best value: 0.387619:  11%|█         | 11/100 [00:40<07:19,  4.94s/it]Best trial: 2. Best value: 0.387619:  11%|█         | 11/100 [00:43<07:19,  4.94s/it]Best trial: 2. Best value: 0.387619:  12%|█▏        | 12/100 [00:43<06:24,  4.37s/it]Best trial: 2. Best value: 0.387619:  12%|█▏        | 12/100 [00:46<06:24,  4.37s/it]Best trial: 2. Best value: 0.387619:  13%|█▎        | 13/100 [00:46<05:46,  3.99s/it]Best trial: 2. Best value: 0.387619:  13%|█▎        | 13/100 [00:49<05:46,  3.99s/it]Best trial: 2. Best value: 0.387619:  14%|█▍        | 14/100 [00:49<05:08,  3.58s/it]Best trial: 2. Best value: 0.387619:  14%|█▍        | 14/100 [00:55<05:08,  3.58s/it]Best trial: 2. Best value: 0.387619:  15%|█▌        | 15/100 [00:55<06:19,  4.47s/it]Best trial: 2. Best value: 0.387619:  15%|█▌        | 15/100 [00:58<06:19,  4.47s/it]Best trial: 2. Best value: 0.387619:  16%|█▌        | 16/100 [00:58<05:40,  4.06s/it]Best trial: 2. Best value: 0.387619:  16%|█▌        | 16/100 [01:01<05:40,  4.06s/it]Best trial: 2. Best value: 0.387619:  17%|█▋        | 17/100 [01:01<04:51,  3.51s/it]Best trial: 2. Best value: 0.387619:  17%|█▋        | 17/100 [01:04<04:51,  3.51s/it]Best trial: 2. Best value: 0.387619:  18%|█▊        | 18/100 [01:04<04:49,  3.54s/it]Best trial: 2. Best value: 0.387619:  18%|█▊        | 18/100 [01:07<04:49,  3.54s/it]Best trial: 2. Best value: 0.387619:  19%|█▉        | 19/100 [01:07<04:24,  3.27s/it]Best trial: 2. Best value: 0.387619:  19%|█▉        | 19/100 [01:09<04:24,  3.27s/it]Best trial: 2. Best value: 0.387619:  20%|██        | 20/100 [01:09<03:57,  2.96s/it]Best trial: 2. Best value: 0.387619:  20%|██        | 20/100 [01:12<03:57,  2.96s/it]Best trial: 2. Best value: 0.387619:  21%|██        | 21/100 [01:12<03:55,  2.98s/it]Best trial: 2. Best value: 0.387619:  21%|██        | 21/100 [01:16<03:55,  2.98s/it]Best trial: 2. Best value: 0.387619:  22%|██▏       | 22/100 [01:16<04:08,  3.19s/it]Best trial: 2. Best value: 0.387619:  22%|██▏       | 22/100 [01:19<04:08,  3.19s/it]Best trial: 2. Best value: 0.387619:  23%|██▎       | 23/100 [01:19<04:05,  3.19s/it]Best trial: 2. Best value: 0.387619:  23%|██▎       | 23/100 [01:23<04:05,  3.19s/it]Best trial: 2. Best value: 0.387619:  24%|██▍       | 24/100 [01:23<04:13,  3.34s/it]Best trial: 2. Best value: 0.387619:  24%|██▍       | 24/100 [01:27<04:13,  3.34s/it]Best trial: 2. Best value: 0.387619:  25%|██▌       | 25/100 [01:27<04:41,  3.75s/it]Best trial: 2. Best value: 0.387619:  25%|██▌       | 25/100 [01:31<04:41,  3.75s/it]Best trial: 2. Best value: 0.387619:  26%|██▌       | 26/100 [01:31<04:23,  3.56s/it]Best trial: 2. Best value: 0.387619:  26%|██▌       | 26/100 [01:34<04:23,  3.56s/it]Best trial: 2. Best value: 0.387619:  27%|██▋       | 27/100 [01:34<04:20,  3.56s/it]Best trial: 2. Best value: 0.387619:  27%|██▋       | 27/100 [01:37<04:20,  3.56s/it]Best trial: 2. Best value: 0.387619:  28%|██▊       | 28/100 [01:37<04:07,  3.43s/it]Best trial: 2. Best value: 0.387619:  28%|██▊       | 28/100 [01:42<04:07,  3.43s/it]Best trial: 2. Best value: 0.387619:  29%|██▉       | 29/100 [01:42<04:36,  3.90s/it]Best trial: 2. Best value: 0.387619:  29%|██▉       | 29/100 [01:49<04:36,  3.90s/it]Best trial: 2. Best value: 0.387619:  30%|███       | 30/100 [01:49<05:31,  4.74s/it]Best trial: 2. Best value: 0.387619:  30%|███       | 30/100 [01:53<05:31,  4.74s/it]Best trial: 2. Best value: 0.387619:  31%|███       | 31/100 [01:53<05:17,  4.59s/it]Best trial: 2. Best value: 0.387619:  31%|███       | 31/100 [01:56<05:17,  4.59s/it]Best trial: 2. Best value: 0.387619:  32%|███▏      | 32/100 [01:56<04:41,  4.14s/it]Best trial: 2. Best value: 0.387619:  32%|███▏      | 32/100 [01:59<04:41,  4.14s/it]Best trial: 2. Best value: 0.387619:  33%|███▎      | 33/100 [01:59<04:17,  3.85s/it]Best trial: 2. Best value: 0.387619:  33%|███▎      | 33/100 [02:02<04:17,  3.85s/it]Best trial: 2. Best value: 0.387619:  34%|███▍      | 34/100 [02:02<03:56,  3.59s/it]Best trial: 2. Best value: 0.387619:  34%|███▍      | 34/100 [02:06<03:56,  3.59s/it]Best trial: 2. Best value: 0.387619:  35%|███▌      | 35/100 [02:06<03:45,  3.47s/it]Best trial: 2. Best value: 0.387619:  35%|███▌      | 35/100 [02:09<03:45,  3.47s/it]Best trial: 2. Best value: 0.387619:  36%|███▌      | 36/100 [02:09<03:30,  3.28s/it]Best trial: 2. Best value: 0.387619:  36%|███▌      | 36/100 [02:13<03:30,  3.28s/it]Best trial: 2. Best value: 0.387619:  37%|███▋      | 37/100 [02:13<03:52,  3.70s/it]Best trial: 2. Best value: 0.387619:  37%|███▋      | 37/100 [02:20<03:52,  3.70s/it]Best trial: 2. Best value: 0.387619:  38%|███▊      | 38/100 [02:20<04:44,  4.59s/it]Best trial: 2. Best value: 0.387619:  38%|███▊      | 38/100 [02:24<04:44,  4.59s/it]Best trial: 2. Best value: 0.387619:  39%|███▉      | 39/100 [02:24<04:29,  4.41s/it]Best trial: 2. Best value: 0.387619:  39%|███▉      | 39/100 [02:27<04:29,  4.41s/it]Best trial: 2. Best value: 0.387619:  40%|████      | 40/100 [02:27<04:08,  4.14s/it]Best trial: 2. Best value: 0.387619:  40%|████      | 40/100 [02:30<04:08,  4.14s/it]Best trial: 2. Best value: 0.387619:  41%|████      | 41/100 [02:30<03:46,  3.84s/it]Best trial: 2. Best value: 0.387619:  41%|████      | 41/100 [02:34<03:46,  3.84s/it]Best trial: 2. Best value: 0.387619:  42%|████▏     | 42/100 [02:34<03:29,  3.61s/it]Best trial: 2. Best value: 0.387619:  42%|████▏     | 42/100 [02:38<03:29,  3.61s/it]Best trial: 2. Best value: 0.387619:  43%|████▎     | 43/100 [02:38<03:31,  3.71s/it]Best trial: 2. Best value: 0.387619:  43%|████▎     | 43/100 [02:41<03:31,  3.71s/it]Best trial: 2. Best value: 0.387619:  44%|████▍     | 44/100 [02:41<03:24,  3.64s/it]Best trial: 2. Best value: 0.387619:  44%|████▍     | 44/100 [02:44<03:24,  3.64s/it]Best trial: 2. Best value: 0.387619:  45%|████▌     | 45/100 [02:44<03:15,  3.56s/it]Best trial: 2. Best value: 0.387619:  45%|████▌     | 45/100 [02:48<03:15,  3.56s/it]Best trial: 2. Best value: 0.387619:  46%|████▌     | 46/100 [02:48<03:15,  3.61s/it]Best trial: 2. Best value: 0.387619:  46%|████▌     | 46/100 [02:52<03:15,  3.61s/it]Best trial: 2. Best value: 0.387619:  47%|████▋     | 47/100 [02:52<03:23,  3.83s/it]Best trial: 2. Best value: 0.387619:  47%|████▋     | 47/100 [02:55<03:23,  3.83s/it]Best trial: 2. Best value: 0.387619:  48%|████▊     | 48/100 [02:55<02:52,  3.31s/it]Best trial: 2. Best value: 0.387619:  48%|████▊     | 48/100 [02:58<02:52,  3.31s/it]Best trial: 2. Best value: 0.387619:  49%|████▉     | 49/100 [02:58<02:48,  3.31s/it]Best trial: 2. Best value: 0.387619:  49%|████▉     | 49/100 [03:01<02:48,  3.31s/it]Best trial: 2. Best value: 0.387619:  50%|█████     | 50/100 [03:01<02:36,  3.12s/it]Best trial: 2. Best value: 0.387619:  50%|█████     | 50/100 [03:05<02:36,  3.12s/it]Best trial: 2. Best value: 0.387619:  51%|█████     | 51/100 [03:05<02:58,  3.63s/it]Best trial: 2. Best value: 0.387619:  51%|█████     | 51/100 [03:09<02:58,  3.63s/it]Best trial: 2. Best value: 0.387619:  52%|█████▏    | 52/100 [03:09<02:49,  3.53s/it]Best trial: 2. Best value: 0.387619:  52%|█████▏    | 52/100 [03:12<02:49,  3.53s/it]Best trial: 2. Best value: 0.387619:  53%|█████▎    | 53/100 [03:12<02:42,  3.45s/it]Best trial: 53. Best value: 0.397978:  53%|█████▎    | 53/100 [03:15<02:42,  3.45s/it]Best trial: 53. Best value: 0.397978:  54%|█████▍    | 54/100 [03:15<02:33,  3.33s/it]Best trial: 54. Best value: 0.400836:  54%|█████▍    | 54/100 [03:18<02:33,  3.33s/it]Best trial: 54. Best value: 0.400836:  55%|█████▌    | 55/100 [03:18<02:21,  3.14s/it]Best trial: 54. Best value: 0.400836:  55%|█████▌    | 55/100 [03:20<02:21,  3.14s/it]Best trial: 54. Best value: 0.400836:  56%|█████▌    | 56/100 [03:20<02:13,  3.02s/it]Best trial: 54. Best value: 0.400836:  56%|█████▌    | 56/100 [03:25<02:13,  3.02s/it]Best trial: 54. Best value: 0.400836:  57%|█████▋    | 57/100 [03:25<02:30,  3.49s/it]Best trial: 54. Best value: 0.400836:  57%|█████▋    | 57/100 [03:28<02:30,  3.49s/it]Best trial: 54. Best value: 0.400836:  58%|█████▊    | 58/100 [03:28<02:16,  3.25s/it]Best trial: 54. Best value: 0.400836:  58%|█████▊    | 58/100 [03:31<02:16,  3.25s/it]Best trial: 54. Best value: 0.400836:  59%|█████▉    | 59/100 [03:31<02:17,  3.35s/it]Best trial: 54. Best value: 0.400836:  59%|█████▉    | 59/100 [03:36<02:17,  3.35s/it]Best trial: 54. Best value: 0.400836:  60%|██████    | 60/100 [03:36<02:28,  3.70s/it]Best trial: 54. Best value: 0.400836:  60%|██████    | 60/100 [03:39<02:28,  3.70s/it]Best trial: 54. Best value: 0.400836:  61%|██████    | 61/100 [03:39<02:18,  3.56s/it]Best trial: 54. Best value: 0.400836:  61%|██████    | 61/100 [03:42<02:18,  3.56s/it]Best trial: 54. Best value: 0.400836:  62%|██████▏   | 62/100 [03:42<02:09,  3.42s/it]Best trial: 54. Best value: 0.400836:  62%|██████▏   | 62/100 [03:45<02:09,  3.42s/it]Best trial: 54. Best value: 0.400836:  63%|██████▎   | 63/100 [03:45<01:56,  3.14s/it]Best trial: 54. Best value: 0.400836:  63%|██████▎   | 63/100 [03:48<01:56,  3.14s/it]Best trial: 54. Best value: 0.400836:  64%|██████▍   | 64/100 [03:48<01:51,  3.10s/it]Best trial: 54. Best value: 0.400836:  64%|██████▍   | 64/100 [03:51<01:51,  3.10s/it]Best trial: 54. Best value: 0.400836:  65%|██████▌   | 65/100 [03:51<01:56,  3.33s/it]Best trial: 54. Best value: 0.400836:  65%|██████▌   | 65/100 [03:54<01:56,  3.33s/it]Best trial: 54. Best value: 0.400836:  66%|██████▌   | 66/100 [03:54<01:44,  3.08s/it]Best trial: 54. Best value: 0.400836:  66%|██████▌   | 66/100 [03:57<01:44,  3.08s/it]Best trial: 54. Best value: 0.400836:  67%|██████▋   | 67/100 [03:57<01:36,  2.93s/it]Best trial: 54. Best value: 0.400836:  67%|██████▋   | 67/100 [04:03<01:36,  2.93s/it]Best trial: 54. Best value: 0.400836:  68%|██████▊   | 68/100 [04:03<02:03,  3.87s/it]Best trial: 54. Best value: 0.400836:  68%|██████▊   | 68/100 [04:05<02:03,  3.87s/it]Best trial: 54. Best value: 0.400836:  69%|██████▉   | 69/100 [04:05<01:44,  3.38s/it]Best trial: 69. Best value: 0.411778:  69%|██████▉   | 69/100 [04:08<01:44,  3.38s/it]Best trial: 69. Best value: 0.411778:  70%|███████   | 70/100 [04:08<01:40,  3.34s/it]Best trial: 69. Best value: 0.411778:  70%|███████   | 70/100 [04:11<01:40,  3.34s/it]Best trial: 69. Best value: 0.411778:  71%|███████   | 71/100 [04:11<01:36,  3.31s/it]Best trial: 69. Best value: 0.411778:  71%|███████   | 71/100 [04:15<01:36,  3.31s/it]Best trial: 69. Best value: 0.411778:  72%|███████▏  | 72/100 [04:15<01:31,  3.28s/it]Best trial: 69. Best value: 0.411778:  72%|███████▏  | 72/100 [04:17<01:31,  3.28s/it]Best trial: 69. Best value: 0.411778:  73%|███████▎  | 73/100 [04:17<01:25,  3.18s/it]Best trial: 69. Best value: 0.411778:  73%|███████▎  | 73/100 [04:21<01:25,  3.18s/it]Best trial: 69. Best value: 0.411778:  74%|███████▍  | 74/100 [04:21<01:23,  3.22s/it]Best trial: 69. Best value: 0.411778:  74%|███████▍  | 74/100 [04:24<01:23,  3.22s/it]Best trial: 69. Best value: 0.411778:  75%|███████▌  | 75/100 [04:24<01:17,  3.11s/it]Best trial: 69. Best value: 0.411778:  75%|███████▌  | 75/100 [04:27<01:17,  3.11s/it]Best trial: 69. Best value: 0.411778:  76%|███████▌  | 76/100 [04:27<01:12,  3.03s/it]Best trial: 69. Best value: 0.411778:  76%|███████▌  | 76/100 [04:29<01:12,  3.03s/it]Best trial: 69. Best value: 0.411778:  77%|███████▋  | 77/100 [04:29<01:08,  3.00s/it]Best trial: 69. Best value: 0.411778:  77%|███████▋  | 77/100 [04:33<01:08,  3.00s/it]Best trial: 69. Best value: 0.411778:  78%|███████▊  | 78/100 [04:33<01:09,  3.17s/it]Best trial: 69. Best value: 0.411778:  78%|███████▊  | 78/100 [04:36<01:09,  3.17s/it]Best trial: 69. Best value: 0.411778:  79%|███████▉  | 79/100 [04:36<01:07,  3.23s/it]Best trial: 69. Best value: 0.411778:  79%|███████▉  | 79/100 [04:39<01:07,  3.23s/it]Best trial: 69. Best value: 0.411778:  80%|████████  | 80/100 [04:39<01:00,  3.04s/it]Best trial: 69. Best value: 0.411778:  80%|████████  | 80/100 [04:42<01:00,  3.04s/it]Best trial: 69. Best value: 0.411778:  81%|████████  | 81/100 [04:42<00:56,  2.95s/it]Best trial: 69. Best value: 0.411778:  81%|████████  | 81/100 [04:45<00:56,  2.95s/it]Best trial: 69. Best value: 0.411778:  82%|████████▏ | 82/100 [04:45<00:54,  3.00s/it]Best trial: 69. Best value: 0.411778:  82%|████████▏ | 82/100 [04:48<00:54,  3.00s/it]Best trial: 69. Best value: 0.411778:  83%|████████▎ | 83/100 [04:48<00:51,  3.02s/it]Best trial: 69. Best value: 0.411778:  83%|████████▎ | 83/100 [04:51<00:51,  3.02s/it]Best trial: 69. Best value: 0.411778:  84%|████████▍ | 84/100 [04:51<00:48,  3.06s/it]Best trial: 69. Best value: 0.411778:  84%|████████▍ | 84/100 [04:54<00:48,  3.06s/it]Best trial: 69. Best value: 0.411778:  85%|████████▌ | 85/100 [04:54<00:43,  2.93s/it]Best trial: 69. Best value: 0.411778:  85%|████████▌ | 85/100 [04:58<00:43,  2.93s/it]Best trial: 69. Best value: 0.411778:  86%|████████▌ | 86/100 [04:58<00:46,  3.33s/it]Best trial: 69. Best value: 0.411778:  86%|████████▌ | 86/100 [05:00<00:46,  3.33s/it]Best trial: 69. Best value: 0.411778:  87%|████████▋ | 87/100 [05:00<00:40,  3.08s/it]Best trial: 69. Best value: 0.411778:  87%|████████▋ | 87/100 [05:03<00:40,  3.08s/it]Best trial: 69. Best value: 0.411778:  88%|████████▊ | 88/100 [05:03<00:36,  3.02s/it]Best trial: 69. Best value: 0.411778:  88%|████████▊ | 88/100 [05:07<00:36,  3.02s/it]Best trial: 69. Best value: 0.411778:  89%|████████▉ | 89/100 [05:07<00:35,  3.22s/it]Best trial: 69. Best value: 0.411778:  89%|████████▉ | 89/100 [05:10<00:35,  3.22s/it]Best trial: 69. Best value: 0.411778:  90%|█████████ | 90/100 [05:10<00:31,  3.17s/it]Best trial: 69. Best value: 0.411778:  90%|█████████ | 90/100 [05:13<00:31,  3.17s/it]Best trial: 69. Best value: 0.411778:  91%|█████████ | 91/100 [05:13<00:27,  3.04s/it]Best trial: 69. Best value: 0.411778:  91%|█████████ | 91/100 [05:15<00:27,  3.04s/it]Best trial: 69. Best value: 0.411778:  92%|█████████▏| 92/100 [05:15<00:23,  2.92s/it]Best trial: 69. Best value: 0.411778:  92%|█████████▏| 92/100 [05:18<00:23,  2.92s/it]Best trial: 69. Best value: 0.411778:  93%|█████████▎| 93/100 [05:18<00:20,  2.96s/it]Best trial: 69. Best value: 0.411778:  93%|█████████▎| 93/100 [05:21<00:20,  2.96s/it]Best trial: 69. Best value: 0.411778:  94%|█████████▍| 94/100 [05:21<00:16,  2.78s/it]Best trial: 69. Best value: 0.411778:  94%|█████████▍| 94/100 [05:24<00:16,  2.78s/it]Best trial: 69. Best value: 0.411778:  95%|█████████▌| 95/100 [05:24<00:14,  2.85s/it]Best trial: 69. Best value: 0.411778:  95%|█████████▌| 95/100 [05:26<00:14,  2.85s/it]Best trial: 69. Best value: 0.411778:  96%|█████████▌| 96/100 [05:26<00:11,  2.77s/it]Best trial: 69. Best value: 0.411778:  96%|█████████▌| 96/100 [05:30<00:11,  2.77s/it]Best trial: 69. Best value: 0.411778:  97%|█████████▋| 97/100 [05:30<00:09,  3.10s/it]Best trial: 69. Best value: 0.411778:  97%|█████████▋| 97/100 [05:33<00:09,  3.10s/it]Best trial: 69. Best value: 0.411778:  98%|█████████▊| 98/100 [05:33<00:06,  3.04s/it]Best trial: 69. Best value: 0.411778:  98%|█████████▊| 98/100 [05:37<00:06,  3.04s/it]Best trial: 69. Best value: 0.411778:  99%|█████████▉| 99/100 [05:37<00:03,  3.27s/it]Best trial: 69. Best value: 0.411778:  99%|█████████▉| 99/100 [05:40<00:03,  3.27s/it]Best trial: 69. Best value: 0.411778: 100%|██████████| 100/100 [05:40<00:00,  3.08s/it]Best trial: 69. Best value: 0.411778: 100%|██████████| 100/100 [05:40<00:00,  3.40s/it]
2025-11-30 12:26:59,803 - INFO - HPO Complete. Best AUPRC: 0.4118
2025-11-30 12:26:59,803 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.005429957904202953, 'max_depth': 3, 'subsample': 0.6452902826299296, 'colsample_bytree': 0.6154907150954462, 'gamma': 1.1361571404479043, 'reg_lambda': 0.07652465318020232, 'reg_alpha': 2.0042552539691323e-07}
2025-11-30 12:26:59,804 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:27:01,695 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 12:27:01,695 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:27:01,785 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:27:01,816 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:27:01,826 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:27:01,826 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:27:01,826 - INFO - Training model...
2025-11-30 12:27:03,325 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:27:08,879 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:27:08,879 - INFO - AUROC: 0.6870 (0.4643 - 0.9068)
2025-11-30 12:27:08,879 - INFO - AUPRC: 0.2530 (0.0703 - 0.5109)
2025-11-30 12:27:08,879 - INFO - Brier Score: 0.0395 (0.0358 - 0.0452)
2025-11-30 12:27:08,879 - INFO - Accuracy: 0.9827 (0.8957 - 0.9931)
2025-11-30 12:27:08,879 - INFO - Precision: 0.4000 (0.1305 - 1.0000)
2025-11-30 12:27:08,879 - INFO - Sensitivity (Recall): 0.4000 (0.1495 - 0.6095)
2025-11-30 12:27:08,879 - INFO - F1-Score: 0.4000 (0.1243 - 0.6391)
2025-11-30 12:27:08,879 - INFO - Best Threshold: 0.6000 (0.4000 - 0.7340)
2025-11-30 12:27:08,879 - INFO - Specificity: 0.9912 (0.9038 - 1.0000)
2025-11-30 12:27:08,888 - INFO - Calculating SHAP values...
2025-11-30 12:27:09,849 - INFO - SHAP plots saved.
2025-11-30 12:27:09,850 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:27:11,032 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 12:27:11,032 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:27:11,117 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:27:11,148 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:27:11,156 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:27:11,156 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.228261:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.228261:   1%|          | 1/100 [00:03<05:35,  3.39s/it]Best trial: 1. Best value: 0.320041:   1%|          | 1/100 [00:07<05:35,  3.39s/it]Best trial: 1. Best value: 0.320041:   2%|▏         | 2/100 [00:07<05:57,  3.64s/it]Best trial: 1. Best value: 0.320041:   2%|▏         | 2/100 [00:10<05:57,  3.64s/it]Best trial: 1. Best value: 0.320041:   3%|▎         | 3/100 [00:10<05:39,  3.50s/it]Best trial: 1. Best value: 0.320041:   3%|▎         | 3/100 [00:16<05:39,  3.50s/it]Best trial: 1. Best value: 0.320041:   4%|▍         | 4/100 [00:16<06:50,  4.28s/it]Best trial: 1. Best value: 0.320041:   4%|▍         | 4/100 [00:18<06:50,  4.28s/it]Best trial: 1. Best value: 0.320041:   5%|▌         | 5/100 [00:18<05:31,  3.49s/it]Best trial: 1. Best value: 0.320041:   5%|▌         | 5/100 [00:21<05:31,  3.49s/it]Best trial: 1. Best value: 0.320041:   6%|▌         | 6/100 [00:21<05:19,  3.40s/it]Best trial: 1. Best value: 0.320041:   6%|▌         | 6/100 [00:23<05:19,  3.40s/it]Best trial: 1. Best value: 0.320041:   7%|▋         | 7/100 [00:23<04:43,  3.04s/it]Best trial: 1. Best value: 0.320041:   7%|▋         | 7/100 [00:26<04:43,  3.04s/it]Best trial: 1. Best value: 0.320041:   8%|▊         | 8/100 [00:26<04:30,  2.94s/it]Best trial: 1. Best value: 0.320041:   8%|▊         | 8/100 [00:29<04:30,  2.94s/it]Best trial: 1. Best value: 0.320041:   9%|▉         | 9/100 [00:29<04:28,  2.95s/it]Best trial: 1. Best value: 0.320041:   9%|▉         | 9/100 [00:31<04:28,  2.95s/it]Best trial: 1. Best value: 0.320041:  10%|█         | 10/100 [00:31<04:13,  2.81s/it]Best trial: 10. Best value: 0.347671:  10%|█         | 10/100 [00:38<04:13,  2.81s/it]Best trial: 10. Best value: 0.347671:  11%|█         | 11/100 [00:38<05:42,  3.85s/it]Best trial: 11. Best value: 0.352277:  11%|█         | 11/100 [00:41<05:42,  3.85s/it]Best trial: 11. Best value: 0.352277:  12%|█▏        | 12/100 [00:41<05:34,  3.80s/it]Best trial: 11. Best value: 0.352277:  12%|█▏        | 12/100 [00:45<05:34,  3.80s/it]Best trial: 11. Best value: 0.352277:  13%|█▎        | 13/100 [00:45<05:19,  3.68s/it]Best trial: 13. Best value: 0.369017:  13%|█▎        | 13/100 [00:47<05:19,  3.68s/it]Best trial: 13. Best value: 0.369017:  14%|█▍        | 14/100 [00:47<04:51,  3.39s/it]Best trial: 13. Best value: 0.369017:  14%|█▍        | 14/100 [00:50<04:51,  3.39s/it]Best trial: 13. Best value: 0.369017:  15%|█▌        | 15/100 [00:50<04:40,  3.30s/it]Best trial: 13. Best value: 0.369017:  15%|█▌        | 15/100 [00:55<04:40,  3.30s/it]Best trial: 13. Best value: 0.369017:  16%|█▌        | 16/100 [00:55<04:58,  3.56s/it]Best trial: 13. Best value: 0.369017:  16%|█▌        | 16/100 [00:58<04:58,  3.56s/it]Best trial: 13. Best value: 0.369017:  17%|█▋        | 17/100 [00:58<04:49,  3.48s/it]Best trial: 13. Best value: 0.369017:  17%|█▋        | 17/100 [01:02<04:49,  3.48s/it]Best trial: 13. Best value: 0.369017:  18%|█▊        | 18/100 [01:02<05:07,  3.76s/it]Best trial: 13. Best value: 0.369017:  18%|█▊        | 18/100 [01:05<05:07,  3.76s/it]Best trial: 13. Best value: 0.369017:  19%|█▉        | 19/100 [01:05<04:29,  3.33s/it]Best trial: 13. Best value: 0.369017:  19%|█▉        | 19/100 [01:11<04:29,  3.33s/it]Best trial: 13. Best value: 0.369017:  20%|██        | 20/100 [01:11<05:38,  4.23s/it]Best trial: 13. Best value: 0.369017:  20%|██        | 20/100 [01:14<05:38,  4.23s/it]Best trial: 13. Best value: 0.369017:  21%|██        | 21/100 [01:14<05:01,  3.82s/it]Best trial: 13. Best value: 0.369017:  21%|██        | 21/100 [01:17<05:01,  3.82s/it]Best trial: 13. Best value: 0.369017:  22%|██▏       | 22/100 [01:17<04:42,  3.62s/it]Best trial: 13. Best value: 0.369017:  22%|██▏       | 22/100 [01:21<04:42,  3.62s/it]Best trial: 13. Best value: 0.369017:  23%|██▎       | 23/100 [01:21<04:57,  3.86s/it]Best trial: 13. Best value: 0.369017:  23%|██▎       | 23/100 [01:25<04:57,  3.86s/it]Best trial: 13. Best value: 0.369017:  24%|██▍       | 24/100 [01:25<04:53,  3.87s/it]Best trial: 13. Best value: 0.369017:  24%|██▍       | 24/100 [01:29<04:53,  3.87s/it]Best trial: 13. Best value: 0.369017:  25%|██▌       | 25/100 [01:29<04:38,  3.72s/it]Best trial: 13. Best value: 0.369017:  25%|██▌       | 25/100 [01:31<04:38,  3.72s/it]Best trial: 13. Best value: 0.369017:  26%|██▌       | 26/100 [01:31<03:58,  3.22s/it]Best trial: 13. Best value: 0.369017:  26%|██▌       | 26/100 [01:34<03:58,  3.22s/it]Best trial: 13. Best value: 0.369017:  27%|██▋       | 27/100 [01:34<03:47,  3.12s/it]Best trial: 13. Best value: 0.369017:  27%|██▋       | 27/100 [01:40<03:47,  3.12s/it]Best trial: 13. Best value: 0.369017:  28%|██▊       | 28/100 [01:40<04:48,  4.00s/it]Best trial: 13. Best value: 0.369017:  28%|██▊       | 28/100 [01:44<04:48,  4.00s/it]Best trial: 13. Best value: 0.369017:  29%|██▉       | 29/100 [01:44<04:48,  4.06s/it]Best trial: 13. Best value: 0.369017:  29%|██▉       | 29/100 [01:47<04:48,  4.06s/it]Best trial: 13. Best value: 0.369017:  30%|███       | 30/100 [01:47<04:29,  3.84s/it]Best trial: 13. Best value: 0.369017:  30%|███       | 30/100 [01:54<04:29,  3.84s/it]Best trial: 13. Best value: 0.369017:  31%|███       | 31/100 [01:54<05:16,  4.59s/it]Best trial: 31. Best value: 0.378267:  31%|███       | 31/100 [01:58<05:16,  4.59s/it]Best trial: 31. Best value: 0.378267:  32%|███▏      | 32/100 [01:58<05:19,  4.70s/it]Best trial: 31. Best value: 0.378267:  32%|███▏      | 32/100 [02:03<05:19,  4.70s/it]Best trial: 31. Best value: 0.378267:  33%|███▎      | 33/100 [02:03<05:16,  4.72s/it]Best trial: 31. Best value: 0.378267:  33%|███▎      | 33/100 [02:08<05:16,  4.72s/it]Best trial: 31. Best value: 0.378267:  34%|███▍      | 34/100 [02:08<05:08,  4.68s/it]Best trial: 31. Best value: 0.378267:  34%|███▍      | 34/100 [02:12<05:08,  4.68s/it]Best trial: 31. Best value: 0.378267:  35%|███▌      | 35/100 [02:12<04:58,  4.59s/it]Best trial: 31. Best value: 0.378267:  35%|███▌      | 35/100 [02:16<04:58,  4.59s/it]Best trial: 31. Best value: 0.378267:  36%|███▌      | 36/100 [02:16<04:38,  4.35s/it]Best trial: 31. Best value: 0.378267:  36%|███▌      | 36/100 [02:22<04:38,  4.35s/it]Best trial: 31. Best value: 0.378267:  37%|███▋      | 37/100 [02:22<05:00,  4.77s/it]Best trial: 31. Best value: 0.378267:  37%|███▋      | 37/100 [02:25<05:00,  4.77s/it]Best trial: 31. Best value: 0.378267:  38%|███▊      | 38/100 [02:25<04:29,  4.34s/it]Best trial: 31. Best value: 0.378267:  38%|███▊      | 38/100 [02:29<04:29,  4.34s/it]Best trial: 31. Best value: 0.378267:  39%|███▉      | 39/100 [02:29<04:15,  4.20s/it]Best trial: 31. Best value: 0.378267:  39%|███▉      | 39/100 [02:36<04:15,  4.20s/it]Best trial: 31. Best value: 0.378267:  40%|████      | 40/100 [02:36<05:04,  5.07s/it]Best trial: 31. Best value: 0.378267:  40%|████      | 40/100 [02:41<05:04,  5.07s/it]Best trial: 31. Best value: 0.378267:  41%|████      | 41/100 [02:41<04:52,  4.96s/it]Best trial: 31. Best value: 0.378267:  41%|████      | 41/100 [02:45<04:52,  4.96s/it]Best trial: 31. Best value: 0.378267:  42%|████▏     | 42/100 [02:45<04:27,  4.61s/it]Best trial: 31. Best value: 0.378267:  42%|████▏     | 42/100 [02:48<04:27,  4.61s/it]Best trial: 31. Best value: 0.378267:  43%|████▎     | 43/100 [02:48<04:11,  4.41s/it]Best trial: 31. Best value: 0.378267:  43%|████▎     | 43/100 [02:52<04:11,  4.41s/it]Best trial: 31. Best value: 0.378267:  44%|████▍     | 44/100 [02:52<03:48,  4.08s/it]Best trial: 31. Best value: 0.378267:  44%|████▍     | 44/100 [02:56<03:48,  4.08s/it]Best trial: 31. Best value: 0.378267:  45%|████▌     | 45/100 [02:56<03:38,  3.97s/it]Best trial: 31. Best value: 0.378267:  45%|████▌     | 45/100 [03:02<03:38,  3.97s/it]Best trial: 31. Best value: 0.378267:  46%|████▌     | 46/100 [03:02<04:17,  4.77s/it]Best trial: 31. Best value: 0.378267:  46%|████▌     | 46/100 [03:07<04:17,  4.77s/it]Best trial: 31. Best value: 0.378267:  47%|████▋     | 47/100 [03:07<04:07,  4.67s/it]Best trial: 31. Best value: 0.378267:  47%|████▋     | 47/100 [03:11<04:07,  4.67s/it]Best trial: 31. Best value: 0.378267:  48%|████▊     | 48/100 [03:11<04:01,  4.65s/it]Best trial: 31. Best value: 0.378267:  48%|████▊     | 48/100 [03:15<04:01,  4.65s/it]Best trial: 31. Best value: 0.378267:  49%|████▉     | 49/100 [03:15<03:51,  4.54s/it]Best trial: 31. Best value: 0.378267:  49%|████▉     | 49/100 [03:19<03:51,  4.54s/it]Best trial: 31. Best value: 0.378267:  50%|█████     | 50/100 [03:19<03:25,  4.11s/it]Best trial: 31. Best value: 0.378267:  50%|█████     | 50/100 [03:22<03:25,  4.11s/it]Best trial: 31. Best value: 0.378267:  51%|█████     | 51/100 [03:22<03:05,  3.79s/it]Best trial: 31. Best value: 0.378267:  51%|█████     | 51/100 [03:25<03:05,  3.79s/it]Best trial: 31. Best value: 0.378267:  52%|█████▏    | 52/100 [03:25<03:00,  3.77s/it]Best trial: 31. Best value: 0.378267:  52%|█████▏    | 52/100 [03:30<03:00,  3.77s/it]Best trial: 31. Best value: 0.378267:  53%|█████▎    | 53/100 [03:30<03:12,  4.09s/it]Best trial: 31. Best value: 0.378267:  53%|█████▎    | 53/100 [03:33<03:12,  4.09s/it]Best trial: 31. Best value: 0.378267:  54%|█████▍    | 54/100 [03:33<02:56,  3.85s/it]Best trial: 31. Best value: 0.378267:  54%|█████▍    | 54/100 [03:37<02:56,  3.85s/it]Best trial: 31. Best value: 0.378267:  55%|█████▌    | 55/100 [03:37<02:45,  3.68s/it]Best trial: 31. Best value: 0.378267:  55%|█████▌    | 55/100 [03:40<02:45,  3.68s/it]Best trial: 31. Best value: 0.378267:  56%|█████▌    | 56/100 [03:40<02:30,  3.42s/it]Best trial: 31. Best value: 0.378267:  56%|█████▌    | 56/100 [03:42<02:30,  3.42s/it]Best trial: 31. Best value: 0.378267:  57%|█████▋    | 57/100 [03:42<02:18,  3.21s/it]Best trial: 31. Best value: 0.378267:  57%|█████▋    | 57/100 [03:46<02:18,  3.21s/it]Best trial: 31. Best value: 0.378267:  58%|█████▊    | 58/100 [03:46<02:18,  3.29s/it]Best trial: 31. Best value: 0.378267:  58%|█████▊    | 58/100 [03:49<02:18,  3.29s/it]Best trial: 31. Best value: 0.378267:  59%|█████▉    | 59/100 [03:49<02:15,  3.31s/it]Best trial: 31. Best value: 0.378267:  59%|█████▉    | 59/100 [03:52<02:15,  3.31s/it]Best trial: 31. Best value: 0.378267:  60%|██████    | 60/100 [03:52<02:03,  3.09s/it]Best trial: 31. Best value: 0.378267:  60%|██████    | 60/100 [03:54<02:03,  3.09s/it]Best trial: 31. Best value: 0.378267:  61%|██████    | 61/100 [03:54<01:56,  2.98s/it]Best trial: 61. Best value: 0.391725:  61%|██████    | 61/100 [03:58<01:56,  2.98s/it]Best trial: 61. Best value: 0.391725:  62%|██████▏   | 62/100 [03:58<02:02,  3.23s/it]Best trial: 62. Best value: 0.393154:  62%|██████▏   | 62/100 [04:04<02:02,  3.23s/it]Best trial: 62. Best value: 0.393154:  63%|██████▎   | 63/100 [04:04<02:23,  3.87s/it]Best trial: 62. Best value: 0.393154:  63%|██████▎   | 63/100 [04:09<02:23,  3.87s/it]Best trial: 62. Best value: 0.393154:  64%|██████▍   | 64/100 [04:09<02:33,  4.27s/it]Best trial: 62. Best value: 0.393154:  64%|██████▍   | 64/100 [04:15<02:33,  4.27s/it]Best trial: 62. Best value: 0.393154:  65%|██████▌   | 65/100 [04:15<02:51,  4.90s/it]Best trial: 62. Best value: 0.393154:  65%|██████▌   | 65/100 [04:19<02:51,  4.90s/it]Best trial: 62. Best value: 0.393154:  66%|██████▌   | 66/100 [04:19<02:30,  4.43s/it]Best trial: 62. Best value: 0.393154:  66%|██████▌   | 66/100 [04:21<02:30,  4.43s/it]Best trial: 62. Best value: 0.393154:  67%|██████▋   | 67/100 [04:21<02:10,  3.96s/it]Best trial: 62. Best value: 0.393154:  67%|██████▋   | 67/100 [04:26<02:10,  3.96s/it]Best trial: 62. Best value: 0.393154:  68%|██████▊   | 68/100 [04:26<02:14,  4.21s/it]Best trial: 62. Best value: 0.393154:  68%|██████▊   | 68/100 [04:29<02:14,  4.21s/it]Best trial: 62. Best value: 0.393154:  69%|██████▉   | 69/100 [04:29<01:58,  3.83s/it]Best trial: 62. Best value: 0.393154:  69%|██████▉   | 69/100 [04:33<01:58,  3.83s/it]Best trial: 62. Best value: 0.393154:  70%|███████   | 70/100 [04:33<01:51,  3.71s/it]Best trial: 62. Best value: 0.393154:  70%|███████   | 70/100 [04:37<01:51,  3.71s/it]Best trial: 62. Best value: 0.393154:  71%|███████   | 71/100 [04:37<01:57,  4.03s/it]Best trial: 62. Best value: 0.393154:  71%|███████   | 71/100 [04:41<01:57,  4.03s/it]Best trial: 62. Best value: 0.393154:  72%|███████▏  | 72/100 [04:41<01:50,  3.95s/it]Best trial: 62. Best value: 0.393154:  72%|███████▏  | 72/100 [04:45<01:50,  3.95s/it]Best trial: 62. Best value: 0.393154:  73%|███████▎  | 73/100 [04:45<01:42,  3.80s/it]Best trial: 62. Best value: 0.393154:  73%|███████▎  | 73/100 [04:49<01:42,  3.80s/it]Best trial: 62. Best value: 0.393154:  74%|███████▍  | 74/100 [04:49<01:42,  3.94s/it]Best trial: 62. Best value: 0.393154:  74%|███████▍  | 74/100 [04:53<01:42,  3.94s/it]Best trial: 62. Best value: 0.393154:  75%|███████▌  | 75/100 [04:53<01:41,  4.08s/it]Best trial: 62. Best value: 0.393154:  75%|███████▌  | 75/100 [04:58<01:41,  4.08s/it]Best trial: 62. Best value: 0.393154:  76%|███████▌  | 76/100 [04:58<01:40,  4.18s/it]Best trial: 62. Best value: 0.393154:  76%|███████▌  | 76/100 [05:01<01:40,  4.18s/it]Best trial: 62. Best value: 0.393154:  77%|███████▋  | 77/100 [05:01<01:31,  3.98s/it]Best trial: 62. Best value: 0.393154:  77%|███████▋  | 77/100 [05:05<01:31,  3.98s/it]Best trial: 62. Best value: 0.393154:  78%|███████▊  | 78/100 [05:05<01:23,  3.81s/it]Best trial: 62. Best value: 0.393154:  78%|███████▊  | 78/100 [05:07<01:23,  3.81s/it]Best trial: 62. Best value: 0.393154:  79%|███████▉  | 79/100 [05:07<01:10,  3.38s/it]Best trial: 62. Best value: 0.393154:  79%|███████▉  | 79/100 [05:10<01:10,  3.38s/it]Best trial: 62. Best value: 0.393154:  80%|████████  | 80/100 [05:10<01:07,  3.38s/it]Best trial: 62. Best value: 0.393154:  80%|████████  | 80/100 [05:15<01:07,  3.38s/it]Best trial: 62. Best value: 0.393154:  81%|████████  | 81/100 [05:15<01:13,  3.87s/it]Best trial: 81. Best value: 0.396228:  81%|████████  | 81/100 [05:21<01:13,  3.87s/it]Best trial: 81. Best value: 0.396228:  82%|████████▏ | 82/100 [05:21<01:19,  4.40s/it]Best trial: 82. Best value: 0.400032:  82%|████████▏ | 82/100 [05:26<01:19,  4.40s/it]Best trial: 82. Best value: 0.400032:  83%|████████▎ | 83/100 [05:26<01:17,  4.56s/it]Best trial: 82. Best value: 0.400032:  83%|████████▎ | 83/100 [05:31<01:17,  4.56s/it]Best trial: 82. Best value: 0.400032:  84%|████████▍ | 84/100 [05:31<01:17,  4.81s/it]Best trial: 82. Best value: 0.400032:  84%|████████▍ | 84/100 [05:34<01:17,  4.81s/it]Best trial: 82. Best value: 0.400032:  85%|████████▌ | 85/100 [05:34<01:01,  4.12s/it]Best trial: 82. Best value: 0.400032:  85%|████████▌ | 85/100 [05:37<01:01,  4.12s/it]Best trial: 82. Best value: 0.400032:  86%|████████▌ | 86/100 [05:37<00:53,  3.80s/it]Best trial: 82. Best value: 0.400032:  86%|████████▌ | 86/100 [05:40<00:53,  3.80s/it]Best trial: 82. Best value: 0.400032:  87%|████████▋ | 87/100 [05:40<00:47,  3.63s/it]Best trial: 82. Best value: 0.400032:  87%|████████▋ | 87/100 [05:45<00:47,  3.63s/it]Best trial: 82. Best value: 0.400032:  88%|████████▊ | 88/100 [05:45<00:49,  4.15s/it]Best trial: 82. Best value: 0.400032:  88%|████████▊ | 88/100 [05:49<00:49,  4.15s/it]Best trial: 82. Best value: 0.400032:  89%|████████▉ | 89/100 [05:49<00:43,  3.96s/it]Best trial: 82. Best value: 0.400032:  89%|████████▉ | 89/100 [05:53<00:43,  3.96s/it]Best trial: 82. Best value: 0.400032:  90%|█████████ | 90/100 [05:53<00:39,  3.95s/it]Best trial: 82. Best value: 0.400032:  90%|█████████ | 90/100 [05:56<00:39,  3.95s/it]Best trial: 82. Best value: 0.400032:  91%|█████████ | 91/100 [05:56<00:33,  3.69s/it]Best trial: 82. Best value: 0.400032:  91%|█████████ | 91/100 [05:58<00:33,  3.69s/it]Best trial: 82. Best value: 0.400032:  92%|█████████▏| 92/100 [05:58<00:26,  3.31s/it]Best trial: 92. Best value: 0.402573:  92%|█████████▏| 92/100 [06:03<00:26,  3.31s/it]Best trial: 92. Best value: 0.402573:  93%|█████████▎| 93/100 [06:03<00:25,  3.64s/it]Best trial: 93. Best value: 0.415397:  93%|█████████▎| 93/100 [06:07<00:25,  3.64s/it]Best trial: 93. Best value: 0.415397:  94%|█████████▍| 94/100 [06:07<00:23,  3.90s/it]Best trial: 93. Best value: 0.415397:  94%|█████████▍| 94/100 [06:11<00:23,  3.90s/it]Best trial: 93. Best value: 0.415397:  95%|█████████▌| 95/100 [06:11<00:19,  3.88s/it]Best trial: 93. Best value: 0.415397:  95%|█████████▌| 95/100 [06:15<00:19,  3.88s/it]Best trial: 93. Best value: 0.415397:  96%|█████████▌| 96/100 [06:15<00:14,  3.73s/it]Best trial: 93. Best value: 0.415397:  96%|█████████▌| 96/100 [06:18<00:14,  3.73s/it]Best trial: 93. Best value: 0.415397:  97%|█████████▋| 97/100 [06:18<00:11,  3.68s/it]Best trial: 93. Best value: 0.415397:  97%|█████████▋| 97/100 [06:22<00:11,  3.68s/it]Best trial: 93. Best value: 0.415397:  98%|█████████▊| 98/100 [06:22<00:07,  3.77s/it]Best trial: 93. Best value: 0.415397:  98%|█████████▊| 98/100 [06:25<00:07,  3.77s/it]Best trial: 93. Best value: 0.415397:  99%|█████████▉| 99/100 [06:25<00:03,  3.64s/it]Best trial: 93. Best value: 0.415397:  99%|█████████▉| 99/100 [06:29<00:03,  3.64s/it]Best trial: 93. Best value: 0.415397: 100%|██████████| 100/100 [06:29<00:00,  3.76s/it]Best trial: 93. Best value: 0.415397: 100%|██████████| 100/100 [06:29<00:00,  3.90s/it]
2025-11-30 12:33:41,094 - INFO - HPO Complete. Best AUPRC: 0.4154
2025-11-30 12:33:41,094 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.03917795426699052, 'max_depth': 3, 'subsample': 0.7020581098684977, 'colsample_bytree': 0.8920052932861083, 'gamma': 3.4064729051993146, 'reg_lambda': 0.21611889982601823, 'reg_alpha': 6.863836473625804e-08}
2025-11-30 12:33:41,094 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:33:43,211 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 12:33:43,212 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:33:43,316 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:33:43,351 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:33:43,361 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:33:43,362 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:33:43,362 - INFO - Training model...
2025-11-30 12:33:45,815 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:33:51,391 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:33:51,392 - INFO - AUROC: 0.6933 (0.5524 - 0.8032)
2025-11-30 12:33:51,392 - INFO - AUPRC: 0.2633 (0.0230 - 0.5268)
2025-11-30 12:33:51,392 - INFO - Brier Score: 0.0165 (0.0122 - 0.0248)
2025-11-30 12:33:51,392 - INFO - Accuracy: 0.9841 (0.9234 - 0.9948)
2025-11-30 12:33:51,392 - INFO - Precision: 0.4286 (0.0383 - 1.0000)
2025-11-30 12:33:51,392 - INFO - Sensitivity (Recall): 0.3000 (0.1302 - 0.5000)
2025-11-30 12:33:51,392 - INFO - F1-Score: 0.3529 (0.0606 - 0.6267)
2025-11-30 12:33:51,392 - INFO - Best Threshold: 0.7000 (0.0920 - 0.9300)
2025-11-30 12:33:51,392 - INFO - Specificity: 0.9941 (0.9338 - 1.0000)
2025-11-30 12:33:51,406 - INFO - Calculating SHAP values...
2025-11-30 12:33:52,429 - INFO - SHAP plots saved.
2025-11-30 12:33:52,431 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=non_windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:33:53,927 - INFO - Starting HPO for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 12:33:53,928 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:33:54,033 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:33:54,069 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:33:54,077 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:33:54,077 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.237725:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.237725:   1%|          | 1/100 [00:03<06:02,  3.66s/it]Best trial: 1. Best value: 0.262274:   1%|          | 1/100 [00:07<06:02,  3.66s/it]Best trial: 1. Best value: 0.262274:   2%|▏         | 2/100 [00:07<05:55,  3.63s/it]Best trial: 2. Best value: 0.263803:   2%|▏         | 2/100 [00:10<05:55,  3.63s/it]Best trial: 2. Best value: 0.263803:   3%|▎         | 3/100 [00:10<05:38,  3.49s/it]Best trial: 2. Best value: 0.263803:   3%|▎         | 3/100 [00:14<05:38,  3.49s/it]Best trial: 2. Best value: 0.263803:   4%|▍         | 4/100 [00:14<05:37,  3.52s/it]Best trial: 2. Best value: 0.263803:   4%|▍         | 4/100 [00:17<05:37,  3.52s/it]Best trial: 2. Best value: 0.263803:   5%|▌         | 5/100 [00:17<05:28,  3.46s/it]Best trial: 2. Best value: 0.263803:   5%|▌         | 5/100 [00:20<05:28,  3.46s/it]Best trial: 2. Best value: 0.263803:   6%|▌         | 6/100 [00:20<05:14,  3.34s/it]Best trial: 2. Best value: 0.263803:   6%|▌         | 6/100 [00:23<05:14,  3.34s/it]Best trial: 2. Best value: 0.263803:   7%|▋         | 7/100 [00:23<05:08,  3.32s/it]Best trial: 2. Best value: 0.263803:   7%|▋         | 7/100 [00:27<05:08,  3.32s/it]Best trial: 2. Best value: 0.263803:   8%|▊         | 8/100 [00:27<05:06,  3.33s/it]Best trial: 2. Best value: 0.263803:   8%|▊         | 8/100 [00:30<05:06,  3.33s/it]Best trial: 2. Best value: 0.263803:   9%|▉         | 9/100 [00:30<04:47,  3.16s/it]Best trial: 9. Best value: 0.270513:   9%|▉         | 9/100 [00:32<04:47,  3.16s/it]Best trial: 9. Best value: 0.270513:  10%|█         | 10/100 [00:32<04:17,  2.87s/it]Best trial: 10. Best value: 0.307605:  10%|█         | 10/100 [00:34<04:17,  2.87s/it]Best trial: 10. Best value: 0.307605:  11%|█         | 11/100 [00:34<04:02,  2.72s/it]Best trial: 11. Best value: 0.324024:  11%|█         | 11/100 [00:37<04:02,  2.72s/it]Best trial: 11. Best value: 0.324024:  12%|█▏        | 12/100 [00:37<04:04,  2.78s/it]Best trial: 11. Best value: 0.324024:  12%|█▏        | 12/100 [00:40<04:04,  2.78s/it]Best trial: 11. Best value: 0.324024:  13%|█▎        | 13/100 [00:40<04:15,  2.94s/it]Best trial: 11. Best value: 0.324024:  13%|█▎        | 13/100 [00:43<04:15,  2.94s/it]Best trial: 11. Best value: 0.324024:  14%|█▍        | 14/100 [00:43<04:05,  2.85s/it]Best trial: 11. Best value: 0.324024:  14%|█▍        | 14/100 [00:46<04:05,  2.85s/it]Best trial: 11. Best value: 0.324024:  15%|█▌        | 15/100 [00:46<03:59,  2.81s/it]Best trial: 11. Best value: 0.324024:  15%|█▌        | 15/100 [00:50<03:59,  2.81s/it]Best trial: 11. Best value: 0.324024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]Best trial: 11. Best value: 0.324024:  16%|█▌        | 16/100 [00:52<04:24,  3.14s/it]Best trial: 11. Best value: 0.324024:  17%|█▋        | 17/100 [00:52<04:08,  2.99s/it]Best trial: 11. Best value: 0.324024:  17%|█▋        | 17/100 [00:55<04:08,  2.99s/it]Best trial: 11. Best value: 0.324024:  18%|█▊        | 18/100 [00:55<03:53,  2.85s/it]Best trial: 11. Best value: 0.324024:  18%|█▊        | 18/100 [00:57<03:53,  2.85s/it]Best trial: 11. Best value: 0.324024:  19%|█▉        | 19/100 [00:57<03:33,  2.64s/it]Best trial: 19. Best value: 0.367463:  19%|█▉        | 19/100 [01:01<03:33,  2.64s/it]Best trial: 19. Best value: 0.367463:  20%|██        | 20/100 [01:01<04:06,  3.08s/it]Best trial: 19. Best value: 0.367463:  20%|██        | 20/100 [01:04<04:06,  3.08s/it]Best trial: 19. Best value: 0.367463:  21%|██        | 21/100 [01:04<04:06,  3.12s/it]Best trial: 19. Best value: 0.367463:  21%|██        | 21/100 [01:08<04:06,  3.12s/it]Best trial: 19. Best value: 0.367463:  22%|██▏       | 22/100 [01:08<04:16,  3.29s/it]Best trial: 19. Best value: 0.367463:  22%|██▏       | 22/100 [01:14<04:16,  3.29s/it]Best trial: 19. Best value: 0.367463:  23%|██▎       | 23/100 [01:14<05:11,  4.05s/it]Best trial: 23. Best value: 0.376452:  23%|██▎       | 23/100 [01:18<05:11,  4.05s/it]Best trial: 23. Best value: 0.376452:  24%|██▍       | 24/100 [01:18<05:03,  3.99s/it]Best trial: 23. Best value: 0.376452:  24%|██▍       | 24/100 [01:21<05:03,  3.99s/it]Best trial: 23. Best value: 0.376452:  25%|██▌       | 25/100 [01:21<04:35,  3.67s/it]Best trial: 23. Best value: 0.376452:  25%|██▌       | 25/100 [01:25<04:35,  3.67s/it]Best trial: 23. Best value: 0.376452:  26%|██▌       | 26/100 [01:25<04:47,  3.88s/it]Best trial: 23. Best value: 0.376452:  26%|██▌       | 26/100 [01:28<04:47,  3.88s/it]Best trial: 23. Best value: 0.376452:  27%|██▋       | 27/100 [01:28<04:25,  3.64s/it]Best trial: 23. Best value: 0.376452:  27%|██▋       | 27/100 [01:33<04:25,  3.64s/it]Best trial: 23. Best value: 0.376452:  28%|██▊       | 28/100 [01:33<04:56,  4.12s/it]Best trial: 23. Best value: 0.376452:  28%|██▊       | 28/100 [01:38<04:56,  4.12s/it]Best trial: 23. Best value: 0.376452:  29%|██▉       | 29/100 [01:38<05:15,  4.44s/it]Best trial: 23. Best value: 0.376452:  29%|██▉       | 29/100 [01:42<05:15,  4.44s/it]Best trial: 23. Best value: 0.376452:  30%|███       | 30/100 [01:42<04:52,  4.17s/it]Best trial: 23. Best value: 0.376452:  30%|███       | 30/100 [01:48<04:52,  4.17s/it]Best trial: 23. Best value: 0.376452:  31%|███       | 31/100 [01:48<05:17,  4.59s/it]Best trial: 23. Best value: 0.376452:  31%|███       | 31/100 [01:51<05:17,  4.59s/it]Best trial: 23. Best value: 0.376452:  32%|███▏      | 32/100 [01:51<04:58,  4.38s/it]Best trial: 23. Best value: 0.376452:  32%|███▏      | 32/100 [01:56<04:58,  4.38s/it]Best trial: 23. Best value: 0.376452:  33%|███▎      | 33/100 [01:56<04:48,  4.30s/it]Best trial: 23. Best value: 0.376452:  33%|███▎      | 33/100 [02:01<04:48,  4.30s/it]Best trial: 23. Best value: 0.376452:  34%|███▍      | 34/100 [02:01<04:56,  4.50s/it]Best trial: 23. Best value: 0.376452:  34%|███▍      | 34/100 [02:05<04:56,  4.50s/it]Best trial: 23. Best value: 0.376452:  35%|███▌      | 35/100 [02:05<04:45,  4.40s/it]Best trial: 23. Best value: 0.376452:  35%|███▌      | 35/100 [02:09<04:45,  4.40s/it]Best trial: 23. Best value: 0.376452:  36%|███▌      | 36/100 [02:09<04:41,  4.40s/it]Best trial: 23. Best value: 0.376452:  36%|███▌      | 36/100 [02:12<04:41,  4.40s/it]Best trial: 23. Best value: 0.376452:  37%|███▋      | 37/100 [02:12<04:06,  3.91s/it]Best trial: 23. Best value: 0.376452:  37%|███▋      | 37/100 [02:14<04:06,  3.91s/it]Best trial: 23. Best value: 0.376452:  38%|███▊      | 38/100 [02:14<03:37,  3.50s/it]Best trial: 23. Best value: 0.376452:  38%|███▊      | 38/100 [02:18<03:37,  3.50s/it]Best trial: 23. Best value: 0.376452:  39%|███▉      | 39/100 [02:18<03:27,  3.41s/it]Best trial: 23. Best value: 0.376452:  39%|███▉      | 39/100 [02:20<03:27,  3.41s/it]Best trial: 23. Best value: 0.376452:  40%|████      | 40/100 [02:20<03:05,  3.10s/it]Best trial: 23. Best value: 0.376452:  40%|████      | 40/100 [02:23<03:05,  3.10s/it]Best trial: 23. Best value: 0.376452:  41%|████      | 41/100 [02:23<02:53,  2.95s/it]Best trial: 23. Best value: 0.376452:  41%|████      | 41/100 [02:25<02:53,  2.95s/it]Best trial: 23. Best value: 0.376452:  42%|████▏     | 42/100 [02:25<02:41,  2.78s/it]Best trial: 23. Best value: 0.376452:  42%|████▏     | 42/100 [02:27<02:41,  2.78s/it]Best trial: 23. Best value: 0.376452:  43%|████▎     | 43/100 [02:27<02:28,  2.61s/it]Best trial: 23. Best value: 0.376452:  43%|████▎     | 43/100 [02:29<02:28,  2.61s/it]Best trial: 23. Best value: 0.376452:  44%|████▍     | 44/100 [02:29<02:21,  2.53s/it]Best trial: 23. Best value: 0.376452:  44%|████▍     | 44/100 [02:33<02:21,  2.53s/it]Best trial: 23. Best value: 0.376452:  45%|████▌     | 45/100 [02:33<02:30,  2.74s/it]Best trial: 23. Best value: 0.376452:  45%|████▌     | 45/100 [02:35<02:30,  2.74s/it]Best trial: 23. Best value: 0.376452:  46%|████▌     | 46/100 [02:35<02:22,  2.63s/it]Best trial: 23. Best value: 0.376452:  46%|████▌     | 46/100 [02:37<02:22,  2.63s/it]Best trial: 23. Best value: 0.376452:  47%|████▋     | 47/100 [02:37<02:11,  2.48s/it]Best trial: 23. Best value: 0.376452:  47%|████▋     | 47/100 [02:40<02:11,  2.48s/it]Best trial: 23. Best value: 0.376452:  48%|████▊     | 48/100 [02:40<02:08,  2.48s/it]Best trial: 23. Best value: 0.376452:  48%|████▊     | 48/100 [02:42<02:08,  2.48s/it]Best trial: 23. Best value: 0.376452:  49%|████▉     | 49/100 [02:42<02:04,  2.44s/it]Best trial: 23. Best value: 0.376452:  49%|████▉     | 49/100 [02:44<02:04,  2.44s/it]Best trial: 23. Best value: 0.376452:  50%|█████     | 50/100 [02:44<02:01,  2.43s/it]Best trial: 23. Best value: 0.376452:  50%|█████     | 50/100 [02:48<02:01,  2.43s/it]Best trial: 23. Best value: 0.376452:  51%|█████     | 51/100 [02:48<02:17,  2.80s/it]Best trial: 23. Best value: 0.376452:  51%|█████     | 51/100 [02:53<02:17,  2.80s/it]Best trial: 23. Best value: 0.376452:  52%|█████▏    | 52/100 [02:53<02:46,  3.46s/it]Best trial: 23. Best value: 0.376452:  52%|█████▏    | 52/100 [02:58<02:46,  3.46s/it]Best trial: 23. Best value: 0.376452:  53%|█████▎    | 53/100 [02:58<03:00,  3.83s/it]Best trial: 23. Best value: 0.376452:  53%|█████▎    | 53/100 [03:02<03:00,  3.83s/it]Best trial: 23. Best value: 0.376452:  54%|█████▍    | 54/100 [03:02<03:02,  3.97s/it]Best trial: 23. Best value: 0.376452:  54%|█████▍    | 54/100 [03:08<03:02,  3.97s/it]Best trial: 23. Best value: 0.376452:  55%|█████▌    | 55/100 [03:08<03:18,  4.42s/it]Best trial: 23. Best value: 0.376452:  55%|█████▌    | 55/100 [03:12<03:18,  4.42s/it]Best trial: 23. Best value: 0.376452:  56%|█████▌    | 56/100 [03:12<03:17,  4.49s/it]Best trial: 23. Best value: 0.376452:  56%|█████▌    | 56/100 [03:16<03:17,  4.49s/it]Best trial: 23. Best value: 0.376452:  57%|█████▋    | 57/100 [03:16<03:02,  4.25s/it]Best trial: 23. Best value: 0.376452:  57%|█████▋    | 57/100 [03:20<03:02,  4.25s/it]Best trial: 23. Best value: 0.376452:  58%|█████▊    | 58/100 [03:20<02:52,  4.10s/it]Best trial: 23. Best value: 0.376452:  58%|█████▊    | 58/100 [03:23<02:52,  4.10s/it]Best trial: 23. Best value: 0.376452:  59%|█████▉    | 59/100 [03:23<02:41,  3.93s/it]Best trial: 23. Best value: 0.376452:  59%|█████▉    | 59/100 [03:28<02:41,  3.93s/it]Best trial: 23. Best value: 0.376452:  60%|██████    | 60/100 [03:28<02:47,  4.19s/it]Best trial: 23. Best value: 0.376452:  60%|██████    | 60/100 [03:33<02:47,  4.19s/it]Best trial: 23. Best value: 0.376452:  61%|██████    | 61/100 [03:33<02:54,  4.47s/it]Best trial: 23. Best value: 0.376452:  61%|██████    | 61/100 [03:37<02:54,  4.47s/it]Best trial: 23. Best value: 0.376452:  62%|██████▏   | 62/100 [03:37<02:45,  4.35s/it]Best trial: 23. Best value: 0.376452:  62%|██████▏   | 62/100 [03:42<02:45,  4.35s/it]Best trial: 23. Best value: 0.376452:  63%|██████▎   | 63/100 [03:42<02:50,  4.60s/it]Best trial: 23. Best value: 0.376452:  63%|██████▎   | 63/100 [03:46<02:50,  4.60s/it]Best trial: 23. Best value: 0.376452:  64%|██████▍   | 64/100 [03:46<02:38,  4.41s/it]Best trial: 23. Best value: 0.376452:  64%|██████▍   | 64/100 [03:52<02:38,  4.41s/it]Best trial: 23. Best value: 0.376452:  65%|██████▌   | 65/100 [03:52<02:43,  4.67s/it]Best trial: 23. Best value: 0.376452:  65%|██████▌   | 65/100 [03:56<02:43,  4.67s/it]Best trial: 23. Best value: 0.376452:  66%|██████▌   | 66/100 [03:56<02:33,  4.53s/it]Best trial: 23. Best value: 0.376452:  66%|██████▌   | 66/100 [04:00<02:33,  4.53s/it]Best trial: 23. Best value: 0.376452:  67%|██████▋   | 67/100 [04:00<02:21,  4.27s/it]Best trial: 23. Best value: 0.376452:  67%|██████▋   | 67/100 [04:04<02:21,  4.27s/it]Best trial: 23. Best value: 0.376452:  68%|██████▊   | 68/100 [04:04<02:15,  4.23s/it]Best trial: 23. Best value: 0.376452:  68%|██████▊   | 68/100 [04:07<02:15,  4.23s/it]Best trial: 23. Best value: 0.376452:  69%|██████▉   | 69/100 [04:07<01:59,  3.85s/it]Best trial: 23. Best value: 0.376452:  69%|██████▉   | 69/100 [04:13<01:59,  3.85s/it]Best trial: 23. Best value: 0.376452:  70%|███████   | 70/100 [04:13<02:16,  4.55s/it]Best trial: 23. Best value: 0.376452:  70%|███████   | 70/100 [04:16<02:16,  4.55s/it]Best trial: 23. Best value: 0.376452:  71%|███████   | 71/100 [04:16<02:01,  4.18s/it]Best trial: 23. Best value: 0.376452:  71%|███████   | 71/100 [04:20<02:01,  4.18s/it]Best trial: 23. Best value: 0.376452:  72%|███████▏  | 72/100 [04:20<01:52,  4.01s/it]Best trial: 72. Best value: 0.427213:  72%|███████▏  | 72/100 [04:23<01:52,  4.01s/it]Best trial: 72. Best value: 0.427213:  73%|███████▎  | 73/100 [04:23<01:42,  3.78s/it]Best trial: 72. Best value: 0.427213:  73%|███████▎  | 73/100 [04:26<01:42,  3.78s/it]Best trial: 72. Best value: 0.427213:  74%|███████▍  | 74/100 [04:26<01:32,  3.54s/it]Best trial: 72. Best value: 0.427213:  74%|███████▍  | 74/100 [04:29<01:32,  3.54s/it]Best trial: 72. Best value: 0.427213:  75%|███████▌  | 75/100 [04:29<01:24,  3.39s/it]Best trial: 72. Best value: 0.427213:  75%|███████▌  | 75/100 [04:32<01:24,  3.39s/it]Best trial: 72. Best value: 0.427213:  76%|███████▌  | 76/100 [04:32<01:19,  3.31s/it]Best trial: 72. Best value: 0.427213:  76%|███████▌  | 76/100 [04:36<01:19,  3.31s/it]Best trial: 72. Best value: 0.427213:  77%|███████▋  | 77/100 [04:36<01:18,  3.41s/it]Best trial: 77. Best value: 0.433645:  77%|███████▋  | 77/100 [04:39<01:18,  3.41s/it]Best trial: 77. Best value: 0.433645:  78%|███████▊  | 78/100 [04:39<01:13,  3.33s/it]Best trial: 77. Best value: 0.433645:  78%|███████▊  | 78/100 [04:42<01:13,  3.33s/it]Best trial: 77. Best value: 0.433645:  79%|███████▉  | 79/100 [04:42<01:07,  3.22s/it]Best trial: 77. Best value: 0.433645:  79%|███████▉  | 79/100 [04:45<01:07,  3.22s/it]Best trial: 77. Best value: 0.433645:  80%|████████  | 80/100 [04:45<01:04,  3.23s/it]Best trial: 77. Best value: 0.433645:  80%|████████  | 80/100 [04:48<01:04,  3.23s/it]Best trial: 77. Best value: 0.433645:  81%|████████  | 81/100 [04:48<01:00,  3.21s/it]Best trial: 77. Best value: 0.433645:  81%|████████  | 81/100 [04:52<01:00,  3.21s/it]Best trial: 77. Best value: 0.433645:  82%|████████▏ | 82/100 [04:52<00:58,  3.26s/it]Best trial: 77. Best value: 0.433645:  82%|████████▏ | 82/100 [04:56<00:58,  3.26s/it]Best trial: 77. Best value: 0.433645:  83%|████████▎ | 83/100 [04:56<00:59,  3.51s/it]Best trial: 77. Best value: 0.433645:  83%|████████▎ | 83/100 [04:59<00:59,  3.51s/it]Best trial: 77. Best value: 0.433645:  84%|████████▍ | 84/100 [04:59<00:55,  3.46s/it]Best trial: 77. Best value: 0.433645:  84%|████████▍ | 84/100 [05:02<00:55,  3.46s/it]Best trial: 77. Best value: 0.433645:  85%|████████▌ | 85/100 [05:02<00:51,  3.44s/it]Best trial: 77. Best value: 0.433645:  85%|████████▌ | 85/100 [05:05<00:51,  3.44s/it]Best trial: 77. Best value: 0.433645:  86%|████████▌ | 86/100 [05:05<00:46,  3.31s/it]Best trial: 77. Best value: 0.433645:  86%|████████▌ | 86/100 [05:09<00:46,  3.31s/it]Best trial: 77. Best value: 0.433645:  87%|████████▋ | 87/100 [05:09<00:44,  3.40s/it]Best trial: 77. Best value: 0.433645:  87%|████████▋ | 87/100 [05:12<00:44,  3.40s/it]Best trial: 77. Best value: 0.433645:  88%|████████▊ | 88/100 [05:12<00:40,  3.36s/it]Best trial: 77. Best value: 0.433645:  88%|████████▊ | 88/100 [05:16<00:40,  3.36s/it]Best trial: 77. Best value: 0.433645:  89%|████████▉ | 89/100 [05:16<00:36,  3.31s/it]Best trial: 77. Best value: 0.433645:  89%|████████▉ | 89/100 [05:19<00:36,  3.31s/it]Best trial: 77. Best value: 0.433645:  90%|█████████ | 90/100 [05:19<00:32,  3.21s/it]Best trial: 77. Best value: 0.433645:  90%|█████████ | 90/100 [05:22<00:32,  3.21s/it]Best trial: 77. Best value: 0.433645:  91%|█████████ | 91/100 [05:22<00:29,  3.23s/it]Best trial: 77. Best value: 0.433645:  91%|█████████ | 91/100 [05:25<00:29,  3.23s/it]Best trial: 77. Best value: 0.433645:  92%|█████████▏| 92/100 [05:25<00:25,  3.17s/it]Best trial: 77. Best value: 0.433645:  92%|█████████▏| 92/100 [05:29<00:25,  3.17s/it]Best trial: 77. Best value: 0.433645:  93%|█████████▎| 93/100 [05:29<00:23,  3.36s/it]Best trial: 77. Best value: 0.433645:  93%|█████████▎| 93/100 [05:33<00:23,  3.36s/it]Best trial: 77. Best value: 0.433645:  94%|█████████▍| 94/100 [05:33<00:21,  3.54s/it]Best trial: 77. Best value: 0.433645:  94%|█████████▍| 94/100 [05:36<00:21,  3.54s/it]Best trial: 77. Best value: 0.433645:  95%|█████████▌| 95/100 [05:36<00:17,  3.49s/it]Best trial: 77. Best value: 0.433645:  95%|█████████▌| 95/100 [05:40<00:17,  3.49s/it]Best trial: 77. Best value: 0.433645:  96%|█████████▌| 96/100 [05:40<00:14,  3.63s/it]Best trial: 77. Best value: 0.433645:  96%|█████████▌| 96/100 [05:43<00:14,  3.63s/it]Best trial: 77. Best value: 0.433645:  97%|█████████▋| 97/100 [05:43<00:10,  3.59s/it]Best trial: 77. Best value: 0.433645:  97%|█████████▋| 97/100 [05:47<00:10,  3.59s/it]Best trial: 77. Best value: 0.433645:  98%|█████████▊| 98/100 [05:47<00:06,  3.47s/it]Best trial: 77. Best value: 0.433645:  98%|█████████▊| 98/100 [05:50<00:06,  3.47s/it]Best trial: 77. Best value: 0.433645:  99%|█████████▉| 99/100 [05:50<00:03,  3.49s/it]Best trial: 77. Best value: 0.433645:  99%|█████████▉| 99/100 [05:54<00:03,  3.49s/it]Best trial: 77. Best value: 0.433645: 100%|██████████| 100/100 [05:54<00:00,  3.50s/it]Best trial: 77. Best value: 0.433645: 100%|██████████| 100/100 [05:54<00:00,  3.54s/it]
2025-11-30 12:39:48,233 - INFO - HPO Complete. Best AUPRC: 0.4336
2025-11-30 12:39:48,233 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0008666312538066886, 'max_depth': 3, 'subsample': 0.6213255312800143, 'colsample_bytree': 0.780400747070207, 'gamma': 4.965834722165298, 'reg_lambda': 0.29241261373068783, 'reg_alpha': 0.009138327961556572}
2025-11-30 12:39:48,235 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/non_windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:39:50,473 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 12:39:50,473 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 12:39:50,576 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 12:39:50,616 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:39:50,626 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 12:39:50,626 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:39:50,626 - INFO - Training model...
2025-11-30 12:39:54,168 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:39:59,683 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:39:59,684 - INFO - AUROC: 0.6261 (0.4309 - 0.8817)
2025-11-30 12:39:59,684 - INFO - AUPRC: 0.2247 (0.0440 - 0.5016)
2025-11-30 12:39:59,684 - INFO - Brier Score: 0.0894 (0.0867 - 0.0933)
2025-11-30 12:39:59,684 - INFO - Accuracy: 0.9827 (0.9329 - 0.9939)
2025-11-30 12:39:59,684 - INFO - Precision: 0.3750 (0.0812 - 1.0000)
2025-11-30 12:39:59,684 - INFO - Sensitivity (Recall): 0.3000 (0.1302 - 0.5333)
2025-11-30 12:39:59,684 - INFO - F1-Score: 0.3333 (0.1213 - 0.5897)
2025-11-30 12:39:59,684 - INFO - Best Threshold: 0.5900 (0.4480 - 0.6800)
2025-11-30 12:39:59,684 - INFO - Specificity: 0.9927 (0.9418 - 1.0000)
2025-11-30 12:39:59,701 - INFO - Calculating SHAP values...
2025-11-30 12:40:00,819 - INFO - SHAP plots saved.
2025-11-30 12:40:00,821 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/non_windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:40:02,173 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_only
2025-11-30 12:40:02,173 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:40:02,435 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:40:02,456 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:40:02,462 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 12:40:02,462 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.358355:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.358355:   1%|          | 1/100 [00:02<04:08,  2.51s/it]Best trial: 1. Best value: 0.37761:   1%|          | 1/100 [00:06<04:08,  2.51s/it] Best trial: 1. Best value: 0.37761:   2%|▏         | 2/100 [00:06<05:55,  3.63s/it]Best trial: 1. Best value: 0.37761:   2%|▏         | 2/100 [00:09<05:55,  3.63s/it]Best trial: 1. Best value: 0.37761:   3%|▎         | 3/100 [00:09<05:26,  3.37s/it]Best trial: 3. Best value: 0.458392:   3%|▎         | 3/100 [00:12<05:26,  3.37s/it]Best trial: 3. Best value: 0.458392:   4%|▍         | 4/100 [00:12<04:56,  3.08s/it]Best trial: 3. Best value: 0.458392:   4%|▍         | 4/100 [00:15<04:56,  3.08s/it]Best trial: 3. Best value: 0.458392:   5%|▌         | 5/100 [00:15<04:41,  2.96s/it]Best trial: 3. Best value: 0.458392:   5%|▌         | 5/100 [00:18<04:41,  2.96s/it]Best trial: 3. Best value: 0.458392:   6%|▌         | 6/100 [00:18<04:48,  3.07s/it]Best trial: 3. Best value: 0.458392:   6%|▌         | 6/100 [00:20<04:48,  3.07s/it]Best trial: 3. Best value: 0.458392:   7%|▋         | 7/100 [00:20<04:09,  2.68s/it]Best trial: 3. Best value: 0.458392:   7%|▋         | 7/100 [00:24<04:09,  2.68s/it]Best trial: 3. Best value: 0.458392:   8%|▊         | 8/100 [00:24<04:40,  3.05s/it]Best trial: 3. Best value: 0.458392:   8%|▊         | 8/100 [00:27<04:40,  3.05s/it]Best trial: 3. Best value: 0.458392:   9%|▉         | 9/100 [00:27<04:40,  3.08s/it]Best trial: 3. Best value: 0.458392:   9%|▉         | 9/100 [00:29<04:40,  3.08s/it]Best trial: 3. Best value: 0.458392:  10%|█         | 10/100 [00:29<04:13,  2.82s/it]Best trial: 3. Best value: 0.458392:  10%|█         | 10/100 [00:32<04:13,  2.82s/it]Best trial: 3. Best value: 0.458392:  11%|█         | 11/100 [00:32<03:59,  2.69s/it]Best trial: 11. Best value: 0.463467:  11%|█         | 11/100 [00:34<03:59,  2.69s/it]Best trial: 11. Best value: 0.463467:  12%|█▏        | 12/100 [00:34<03:52,  2.64s/it]Best trial: 11. Best value: 0.463467:  12%|█▏        | 12/100 [00:37<03:52,  2.64s/it]Best trial: 11. Best value: 0.463467:  13%|█▎        | 13/100 [00:37<03:43,  2.57s/it]Best trial: 11. Best value: 0.463467:  13%|█▎        | 13/100 [00:40<03:43,  2.57s/it]Best trial: 11. Best value: 0.463467:  14%|█▍        | 14/100 [00:40<04:15,  2.97s/it]Best trial: 11. Best value: 0.463467:  14%|█▍        | 14/100 [00:43<04:15,  2.97s/it]Best trial: 11. Best value: 0.463467:  15%|█▌        | 15/100 [00:43<04:09,  2.94s/it]Best trial: 11. Best value: 0.463467:  15%|█▌        | 15/100 [00:46<04:09,  2.94s/it]Best trial: 11. Best value: 0.463467:  16%|█▌        | 16/100 [00:46<04:08,  2.96s/it]Best trial: 11. Best value: 0.463467:  16%|█▌        | 16/100 [00:48<04:08,  2.96s/it]Best trial: 11. Best value: 0.463467:  17%|█▋        | 17/100 [00:48<03:42,  2.68s/it]Best trial: 11. Best value: 0.463467:  17%|█▋        | 17/100 [00:51<03:42,  2.68s/it]Best trial: 11. Best value: 0.463467:  18%|█▊        | 18/100 [00:51<03:36,  2.64s/it]Best trial: 11. Best value: 0.463467:  18%|█▊        | 18/100 [00:53<03:36,  2.64s/it]Best trial: 11. Best value: 0.463467:  19%|█▉        | 19/100 [00:53<03:10,  2.35s/it]Best trial: 11. Best value: 0.463467:  19%|█▉        | 19/100 [00:55<03:10,  2.35s/it]Best trial: 11. Best value: 0.463467:  20%|██        | 20/100 [00:55<02:58,  2.23s/it]Best trial: 11. Best value: 0.463467:  20%|██        | 20/100 [00:57<02:58,  2.23s/it]Best trial: 11. Best value: 0.463467:  21%|██        | 21/100 [00:57<02:54,  2.21s/it]Best trial: 11. Best value: 0.463467:  21%|██        | 21/100 [00:59<02:54,  2.21s/it]Best trial: 11. Best value: 0.463467:  22%|██▏       | 22/100 [00:59<02:58,  2.29s/it]Best trial: 22. Best value: 0.483022:  22%|██▏       | 22/100 [01:02<02:58,  2.29s/it]Best trial: 22. Best value: 0.483022:  23%|██▎       | 23/100 [01:02<03:02,  2.37s/it]Best trial: 22. Best value: 0.483022:  23%|██▎       | 23/100 [01:06<03:02,  2.37s/it]Best trial: 22. Best value: 0.483022:  24%|██▍       | 24/100 [01:06<03:34,  2.82s/it]Best trial: 22. Best value: 0.483022:  24%|██▍       | 24/100 [01:10<03:34,  2.82s/it]Best trial: 22. Best value: 0.483022:  25%|██▌       | 25/100 [01:10<03:59,  3.20s/it]Best trial: 22. Best value: 0.483022:  25%|██▌       | 25/100 [01:12<03:59,  3.20s/it]Best trial: 22. Best value: 0.483022:  26%|██▌       | 26/100 [01:12<03:41,  3.00s/it]Best trial: 22. Best value: 0.483022:  26%|██▌       | 26/100 [01:15<03:41,  3.00s/it]Best trial: 22. Best value: 0.483022:  27%|██▋       | 27/100 [01:15<03:25,  2.82s/it]Best trial: 22. Best value: 0.483022:  27%|██▋       | 27/100 [01:18<03:25,  2.82s/it]Best trial: 22. Best value: 0.483022:  28%|██▊       | 28/100 [01:18<03:24,  2.84s/it]Best trial: 22. Best value: 0.483022:  28%|██▊       | 28/100 [01:21<03:24,  2.84s/it]Best trial: 22. Best value: 0.483022:  29%|██▉       | 29/100 [01:21<03:40,  3.11s/it]Best trial: 22. Best value: 0.483022:  29%|██▉       | 29/100 [01:24<03:40,  3.11s/it]Best trial: 22. Best value: 0.483022:  30%|███       | 30/100 [01:24<03:30,  3.01s/it]Best trial: 30. Best value: 0.517126:  30%|███       | 30/100 [01:27<03:30,  3.01s/it]Best trial: 30. Best value: 0.517126:  31%|███       | 31/100 [01:27<03:28,  3.02s/it]Best trial: 30. Best value: 0.517126:  31%|███       | 31/100 [01:30<03:28,  3.02s/it]Best trial: 30. Best value: 0.517126:  32%|███▏      | 32/100 [01:30<03:20,  2.95s/it]Best trial: 30. Best value: 0.517126:  32%|███▏      | 32/100 [01:32<03:20,  2.95s/it]Best trial: 30. Best value: 0.517126:  33%|███▎      | 33/100 [01:32<03:08,  2.82s/it]Best trial: 30. Best value: 0.517126:  33%|███▎      | 33/100 [01:35<03:08,  2.82s/it]Best trial: 30. Best value: 0.517126:  34%|███▍      | 34/100 [01:35<03:07,  2.84s/it]Best trial: 30. Best value: 0.517126:  34%|███▍      | 34/100 [01:40<03:07,  2.84s/it]Best trial: 30. Best value: 0.517126:  35%|███▌      | 35/100 [01:40<03:37,  3.35s/it]Best trial: 30. Best value: 0.517126:  35%|███▌      | 35/100 [01:42<03:37,  3.35s/it]Best trial: 30. Best value: 0.517126:  36%|███▌      | 36/100 [01:42<03:03,  2.86s/it]Best trial: 30. Best value: 0.517126:  36%|███▌      | 36/100 [01:45<03:03,  2.86s/it]Best trial: 30. Best value: 0.517126:  37%|███▋      | 37/100 [01:45<03:16,  3.12s/it]Best trial: 30. Best value: 0.517126:  37%|███▋      | 37/100 [01:47<03:16,  3.12s/it]Best trial: 30. Best value: 0.517126:  38%|███▊      | 38/100 [01:47<02:56,  2.85s/it]Best trial: 30. Best value: 0.517126:  38%|███▊      | 38/100 [01:50<02:56,  2.85s/it]Best trial: 30. Best value: 0.517126:  39%|███▉      | 39/100 [01:50<02:38,  2.60s/it]Best trial: 30. Best value: 0.517126:  39%|███▉      | 39/100 [01:51<02:38,  2.60s/it]Best trial: 30. Best value: 0.517126:  40%|████      | 40/100 [01:51<02:20,  2.34s/it]Best trial: 30. Best value: 0.517126:  40%|████      | 40/100 [01:53<02:20,  2.34s/it]Best trial: 30. Best value: 0.517126:  41%|████      | 41/100 [01:53<02:16,  2.31s/it]Best trial: 30. Best value: 0.517126:  41%|████      | 41/100 [01:55<02:16,  2.31s/it]Best trial: 30. Best value: 0.517126:  42%|████▏     | 42/100 [01:55<02:04,  2.15s/it]Best trial: 30. Best value: 0.517126:  42%|████▏     | 42/100 [01:58<02:04,  2.15s/it]Best trial: 30. Best value: 0.517126:  43%|████▎     | 43/100 [01:58<02:13,  2.35s/it]Best trial: 30. Best value: 0.517126:  43%|████▎     | 43/100 [02:00<02:13,  2.35s/it]Best trial: 30. Best value: 0.517126:  44%|████▍     | 44/100 [02:00<02:10,  2.33s/it]Best trial: 30. Best value: 0.517126:  44%|████▍     | 44/100 [02:04<02:10,  2.33s/it]Best trial: 30. Best value: 0.517126:  45%|████▌     | 45/100 [02:04<02:31,  2.76s/it]Best trial: 30. Best value: 0.517126:  45%|████▌     | 45/100 [02:07<02:31,  2.76s/it]Best trial: 30. Best value: 0.517126:  46%|████▌     | 46/100 [02:07<02:36,  2.90s/it]Best trial: 30. Best value: 0.517126:  46%|████▌     | 46/100 [02:10<02:36,  2.90s/it]Best trial: 30. Best value: 0.517126:  47%|████▋     | 47/100 [02:10<02:26,  2.77s/it]Best trial: 30. Best value: 0.517126:  47%|████▋     | 47/100 [02:12<02:26,  2.77s/it]Best trial: 30. Best value: 0.517126:  48%|████▊     | 48/100 [02:12<02:16,  2.62s/it]Best trial: 30. Best value: 0.517126:  48%|████▊     | 48/100 [02:14<02:16,  2.62s/it]Best trial: 30. Best value: 0.517126:  49%|████▉     | 49/100 [02:14<02:06,  2.48s/it]Best trial: 30. Best value: 0.517126:  49%|████▉     | 49/100 [02:16<02:06,  2.48s/it]Best trial: 30. Best value: 0.517126:  50%|█████     | 50/100 [02:16<01:50,  2.22s/it]Best trial: 30. Best value: 0.517126:  50%|█████     | 50/100 [02:18<01:50,  2.22s/it]Best trial: 30. Best value: 0.517126:  51%|█████     | 51/100 [02:18<01:49,  2.23s/it]Best trial: 30. Best value: 0.517126:  51%|█████     | 51/100 [02:21<01:49,  2.23s/it]Best trial: 30. Best value: 0.517126:  52%|█████▏    | 52/100 [02:21<01:51,  2.32s/it]Best trial: 30. Best value: 0.517126:  52%|█████▏    | 52/100 [02:23<01:51,  2.32s/it]Best trial: 30. Best value: 0.517126:  53%|█████▎    | 53/100 [02:23<01:51,  2.38s/it]Best trial: 30. Best value: 0.517126:  53%|█████▎    | 53/100 [02:25<01:51,  2.38s/it]Best trial: 30. Best value: 0.517126:  54%|█████▍    | 54/100 [02:25<01:46,  2.32s/it]Best trial: 54. Best value: 0.520114:  54%|█████▍    | 54/100 [02:28<01:46,  2.32s/it]Best trial: 54. Best value: 0.520114:  55%|█████▌    | 55/100 [02:28<01:44,  2.32s/it]Best trial: 54. Best value: 0.520114:  55%|█████▌    | 55/100 [02:29<01:44,  2.32s/it]Best trial: 54. Best value: 0.520114:  56%|█████▌    | 56/100 [02:29<01:32,  2.09s/it]Best trial: 54. Best value: 0.520114:  56%|█████▌    | 56/100 [02:31<01:32,  2.09s/it]Best trial: 54. Best value: 0.520114:  57%|█████▋    | 57/100 [02:31<01:28,  2.06s/it]Best trial: 54. Best value: 0.520114:  57%|█████▋    | 57/100 [02:34<01:28,  2.06s/it]Best trial: 54. Best value: 0.520114:  58%|█████▊    | 58/100 [02:34<01:34,  2.24s/it]Best trial: 54. Best value: 0.520114:  58%|█████▊    | 58/100 [02:36<01:34,  2.24s/it]Best trial: 54. Best value: 0.520114:  59%|█████▉    | 59/100 [02:36<01:25,  2.10s/it]Best trial: 54. Best value: 0.520114:  59%|█████▉    | 59/100 [02:39<01:25,  2.10s/it]Best trial: 54. Best value: 0.520114:  60%|██████    | 60/100 [02:39<01:36,  2.41s/it]Best trial: 54. Best value: 0.520114:  60%|██████    | 60/100 [02:41<01:36,  2.41s/it]Best trial: 54. Best value: 0.520114:  61%|██████    | 61/100 [02:41<01:32,  2.38s/it]Best trial: 54. Best value: 0.520114:  61%|██████    | 61/100 [02:44<01:32,  2.38s/it]Best trial: 54. Best value: 0.520114:  62%|██████▏   | 62/100 [02:44<01:33,  2.47s/it]Best trial: 54. Best value: 0.520114:  62%|██████▏   | 62/100 [02:46<01:33,  2.47s/it]Best trial: 54. Best value: 0.520114:  63%|██████▎   | 63/100 [02:46<01:26,  2.35s/it]Best trial: 54. Best value: 0.520114:  63%|██████▎   | 63/100 [02:48<01:26,  2.35s/it]Best trial: 54. Best value: 0.520114:  64%|██████▍   | 64/100 [02:48<01:21,  2.27s/it]Best trial: 54. Best value: 0.520114:  64%|██████▍   | 64/100 [02:50<01:21,  2.27s/it]Best trial: 54. Best value: 0.520114:  65%|██████▌   | 65/100 [02:50<01:18,  2.24s/it]Best trial: 54. Best value: 0.520114:  65%|██████▌   | 65/100 [02:52<01:18,  2.24s/it]Best trial: 54. Best value: 0.520114:  66%|██████▌   | 66/100 [02:52<01:10,  2.07s/it]Best trial: 54. Best value: 0.520114:  66%|██████▌   | 66/100 [02:54<01:10,  2.07s/it]Best trial: 54. Best value: 0.520114:  67%|██████▋   | 67/100 [02:54<01:05,  2.00s/it]Best trial: 54. Best value: 0.520114:  67%|██████▋   | 67/100 [02:56<01:05,  2.00s/it]Best trial: 54. Best value: 0.520114:  68%|██████▊   | 68/100 [02:56<01:06,  2.09s/it]Best trial: 54. Best value: 0.520114:  68%|██████▊   | 68/100 [02:58<01:06,  2.09s/it]Best trial: 54. Best value: 0.520114:  69%|██████▉   | 69/100 [02:58<01:05,  2.11s/it]Best trial: 54. Best value: 0.520114:  69%|██████▉   | 69/100 [03:01<01:05,  2.11s/it]Best trial: 54. Best value: 0.520114:  70%|███████   | 70/100 [03:01<01:08,  2.28s/it]Best trial: 54. Best value: 0.520114:  70%|███████   | 70/100 [03:04<01:08,  2.28s/it]Best trial: 54. Best value: 0.520114:  71%|███████   | 71/100 [03:04<01:13,  2.54s/it]Best trial: 54. Best value: 0.520114:  71%|███████   | 71/100 [03:06<01:13,  2.54s/it]Best trial: 54. Best value: 0.520114:  72%|███████▏  | 72/100 [03:06<01:11,  2.56s/it]Best trial: 54. Best value: 0.520114:  72%|███████▏  | 72/100 [03:09<01:11,  2.56s/it]Best trial: 54. Best value: 0.520114:  73%|███████▎  | 73/100 [03:09<01:11,  2.64s/it]Best trial: 54. Best value: 0.520114:  73%|███████▎  | 73/100 [03:12<01:11,  2.64s/it]Best trial: 54. Best value: 0.520114:  74%|███████▍  | 74/100 [03:12<01:11,  2.75s/it]Best trial: 54. Best value: 0.520114:  74%|███████▍  | 74/100 [03:15<01:11,  2.75s/it]Best trial: 54. Best value: 0.520114:  75%|███████▌  | 75/100 [03:15<01:08,  2.73s/it]Best trial: 54. Best value: 0.520114:  75%|███████▌  | 75/100 [03:18<01:08,  2.73s/it]Best trial: 54. Best value: 0.520114:  76%|███████▌  | 76/100 [03:18<01:08,  2.87s/it]Best trial: 54. Best value: 0.520114:  76%|███████▌  | 76/100 [03:21<01:08,  2.87s/it]Best trial: 54. Best value: 0.520114:  77%|███████▋  | 77/100 [03:21<01:08,  2.99s/it]Best trial: 54. Best value: 0.520114:  77%|███████▋  | 77/100 [03:24<01:08,  2.99s/it]Best trial: 54. Best value: 0.520114:  78%|███████▊  | 78/100 [03:24<01:02,  2.84s/it]Best trial: 54. Best value: 0.520114:  78%|███████▊  | 78/100 [03:26<01:02,  2.84s/it]Best trial: 54. Best value: 0.520114:  79%|███████▉  | 79/100 [03:26<00:52,  2.50s/it]Best trial: 79. Best value: 0.535845:  79%|███████▉  | 79/100 [03:29<00:52,  2.50s/it]Best trial: 79. Best value: 0.535845:  80%|████████  | 80/100 [03:29<00:53,  2.65s/it]Best trial: 79. Best value: 0.535845:  80%|████████  | 80/100 [03:31<00:53,  2.65s/it]Best trial: 79. Best value: 0.535845:  81%|████████  | 81/100 [03:31<00:50,  2.65s/it]Best trial: 81. Best value: 0.536519:  81%|████████  | 81/100 [03:34<00:50,  2.65s/it]Best trial: 81. Best value: 0.536519:  82%|████████▏ | 82/100 [03:34<00:50,  2.78s/it]Best trial: 81. Best value: 0.536519:  82%|████████▏ | 82/100 [03:37<00:50,  2.78s/it]Best trial: 81. Best value: 0.536519:  83%|████████▎ | 83/100 [03:37<00:48,  2.84s/it]Best trial: 81. Best value: 0.536519:  83%|████████▎ | 83/100 [03:40<00:48,  2.84s/it]Best trial: 81. Best value: 0.536519:  84%|████████▍ | 84/100 [03:40<00:45,  2.84s/it]Best trial: 81. Best value: 0.536519:  84%|████████▍ | 84/100 [03:43<00:45,  2.84s/it]Best trial: 81. Best value: 0.536519:  85%|████████▌ | 85/100 [03:43<00:43,  2.89s/it]Best trial: 81. Best value: 0.536519:  85%|████████▌ | 85/100 [03:46<00:43,  2.89s/it]Best trial: 81. Best value: 0.536519:  86%|████████▌ | 86/100 [03:46<00:41,  2.98s/it]Best trial: 81. Best value: 0.536519:  86%|████████▌ | 86/100 [03:50<00:41,  2.98s/it]Best trial: 81. Best value: 0.536519:  87%|████████▋ | 87/100 [03:50<00:41,  3.23s/it]Best trial: 81. Best value: 0.536519:  87%|████████▋ | 87/100 [03:53<00:41,  3.23s/it]Best trial: 81. Best value: 0.536519:  88%|████████▊ | 88/100 [03:53<00:38,  3.19s/it]Best trial: 81. Best value: 0.536519:  88%|████████▊ | 88/100 [03:56<00:38,  3.19s/it]Best trial: 81. Best value: 0.536519:  89%|████████▉ | 89/100 [03:56<00:32,  2.92s/it]Best trial: 81. Best value: 0.536519:  89%|████████▉ | 89/100 [03:58<00:32,  2.92s/it]Best trial: 81. Best value: 0.536519:  90%|█████████ | 90/100 [03:58<00:28,  2.83s/it]Best trial: 81. Best value: 0.536519:  90%|█████████ | 90/100 [04:01<00:28,  2.83s/it]Best trial: 81. Best value: 0.536519:  91%|█████████ | 91/100 [04:01<00:24,  2.70s/it]Best trial: 81. Best value: 0.536519:  91%|█████████ | 91/100 [04:03<00:24,  2.70s/it]Best trial: 81. Best value: 0.536519:  92%|█████████▏| 92/100 [04:03<00:20,  2.55s/it]Best trial: 81. Best value: 0.536519:  92%|█████████▏| 92/100 [04:05<00:20,  2.55s/it]Best trial: 81. Best value: 0.536519:  93%|█████████▎| 93/100 [04:05<00:16,  2.35s/it]Best trial: 81. Best value: 0.536519:  93%|█████████▎| 93/100 [04:07<00:16,  2.35s/it]Best trial: 81. Best value: 0.536519:  94%|█████████▍| 94/100 [04:07<00:14,  2.37s/it]Best trial: 81. Best value: 0.536519:  94%|█████████▍| 94/100 [04:09<00:14,  2.37s/it]Best trial: 81. Best value: 0.536519:  95%|█████████▌| 95/100 [04:09<00:11,  2.31s/it]Best trial: 81. Best value: 0.536519:  95%|█████████▌| 95/100 [04:12<00:11,  2.31s/it]Best trial: 81. Best value: 0.536519:  96%|█████████▌| 96/100 [04:12<00:09,  2.44s/it]Best trial: 81. Best value: 0.536519:  96%|█████████▌| 96/100 [04:14<00:09,  2.44s/it]Best trial: 81. Best value: 0.536519:  97%|█████████▋| 97/100 [04:14<00:07,  2.35s/it]Best trial: 81. Best value: 0.536519:  97%|█████████▋| 97/100 [04:17<00:07,  2.35s/it]Best trial: 81. Best value: 0.536519:  98%|█████████▊| 98/100 [04:17<00:04,  2.46s/it]Best trial: 81. Best value: 0.536519:  98%|█████████▊| 98/100 [04:19<00:04,  2.46s/it]Best trial: 81. Best value: 0.536519:  99%|█████████▉| 99/100 [04:19<00:02,  2.50s/it]Best trial: 81. Best value: 0.536519:  99%|█████████▉| 99/100 [04:22<00:02,  2.50s/it]Best trial: 81. Best value: 0.536519: 100%|██████████| 100/100 [04:22<00:00,  2.50s/it]Best trial: 81. Best value: 0.536519: 100%|██████████| 100/100 [04:22<00:00,  2.62s/it]
2025-11-30 12:44:24,936 - INFO - HPO Complete. Best AUPRC: 0.5365
2025-11-30 12:44:24,937 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.05789989156346474, 'max_depth': 8, 'subsample': 0.7991518378954938, 'colsample_bytree': 0.8050285755471328, 'gamma': 4.260778578852788, 'reg_lambda': 8.291376625868445e-08, 'reg_alpha': 0.5545585427524914}
2025-11-30 12:44:24,937 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:44:27,118 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_only
2025-11-30 12:44:27,118 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:44:27,342 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:44:27,364 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:44:27,369 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 12:44:27,369 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:44:27,369 - INFO - Training model...
2025-11-30 12:44:28,445 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:44:33,525 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:44:33,525 - INFO - AUROC: 0.7107 (0.5943 - 0.8659)
2025-11-30 12:44:33,525 - INFO - AUPRC: 0.2019 (0.0276 - 0.4609)
2025-11-30 12:44:33,525 - INFO - Brier Score: 0.0188 (0.0147 - 0.0267)
2025-11-30 12:44:33,525 - INFO - Accuracy: 0.9754 (0.8994 - 0.9922)
2025-11-30 12:44:33,525 - INFO - Precision: 0.2667 (0.0744 - 1.0000)
2025-11-30 12:44:33,525 - INFO - Sensitivity (Recall): 0.4000 (0.1495 - 0.6167)
2025-11-30 12:44:33,525 - INFO - F1-Score: 0.3200 (0.0945 - 0.5752)
2025-11-30 12:44:33,525 - INFO - Best Threshold: 0.2800 (0.0400 - 0.9700)
2025-11-30 12:44:33,525 - INFO - Specificity: 0.9839 (0.9058 - 1.0000)
2025-11-30 12:44:33,537 - INFO - Calculating SHAP values...
2025-11-30 12:44:34,472 - INFO - SHAP plots saved.
2025-11-30 12:44:34,474 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:44:35,790 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: pleth_only
2025-11-30 12:44:35,790 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:44:36,062 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:44:36,083 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:44:36,089 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:44:36,089 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0981558:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0981558:   1%|          | 1/100 [00:02<03:22,  2.04s/it]Best trial: 1. Best value: 0.111148:   1%|          | 1/100 [00:04<03:22,  2.04s/it] Best trial: 1. Best value: 0.111148:   2%|▏         | 2/100 [00:04<03:41,  2.26s/it]Best trial: 1. Best value: 0.111148:   2%|▏         | 2/100 [00:06<03:41,  2.26s/it]Best trial: 1. Best value: 0.111148:   3%|▎         | 3/100 [00:06<03:43,  2.30s/it]Best trial: 3. Best value: 0.13648:   3%|▎         | 3/100 [00:09<03:43,  2.30s/it] Best trial: 3. Best value: 0.13648:   4%|▍         | 4/100 [00:09<03:48,  2.38s/it]Best trial: 3. Best value: 0.13648:   4%|▍         | 4/100 [00:10<03:48,  2.38s/it]Best trial: 3. Best value: 0.13648:   5%|▌         | 5/100 [00:10<03:21,  2.12s/it]Best trial: 3. Best value: 0.13648:   5%|▌         | 5/100 [00:13<03:21,  2.12s/it]Best trial: 3. Best value: 0.13648:   6%|▌         | 6/100 [00:13<03:20,  2.13s/it]Best trial: 6. Best value: 0.141527:   6%|▌         | 6/100 [00:15<03:20,  2.13s/it]Best trial: 6. Best value: 0.141527:   7%|▋         | 7/100 [00:15<03:20,  2.15s/it]Best trial: 6. Best value: 0.141527:   7%|▋         | 7/100 [00:17<03:20,  2.15s/it]Best trial: 6. Best value: 0.141527:   8%|▊         | 8/100 [00:17<03:24,  2.23s/it]Best trial: 6. Best value: 0.141527:   8%|▊         | 8/100 [00:20<03:24,  2.23s/it]Best trial: 6. Best value: 0.141527:   9%|▉         | 9/100 [00:20<03:30,  2.31s/it]Best trial: 6. Best value: 0.141527:   9%|▉         | 9/100 [00:22<03:30,  2.31s/it]Best trial: 6. Best value: 0.141527:  10%|█         | 10/100 [00:22<03:27,  2.30s/it]Best trial: 10. Best value: 0.146326:  10%|█         | 10/100 [00:24<03:27,  2.30s/it]Best trial: 10. Best value: 0.146326:  11%|█         | 11/100 [00:24<03:18,  2.23s/it]Best trial: 10. Best value: 0.146326:  11%|█         | 11/100 [00:26<03:18,  2.23s/it]Best trial: 10. Best value: 0.146326:  12%|█▏        | 12/100 [00:26<03:14,  2.21s/it]Best trial: 10. Best value: 0.146326:  12%|█▏        | 12/100 [00:29<03:14,  2.21s/it]Best trial: 10. Best value: 0.146326:  13%|█▎        | 13/100 [00:29<03:39,  2.53s/it]Best trial: 10. Best value: 0.146326:  13%|█▎        | 13/100 [00:32<03:39,  2.53s/it]Best trial: 10. Best value: 0.146326:  14%|█▍        | 14/100 [00:32<03:26,  2.40s/it]Best trial: 14. Best value: 0.160438:  14%|█▍        | 14/100 [00:34<03:26,  2.40s/it]Best trial: 14. Best value: 0.160438:  15%|█▌        | 15/100 [00:34<03:15,  2.30s/it]Best trial: 14. Best value: 0.160438:  15%|█▌        | 15/100 [00:36<03:15,  2.30s/it]Best trial: 14. Best value: 0.160438:  16%|█▌        | 16/100 [00:36<03:05,  2.21s/it]Best trial: 14. Best value: 0.160438:  16%|█▌        | 16/100 [00:39<03:05,  2.21s/it]Best trial: 14. Best value: 0.160438:  17%|█▋        | 17/100 [00:39<03:34,  2.59s/it]Best trial: 14. Best value: 0.160438:  17%|█▋        | 17/100 [00:41<03:34,  2.59s/it]Best trial: 14. Best value: 0.160438:  18%|█▊        | 18/100 [00:41<03:23,  2.48s/it]Best trial: 18. Best value: 0.163856:  18%|█▊        | 18/100 [00:43<03:23,  2.48s/it]Best trial: 18. Best value: 0.163856:  19%|█▉        | 19/100 [00:43<02:56,  2.17s/it]Best trial: 18. Best value: 0.163856:  19%|█▉        | 19/100 [00:45<02:56,  2.17s/it]Best trial: 18. Best value: 0.163856:  20%|██        | 20/100 [00:45<02:42,  2.03s/it]Best trial: 18. Best value: 0.163856:  20%|██        | 20/100 [00:47<02:42,  2.03s/it]Best trial: 18. Best value: 0.163856:  21%|██        | 21/100 [00:47<02:45,  2.09s/it]Best trial: 18. Best value: 0.163856:  21%|██        | 21/100 [00:49<02:45,  2.09s/it]Best trial: 18. Best value: 0.163856:  22%|██▏       | 22/100 [00:49<02:54,  2.23s/it]Best trial: 18. Best value: 0.163856:  22%|██▏       | 22/100 [00:51<02:54,  2.23s/it]Best trial: 18. Best value: 0.163856:  23%|██▎       | 23/100 [00:51<02:50,  2.22s/it]Best trial: 18. Best value: 0.163856:  23%|██▎       | 23/100 [00:54<02:50,  2.22s/it]Best trial: 18. Best value: 0.163856:  24%|██▍       | 24/100 [00:54<02:56,  2.32s/it]Best trial: 18. Best value: 0.163856:  24%|██▍       | 24/100 [00:56<02:56,  2.32s/it]Best trial: 18. Best value: 0.163856:  25%|██▌       | 25/100 [00:56<02:41,  2.15s/it]Best trial: 18. Best value: 0.163856:  25%|██▌       | 25/100 [00:58<02:41,  2.15s/it]Best trial: 18. Best value: 0.163856:  26%|██▌       | 26/100 [00:58<02:36,  2.11s/it]Best trial: 18. Best value: 0.163856:  26%|██▌       | 26/100 [01:00<02:36,  2.11s/it]Best trial: 18. Best value: 0.163856:  27%|██▋       | 27/100 [01:00<02:36,  2.15s/it]Best trial: 18. Best value: 0.163856:  27%|██▋       | 27/100 [01:02<02:36,  2.15s/it]Best trial: 18. Best value: 0.163856:  28%|██▊       | 28/100 [01:02<02:25,  2.02s/it]Best trial: 18. Best value: 0.163856:  28%|██▊       | 28/100 [01:04<02:25,  2.02s/it]Best trial: 18. Best value: 0.163856:  29%|██▉       | 29/100 [01:04<02:25,  2.05s/it]Best trial: 18. Best value: 0.163856:  29%|██▉       | 29/100 [01:06<02:25,  2.05s/it]Best trial: 18. Best value: 0.163856:  30%|███       | 30/100 [01:06<02:21,  2.03s/it]Best trial: 18. Best value: 0.163856:  30%|███       | 30/100 [01:08<02:21,  2.03s/it]Best trial: 18. Best value: 0.163856:  31%|███       | 31/100 [01:08<02:13,  1.94s/it]Best trial: 18. Best value: 0.163856:  31%|███       | 31/100 [01:09<02:13,  1.94s/it]Best trial: 18. Best value: 0.163856:  32%|███▏      | 32/100 [01:09<02:02,  1.80s/it]Best trial: 18. Best value: 0.163856:  32%|███▏      | 32/100 [01:11<02:02,  1.80s/it]Best trial: 18. Best value: 0.163856:  33%|███▎      | 33/100 [01:11<02:10,  1.94s/it]Best trial: 18. Best value: 0.163856:  33%|███▎      | 33/100 [01:13<02:10,  1.94s/it]Best trial: 18. Best value: 0.163856:  34%|███▍      | 34/100 [01:13<02:02,  1.86s/it]Best trial: 18. Best value: 0.163856:  34%|███▍      | 34/100 [01:16<02:02,  1.86s/it]Best trial: 18. Best value: 0.163856:  35%|███▌      | 35/100 [01:16<02:12,  2.04s/it]Best trial: 18. Best value: 0.163856:  35%|███▌      | 35/100 [01:17<02:12,  2.04s/it]Best trial: 18. Best value: 0.163856:  36%|███▌      | 36/100 [01:17<02:06,  1.98s/it]Best trial: 18. Best value: 0.163856:  36%|███▌      | 36/100 [01:19<02:06,  1.98s/it]Best trial: 18. Best value: 0.163856:  37%|███▋      | 37/100 [01:19<01:58,  1.88s/it]Best trial: 18. Best value: 0.163856:  37%|███▋      | 37/100 [01:21<01:58,  1.88s/it]Best trial: 18. Best value: 0.163856:  38%|███▊      | 38/100 [01:21<02:01,  1.96s/it]Best trial: 18. Best value: 0.163856:  38%|███▊      | 38/100 [01:24<02:01,  1.96s/it]Best trial: 18. Best value: 0.163856:  39%|███▉      | 39/100 [01:24<02:11,  2.16s/it]Best trial: 18. Best value: 0.163856:  39%|███▉      | 39/100 [01:26<02:11,  2.16s/it]Best trial: 18. Best value: 0.163856:  40%|████      | 40/100 [01:26<02:04,  2.08s/it]Best trial: 18. Best value: 0.163856:  40%|████      | 40/100 [01:27<02:04,  2.08s/it]Best trial: 18. Best value: 0.163856:  41%|████      | 41/100 [01:27<01:53,  1.93s/it]Best trial: 18. Best value: 0.163856:  41%|████      | 41/100 [01:29<01:53,  1.93s/it]Best trial: 18. Best value: 0.163856:  42%|████▏     | 42/100 [01:29<01:48,  1.87s/it]Best trial: 18. Best value: 0.163856:  42%|████▏     | 42/100 [01:31<01:48,  1.87s/it]Best trial: 18. Best value: 0.163856:  43%|████▎     | 43/100 [01:31<01:49,  1.92s/it]Best trial: 18. Best value: 0.163856:  43%|████▎     | 43/100 [01:33<01:49,  1.92s/it]Best trial: 18. Best value: 0.163856:  44%|████▍     | 44/100 [01:33<01:56,  2.08s/it]Best trial: 18. Best value: 0.163856:  44%|████▍     | 44/100 [01:35<01:56,  2.08s/it]Best trial: 18. Best value: 0.163856:  45%|████▌     | 45/100 [01:35<01:44,  1.91s/it]Best trial: 18. Best value: 0.163856:  45%|████▌     | 45/100 [01:37<01:44,  1.91s/it]Best trial: 18. Best value: 0.163856:  46%|████▌     | 46/100 [01:37<01:40,  1.86s/it]Best trial: 18. Best value: 0.163856:  46%|████▌     | 46/100 [01:39<01:40,  1.86s/it]Best trial: 18. Best value: 0.163856:  47%|████▋     | 47/100 [01:39<01:37,  1.85s/it]Best trial: 18. Best value: 0.163856:  47%|████▋     | 47/100 [01:41<01:37,  1.85s/it]Best trial: 18. Best value: 0.163856:  48%|████▊     | 48/100 [01:41<01:48,  2.08s/it]Best trial: 18. Best value: 0.163856:  48%|████▊     | 48/100 [01:43<01:48,  2.08s/it]Best trial: 18. Best value: 0.163856:  49%|████▉     | 49/100 [01:43<01:36,  1.90s/it]Best trial: 18. Best value: 0.163856:  49%|████▉     | 49/100 [01:45<01:36,  1.90s/it]Best trial: 18. Best value: 0.163856:  50%|█████     | 50/100 [01:45<01:36,  1.92s/it]Best trial: 18. Best value: 0.163856:  50%|█████     | 50/100 [01:47<01:36,  1.92s/it]Best trial: 18. Best value: 0.163856:  51%|█████     | 51/100 [01:47<01:41,  2.08s/it]Best trial: 51. Best value: 0.167672:  51%|█████     | 51/100 [01:49<01:41,  2.08s/it]Best trial: 51. Best value: 0.167672:  52%|█████▏    | 52/100 [01:49<01:34,  1.98s/it]Best trial: 51. Best value: 0.167672:  52%|█████▏    | 52/100 [01:52<01:34,  1.98s/it]Best trial: 51. Best value: 0.167672:  53%|█████▎    | 53/100 [01:52<01:48,  2.30s/it]Best trial: 51. Best value: 0.167672:  53%|█████▎    | 53/100 [01:54<01:48,  2.30s/it]Best trial: 51. Best value: 0.167672:  54%|█████▍    | 54/100 [01:54<01:42,  2.24s/it]Best trial: 51. Best value: 0.167672:  54%|█████▍    | 54/100 [01:56<01:42,  2.24s/it]Best trial: 51. Best value: 0.167672:  55%|█████▌    | 55/100 [01:56<01:38,  2.18s/it]Best trial: 51. Best value: 0.167672:  55%|█████▌    | 55/100 [01:59<01:38,  2.18s/it]Best trial: 51. Best value: 0.167672:  56%|█████▌    | 56/100 [01:59<01:40,  2.29s/it]Best trial: 51. Best value: 0.167672:  56%|█████▌    | 56/100 [02:01<01:40,  2.29s/it]Best trial: 51. Best value: 0.167672:  57%|█████▋    | 57/100 [02:01<01:39,  2.32s/it]Best trial: 51. Best value: 0.167672:  57%|█████▋    | 57/100 [02:04<01:39,  2.32s/it]Best trial: 51. Best value: 0.167672:  58%|█████▊    | 58/100 [02:04<01:46,  2.55s/it]Best trial: 51. Best value: 0.167672:  58%|█████▊    | 58/100 [02:07<01:46,  2.55s/it]Best trial: 51. Best value: 0.167672:  59%|█████▉    | 59/100 [02:07<01:51,  2.72s/it]Best trial: 51. Best value: 0.167672:  59%|█████▉    | 59/100 [02:09<01:51,  2.72s/it]Best trial: 51. Best value: 0.167672:  60%|██████    | 60/100 [02:09<01:40,  2.52s/it]Best trial: 51. Best value: 0.167672:  60%|██████    | 60/100 [02:11<01:40,  2.52s/it]Best trial: 51. Best value: 0.167672:  61%|██████    | 61/100 [02:11<01:28,  2.27s/it]Best trial: 51. Best value: 0.167672:  61%|██████    | 61/100 [02:14<01:28,  2.27s/it]Best trial: 51. Best value: 0.167672:  62%|██████▏   | 62/100 [02:14<01:37,  2.56s/it]Best trial: 51. Best value: 0.167672:  62%|██████▏   | 62/100 [02:17<01:37,  2.56s/it]Best trial: 51. Best value: 0.167672:  63%|██████▎   | 63/100 [02:17<01:36,  2.60s/it]Best trial: 51. Best value: 0.167672:  63%|██████▎   | 63/100 [02:19<01:36,  2.60s/it]Best trial: 51. Best value: 0.167672:  64%|██████▍   | 64/100 [02:19<01:32,  2.56s/it]Best trial: 51. Best value: 0.167672:  64%|██████▍   | 64/100 [02:21<01:32,  2.56s/it]Best trial: 51. Best value: 0.167672:  65%|██████▌   | 65/100 [02:21<01:23,  2.39s/it]Best trial: 51. Best value: 0.167672:  65%|██████▌   | 65/100 [02:23<01:23,  2.39s/it]Best trial: 51. Best value: 0.167672:  66%|██████▌   | 66/100 [02:23<01:16,  2.24s/it]Best trial: 51. Best value: 0.167672:  66%|██████▌   | 66/100 [02:26<01:16,  2.24s/it]Best trial: 51. Best value: 0.167672:  67%|██████▋   | 67/100 [02:26<01:15,  2.29s/it]Best trial: 51. Best value: 0.167672:  67%|██████▋   | 67/100 [02:28<01:15,  2.29s/it]Best trial: 51. Best value: 0.167672:  68%|██████▊   | 68/100 [02:28<01:18,  2.47s/it]Best trial: 51. Best value: 0.167672:  68%|██████▊   | 68/100 [02:30<01:18,  2.47s/it]Best trial: 51. Best value: 0.167672:  69%|██████▉   | 69/100 [02:30<01:08,  2.21s/it]Best trial: 51. Best value: 0.167672:  69%|██████▉   | 69/100 [02:32<01:08,  2.21s/it]Best trial: 51. Best value: 0.167672:  70%|███████   | 70/100 [02:32<01:07,  2.26s/it]Best trial: 51. Best value: 0.167672:  70%|███████   | 70/100 [02:36<01:07,  2.26s/it]Best trial: 51. Best value: 0.167672:  71%|███████   | 71/100 [02:36<01:15,  2.60s/it]Best trial: 51. Best value: 0.167672:  71%|███████   | 71/100 [02:39<01:15,  2.60s/it]Best trial: 51. Best value: 0.167672:  72%|███████▏  | 72/100 [02:39<01:15,  2.71s/it]Best trial: 51. Best value: 0.167672:  72%|███████▏  | 72/100 [02:41<01:15,  2.71s/it]Best trial: 51. Best value: 0.167672:  73%|███████▎  | 73/100 [02:41<01:11,  2.66s/it]Best trial: 51. Best value: 0.167672:  73%|███████▎  | 73/100 [02:44<01:11,  2.66s/it]Best trial: 51. Best value: 0.167672:  74%|███████▍  | 74/100 [02:44<01:09,  2.67s/it]Best trial: 51. Best value: 0.167672:  74%|███████▍  | 74/100 [02:46<01:09,  2.67s/it]Best trial: 51. Best value: 0.167672:  75%|███████▌  | 75/100 [02:46<01:04,  2.58s/it]Best trial: 51. Best value: 0.167672:  75%|███████▌  | 75/100 [02:50<01:04,  2.58s/it]Best trial: 51. Best value: 0.167672:  76%|███████▌  | 76/100 [02:50<01:10,  2.93s/it]Best trial: 51. Best value: 0.167672:  76%|███████▌  | 76/100 [02:52<01:10,  2.93s/it]Best trial: 51. Best value: 0.167672:  77%|███████▋  | 77/100 [02:52<01:01,  2.68s/it]Best trial: 51. Best value: 0.167672:  77%|███████▋  | 77/100 [02:55<01:01,  2.68s/it]Best trial: 51. Best value: 0.167672:  78%|███████▊  | 78/100 [02:55<00:57,  2.63s/it]Best trial: 51. Best value: 0.167672:  78%|███████▊  | 78/100 [02:56<00:57,  2.63s/it]Best trial: 51. Best value: 0.167672:  79%|███████▉  | 79/100 [02:56<00:48,  2.33s/it]Best trial: 51. Best value: 0.167672:  79%|███████▉  | 79/100 [03:00<00:48,  2.33s/it]Best trial: 51. Best value: 0.167672:  80%|████████  | 80/100 [03:00<00:52,  2.60s/it]Best trial: 51. Best value: 0.167672:  80%|████████  | 80/100 [03:02<00:52,  2.60s/it]Best trial: 51. Best value: 0.167672:  81%|████████  | 81/100 [03:02<00:49,  2.62s/it]Best trial: 51. Best value: 0.167672:  81%|████████  | 81/100 [03:05<00:49,  2.62s/it]Best trial: 51. Best value: 0.167672:  82%|████████▏ | 82/100 [03:05<00:45,  2.51s/it]Best trial: 51. Best value: 0.167672:  82%|████████▏ | 82/100 [03:08<00:45,  2.51s/it]Best trial: 51. Best value: 0.167672:  83%|████████▎ | 83/100 [03:08<00:48,  2.83s/it]Best trial: 51. Best value: 0.167672:  83%|████████▎ | 83/100 [03:11<00:48,  2.83s/it]Best trial: 51. Best value: 0.167672:  84%|████████▍ | 84/100 [03:11<00:47,  2.99s/it]Best trial: 51. Best value: 0.167672:  84%|████████▍ | 84/100 [03:13<00:47,  2.99s/it]Best trial: 51. Best value: 0.167672:  85%|████████▌ | 85/100 [03:13<00:40,  2.68s/it]Best trial: 85. Best value: 0.178878:  85%|████████▌ | 85/100 [03:16<00:40,  2.68s/it]Best trial: 85. Best value: 0.178878:  86%|████████▌ | 86/100 [03:16<00:35,  2.52s/it]Best trial: 85. Best value: 0.178878:  86%|████████▌ | 86/100 [03:18<00:35,  2.52s/it]Best trial: 85. Best value: 0.178878:  87%|████████▋ | 87/100 [03:18<00:32,  2.52s/it]Best trial: 85. Best value: 0.178878:  87%|████████▋ | 87/100 [03:21<00:32,  2.52s/it]Best trial: 85. Best value: 0.178878:  88%|████████▊ | 88/100 [03:21<00:31,  2.61s/it]Best trial: 85. Best value: 0.178878:  88%|████████▊ | 88/100 [03:23<00:31,  2.61s/it]Best trial: 85. Best value: 0.178878:  89%|████████▉ | 89/100 [03:23<00:27,  2.53s/it]Best trial: 85. Best value: 0.178878:  89%|████████▉ | 89/100 [03:25<00:27,  2.53s/it]Best trial: 85. Best value: 0.178878:  90%|█████████ | 90/100 [03:25<00:23,  2.31s/it]Best trial: 85. Best value: 0.178878:  90%|█████████ | 90/100 [03:28<00:23,  2.31s/it]Best trial: 85. Best value: 0.178878:  91%|█████████ | 91/100 [03:28<00:22,  2.46s/it]Best trial: 85. Best value: 0.178878:  91%|█████████ | 91/100 [03:30<00:22,  2.46s/it]Best trial: 85. Best value: 0.178878:  92%|█████████▏| 92/100 [03:30<00:18,  2.36s/it]Best trial: 85. Best value: 0.178878:  92%|█████████▏| 92/100 [03:32<00:18,  2.36s/it]Best trial: 85. Best value: 0.178878:  93%|█████████▎| 93/100 [03:32<00:15,  2.21s/it]Best trial: 85. Best value: 0.178878:  93%|█████████▎| 93/100 [03:34<00:15,  2.21s/it]Best trial: 85. Best value: 0.178878:  94%|█████████▍| 94/100 [03:34<00:12,  2.09s/it]Best trial: 85. Best value: 0.178878:  94%|█████████▍| 94/100 [03:36<00:12,  2.09s/it]Best trial: 85. Best value: 0.178878:  95%|█████████▌| 95/100 [03:36<00:11,  2.27s/it]Best trial: 85. Best value: 0.178878:  95%|█████████▌| 95/100 [03:39<00:11,  2.27s/it]Best trial: 85. Best value: 0.178878:  96%|█████████▌| 96/100 [03:39<00:09,  2.35s/it]Best trial: 85. Best value: 0.178878:  96%|█████████▌| 96/100 [03:41<00:09,  2.35s/it]Best trial: 85. Best value: 0.178878:  97%|█████████▋| 97/100 [03:41<00:06,  2.16s/it]Best trial: 85. Best value: 0.178878:  97%|█████████▋| 97/100 [03:43<00:06,  2.16s/it]Best trial: 85. Best value: 0.178878:  98%|█████████▊| 98/100 [03:43<00:04,  2.26s/it]Best trial: 85. Best value: 0.178878:  98%|█████████▊| 98/100 [03:45<00:04,  2.26s/it]Best trial: 85. Best value: 0.178878:  99%|█████████▉| 99/100 [03:45<00:02,  2.19s/it]Best trial: 85. Best value: 0.178878:  99%|█████████▉| 99/100 [03:48<00:02,  2.19s/it]Best trial: 85. Best value: 0.178878: 100%|██████████| 100/100 [03:48<00:00,  2.38s/it]Best trial: 85. Best value: 0.178878: 100%|██████████| 100/100 [03:48<00:00,  2.28s/it]
2025-11-30 12:48:24,544 - INFO - HPO Complete. Best AUPRC: 0.1789
2025-11-30 12:48:24,544 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0012839935784809766, 'max_depth': 3, 'subsample': 0.7518121202088963, 'colsample_bytree': 0.6895506705196447, 'gamma': 3.8254458810461696, 'reg_lambda': 0.0035082158176028633, 'reg_alpha': 1.963519353677661e-07}
2025-11-30 12:48:24,545 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:48:26,810 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: pleth_only
2025-11-30 12:48:26,810 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:48:26,999 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:48:27,021 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:48:27,025 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:48:27,025 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:48:27,025 - INFO - Training model...
2025-11-30 12:48:30,794 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:48:35,749 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:48:35,749 - INFO - AUROC: 0.6924 (0.5002 - 0.8222)
2025-11-30 12:48:35,749 - INFO - AUPRC: 0.0336 (0.0144 - 0.0935)
2025-11-30 12:48:35,749 - INFO - Brier Score: 0.0989 (0.0952 - 0.1052)
2025-11-30 12:48:35,749 - INFO - Accuracy: 0.8916 (0.5312 - 0.9512)
2025-11-30 12:48:35,749 - INFO - Precision: 0.0548 (0.0157 - 0.1141)
2025-11-30 12:48:35,749 - INFO - Sensitivity (Recall): 0.4000 (0.0808 - 0.9143)
2025-11-30 12:48:35,749 - INFO - F1-Score: 0.0964 (0.0302 - 0.1894)
2025-11-30 12:48:35,749 - INFO - Best Threshold: 0.4200 (0.2980 - 0.4800)
2025-11-30 12:48:35,749 - INFO - Specificity: 0.8988 (0.5292 - 0.9636)
2025-11-30 12:48:35,766 - INFO - Calculating SHAP values...
2025-11-30 12:48:36,980 - INFO - SHAP plots saved.
2025-11-30 12:48:36,981 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:48:38,336 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: ecg_only
2025-11-30 12:48:38,336 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:48:38,568 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:48:38,591 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:48:38,596 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:48:38,597 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0704105:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0704105:   1%|          | 1/100 [00:01<03:06,  1.89s/it]Best trial: 1. Best value: 0.0787684:   1%|          | 1/100 [00:04<03:06,  1.89s/it]Best trial: 1. Best value: 0.0787684:   2%|▏         | 2/100 [00:04<03:36,  2.21s/it]Best trial: 2. Best value: 0.134346:   2%|▏         | 2/100 [00:06<03:36,  2.21s/it] Best trial: 2. Best value: 0.134346:   3%|▎         | 3/100 [00:06<03:48,  2.36s/it]Best trial: 2. Best value: 0.134346:   3%|▎         | 3/100 [00:08<03:48,  2.36s/it]Best trial: 2. Best value: 0.134346:   4%|▍         | 4/100 [00:08<03:35,  2.24s/it]Best trial: 2. Best value: 0.134346:   4%|▍         | 4/100 [00:10<03:35,  2.24s/it]Best trial: 2. Best value: 0.134346:   5%|▌         | 5/100 [00:10<03:24,  2.15s/it]Best trial: 2. Best value: 0.134346:   5%|▌         | 5/100 [00:13<03:24,  2.15s/it]Best trial: 2. Best value: 0.134346:   6%|▌         | 6/100 [00:13<03:25,  2.18s/it]Best trial: 2. Best value: 0.134346:   6%|▌         | 6/100 [00:15<03:25,  2.18s/it]Best trial: 2. Best value: 0.134346:   7%|▋         | 7/100 [00:15<03:41,  2.38s/it]Best trial: 2. Best value: 0.134346:   7%|▋         | 7/100 [00:18<03:41,  2.38s/it]Best trial: 2. Best value: 0.134346:   8%|▊         | 8/100 [00:18<03:33,  2.33s/it]Best trial: 2. Best value: 0.134346:   8%|▊         | 8/100 [00:20<03:33,  2.33s/it]Best trial: 2. Best value: 0.134346:   9%|▉         | 9/100 [00:20<03:19,  2.20s/it]Best trial: 2. Best value: 0.134346:   9%|▉         | 9/100 [00:22<03:19,  2.20s/it]Best trial: 2. Best value: 0.134346:  10%|█         | 10/100 [00:22<03:23,  2.26s/it]Best trial: 2. Best value: 0.134346:  10%|█         | 10/100 [00:25<03:23,  2.26s/it]Best trial: 2. Best value: 0.134346:  11%|█         | 11/100 [00:25<03:30,  2.37s/it]Best trial: 2. Best value: 0.134346:  11%|█         | 11/100 [00:27<03:30,  2.37s/it]Best trial: 2. Best value: 0.134346:  12%|█▏        | 12/100 [00:27<03:17,  2.25s/it]Best trial: 2. Best value: 0.134346:  12%|█▏        | 12/100 [00:29<03:17,  2.25s/it]Best trial: 2. Best value: 0.134346:  13%|█▎        | 13/100 [00:29<03:08,  2.17s/it]Best trial: 2. Best value: 0.134346:  13%|█▎        | 13/100 [00:30<03:08,  2.17s/it]Best trial: 2. Best value: 0.134346:  14%|█▍        | 14/100 [00:30<03:00,  2.10s/it]Best trial: 2. Best value: 0.134346:  14%|█▍        | 14/100 [00:32<03:00,  2.10s/it]Best trial: 2. Best value: 0.134346:  15%|█▌        | 15/100 [00:32<02:47,  1.97s/it]Best trial: 2. Best value: 0.134346:  15%|█▌        | 15/100 [00:34<02:47,  1.97s/it]Best trial: 2. Best value: 0.134346:  16%|█▌        | 16/100 [00:34<02:48,  2.00s/it]Best trial: 2. Best value: 0.134346:  16%|█▌        | 16/100 [00:37<02:48,  2.00s/it]Best trial: 2. Best value: 0.134346:  17%|█▋        | 17/100 [00:37<02:57,  2.14s/it]Best trial: 2. Best value: 0.134346:  17%|█▋        | 17/100 [00:39<02:57,  2.14s/it]Best trial: 2. Best value: 0.134346:  18%|█▊        | 18/100 [00:39<02:56,  2.15s/it]Best trial: 2. Best value: 0.134346:  18%|█▊        | 18/100 [00:41<02:56,  2.15s/it]Best trial: 2. Best value: 0.134346:  19%|█▉        | 19/100 [00:41<03:02,  2.25s/it]Best trial: 2. Best value: 0.134346:  19%|█▉        | 19/100 [00:43<03:02,  2.25s/it]Best trial: 2. Best value: 0.134346:  20%|██        | 20/100 [00:43<02:45,  2.07s/it]Best trial: 2. Best value: 0.134346:  20%|██        | 20/100 [00:45<02:45,  2.07s/it]Best trial: 2. Best value: 0.134346:  21%|██        | 21/100 [00:45<02:32,  1.94s/it]Best trial: 2. Best value: 0.134346:  21%|██        | 21/100 [00:47<02:32,  1.94s/it]Best trial: 2. Best value: 0.134346:  22%|██▏       | 22/100 [00:47<02:36,  2.00s/it]Best trial: 2. Best value: 0.134346:  22%|██▏       | 22/100 [00:49<02:36,  2.00s/it]Best trial: 2. Best value: 0.134346:  23%|██▎       | 23/100 [00:49<02:40,  2.09s/it]Best trial: 2. Best value: 0.134346:  23%|██▎       | 23/100 [00:51<02:40,  2.09s/it]Best trial: 2. Best value: 0.134346:  24%|██▍       | 24/100 [00:51<02:37,  2.08s/it]Best trial: 2. Best value: 0.134346:  24%|██▍       | 24/100 [00:53<02:37,  2.08s/it]Best trial: 2. Best value: 0.134346:  25%|██▌       | 25/100 [00:53<02:41,  2.16s/it]Best trial: 2. Best value: 0.134346:  25%|██▌       | 25/100 [00:56<02:41,  2.16s/it]Best trial: 2. Best value: 0.134346:  26%|██▌       | 26/100 [00:56<02:49,  2.29s/it]Best trial: 2. Best value: 0.134346:  26%|██▌       | 26/100 [00:58<02:49,  2.29s/it]Best trial: 2. Best value: 0.134346:  27%|██▋       | 27/100 [00:58<02:36,  2.15s/it]Best trial: 2. Best value: 0.134346:  27%|██▋       | 27/100 [01:00<02:36,  2.15s/it]Best trial: 2. Best value: 0.134346:  28%|██▊       | 28/100 [01:00<02:43,  2.28s/it]Best trial: 2. Best value: 0.134346:  28%|██▊       | 28/100 [01:03<02:43,  2.28s/it]Best trial: 2. Best value: 0.134346:  29%|██▉       | 29/100 [01:03<02:37,  2.22s/it]Best trial: 2. Best value: 0.134346:  29%|██▉       | 29/100 [01:05<02:37,  2.22s/it]Best trial: 2. Best value: 0.134346:  30%|███       | 30/100 [01:05<02:32,  2.18s/it]Best trial: 30. Best value: 0.142915:  30%|███       | 30/100 [01:07<02:32,  2.18s/it]Best trial: 30. Best value: 0.142915:  31%|███       | 31/100 [01:07<02:43,  2.38s/it]Best trial: 30. Best value: 0.142915:  31%|███       | 31/100 [01:10<02:43,  2.38s/it]Best trial: 30. Best value: 0.142915:  32%|███▏      | 32/100 [01:10<02:46,  2.45s/it]Best trial: 30. Best value: 0.142915:  32%|███▏      | 32/100 [01:13<02:46,  2.45s/it]Best trial: 30. Best value: 0.142915:  33%|███▎      | 33/100 [01:13<03:02,  2.73s/it]Best trial: 30. Best value: 0.142915:  33%|███▎      | 33/100 [01:16<03:02,  2.73s/it]Best trial: 30. Best value: 0.142915:  34%|███▍      | 34/100 [01:16<02:49,  2.57s/it]Best trial: 30. Best value: 0.142915:  34%|███▍      | 34/100 [01:18<02:49,  2.57s/it]Best trial: 30. Best value: 0.142915:  35%|███▌      | 35/100 [01:18<02:40,  2.48s/it]Best trial: 30. Best value: 0.142915:  35%|███▌      | 35/100 [01:20<02:40,  2.48s/it]Best trial: 30. Best value: 0.142915:  36%|███▌      | 36/100 [01:20<02:28,  2.32s/it]Best trial: 30. Best value: 0.142915:  36%|███▌      | 36/100 [01:23<02:28,  2.32s/it]Best trial: 30. Best value: 0.142915:  37%|███▋      | 37/100 [01:23<02:36,  2.49s/it]Best trial: 30. Best value: 0.142915:  37%|███▋      | 37/100 [01:25<02:36,  2.49s/it]Best trial: 30. Best value: 0.142915:  38%|███▊      | 38/100 [01:25<02:26,  2.37s/it]Best trial: 30. Best value: 0.142915:  38%|███▊      | 38/100 [01:27<02:26,  2.37s/it]Best trial: 30. Best value: 0.142915:  39%|███▉      | 39/100 [01:27<02:24,  2.37s/it]Best trial: 30. Best value: 0.142915:  39%|███▉      | 39/100 [01:29<02:24,  2.37s/it]Best trial: 30. Best value: 0.142915:  40%|████      | 40/100 [01:29<02:15,  2.25s/it]Best trial: 30. Best value: 0.142915:  40%|████      | 40/100 [01:31<02:15,  2.25s/it]Best trial: 30. Best value: 0.142915:  41%|████      | 41/100 [01:31<02:11,  2.23s/it]Best trial: 30. Best value: 0.142915:  41%|████      | 41/100 [01:33<02:11,  2.23s/it]Best trial: 30. Best value: 0.142915:  42%|████▏     | 42/100 [01:33<02:02,  2.11s/it]Best trial: 30. Best value: 0.142915:  42%|████▏     | 42/100 [01:36<02:02,  2.11s/it]Best trial: 30. Best value: 0.142915:  43%|████▎     | 43/100 [01:36<02:11,  2.30s/it]Best trial: 43. Best value: 0.151179:  43%|████▎     | 43/100 [01:38<02:11,  2.30s/it]Best trial: 43. Best value: 0.151179:  44%|████▍     | 44/100 [01:38<02:06,  2.26s/it]Best trial: 43. Best value: 0.151179:  44%|████▍     | 44/100 [01:40<02:06,  2.26s/it]Best trial: 43. Best value: 0.151179:  45%|████▌     | 45/100 [01:40<02:05,  2.28s/it]Best trial: 43. Best value: 0.151179:  45%|████▌     | 45/100 [01:44<02:05,  2.28s/it]Best trial: 43. Best value: 0.151179:  46%|████▌     | 46/100 [01:44<02:16,  2.53s/it]Best trial: 43. Best value: 0.151179:  46%|████▌     | 46/100 [01:48<02:16,  2.53s/it]Best trial: 43. Best value: 0.151179:  47%|████▋     | 47/100 [01:48<02:38,  2.99s/it]Best trial: 43. Best value: 0.151179:  47%|████▋     | 47/100 [01:50<02:38,  2.99s/it]Best trial: 43. Best value: 0.151179:  48%|████▊     | 48/100 [01:50<02:19,  2.69s/it]Best trial: 43. Best value: 0.151179:  48%|████▊     | 48/100 [01:53<02:19,  2.69s/it]Best trial: 43. Best value: 0.151179:  49%|████▉     | 49/100 [01:53<02:23,  2.81s/it]Best trial: 43. Best value: 0.151179:  49%|████▉     | 49/100 [01:54<02:23,  2.81s/it]Best trial: 43. Best value: 0.151179:  50%|█████     | 50/100 [01:54<02:03,  2.47s/it]Best trial: 43. Best value: 0.151179:  50%|█████     | 50/100 [01:57<02:03,  2.47s/it]Best trial: 43. Best value: 0.151179:  51%|█████     | 51/100 [01:57<01:59,  2.44s/it]Best trial: 43. Best value: 0.151179:  51%|█████     | 51/100 [01:59<01:59,  2.44s/it]Best trial: 43. Best value: 0.151179:  52%|█████▏    | 52/100 [01:59<01:49,  2.28s/it]Best trial: 43. Best value: 0.151179:  52%|█████▏    | 52/100 [02:00<01:49,  2.28s/it]Best trial: 43. Best value: 0.151179:  53%|█████▎    | 53/100 [02:00<01:37,  2.08s/it]Best trial: 43. Best value: 0.151179:  53%|█████▎    | 53/100 [02:02<01:37,  2.08s/it]Best trial: 43. Best value: 0.151179:  54%|█████▍    | 54/100 [02:02<01:37,  2.13s/it]Best trial: 43. Best value: 0.151179:  54%|█████▍    | 54/100 [02:04<01:37,  2.13s/it]Best trial: 43. Best value: 0.151179:  55%|█████▌    | 55/100 [02:04<01:29,  1.98s/it]Best trial: 43. Best value: 0.151179:  55%|█████▌    | 55/100 [02:07<01:29,  1.98s/it]Best trial: 43. Best value: 0.151179:  56%|█████▌    | 56/100 [02:07<01:38,  2.25s/it]Best trial: 56. Best value: 0.186675:  56%|█████▌    | 56/100 [02:10<01:38,  2.25s/it]Best trial: 56. Best value: 0.186675:  57%|█████▋    | 57/100 [02:10<01:41,  2.35s/it]Best trial: 56. Best value: 0.186675:  57%|█████▋    | 57/100 [02:12<01:41,  2.35s/it]Best trial: 56. Best value: 0.186675:  58%|█████▊    | 58/100 [02:12<01:36,  2.30s/it]Best trial: 56. Best value: 0.186675:  58%|█████▊    | 58/100 [02:15<01:36,  2.30s/it]Best trial: 56. Best value: 0.186675:  59%|█████▉    | 59/100 [02:15<01:40,  2.46s/it]Best trial: 56. Best value: 0.186675:  59%|█████▉    | 59/100 [02:17<01:40,  2.46s/it]Best trial: 56. Best value: 0.186675:  60%|██████    | 60/100 [02:17<01:34,  2.35s/it]Best trial: 56. Best value: 0.186675:  60%|██████    | 60/100 [02:19<01:34,  2.35s/it]Best trial: 56. Best value: 0.186675:  61%|██████    | 61/100 [02:19<01:33,  2.39s/it]Best trial: 56. Best value: 0.186675:  61%|██████    | 61/100 [02:22<01:33,  2.39s/it]Best trial: 56. Best value: 0.186675:  62%|██████▏   | 62/100 [02:22<01:32,  2.42s/it]Best trial: 56. Best value: 0.186675:  62%|██████▏   | 62/100 [02:25<01:32,  2.42s/it]Best trial: 56. Best value: 0.186675:  63%|██████▎   | 63/100 [02:25<01:34,  2.54s/it]Best trial: 56. Best value: 0.186675:  63%|██████▎   | 63/100 [02:27<01:34,  2.54s/it]Best trial: 56. Best value: 0.186675:  64%|██████▍   | 64/100 [02:27<01:33,  2.61s/it]Best trial: 56. Best value: 0.186675:  64%|██████▍   | 64/100 [02:30<01:33,  2.61s/it]Best trial: 56. Best value: 0.186675:  65%|██████▌   | 65/100 [02:30<01:29,  2.55s/it]Best trial: 56. Best value: 0.186675:  65%|██████▌   | 65/100 [02:32<01:29,  2.55s/it]Best trial: 56. Best value: 0.186675:  66%|██████▌   | 66/100 [02:32<01:27,  2.58s/it]Best trial: 56. Best value: 0.186675:  66%|██████▌   | 66/100 [02:34<01:27,  2.58s/it]Best trial: 56. Best value: 0.186675:  67%|██████▋   | 67/100 [02:34<01:17,  2.36s/it]Best trial: 56. Best value: 0.186675:  67%|██████▋   | 67/100 [02:36<01:17,  2.36s/it]Best trial: 56. Best value: 0.186675:  68%|██████▊   | 68/100 [02:36<01:10,  2.22s/it]Best trial: 56. Best value: 0.186675:  68%|██████▊   | 68/100 [02:38<01:10,  2.22s/it]Best trial: 56. Best value: 0.186675:  69%|██████▉   | 69/100 [02:38<01:10,  2.26s/it]Best trial: 56. Best value: 0.186675:  69%|██████▉   | 69/100 [02:40<01:10,  2.26s/it]Best trial: 56. Best value: 0.186675:  70%|███████   | 70/100 [02:40<01:05,  2.17s/it]Best trial: 56. Best value: 0.186675:  70%|███████   | 70/100 [02:43<01:05,  2.17s/it]Best trial: 56. Best value: 0.186675:  71%|███████   | 71/100 [02:43<01:05,  2.26s/it]Best trial: 56. Best value: 0.186675:  71%|███████   | 71/100 [02:46<01:05,  2.26s/it]Best trial: 56. Best value: 0.186675:  72%|███████▏  | 72/100 [02:46<01:07,  2.40s/it]Best trial: 56. Best value: 0.186675:  72%|███████▏  | 72/100 [02:47<01:07,  2.40s/it]Best trial: 56. Best value: 0.186675:  73%|███████▎  | 73/100 [02:47<00:59,  2.22s/it]Best trial: 56. Best value: 0.186675:  73%|███████▎  | 73/100 [02:50<00:59,  2.22s/it]Best trial: 56. Best value: 0.186675:  74%|███████▍  | 74/100 [02:50<00:58,  2.27s/it]Best trial: 56. Best value: 0.186675:  74%|███████▍  | 74/100 [02:52<00:58,  2.27s/it]Best trial: 56. Best value: 0.186675:  75%|███████▌  | 75/100 [02:52<00:56,  2.28s/it]Best trial: 56. Best value: 0.186675:  75%|███████▌  | 75/100 [02:54<00:56,  2.28s/it]Best trial: 56. Best value: 0.186675:  76%|███████▌  | 76/100 [02:54<00:50,  2.09s/it]Best trial: 56. Best value: 0.186675:  76%|███████▌  | 76/100 [02:55<00:50,  2.09s/it]Best trial: 56. Best value: 0.186675:  77%|███████▋  | 77/100 [02:55<00:43,  1.91s/it]Best trial: 56. Best value: 0.186675:  77%|███████▋  | 77/100 [02:57<00:43,  1.91s/it]Best trial: 56. Best value: 0.186675:  78%|███████▊  | 78/100 [02:57<00:44,  2.02s/it]Best trial: 56. Best value: 0.186675:  78%|███████▊  | 78/100 [03:00<00:44,  2.02s/it]Best trial: 56. Best value: 0.186675:  79%|███████▉  | 79/100 [03:00<00:42,  2.04s/it]Best trial: 56. Best value: 0.186675:  79%|███████▉  | 79/100 [03:02<00:42,  2.04s/it]Best trial: 56. Best value: 0.186675:  80%|████████  | 80/100 [03:02<00:44,  2.20s/it]Best trial: 56. Best value: 0.186675:  80%|████████  | 80/100 [03:05<00:44,  2.20s/it]Best trial: 56. Best value: 0.186675:  81%|████████  | 81/100 [03:05<00:46,  2.44s/it]Best trial: 56. Best value: 0.186675:  81%|████████  | 81/100 [03:08<00:46,  2.44s/it]Best trial: 56. Best value: 0.186675:  82%|████████▏ | 82/100 [03:08<00:44,  2.48s/it]Best trial: 56. Best value: 0.186675:  82%|████████▏ | 82/100 [03:10<00:44,  2.48s/it]Best trial: 56. Best value: 0.186675:  83%|████████▎ | 83/100 [03:10<00:42,  2.50s/it]Best trial: 56. Best value: 0.186675:  83%|████████▎ | 83/100 [03:12<00:42,  2.50s/it]Best trial: 56. Best value: 0.186675:  84%|████████▍ | 84/100 [03:12<00:36,  2.29s/it]Best trial: 56. Best value: 0.186675:  84%|████████▍ | 84/100 [03:14<00:36,  2.29s/it]Best trial: 56. Best value: 0.186675:  85%|████████▌ | 85/100 [03:14<00:32,  2.17s/it]Best trial: 56. Best value: 0.186675:  85%|████████▌ | 85/100 [03:17<00:32,  2.17s/it]Best trial: 56. Best value: 0.186675:  86%|████████▌ | 86/100 [03:17<00:32,  2.31s/it]Best trial: 56. Best value: 0.186675:  86%|████████▌ | 86/100 [03:19<00:32,  2.31s/it]Best trial: 56. Best value: 0.186675:  87%|████████▋ | 87/100 [03:19<00:29,  2.27s/it]Best trial: 56. Best value: 0.186675:  87%|████████▋ | 87/100 [03:21<00:29,  2.27s/it]Best trial: 56. Best value: 0.186675:  88%|████████▊ | 88/100 [03:21<00:26,  2.20s/it]Best trial: 56. Best value: 0.186675:  88%|████████▊ | 88/100 [03:23<00:26,  2.20s/it]Best trial: 56. Best value: 0.186675:  89%|████████▉ | 89/100 [03:23<00:24,  2.25s/it]Best trial: 56. Best value: 0.186675:  89%|████████▉ | 89/100 [03:27<00:24,  2.25s/it]Best trial: 56. Best value: 0.186675:  90%|█████████ | 90/100 [03:27<00:25,  2.59s/it]Best trial: 56. Best value: 0.186675:  90%|█████████ | 90/100 [03:29<00:25,  2.59s/it]Best trial: 56. Best value: 0.186675:  91%|█████████ | 91/100 [03:29<00:23,  2.64s/it]Best trial: 56. Best value: 0.186675:  91%|█████████ | 91/100 [03:32<00:23,  2.64s/it]Best trial: 56. Best value: 0.186675:  92%|█████████▏| 92/100 [03:32<00:22,  2.81s/it]Best trial: 56. Best value: 0.186675:  92%|█████████▏| 92/100 [03:35<00:22,  2.81s/it]Best trial: 56. Best value: 0.186675:  93%|█████████▎| 93/100 [03:35<00:18,  2.62s/it]Best trial: 56. Best value: 0.186675:  93%|█████████▎| 93/100 [03:36<00:18,  2.62s/it]Best trial: 56. Best value: 0.186675:  94%|█████████▍| 94/100 [03:36<00:14,  2.38s/it]Best trial: 56. Best value: 0.186675:  94%|█████████▍| 94/100 [03:39<00:14,  2.38s/it]Best trial: 56. Best value: 0.186675:  95%|█████████▌| 95/100 [03:39<00:11,  2.40s/it]Best trial: 56. Best value: 0.186675:  95%|█████████▌| 95/100 [03:41<00:11,  2.40s/it]Best trial: 56. Best value: 0.186675:  96%|█████████▌| 96/100 [03:41<00:09,  2.32s/it]Best trial: 56. Best value: 0.186675:  96%|█████████▌| 96/100 [03:44<00:09,  2.32s/it]Best trial: 56. Best value: 0.186675:  97%|█████████▋| 97/100 [03:44<00:07,  2.50s/it]Best trial: 56. Best value: 0.186675:  97%|█████████▋| 97/100 [03:46<00:07,  2.50s/it]Best trial: 56. Best value: 0.186675:  98%|█████████▊| 98/100 [03:46<00:04,  2.42s/it]Best trial: 56. Best value: 0.186675:  98%|█████████▊| 98/100 [03:48<00:04,  2.42s/it]Best trial: 56. Best value: 0.186675:  99%|█████████▉| 99/100 [03:48<00:02,  2.30s/it]Best trial: 56. Best value: 0.186675:  99%|█████████▉| 99/100 [03:51<00:02,  2.30s/it]Best trial: 56. Best value: 0.186675: 100%|██████████| 100/100 [03:51<00:00,  2.43s/it]Best trial: 56. Best value: 0.186675: 100%|██████████| 100/100 [03:51<00:00,  2.31s/it]
2025-11-30 12:52:30,073 - INFO - HPO Complete. Best AUPRC: 0.1867
2025-11-30 12:52:30,073 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.07435216038220854, 'max_depth': 4, 'subsample': 0.8918941820916138, 'colsample_bytree': 0.6535053357223973, 'gamma': 2.8818498606668337, 'reg_lambda': 2.847070137426437e-06, 'reg_alpha': 4.632465811359778e-06}
2025-11-30 12:52:30,074 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:52:32,033 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: ecg_only
2025-11-30 12:52:32,033 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:52:32,221 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:52:32,243 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:52:32,247 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:52:32,247 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:52:32,247 - INFO - Training model...
2025-11-30 12:52:34,287 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:52:39,298 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:52:39,298 - INFO - AUROC: 0.4630 (0.3209 - 0.5745)
2025-11-30 12:52:39,298 - INFO - AUPRC: 0.0148 (0.0097 - 0.0308)
2025-11-30 12:52:39,298 - INFO - Brier Score: 0.0168 (0.0109 - 0.0289)
2025-11-30 12:52:39,298 - INFO - Accuracy: 0.8916 (0.7208 - 0.9046)
2025-11-30 12:52:39,299 - INFO - Precision: 0.0149 (0.0034 - 0.0487)
2025-11-30 12:52:39,299 - INFO - Sensitivity (Recall): 0.1000 (0.0353 - 0.3100)
2025-11-30 12:52:39,299 - INFO - F1-Score: 0.0260 (0.0064 - 0.0778)
2025-11-30 12:52:39,299 - INFO - Best Threshold: 0.0300 (0.0100 - 0.0300)
2025-11-30 12:52:39,299 - INFO - Specificity: 0.9032 (0.7281 - 0.9209)
2025-11-30 12:52:39,310 - INFO - Calculating SHAP values...
2025-11-30 12:52:40,426 - INFO - SHAP plots saved.
2025-11-30 12:52:40,427 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:52:41,777 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: co2_only
2025-11-30 12:52:41,777 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:52:42,019 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:52:42,043 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:52:42,051 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:52:42,051 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0729097:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0729097:   1%|          | 1/100 [00:02<04:56,  2.99s/it]Best trial: 1. Best value: 0.097311:   1%|          | 1/100 [00:04<04:56,  2.99s/it] Best trial: 1. Best value: 0.097311:   2%|▏         | 2/100 [00:04<03:53,  2.39s/it]Best trial: 1. Best value: 0.097311:   2%|▏         | 2/100 [00:07<03:53,  2.39s/it]Best trial: 1. Best value: 0.097311:   3%|▎         | 3/100 [00:07<03:41,  2.28s/it]Best trial: 1. Best value: 0.097311:   3%|▎         | 3/100 [00:09<03:41,  2.28s/it]Best trial: 1. Best value: 0.097311:   4%|▍         | 4/100 [00:09<03:44,  2.34s/it]Best trial: 1. Best value: 0.097311:   4%|▍         | 4/100 [00:11<03:44,  2.34s/it]Best trial: 1. Best value: 0.097311:   5%|▌         | 5/100 [00:11<03:21,  2.12s/it]Best trial: 1. Best value: 0.097311:   5%|▌         | 5/100 [00:13<03:21,  2.12s/it]Best trial: 1. Best value: 0.097311:   6%|▌         | 6/100 [00:13<03:35,  2.29s/it]Best trial: 1. Best value: 0.097311:   6%|▌         | 6/100 [00:16<03:35,  2.29s/it]Best trial: 1. Best value: 0.097311:   7%|▋         | 7/100 [00:16<03:39,  2.36s/it]Best trial: 1. Best value: 0.097311:   7%|▋         | 7/100 [00:18<03:39,  2.36s/it]Best trial: 1. Best value: 0.097311:   8%|▊         | 8/100 [00:18<03:37,  2.37s/it]Best trial: 1. Best value: 0.097311:   8%|▊         | 8/100 [00:22<03:37,  2.37s/it]Best trial: 1. Best value: 0.097311:   9%|▉         | 9/100 [00:22<04:04,  2.68s/it]Best trial: 1. Best value: 0.097311:   9%|▉         | 9/100 [00:24<04:04,  2.68s/it]Best trial: 1. Best value: 0.097311:  10%|█         | 10/100 [00:24<03:51,  2.57s/it]Best trial: 1. Best value: 0.097311:  10%|█         | 10/100 [00:28<03:51,  2.57s/it]Best trial: 1. Best value: 0.097311:  11%|█         | 11/100 [00:28<04:21,  2.94s/it]Best trial: 1. Best value: 0.097311:  11%|█         | 11/100 [00:32<04:21,  2.94s/it]Best trial: 1. Best value: 0.097311:  12%|█▏        | 12/100 [00:32<04:40,  3.19s/it]Best trial: 12. Best value: 0.114474:  12%|█▏        | 12/100 [00:35<04:40,  3.19s/it]Best trial: 12. Best value: 0.114474:  13%|█▎        | 13/100 [00:35<04:45,  3.28s/it]Best trial: 12. Best value: 0.114474:  13%|█▎        | 13/100 [00:38<04:45,  3.28s/it]Best trial: 12. Best value: 0.114474:  14%|█▍        | 14/100 [00:38<04:43,  3.30s/it]Best trial: 12. Best value: 0.114474:  14%|█▍        | 14/100 [00:41<04:43,  3.30s/it]Best trial: 12. Best value: 0.114474:  15%|█▌        | 15/100 [00:41<04:21,  3.08s/it]Best trial: 12. Best value: 0.114474:  15%|█▌        | 15/100 [00:43<04:21,  3.08s/it]Best trial: 12. Best value: 0.114474:  16%|█▌        | 16/100 [00:43<04:01,  2.87s/it]Best trial: 12. Best value: 0.114474:  16%|█▌        | 16/100 [00:47<04:01,  2.87s/it]Best trial: 12. Best value: 0.114474:  17%|█▋        | 17/100 [00:47<04:12,  3.04s/it]Best trial: 12. Best value: 0.114474:  17%|█▋        | 17/100 [00:50<04:12,  3.04s/it]Best trial: 12. Best value: 0.114474:  18%|█▊        | 18/100 [00:50<04:26,  3.26s/it]Best trial: 12. Best value: 0.114474:  18%|█▊        | 18/100 [00:55<04:26,  3.26s/it]Best trial: 12. Best value: 0.114474:  19%|█▉        | 19/100 [00:55<04:47,  3.55s/it]Best trial: 12. Best value: 0.114474:  19%|█▉        | 19/100 [00:58<04:47,  3.55s/it]Best trial: 12. Best value: 0.114474:  20%|██        | 20/100 [00:58<04:47,  3.59s/it]Best trial: 12. Best value: 0.114474:  20%|██        | 20/100 [01:02<04:47,  3.59s/it]Best trial: 12. Best value: 0.114474:  21%|██        | 21/100 [01:02<04:46,  3.62s/it]Best trial: 12. Best value: 0.114474:  21%|██        | 21/100 [01:06<04:46,  3.62s/it]Best trial: 12. Best value: 0.114474:  22%|██▏       | 22/100 [01:06<04:57,  3.81s/it]Best trial: 12. Best value: 0.114474:  22%|██▏       | 22/100 [01:12<04:57,  3.81s/it]Best trial: 12. Best value: 0.114474:  23%|██▎       | 23/100 [01:12<05:32,  4.31s/it]Best trial: 12. Best value: 0.114474:  23%|██▎       | 23/100 [01:16<05:32,  4.31s/it]Best trial: 12. Best value: 0.114474:  24%|██▍       | 24/100 [01:16<05:20,  4.21s/it]Best trial: 12. Best value: 0.114474:  24%|██▍       | 24/100 [01:18<05:20,  4.21s/it]Best trial: 12. Best value: 0.114474:  25%|██▌       | 25/100 [01:18<04:40,  3.74s/it]Best trial: 12. Best value: 0.114474:  25%|██▌       | 25/100 [01:21<04:40,  3.74s/it]Best trial: 12. Best value: 0.114474:  26%|██▌       | 26/100 [01:21<04:11,  3.40s/it]Best trial: 12. Best value: 0.114474:  26%|██▌       | 26/100 [01:24<04:11,  3.40s/it]Best trial: 12. Best value: 0.114474:  27%|██▋       | 27/100 [01:24<04:00,  3.29s/it]Best trial: 12. Best value: 0.114474:  27%|██▋       | 27/100 [01:27<04:00,  3.29s/it]Best trial: 12. Best value: 0.114474:  28%|██▊       | 28/100 [01:27<03:48,  3.17s/it]Best trial: 12. Best value: 0.114474:  28%|██▊       | 28/100 [01:30<03:48,  3.17s/it]Best trial: 12. Best value: 0.114474:  29%|██▉       | 29/100 [01:30<03:48,  3.22s/it]Best trial: 12. Best value: 0.114474:  29%|██▉       | 29/100 [01:33<03:48,  3.22s/it]Best trial: 12. Best value: 0.114474:  30%|███       | 30/100 [01:33<03:34,  3.06s/it]Best trial: 12. Best value: 0.114474:  30%|███       | 30/100 [01:36<03:34,  3.06s/it]Best trial: 12. Best value: 0.114474:  31%|███       | 31/100 [01:36<03:25,  2.98s/it]Best trial: 12. Best value: 0.114474:  31%|███       | 31/100 [01:38<03:25,  2.98s/it]Best trial: 12. Best value: 0.114474:  32%|███▏      | 32/100 [01:38<02:58,  2.63s/it]Best trial: 12. Best value: 0.114474:  32%|███▏      | 32/100 [01:41<02:58,  2.63s/it]Best trial: 12. Best value: 0.114474:  33%|███▎      | 33/100 [01:41<03:14,  2.91s/it]Best trial: 12. Best value: 0.114474:  33%|███▎      | 33/100 [01:45<03:14,  2.91s/it]Best trial: 12. Best value: 0.114474:  34%|███▍      | 34/100 [01:45<03:26,  3.12s/it]Best trial: 12. Best value: 0.114474:  34%|███▍      | 34/100 [01:48<03:26,  3.12s/it]Best trial: 12. Best value: 0.114474:  35%|███▌      | 35/100 [01:48<03:31,  3.26s/it]Best trial: 12. Best value: 0.114474:  35%|███▌      | 35/100 [01:52<03:31,  3.26s/it]Best trial: 12. Best value: 0.114474:  36%|███▌      | 36/100 [01:52<03:35,  3.37s/it]Best trial: 12. Best value: 0.114474:  36%|███▌      | 36/100 [01:56<03:35,  3.37s/it]Best trial: 12. Best value: 0.114474:  37%|███▋      | 37/100 [01:56<03:37,  3.45s/it]Best trial: 12. Best value: 0.114474:  37%|███▋      | 37/100 [01:59<03:37,  3.45s/it]Best trial: 12. Best value: 0.114474:  38%|███▊      | 38/100 [01:59<03:35,  3.47s/it]Best trial: 12. Best value: 0.114474:  38%|███▊      | 38/100 [02:02<03:35,  3.47s/it]Best trial: 12. Best value: 0.114474:  39%|███▉      | 39/100 [02:02<03:29,  3.43s/it]Best trial: 12. Best value: 0.114474:  39%|███▉      | 39/100 [02:07<03:29,  3.43s/it]Best trial: 12. Best value: 0.114474:  40%|████      | 40/100 [02:07<03:40,  3.67s/it]Best trial: 12. Best value: 0.114474:  40%|████      | 40/100 [02:11<03:40,  3.67s/it]Best trial: 12. Best value: 0.114474:  41%|████      | 41/100 [02:11<03:44,  3.81s/it]Best trial: 12. Best value: 0.114474:  41%|████      | 41/100 [02:15<03:44,  3.81s/it]Best trial: 12. Best value: 0.114474:  42%|████▏     | 42/100 [02:15<03:51,  3.99s/it]Best trial: 12. Best value: 0.114474:  42%|████▏     | 42/100 [02:19<03:51,  3.99s/it]Best trial: 12. Best value: 0.114474:  43%|████▎     | 43/100 [02:19<03:43,  3.92s/it]Best trial: 12. Best value: 0.114474:  43%|████▎     | 43/100 [02:23<03:43,  3.92s/it]Best trial: 12. Best value: 0.114474:  44%|████▍     | 44/100 [02:23<03:35,  3.85s/it]Best trial: 12. Best value: 0.114474:  44%|████▍     | 44/100 [02:25<03:35,  3.85s/it]Best trial: 12. Best value: 0.114474:  45%|████▌     | 45/100 [02:25<03:07,  3.40s/it]Best trial: 12. Best value: 0.114474:  45%|████▌     | 45/100 [02:29<03:07,  3.40s/it]Best trial: 12. Best value: 0.114474:  46%|████▌     | 46/100 [02:29<03:20,  3.71s/it]Best trial: 46. Best value: 0.12213:  46%|████▌     | 46/100 [02:32<03:20,  3.71s/it] Best trial: 46. Best value: 0.12213:  47%|████▋     | 47/100 [02:32<02:59,  3.39s/it]Best trial: 46. Best value: 0.12213:  47%|████▋     | 47/100 [02:35<02:59,  3.39s/it]Best trial: 46. Best value: 0.12213:  48%|████▊     | 48/100 [02:35<02:52,  3.32s/it]Best trial: 46. Best value: 0.12213:  48%|████▊     | 48/100 [02:38<02:52,  3.32s/it]Best trial: 46. Best value: 0.12213:  49%|████▉     | 49/100 [02:38<02:40,  3.14s/it]Best trial: 46. Best value: 0.12213:  49%|████▉     | 49/100 [02:40<02:40,  3.14s/it]Best trial: 46. Best value: 0.12213:  50%|█████     | 50/100 [02:40<02:27,  2.95s/it]Best trial: 46. Best value: 0.12213:  50%|█████     | 50/100 [02:43<02:27,  2.95s/it]Best trial: 46. Best value: 0.12213:  51%|█████     | 51/100 [02:43<02:20,  2.87s/it]Best trial: 46. Best value: 0.12213:  51%|█████     | 51/100 [02:47<02:20,  2.87s/it]Best trial: 46. Best value: 0.12213:  52%|█████▏    | 52/100 [02:47<02:38,  3.30s/it]Best trial: 46. Best value: 0.12213:  52%|█████▏    | 52/100 [02:50<02:38,  3.30s/it]Best trial: 46. Best value: 0.12213:  53%|█████▎    | 53/100 [02:50<02:30,  3.20s/it]Best trial: 46. Best value: 0.12213:  53%|█████▎    | 53/100 [02:55<02:30,  3.20s/it]Best trial: 46. Best value: 0.12213:  54%|█████▍    | 54/100 [02:55<02:50,  3.71s/it]Best trial: 46. Best value: 0.12213:  54%|█████▍    | 54/100 [02:58<02:50,  3.71s/it]Best trial: 46. Best value: 0.12213:  55%|█████▌    | 55/100 [02:58<02:35,  3.46s/it]Best trial: 46. Best value: 0.12213:  55%|█████▌    | 55/100 [03:01<02:35,  3.46s/it]Best trial: 46. Best value: 0.12213:  56%|█████▌    | 56/100 [03:01<02:22,  3.24s/it]Best trial: 46. Best value: 0.12213:  56%|█████▌    | 56/100 [03:04<02:22,  3.24s/it]Best trial: 46. Best value: 0.12213:  57%|█████▋    | 57/100 [03:04<02:13,  3.10s/it]Best trial: 46. Best value: 0.12213:  57%|█████▋    | 57/100 [03:07<02:13,  3.10s/it]Best trial: 46. Best value: 0.12213:  58%|█████▊    | 58/100 [03:07<02:08,  3.06s/it]Best trial: 46. Best value: 0.12213:  58%|█████▊    | 58/100 [03:10<02:08,  3.06s/it]Best trial: 46. Best value: 0.12213:  59%|█████▉    | 59/100 [03:10<02:05,  3.07s/it]Best trial: 46. Best value: 0.12213:  59%|█████▉    | 59/100 [03:12<02:05,  3.07s/it]Best trial: 46. Best value: 0.12213:  60%|██████    | 60/100 [03:12<01:54,  2.87s/it]Best trial: 46. Best value: 0.12213:  60%|██████    | 60/100 [03:15<01:54,  2.87s/it]Best trial: 46. Best value: 0.12213:  61%|██████    | 61/100 [03:15<01:51,  2.85s/it]Best trial: 46. Best value: 0.12213:  61%|██████    | 61/100 [03:18<01:51,  2.85s/it]Best trial: 46. Best value: 0.12213:  62%|██████▏   | 62/100 [03:18<01:46,  2.81s/it]Best trial: 46. Best value: 0.12213:  62%|██████▏   | 62/100 [03:20<01:46,  2.81s/it]Best trial: 46. Best value: 0.12213:  63%|██████▎   | 63/100 [03:20<01:39,  2.70s/it]Best trial: 46. Best value: 0.12213:  63%|██████▎   | 63/100 [03:23<01:39,  2.70s/it]Best trial: 46. Best value: 0.12213:  64%|██████▍   | 64/100 [03:23<01:43,  2.86s/it]Best trial: 46. Best value: 0.12213:  64%|██████▍   | 64/100 [03:27<01:43,  2.86s/it]Best trial: 46. Best value: 0.12213:  65%|██████▌   | 65/100 [03:27<01:42,  2.94s/it]Best trial: 46. Best value: 0.12213:  65%|██████▌   | 65/100 [03:30<01:42,  2.94s/it]Best trial: 46. Best value: 0.12213:  66%|██████▌   | 66/100 [03:30<01:42,  3.00s/it]Best trial: 46. Best value: 0.12213:  66%|██████▌   | 66/100 [03:34<01:42,  3.00s/it]Best trial: 46. Best value: 0.12213:  67%|██████▋   | 67/100 [03:34<01:48,  3.30s/it]Best trial: 46. Best value: 0.12213:  67%|██████▋   | 67/100 [03:37<01:48,  3.30s/it]Best trial: 46. Best value: 0.12213:  68%|██████▊   | 68/100 [03:37<01:43,  3.22s/it]Best trial: 46. Best value: 0.12213:  68%|██████▊   | 68/100 [03:40<01:43,  3.22s/it]Best trial: 46. Best value: 0.12213:  69%|██████▉   | 69/100 [03:40<01:37,  3.14s/it]Best trial: 46. Best value: 0.12213:  69%|██████▉   | 69/100 [03:43<01:37,  3.14s/it]Best trial: 46. Best value: 0.12213:  70%|███████   | 70/100 [03:43<01:33,  3.10s/it]Best trial: 46. Best value: 0.12213:  70%|███████   | 70/100 [03:46<01:33,  3.10s/it]Best trial: 46. Best value: 0.12213:  71%|███████   | 71/100 [03:46<01:29,  3.10s/it]Best trial: 46. Best value: 0.12213:  71%|███████   | 71/100 [03:49<01:29,  3.10s/it]Best trial: 46. Best value: 0.12213:  72%|███████▏  | 72/100 [03:49<01:24,  3.02s/it]Best trial: 46. Best value: 0.12213:  72%|███████▏  | 72/100 [03:51<01:24,  3.02s/it]Best trial: 46. Best value: 0.12213:  73%|███████▎  | 73/100 [03:51<01:20,  2.98s/it]Best trial: 46. Best value: 0.12213:  73%|███████▎  | 73/100 [03:54<01:20,  2.98s/it]Best trial: 46. Best value: 0.12213:  74%|███████▍  | 74/100 [03:54<01:13,  2.84s/it]Best trial: 46. Best value: 0.12213:  74%|███████▍  | 74/100 [03:56<01:13,  2.84s/it]Best trial: 46. Best value: 0.12213:  75%|███████▌  | 75/100 [03:56<01:04,  2.59s/it]Best trial: 46. Best value: 0.12213:  75%|███████▌  | 75/100 [03:59<01:04,  2.59s/it]Best trial: 46. Best value: 0.12213:  76%|███████▌  | 76/100 [03:59<01:05,  2.71s/it]Best trial: 46. Best value: 0.12213:  76%|███████▌  | 76/100 [04:02<01:05,  2.71s/it]Best trial: 46. Best value: 0.12213:  77%|███████▋  | 77/100 [04:02<01:04,  2.81s/it]Best trial: 77. Best value: 0.131747:  77%|███████▋  | 77/100 [04:05<01:04,  2.81s/it]Best trial: 77. Best value: 0.131747:  78%|███████▊  | 78/100 [04:05<01:03,  2.91s/it]Best trial: 77. Best value: 0.131747:  78%|███████▊  | 78/100 [04:09<01:03,  2.91s/it]Best trial: 77. Best value: 0.131747:  79%|███████▉  | 79/100 [04:09<01:05,  3.14s/it]Best trial: 77. Best value: 0.131747:  79%|███████▉  | 79/100 [04:11<01:05,  3.14s/it]Best trial: 77. Best value: 0.131747:  80%|████████  | 80/100 [04:11<00:59,  2.97s/it]Best trial: 77. Best value: 0.131747:  80%|████████  | 80/100 [04:15<00:59,  2.97s/it]Best trial: 77. Best value: 0.131747:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]Best trial: 77. Best value: 0.131747:  81%|████████  | 81/100 [04:18<01:00,  3.18s/it]Best trial: 77. Best value: 0.131747:  82%|████████▏ | 82/100 [04:18<00:53,  3.00s/it]Best trial: 77. Best value: 0.131747:  82%|████████▏ | 82/100 [04:20<00:53,  3.00s/it]Best trial: 77. Best value: 0.131747:  83%|████████▎ | 83/100 [04:20<00:49,  2.94s/it]Best trial: 77. Best value: 0.131747:  83%|████████▎ | 83/100 [04:23<00:49,  2.94s/it]Best trial: 77. Best value: 0.131747:  84%|████████▍ | 84/100 [04:23<00:45,  2.82s/it]Best trial: 77. Best value: 0.131747:  84%|████████▍ | 84/100 [04:26<00:45,  2.82s/it]Best trial: 77. Best value: 0.131747:  85%|████████▌ | 85/100 [04:26<00:43,  2.90s/it]Best trial: 77. Best value: 0.131747:  85%|████████▌ | 85/100 [04:28<00:43,  2.90s/it]Best trial: 77. Best value: 0.131747:  86%|████████▌ | 86/100 [04:28<00:38,  2.73s/it]Best trial: 86. Best value: 0.135091:  86%|████████▌ | 86/100 [04:31<00:38,  2.73s/it]Best trial: 86. Best value: 0.135091:  87%|████████▋ | 87/100 [04:31<00:32,  2.53s/it]Best trial: 86. Best value: 0.135091:  87%|████████▋ | 87/100 [04:33<00:32,  2.53s/it]Best trial: 86. Best value: 0.135091:  88%|████████▊ | 88/100 [04:33<00:28,  2.41s/it]Best trial: 86. Best value: 0.135091:  88%|████████▊ | 88/100 [04:34<00:28,  2.41s/it]Best trial: 86. Best value: 0.135091:  89%|████████▉ | 89/100 [04:34<00:23,  2.14s/it]Best trial: 86. Best value: 0.135091:  89%|████████▉ | 89/100 [04:36<00:23,  2.14s/it]Best trial: 86. Best value: 0.135091:  90%|█████████ | 90/100 [04:36<00:20,  2.01s/it]Best trial: 86. Best value: 0.135091:  90%|█████████ | 90/100 [04:37<00:20,  2.01s/it]Best trial: 86. Best value: 0.135091:  91%|█████████ | 91/100 [04:37<00:16,  1.84s/it]Best trial: 86. Best value: 0.135091:  91%|█████████ | 91/100 [04:39<00:16,  1.84s/it]Best trial: 86. Best value: 0.135091:  92%|█████████▏| 92/100 [04:39<00:14,  1.76s/it]Best trial: 86. Best value: 0.135091:  92%|█████████▏| 92/100 [04:41<00:14,  1.76s/it]Best trial: 86. Best value: 0.135091:  93%|█████████▎| 93/100 [04:41<00:12,  1.75s/it]Best trial: 86. Best value: 0.135091:  93%|█████████▎| 93/100 [04:42<00:12,  1.75s/it]Best trial: 86. Best value: 0.135091:  94%|█████████▍| 94/100 [04:42<00:10,  1.79s/it]Best trial: 86. Best value: 0.135091:  94%|█████████▍| 94/100 [04:44<00:10,  1.79s/it]Best trial: 86. Best value: 0.135091:  95%|█████████▌| 95/100 [04:44<00:09,  1.84s/it]Best trial: 86. Best value: 0.135091:  95%|█████████▌| 95/100 [04:47<00:09,  1.84s/it]Best trial: 86. Best value: 0.135091:  96%|█████████▌| 96/100 [04:47<00:08,  2.10s/it]Best trial: 86. Best value: 0.135091:  96%|█████████▌| 96/100 [04:49<00:08,  2.10s/it]Best trial: 86. Best value: 0.135091:  97%|█████████▋| 97/100 [04:49<00:06,  2.06s/it]Best trial: 86. Best value: 0.135091:  97%|█████████▋| 97/100 [04:52<00:06,  2.06s/it]Best trial: 86. Best value: 0.135091:  98%|█████████▊| 98/100 [04:52<00:04,  2.29s/it]Best trial: 86. Best value: 0.135091:  98%|█████████▊| 98/100 [04:55<00:04,  2.29s/it]Best trial: 86. Best value: 0.135091:  99%|█████████▉| 99/100 [04:55<00:02,  2.48s/it]Best trial: 86. Best value: 0.135091:  99%|█████████▉| 99/100 [04:59<00:02,  2.48s/it]Best trial: 86. Best value: 0.135091: 100%|██████████| 100/100 [04:59<00:00,  2.93s/it]Best trial: 86. Best value: 0.135091: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
2025-11-30 12:57:41,366 - INFO - HPO Complete. Best AUPRC: 0.1351
2025-11-30 12:57:41,366 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.017142410392986175, 'max_depth': 6, 'subsample': 0.6493786249901912, 'colsample_bytree': 0.9669303335316864, 'gamma': 4.434971215364501, 'reg_lambda': 7.215653788987048e-06, 'reg_alpha': 0.007029233971959236}
2025-11-30 12:57:41,367 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 12:57:43,589 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: co2_only
2025-11-30 12:57:43,590 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:57:43,836 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:57:43,860 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:57:43,865 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:57:43,865 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 12:57:43,865 - INFO - Training model...
2025-11-30 12:57:45,107 - INFO - Evaluating model with bootstrapping...
2025-11-30 12:57:50,060 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 12:57:50,060 - INFO - AUROC: 0.5702 (0.4482 - 0.6855)
2025-11-30 12:57:50,060 - INFO - AUPRC: 0.0229 (0.0148 - 0.0489)
2025-11-30 12:57:50,060 - INFO - Brier Score: 0.0202 (0.0146 - 0.0316)
2025-11-30 12:57:50,060 - INFO - Accuracy: 0.9277 (0.3436 - 0.9566)
2025-11-30 12:57:50,060 - INFO - Precision: 0.0455 (0.0175 - 0.0889)
2025-11-30 12:57:50,060 - INFO - Sensitivity (Recall): 0.2000 (0.0933 - 0.8144)
2025-11-30 12:57:50,061 - INFO - F1-Score: 0.0741 (0.0343 - 0.1371)
2025-11-30 12:57:50,061 - INFO - Best Threshold: 0.1900 (0.0100 - 0.2300)
2025-11-30 12:57:50,061 - INFO - Specificity: 0.9384 (0.3354 - 0.9652)
2025-11-30 12:57:50,071 - INFO - Calculating SHAP values...
2025-11-30 12:57:51,262 - INFO - SHAP plots saved.
2025-11-30 12:57:51,264 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 12:57:52,792 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: awp_only
2025-11-30 12:57:52,793 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 12:57:53,009 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 12:57:53,029 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 12:57:53,034 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 12:57:53,034 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0447826:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0447826:   1%|          | 1/100 [00:02<03:34,  2.16s/it]Best trial: 0. Best value: 0.0447826:   1%|          | 1/100 [00:04<03:34,  2.16s/it]Best trial: 0. Best value: 0.0447826:   2%|▏         | 2/100 [00:04<03:28,  2.13s/it]Best trial: 2. Best value: 0.0638289:   2%|▏         | 2/100 [00:06<03:28,  2.13s/it]Best trial: 2. Best value: 0.0638289:   3%|▎         | 3/100 [00:06<03:24,  2.11s/it]Best trial: 2. Best value: 0.0638289:   3%|▎         | 3/100 [00:08<03:24,  2.11s/it]Best trial: 2. Best value: 0.0638289:   4%|▍         | 4/100 [00:08<03:17,  2.06s/it]Best trial: 2. Best value: 0.0638289:   4%|▍         | 4/100 [00:10<03:17,  2.06s/it]Best trial: 2. Best value: 0.0638289:   5%|▌         | 5/100 [00:10<03:34,  2.26s/it]Best trial: 2. Best value: 0.0638289:   5%|▌         | 5/100 [00:12<03:34,  2.26s/it]Best trial: 2. Best value: 0.0638289:   6%|▌         | 6/100 [00:12<03:21,  2.14s/it]Best trial: 2. Best value: 0.0638289:   6%|▌         | 6/100 [00:14<03:21,  2.14s/it]Best trial: 2. Best value: 0.0638289:   7%|▋         | 7/100 [00:14<03:12,  2.07s/it]Best trial: 2. Best value: 0.0638289:   7%|▋         | 7/100 [00:17<03:12,  2.07s/it]Best trial: 2. Best value: 0.0638289:   8%|▊         | 8/100 [00:17<03:17,  2.15s/it]Best trial: 8. Best value: 0.0654426:   8%|▊         | 8/100 [00:19<03:17,  2.15s/it]Best trial: 8. Best value: 0.0654426:   9%|▉         | 9/100 [00:19<03:17,  2.18s/it]Best trial: 8. Best value: 0.0654426:   9%|▉         | 9/100 [00:21<03:17,  2.18s/it]Best trial: 8. Best value: 0.0654426:  10%|█         | 10/100 [00:21<03:09,  2.11s/it]Best trial: 8. Best value: 0.0654426:  10%|█         | 10/100 [00:23<03:09,  2.11s/it]Best trial: 8. Best value: 0.0654426:  11%|█         | 11/100 [00:23<03:00,  2.03s/it]Best trial: 8. Best value: 0.0654426:  11%|█         | 11/100 [00:24<03:00,  2.03s/it]Best trial: 8. Best value: 0.0654426:  12%|█▏        | 12/100 [00:24<02:45,  1.89s/it]Best trial: 8. Best value: 0.0654426:  12%|█▏        | 12/100 [00:27<02:45,  1.89s/it]Best trial: 8. Best value: 0.0654426:  13%|█▎        | 13/100 [00:27<02:58,  2.06s/it]Best trial: 8. Best value: 0.0654426:  13%|█▎        | 13/100 [00:29<02:58,  2.06s/it]Best trial: 8. Best value: 0.0654426:  14%|█▍        | 14/100 [00:29<03:04,  2.14s/it]Best trial: 8. Best value: 0.0654426:  14%|█▍        | 14/100 [00:32<03:04,  2.14s/it]Best trial: 8. Best value: 0.0654426:  15%|█▌        | 15/100 [00:32<03:34,  2.52s/it]Best trial: 8. Best value: 0.0654426:  15%|█▌        | 15/100 [00:34<03:34,  2.52s/it]Best trial: 8. Best value: 0.0654426:  16%|█▌        | 16/100 [00:34<03:18,  2.36s/it]Best trial: 8. Best value: 0.0654426:  16%|█▌        | 16/100 [00:37<03:18,  2.36s/it]Best trial: 8. Best value: 0.0654426:  17%|█▋        | 17/100 [00:37<03:17,  2.38s/it]Best trial: 8. Best value: 0.0654426:  17%|█▋        | 17/100 [00:40<03:17,  2.38s/it]Best trial: 8. Best value: 0.0654426:  18%|█▊        | 18/100 [00:40<03:36,  2.64s/it]Best trial: 8. Best value: 0.0654426:  18%|█▊        | 18/100 [00:42<03:36,  2.64s/it]Best trial: 8. Best value: 0.0654426:  19%|█▉        | 19/100 [00:42<03:26,  2.55s/it]Best trial: 8. Best value: 0.0654426:  19%|█▉        | 19/100 [00:47<03:26,  2.55s/it]Best trial: 8. Best value: 0.0654426:  20%|██        | 20/100 [00:47<04:01,  3.02s/it]Best trial: 8. Best value: 0.0654426:  20%|██        | 20/100 [00:49<04:01,  3.02s/it]Best trial: 8. Best value: 0.0654426:  21%|██        | 21/100 [00:49<03:37,  2.76s/it]Best trial: 8. Best value: 0.0654426:  21%|██        | 21/100 [00:52<03:37,  2.76s/it]Best trial: 8. Best value: 0.0654426:  22%|██▏       | 22/100 [00:52<03:47,  2.91s/it]Best trial: 8. Best value: 0.0654426:  22%|██▏       | 22/100 [00:55<03:47,  2.91s/it]Best trial: 8. Best value: 0.0654426:  23%|██▎       | 23/100 [00:55<03:42,  2.89s/it]Best trial: 8. Best value: 0.0654426:  23%|██▎       | 23/100 [00:57<03:42,  2.89s/it]Best trial: 8. Best value: 0.0654426:  24%|██▍       | 24/100 [00:57<03:34,  2.83s/it]Best trial: 8. Best value: 0.0654426:  24%|██▍       | 24/100 [00:59<03:34,  2.83s/it]Best trial: 8. Best value: 0.0654426:  25%|██▌       | 25/100 [00:59<03:08,  2.52s/it]Best trial: 8. Best value: 0.0654426:  25%|██▌       | 25/100 [01:02<03:08,  2.52s/it]Best trial: 8. Best value: 0.0654426:  26%|██▌       | 26/100 [01:02<03:07,  2.53s/it]Best trial: 8. Best value: 0.0654426:  26%|██▌       | 26/100 [01:05<03:07,  2.53s/it]Best trial: 8. Best value: 0.0654426:  27%|██▋       | 27/100 [01:05<03:09,  2.59s/it]Best trial: 8. Best value: 0.0654426:  27%|██▋       | 27/100 [01:07<03:09,  2.59s/it]Best trial: 8. Best value: 0.0654426:  28%|██▊       | 28/100 [01:07<03:00,  2.50s/it]Best trial: 8. Best value: 0.0654426:  28%|██▊       | 28/100 [01:10<03:00,  2.50s/it]Best trial: 8. Best value: 0.0654426:  29%|██▉       | 29/100 [01:10<03:08,  2.66s/it]Best trial: 8. Best value: 0.0654426:  29%|██▉       | 29/100 [01:12<03:08,  2.66s/it]Best trial: 8. Best value: 0.0654426:  30%|███       | 30/100 [01:12<02:58,  2.55s/it]Best trial: 30. Best value: 0.0674484:  30%|███       | 30/100 [01:14<02:58,  2.55s/it]Best trial: 30. Best value: 0.0674484:  31%|███       | 31/100 [01:14<02:48,  2.45s/it]Best trial: 30. Best value: 0.0674484:  31%|███       | 31/100 [01:17<02:48,  2.45s/it]Best trial: 30. Best value: 0.0674484:  32%|███▏      | 32/100 [01:17<02:45,  2.44s/it]Best trial: 30. Best value: 0.0674484:  32%|███▏      | 32/100 [01:19<02:45,  2.44s/it]Best trial: 30. Best value: 0.0674484:  33%|███▎      | 33/100 [01:19<02:42,  2.42s/it]Best trial: 33. Best value: 0.0807161:  33%|███▎      | 33/100 [01:22<02:42,  2.42s/it]Best trial: 33. Best value: 0.0807161:  34%|███▍      | 34/100 [01:22<02:42,  2.46s/it]Best trial: 33. Best value: 0.0807161:  34%|███▍      | 34/100 [01:24<02:42,  2.46s/it]Best trial: 33. Best value: 0.0807161:  35%|███▌      | 35/100 [01:24<02:42,  2.51s/it]Best trial: 33. Best value: 0.0807161:  35%|███▌      | 35/100 [01:27<02:42,  2.51s/it]Best trial: 33. Best value: 0.0807161:  36%|███▌      | 36/100 [01:27<02:48,  2.63s/it]Best trial: 33. Best value: 0.0807161:  36%|███▌      | 36/100 [01:29<02:48,  2.63s/it]Best trial: 33. Best value: 0.0807161:  37%|███▋      | 37/100 [01:29<02:34,  2.46s/it]Best trial: 33. Best value: 0.0807161:  37%|███▋      | 37/100 [01:31<02:34,  2.46s/it]Best trial: 33. Best value: 0.0807161:  38%|███▊      | 38/100 [01:31<02:23,  2.31s/it]Best trial: 33. Best value: 0.0807161:  38%|███▊      | 38/100 [01:34<02:23,  2.31s/it]Best trial: 33. Best value: 0.0807161:  39%|███▉      | 39/100 [01:34<02:28,  2.43s/it]Best trial: 33. Best value: 0.0807161:  39%|███▉      | 39/100 [01:36<02:28,  2.43s/it]Best trial: 33. Best value: 0.0807161:  40%|████      | 40/100 [01:36<02:21,  2.37s/it]Best trial: 33. Best value: 0.0807161:  40%|████      | 40/100 [01:38<02:21,  2.37s/it]Best trial: 33. Best value: 0.0807161:  41%|████      | 41/100 [01:38<02:15,  2.29s/it]Best trial: 33. Best value: 0.0807161:  41%|████      | 41/100 [01:41<02:15,  2.29s/it]Best trial: 33. Best value: 0.0807161:  42%|████▏     | 42/100 [01:41<02:13,  2.30s/it]Best trial: 33. Best value: 0.0807161:  42%|████▏     | 42/100 [01:43<02:13,  2.30s/it]Best trial: 33. Best value: 0.0807161:  43%|████▎     | 43/100 [01:43<02:05,  2.19s/it]Best trial: 43. Best value: 0.0880481:  43%|████▎     | 43/100 [01:45<02:05,  2.19s/it]Best trial: 43. Best value: 0.0880481:  44%|████▍     | 44/100 [01:45<01:59,  2.14s/it]Best trial: 43. Best value: 0.0880481:  44%|████▍     | 44/100 [01:47<01:59,  2.14s/it]Best trial: 43. Best value: 0.0880481:  45%|████▌     | 45/100 [01:47<01:56,  2.13s/it]Best trial: 43. Best value: 0.0880481:  45%|████▌     | 45/100 [01:49<01:56,  2.13s/it]Best trial: 43. Best value: 0.0880481:  46%|████▌     | 46/100 [01:49<01:54,  2.12s/it]Best trial: 43. Best value: 0.0880481:  46%|████▌     | 46/100 [01:51<01:54,  2.12s/it]Best trial: 43. Best value: 0.0880481:  47%|████▋     | 47/100 [01:51<01:48,  2.04s/it]Best trial: 47. Best value: 0.0888184:  47%|████▋     | 47/100 [01:53<01:48,  2.04s/it]Best trial: 47. Best value: 0.0888184:  48%|████▊     | 48/100 [01:53<01:58,  2.28s/it]Best trial: 47. Best value: 0.0888184:  48%|████▊     | 48/100 [01:55<01:58,  2.28s/it]Best trial: 47. Best value: 0.0888184:  49%|████▉     | 49/100 [01:55<01:49,  2.15s/it]Best trial: 47. Best value: 0.0888184:  49%|████▉     | 49/100 [01:57<01:49,  2.15s/it]Best trial: 47. Best value: 0.0888184:  50%|█████     | 50/100 [01:57<01:46,  2.13s/it]Best trial: 50. Best value: 0.0919181:  50%|█████     | 50/100 [02:00<01:46,  2.13s/it]Best trial: 50. Best value: 0.0919181:  51%|█████     | 51/100 [02:00<01:44,  2.12s/it]Best trial: 50. Best value: 0.0919181:  51%|█████     | 51/100 [02:01<01:44,  2.12s/it]Best trial: 50. Best value: 0.0919181:  52%|█████▏    | 52/100 [02:01<01:39,  2.07s/it]Best trial: 50. Best value: 0.0919181:  52%|█████▏    | 52/100 [02:03<01:39,  2.07s/it]Best trial: 50. Best value: 0.0919181:  53%|█████▎    | 53/100 [02:03<01:33,  1.99s/it]Best trial: 53. Best value: 0.0924618:  53%|█████▎    | 53/100 [02:05<01:33,  1.99s/it]Best trial: 53. Best value: 0.0924618:  54%|█████▍    | 54/100 [02:05<01:29,  1.94s/it]Best trial: 53. Best value: 0.0924618:  54%|█████▍    | 54/100 [02:07<01:29,  1.94s/it]Best trial: 53. Best value: 0.0924618:  55%|█████▌    | 55/100 [02:07<01:28,  1.97s/it]Best trial: 53. Best value: 0.0924618:  55%|█████▌    | 55/100 [02:09<01:28,  1.97s/it]Best trial: 53. Best value: 0.0924618:  56%|█████▌    | 56/100 [02:09<01:27,  1.98s/it]Best trial: 56. Best value: 0.0999499:  56%|█████▌    | 56/100 [02:11<01:27,  1.98s/it]Best trial: 56. Best value: 0.0999499:  57%|█████▋    | 57/100 [02:11<01:26,  2.01s/it]Best trial: 56. Best value: 0.0999499:  57%|█████▋    | 57/100 [02:13<01:26,  2.01s/it]Best trial: 56. Best value: 0.0999499:  58%|█████▊    | 58/100 [02:13<01:23,  2.00s/it]Best trial: 58. Best value: 0.105095:  58%|█████▊    | 58/100 [02:15<01:23,  2.00s/it] Best trial: 58. Best value: 0.105095:  59%|█████▉    | 59/100 [02:15<01:21,  1.98s/it]Best trial: 58. Best value: 0.105095:  59%|█████▉    | 59/100 [02:17<01:21,  1.98s/it]Best trial: 58. Best value: 0.105095:  60%|██████    | 60/100 [02:17<01:19,  1.99s/it]Best trial: 58. Best value: 0.105095:  60%|██████    | 60/100 [02:19<01:19,  1.99s/it]Best trial: 58. Best value: 0.105095:  61%|██████    | 61/100 [02:19<01:12,  1.86s/it]Best trial: 58. Best value: 0.105095:  61%|██████    | 61/100 [02:21<01:12,  1.86s/it]Best trial: 58. Best value: 0.105095:  62%|██████▏   | 62/100 [02:21<01:10,  1.87s/it]Best trial: 62. Best value: 0.119101:  62%|██████▏   | 62/100 [02:22<01:10,  1.87s/it]Best trial: 62. Best value: 0.119101:  63%|██████▎   | 63/100 [02:22<01:08,  1.85s/it]Best trial: 62. Best value: 0.119101:  63%|██████▎   | 63/100 [02:24<01:08,  1.85s/it]Best trial: 62. Best value: 0.119101:  64%|██████▍   | 64/100 [02:24<01:04,  1.80s/it]Best trial: 62. Best value: 0.119101:  64%|██████▍   | 64/100 [02:26<01:04,  1.80s/it]Best trial: 62. Best value: 0.119101:  65%|██████▌   | 65/100 [02:26<01:05,  1.88s/it]Best trial: 62. Best value: 0.119101:  65%|██████▌   | 65/100 [02:28<01:05,  1.88s/it]Best trial: 62. Best value: 0.119101:  66%|██████▌   | 66/100 [02:28<01:06,  1.95s/it]Best trial: 62. Best value: 0.119101:  66%|██████▌   | 66/100 [02:30<01:06,  1.95s/it]Best trial: 62. Best value: 0.119101:  67%|██████▋   | 67/100 [02:30<01:01,  1.85s/it]Best trial: 62. Best value: 0.119101:  67%|██████▋   | 67/100 [02:31<01:01,  1.85s/it]Best trial: 62. Best value: 0.119101:  68%|██████▊   | 68/100 [02:31<00:56,  1.77s/it]Best trial: 62. Best value: 0.119101:  68%|██████▊   | 68/100 [02:33<00:56,  1.77s/it]Best trial: 62. Best value: 0.119101:  69%|██████▉   | 69/100 [02:33<00:54,  1.77s/it]Best trial: 62. Best value: 0.119101:  69%|██████▉   | 69/100 [02:35<00:54,  1.77s/it]Best trial: 62. Best value: 0.119101:  70%|███████   | 70/100 [02:35<00:54,  1.80s/it]Best trial: 62. Best value: 0.119101:  70%|███████   | 70/100 [02:37<00:54,  1.80s/it]Best trial: 62. Best value: 0.119101:  71%|███████   | 71/100 [02:37<00:53,  1.85s/it]Best trial: 62. Best value: 0.119101:  71%|███████   | 71/100 [02:39<00:53,  1.85s/it]Best trial: 62. Best value: 0.119101:  72%|███████▏  | 72/100 [02:39<00:50,  1.79s/it]Best trial: 62. Best value: 0.119101:  72%|███████▏  | 72/100 [02:40<00:50,  1.79s/it]Best trial: 62. Best value: 0.119101:  73%|███████▎  | 73/100 [02:40<00:47,  1.75s/it]Best trial: 62. Best value: 0.119101:  73%|███████▎  | 73/100 [02:42<00:47,  1.75s/it]Best trial: 62. Best value: 0.119101:  74%|███████▍  | 74/100 [02:42<00:46,  1.77s/it]Best trial: 62. Best value: 0.119101:  74%|███████▍  | 74/100 [02:44<00:46,  1.77s/it]Best trial: 62. Best value: 0.119101:  75%|███████▌  | 75/100 [02:44<00:48,  1.93s/it]Best trial: 62. Best value: 0.119101:  75%|███████▌  | 75/100 [02:46<00:48,  1.93s/it]Best trial: 62. Best value: 0.119101:  76%|███████▌  | 76/100 [02:46<00:44,  1.87s/it]Best trial: 62. Best value: 0.119101:  76%|███████▌  | 76/100 [02:48<00:44,  1.87s/it]Best trial: 62. Best value: 0.119101:  77%|███████▋  | 77/100 [02:48<00:42,  1.84s/it]Best trial: 62. Best value: 0.119101:  77%|███████▋  | 77/100 [02:50<00:42,  1.84s/it]Best trial: 62. Best value: 0.119101:  78%|███████▊  | 78/100 [02:50<00:40,  1.85s/it]Best trial: 62. Best value: 0.119101:  78%|███████▊  | 78/100 [02:51<00:40,  1.85s/it]Best trial: 62. Best value: 0.119101:  79%|███████▉  | 79/100 [02:51<00:37,  1.77s/it]Best trial: 62. Best value: 0.119101:  79%|███████▉  | 79/100 [02:53<00:37,  1.77s/it]Best trial: 62. Best value: 0.119101:  80%|████████  | 80/100 [02:53<00:35,  1.77s/it]Best trial: 62. Best value: 0.119101:  80%|████████  | 80/100 [02:55<00:35,  1.77s/it]Best trial: 62. Best value: 0.119101:  81%|████████  | 81/100 [02:55<00:34,  1.80s/it]Best trial: 62. Best value: 0.119101:  81%|████████  | 81/100 [02:57<00:34,  1.80s/it]Best trial: 62. Best value: 0.119101:  82%|████████▏ | 82/100 [02:57<00:33,  1.86s/it]Best trial: 62. Best value: 0.119101:  82%|████████▏ | 82/100 [02:59<00:33,  1.86s/it]Best trial: 62. Best value: 0.119101:  83%|████████▎ | 83/100 [02:59<00:32,  1.88s/it]Best trial: 62. Best value: 0.119101:  83%|████████▎ | 83/100 [03:01<00:32,  1.88s/it]Best trial: 62. Best value: 0.119101:  84%|████████▍ | 84/100 [03:01<00:30,  1.88s/it]Best trial: 84. Best value: 0.123681:  84%|████████▍ | 84/100 [03:03<00:30,  1.88s/it]Best trial: 84. Best value: 0.123681:  85%|████████▌ | 85/100 [03:03<00:27,  1.81s/it]Best trial: 84. Best value: 0.123681:  85%|████████▌ | 85/100 [03:04<00:27,  1.81s/it]Best trial: 84. Best value: 0.123681:  86%|████████▌ | 86/100 [03:04<00:25,  1.83s/it]Best trial: 84. Best value: 0.123681:  86%|████████▌ | 86/100 [03:06<00:25,  1.83s/it]Best trial: 84. Best value: 0.123681:  87%|████████▋ | 87/100 [03:06<00:22,  1.73s/it]Best trial: 84. Best value: 0.123681:  87%|████████▋ | 87/100 [03:08<00:22,  1.73s/it]Best trial: 84. Best value: 0.123681:  88%|████████▊ | 88/100 [03:08<00:21,  1.80s/it]Best trial: 84. Best value: 0.123681:  88%|████████▊ | 88/100 [03:10<00:21,  1.80s/it]Best trial: 84. Best value: 0.123681:  89%|████████▉ | 89/100 [03:10<00:20,  1.86s/it]Best trial: 84. Best value: 0.123681:  89%|████████▉ | 89/100 [03:12<00:20,  1.86s/it]Best trial: 84. Best value: 0.123681:  90%|█████████ | 90/100 [03:12<00:18,  1.82s/it]Best trial: 84. Best value: 0.123681:  90%|█████████ | 90/100 [03:13<00:18,  1.82s/it]Best trial: 84. Best value: 0.123681:  91%|█████████ | 91/100 [03:13<00:15,  1.77s/it]Best trial: 84. Best value: 0.123681:  91%|█████████ | 91/100 [03:15<00:15,  1.77s/it]Best trial: 84. Best value: 0.123681:  92%|█████████▏| 92/100 [03:15<00:13,  1.74s/it]Best trial: 84. Best value: 0.123681:  92%|█████████▏| 92/100 [03:17<00:13,  1.74s/it]Best trial: 84. Best value: 0.123681:  93%|█████████▎| 93/100 [03:17<00:12,  1.81s/it]Best trial: 84. Best value: 0.123681:  93%|█████████▎| 93/100 [03:19<00:12,  1.81s/it]Best trial: 84. Best value: 0.123681:  94%|█████████▍| 94/100 [03:19<00:10,  1.77s/it]Best trial: 84. Best value: 0.123681:  94%|█████████▍| 94/100 [03:20<00:10,  1.77s/it]Best trial: 84. Best value: 0.123681:  95%|█████████▌| 95/100 [03:20<00:08,  1.73s/it]Best trial: 84. Best value: 0.123681:  95%|█████████▌| 95/100 [03:22<00:08,  1.73s/it]Best trial: 84. Best value: 0.123681:  96%|█████████▌| 96/100 [03:22<00:06,  1.74s/it]Best trial: 84. Best value: 0.123681:  96%|█████████▌| 96/100 [03:24<00:06,  1.74s/it]Best trial: 84. Best value: 0.123681:  97%|█████████▋| 97/100 [03:24<00:05,  1.70s/it]Best trial: 84. Best value: 0.123681:  97%|█████████▋| 97/100 [03:25<00:05,  1.70s/it]Best trial: 84. Best value: 0.123681:  98%|█████████▊| 98/100 [03:25<00:03,  1.71s/it]Best trial: 84. Best value: 0.123681:  98%|█████████▊| 98/100 [03:27<00:03,  1.71s/it]Best trial: 84. Best value: 0.123681:  99%|█████████▉| 99/100 [03:27<00:01,  1.67s/it]Best trial: 84. Best value: 0.123681:  99%|█████████▉| 99/100 [03:29<00:01,  1.67s/it]Best trial: 84. Best value: 0.123681: 100%|██████████| 100/100 [03:29<00:00,  1.73s/it]Best trial: 84. Best value: 0.123681: 100%|██████████| 100/100 [03:29<00:00,  2.09s/it]
2025-11-30 13:01:22,308 - INFO - HPO Complete. Best AUPRC: 0.1237
2025-11-30 13:01:22,309 - INFO - Best Params: {'n_estimators': 100, 'learning_rate': 0.00208097658910206, 'max_depth': 8, 'subsample': 0.6253917044423637, 'colsample_bytree': 0.96787664845909, 'gamma': 3.66263086076083, 'reg_lambda': 0.00015245248976420342, 'reg_alpha': 0.05184093722763653}
2025-11-30 13:01:22,309 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:01:24,491 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: awp_only
2025-11-30 13:01:24,493 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:01:24,734 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:01:24,757 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:01:24,762 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 13:01:24,762 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:01:24,762 - INFO - Training model...
2025-11-30 13:01:25,427 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:01:30,356 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:01:30,356 - INFO - AUROC: 0.5330 (0.3178 - 0.6880)
2025-11-30 13:01:30,356 - INFO - AUPRC: 0.0293 (0.0120 - 0.0906)
2025-11-30 13:01:30,356 - INFO - Brier Score: 0.1800 (0.1788 - 0.1819)
2025-11-30 13:01:30,356 - INFO - Accuracy: 0.9769 (0.0130 - 0.9873)
2025-11-30 13:01:30,356 - INFO - Precision: 0.1250 (0.0125 - 0.3333)
2025-11-30 13:01:30,356 - INFO - Sensitivity (Recall): 0.1000 (0.0563 - 1.0000)
2025-11-30 13:01:30,357 - INFO - F1-Score: 0.1111 (0.0244 - 0.2691)
2025-11-30 13:01:30,357 - INFO - Best Threshold: 0.4800 (0.0100 - 0.4800)
2025-11-30 13:01:30,357 - INFO - Specificity: 0.9897 (0.0000 - 0.9953)
2025-11-30 13:01:30,362 - INFO - Calculating SHAP values...
2025-11-30 13:01:31,413 - INFO - SHAP plots saved.
2025-11-30 13:01:31,414 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:01:32,607 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: all_waveforms
2025-11-30 13:01:32,607 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:01:32,802 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:01:32,871 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:01:32,882 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 13:01:32,883 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0760891:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.0760891:   1%|          | 1/100 [00:07<12:42,  7.70s/it]Best trial: 1. Best value: 0.0906852:   1%|          | 1/100 [00:13<12:42,  7.70s/it]Best trial: 1. Best value: 0.0906852:   2%|▏         | 2/100 [00:13<10:56,  6.70s/it]Best trial: 1. Best value: 0.0906852:   2%|▏         | 2/100 [00:20<10:56,  6.70s/it]Best trial: 1. Best value: 0.0906852:   3%|▎         | 3/100 [00:20<10:34,  6.55s/it]Best trial: 1. Best value: 0.0906852:   3%|▎         | 3/100 [00:24<10:34,  6.55s/it]Best trial: 1. Best value: 0.0906852:   4%|▍         | 4/100 [00:24<09:01,  5.64s/it]Best trial: 4. Best value: 0.118388:   4%|▍         | 4/100 [00:28<09:01,  5.64s/it] Best trial: 4. Best value: 0.118388:   5%|▌         | 5/100 [00:28<07:55,  5.00s/it]Best trial: 4. Best value: 0.118388:   5%|▌         | 5/100 [00:34<07:55,  5.00s/it]Best trial: 4. Best value: 0.118388:   6%|▌         | 6/100 [00:34<08:31,  5.44s/it]Best trial: 4. Best value: 0.118388:   6%|▌         | 6/100 [00:41<08:31,  5.44s/it]Best trial: 4. Best value: 0.118388:   7%|▋         | 7/100 [00:41<09:00,  5.81s/it]Best trial: 4. Best value: 0.118388:   7%|▋         | 7/100 [00:50<09:00,  5.81s/it]Best trial: 4. Best value: 0.118388:   8%|▊         | 8/100 [00:50<10:49,  7.05s/it]Best trial: 4. Best value: 0.118388:   8%|▊         | 8/100 [00:58<10:49,  7.05s/it]Best trial: 4. Best value: 0.118388:   9%|▉         | 9/100 [00:58<10:57,  7.22s/it]Best trial: 4. Best value: 0.118388:   9%|▉         | 9/100 [01:05<10:57,  7.22s/it]Best trial: 4. Best value: 0.118388:  10%|█         | 10/100 [01:05<10:57,  7.30s/it]Best trial: 10. Best value: 0.153737:  10%|█         | 10/100 [01:09<10:57,  7.30s/it]Best trial: 10. Best value: 0.153737:  11%|█         | 11/100 [01:09<09:17,  6.27s/it]Best trial: 10. Best value: 0.153737:  11%|█         | 11/100 [01:13<09:17,  6.27s/it]Best trial: 10. Best value: 0.153737:  12%|█▏        | 12/100 [01:13<08:00,  5.46s/it]Best trial: 10. Best value: 0.153737:  12%|█▏        | 12/100 [01:17<08:00,  5.46s/it]Best trial: 10. Best value: 0.153737:  13%|█▎        | 13/100 [01:17<07:21,  5.08s/it]Best trial: 10. Best value: 0.153737:  13%|█▎        | 13/100 [01:23<07:21,  5.08s/it]Best trial: 10. Best value: 0.153737:  14%|█▍        | 14/100 [01:23<07:35,  5.30s/it]Best trial: 10. Best value: 0.153737:  14%|█▍        | 14/100 [01:30<07:35,  5.30s/it]Best trial: 10. Best value: 0.153737:  15%|█▌        | 15/100 [01:30<08:28,  5.98s/it]Best trial: 10. Best value: 0.153737:  15%|█▌        | 15/100 [01:36<08:28,  5.98s/it]Best trial: 10. Best value: 0.153737:  16%|█▌        | 16/100 [01:36<07:59,  5.70s/it]Best trial: 10. Best value: 0.153737:  16%|█▌        | 16/100 [01:42<07:59,  5.70s/it]Best trial: 10. Best value: 0.153737:  17%|█▋        | 17/100 [01:42<08:06,  5.87s/it]Best trial: 10. Best value: 0.153737:  17%|█▋        | 17/100 [01:46<08:06,  5.87s/it]Best trial: 10. Best value: 0.153737:  18%|█▊        | 18/100 [01:46<07:22,  5.40s/it]Best trial: 10. Best value: 0.153737:  18%|█▊        | 18/100 [01:51<07:22,  5.40s/it]Best trial: 10. Best value: 0.153737:  19%|█▉        | 19/100 [01:51<07:04,  5.24s/it]Best trial: 10. Best value: 0.153737:  19%|█▉        | 19/100 [01:59<07:04,  5.24s/it]Best trial: 10. Best value: 0.153737:  20%|██        | 20/100 [01:59<08:17,  6.22s/it]Best trial: 10. Best value: 0.153737:  20%|██        | 20/100 [02:06<08:17,  6.22s/it]Best trial: 10. Best value: 0.153737:  21%|██        | 21/100 [02:06<08:17,  6.30s/it]Best trial: 10. Best value: 0.153737:  21%|██        | 21/100 [02:10<08:17,  6.30s/it]Best trial: 10. Best value: 0.153737:  22%|██▏       | 22/100 [02:10<07:12,  5.55s/it]Best trial: 10. Best value: 0.153737:  22%|██▏       | 22/100 [02:14<07:12,  5.55s/it]Best trial: 10. Best value: 0.153737:  23%|██▎       | 23/100 [02:14<06:28,  5.04s/it]Best trial: 10. Best value: 0.153737:  23%|██▎       | 23/100 [02:18<06:28,  5.04s/it]Best trial: 10. Best value: 0.153737:  24%|██▍       | 24/100 [02:18<06:12,  4.90s/it]Best trial: 10. Best value: 0.153737:  24%|██▍       | 24/100 [02:24<06:12,  4.90s/it]Best trial: 10. Best value: 0.153737:  25%|██▌       | 25/100 [02:24<06:20,  5.07s/it]Best trial: 10. Best value: 0.153737:  25%|██▌       | 25/100 [02:31<06:20,  5.07s/it]Best trial: 10. Best value: 0.153737:  26%|██▌       | 26/100 [02:31<06:56,  5.63s/it]Best trial: 10. Best value: 0.153737:  26%|██▌       | 26/100 [02:34<06:56,  5.63s/it]Best trial: 10. Best value: 0.153737:  27%|██▋       | 27/100 [02:34<06:03,  4.97s/it]Best trial: 10. Best value: 0.153737:  27%|██▋       | 27/100 [02:38<06:03,  4.97s/it]Best trial: 10. Best value: 0.153737:  28%|██▊       | 28/100 [02:38<05:44,  4.79s/it]Best trial: 10. Best value: 0.153737:  28%|██▊       | 28/100 [02:44<05:44,  4.79s/it]Best trial: 10. Best value: 0.153737:  29%|██▉       | 29/100 [02:44<06:05,  5.14s/it]Best trial: 10. Best value: 0.153737:  29%|██▉       | 29/100 [02:49<06:05,  5.14s/it]Best trial: 10. Best value: 0.153737:  30%|███       | 30/100 [02:49<05:55,  5.08s/it]Best trial: 10. Best value: 0.153737:  30%|███       | 30/100 [02:57<05:55,  5.08s/it]Best trial: 10. Best value: 0.153737:  31%|███       | 31/100 [02:57<06:44,  5.86s/it]Best trial: 10. Best value: 0.153737:  31%|███       | 31/100 [03:01<06:44,  5.86s/it]Best trial: 10. Best value: 0.153737:  32%|███▏      | 32/100 [03:01<06:02,  5.33s/it]Best trial: 10. Best value: 0.153737:  32%|███▏      | 32/100 [03:06<06:02,  5.33s/it]Best trial: 10. Best value: 0.153737:  33%|███▎      | 33/100 [03:06<05:41,  5.09s/it]Best trial: 10. Best value: 0.153737:  33%|███▎      | 33/100 [03:10<05:41,  5.09s/it]Best trial: 10. Best value: 0.153737:  34%|███▍      | 34/100 [03:10<05:18,  4.83s/it]Best trial: 10. Best value: 0.153737:  34%|███▍      | 34/100 [03:16<05:18,  4.83s/it]Best trial: 10. Best value: 0.153737:  35%|███▌      | 35/100 [03:16<05:46,  5.32s/it]Best trial: 10. Best value: 0.153737:  35%|███▌      | 35/100 [03:21<05:46,  5.32s/it]Best trial: 10. Best value: 0.153737:  36%|███▌      | 36/100 [03:21<05:24,  5.07s/it]Best trial: 10. Best value: 0.153737:  36%|███▌      | 36/100 [03:26<05:24,  5.07s/it]Best trial: 10. Best value: 0.153737:  37%|███▋      | 37/100 [03:26<05:31,  5.25s/it]Best trial: 10. Best value: 0.153737:  37%|███▋      | 37/100 [03:30<05:31,  5.25s/it]Best trial: 10. Best value: 0.153737:  38%|███▊      | 38/100 [03:30<05:03,  4.90s/it]Best trial: 10. Best value: 0.153737:  38%|███▊      | 38/100 [03:35<05:03,  4.90s/it]Best trial: 10. Best value: 0.153737:  39%|███▉      | 39/100 [03:35<04:55,  4.85s/it]Best trial: 10. Best value: 0.153737:  39%|███▉      | 39/100 [03:42<04:55,  4.85s/it]Best trial: 10. Best value: 0.153737:  40%|████      | 40/100 [03:42<05:21,  5.35s/it]Best trial: 10. Best value: 0.153737:  40%|████      | 40/100 [03:49<05:21,  5.35s/it]Best trial: 10. Best value: 0.153737:  41%|████      | 41/100 [03:49<05:57,  6.06s/it]Best trial: 10. Best value: 0.153737:  41%|████      | 41/100 [03:54<05:57,  6.06s/it]Best trial: 10. Best value: 0.153737:  42%|████▏     | 42/100 [03:54<05:28,  5.66s/it]Best trial: 10. Best value: 0.153737:  42%|████▏     | 42/100 [03:58<05:28,  5.66s/it]Best trial: 10. Best value: 0.153737:  43%|████▎     | 43/100 [03:58<04:54,  5.16s/it]Best trial: 10. Best value: 0.153737:  43%|████▎     | 43/100 [04:03<04:54,  5.16s/it]Best trial: 10. Best value: 0.153737:  44%|████▍     | 44/100 [04:03<04:36,  4.95s/it]Best trial: 10. Best value: 0.153737:  44%|████▍     | 44/100 [04:09<04:36,  4.95s/it]Best trial: 10. Best value: 0.153737:  45%|████▌     | 45/100 [04:09<04:56,  5.39s/it]Best trial: 10. Best value: 0.153737:  45%|████▌     | 45/100 [04:14<04:56,  5.39s/it]Best trial: 10. Best value: 0.153737:  46%|████▌     | 46/100 [04:14<04:38,  5.16s/it]Best trial: 10. Best value: 0.153737:  46%|████▌     | 46/100 [04:18<04:38,  5.16s/it]Best trial: 10. Best value: 0.153737:  47%|████▋     | 47/100 [04:18<04:23,  4.97s/it]Best trial: 10. Best value: 0.153737:  47%|████▋     | 47/100 [04:27<04:23,  4.97s/it]Best trial: 10. Best value: 0.153737:  48%|████▊     | 48/100 [04:27<05:21,  6.19s/it]Best trial: 10. Best value: 0.153737:  48%|████▊     | 48/100 [04:33<05:21,  6.19s/it]Best trial: 10. Best value: 0.153737:  49%|████▉     | 49/100 [04:33<05:13,  6.15s/it]Best trial: 10. Best value: 0.153737:  49%|████▉     | 49/100 [04:39<05:13,  6.15s/it]Best trial: 10. Best value: 0.153737:  50%|█████     | 50/100 [04:39<04:58,  5.97s/it]Best trial: 10. Best value: 0.153737:  50%|█████     | 50/100 [04:44<04:58,  5.97s/it]Best trial: 10. Best value: 0.153737:  51%|█████     | 51/100 [04:44<04:41,  5.75s/it]Best trial: 10. Best value: 0.153737:  51%|█████     | 51/100 [04:49<04:41,  5.75s/it]Best trial: 10. Best value: 0.153737:  52%|█████▏    | 52/100 [04:49<04:18,  5.38s/it]Best trial: 10. Best value: 0.153737:  52%|█████▏    | 52/100 [04:53<04:18,  5.38s/it]Best trial: 10. Best value: 0.153737:  53%|█████▎    | 53/100 [04:53<03:53,  4.97s/it]Best trial: 10. Best value: 0.153737:  53%|█████▎    | 53/100 [04:57<03:53,  4.97s/it]Best trial: 10. Best value: 0.153737:  54%|█████▍    | 54/100 [04:57<03:38,  4.75s/it]Best trial: 10. Best value: 0.153737:  54%|█████▍    | 54/100 [05:01<03:38,  4.75s/it]Best trial: 10. Best value: 0.153737:  55%|█████▌    | 55/100 [05:01<03:24,  4.54s/it]Best trial: 10. Best value: 0.153737:  55%|█████▌    | 55/100 [05:06<03:24,  4.54s/it]Best trial: 10. Best value: 0.153737:  56%|█████▌    | 56/100 [05:06<03:28,  4.74s/it]Best trial: 10. Best value: 0.153737:  56%|█████▌    | 56/100 [05:11<03:28,  4.74s/it]Best trial: 10. Best value: 0.153737:  57%|█████▋    | 57/100 [05:11<03:19,  4.64s/it]Best trial: 10. Best value: 0.153737:  57%|█████▋    | 57/100 [05:16<03:19,  4.64s/it]Best trial: 10. Best value: 0.153737:  58%|█████▊    | 58/100 [05:16<03:27,  4.95s/it]Best trial: 10. Best value: 0.153737:  58%|█████▊    | 58/100 [05:20<03:27,  4.95s/it]Best trial: 10. Best value: 0.153737:  59%|█████▉    | 59/100 [05:20<03:15,  4.76s/it]Best trial: 10. Best value: 0.153737:  59%|█████▉    | 59/100 [05:26<03:15,  4.76s/it]Best trial: 10. Best value: 0.153737:  60%|██████    | 60/100 [05:26<03:18,  4.95s/it]Best trial: 10. Best value: 0.153737:  60%|██████    | 60/100 [05:31<03:18,  4.95s/it]Best trial: 10. Best value: 0.153737:  61%|██████    | 61/100 [05:31<03:10,  4.90s/it]Best trial: 61. Best value: 0.157301:  61%|██████    | 61/100 [05:35<03:10,  4.90s/it]Best trial: 61. Best value: 0.157301:  62%|██████▏   | 62/100 [05:35<02:58,  4.69s/it]Best trial: 61. Best value: 0.157301:  62%|██████▏   | 62/100 [05:39<02:58,  4.69s/it]Best trial: 61. Best value: 0.157301:  63%|██████▎   | 63/100 [05:39<02:47,  4.53s/it]Best trial: 61. Best value: 0.157301:  63%|██████▎   | 63/100 [05:45<02:47,  4.53s/it]Best trial: 61. Best value: 0.157301:  64%|██████▍   | 64/100 [05:45<02:58,  4.96s/it]Best trial: 61. Best value: 0.157301:  64%|██████▍   | 64/100 [05:49<02:58,  4.96s/it]Best trial: 61. Best value: 0.157301:  65%|██████▌   | 65/100 [05:49<02:41,  4.61s/it]Best trial: 61. Best value: 0.157301:  65%|██████▌   | 65/100 [05:53<02:41,  4.61s/it]Best trial: 61. Best value: 0.157301:  66%|██████▌   | 66/100 [05:53<02:29,  4.39s/it]Best trial: 61. Best value: 0.157301:  66%|██████▌   | 66/100 [05:57<02:29,  4.39s/it]Best trial: 61. Best value: 0.157301:  67%|██████▋   | 67/100 [05:57<02:27,  4.48s/it]Best trial: 61. Best value: 0.157301:  67%|██████▋   | 67/100 [06:03<02:27,  4.48s/it]Best trial: 61. Best value: 0.157301:  68%|██████▊   | 68/100 [06:03<02:31,  4.73s/it]Best trial: 61. Best value: 0.157301:  68%|██████▊   | 68/100 [06:08<02:31,  4.73s/it]Best trial: 61. Best value: 0.157301:  69%|██████▉   | 69/100 [06:08<02:27,  4.76s/it]Best trial: 61. Best value: 0.157301:  69%|██████▉   | 69/100 [06:13<02:27,  4.76s/it]Best trial: 61. Best value: 0.157301:  70%|███████   | 70/100 [06:13<02:29,  5.00s/it]Best trial: 70. Best value: 0.189928:  70%|███████   | 70/100 [06:17<02:29,  5.00s/it]Best trial: 70. Best value: 0.189928:  71%|███████   | 71/100 [06:17<02:15,  4.66s/it]Best trial: 70. Best value: 0.189928:  71%|███████   | 71/100 [06:22<02:15,  4.66s/it]Best trial: 70. Best value: 0.189928:  72%|███████▏  | 72/100 [06:22<02:12,  4.72s/it]Best trial: 70. Best value: 0.189928:  72%|███████▏  | 72/100 [06:26<02:12,  4.72s/it]Best trial: 70. Best value: 0.189928:  73%|███████▎  | 73/100 [06:26<02:00,  4.47s/it]Best trial: 70. Best value: 0.189928:  73%|███████▎  | 73/100 [06:30<02:00,  4.47s/it]Best trial: 70. Best value: 0.189928:  74%|███████▍  | 74/100 [06:30<01:53,  4.37s/it]Best trial: 70. Best value: 0.189928:  74%|███████▍  | 74/100 [06:36<01:53,  4.37s/it]Best trial: 70. Best value: 0.189928:  75%|███████▌  | 75/100 [06:36<02:04,  4.96s/it]Best trial: 70. Best value: 0.189928:  75%|███████▌  | 75/100 [06:40<02:04,  4.96s/it]Best trial: 70. Best value: 0.189928:  76%|███████▌  | 76/100 [06:40<01:52,  4.71s/it]Best trial: 70. Best value: 0.189928:  76%|███████▌  | 76/100 [06:45<01:52,  4.71s/it]Best trial: 70. Best value: 0.189928:  77%|███████▋  | 77/100 [06:45<01:48,  4.73s/it]Best trial: 70. Best value: 0.189928:  77%|███████▋  | 77/100 [06:50<01:48,  4.73s/it]Best trial: 70. Best value: 0.189928:  78%|███████▊  | 78/100 [06:50<01:42,  4.67s/it]Best trial: 70. Best value: 0.189928:  78%|███████▊  | 78/100 [06:54<01:42,  4.67s/it]Best trial: 70. Best value: 0.189928:  79%|███████▉  | 79/100 [06:54<01:38,  4.70s/it]Best trial: 70. Best value: 0.189928:  79%|███████▉  | 79/100 [07:01<01:38,  4.70s/it]Best trial: 70. Best value: 0.189928:  80%|████████  | 80/100 [07:01<01:43,  5.16s/it]Best trial: 70. Best value: 0.189928:  80%|████████  | 80/100 [07:05<01:43,  5.16s/it]Best trial: 70. Best value: 0.189928:  81%|████████  | 81/100 [07:05<01:33,  4.91s/it]Best trial: 70. Best value: 0.189928:  81%|████████  | 81/100 [07:10<01:33,  4.91s/it]Best trial: 70. Best value: 0.189928:  82%|████████▏ | 82/100 [07:10<01:27,  4.85s/it]Best trial: 70. Best value: 0.189928:  82%|████████▏ | 82/100 [07:13<01:27,  4.85s/it]Best trial: 70. Best value: 0.189928:  83%|████████▎ | 83/100 [07:13<01:17,  4.53s/it]Best trial: 70. Best value: 0.189928:  83%|████████▎ | 83/100 [07:18<01:17,  4.53s/it]Best trial: 70. Best value: 0.189928:  84%|████████▍ | 84/100 [07:18<01:14,  4.66s/it]Best trial: 70. Best value: 0.189928:  84%|████████▍ | 84/100 [07:22<01:14,  4.66s/it]Best trial: 70. Best value: 0.189928:  85%|████████▌ | 85/100 [07:22<01:06,  4.42s/it]Best trial: 70. Best value: 0.189928:  85%|████████▌ | 85/100 [07:27<01:06,  4.42s/it]Best trial: 70. Best value: 0.189928:  86%|████████▌ | 86/100 [07:27<01:05,  4.65s/it]Best trial: 70. Best value: 0.189928:  86%|████████▌ | 86/100 [07:32<01:05,  4.65s/it]Best trial: 70. Best value: 0.189928:  87%|████████▋ | 87/100 [07:32<00:59,  4.58s/it]Best trial: 70. Best value: 0.189928:  87%|████████▋ | 87/100 [07:38<00:59,  4.58s/it]Best trial: 70. Best value: 0.189928:  88%|████████▊ | 88/100 [07:38<01:01,  5.13s/it]Best trial: 70. Best value: 0.189928:  88%|████████▊ | 88/100 [07:42<01:01,  5.13s/it]Best trial: 70. Best value: 0.189928:  89%|████████▉ | 89/100 [07:42<00:53,  4.83s/it]Best trial: 70. Best value: 0.189928:  89%|████████▉ | 89/100 [07:47<00:53,  4.83s/it]Best trial: 70. Best value: 0.189928:  90%|█████████ | 90/100 [07:47<00:48,  4.80s/it]Best trial: 70. Best value: 0.189928:  90%|█████████ | 90/100 [07:56<00:48,  4.80s/it]Best trial: 70. Best value: 0.189928:  91%|█████████ | 91/100 [07:56<00:54,  6.01s/it]Best trial: 70. Best value: 0.189928:  91%|█████████ | 91/100 [08:00<00:54,  6.01s/it]Best trial: 70. Best value: 0.189928:  92%|█████████▏| 92/100 [08:00<00:44,  5.53s/it]Best trial: 70. Best value: 0.189928:  92%|█████████▏| 92/100 [08:04<00:44,  5.53s/it]Best trial: 70. Best value: 0.189928:  93%|█████████▎| 93/100 [08:04<00:35,  5.07s/it]Best trial: 70. Best value: 0.189928:  93%|█████████▎| 93/100 [08:08<00:35,  5.07s/it]Best trial: 70. Best value: 0.189928:  94%|█████████▍| 94/100 [08:08<00:28,  4.78s/it]Best trial: 70. Best value: 0.189928:  94%|█████████▍| 94/100 [08:12<00:28,  4.78s/it]Best trial: 70. Best value: 0.189928:  95%|█████████▌| 95/100 [08:12<00:22,  4.55s/it]Best trial: 70. Best value: 0.189928:  95%|█████████▌| 95/100 [08:17<00:22,  4.55s/it]Best trial: 70. Best value: 0.189928:  96%|█████████▌| 96/100 [08:17<00:17,  4.40s/it]Best trial: 70. Best value: 0.189928:  96%|█████████▌| 96/100 [08:21<00:17,  4.40s/it]Best trial: 70. Best value: 0.189928:  97%|█████████▋| 97/100 [08:21<00:12,  4.31s/it]Best trial: 70. Best value: 0.189928:  97%|█████████▋| 97/100 [08:25<00:12,  4.31s/it]Best trial: 70. Best value: 0.189928:  98%|█████████▊| 98/100 [08:25<00:08,  4.26s/it]Best trial: 70. Best value: 0.189928:  98%|█████████▊| 98/100 [08:29<00:08,  4.26s/it]Best trial: 70. Best value: 0.189928:  99%|█████████▉| 99/100 [08:29<00:04,  4.16s/it]Best trial: 70. Best value: 0.189928:  99%|█████████▉| 99/100 [08:33<00:04,  4.16s/it]Best trial: 70. Best value: 0.189928: 100%|██████████| 100/100 [08:33<00:00,  4.12s/it]Best trial: 70. Best value: 0.189928: 100%|██████████| 100/100 [08:33<00:00,  5.13s/it]
2025-11-30 13:10:06,129 - INFO - HPO Complete. Best AUPRC: 0.1899
2025-11-30 13:10:06,129 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.0001016098583408588, 'max_depth': 3, 'subsample': 0.6860033894000204, 'colsample_bytree': 0.8621725290204415, 'gamma': 2.698307684987302, 'reg_lambda': 9.332388142665813e-08, 'reg_alpha': 1.3159583919829444e-07}
2025-11-30 13:10:06,130 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:10:07,988 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: all_waveforms
2025-11-30 13:10:07,989 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:10:08,215 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:10:08,283 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:10:08,295 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 13:10:08,295 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:10:08,295 - INFO - Training model...
2025-11-30 13:10:09,820 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:10:16,121 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:10:16,122 - INFO - AUROC: 0.6705 (0.4552 - 0.7822)
2025-11-30 13:10:16,122 - INFO - AUPRC: 0.0432 (0.0197 - 0.0890)
2025-11-30 13:10:16,122 - INFO - Brier Score: 0.2443 (0.2442 - 0.2444)
2025-11-30 13:10:16,122 - INFO - Accuracy: 0.0145 (0.0087 - 0.0266)
2025-11-30 13:10:16,122 - INFO - Precision: 0.0145 (0.0087 - 0.0266)
2025-11-30 13:10:16,122 - INFO - Sensitivity (Recall): 1.0000 (1.0000 - 1.0000)
2025-11-30 13:10:16,122 - INFO - F1-Score: 0.0285 (0.0172 - 0.0518)
2025-11-30 13:10:16,122 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0100)
2025-11-30 13:10:16,122 - INFO - Specificity: 0.0000 (0.0000 - 0.0000)
2025-11-30 13:10:16,128 - INFO - Calculating SHAP values...
2025-11-30 13:10:17,230 - INFO - SHAP plots saved.
2025-11-30 13:10:17,230 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:10:18,430 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 13:10:18,430 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:10:18,623 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:10:18,704 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:10:18,728 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 13:10:18,728 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.207103:   0%|          | 0/100 [00:11<?, ?it/s]Best trial: 0. Best value: 0.207103:   1%|          | 1/100 [00:11<19:38, 11.90s/it]Best trial: 1. Best value: 0.315111:   1%|          | 1/100 [00:19<19:38, 11.90s/it]Best trial: 1. Best value: 0.315111:   2%|▏         | 2/100 [00:19<14:59,  9.18s/it]Best trial: 1. Best value: 0.315111:   2%|▏         | 2/100 [00:31<14:59,  9.18s/it]Best trial: 1. Best value: 0.315111:   3%|▎         | 3/100 [00:31<16:51, 10.43s/it]Best trial: 1. Best value: 0.315111:   3%|▎         | 3/100 [00:37<16:51, 10.43s/it]Best trial: 1. Best value: 0.315111:   4%|▍         | 4/100 [00:37<14:26,  9.02s/it]Best trial: 4. Best value: 0.328263:   4%|▍         | 4/100 [00:43<14:26,  9.02s/it]Best trial: 4. Best value: 0.328263:   5%|▌         | 5/100 [00:43<12:22,  7.81s/it]Best trial: 4. Best value: 0.328263:   5%|▌         | 5/100 [00:49<12:22,  7.81s/it]Best trial: 4. Best value: 0.328263:   6%|▌         | 6/100 [00:49<11:26,  7.30s/it]Best trial: 4. Best value: 0.328263:   6%|▌         | 6/100 [00:59<11:26,  7.30s/it]Best trial: 4. Best value: 0.328263:   7%|▋         | 7/100 [00:59<12:27,  8.03s/it]Best trial: 4. Best value: 0.328263:   7%|▋         | 7/100 [01:10<12:27,  8.03s/it]Best trial: 4. Best value: 0.328263:   8%|▊         | 8/100 [01:10<13:42,  8.94s/it]Best trial: 4. Best value: 0.328263:   8%|▊         | 8/100 [01:20<13:42,  8.94s/it]Best trial: 4. Best value: 0.328263:   9%|▉         | 9/100 [01:20<14:04,  9.28s/it]Best trial: 4. Best value: 0.328263:   9%|▉         | 9/100 [01:28<14:04,  9.28s/it]Best trial: 4. Best value: 0.328263:  10%|█         | 10/100 [01:28<13:18,  8.88s/it]Best trial: 10. Best value: 0.337271:  10%|█         | 10/100 [01:33<13:18,  8.88s/it]Best trial: 10. Best value: 0.337271:  11%|█         | 11/100 [01:33<11:33,  7.80s/it]Best trial: 11. Best value: 0.35355:  11%|█         | 11/100 [01:39<11:33,  7.80s/it] Best trial: 11. Best value: 0.35355:  12%|█▏        | 12/100 [01:39<10:37,  7.25s/it]Best trial: 12. Best value: 0.360855:  12%|█▏        | 12/100 [01:47<10:37,  7.25s/it]Best trial: 12. Best value: 0.360855:  13%|█▎        | 13/100 [01:47<10:50,  7.48s/it]Best trial: 12. Best value: 0.360855:  13%|█▎        | 13/100 [01:53<10:50,  7.48s/it]Best trial: 12. Best value: 0.360855:  14%|█▍        | 14/100 [01:53<09:59,  6.97s/it]Best trial: 14. Best value: 0.372362:  14%|█▍        | 14/100 [01:59<09:59,  6.97s/it]Best trial: 14. Best value: 0.372362:  15%|█▌        | 15/100 [01:59<09:22,  6.61s/it]Best trial: 14. Best value: 0.372362:  15%|█▌        | 15/100 [02:07<09:22,  6.61s/it]Best trial: 14. Best value: 0.372362:  16%|█▌        | 16/100 [02:07<09:51,  7.04s/it]Best trial: 14. Best value: 0.372362:  16%|█▌        | 16/100 [02:13<09:51,  7.04s/it]Best trial: 14. Best value: 0.372362:  17%|█▋        | 17/100 [02:13<09:34,  6.92s/it]Best trial: 14. Best value: 0.372362:  17%|█▋        | 17/100 [02:20<09:34,  6.92s/it]Best trial: 14. Best value: 0.372362:  18%|█▊        | 18/100 [02:20<09:07,  6.67s/it]Best trial: 14. Best value: 0.372362:  18%|█▊        | 18/100 [02:29<09:07,  6.67s/it]Best trial: 14. Best value: 0.372362:  19%|█▉        | 19/100 [02:29<10:02,  7.44s/it]Best trial: 14. Best value: 0.372362:  19%|█▉        | 19/100 [02:34<10:02,  7.44s/it]Best trial: 14. Best value: 0.372362:  20%|██        | 20/100 [02:34<09:06,  6.83s/it]Best trial: 14. Best value: 0.372362:  20%|██        | 20/100 [02:40<09:06,  6.83s/it]Best trial: 14. Best value: 0.372362:  21%|██        | 21/100 [02:40<08:43,  6.62s/it]Best trial: 14. Best value: 0.372362:  21%|██        | 21/100 [02:46<08:43,  6.62s/it]Best trial: 14. Best value: 0.372362:  22%|██▏       | 22/100 [02:46<08:23,  6.45s/it]Best trial: 22. Best value: 0.384243:  22%|██▏       | 22/100 [02:53<08:23,  6.45s/it]Best trial: 22. Best value: 0.384243:  23%|██▎       | 23/100 [02:53<08:23,  6.54s/it]Best trial: 22. Best value: 0.384243:  23%|██▎       | 23/100 [03:00<08:23,  6.54s/it]Best trial: 22. Best value: 0.384243:  24%|██▍       | 24/100 [03:00<08:21,  6.60s/it]Best trial: 22. Best value: 0.384243:  24%|██▍       | 24/100 [03:07<08:21,  6.60s/it]Best trial: 22. Best value: 0.384243:  25%|██▌       | 25/100 [03:07<08:20,  6.67s/it]Best trial: 22. Best value: 0.384243:  25%|██▌       | 25/100 [03:11<08:20,  6.67s/it]Best trial: 22. Best value: 0.384243:  26%|██▌       | 26/100 [03:11<07:30,  6.08s/it]Best trial: 22. Best value: 0.384243:  26%|██▌       | 26/100 [03:17<07:30,  6.08s/it]Best trial: 22. Best value: 0.384243:  27%|██▋       | 27/100 [03:17<07:19,  6.02s/it]Best trial: 22. Best value: 0.384243:  27%|██▋       | 27/100 [03:22<07:19,  6.02s/it]Best trial: 22. Best value: 0.384243:  28%|██▊       | 28/100 [03:22<06:41,  5.58s/it]Best trial: 22. Best value: 0.384243:  28%|██▊       | 28/100 [03:34<06:41,  5.58s/it]Best trial: 22. Best value: 0.384243:  29%|██▉       | 29/100 [03:34<09:03,  7.65s/it]Best trial: 22. Best value: 0.384243:  29%|██▉       | 29/100 [03:41<09:03,  7.65s/it]Best trial: 22. Best value: 0.384243:  30%|███       | 30/100 [03:41<08:28,  7.27s/it]Best trial: 22. Best value: 0.384243:  30%|███       | 30/100 [03:48<08:28,  7.27s/it]Best trial: 22. Best value: 0.384243:  31%|███       | 31/100 [03:48<08:13,  7.16s/it]Best trial: 22. Best value: 0.384243:  31%|███       | 31/100 [03:55<08:13,  7.16s/it]Best trial: 22. Best value: 0.384243:  32%|███▏      | 32/100 [03:55<08:05,  7.14s/it]Best trial: 22. Best value: 0.384243:  32%|███▏      | 32/100 [04:00<08:05,  7.14s/it]Best trial: 22. Best value: 0.384243:  33%|███▎      | 33/100 [04:00<07:30,  6.72s/it]Best trial: 22. Best value: 0.384243:  33%|███▎      | 33/100 [04:06<07:30,  6.72s/it]Best trial: 22. Best value: 0.384243:  34%|███▍      | 34/100 [04:06<06:59,  6.36s/it]Best trial: 22. Best value: 0.384243:  34%|███▍      | 34/100 [04:12<06:59,  6.36s/it]Best trial: 22. Best value: 0.384243:  35%|███▌      | 35/100 [04:12<06:52,  6.35s/it]Best trial: 22. Best value: 0.384243:  35%|███▌      | 35/100 [04:19<06:52,  6.35s/it]Best trial: 22. Best value: 0.384243:  36%|███▌      | 36/100 [04:19<06:57,  6.52s/it]Best trial: 22. Best value: 0.384243:  36%|███▌      | 36/100 [04:33<06:57,  6.52s/it]Best trial: 22. Best value: 0.384243:  37%|███▋      | 37/100 [04:33<09:16,  8.83s/it]Best trial: 22. Best value: 0.384243:  37%|███▋      | 37/100 [04:40<09:16,  8.83s/it]Best trial: 22. Best value: 0.384243:  38%|███▊      | 38/100 [04:40<08:21,  8.10s/it]Best trial: 22. Best value: 0.384243:  38%|███▊      | 38/100 [04:46<08:21,  8.10s/it]Best trial: 22. Best value: 0.384243:  39%|███▉      | 39/100 [04:46<07:32,  7.42s/it]Best trial: 22. Best value: 0.384243:  39%|███▉      | 39/100 [04:55<07:32,  7.42s/it]Best trial: 22. Best value: 0.384243:  40%|████      | 40/100 [04:55<07:56,  7.94s/it]Best trial: 22. Best value: 0.384243:  40%|████      | 40/100 [05:01<07:56,  7.94s/it]Best trial: 22. Best value: 0.384243:  41%|████      | 41/100 [05:01<07:20,  7.47s/it]Best trial: 22. Best value: 0.384243:  41%|████      | 41/100 [05:06<07:20,  7.47s/it]Best trial: 22. Best value: 0.384243:  42%|████▏     | 42/100 [05:06<06:35,  6.81s/it]Best trial: 22. Best value: 0.384243:  42%|████▏     | 42/100 [05:12<06:35,  6.81s/it]Best trial: 22. Best value: 0.384243:  43%|████▎     | 43/100 [05:12<06:08,  6.47s/it]Best trial: 22. Best value: 0.384243:  43%|████▎     | 43/100 [05:19<06:08,  6.47s/it]Best trial: 22. Best value: 0.384243:  44%|████▍     | 44/100 [05:19<06:01,  6.46s/it]Best trial: 22. Best value: 0.384243:  44%|████▍     | 44/100 [05:24<06:01,  6.46s/it]Best trial: 22. Best value: 0.384243:  45%|████▌     | 45/100 [05:24<05:42,  6.22s/it]Best trial: 22. Best value: 0.384243:  45%|████▌     | 45/100 [05:30<05:42,  6.22s/it]Best trial: 22. Best value: 0.384243:  46%|████▌     | 46/100 [05:30<05:21,  5.95s/it]Best trial: 22. Best value: 0.384243:  46%|████▌     | 46/100 [05:35<05:21,  5.95s/it]Best trial: 22. Best value: 0.384243:  47%|████▋     | 47/100 [05:35<05:13,  5.92s/it]Best trial: 22. Best value: 0.384243:  47%|████▋     | 47/100 [05:40<05:13,  5.92s/it]Best trial: 22. Best value: 0.384243:  48%|████▊     | 48/100 [05:40<04:52,  5.62s/it]Best trial: 22. Best value: 0.384243:  48%|████▊     | 48/100 [05:48<04:52,  5.62s/it]Best trial: 22. Best value: 0.384243:  49%|████▉     | 49/100 [05:48<05:10,  6.10s/it]Best trial: 22. Best value: 0.384243:  49%|████▉     | 49/100 [05:54<05:10,  6.10s/it]Best trial: 22. Best value: 0.384243:  50%|█████     | 50/100 [05:54<05:04,  6.09s/it]Best trial: 22. Best value: 0.384243:  50%|█████     | 50/100 [05:58<05:04,  6.09s/it]Best trial: 22. Best value: 0.384243:  51%|█████     | 51/100 [05:58<04:38,  5.69s/it]Best trial: 22. Best value: 0.384243:  51%|█████     | 51/100 [06:04<04:38,  5.69s/it]Best trial: 22. Best value: 0.384243:  52%|█████▏    | 52/100 [06:04<04:25,  5.54s/it]Best trial: 22. Best value: 0.384243:  52%|█████▏    | 52/100 [06:09<04:25,  5.54s/it]Best trial: 22. Best value: 0.384243:  53%|█████▎    | 53/100 [06:09<04:19,  5.51s/it]Best trial: 22. Best value: 0.384243:  53%|█████▎    | 53/100 [06:14<04:19,  5.51s/it]Best trial: 22. Best value: 0.384243:  54%|█████▍    | 54/100 [06:14<04:10,  5.44s/it]Best trial: 22. Best value: 0.384243:  54%|█████▍    | 54/100 [06:20<04:10,  5.44s/it]Best trial: 22. Best value: 0.384243:  55%|█████▌    | 55/100 [06:20<04:05,  5.46s/it]Best trial: 22. Best value: 0.384243:  55%|█████▌    | 55/100 [06:29<04:05,  5.46s/it]Best trial: 22. Best value: 0.384243:  56%|█████▌    | 56/100 [06:29<04:49,  6.59s/it]Best trial: 22. Best value: 0.384243:  56%|█████▌    | 56/100 [06:35<04:49,  6.59s/it]Best trial: 22. Best value: 0.384243:  57%|█████▋    | 57/100 [06:35<04:32,  6.33s/it]Best trial: 22. Best value: 0.384243:  57%|█████▋    | 57/100 [06:40<04:32,  6.33s/it]Best trial: 22. Best value: 0.384243:  58%|█████▊    | 58/100 [06:40<04:16,  6.11s/it]Best trial: 22. Best value: 0.384243:  58%|█████▊    | 58/100 [06:47<04:16,  6.11s/it]Best trial: 22. Best value: 0.384243:  59%|█████▉    | 59/100 [06:47<04:12,  6.17s/it]Best trial: 22. Best value: 0.384243:  59%|█████▉    | 59/100 [06:52<04:12,  6.17s/it]Best trial: 22. Best value: 0.384243:  60%|██████    | 60/100 [06:52<03:57,  5.93s/it]Best trial: 22. Best value: 0.384243:  60%|██████    | 60/100 [06:59<03:57,  5.93s/it]Best trial: 22. Best value: 0.384243:  61%|██████    | 61/100 [06:59<04:04,  6.27s/it]Best trial: 22. Best value: 0.384243:  61%|██████    | 61/100 [07:05<04:04,  6.27s/it]Best trial: 22. Best value: 0.384243:  62%|██████▏   | 62/100 [07:05<03:53,  6.13s/it]Best trial: 22. Best value: 0.384243:  62%|██████▏   | 62/100 [07:11<03:53,  6.13s/it]Best trial: 22. Best value: 0.384243:  63%|██████▎   | 63/100 [07:11<03:41,  5.98s/it]Best trial: 22. Best value: 0.384243:  63%|██████▎   | 63/100 [07:16<03:41,  5.98s/it]Best trial: 22. Best value: 0.384243:  64%|██████▍   | 64/100 [07:16<03:28,  5.78s/it]Best trial: 22. Best value: 0.384243:  64%|██████▍   | 64/100 [07:22<03:28,  5.78s/it]Best trial: 22. Best value: 0.384243:  65%|██████▌   | 65/100 [07:22<03:26,  5.89s/it]Best trial: 22. Best value: 0.384243:  65%|██████▌   | 65/100 [07:28<03:26,  5.89s/it]Best trial: 22. Best value: 0.384243:  66%|██████▌   | 66/100 [07:28<03:17,  5.81s/it]Best trial: 22. Best value: 0.384243:  66%|██████▌   | 66/100 [07:33<03:17,  5.81s/it]Best trial: 22. Best value: 0.384243:  67%|██████▋   | 67/100 [07:33<03:05,  5.61s/it]Best trial: 22. Best value: 0.384243:  67%|██████▋   | 67/100 [07:38<03:05,  5.61s/it]Best trial: 22. Best value: 0.384243:  68%|██████▊   | 68/100 [07:38<03:00,  5.63s/it]Best trial: 22. Best value: 0.384243:  68%|██████▊   | 68/100 [07:45<03:00,  5.63s/it]Best trial: 22. Best value: 0.384243:  69%|██████▉   | 69/100 [07:45<03:07,  6.04s/it]Best trial: 22. Best value: 0.384243:  69%|██████▉   | 69/100 [07:53<03:07,  6.04s/it]Best trial: 22. Best value: 0.384243:  70%|███████   | 70/100 [07:53<03:13,  6.45s/it]Best trial: 22. Best value: 0.384243:  70%|███████   | 70/100 [07:59<03:13,  6.45s/it]Best trial: 22. Best value: 0.384243:  71%|███████   | 71/100 [07:59<03:07,  6.48s/it]Best trial: 22. Best value: 0.384243:  71%|███████   | 71/100 [08:06<03:07,  6.48s/it]Best trial: 22. Best value: 0.384243:  72%|███████▏  | 72/100 [08:06<03:04,  6.59s/it]Best trial: 22. Best value: 0.384243:  72%|███████▏  | 72/100 [08:14<03:04,  6.59s/it]Best trial: 22. Best value: 0.384243:  73%|███████▎  | 73/100 [08:14<03:07,  6.95s/it]Best trial: 22. Best value: 0.384243:  73%|███████▎  | 73/100 [08:21<03:07,  6.95s/it]Best trial: 22. Best value: 0.384243:  74%|███████▍  | 74/100 [08:21<03:03,  7.06s/it]Best trial: 22. Best value: 0.384243:  74%|███████▍  | 74/100 [08:29<03:03,  7.06s/it]Best trial: 22. Best value: 0.384243:  75%|███████▌  | 75/100 [08:29<03:04,  7.39s/it]Best trial: 22. Best value: 0.384243:  75%|███████▌  | 75/100 [08:37<03:04,  7.39s/it]Best trial: 22. Best value: 0.384243:  76%|███████▌  | 76/100 [08:37<02:55,  7.32s/it]Best trial: 22. Best value: 0.384243:  76%|███████▌  | 76/100 [08:45<02:55,  7.32s/it]Best trial: 22. Best value: 0.384243:  77%|███████▋  | 77/100 [08:45<02:54,  7.57s/it]Best trial: 22. Best value: 0.384243:  77%|███████▋  | 77/100 [08:51<02:54,  7.57s/it]Best trial: 22. Best value: 0.384243:  78%|███████▊  | 78/100 [08:51<02:38,  7.20s/it]Best trial: 22. Best value: 0.384243:  78%|███████▊  | 78/100 [08:57<02:38,  7.20s/it]Best trial: 22. Best value: 0.384243:  79%|███████▉  | 79/100 [08:57<02:21,  6.72s/it]Best trial: 22. Best value: 0.384243:  79%|███████▉  | 79/100 [09:05<02:21,  6.72s/it]Best trial: 22. Best value: 0.384243:  80%|████████  | 80/100 [09:05<02:22,  7.12s/it]Best trial: 22. Best value: 0.384243:  80%|████████  | 80/100 [09:11<02:22,  7.12s/it]Best trial: 22. Best value: 0.384243:  81%|████████  | 81/100 [09:11<02:10,  6.85s/it]Best trial: 22. Best value: 0.384243:  81%|████████  | 81/100 [09:16<02:10,  6.85s/it]Best trial: 22. Best value: 0.384243:  82%|████████▏ | 82/100 [09:16<01:53,  6.30s/it]Best trial: 22. Best value: 0.384243:  82%|████████▏ | 82/100 [09:22<01:53,  6.30s/it]Best trial: 22. Best value: 0.384243:  83%|████████▎ | 83/100 [09:22<01:43,  6.08s/it]Best trial: 22. Best value: 0.384243:  83%|████████▎ | 83/100 [09:32<01:43,  6.08s/it]Best trial: 22. Best value: 0.384243:  84%|████████▍ | 84/100 [09:32<01:59,  7.47s/it]Best trial: 22. Best value: 0.384243:  84%|████████▍ | 84/100 [09:40<01:59,  7.47s/it]Best trial: 22. Best value: 0.384243:  85%|████████▌ | 85/100 [09:40<01:54,  7.63s/it]Best trial: 22. Best value: 0.384243:  85%|████████▌ | 85/100 [09:46<01:54,  7.63s/it]Best trial: 22. Best value: 0.384243:  86%|████████▌ | 86/100 [09:46<01:38,  7.03s/it]Best trial: 22. Best value: 0.384243:  86%|████████▌ | 86/100 [09:52<01:38,  7.03s/it]Best trial: 22. Best value: 0.384243:  87%|████████▋ | 87/100 [09:52<01:27,  6.70s/it]Best trial: 22. Best value: 0.384243:  87%|████████▋ | 87/100 [09:59<01:27,  6.70s/it]Best trial: 22. Best value: 0.384243:  88%|████████▊ | 88/100 [09:59<01:20,  6.71s/it]Best trial: 22. Best value: 0.384243:  88%|████████▊ | 88/100 [10:05<01:20,  6.71s/it]Best trial: 22. Best value: 0.384243:  89%|████████▉ | 89/100 [10:05<01:11,  6.53s/it]Best trial: 22. Best value: 0.384243:  89%|████████▉ | 89/100 [10:12<01:11,  6.53s/it]Best trial: 22. Best value: 0.384243:  90%|█████████ | 90/100 [10:12<01:06,  6.61s/it]Best trial: 22. Best value: 0.384243:  90%|█████████ | 90/100 [10:17<01:06,  6.61s/it]Best trial: 22. Best value: 0.384243:  91%|█████████ | 91/100 [10:17<00:57,  6.39s/it]Best trial: 22. Best value: 0.384243:  91%|█████████ | 91/100 [10:24<00:57,  6.39s/it]Best trial: 22. Best value: 0.384243:  92%|█████████▏| 92/100 [10:24<00:52,  6.53s/it]Best trial: 22. Best value: 0.384243:  92%|█████████▏| 92/100 [10:31<00:52,  6.53s/it]Best trial: 22. Best value: 0.384243:  93%|█████████▎| 93/100 [10:31<00:45,  6.46s/it]Best trial: 22. Best value: 0.384243:  93%|█████████▎| 93/100 [10:36<00:45,  6.46s/it]Best trial: 22. Best value: 0.384243:  94%|█████████▍| 94/100 [10:36<00:36,  6.08s/it]Best trial: 22. Best value: 0.384243:  94%|█████████▍| 94/100 [10:43<00:36,  6.08s/it]Best trial: 22. Best value: 0.384243:  95%|█████████▌| 95/100 [10:43<00:31,  6.39s/it]Best trial: 22. Best value: 0.384243:  95%|█████████▌| 95/100 [10:51<00:31,  6.39s/it]Best trial: 22. Best value: 0.384243:  96%|█████████▌| 96/100 [10:51<00:27,  6.78s/it]Best trial: 22. Best value: 0.384243:  96%|█████████▌| 96/100 [10:56<00:27,  6.78s/it]Best trial: 22. Best value: 0.384243:  97%|█████████▋| 97/100 [10:56<00:19,  6.46s/it]Best trial: 22. Best value: 0.384243:  97%|█████████▋| 97/100 [11:02<00:19,  6.46s/it]Best trial: 22. Best value: 0.384243:  98%|█████████▊| 98/100 [11:02<00:12,  6.20s/it]Best trial: 22. Best value: 0.384243:  98%|█████████▊| 98/100 [11:07<00:12,  6.20s/it]Best trial: 22. Best value: 0.384243:  99%|█████████▉| 99/100 [11:07<00:05,  5.76s/it]Best trial: 22. Best value: 0.384243:  99%|█████████▉| 99/100 [11:12<00:05,  5.76s/it]Best trial: 22. Best value: 0.384243: 100%|██████████| 100/100 [11:12<00:00,  5.70s/it]Best trial: 22. Best value: 0.384243: 100%|██████████| 100/100 [11:12<00:00,  6.73s/it]
2025-11-30 13:21:31,392 - INFO - HPO Complete. Best AUPRC: 0.3842
2025-11-30 13:21:31,393 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.00026135008981143437, 'max_depth': 3, 'subsample': 0.6038753885472854, 'colsample_bytree': 0.7861993186165337, 'gamma': 2.94619690710804, 'reg_lambda': 0.00027903566704392396, 'reg_alpha': 9.546948448698085e-07}
2025-11-30 13:21:31,394 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:21:33,659 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 13:21:33,660 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:21:33,892 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:21:33,977 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:21:34,009 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 13:21:34,009 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:21:34,009 - INFO - Training model...
2025-11-30 13:21:39,605 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:21:46,817 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:21:46,817 - INFO - AUROC: 0.7106 (0.4753 - 0.8739)
2025-11-30 13:21:46,817 - INFO - AUPRC: 0.1218 (0.0337 - 0.3120)
2025-11-30 13:21:46,817 - INFO - Brier Score: 0.1919 (0.1910 - 0.1934)
2025-11-30 13:21:46,817 - INFO - Accuracy: 0.9740 (0.9228 - 0.9890)
2025-11-30 13:21:46,817 - INFO - Precision: 0.2143 (0.0654 - 0.5667)
2025-11-30 13:21:46,818 - INFO - Sensitivity (Recall): 0.3000 (0.1495 - 0.6000)
2025-11-30 13:21:46,818 - INFO - F1-Score: 0.2500 (0.0945 - 0.4418)
2025-11-30 13:21:46,818 - INFO - Best Threshold: 0.5000 (0.4740 - 0.5200)
2025-11-30 13:21:46,818 - INFO - Specificity: 0.9839 (0.9315 - 0.9959)
2025-11-30 13:21:46,833 - INFO - Calculating SHAP values...
2025-11-30 13:21:47,898 - INFO - SHAP plots saved.
2025-11-30 13:21:47,900 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:21:49,289 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: ventilator_only
2025-11-30 13:21:49,289 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:21:49,486 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:21:49,524 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:21:49,532 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 13:21:49,532 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0403571:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.0403571:   1%|          | 1/100 [00:03<05:25,  3.29s/it]Best trial: 0. Best value: 0.0403571:   1%|          | 1/100 [00:06<05:25,  3.29s/it]Best trial: 0. Best value: 0.0403571:   2%|▏         | 2/100 [00:06<05:38,  3.45s/it]Best trial: 2. Best value: 0.0534375:   2%|▏         | 2/100 [00:10<05:38,  3.45s/it]Best trial: 2. Best value: 0.0534375:   3%|▎         | 3/100 [00:10<05:37,  3.48s/it]Best trial: 2. Best value: 0.0534375:   3%|▎         | 3/100 [00:13<05:37,  3.48s/it]Best trial: 2. Best value: 0.0534375:   4%|▍         | 4/100 [00:13<05:39,  3.54s/it]Best trial: 2. Best value: 0.0534375:   4%|▍         | 4/100 [00:17<05:39,  3.54s/it]Best trial: 2. Best value: 0.0534375:   5%|▌         | 5/100 [00:17<05:20,  3.37s/it]Best trial: 2. Best value: 0.0534375:   5%|▌         | 5/100 [00:19<05:20,  3.37s/it]Best trial: 2. Best value: 0.0534375:   6%|▌         | 6/100 [00:19<04:48,  3.07s/it]Best trial: 2. Best value: 0.0534375:   6%|▌         | 6/100 [00:22<04:48,  3.07s/it]Best trial: 2. Best value: 0.0534375:   7%|▋         | 7/100 [00:22<04:40,  3.02s/it]Best trial: 2. Best value: 0.0534375:   7%|▋         | 7/100 [00:26<04:40,  3.02s/it]Best trial: 2. Best value: 0.0534375:   8%|▊         | 8/100 [00:26<05:10,  3.38s/it]Best trial: 2. Best value: 0.0534375:   8%|▊         | 8/100 [00:31<05:10,  3.38s/it]Best trial: 2. Best value: 0.0534375:   9%|▉         | 9/100 [00:31<05:41,  3.75s/it]Best trial: 2. Best value: 0.0534375:   9%|▉         | 9/100 [00:33<05:41,  3.75s/it]Best trial: 2. Best value: 0.0534375:  10%|█         | 10/100 [00:33<05:04,  3.38s/it]Best trial: 2. Best value: 0.0534375:  10%|█         | 10/100 [00:36<05:04,  3.38s/it]Best trial: 2. Best value: 0.0534375:  11%|█         | 11/100 [00:36<04:51,  3.27s/it]Best trial: 2. Best value: 0.0534375:  11%|█         | 11/100 [00:40<04:51,  3.27s/it]Best trial: 2. Best value: 0.0534375:  12%|█▏        | 12/100 [00:40<04:51,  3.32s/it]Best trial: 2. Best value: 0.0534375:  12%|█▏        | 12/100 [00:43<04:51,  3.32s/it]Best trial: 2. Best value: 0.0534375:  13%|█▎        | 13/100 [00:43<04:45,  3.28s/it]Best trial: 2. Best value: 0.0534375:  13%|█▎        | 13/100 [00:46<04:45,  3.28s/it]Best trial: 2. Best value: 0.0534375:  14%|█▍        | 14/100 [00:46<04:49,  3.36s/it]Best trial: 2. Best value: 0.0534375:  14%|█▍        | 14/100 [00:50<04:49,  3.36s/it]Best trial: 2. Best value: 0.0534375:  15%|█▌        | 15/100 [00:50<04:39,  3.28s/it]Best trial: 2. Best value: 0.0534375:  15%|█▌        | 15/100 [00:52<04:39,  3.28s/it]Best trial: 2. Best value: 0.0534375:  16%|█▌        | 16/100 [00:52<04:17,  3.07s/it]Best trial: 2. Best value: 0.0534375:  16%|█▌        | 16/100 [00:55<04:17,  3.07s/it]Best trial: 2. Best value: 0.0534375:  17%|█▋        | 17/100 [00:55<04:08,  2.99s/it]Best trial: 17. Best value: 0.0637677:  17%|█▋        | 17/100 [00:57<04:08,  2.99s/it]Best trial: 17. Best value: 0.0637677:  18%|█▊        | 18/100 [00:57<03:48,  2.79s/it]Best trial: 17. Best value: 0.0637677:  18%|█▊        | 18/100 [01:00<03:48,  2.79s/it]Best trial: 17. Best value: 0.0637677:  19%|█▉        | 19/100 [01:00<03:40,  2.73s/it]Best trial: 17. Best value: 0.0637677:  19%|█▉        | 19/100 [01:03<03:40,  2.73s/it]Best trial: 17. Best value: 0.0637677:  20%|██        | 20/100 [01:03<03:39,  2.75s/it]Best trial: 17. Best value: 0.0637677:  20%|██        | 20/100 [01:06<03:39,  2.75s/it]Best trial: 17. Best value: 0.0637677:  21%|██        | 21/100 [01:06<03:40,  2.80s/it]Best trial: 17. Best value: 0.0637677:  21%|██        | 21/100 [01:09<03:40,  2.80s/it]Best trial: 17. Best value: 0.0637677:  22%|██▏       | 22/100 [01:09<03:42,  2.86s/it]Best trial: 17. Best value: 0.0637677:  22%|██▏       | 22/100 [01:11<03:42,  2.86s/it]Best trial: 17. Best value: 0.0637677:  23%|██▎       | 23/100 [01:11<03:34,  2.78s/it]Best trial: 23. Best value: 0.087395:  23%|██▎       | 23/100 [01:14<03:34,  2.78s/it] Best trial: 23. Best value: 0.087395:  24%|██▍       | 24/100 [01:14<03:23,  2.67s/it]Best trial: 23. Best value: 0.087395:  24%|██▍       | 24/100 [01:16<03:23,  2.67s/it]Best trial: 23. Best value: 0.087395:  25%|██▌       | 25/100 [01:16<03:25,  2.73s/it]Best trial: 23. Best value: 0.087395:  25%|██▌       | 25/100 [01:19<03:25,  2.73s/it]Best trial: 23. Best value: 0.087395:  26%|██▌       | 26/100 [01:19<03:28,  2.82s/it]Best trial: 23. Best value: 0.087395:  26%|██▌       | 26/100 [01:23<03:28,  2.82s/it]Best trial: 23. Best value: 0.087395:  27%|██▋       | 27/100 [01:23<03:35,  2.95s/it]Best trial: 27. Best value: 0.108943:  27%|██▋       | 27/100 [01:26<03:35,  2.95s/it]Best trial: 27. Best value: 0.108943:  28%|██▊       | 28/100 [01:26<03:40,  3.07s/it]Best trial: 27. Best value: 0.108943:  28%|██▊       | 28/100 [01:30<03:40,  3.07s/it]Best trial: 27. Best value: 0.108943:  29%|██▉       | 29/100 [01:30<03:46,  3.19s/it]Best trial: 27. Best value: 0.108943:  29%|██▉       | 29/100 [01:32<03:46,  3.19s/it]Best trial: 27. Best value: 0.108943:  30%|███       | 30/100 [01:32<03:35,  3.08s/it]Best trial: 27. Best value: 0.108943:  30%|███       | 30/100 [01:36<03:35,  3.08s/it]Best trial: 27. Best value: 0.108943:  31%|███       | 31/100 [01:36<03:40,  3.20s/it]Best trial: 27. Best value: 0.108943:  31%|███       | 31/100 [01:39<03:40,  3.20s/it]Best trial: 27. Best value: 0.108943:  32%|███▏      | 32/100 [01:39<03:28,  3.07s/it]Best trial: 27. Best value: 0.108943:  32%|███▏      | 32/100 [01:42<03:28,  3.07s/it]Best trial: 27. Best value: 0.108943:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]Best trial: 27. Best value: 0.108943:  33%|███▎      | 33/100 [01:45<03:27,  3.10s/it]Best trial: 27. Best value: 0.108943:  34%|███▍      | 34/100 [01:45<03:29,  3.18s/it]Best trial: 27. Best value: 0.108943:  34%|███▍      | 34/100 [01:48<03:29,  3.18s/it]Best trial: 27. Best value: 0.108943:  35%|███▌      | 35/100 [01:48<03:27,  3.19s/it]Best trial: 27. Best value: 0.108943:  35%|███▌      | 35/100 [01:52<03:27,  3.19s/it]Best trial: 27. Best value: 0.108943:  36%|███▌      | 36/100 [01:52<03:29,  3.28s/it]Best trial: 27. Best value: 0.108943:  36%|███▌      | 36/100 [01:55<03:29,  3.28s/it]Best trial: 27. Best value: 0.108943:  37%|███▋      | 37/100 [01:55<03:30,  3.34s/it]Best trial: 27. Best value: 0.108943:  37%|███▋      | 37/100 [01:58<03:30,  3.34s/it]Best trial: 27. Best value: 0.108943:  38%|███▊      | 38/100 [01:58<03:19,  3.22s/it]Best trial: 27. Best value: 0.108943:  38%|███▊      | 38/100 [02:03<03:19,  3.22s/it]Best trial: 27. Best value: 0.108943:  39%|███▉      | 39/100 [02:03<03:35,  3.54s/it]Best trial: 27. Best value: 0.108943:  39%|███▉      | 39/100 [02:06<03:35,  3.54s/it]Best trial: 27. Best value: 0.108943:  40%|████      | 40/100 [02:06<03:36,  3.61s/it]Best trial: 27. Best value: 0.108943:  40%|████      | 40/100 [02:10<03:36,  3.61s/it]Best trial: 27. Best value: 0.108943:  41%|████      | 41/100 [02:10<03:26,  3.50s/it]Best trial: 27. Best value: 0.108943:  41%|████      | 41/100 [02:14<03:26,  3.50s/it]Best trial: 27. Best value: 0.108943:  42%|████▏     | 42/100 [02:14<03:32,  3.66s/it]Best trial: 27. Best value: 0.108943:  42%|████▏     | 42/100 [02:18<03:32,  3.66s/it]Best trial: 27. Best value: 0.108943:  43%|████▎     | 43/100 [02:18<03:40,  3.86s/it]Best trial: 27. Best value: 0.108943:  43%|████▎     | 43/100 [02:21<03:40,  3.86s/it]Best trial: 27. Best value: 0.108943:  44%|████▍     | 44/100 [02:21<03:28,  3.73s/it]Best trial: 27. Best value: 0.108943:  44%|████▍     | 44/100 [02:25<03:28,  3.73s/it]Best trial: 27. Best value: 0.108943:  45%|████▌     | 45/100 [02:25<03:32,  3.86s/it]Best trial: 27. Best value: 0.108943:  45%|████▌     | 45/100 [02:29<03:32,  3.86s/it]Best trial: 27. Best value: 0.108943:  46%|████▌     | 46/100 [02:29<03:28,  3.86s/it]Best trial: 27. Best value: 0.108943:  46%|████▌     | 46/100 [02:33<03:28,  3.86s/it]Best trial: 27. Best value: 0.108943:  47%|████▋     | 47/100 [02:33<03:17,  3.73s/it]Best trial: 27. Best value: 0.108943:  47%|████▋     | 47/100 [02:36<03:17,  3.73s/it]Best trial: 27. Best value: 0.108943:  48%|████▊     | 48/100 [02:36<02:58,  3.43s/it]Best trial: 27. Best value: 0.108943:  48%|████▊     | 48/100 [02:39<02:58,  3.43s/it]Best trial: 27. Best value: 0.108943:  49%|████▉     | 49/100 [02:39<02:52,  3.38s/it]Best trial: 27. Best value: 0.108943:  49%|████▉     | 49/100 [02:42<02:52,  3.38s/it]Best trial: 27. Best value: 0.108943:  50%|█████     | 50/100 [02:42<02:39,  3.19s/it]Best trial: 27. Best value: 0.108943:  50%|█████     | 50/100 [02:44<02:39,  3.19s/it]Best trial: 27. Best value: 0.108943:  51%|█████     | 51/100 [02:44<02:33,  3.12s/it]Best trial: 27. Best value: 0.108943:  51%|█████     | 51/100 [02:48<02:33,  3.12s/it]Best trial: 27. Best value: 0.108943:  52%|█████▏    | 52/100 [02:48<02:35,  3.24s/it]Best trial: 27. Best value: 0.108943:  52%|█████▏    | 52/100 [02:52<02:35,  3.24s/it]Best trial: 27. Best value: 0.108943:  53%|█████▎    | 53/100 [02:52<02:37,  3.35s/it]Best trial: 27. Best value: 0.108943:  53%|█████▎    | 53/100 [02:55<02:37,  3.35s/it]Best trial: 27. Best value: 0.108943:  54%|█████▍    | 54/100 [02:55<02:31,  3.29s/it]Best trial: 27. Best value: 0.108943:  54%|█████▍    | 54/100 [02:58<02:31,  3.29s/it]Best trial: 27. Best value: 0.108943:  55%|█████▌    | 55/100 [02:58<02:32,  3.40s/it]Best trial: 27. Best value: 0.108943:  55%|█████▌    | 55/100 [03:01<02:32,  3.40s/it]Best trial: 27. Best value: 0.108943:  56%|█████▌    | 56/100 [03:01<02:23,  3.26s/it]Best trial: 27. Best value: 0.108943:  56%|█████▌    | 56/100 [03:05<02:23,  3.26s/it]Best trial: 27. Best value: 0.108943:  57%|█████▋    | 57/100 [03:05<02:18,  3.23s/it]Best trial: 27. Best value: 0.108943:  57%|█████▋    | 57/100 [03:09<02:18,  3.23s/it]Best trial: 27. Best value: 0.108943:  58%|█████▊    | 58/100 [03:09<02:30,  3.58s/it]Best trial: 27. Best value: 0.108943:  58%|█████▊    | 58/100 [03:11<02:30,  3.58s/it]Best trial: 27. Best value: 0.108943:  59%|█████▉    | 59/100 [03:11<02:14,  3.27s/it]Best trial: 27. Best value: 0.108943:  59%|█████▉    | 59/100 [03:14<02:14,  3.27s/it]Best trial: 27. Best value: 0.108943:  60%|██████    | 60/100 [03:14<02:03,  3.08s/it]Best trial: 27. Best value: 0.108943:  60%|██████    | 60/100 [03:17<02:03,  3.08s/it]Best trial: 27. Best value: 0.108943:  61%|██████    | 61/100 [03:17<01:58,  3.04s/it]Best trial: 27. Best value: 0.108943:  61%|██████    | 61/100 [03:20<01:58,  3.04s/it]Best trial: 27. Best value: 0.108943:  62%|██████▏   | 62/100 [03:20<01:54,  3.01s/it]Best trial: 27. Best value: 0.108943:  62%|██████▏   | 62/100 [03:24<01:54,  3.01s/it]Best trial: 27. Best value: 0.108943:  63%|██████▎   | 63/100 [03:24<02:00,  3.24s/it]Best trial: 27. Best value: 0.108943:  63%|██████▎   | 63/100 [03:28<02:00,  3.24s/it]Best trial: 27. Best value: 0.108943:  64%|██████▍   | 64/100 [03:28<02:08,  3.58s/it]Best trial: 27. Best value: 0.108943:  64%|██████▍   | 64/100 [03:31<02:08,  3.58s/it]Best trial: 27. Best value: 0.108943:  65%|██████▌   | 65/100 [03:31<01:58,  3.39s/it]Best trial: 27. Best value: 0.108943:  65%|██████▌   | 65/100 [03:34<01:58,  3.39s/it]Best trial: 27. Best value: 0.108943:  66%|██████▌   | 66/100 [03:34<01:48,  3.19s/it]Best trial: 27. Best value: 0.108943:  66%|██████▌   | 66/100 [03:37<01:48,  3.19s/it]Best trial: 27. Best value: 0.108943:  67%|██████▋   | 67/100 [03:37<01:47,  3.26s/it]Best trial: 27. Best value: 0.108943:  67%|██████▋   | 67/100 [03:40<01:47,  3.26s/it]Best trial: 27. Best value: 0.108943:  68%|██████▊   | 68/100 [03:40<01:43,  3.24s/it]Best trial: 27. Best value: 0.108943:  68%|██████▊   | 68/100 [03:45<01:43,  3.24s/it]Best trial: 27. Best value: 0.108943:  69%|██████▉   | 69/100 [03:45<01:50,  3.56s/it]Best trial: 27. Best value: 0.108943:  69%|██████▉   | 69/100 [03:47<01:50,  3.56s/it]Best trial: 27. Best value: 0.108943:  70%|███████   | 70/100 [03:47<01:38,  3.27s/it]Best trial: 27. Best value: 0.108943:  70%|███████   | 70/100 [03:50<01:38,  3.27s/it]Best trial: 27. Best value: 0.108943:  71%|███████   | 71/100 [03:50<01:25,  2.95s/it]Best trial: 27. Best value: 0.108943:  71%|███████   | 71/100 [03:53<01:25,  2.95s/it]Best trial: 27. Best value: 0.108943:  72%|███████▏  | 72/100 [03:53<01:23,  2.99s/it]Best trial: 27. Best value: 0.108943:  72%|███████▏  | 72/100 [03:55<01:23,  2.99s/it]Best trial: 27. Best value: 0.108943:  73%|███████▎  | 73/100 [03:55<01:12,  2.69s/it]Best trial: 27. Best value: 0.108943:  73%|███████▎  | 73/100 [03:57<01:12,  2.69s/it]Best trial: 27. Best value: 0.108943:  74%|███████▍  | 74/100 [03:57<01:08,  2.65s/it]Best trial: 27. Best value: 0.108943:  74%|███████▍  | 74/100 [04:00<01:08,  2.65s/it]Best trial: 27. Best value: 0.108943:  75%|███████▌  | 75/100 [04:00<01:09,  2.77s/it]Best trial: 27. Best value: 0.108943:  75%|███████▌  | 75/100 [04:03<01:09,  2.77s/it]Best trial: 27. Best value: 0.108943:  76%|███████▌  | 76/100 [04:03<01:06,  2.75s/it]Best trial: 76. Best value: 0.111125:  76%|███████▌  | 76/100 [04:05<01:06,  2.75s/it]Best trial: 76. Best value: 0.111125:  77%|███████▋  | 77/100 [04:05<00:58,  2.53s/it]Best trial: 76. Best value: 0.111125:  77%|███████▋  | 77/100 [04:07<00:58,  2.53s/it]Best trial: 76. Best value: 0.111125:  78%|███████▊  | 78/100 [04:07<00:51,  2.33s/it]Best trial: 76. Best value: 0.111125:  78%|███████▊  | 78/100 [04:09<00:51,  2.33s/it]Best trial: 76. Best value: 0.111125:  79%|███████▉  | 79/100 [04:09<00:48,  2.33s/it]Best trial: 76. Best value: 0.111125:  79%|███████▉  | 79/100 [04:11<00:48,  2.33s/it]Best trial: 76. Best value: 0.111125:  80%|████████  | 80/100 [04:11<00:44,  2.22s/it]Best trial: 76. Best value: 0.111125:  80%|████████  | 80/100 [04:13<00:44,  2.22s/it]Best trial: 76. Best value: 0.111125:  81%|████████  | 81/100 [04:13<00:40,  2.14s/it]Best trial: 76. Best value: 0.111125:  81%|████████  | 81/100 [04:15<00:40,  2.14s/it]Best trial: 76. Best value: 0.111125:  82%|████████▏ | 82/100 [04:15<00:39,  2.17s/it]Best trial: 76. Best value: 0.111125:  82%|████████▏ | 82/100 [04:17<00:39,  2.17s/it]Best trial: 76. Best value: 0.111125:  83%|████████▎ | 83/100 [04:17<00:36,  2.14s/it]Best trial: 76. Best value: 0.111125:  83%|████████▎ | 83/100 [04:20<00:36,  2.14s/it]Best trial: 76. Best value: 0.111125:  84%|████████▍ | 84/100 [04:20<00:35,  2.23s/it]Best trial: 76. Best value: 0.111125:  84%|████████▍ | 84/100 [04:23<00:35,  2.23s/it]Best trial: 76. Best value: 0.111125:  85%|████████▌ | 85/100 [04:23<00:39,  2.62s/it]Best trial: 76. Best value: 0.111125:  85%|████████▌ | 85/100 [04:26<00:39,  2.62s/it]Best trial: 76. Best value: 0.111125:  86%|████████▌ | 86/100 [04:26<00:38,  2.78s/it]Best trial: 76. Best value: 0.111125:  86%|████████▌ | 86/100 [04:30<00:38,  2.78s/it]Best trial: 76. Best value: 0.111125:  87%|████████▋ | 87/100 [04:30<00:39,  3.02s/it]Best trial: 76. Best value: 0.111125:  87%|████████▋ | 87/100 [04:35<00:39,  3.02s/it]Best trial: 76. Best value: 0.111125:  88%|████████▊ | 88/100 [04:35<00:44,  3.67s/it]Best trial: 76. Best value: 0.111125:  88%|████████▊ | 88/100 [04:39<00:44,  3.67s/it]Best trial: 76. Best value: 0.111125:  89%|████████▉ | 89/100 [04:39<00:39,  3.57s/it]Best trial: 76. Best value: 0.111125:  89%|████████▉ | 89/100 [04:42<00:39,  3.57s/it]Best trial: 76. Best value: 0.111125:  90%|█████████ | 90/100 [04:42<00:34,  3.42s/it]Best trial: 76. Best value: 0.111125:  90%|█████████ | 90/100 [04:46<00:34,  3.42s/it]Best trial: 76. Best value: 0.111125:  91%|█████████ | 91/100 [04:46<00:31,  3.55s/it]Best trial: 76. Best value: 0.111125:  91%|█████████ | 91/100 [04:49<00:31,  3.55s/it]Best trial: 76. Best value: 0.111125:  92%|█████████▏| 92/100 [04:49<00:27,  3.42s/it]Best trial: 76. Best value: 0.111125:  92%|█████████▏| 92/100 [04:52<00:27,  3.42s/it]Best trial: 76. Best value: 0.111125:  93%|█████████▎| 93/100 [04:52<00:24,  3.54s/it]Best trial: 76. Best value: 0.111125:  93%|█████████▎| 93/100 [04:56<00:24,  3.54s/it]Best trial: 76. Best value: 0.111125:  94%|█████████▍| 94/100 [04:56<00:21,  3.52s/it]Best trial: 76. Best value: 0.111125:  94%|█████████▍| 94/100 [05:00<00:21,  3.52s/it]Best trial: 76. Best value: 0.111125:  95%|█████████▌| 95/100 [05:00<00:18,  3.63s/it]Best trial: 76. Best value: 0.111125:  95%|█████████▌| 95/100 [05:03<00:18,  3.63s/it]Best trial: 76. Best value: 0.111125:  96%|█████████▌| 96/100 [05:03<00:13,  3.38s/it]Best trial: 76. Best value: 0.111125:  96%|█████████▌| 96/100 [05:06<00:13,  3.38s/it]Best trial: 76. Best value: 0.111125:  97%|█████████▋| 97/100 [05:06<00:09,  3.30s/it]Best trial: 76. Best value: 0.111125:  97%|█████████▋| 97/100 [05:09<00:09,  3.30s/it]Best trial: 76. Best value: 0.111125:  98%|█████████▊| 98/100 [05:09<00:06,  3.30s/it]Best trial: 76. Best value: 0.111125:  98%|█████████▊| 98/100 [05:13<00:06,  3.30s/it]Best trial: 76. Best value: 0.111125:  99%|█████████▉| 99/100 [05:13<00:03,  3.58s/it]Best trial: 76. Best value: 0.111125:  99%|█████████▉| 99/100 [05:20<00:03,  3.58s/it]Best trial: 76. Best value: 0.111125: 100%|██████████| 100/100 [05:20<00:00,  4.39s/it]Best trial: 76. Best value: 0.111125: 100%|██████████| 100/100 [05:20<00:00,  3.20s/it]
2025-11-30 13:27:09,552 - INFO - HPO Complete. Best AUPRC: 0.1111
2025-11-30 13:27:09,553 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.09789425036356737, 'max_depth': 3, 'subsample': 0.6417508205754073, 'colsample_bytree': 0.9046021631408256, 'gamma': 0.07696692093884405, 'reg_lambda': 0.01503077226598574, 'reg_alpha': 1.31069472756314e-07}
2025-11-30 13:27:09,554 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:27:11,493 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: ventilator_only
2025-11-30 13:27:11,493 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:27:11,688 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:27:11,725 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:27:11,732 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 13:27:11,732 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:27:11,732 - INFO - Training model...
2025-11-30 13:27:13,968 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:27:19,480 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:27:19,481 - INFO - AUROC: 0.6261 (0.4236 - 0.8182)
2025-11-30 13:27:19,481 - INFO - AUPRC: 0.0280 (0.0151 - 0.0661)
2025-11-30 13:27:19,481 - INFO - Brier Score: 0.0152 (0.0097 - 0.0276)
2025-11-30 13:27:19,481 - INFO - Accuracy: 0.9393 (0.9168 - 0.9546)
2025-11-30 13:27:19,481 - INFO - Precision: 0.0294 (0.0000 - 0.0816)
2025-11-30 13:27:19,481 - INFO - Sensitivity (Recall): 0.1000 (0.0000 - 0.2533)
2025-11-30 13:27:19,481 - INFO - F1-Score: 0.0455 (0.0000 - 0.1144)
2025-11-30 13:27:19,481 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0100)
2025-11-30 13:27:19,481 - INFO - Specificity: 0.9516 (0.9342 - 0.9670)
2025-11-30 13:27:19,492 - INFO - Calculating SHAP values...
2025-11-30 13:27:20,585 - INFO - SHAP plots saved.
2025-11-30 13:27:20,586 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:27:21,761 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: monitors_only
2025-11-30 13:27:21,761 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:27:21,956 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:27:21,992 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:27:22,000 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 13:27:22,000 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.100401:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.100401:   1%|          | 1/100 [00:03<04:59,  3.02s/it]Best trial: 1. Best value: 0.10246:   1%|          | 1/100 [00:06<04:59,  3.02s/it] Best trial: 1. Best value: 0.10246:   2%|▏         | 2/100 [00:06<05:18,  3.25s/it]Best trial: 2. Best value: 0.120747:   2%|▏         | 2/100 [00:09<05:18,  3.25s/it]Best trial: 2. Best value: 0.120747:   3%|▎         | 3/100 [00:09<04:50,  2.99s/it]Best trial: 2. Best value: 0.120747:   3%|▎         | 3/100 [00:12<04:50,  2.99s/it]Best trial: 2. Best value: 0.120747:   4%|▍         | 4/100 [00:12<04:51,  3.04s/it]Best trial: 2. Best value: 0.120747:   4%|▍         | 4/100 [00:16<04:51,  3.04s/it]Best trial: 2. Best value: 0.120747:   5%|▌         | 5/100 [00:16<05:33,  3.51s/it]Best trial: 2. Best value: 0.120747:   5%|▌         | 5/100 [00:20<05:33,  3.51s/it]Best trial: 2. Best value: 0.120747:   6%|▌         | 6/100 [00:20<05:57,  3.80s/it]Best trial: 2. Best value: 0.120747:   6%|▌         | 6/100 [00:24<05:57,  3.80s/it]Best trial: 2. Best value: 0.120747:   7%|▋         | 7/100 [00:24<05:56,  3.83s/it]Best trial: 2. Best value: 0.120747:   7%|▋         | 7/100 [00:29<05:56,  3.83s/it]Best trial: 2. Best value: 0.120747:   8%|▊         | 8/100 [00:29<06:08,  4.00s/it]Best trial: 2. Best value: 0.120747:   8%|▊         | 8/100 [00:32<06:08,  4.00s/it]Best trial: 2. Best value: 0.120747:   9%|▉         | 9/100 [00:32<05:42,  3.76s/it]Best trial: 2. Best value: 0.120747:   9%|▉         | 9/100 [00:36<05:42,  3.76s/it]Best trial: 2. Best value: 0.120747:  10%|█         | 10/100 [00:36<05:33,  3.71s/it]Best trial: 2. Best value: 0.120747:  10%|█         | 10/100 [00:40<05:33,  3.71s/it]Best trial: 2. Best value: 0.120747:  11%|█         | 11/100 [00:40<05:49,  3.93s/it]Best trial: 2. Best value: 0.120747:  11%|█         | 11/100 [00:43<05:49,  3.93s/it]Best trial: 2. Best value: 0.120747:  12%|█▏        | 12/100 [00:43<05:28,  3.74s/it]Best trial: 2. Best value: 0.120747:  12%|█▏        | 12/100 [00:47<05:28,  3.74s/it]Best trial: 2. Best value: 0.120747:  13%|█▎        | 13/100 [00:47<05:30,  3.80s/it]Best trial: 2. Best value: 0.120747:  13%|█▎        | 13/100 [00:51<05:30,  3.80s/it]Best trial: 2. Best value: 0.120747:  14%|█▍        | 14/100 [00:51<05:26,  3.80s/it]Best trial: 2. Best value: 0.120747:  14%|█▍        | 14/100 [00:54<05:26,  3.80s/it]Best trial: 2. Best value: 0.120747:  15%|█▌        | 15/100 [00:54<05:00,  3.54s/it]Best trial: 2. Best value: 0.120747:  15%|█▌        | 15/100 [00:57<05:00,  3.54s/it]Best trial: 2. Best value: 0.120747:  16%|█▌        | 16/100 [00:57<04:33,  3.25s/it]Best trial: 2. Best value: 0.120747:  16%|█▌        | 16/100 [00:59<04:33,  3.25s/it]Best trial: 2. Best value: 0.120747:  17%|█▋        | 17/100 [00:59<04:16,  3.09s/it]Best trial: 2. Best value: 0.120747:  17%|█▋        | 17/100 [01:03<04:16,  3.09s/it]Best trial: 2. Best value: 0.120747:  18%|█▊        | 18/100 [01:03<04:23,  3.21s/it]Best trial: 18. Best value: 0.14195:  18%|█▊        | 18/100 [01:05<04:23,  3.21s/it]Best trial: 18. Best value: 0.14195:  19%|█▉        | 19/100 [01:05<04:07,  3.06s/it]Best trial: 18. Best value: 0.14195:  19%|█▉        | 19/100 [01:09<04:07,  3.06s/it]Best trial: 18. Best value: 0.14195:  20%|██        | 20/100 [01:09<04:13,  3.17s/it]Best trial: 18. Best value: 0.14195:  20%|██        | 20/100 [01:12<04:13,  3.17s/it]Best trial: 18. Best value: 0.14195:  21%|██        | 21/100 [01:12<04:06,  3.12s/it]Best trial: 18. Best value: 0.14195:  21%|██        | 21/100 [01:14<04:06,  3.12s/it]Best trial: 18. Best value: 0.14195:  22%|██▏       | 22/100 [01:14<03:49,  2.95s/it]Best trial: 18. Best value: 0.14195:  22%|██▏       | 22/100 [01:17<03:49,  2.95s/it]Best trial: 18. Best value: 0.14195:  23%|██▎       | 23/100 [01:17<03:37,  2.83s/it]Best trial: 23. Best value: 0.172778:  23%|██▎       | 23/100 [01:19<03:37,  2.83s/it]Best trial: 23. Best value: 0.172778:  24%|██▍       | 24/100 [01:19<03:24,  2.68s/it]Best trial: 23. Best value: 0.172778:  24%|██▍       | 24/100 [01:22<03:24,  2.68s/it]Best trial: 23. Best value: 0.172778:  25%|██▌       | 25/100 [01:22<03:29,  2.79s/it]Best trial: 23. Best value: 0.172778:  25%|██▌       | 25/100 [01:26<03:29,  2.79s/it]Best trial: 23. Best value: 0.172778:  26%|██▌       | 26/100 [01:26<03:47,  3.07s/it]Best trial: 23. Best value: 0.172778:  26%|██▌       | 26/100 [01:28<03:47,  3.07s/it]Best trial: 23. Best value: 0.172778:  27%|██▋       | 27/100 [01:28<03:25,  2.81s/it]Best trial: 23. Best value: 0.172778:  27%|██▋       | 27/100 [01:31<03:25,  2.81s/it]Best trial: 23. Best value: 0.172778:  28%|██▊       | 28/100 [01:31<03:21,  2.80s/it]Best trial: 23. Best value: 0.172778:  28%|██▊       | 28/100 [01:33<03:21,  2.80s/it]Best trial: 23. Best value: 0.172778:  29%|██▉       | 29/100 [01:33<03:08,  2.66s/it]Best trial: 23. Best value: 0.172778:  29%|██▉       | 29/100 [01:36<03:08,  2.66s/it]Best trial: 23. Best value: 0.172778:  30%|███       | 30/100 [01:36<03:10,  2.72s/it]Best trial: 23. Best value: 0.172778:  30%|███       | 30/100 [01:39<03:10,  2.72s/it]Best trial: 23. Best value: 0.172778:  31%|███       | 31/100 [01:39<03:04,  2.68s/it]Best trial: 23. Best value: 0.172778:  31%|███       | 31/100 [01:41<03:04,  2.68s/it]Best trial: 23. Best value: 0.172778:  32%|███▏      | 32/100 [01:41<02:57,  2.61s/it]Best trial: 23. Best value: 0.172778:  32%|███▏      | 32/100 [01:44<02:57,  2.61s/it]Best trial: 23. Best value: 0.172778:  33%|███▎      | 33/100 [01:44<02:54,  2.61s/it]Best trial: 23. Best value: 0.172778:  33%|███▎      | 33/100 [01:47<02:54,  2.61s/it]Best trial: 23. Best value: 0.172778:  34%|███▍      | 34/100 [01:47<03:00,  2.74s/it]Best trial: 23. Best value: 0.172778:  34%|███▍      | 34/100 [01:50<03:00,  2.74s/it]Best trial: 23. Best value: 0.172778:  35%|███▌      | 35/100 [01:50<02:56,  2.72s/it]Best trial: 23. Best value: 0.172778:  35%|███▌      | 35/100 [01:53<02:56,  2.72s/it]Best trial: 23. Best value: 0.172778:  36%|███▌      | 36/100 [01:53<03:02,  2.85s/it]Best trial: 23. Best value: 0.172778:  36%|███▌      | 36/100 [01:55<03:02,  2.85s/it]Best trial: 23. Best value: 0.172778:  37%|███▋      | 37/100 [01:55<02:53,  2.76s/it]Best trial: 23. Best value: 0.172778:  37%|███▋      | 37/100 [01:57<02:53,  2.76s/it]Best trial: 23. Best value: 0.172778:  38%|███▊      | 38/100 [01:57<02:38,  2.55s/it]Best trial: 23. Best value: 0.172778:  38%|███▊      | 38/100 [02:04<02:38,  2.55s/it]Best trial: 23. Best value: 0.172778:  39%|███▉      | 39/100 [02:04<03:57,  3.89s/it]Best trial: 23. Best value: 0.172778:  39%|███▉      | 39/100 [02:08<03:57,  3.89s/it]Best trial: 23. Best value: 0.172778:  40%|████      | 40/100 [02:08<03:48,  3.81s/it]Best trial: 23. Best value: 0.172778:  40%|████      | 40/100 [02:11<03:48,  3.81s/it]Best trial: 23. Best value: 0.172778:  41%|████      | 41/100 [02:11<03:27,  3.52s/it]Best trial: 23. Best value: 0.172778:  41%|████      | 41/100 [02:13<03:27,  3.52s/it]Best trial: 23. Best value: 0.172778:  42%|████▏     | 42/100 [02:13<03:07,  3.23s/it]Best trial: 23. Best value: 0.172778:  42%|████▏     | 42/100 [02:16<03:07,  3.23s/it]Best trial: 23. Best value: 0.172778:  43%|████▎     | 43/100 [02:16<02:55,  3.09s/it]Best trial: 23. Best value: 0.172778:  43%|████▎     | 43/100 [02:19<02:55,  3.09s/it]Best trial: 23. Best value: 0.172778:  44%|████▍     | 44/100 [02:19<02:43,  2.92s/it]Best trial: 23. Best value: 0.172778:  44%|████▍     | 44/100 [02:21<02:43,  2.92s/it]Best trial: 23. Best value: 0.172778:  45%|████▌     | 45/100 [02:21<02:37,  2.86s/it]Best trial: 23. Best value: 0.172778:  45%|████▌     | 45/100 [02:24<02:37,  2.86s/it]Best trial: 23. Best value: 0.172778:  46%|████▌     | 46/100 [02:24<02:33,  2.84s/it]Best trial: 23. Best value: 0.172778:  46%|████▌     | 46/100 [02:26<02:33,  2.84s/it]Best trial: 23. Best value: 0.172778:  47%|████▋     | 47/100 [02:26<02:20,  2.65s/it]Best trial: 23. Best value: 0.172778:  47%|████▋     | 47/100 [02:29<02:20,  2.65s/it]Best trial: 23. Best value: 0.172778:  48%|████▊     | 48/100 [02:29<02:12,  2.54s/it]Best trial: 23. Best value: 0.172778:  48%|████▊     | 48/100 [02:32<02:12,  2.54s/it]Best trial: 23. Best value: 0.172778:  49%|████▉     | 49/100 [02:32<02:15,  2.66s/it]Best trial: 23. Best value: 0.172778:  49%|████▉     | 49/100 [02:36<02:15,  2.66s/it]Best trial: 23. Best value: 0.172778:  50%|█████     | 50/100 [02:36<02:42,  3.24s/it]Best trial: 23. Best value: 0.172778:  50%|█████     | 50/100 [02:40<02:42,  3.24s/it]Best trial: 23. Best value: 0.172778:  51%|█████     | 51/100 [02:40<02:45,  3.37s/it]Best trial: 23. Best value: 0.172778:  51%|█████     | 51/100 [02:43<02:45,  3.37s/it]Best trial: 23. Best value: 0.172778:  52%|█████▏    | 52/100 [02:43<02:40,  3.34s/it]Best trial: 23. Best value: 0.172778:  52%|█████▏    | 52/100 [02:47<02:40,  3.34s/it]Best trial: 23. Best value: 0.172778:  53%|█████▎    | 53/100 [02:47<02:37,  3.36s/it]Best trial: 23. Best value: 0.172778:  53%|█████▎    | 53/100 [02:50<02:37,  3.36s/it]Best trial: 23. Best value: 0.172778:  54%|█████▍    | 54/100 [02:50<02:34,  3.37s/it]Best trial: 23. Best value: 0.172778:  54%|█████▍    | 54/100 [02:54<02:34,  3.37s/it]Best trial: 23. Best value: 0.172778:  55%|█████▌    | 55/100 [02:54<02:35,  3.46s/it]Best trial: 23. Best value: 0.172778:  55%|█████▌    | 55/100 [02:58<02:35,  3.46s/it]Best trial: 23. Best value: 0.172778:  56%|█████▌    | 56/100 [02:58<02:48,  3.83s/it]Best trial: 23. Best value: 0.172778:  56%|█████▌    | 56/100 [03:01<02:48,  3.83s/it]Best trial: 23. Best value: 0.172778:  57%|█████▋    | 57/100 [03:01<02:30,  3.49s/it]Best trial: 23. Best value: 0.172778:  57%|█████▋    | 57/100 [03:06<02:30,  3.49s/it]Best trial: 23. Best value: 0.172778:  58%|█████▊    | 58/100 [03:06<02:41,  3.84s/it]Best trial: 23. Best value: 0.172778:  58%|█████▊    | 58/100 [03:09<02:41,  3.84s/it]Best trial: 23. Best value: 0.172778:  59%|█████▉    | 59/100 [03:09<02:26,  3.57s/it]Best trial: 23. Best value: 0.172778:  59%|█████▉    | 59/100 [03:13<02:26,  3.57s/it]Best trial: 23. Best value: 0.172778:  60%|██████    | 60/100 [03:13<02:27,  3.68s/it]Best trial: 23. Best value: 0.172778:  60%|██████    | 60/100 [03:16<02:27,  3.68s/it]Best trial: 23. Best value: 0.172778:  61%|██████    | 61/100 [03:16<02:18,  3.55s/it]Best trial: 23. Best value: 0.172778:  61%|██████    | 61/100 [03:20<02:18,  3.55s/it]Best trial: 23. Best value: 0.172778:  62%|██████▏   | 62/100 [03:20<02:23,  3.78s/it]Best trial: 23. Best value: 0.172778:  62%|██████▏   | 62/100 [03:24<02:23,  3.78s/it]Best trial: 23. Best value: 0.172778:  63%|██████▎   | 63/100 [03:24<02:21,  3.84s/it]Best trial: 23. Best value: 0.172778:  63%|██████▎   | 63/100 [03:27<02:21,  3.84s/it]Best trial: 23. Best value: 0.172778:  64%|██████▍   | 64/100 [03:27<02:06,  3.51s/it]Best trial: 23. Best value: 0.172778:  64%|██████▍   | 64/100 [03:29<02:06,  3.51s/it]Best trial: 23. Best value: 0.172778:  65%|██████▌   | 65/100 [03:29<01:52,  3.21s/it]Best trial: 23. Best value: 0.172778:  65%|██████▌   | 65/100 [03:33<01:52,  3.21s/it]Best trial: 23. Best value: 0.172778:  66%|██████▌   | 66/100 [03:33<01:52,  3.31s/it]Best trial: 23. Best value: 0.172778:  66%|██████▌   | 66/100 [03:36<01:52,  3.31s/it]Best trial: 23. Best value: 0.172778:  67%|██████▋   | 67/100 [03:36<01:45,  3.18s/it]Best trial: 23. Best value: 0.172778:  67%|██████▋   | 67/100 [03:39<01:45,  3.18s/it]Best trial: 23. Best value: 0.172778:  68%|██████▊   | 68/100 [03:39<01:41,  3.18s/it]Best trial: 23. Best value: 0.172778:  68%|██████▊   | 68/100 [03:42<01:41,  3.18s/it]Best trial: 23. Best value: 0.172778:  69%|██████▉   | 69/100 [03:42<01:33,  3.02s/it]Best trial: 23. Best value: 0.172778:  69%|██████▉   | 69/100 [03:45<01:33,  3.02s/it]Best trial: 23. Best value: 0.172778:  70%|███████   | 70/100 [03:45<01:32,  3.08s/it]Best trial: 23. Best value: 0.172778:  70%|███████   | 70/100 [03:48<01:32,  3.08s/it]Best trial: 23. Best value: 0.172778:  71%|███████   | 71/100 [03:48<01:30,  3.14s/it]Best trial: 23. Best value: 0.172778:  71%|███████   | 71/100 [03:51<01:30,  3.14s/it]Best trial: 23. Best value: 0.172778:  72%|███████▏  | 72/100 [03:51<01:22,  2.94s/it]Best trial: 23. Best value: 0.172778:  72%|███████▏  | 72/100 [03:54<01:22,  2.94s/it]Best trial: 23. Best value: 0.172778:  73%|███████▎  | 73/100 [03:54<01:21,  3.03s/it]Best trial: 23. Best value: 0.172778:  73%|███████▎  | 73/100 [03:56<01:21,  3.03s/it]Best trial: 23. Best value: 0.172778:  74%|███████▍  | 74/100 [03:56<01:15,  2.92s/it]Best trial: 23. Best value: 0.172778:  74%|███████▍  | 74/100 [04:00<01:15,  2.92s/it]Best trial: 23. Best value: 0.172778:  75%|███████▌  | 75/100 [04:00<01:16,  3.05s/it]Best trial: 23. Best value: 0.172778:  75%|███████▌  | 75/100 [04:03<01:16,  3.05s/it]Best trial: 23. Best value: 0.172778:  76%|███████▌  | 76/100 [04:03<01:16,  3.21s/it]Best trial: 23. Best value: 0.172778:  76%|███████▌  | 76/100 [04:06<01:16,  3.21s/it]Best trial: 23. Best value: 0.172778:  77%|███████▋  | 77/100 [04:06<01:10,  3.05s/it]Best trial: 23. Best value: 0.172778:  77%|███████▋  | 77/100 [04:09<01:10,  3.05s/it]Best trial: 23. Best value: 0.172778:  78%|███████▊  | 78/100 [04:09<01:05,  2.98s/it]Best trial: 23. Best value: 0.172778:  78%|███████▊  | 78/100 [04:12<01:05,  2.98s/it]Best trial: 23. Best value: 0.172778:  79%|███████▉  | 79/100 [04:12<01:02,  2.99s/it]Best trial: 23. Best value: 0.172778:  79%|███████▉  | 79/100 [04:15<01:02,  2.99s/it]Best trial: 23. Best value: 0.172778:  80%|████████  | 80/100 [04:15<01:03,  3.16s/it]Best trial: 23. Best value: 0.172778:  80%|████████  | 80/100 [04:18<01:03,  3.16s/it]Best trial: 23. Best value: 0.172778:  81%|████████  | 81/100 [04:18<00:57,  3.04s/it]Best trial: 23. Best value: 0.172778:  81%|████████  | 81/100 [04:21<00:57,  3.04s/it]Best trial: 23. Best value: 0.172778:  82%|████████▏ | 82/100 [04:21<00:52,  2.90s/it]Best trial: 23. Best value: 0.172778:  82%|████████▏ | 82/100 [04:25<00:52,  2.90s/it]Best trial: 23. Best value: 0.172778:  83%|████████▎ | 83/100 [04:25<00:55,  3.28s/it]Best trial: 23. Best value: 0.172778:  83%|████████▎ | 83/100 [04:27<00:55,  3.28s/it]Best trial: 23. Best value: 0.172778:  84%|████████▍ | 84/100 [04:27<00:48,  3.04s/it]Best trial: 23. Best value: 0.172778:  84%|████████▍ | 84/100 [04:31<00:48,  3.04s/it]Best trial: 23. Best value: 0.172778:  85%|████████▌ | 85/100 [04:31<00:46,  3.12s/it]Best trial: 23. Best value: 0.172778:  85%|████████▌ | 85/100 [04:35<00:46,  3.12s/it]Best trial: 23. Best value: 0.172778:  86%|████████▌ | 86/100 [04:35<00:49,  3.53s/it]Best trial: 23. Best value: 0.172778:  86%|████████▌ | 86/100 [04:39<00:49,  3.53s/it]Best trial: 23. Best value: 0.172778:  87%|████████▋ | 87/100 [04:39<00:46,  3.54s/it]Best trial: 23. Best value: 0.172778:  87%|████████▋ | 87/100 [04:42<00:46,  3.54s/it]Best trial: 23. Best value: 0.172778:  88%|████████▊ | 88/100 [04:42<00:39,  3.30s/it]Best trial: 23. Best value: 0.172778:  88%|████████▊ | 88/100 [04:45<00:39,  3.30s/it]Best trial: 23. Best value: 0.172778:  89%|████████▉ | 89/100 [04:45<00:37,  3.37s/it]Best trial: 23. Best value: 0.172778:  89%|████████▉ | 89/100 [04:49<00:37,  3.37s/it]Best trial: 23. Best value: 0.172778:  90%|█████████ | 90/100 [04:49<00:34,  3.43s/it]Best trial: 23. Best value: 0.172778:  90%|█████████ | 90/100 [04:52<00:34,  3.43s/it]Best trial: 23. Best value: 0.172778:  91%|█████████ | 91/100 [04:52<00:30,  3.44s/it]Best trial: 23. Best value: 0.172778:  91%|█████████ | 91/100 [04:55<00:30,  3.44s/it]Best trial: 23. Best value: 0.172778:  92%|█████████▏| 92/100 [04:55<00:26,  3.34s/it]Best trial: 23. Best value: 0.172778:  92%|█████████▏| 92/100 [04:58<00:26,  3.34s/it]Best trial: 23. Best value: 0.172778:  93%|█████████▎| 93/100 [04:58<00:22,  3.19s/it]Best trial: 23. Best value: 0.172778:  93%|█████████▎| 93/100 [05:01<00:22,  3.19s/it]Best trial: 23. Best value: 0.172778:  94%|█████████▍| 94/100 [05:01<00:18,  3.07s/it]Best trial: 23. Best value: 0.172778:  94%|█████████▍| 94/100 [05:04<00:18,  3.07s/it]Best trial: 23. Best value: 0.172778:  95%|█████████▌| 95/100 [05:04<00:15,  3.01s/it]Best trial: 23. Best value: 0.172778:  95%|█████████▌| 95/100 [05:06<00:15,  3.01s/it]Best trial: 23. Best value: 0.172778:  96%|█████████▌| 96/100 [05:06<00:11,  2.81s/it]Best trial: 23. Best value: 0.172778:  96%|█████████▌| 96/100 [05:10<00:11,  2.81s/it]Best trial: 23. Best value: 0.172778:  97%|█████████▋| 97/100 [05:10<00:09,  3.09s/it]Best trial: 23. Best value: 0.172778:  97%|█████████▋| 97/100 [05:15<00:09,  3.09s/it]Best trial: 23. Best value: 0.172778:  98%|█████████▊| 98/100 [05:15<00:07,  3.57s/it]Best trial: 23. Best value: 0.172778:  98%|█████████▊| 98/100 [05:18<00:07,  3.57s/it]Best trial: 23. Best value: 0.172778:  99%|█████████▉| 99/100 [05:18<00:03,  3.46s/it]Best trial: 23. Best value: 0.172778:  99%|█████████▉| 99/100 [05:20<00:03,  3.46s/it]Best trial: 23. Best value: 0.172778: 100%|██████████| 100/100 [05:20<00:00,  3.25s/it]Best trial: 23. Best value: 0.172778: 100%|██████████| 100/100 [05:20<00:00,  3.21s/it]
2025-11-30 13:32:42,981 - INFO - HPO Complete. Best AUPRC: 0.1728
2025-11-30 13:32:42,981 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.00505132761210868, 'max_depth': 3, 'subsample': 0.6803546774323196, 'colsample_bytree': 0.6429353136261725, 'gamma': 4.471457076700188, 'reg_lambda': 0.07367979321717774, 'reg_alpha': 3.95410233792104e-07}
2025-11-30 13:32:42,983 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:32:44,934 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: monitors_only
2025-11-30 13:32:44,934 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:32:45,134 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:32:45,172 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:32:45,179 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 13:32:45,179 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:32:45,180 - INFO - Training model...
2025-11-30 13:32:47,308 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:32:52,720 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:32:52,721 - INFO - AUROC: 0.6629 (0.5352 - 0.7446)
2025-11-30 13:32:52,721 - INFO - AUPRC: 0.0247 (0.0169 - 0.0469)
2025-11-30 13:32:52,721 - INFO - Brier Score: 0.0483 (0.0426 - 0.0568)
2025-11-30 13:32:52,721 - INFO - Accuracy: 0.6763 (0.4277 - 0.9347)
2025-11-30 13:32:52,721 - INFO - Precision: 0.0307 (0.0188 - 0.0678)
2025-11-30 13:32:52,721 - INFO - Sensitivity (Recall): 0.7000 (0.1667 - 1.0000)
2025-11-30 13:32:52,721 - INFO - F1-Score: 0.0588 (0.0368 - 0.1126)
2025-11-30 13:32:52,721 - INFO - Best Threshold: 0.1800 (0.1100 - 0.3600)
2025-11-30 13:32:52,721 - INFO - Specificity: 0.6760 (0.4206 - 0.9482)
2025-11-30 13:32:52,733 - INFO - Calculating SHAP values...
2025-11-30 13:32:53,853 - INFO - SHAP plots saved.
2025-11-30 13:32:53,853 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:32:55,034 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 13:32:55,034 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:32:55,229 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:32:55,264 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:32:55,272 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:32:55,273 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.191197:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.191197:   1%|          | 1/100 [00:03<04:59,  3.03s/it]Best trial: 1. Best value: 0.335452:   1%|          | 1/100 [00:06<04:59,  3.03s/it]Best trial: 1. Best value: 0.335452:   2%|▏         | 2/100 [00:06<05:26,  3.33s/it]Best trial: 1. Best value: 0.335452:   2%|▏         | 2/100 [00:09<05:26,  3.33s/it]Best trial: 1. Best value: 0.335452:   3%|▎         | 3/100 [00:09<05:17,  3.27s/it]Best trial: 1. Best value: 0.335452:   3%|▎         | 3/100 [00:12<05:17,  3.27s/it]Best trial: 1. Best value: 0.335452:   4%|▍         | 4/100 [00:12<05:01,  3.15s/it]Best trial: 1. Best value: 0.335452:   4%|▍         | 4/100 [00:17<05:01,  3.15s/it]Best trial: 1. Best value: 0.335452:   5%|▌         | 5/100 [00:17<05:49,  3.68s/it]Best trial: 5. Best value: 0.365573:   5%|▌         | 5/100 [00:19<05:49,  3.68s/it]Best trial: 5. Best value: 0.365573:   6%|▌         | 6/100 [00:19<05:10,  3.30s/it]Best trial: 5. Best value: 0.365573:   6%|▌         | 6/100 [00:22<05:10,  3.30s/it]Best trial: 5. Best value: 0.365573:   7%|▋         | 7/100 [00:22<04:37,  2.99s/it]Best trial: 5. Best value: 0.365573:   7%|▋         | 7/100 [00:25<04:37,  2.99s/it]Best trial: 5. Best value: 0.365573:   8%|▊         | 8/100 [00:25<04:27,  2.91s/it]Best trial: 5. Best value: 0.365573:   8%|▊         | 8/100 [00:27<04:27,  2.91s/it]Best trial: 5. Best value: 0.365573:   9%|▉         | 9/100 [00:27<04:22,  2.88s/it]Best trial: 5. Best value: 0.365573:   9%|▉         | 9/100 [00:31<04:22,  2.88s/it]Best trial: 5. Best value: 0.365573:  10%|█         | 10/100 [00:31<04:48,  3.21s/it]Best trial: 5. Best value: 0.365573:  10%|█         | 10/100 [00:34<04:48,  3.21s/it]Best trial: 5. Best value: 0.365573:  11%|█         | 11/100 [00:34<04:25,  2.99s/it]Best trial: 5. Best value: 0.365573:  11%|█         | 11/100 [00:37<04:25,  2.99s/it]Best trial: 5. Best value: 0.365573:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]Best trial: 5. Best value: 0.365573:  12%|█▏        | 12/100 [00:40<04:35,  3.13s/it]Best trial: 5. Best value: 0.365573:  13%|█▎        | 13/100 [00:40<04:34,  3.16s/it]Best trial: 5. Best value: 0.365573:  13%|█▎        | 13/100 [00:43<04:34,  3.16s/it]Best trial: 5. Best value: 0.365573:  14%|█▍        | 14/100 [00:43<04:27,  3.12s/it]Best trial: 5. Best value: 0.365573:  14%|█▍        | 14/100 [00:47<04:27,  3.12s/it]Best trial: 5. Best value: 0.365573:  15%|█▌        | 15/100 [00:47<04:34,  3.23s/it]Best trial: 5. Best value: 0.365573:  15%|█▌        | 15/100 [00:51<04:34,  3.23s/it]Best trial: 5. Best value: 0.365573:  16%|█▌        | 16/100 [00:51<04:43,  3.37s/it]Best trial: 5. Best value: 0.365573:  16%|█▌        | 16/100 [00:54<04:43,  3.37s/it]Best trial: 5. Best value: 0.365573:  17%|█▋        | 17/100 [00:54<04:40,  3.38s/it]Best trial: 5. Best value: 0.365573:  17%|█▋        | 17/100 [00:58<04:40,  3.38s/it]Best trial: 5. Best value: 0.365573:  18%|█▊        | 18/100 [00:58<04:41,  3.44s/it]Best trial: 5. Best value: 0.365573:  18%|█▊        | 18/100 [01:00<04:41,  3.44s/it]Best trial: 5. Best value: 0.365573:  19%|█▉        | 19/100 [01:00<04:23,  3.26s/it]Best trial: 19. Best value: 0.389659:  19%|█▉        | 19/100 [01:03<04:23,  3.26s/it]Best trial: 19. Best value: 0.389659:  20%|██        | 20/100 [01:03<04:06,  3.08s/it]Best trial: 19. Best value: 0.389659:  20%|██        | 20/100 [01:06<04:06,  3.08s/it]Best trial: 19. Best value: 0.389659:  21%|██        | 21/100 [01:06<04:00,  3.05s/it]Best trial: 19. Best value: 0.389659:  21%|██        | 21/100 [01:09<04:00,  3.05s/it]Best trial: 19. Best value: 0.389659:  22%|██▏       | 22/100 [01:09<03:50,  2.95s/it]Best trial: 19. Best value: 0.389659:  22%|██▏       | 22/100 [01:12<03:50,  2.95s/it]Best trial: 19. Best value: 0.389659:  23%|██▎       | 23/100 [01:12<03:48,  2.96s/it]Best trial: 19. Best value: 0.389659:  23%|██▎       | 23/100 [01:15<03:48,  2.96s/it]Best trial: 19. Best value: 0.389659:  24%|██▍       | 24/100 [01:15<03:53,  3.08s/it]Best trial: 19. Best value: 0.389659:  24%|██▍       | 24/100 [01:17<03:53,  3.08s/it]Best trial: 19. Best value: 0.389659:  25%|██▌       | 25/100 [01:17<03:31,  2.81s/it]Best trial: 19. Best value: 0.389659:  25%|██▌       | 25/100 [01:20<03:31,  2.81s/it]Best trial: 19. Best value: 0.389659:  26%|██▌       | 26/100 [01:20<03:23,  2.74s/it]Best trial: 19. Best value: 0.389659:  26%|██▌       | 26/100 [01:23<03:23,  2.74s/it]Best trial: 19. Best value: 0.389659:  27%|██▋       | 27/100 [01:23<03:30,  2.88s/it]Best trial: 19. Best value: 0.389659:  27%|██▋       | 27/100 [01:27<03:30,  2.88s/it]Best trial: 19. Best value: 0.389659:  28%|██▊       | 28/100 [01:27<03:41,  3.07s/it]Best trial: 19. Best value: 0.389659:  28%|██▊       | 28/100 [01:31<03:41,  3.07s/it]Best trial: 19. Best value: 0.389659:  29%|██▉       | 29/100 [01:31<04:03,  3.43s/it]Best trial: 19. Best value: 0.389659:  29%|██▉       | 29/100 [01:33<04:03,  3.43s/it]Best trial: 19. Best value: 0.389659:  30%|███       | 30/100 [01:33<03:41,  3.17s/it]Best trial: 19. Best value: 0.389659:  30%|███       | 30/100 [01:36<03:41,  3.17s/it]Best trial: 19. Best value: 0.389659:  31%|███       | 31/100 [01:36<03:35,  3.13s/it]Best trial: 19. Best value: 0.389659:  31%|███       | 31/100 [01:40<03:35,  3.13s/it]Best trial: 19. Best value: 0.389659:  32%|███▏      | 32/100 [01:40<03:31,  3.11s/it]Best trial: 32. Best value: 0.393128:  32%|███▏      | 32/100 [01:43<03:31,  3.11s/it]Best trial: 32. Best value: 0.393128:  33%|███▎      | 33/100 [01:43<03:44,  3.35s/it]Best trial: 32. Best value: 0.393128:  33%|███▎      | 33/100 [01:47<03:44,  3.35s/it]Best trial: 32. Best value: 0.393128:  34%|███▍      | 34/100 [01:47<03:49,  3.47s/it]Best trial: 32. Best value: 0.393128:  34%|███▍      | 34/100 [01:50<03:49,  3.47s/it]Best trial: 32. Best value: 0.393128:  35%|███▌      | 35/100 [01:50<03:40,  3.40s/it]Best trial: 32. Best value: 0.393128:  35%|███▌      | 35/100 [01:53<03:40,  3.40s/it]Best trial: 32. Best value: 0.393128:  36%|███▌      | 36/100 [01:53<03:24,  3.19s/it]Best trial: 32. Best value: 0.393128:  36%|███▌      | 36/100 [01:56<03:24,  3.19s/it]Best trial: 32. Best value: 0.393128:  37%|███▋      | 37/100 [01:56<03:06,  2.96s/it]Best trial: 32. Best value: 0.393128:  37%|███▋      | 37/100 [01:58<03:06,  2.96s/it]Best trial: 32. Best value: 0.393128:  38%|███▊      | 38/100 [01:58<02:57,  2.86s/it]Best trial: 32. Best value: 0.393128:  38%|███▊      | 38/100 [02:02<02:57,  2.86s/it]Best trial: 32. Best value: 0.393128:  39%|███▉      | 39/100 [02:02<03:07,  3.07s/it]Best trial: 32. Best value: 0.393128:  39%|███▉      | 39/100 [02:04<03:07,  3.07s/it]Best trial: 32. Best value: 0.393128:  40%|████      | 40/100 [02:04<02:54,  2.92s/it]Best trial: 32. Best value: 0.393128:  40%|████      | 40/100 [02:08<02:54,  2.92s/it]Best trial: 32. Best value: 0.393128:  41%|████      | 41/100 [02:08<03:12,  3.26s/it]Best trial: 32. Best value: 0.393128:  41%|████      | 41/100 [02:13<03:12,  3.26s/it]Best trial: 32. Best value: 0.393128:  42%|████▏     | 42/100 [02:13<03:25,  3.54s/it]Best trial: 32. Best value: 0.393128:  42%|████▏     | 42/100 [02:15<03:25,  3.54s/it]Best trial: 32. Best value: 0.393128:  43%|████▎     | 43/100 [02:15<03:05,  3.26s/it]Best trial: 32. Best value: 0.393128:  43%|████▎     | 43/100 [02:19<03:05,  3.26s/it]Best trial: 32. Best value: 0.393128:  44%|████▍     | 44/100 [02:19<03:06,  3.33s/it]Best trial: 32. Best value: 0.393128:  44%|████▍     | 44/100 [02:21<03:06,  3.33s/it]Best trial: 32. Best value: 0.393128:  45%|████▌     | 45/100 [02:21<02:52,  3.13s/it]Best trial: 32. Best value: 0.393128:  45%|████▌     | 45/100 [02:24<02:52,  3.13s/it]Best trial: 32. Best value: 0.393128:  46%|████▌     | 46/100 [02:24<02:45,  3.07s/it]Best trial: 32. Best value: 0.393128:  46%|████▌     | 46/100 [02:27<02:45,  3.07s/it]Best trial: 32. Best value: 0.393128:  47%|████▋     | 47/100 [02:27<02:38,  2.98s/it]Best trial: 32. Best value: 0.393128:  47%|████▋     | 47/100 [02:30<02:38,  2.98s/it]Best trial: 32. Best value: 0.393128:  48%|████▊     | 48/100 [02:30<02:28,  2.85s/it]Best trial: 32. Best value: 0.393128:  48%|████▊     | 48/100 [02:33<02:28,  2.85s/it]Best trial: 32. Best value: 0.393128:  49%|████▉     | 49/100 [02:33<02:28,  2.91s/it]Best trial: 32. Best value: 0.393128:  49%|████▉     | 49/100 [02:36<02:28,  2.91s/it]Best trial: 32. Best value: 0.393128:  50%|█████     | 50/100 [02:36<02:33,  3.07s/it]Best trial: 32. Best value: 0.393128:  50%|█████     | 50/100 [02:40<02:33,  3.07s/it]Best trial: 32. Best value: 0.393128:  51%|█████     | 51/100 [02:40<02:49,  3.46s/it]Best trial: 51. Best value: 0.401541:  51%|█████     | 51/100 [02:44<02:49,  3.46s/it]Best trial: 51. Best value: 0.401541:  52%|█████▏    | 52/100 [02:44<02:42,  3.38s/it]Best trial: 52. Best value: 0.427528:  52%|█████▏    | 52/100 [02:46<02:42,  3.38s/it]Best trial: 52. Best value: 0.427528:  53%|█████▎    | 53/100 [02:46<02:28,  3.16s/it]Best trial: 52. Best value: 0.427528:  53%|█████▎    | 53/100 [02:49<02:28,  3.16s/it]Best trial: 52. Best value: 0.427528:  54%|█████▍    | 54/100 [02:49<02:17,  2.99s/it]Best trial: 52. Best value: 0.427528:  54%|█████▍    | 54/100 [02:52<02:17,  2.99s/it]Best trial: 52. Best value: 0.427528:  55%|█████▌    | 55/100 [02:52<02:10,  2.91s/it]Best trial: 52. Best value: 0.427528:  55%|█████▌    | 55/100 [02:55<02:10,  2.91s/it]Best trial: 52. Best value: 0.427528:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]Best trial: 52. Best value: 0.427528:  56%|█████▌    | 56/100 [02:59<02:18,  3.14s/it]Best trial: 52. Best value: 0.427528:  57%|█████▋    | 57/100 [02:59<02:22,  3.31s/it]Best trial: 52. Best value: 0.427528:  57%|█████▋    | 57/100 [03:02<02:22,  3.31s/it]Best trial: 52. Best value: 0.427528:  58%|█████▊    | 58/100 [03:02<02:19,  3.32s/it]Best trial: 52. Best value: 0.427528:  58%|█████▊    | 58/100 [03:05<02:19,  3.32s/it]Best trial: 52. Best value: 0.427528:  59%|█████▉    | 59/100 [03:05<02:12,  3.22s/it]Best trial: 52. Best value: 0.427528:  59%|█████▉    | 59/100 [03:09<02:12,  3.22s/it]Best trial: 52. Best value: 0.427528:  60%|██████    | 60/100 [03:09<02:09,  3.23s/it]Best trial: 52. Best value: 0.427528:  60%|██████    | 60/100 [03:12<02:09,  3.23s/it]Best trial: 52. Best value: 0.427528:  61%|██████    | 61/100 [03:12<02:02,  3.15s/it]Best trial: 52. Best value: 0.427528:  61%|██████    | 61/100 [03:15<02:02,  3.15s/it]Best trial: 52. Best value: 0.427528:  62%|██████▏   | 62/100 [03:15<02:00,  3.17s/it]Best trial: 52. Best value: 0.427528:  62%|██████▏   | 62/100 [03:18<02:00,  3.17s/it]Best trial: 52. Best value: 0.427528:  63%|██████▎   | 63/100 [03:18<02:00,  3.24s/it]Best trial: 52. Best value: 0.427528:  63%|██████▎   | 63/100 [03:23<02:00,  3.24s/it]Best trial: 52. Best value: 0.427528:  64%|██████▍   | 64/100 [03:23<02:10,  3.62s/it]Best trial: 52. Best value: 0.427528:  64%|██████▍   | 64/100 [03:25<02:10,  3.62s/it]Best trial: 52. Best value: 0.427528:  65%|██████▌   | 65/100 [03:25<01:55,  3.30s/it]Best trial: 52. Best value: 0.427528:  65%|██████▌   | 65/100 [03:29<01:55,  3.30s/it]Best trial: 52. Best value: 0.427528:  66%|██████▌   | 66/100 [03:29<01:53,  3.33s/it]Best trial: 52. Best value: 0.427528:  66%|██████▌   | 66/100 [03:33<01:53,  3.33s/it]Best trial: 52. Best value: 0.427528:  67%|██████▋   | 67/100 [03:33<01:57,  3.56s/it]Best trial: 52. Best value: 0.427528:  67%|██████▋   | 67/100 [03:36<01:57,  3.56s/it]Best trial: 52. Best value: 0.427528:  68%|██████▊   | 68/100 [03:36<01:51,  3.47s/it]Best trial: 52. Best value: 0.427528:  68%|██████▊   | 68/100 [03:39<01:51,  3.47s/it]Best trial: 52. Best value: 0.427528:  69%|██████▉   | 69/100 [03:39<01:42,  3.29s/it]Best trial: 52. Best value: 0.427528:  69%|██████▉   | 69/100 [03:42<01:42,  3.29s/it]Best trial: 52. Best value: 0.427528:  70%|███████   | 70/100 [03:42<01:38,  3.27s/it]Best trial: 52. Best value: 0.427528:  70%|███████   | 70/100 [03:46<01:38,  3.27s/it]Best trial: 52. Best value: 0.427528:  71%|███████   | 71/100 [03:46<01:38,  3.40s/it]Best trial: 52. Best value: 0.427528:  71%|███████   | 71/100 [03:48<01:38,  3.40s/it]Best trial: 52. Best value: 0.427528:  72%|███████▏  | 72/100 [03:48<01:26,  3.07s/it]Best trial: 52. Best value: 0.427528:  72%|███████▏  | 72/100 [03:51<01:26,  3.07s/it]Best trial: 52. Best value: 0.427528:  73%|███████▎  | 73/100 [03:51<01:25,  3.15s/it]Best trial: 52. Best value: 0.427528:  73%|███████▎  | 73/100 [03:55<01:25,  3.15s/it]Best trial: 52. Best value: 0.427528:  74%|███████▍  | 74/100 [03:55<01:22,  3.19s/it]Best trial: 52. Best value: 0.427528:  74%|███████▍  | 74/100 [03:58<01:22,  3.19s/it]Best trial: 52. Best value: 0.427528:  75%|███████▌  | 75/100 [03:58<01:18,  3.15s/it]Best trial: 52. Best value: 0.427528:  75%|███████▌  | 75/100 [04:01<01:18,  3.15s/it]Best trial: 52. Best value: 0.427528:  76%|███████▌  | 76/100 [04:01<01:18,  3.26s/it]Best trial: 52. Best value: 0.427528:  76%|███████▌  | 76/100 [04:04<01:18,  3.26s/it]Best trial: 52. Best value: 0.427528:  77%|███████▋  | 77/100 [04:04<01:11,  3.09s/it]Best trial: 52. Best value: 0.427528:  77%|███████▋  | 77/100 [04:07<01:11,  3.09s/it]Best trial: 52. Best value: 0.427528:  78%|███████▊  | 78/100 [04:07<01:04,  2.94s/it]Best trial: 52. Best value: 0.427528:  78%|███████▊  | 78/100 [04:09<01:04,  2.94s/it]Best trial: 52. Best value: 0.427528:  79%|███████▉  | 79/100 [04:09<00:59,  2.86s/it]Best trial: 52. Best value: 0.427528:  79%|███████▉  | 79/100 [04:13<00:59,  2.86s/it]Best trial: 52. Best value: 0.427528:  80%|████████  | 80/100 [04:13<01:03,  3.17s/it]Best trial: 52. Best value: 0.427528:  80%|████████  | 80/100 [04:16<01:03,  3.17s/it]Best trial: 52. Best value: 0.427528:  81%|████████  | 81/100 [04:16<00:58,  3.09s/it]Best trial: 52. Best value: 0.427528:  81%|████████  | 81/100 [04:19<00:58,  3.09s/it]Best trial: 52. Best value: 0.427528:  82%|████████▏ | 82/100 [04:19<00:54,  3.01s/it]Best trial: 52. Best value: 0.427528:  82%|████████▏ | 82/100 [04:21<00:54,  3.01s/it]Best trial: 52. Best value: 0.427528:  83%|████████▎ | 83/100 [04:21<00:49,  2.90s/it]Best trial: 52. Best value: 0.427528:  83%|████████▎ | 83/100 [04:25<00:49,  2.90s/it]Best trial: 52. Best value: 0.427528:  84%|████████▍ | 84/100 [04:25<00:48,  3.00s/it]Best trial: 52. Best value: 0.427528:  84%|████████▍ | 84/100 [04:28<00:48,  3.00s/it]Best trial: 52. Best value: 0.427528:  85%|████████▌ | 85/100 [04:28<00:47,  3.20s/it]Best trial: 52. Best value: 0.427528:  85%|████████▌ | 85/100 [04:33<00:47,  3.20s/it]Best trial: 52. Best value: 0.427528:  86%|████████▌ | 86/100 [04:33<00:49,  3.51s/it]Best trial: 52. Best value: 0.427528:  86%|████████▌ | 86/100 [04:35<00:49,  3.51s/it]Best trial: 52. Best value: 0.427528:  87%|████████▋ | 87/100 [04:35<00:42,  3.25s/it]Best trial: 52. Best value: 0.427528:  87%|████████▋ | 87/100 [04:38<00:42,  3.25s/it]Best trial: 52. Best value: 0.427528:  88%|████████▊ | 88/100 [04:38<00:38,  3.20s/it]Best trial: 52. Best value: 0.427528:  88%|████████▊ | 88/100 [04:41<00:38,  3.20s/it]Best trial: 52. Best value: 0.427528:  89%|████████▉ | 89/100 [04:41<00:34,  3.12s/it]Best trial: 52. Best value: 0.427528:  89%|████████▉ | 89/100 [04:44<00:34,  3.12s/it]Best trial: 52. Best value: 0.427528:  90%|█████████ | 90/100 [04:44<00:29,  2.94s/it]Best trial: 52. Best value: 0.427528:  90%|█████████ | 90/100 [04:47<00:29,  2.94s/it]Best trial: 52. Best value: 0.427528:  91%|█████████ | 91/100 [04:47<00:26,  2.98s/it]Best trial: 52. Best value: 0.427528:  91%|█████████ | 91/100 [04:51<00:26,  2.98s/it]Best trial: 52. Best value: 0.427528:  92%|█████████▏| 92/100 [04:51<00:27,  3.39s/it]Best trial: 52. Best value: 0.427528:  92%|█████████▏| 92/100 [04:55<00:27,  3.39s/it]Best trial: 52. Best value: 0.427528:  93%|█████████▎| 93/100 [04:55<00:23,  3.39s/it]Best trial: 52. Best value: 0.427528:  93%|█████████▎| 93/100 [04:57<00:23,  3.39s/it]Best trial: 52. Best value: 0.427528:  94%|█████████▍| 94/100 [04:57<00:19,  3.18s/it]Best trial: 52. Best value: 0.427528:  94%|█████████▍| 94/100 [05:00<00:19,  3.18s/it]Best trial: 52. Best value: 0.427528:  95%|█████████▌| 95/100 [05:00<00:15,  3.04s/it]Best trial: 52. Best value: 0.427528:  95%|█████████▌| 95/100 [05:03<00:15,  3.04s/it]Best trial: 52. Best value: 0.427528:  96%|█████████▌| 96/100 [05:03<00:12,  3.08s/it]Best trial: 52. Best value: 0.427528:  96%|█████████▌| 96/100 [05:06<00:12,  3.08s/it]Best trial: 52. Best value: 0.427528:  97%|█████████▋| 97/100 [05:06<00:09,  3.07s/it]Best trial: 52. Best value: 0.427528:  97%|█████████▋| 97/100 [05:10<00:09,  3.07s/it]Best trial: 52. Best value: 0.427528:  98%|█████████▊| 98/100 [05:10<00:06,  3.26s/it]Best trial: 52. Best value: 0.427528:  98%|█████████▊| 98/100 [05:13<00:06,  3.26s/it]Best trial: 52. Best value: 0.427528:  99%|█████████▉| 99/100 [05:13<00:03,  3.28s/it]Best trial: 52. Best value: 0.427528:  99%|█████████▉| 99/100 [05:15<00:03,  3.28s/it]Best trial: 52. Best value: 0.427528: 100%|██████████| 100/100 [05:15<00:00,  2.92s/it]Best trial: 52. Best value: 0.427528: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
2025-11-30 13:38:11,161 - INFO - HPO Complete. Best AUPRC: 0.4275
2025-11-30 13:38:11,161 - INFO - Best Params: {'n_estimators': 100, 'learning_rate': 0.070280586085309, 'max_depth': 3, 'subsample': 0.8633263309307726, 'colsample_bytree': 0.8228903958893138, 'gamma': 2.7056911325682407, 'reg_lambda': 6.339256032897206e-07, 'reg_alpha': 9.486278659859524e-08}
2025-11-30 13:38:11,162 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:38:13,293 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 13:38:13,293 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:38:13,491 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:38:13,525 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:38:13,534 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:38:13,534 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:38:13,534 - INFO - Training model...
2025-11-30 13:38:14,077 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:38:19,699 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:38:19,699 - INFO - AUROC: 0.8249 (0.7167 - 0.9027)
2025-11-30 13:38:19,700 - INFO - AUPRC: 0.1689 (0.0439 - 0.3814)
2025-11-30 13:38:19,700 - INFO - Brier Score: 0.0181 (0.0136 - 0.0267)
2025-11-30 13:38:19,700 - INFO - Accuracy: 0.9841 (0.8500 - 0.9910)
2025-11-30 13:38:19,700 - INFO - Precision: 0.4444 (0.1317 - 0.7333)
2025-11-30 13:38:19,700 - INFO - Sensitivity (Recall): 0.4000 (0.1495 - 0.7500)
2025-11-30 13:38:19,700 - INFO - F1-Score: 0.4211 (0.1426 - 0.5745)
2025-11-30 13:38:19,700 - INFO - Best Threshold: 0.4800 (0.2660 - 0.5980)
2025-11-30 13:38:19,700 - INFO - Specificity: 0.9927 (0.8567 - 0.9977)
2025-11-30 13:38:19,704 - INFO - Calculating SHAP values...
2025-11-30 13:38:20,635 - INFO - SHAP plots saved.
2025-11-30 13:38:20,636 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:38:21,874 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 13:38:21,874 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:38:22,082 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:38:22,117 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:38:22,125 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:38:22,125 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.305014:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.305014:   1%|          | 1/100 [00:03<05:31,  3.35s/it]Best trial: 1. Best value: 0.331899:   1%|          | 1/100 [00:07<05:31,  3.35s/it]Best trial: 1. Best value: 0.331899:   2%|▏         | 2/100 [00:07<06:05,  3.73s/it]Best trial: 1. Best value: 0.331899:   2%|▏         | 2/100 [00:10<06:05,  3.73s/it]Best trial: 1. Best value: 0.331899:   3%|▎         | 3/100 [00:10<05:38,  3.49s/it]Best trial: 1. Best value: 0.331899:   3%|▎         | 3/100 [00:13<05:38,  3.49s/it]Best trial: 1. Best value: 0.331899:   4%|▍         | 4/100 [00:13<05:33,  3.47s/it]Best trial: 4. Best value: 0.333106:   4%|▍         | 4/100 [00:18<05:33,  3.47s/it]Best trial: 4. Best value: 0.333106:   5%|▌         | 5/100 [00:18<06:01,  3.80s/it]Best trial: 5. Best value: 0.352569:   5%|▌         | 5/100 [00:22<06:01,  3.80s/it]Best trial: 5. Best value: 0.352569:   6%|▌         | 6/100 [00:22<05:58,  3.82s/it]Best trial: 5. Best value: 0.352569:   6%|▌         | 6/100 [00:25<05:58,  3.82s/it]Best trial: 5. Best value: 0.352569:   7%|▋         | 7/100 [00:25<05:48,  3.74s/it]Best trial: 5. Best value: 0.352569:   7%|▋         | 7/100 [00:30<05:48,  3.74s/it]Best trial: 5. Best value: 0.352569:   8%|▊         | 8/100 [00:30<05:57,  3.88s/it]Best trial: 5. Best value: 0.352569:   8%|▊         | 8/100 [00:33<05:57,  3.88s/it]Best trial: 5. Best value: 0.352569:   9%|▉         | 9/100 [00:33<05:54,  3.90s/it]Best trial: 5. Best value: 0.352569:   9%|▉         | 9/100 [00:36<05:54,  3.90s/it]Best trial: 5. Best value: 0.352569:  10%|█         | 10/100 [00:36<05:19,  3.54s/it]Best trial: 10. Best value: 0.35866:  10%|█         | 10/100 [00:40<05:19,  3.54s/it]Best trial: 10. Best value: 0.35866:  11%|█         | 11/100 [00:40<05:13,  3.52s/it]Best trial: 10. Best value: 0.35866:  11%|█         | 11/100 [00:43<05:13,  3.52s/it]Best trial: 10. Best value: 0.35866:  12%|█▏        | 12/100 [00:43<04:54,  3.35s/it]Best trial: 12. Best value: 0.359615:  12%|█▏        | 12/100 [00:45<04:54,  3.35s/it]Best trial: 12. Best value: 0.359615:  13%|█▎        | 13/100 [00:45<04:33,  3.14s/it]Best trial: 12. Best value: 0.359615:  13%|█▎        | 13/100 [00:48<04:33,  3.14s/it]Best trial: 12. Best value: 0.359615:  14%|█▍        | 14/100 [00:48<04:27,  3.11s/it]Best trial: 12. Best value: 0.359615:  14%|█▍        | 14/100 [00:52<04:27,  3.11s/it]Best trial: 12. Best value: 0.359615:  15%|█▌        | 15/100 [00:52<04:26,  3.14s/it]Best trial: 12. Best value: 0.359615:  15%|█▌        | 15/100 [00:55<04:26,  3.14s/it]Best trial: 12. Best value: 0.359615:  16%|█▌        | 16/100 [00:55<04:28,  3.20s/it]Best trial: 16. Best value: 0.375902:  16%|█▌        | 16/100 [00:58<04:28,  3.20s/it]Best trial: 16. Best value: 0.375902:  17%|█▋        | 17/100 [00:58<04:28,  3.23s/it]Best trial: 16. Best value: 0.375902:  17%|█▋        | 17/100 [01:02<04:28,  3.23s/it]Best trial: 16. Best value: 0.375902:  18%|█▊        | 18/100 [01:02<04:42,  3.45s/it]Best trial: 16. Best value: 0.375902:  18%|█▊        | 18/100 [01:07<04:42,  3.45s/it]Best trial: 16. Best value: 0.375902:  19%|█▉        | 19/100 [01:07<05:08,  3.81s/it]Best trial: 16. Best value: 0.375902:  19%|█▉        | 19/100 [01:12<05:08,  3.81s/it]Best trial: 16. Best value: 0.375902:  20%|██        | 20/100 [01:12<05:32,  4.16s/it]Best trial: 16. Best value: 0.375902:  20%|██        | 20/100 [01:15<05:32,  4.16s/it]Best trial: 16. Best value: 0.375902:  21%|██        | 21/100 [01:15<05:09,  3.92s/it]Best trial: 21. Best value: 0.392443:  21%|██        | 21/100 [01:21<05:09,  3.92s/it]Best trial: 21. Best value: 0.392443:  22%|██▏       | 22/100 [01:21<05:50,  4.49s/it]Best trial: 22. Best value: 0.395792:  22%|██▏       | 22/100 [01:27<05:50,  4.49s/it]Best trial: 22. Best value: 0.395792:  23%|██▎       | 23/100 [01:27<06:22,  4.97s/it]Best trial: 22. Best value: 0.395792:  23%|██▎       | 23/100 [01:32<06:22,  4.97s/it]Best trial: 22. Best value: 0.395792:  24%|██▍       | 24/100 [01:32<06:12,  4.91s/it]Best trial: 22. Best value: 0.395792:  24%|██▍       | 24/100 [01:36<06:12,  4.91s/it]Best trial: 22. Best value: 0.395792:  25%|██▌       | 25/100 [01:36<06:03,  4.84s/it]Best trial: 22. Best value: 0.395792:  25%|██▌       | 25/100 [01:41<06:03,  4.84s/it]Best trial: 22. Best value: 0.395792:  26%|██▌       | 26/100 [01:41<05:59,  4.86s/it]Best trial: 22. Best value: 0.395792:  26%|██▌       | 26/100 [01:45<05:59,  4.86s/it]Best trial: 22. Best value: 0.395792:  27%|██▋       | 27/100 [01:45<05:32,  4.55s/it]Best trial: 22. Best value: 0.395792:  27%|██▋       | 27/100 [01:50<05:32,  4.55s/it]Best trial: 22. Best value: 0.395792:  28%|██▊       | 28/100 [01:50<05:32,  4.62s/it]Best trial: 22. Best value: 0.395792:  28%|██▊       | 28/100 [01:54<05:32,  4.62s/it]Best trial: 22. Best value: 0.395792:  29%|██▉       | 29/100 [01:54<05:11,  4.38s/it]Best trial: 22. Best value: 0.395792:  29%|██▉       | 29/100 [01:58<05:11,  4.38s/it]Best trial: 22. Best value: 0.395792:  30%|███       | 30/100 [01:58<05:04,  4.35s/it]Best trial: 22. Best value: 0.395792:  30%|███       | 30/100 [02:02<05:04,  4.35s/it]Best trial: 22. Best value: 0.395792:  31%|███       | 31/100 [02:02<04:49,  4.20s/it]Best trial: 22. Best value: 0.395792:  31%|███       | 31/100 [02:08<04:49,  4.20s/it]Best trial: 22. Best value: 0.395792:  32%|███▏      | 32/100 [02:08<05:13,  4.61s/it]Best trial: 22. Best value: 0.395792:  32%|███▏      | 32/100 [02:14<05:13,  4.61s/it]Best trial: 22. Best value: 0.395792:  33%|███▎      | 33/100 [02:14<05:39,  5.07s/it]Best trial: 22. Best value: 0.395792:  33%|███▎      | 33/100 [02:22<05:39,  5.07s/it]Best trial: 22. Best value: 0.395792:  34%|███▍      | 34/100 [02:22<06:36,  6.01s/it]Best trial: 22. Best value: 0.395792:  34%|███▍      | 34/100 [02:27<06:36,  6.01s/it]Best trial: 22. Best value: 0.395792:  35%|███▌      | 35/100 [02:27<06:08,  5.67s/it]Best trial: 22. Best value: 0.395792:  35%|███▌      | 35/100 [02:31<06:08,  5.67s/it]Best trial: 22. Best value: 0.395792:  36%|███▌      | 36/100 [02:31<05:27,  5.12s/it]Best trial: 22. Best value: 0.395792:  36%|███▌      | 36/100 [02:34<05:27,  5.12s/it]Best trial: 22. Best value: 0.395792:  37%|███▋      | 37/100 [02:34<04:59,  4.75s/it]Best trial: 22. Best value: 0.395792:  37%|███▋      | 37/100 [02:38<04:59,  4.75s/it]Best trial: 22. Best value: 0.395792:  38%|███▊      | 38/100 [02:38<04:40,  4.52s/it]Best trial: 22. Best value: 0.395792:  38%|███▊      | 38/100 [02:43<04:40,  4.52s/it]Best trial: 22. Best value: 0.395792:  39%|███▉      | 39/100 [02:43<04:45,  4.67s/it]Best trial: 22. Best value: 0.395792:  39%|███▉      | 39/100 [02:48<04:45,  4.67s/it]Best trial: 22. Best value: 0.395792:  40%|████      | 40/100 [02:48<04:45,  4.75s/it]Best trial: 22. Best value: 0.395792:  40%|████      | 40/100 [02:54<04:45,  4.75s/it]Best trial: 22. Best value: 0.395792:  41%|████      | 41/100 [02:54<04:47,  4.87s/it]Best trial: 22. Best value: 0.395792:  41%|████      | 41/100 [02:57<04:47,  4.87s/it]Best trial: 22. Best value: 0.395792:  42%|████▏     | 42/100 [02:57<04:23,  4.55s/it]Best trial: 22. Best value: 0.395792:  42%|████▏     | 42/100 [03:01<04:23,  4.55s/it]Best trial: 22. Best value: 0.395792:  43%|████▎     | 43/100 [03:01<04:11,  4.41s/it]Best trial: 22. Best value: 0.395792:  43%|████▎     | 43/100 [03:05<04:11,  4.41s/it]Best trial: 22. Best value: 0.395792:  44%|████▍     | 44/100 [03:05<03:51,  4.13s/it]Best trial: 22. Best value: 0.395792:  44%|████▍     | 44/100 [03:08<03:51,  4.13s/it]Best trial: 22. Best value: 0.395792:  45%|████▌     | 45/100 [03:08<03:33,  3.89s/it]Best trial: 22. Best value: 0.395792:  45%|████▌     | 45/100 [03:12<03:33,  3.89s/it]Best trial: 22. Best value: 0.395792:  46%|████▌     | 46/100 [03:12<03:20,  3.72s/it]Best trial: 22. Best value: 0.395792:  46%|████▌     | 46/100 [03:16<03:20,  3.72s/it]Best trial: 22. Best value: 0.395792:  47%|████▋     | 47/100 [03:16<03:21,  3.80s/it]Best trial: 22. Best value: 0.395792:  47%|████▋     | 47/100 [03:19<03:21,  3.80s/it]Best trial: 22. Best value: 0.395792:  48%|████▊     | 48/100 [03:19<03:18,  3.82s/it]Best trial: 22. Best value: 0.395792:  48%|████▊     | 48/100 [03:24<03:18,  3.82s/it]Best trial: 22. Best value: 0.395792:  49%|████▉     | 49/100 [03:24<03:26,  4.04s/it]Best trial: 22. Best value: 0.395792:  49%|████▉     | 49/100 [03:27<03:26,  4.04s/it]Best trial: 22. Best value: 0.395792:  50%|█████     | 50/100 [03:27<03:11,  3.83s/it]Best trial: 22. Best value: 0.395792:  50%|█████     | 50/100 [03:30<03:11,  3.83s/it]Best trial: 22. Best value: 0.395792:  51%|█████     | 51/100 [03:30<02:45,  3.38s/it]Best trial: 22. Best value: 0.395792:  51%|█████     | 51/100 [03:35<02:45,  3.38s/it]Best trial: 22. Best value: 0.395792:  52%|█████▏    | 52/100 [03:35<03:09,  3.94s/it]Best trial: 22. Best value: 0.395792:  52%|█████▏    | 52/100 [03:41<03:09,  3.94s/it]Best trial: 22. Best value: 0.395792:  53%|█████▎    | 53/100 [03:41<03:32,  4.52s/it]Best trial: 22. Best value: 0.395792:  53%|█████▎    | 53/100 [03:45<03:32,  4.52s/it]Best trial: 22. Best value: 0.395792:  54%|█████▍    | 54/100 [03:45<03:20,  4.35s/it]Best trial: 22. Best value: 0.395792:  54%|█████▍    | 54/100 [03:49<03:20,  4.35s/it]Best trial: 22. Best value: 0.395792:  55%|█████▌    | 55/100 [03:49<03:08,  4.20s/it]Best trial: 22. Best value: 0.395792:  55%|█████▌    | 55/100 [03:53<03:08,  4.20s/it]Best trial: 22. Best value: 0.395792:  56%|█████▌    | 56/100 [03:53<03:11,  4.36s/it]Best trial: 22. Best value: 0.395792:  56%|█████▌    | 56/100 [03:57<03:11,  4.36s/it]Best trial: 22. Best value: 0.395792:  57%|█████▋    | 57/100 [03:57<03:01,  4.22s/it]Best trial: 22. Best value: 0.395792:  57%|█████▋    | 57/100 [04:01<03:01,  4.22s/it]Best trial: 22. Best value: 0.395792:  58%|█████▊    | 58/100 [04:01<02:45,  3.95s/it]Best trial: 58. Best value: 0.411665:  58%|█████▊    | 58/100 [04:06<02:45,  3.95s/it]Best trial: 58. Best value: 0.411665:  59%|█████▉    | 59/100 [04:06<03:05,  4.53s/it]Best trial: 58. Best value: 0.411665:  59%|█████▉    | 59/100 [04:12<03:05,  4.53s/it]Best trial: 58. Best value: 0.411665:  60%|██████    | 60/100 [04:12<03:13,  4.84s/it]Best trial: 58. Best value: 0.411665:  60%|██████    | 60/100 [04:17<03:13,  4.84s/it]Best trial: 58. Best value: 0.411665:  61%|██████    | 61/100 [04:17<03:05,  4.76s/it]Best trial: 58. Best value: 0.411665:  61%|██████    | 61/100 [04:21<03:05,  4.76s/it]Best trial: 58. Best value: 0.411665:  62%|██████▏   | 62/100 [04:21<02:56,  4.65s/it]Best trial: 58. Best value: 0.411665:  62%|██████▏   | 62/100 [04:25<02:56,  4.65s/it]Best trial: 58. Best value: 0.411665:  63%|██████▎   | 63/100 [04:25<02:43,  4.41s/it]Best trial: 58. Best value: 0.411665:  63%|██████▎   | 63/100 [04:28<02:43,  4.41s/it]Best trial: 58. Best value: 0.411665:  64%|██████▍   | 64/100 [04:28<02:28,  4.13s/it]Best trial: 58. Best value: 0.411665:  64%|██████▍   | 64/100 [04:32<02:28,  4.13s/it]Best trial: 58. Best value: 0.411665:  65%|██████▌   | 65/100 [04:32<02:22,  4.06s/it]Best trial: 58. Best value: 0.411665:  65%|██████▌   | 65/100 [04:36<02:22,  4.06s/it]Best trial: 58. Best value: 0.411665:  66%|██████▌   | 66/100 [04:36<02:16,  4.01s/it]Best trial: 66. Best value: 0.417913:  66%|██████▌   | 66/100 [04:39<02:16,  4.01s/it]Best trial: 66. Best value: 0.417913:  67%|██████▋   | 67/100 [04:39<02:06,  3.82s/it]Best trial: 66. Best value: 0.417913:  67%|██████▋   | 67/100 [04:42<02:06,  3.82s/it]Best trial: 66. Best value: 0.417913:  68%|██████▊   | 68/100 [04:42<01:54,  3.58s/it]Best trial: 66. Best value: 0.417913:  68%|██████▊   | 68/100 [04:46<01:54,  3.58s/it]Best trial: 66. Best value: 0.417913:  69%|██████▉   | 69/100 [04:46<01:48,  3.51s/it]Best trial: 66. Best value: 0.417913:  69%|██████▉   | 69/100 [04:49<01:48,  3.51s/it]Best trial: 66. Best value: 0.417913:  70%|███████   | 70/100 [04:49<01:41,  3.38s/it]Best trial: 66. Best value: 0.417913:  70%|███████   | 70/100 [04:54<01:41,  3.38s/it]Best trial: 66. Best value: 0.417913:  71%|███████   | 71/100 [04:54<01:49,  3.77s/it]Best trial: 66. Best value: 0.417913:  71%|███████   | 71/100 [04:57<01:49,  3.77s/it]Best trial: 66. Best value: 0.417913:  72%|███████▏  | 72/100 [04:57<01:46,  3.79s/it]Best trial: 66. Best value: 0.417913:  72%|███████▏  | 72/100 [05:01<01:46,  3.79s/it]Best trial: 66. Best value: 0.417913:  73%|███████▎  | 73/100 [05:01<01:43,  3.83s/it]Best trial: 66. Best value: 0.417913:  73%|███████▎  | 73/100 [05:05<01:43,  3.83s/it]Best trial: 66. Best value: 0.417913:  74%|███████▍  | 74/100 [05:05<01:35,  3.68s/it]Best trial: 66. Best value: 0.417913:  74%|███████▍  | 74/100 [05:09<01:35,  3.68s/it]Best trial: 66. Best value: 0.417913:  75%|███████▌  | 75/100 [05:09<01:34,  3.77s/it]Best trial: 66. Best value: 0.417913:  75%|███████▌  | 75/100 [05:12<01:34,  3.77s/it]Best trial: 66. Best value: 0.417913:  76%|███████▌  | 76/100 [05:12<01:27,  3.63s/it]Best trial: 66. Best value: 0.417913:  76%|███████▌  | 76/100 [05:17<01:27,  3.63s/it]Best trial: 66. Best value: 0.417913:  77%|███████▋  | 77/100 [05:17<01:34,  4.12s/it]Best trial: 66. Best value: 0.417913:  77%|███████▋  | 77/100 [05:22<01:34,  4.12s/it]Best trial: 66. Best value: 0.417913:  78%|███████▊  | 78/100 [05:22<01:33,  4.26s/it]Best trial: 66. Best value: 0.417913:  78%|███████▊  | 78/100 [05:26<01:33,  4.26s/it]Best trial: 66. Best value: 0.417913:  79%|███████▉  | 79/100 [05:26<01:27,  4.17s/it]Best trial: 66. Best value: 0.417913:  79%|███████▉  | 79/100 [05:29<01:27,  4.17s/it]Best trial: 66. Best value: 0.417913:  80%|████████  | 80/100 [05:29<01:15,  3.78s/it]Best trial: 66. Best value: 0.417913:  80%|████████  | 80/100 [05:34<01:15,  3.78s/it]Best trial: 66. Best value: 0.417913:  81%|████████  | 81/100 [05:34<01:18,  4.14s/it]Best trial: 66. Best value: 0.417913:  81%|████████  | 81/100 [05:38<01:18,  4.14s/it]Best trial: 66. Best value: 0.417913:  82%|████████▏ | 82/100 [05:38<01:14,  4.13s/it]Best trial: 66. Best value: 0.417913:  82%|████████▏ | 82/100 [05:43<01:14,  4.13s/it]Best trial: 66. Best value: 0.417913:  83%|████████▎ | 83/100 [05:43<01:14,  4.36s/it]Best trial: 66. Best value: 0.417913:  83%|████████▎ | 83/100 [05:47<01:14,  4.36s/it]Best trial: 66. Best value: 0.417913:  84%|████████▍ | 84/100 [05:47<01:08,  4.30s/it]Best trial: 66. Best value: 0.417913:  84%|████████▍ | 84/100 [05:51<01:08,  4.30s/it]Best trial: 66. Best value: 0.417913:  85%|████████▌ | 85/100 [05:51<01:06,  4.42s/it]Best trial: 66. Best value: 0.417913:  85%|████████▌ | 85/100 [05:55<01:06,  4.42s/it]Best trial: 66. Best value: 0.417913:  86%|████████▌ | 86/100 [05:55<00:58,  4.20s/it]Best trial: 66. Best value: 0.417913:  86%|████████▌ | 86/100 [05:59<00:58,  4.20s/it]Best trial: 66. Best value: 0.417913:  87%|████████▋ | 87/100 [05:59<00:51,  3.98s/it]Best trial: 66. Best value: 0.417913:  87%|████████▋ | 87/100 [06:03<00:51,  3.98s/it]Best trial: 66. Best value: 0.417913:  88%|████████▊ | 88/100 [06:03<00:50,  4.22s/it]Best trial: 66. Best value: 0.417913:  88%|████████▊ | 88/100 [06:07<00:50,  4.22s/it]Best trial: 66. Best value: 0.417913:  89%|████████▉ | 89/100 [06:07<00:45,  4.12s/it]Best trial: 66. Best value: 0.417913:  89%|████████▉ | 89/100 [06:10<00:45,  4.12s/it]Best trial: 66. Best value: 0.417913:  90%|█████████ | 90/100 [06:10<00:35,  3.57s/it]Best trial: 66. Best value: 0.417913:  90%|█████████ | 90/100 [06:13<00:35,  3.57s/it]Best trial: 66. Best value: 0.417913:  91%|█████████ | 91/100 [06:13<00:32,  3.65s/it]Best trial: 66. Best value: 0.417913:  91%|█████████ | 91/100 [06:18<00:32,  3.65s/it]Best trial: 66. Best value: 0.417913:  92%|█████████▏| 92/100 [06:18<00:32,  4.05s/it]Best trial: 66. Best value: 0.417913:  92%|█████████▏| 92/100 [06:22<00:32,  4.05s/it]Best trial: 66. Best value: 0.417913:  93%|█████████▎| 93/100 [06:22<00:27,  3.94s/it]Best trial: 66. Best value: 0.417913:  93%|█████████▎| 93/100 [06:26<00:27,  3.94s/it]Best trial: 66. Best value: 0.417913:  94%|█████████▍| 94/100 [06:26<00:23,  3.90s/it]Best trial: 66. Best value: 0.417913:  94%|█████████▍| 94/100 [06:30<00:23,  3.90s/it]Best trial: 66. Best value: 0.417913:  95%|█████████▌| 95/100 [06:30<00:19,  3.83s/it]Best trial: 66. Best value: 0.417913:  95%|█████████▌| 95/100 [06:33<00:19,  3.83s/it]Best trial: 66. Best value: 0.417913:  96%|█████████▌| 96/100 [06:33<00:14,  3.71s/it]Best trial: 66. Best value: 0.417913:  96%|█████████▌| 96/100 [06:37<00:14,  3.71s/it]Best trial: 66. Best value: 0.417913:  97%|█████████▋| 97/100 [06:37<00:11,  3.69s/it]Best trial: 66. Best value: 0.417913:  97%|█████████▋| 97/100 [06:42<00:11,  3.69s/it]Best trial: 66. Best value: 0.417913:  98%|█████████▊| 98/100 [06:42<00:08,  4.10s/it]Best trial: 66. Best value: 0.417913:  98%|█████████▊| 98/100 [06:48<00:08,  4.10s/it]Best trial: 66. Best value: 0.417913:  99%|█████████▉| 99/100 [06:48<00:04,  4.68s/it]Best trial: 66. Best value: 0.417913:  99%|█████████▉| 99/100 [06:51<00:04,  4.68s/it]Best trial: 66. Best value: 0.417913: 100%|██████████| 100/100 [06:51<00:00,  4.36s/it]Best trial: 66. Best value: 0.417913: 100%|██████████| 100/100 [06:51<00:00,  4.12s/it]
2025-11-30 13:45:13,942 - INFO - HPO Complete. Best AUPRC: 0.4179
2025-11-30 13:45:13,942 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.08940688273696319, 'max_depth': 4, 'subsample': 0.8059600361448737, 'colsample_bytree': 0.867629172814263, 'gamma': 2.7214268441193514, 'reg_lambda': 0.000599188855730992, 'reg_alpha': 8.660641035215578e-08}
2025-11-30 13:45:13,942 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:45:15,780 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 13:45:15,781 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:45:15,980 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:45:16,013 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:45:16,021 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:45:16,021 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:45:16,022 - INFO - Training model...
2025-11-30 13:45:18,686 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:45:24,286 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:45:24,286 - INFO - AUROC: 0.7097 (0.5273 - 0.8362)
2025-11-30 13:45:24,286 - INFO - AUPRC: 0.0852 (0.0197 - 0.3092)
2025-11-30 13:45:24,286 - INFO - Brier Score: 0.0177 (0.0115 - 0.0291)
2025-11-30 13:45:24,286 - INFO - Accuracy: 0.9668 (0.9145 - 0.9908)
2025-11-30 13:45:24,286 - INFO - Precision: 0.1579 (0.0400 - 0.7500)
2025-11-30 13:45:24,286 - INFO - Sensitivity (Recall): 0.3000 (0.0462 - 0.5222)
2025-11-30 13:45:24,286 - INFO - F1-Score: 0.2069 (0.0545 - 0.5009)
2025-11-30 13:45:24,286 - INFO - Best Threshold: 0.1300 (0.0820 - 0.8000)
2025-11-30 13:45:24,286 - INFO - Specificity: 0.9765 (0.9268 - 0.9985)
2025-11-30 13:45:24,298 - INFO - Calculating SHAP values...
2025-11-30 13:45:25,359 - INFO - SHAP plots saved.
2025-11-30 13:45:25,360 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:45:26,662 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 13:45:26,663 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:45:26,862 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:45:26,900 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:45:26,908 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:45:26,908 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.270693:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.270693:   1%|          | 1/100 [00:03<05:02,  3.05s/it]Best trial: 1. Best value: 0.335294:   1%|          | 1/100 [00:06<05:02,  3.05s/it]Best trial: 1. Best value: 0.335294:   2%|▏         | 2/100 [00:06<04:55,  3.01s/it]Best trial: 1. Best value: 0.335294:   2%|▏         | 2/100 [00:08<04:55,  3.01s/it]Best trial: 1. Best value: 0.335294:   3%|▎         | 3/100 [00:08<04:48,  2.97s/it]Best trial: 1. Best value: 0.335294:   3%|▎         | 3/100 [00:11<04:48,  2.97s/it]Best trial: 1. Best value: 0.335294:   4%|▍         | 4/100 [00:11<04:33,  2.85s/it]Best trial: 1. Best value: 0.335294:   4%|▍         | 4/100 [00:15<04:33,  2.85s/it]Best trial: 1. Best value: 0.335294:   5%|▌         | 5/100 [00:15<05:02,  3.18s/it]Best trial: 1. Best value: 0.335294:   5%|▌         | 5/100 [00:18<05:02,  3.18s/it]Best trial: 1. Best value: 0.335294:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]Best trial: 1. Best value: 0.335294:   6%|▌         | 6/100 [00:21<04:52,  3.11s/it]Best trial: 1. Best value: 0.335294:   7%|▋         | 7/100 [00:21<04:53,  3.16s/it]Best trial: 1. Best value: 0.335294:   7%|▋         | 7/100 [00:24<04:53,  3.16s/it]Best trial: 1. Best value: 0.335294:   8%|▊         | 8/100 [00:24<04:40,  3.04s/it]Best trial: 1. Best value: 0.335294:   8%|▊         | 8/100 [00:27<04:40,  3.04s/it]Best trial: 1. Best value: 0.335294:   9%|▉         | 9/100 [00:27<04:38,  3.06s/it]Best trial: 1. Best value: 0.335294:   9%|▉         | 9/100 [00:30<04:38,  3.06s/it]Best trial: 1. Best value: 0.335294:  10%|█         | 10/100 [00:30<04:40,  3.12s/it]Best trial: 10. Best value: 0.356498:  10%|█         | 10/100 [00:33<04:40,  3.12s/it]Best trial: 10. Best value: 0.356498:  11%|█         | 11/100 [00:33<04:31,  3.06s/it]Best trial: 10. Best value: 0.356498:  11%|█         | 11/100 [00:36<04:31,  3.06s/it]Best trial: 10. Best value: 0.356498:  12%|█▏        | 12/100 [00:36<04:33,  3.11s/it]Best trial: 10. Best value: 0.356498:  12%|█▏        | 12/100 [00:39<04:33,  3.11s/it]Best trial: 10. Best value: 0.356498:  13%|█▎        | 13/100 [00:39<04:27,  3.07s/it]Best trial: 10. Best value: 0.356498:  13%|█▎        | 13/100 [00:44<04:27,  3.07s/it]Best trial: 10. Best value: 0.356498:  14%|█▍        | 14/100 [00:44<05:02,  3.52s/it]Best trial: 10. Best value: 0.356498:  14%|█▍        | 14/100 [00:47<05:02,  3.52s/it]Best trial: 10. Best value: 0.356498:  15%|█▌        | 15/100 [00:47<04:39,  3.29s/it]Best trial: 10. Best value: 0.356498:  15%|█▌        | 15/100 [00:50<04:39,  3.29s/it]Best trial: 10. Best value: 0.356498:  16%|█▌        | 16/100 [00:50<04:25,  3.16s/it]Best trial: 10. Best value: 0.356498:  16%|█▌        | 16/100 [00:54<04:25,  3.16s/it]Best trial: 10. Best value: 0.356498:  17%|█▋        | 17/100 [00:54<04:45,  3.44s/it]Best trial: 10. Best value: 0.356498:  17%|█▋        | 17/100 [00:56<04:45,  3.44s/it]Best trial: 10. Best value: 0.356498:  18%|█▊        | 18/100 [00:56<04:21,  3.19s/it]Best trial: 10. Best value: 0.356498:  18%|█▊        | 18/100 [00:59<04:21,  3.19s/it]Best trial: 10. Best value: 0.356498:  19%|█▉        | 19/100 [00:59<04:17,  3.18s/it]Best trial: 10. Best value: 0.356498:  19%|█▉        | 19/100 [01:03<04:17,  3.18s/it]Best trial: 10. Best value: 0.356498:  20%|██        | 20/100 [01:03<04:25,  3.32s/it]Best trial: 20. Best value: 0.382129:  20%|██        | 20/100 [01:07<04:25,  3.32s/it]Best trial: 20. Best value: 0.382129:  21%|██        | 21/100 [01:07<04:34,  3.47s/it]Best trial: 20. Best value: 0.382129:  21%|██        | 21/100 [01:11<04:34,  3.47s/it]Best trial: 20. Best value: 0.382129:  22%|██▏       | 22/100 [01:11<04:36,  3.55s/it]Best trial: 22. Best value: 0.402799:  22%|██▏       | 22/100 [01:15<04:36,  3.55s/it]Best trial: 22. Best value: 0.402799:  23%|██▎       | 23/100 [01:15<04:45,  3.71s/it]Best trial: 22. Best value: 0.402799:  23%|██▎       | 23/100 [01:17<04:45,  3.71s/it]Best trial: 22. Best value: 0.402799:  24%|██▍       | 24/100 [01:17<04:20,  3.43s/it]Best trial: 22. Best value: 0.402799:  24%|██▍       | 24/100 [01:22<04:20,  3.43s/it]Best trial: 22. Best value: 0.402799:  25%|██▌       | 25/100 [01:22<04:35,  3.67s/it]Best trial: 22. Best value: 0.402799:  25%|██▌       | 25/100 [01:26<04:35,  3.67s/it]Best trial: 22. Best value: 0.402799:  26%|██▌       | 26/100 [01:26<04:54,  3.98s/it]Best trial: 22. Best value: 0.402799:  26%|██▌       | 26/100 [01:30<04:54,  3.98s/it]Best trial: 22. Best value: 0.402799:  27%|██▋       | 27/100 [01:30<04:32,  3.73s/it]Best trial: 22. Best value: 0.402799:  27%|██▋       | 27/100 [01:33<04:32,  3.73s/it]Best trial: 22. Best value: 0.402799:  28%|██▊       | 28/100 [01:33<04:19,  3.60s/it]Best trial: 22. Best value: 0.402799:  28%|██▊       | 28/100 [01:37<04:19,  3.60s/it]Best trial: 22. Best value: 0.402799:  29%|██▉       | 29/100 [01:37<04:21,  3.69s/it]Best trial: 22. Best value: 0.402799:  29%|██▉       | 29/100 [01:40<04:21,  3.69s/it]Best trial: 22. Best value: 0.402799:  30%|███       | 30/100 [01:40<04:00,  3.44s/it]Best trial: 22. Best value: 0.402799:  30%|███       | 30/100 [01:43<04:00,  3.44s/it]Best trial: 22. Best value: 0.402799:  31%|███       | 31/100 [01:43<03:54,  3.40s/it]Best trial: 22. Best value: 0.402799:  31%|███       | 31/100 [01:46<03:54,  3.40s/it]Best trial: 22. Best value: 0.402799:  32%|███▏      | 32/100 [01:46<03:50,  3.39s/it]Best trial: 22. Best value: 0.402799:  32%|███▏      | 32/100 [01:50<03:50,  3.39s/it]Best trial: 22. Best value: 0.402799:  33%|███▎      | 33/100 [01:50<03:57,  3.54s/it]Best trial: 22. Best value: 0.402799:  33%|███▎      | 33/100 [01:56<03:57,  3.54s/it]Best trial: 22. Best value: 0.402799:  34%|███▍      | 34/100 [01:56<04:30,  4.10s/it]Best trial: 22. Best value: 0.402799:  34%|███▍      | 34/100 [02:00<04:30,  4.10s/it]Best trial: 22. Best value: 0.402799:  35%|███▌      | 35/100 [02:00<04:28,  4.13s/it]Best trial: 22. Best value: 0.402799:  35%|███▌      | 35/100 [02:03<04:28,  4.13s/it]Best trial: 22. Best value: 0.402799:  36%|███▌      | 36/100 [02:03<04:13,  3.95s/it]Best trial: 22. Best value: 0.402799:  36%|███▌      | 36/100 [02:07<04:13,  3.95s/it]Best trial: 22. Best value: 0.402799:  37%|███▋      | 37/100 [02:07<04:12,  4.02s/it]Best trial: 22. Best value: 0.402799:  37%|███▋      | 37/100 [02:11<04:12,  4.02s/it]Best trial: 22. Best value: 0.402799:  38%|███▊      | 38/100 [02:11<04:01,  3.89s/it]Best trial: 22. Best value: 0.402799:  38%|███▊      | 38/100 [02:15<04:01,  3.89s/it]Best trial: 22. Best value: 0.402799:  39%|███▉      | 39/100 [02:15<03:50,  3.78s/it]Best trial: 22. Best value: 0.402799:  39%|███▉      | 39/100 [02:17<03:50,  3.78s/it]Best trial: 22. Best value: 0.402799:  40%|████      | 40/100 [02:17<03:27,  3.45s/it]Best trial: 22. Best value: 0.402799:  40%|████      | 40/100 [02:20<03:27,  3.45s/it]Best trial: 22. Best value: 0.402799:  41%|████      | 41/100 [02:20<03:09,  3.21s/it]Best trial: 22. Best value: 0.402799:  41%|████      | 41/100 [02:23<03:09,  3.21s/it]Best trial: 22. Best value: 0.402799:  42%|████▏     | 42/100 [02:23<03:00,  3.11s/it]Best trial: 22. Best value: 0.402799:  42%|████▏     | 42/100 [02:27<03:00,  3.11s/it]Best trial: 22. Best value: 0.402799:  43%|████▎     | 43/100 [02:27<03:20,  3.51s/it]Best trial: 22. Best value: 0.402799:  43%|████▎     | 43/100 [02:31<03:20,  3.51s/it]Best trial: 22. Best value: 0.402799:  44%|████▍     | 44/100 [02:31<03:14,  3.47s/it]Best trial: 22. Best value: 0.402799:  44%|████▍     | 44/100 [02:35<03:14,  3.47s/it]Best trial: 22. Best value: 0.402799:  45%|████▌     | 45/100 [02:35<03:28,  3.79s/it]Best trial: 22. Best value: 0.402799:  45%|████▌     | 45/100 [02:38<03:28,  3.79s/it]Best trial: 22. Best value: 0.402799:  46%|████▌     | 46/100 [02:38<03:15,  3.63s/it]Best trial: 22. Best value: 0.402799:  46%|████▌     | 46/100 [02:42<03:15,  3.63s/it]Best trial: 22. Best value: 0.402799:  47%|████▋     | 47/100 [02:42<03:16,  3.71s/it]Best trial: 22. Best value: 0.402799:  47%|████▋     | 47/100 [02:45<03:16,  3.71s/it]Best trial: 22. Best value: 0.402799:  48%|████▊     | 48/100 [02:45<03:01,  3.48s/it]Best trial: 22. Best value: 0.402799:  48%|████▊     | 48/100 [02:50<03:01,  3.48s/it]Best trial: 22. Best value: 0.402799:  49%|████▉     | 49/100 [02:50<03:23,  3.98s/it]Best trial: 22. Best value: 0.402799:  49%|████▉     | 49/100 [02:54<03:23,  3.98s/it]Best trial: 22. Best value: 0.402799:  50%|█████     | 50/100 [02:54<03:15,  3.91s/it]Best trial: 22. Best value: 0.402799:  50%|█████     | 50/100 [02:58<03:15,  3.91s/it]Best trial: 22. Best value: 0.402799:  51%|█████     | 51/100 [02:58<03:06,  3.80s/it]Best trial: 22. Best value: 0.402799:  51%|█████     | 51/100 [03:01<03:06,  3.80s/it]Best trial: 22. Best value: 0.402799:  52%|█████▏    | 52/100 [03:01<02:51,  3.57s/it]Best trial: 22. Best value: 0.402799:  52%|█████▏    | 52/100 [03:05<02:51,  3.57s/it]Best trial: 22. Best value: 0.402799:  53%|█████▎    | 53/100 [03:05<02:57,  3.77s/it]Best trial: 22. Best value: 0.402799:  53%|█████▎    | 53/100 [03:08<02:57,  3.77s/it]Best trial: 22. Best value: 0.402799:  54%|█████▍    | 54/100 [03:08<02:46,  3.63s/it]Best trial: 22. Best value: 0.402799:  54%|█████▍    | 54/100 [03:13<02:46,  3.63s/it]Best trial: 22. Best value: 0.402799:  55%|█████▌    | 55/100 [03:13<02:56,  3.93s/it]Best trial: 22. Best value: 0.402799:  55%|█████▌    | 55/100 [03:17<02:56,  3.93s/it]Best trial: 22. Best value: 0.402799:  56%|█████▌    | 56/100 [03:17<02:59,  4.09s/it]Best trial: 22. Best value: 0.402799:  56%|█████▌    | 56/100 [03:21<02:59,  4.09s/it]Best trial: 22. Best value: 0.402799:  57%|█████▋    | 57/100 [03:21<02:44,  3.82s/it]Best trial: 22. Best value: 0.402799:  57%|█████▋    | 57/100 [03:24<02:44,  3.82s/it]Best trial: 22. Best value: 0.402799:  58%|█████▊    | 58/100 [03:24<02:32,  3.62s/it]Best trial: 22. Best value: 0.402799:  58%|█████▊    | 58/100 [03:28<02:32,  3.62s/it]Best trial: 22. Best value: 0.402799:  59%|█████▉    | 59/100 [03:28<02:33,  3.75s/it]Best trial: 22. Best value: 0.402799:  59%|█████▉    | 59/100 [03:33<02:33,  3.75s/it]Best trial: 22. Best value: 0.402799:  60%|██████    | 60/100 [03:33<02:42,  4.07s/it]Best trial: 22. Best value: 0.402799:  60%|██████    | 60/100 [03:36<02:42,  4.07s/it]Best trial: 22. Best value: 0.402799:  61%|██████    | 61/100 [03:36<02:34,  3.96s/it]Best trial: 22. Best value: 0.402799:  61%|██████    | 61/100 [03:41<02:34,  3.96s/it]Best trial: 22. Best value: 0.402799:  62%|██████▏   | 62/100 [03:41<02:40,  4.23s/it]Best trial: 22. Best value: 0.402799:  62%|██████▏   | 62/100 [03:45<02:40,  4.23s/it]Best trial: 22. Best value: 0.402799:  63%|██████▎   | 63/100 [03:45<02:30,  4.07s/it]Best trial: 22. Best value: 0.402799:  63%|██████▎   | 63/100 [03:49<02:30,  4.07s/it]Best trial: 22. Best value: 0.402799:  64%|██████▍   | 64/100 [03:49<02:22,  3.95s/it]Best trial: 22. Best value: 0.402799:  64%|██████▍   | 64/100 [03:53<02:22,  3.95s/it]Best trial: 22. Best value: 0.402799:  65%|██████▌   | 65/100 [03:53<02:24,  4.13s/it]Best trial: 22. Best value: 0.402799:  65%|██████▌   | 65/100 [03:58<02:24,  4.13s/it]Best trial: 22. Best value: 0.402799:  66%|██████▌   | 66/100 [03:58<02:31,  4.47s/it]Best trial: 22. Best value: 0.402799:  66%|██████▌   | 66/100 [04:02<02:31,  4.47s/it]Best trial: 22. Best value: 0.402799:  67%|██████▋   | 67/100 [04:02<02:16,  4.12s/it]Best trial: 22. Best value: 0.402799:  67%|██████▋   | 67/100 [04:06<02:16,  4.12s/it]Best trial: 22. Best value: 0.402799:  68%|██████▊   | 68/100 [04:06<02:11,  4.10s/it]Best trial: 22. Best value: 0.402799:  68%|██████▊   | 68/100 [04:10<02:11,  4.10s/it]Best trial: 22. Best value: 0.402799:  69%|██████▉   | 69/100 [04:10<02:06,  4.07s/it]Best trial: 22. Best value: 0.402799:  69%|██████▉   | 69/100 [04:13<02:06,  4.07s/it]Best trial: 22. Best value: 0.402799:  70%|███████   | 70/100 [04:13<01:53,  3.77s/it]Best trial: 22. Best value: 0.402799:  70%|███████   | 70/100 [04:16<01:53,  3.77s/it]Best trial: 22. Best value: 0.402799:  71%|███████   | 71/100 [04:16<01:48,  3.73s/it]Best trial: 22. Best value: 0.402799:  71%|███████   | 71/100 [04:21<01:48,  3.73s/it]Best trial: 22. Best value: 0.402799:  72%|███████▏  | 72/100 [04:21<01:49,  3.92s/it]Best trial: 22. Best value: 0.402799:  72%|███████▏  | 72/100 [04:25<01:49,  3.92s/it]Best trial: 22. Best value: 0.402799:  73%|███████▎  | 73/100 [04:25<01:51,  4.12s/it]Best trial: 22. Best value: 0.402799:  73%|███████▎  | 73/100 [04:29<01:51,  4.12s/it]Best trial: 22. Best value: 0.402799:  74%|███████▍  | 74/100 [04:29<01:40,  3.85s/it]Best trial: 22. Best value: 0.402799:  74%|███████▍  | 74/100 [04:32<01:40,  3.85s/it]Best trial: 22. Best value: 0.402799:  75%|███████▌  | 75/100 [04:32<01:36,  3.85s/it]Best trial: 22. Best value: 0.402799:  75%|███████▌  | 75/100 [04:36<01:36,  3.85s/it]Best trial: 22. Best value: 0.402799:  76%|███████▌  | 76/100 [04:36<01:28,  3.67s/it]Best trial: 22. Best value: 0.402799:  76%|███████▌  | 76/100 [04:39<01:28,  3.67s/it]Best trial: 22. Best value: 0.402799:  77%|███████▋  | 77/100 [04:39<01:19,  3.47s/it]Best trial: 22. Best value: 0.402799:  77%|███████▋  | 77/100 [04:42<01:19,  3.47s/it]Best trial: 22. Best value: 0.402799:  78%|███████▊  | 78/100 [04:42<01:14,  3.40s/it]Best trial: 22. Best value: 0.402799:  78%|███████▊  | 78/100 [04:46<01:14,  3.40s/it]Best trial: 22. Best value: 0.402799:  79%|███████▉  | 79/100 [04:46<01:15,  3.59s/it]Best trial: 22. Best value: 0.402799:  79%|███████▉  | 79/100 [04:50<01:15,  3.59s/it]Best trial: 22. Best value: 0.402799:  80%|████████  | 80/100 [04:50<01:17,  3.85s/it]Best trial: 22. Best value: 0.402799:  80%|████████  | 80/100 [04:53<01:17,  3.85s/it]Best trial: 22. Best value: 0.402799:  81%|████████  | 81/100 [04:53<01:07,  3.55s/it]Best trial: 22. Best value: 0.402799:  81%|████████  | 81/100 [04:58<01:07,  3.55s/it]Best trial: 22. Best value: 0.402799:  82%|████████▏ | 82/100 [04:58<01:07,  3.76s/it]Best trial: 22. Best value: 0.402799:  82%|████████▏ | 82/100 [05:01<01:07,  3.76s/it]Best trial: 22. Best value: 0.402799:  83%|████████▎ | 83/100 [05:01<01:02,  3.69s/it]Best trial: 22. Best value: 0.402799:  83%|████████▎ | 83/100 [05:07<01:02,  3.69s/it]Best trial: 22. Best value: 0.402799:  84%|████████▍ | 84/100 [05:07<01:08,  4.30s/it]Best trial: 22. Best value: 0.402799:  84%|████████▍ | 84/100 [05:11<01:08,  4.30s/it]Best trial: 22. Best value: 0.402799:  85%|████████▌ | 85/100 [05:11<01:02,  4.19s/it]Best trial: 22. Best value: 0.402799:  85%|████████▌ | 85/100 [05:16<01:02,  4.19s/it]Best trial: 22. Best value: 0.402799:  86%|████████▌ | 86/100 [05:16<01:02,  4.47s/it]Best trial: 22. Best value: 0.402799:  86%|████████▌ | 86/100 [05:21<01:02,  4.47s/it]Best trial: 22. Best value: 0.402799:  87%|████████▋ | 87/100 [05:21<01:01,  4.70s/it]Best trial: 22. Best value: 0.402799:  87%|████████▋ | 87/100 [05:24<01:01,  4.70s/it]Best trial: 22. Best value: 0.402799:  88%|████████▊ | 88/100 [05:24<00:48,  4.07s/it]Best trial: 22. Best value: 0.402799:  88%|████████▊ | 88/100 [05:26<00:48,  4.07s/it]Best trial: 22. Best value: 0.402799:  89%|████████▉ | 89/100 [05:26<00:40,  3.66s/it]Best trial: 89. Best value: 0.40483:  89%|████████▉ | 89/100 [05:30<00:40,  3.66s/it] Best trial: 89. Best value: 0.40483:  90%|█████████ | 90/100 [05:30<00:37,  3.75s/it]Best trial: 89. Best value: 0.40483:  90%|█████████ | 90/100 [05:34<00:37,  3.75s/it]Best trial: 89. Best value: 0.40483:  91%|█████████ | 91/100 [05:34<00:32,  3.62s/it]Best trial: 89. Best value: 0.40483:  91%|█████████ | 91/100 [05:37<00:32,  3.62s/it]Best trial: 89. Best value: 0.40483:  92%|█████████▏| 92/100 [05:37<00:27,  3.41s/it]Best trial: 89. Best value: 0.40483:  92%|█████████▏| 92/100 [05:40<00:27,  3.41s/it]Best trial: 89. Best value: 0.40483:  93%|█████████▎| 93/100 [05:40<00:24,  3.48s/it]Best trial: 89. Best value: 0.40483:  93%|█████████▎| 93/100 [05:44<00:24,  3.48s/it]Best trial: 89. Best value: 0.40483:  94%|█████████▍| 94/100 [05:44<00:21,  3.54s/it]Best trial: 89. Best value: 0.40483:  94%|█████████▍| 94/100 [05:47<00:21,  3.54s/it]Best trial: 89. Best value: 0.40483:  95%|█████████▌| 95/100 [05:47<00:16,  3.40s/it]Best trial: 89. Best value: 0.40483:  95%|█████████▌| 95/100 [05:50<00:16,  3.40s/it]Best trial: 89. Best value: 0.40483:  96%|█████████▌| 96/100 [05:50<00:13,  3.29s/it]Best trial: 89. Best value: 0.40483:  96%|█████████▌| 96/100 [05:53<00:13,  3.29s/it]Best trial: 89. Best value: 0.40483:  97%|█████████▋| 97/100 [05:53<00:09,  3.26s/it]Best trial: 89. Best value: 0.40483:  97%|█████████▋| 97/100 [05:57<00:09,  3.26s/it]Best trial: 89. Best value: 0.40483:  98%|█████████▊| 98/100 [05:57<00:06,  3.38s/it]Best trial: 89. Best value: 0.40483:  98%|█████████▊| 98/100 [06:00<00:06,  3.38s/it]Best trial: 89. Best value: 0.40483:  99%|█████████▉| 99/100 [06:00<00:03,  3.34s/it]Best trial: 89. Best value: 0.40483:  99%|█████████▉| 99/100 [06:04<00:03,  3.34s/it]Best trial: 89. Best value: 0.40483: 100%|██████████| 100/100 [06:04<00:00,  3.40s/it]Best trial: 89. Best value: 0.40483: 100%|██████████| 100/100 [06:04<00:00,  3.64s/it]
2025-11-30 13:51:31,015 - INFO - HPO Complete. Best AUPRC: 0.4048
2025-11-30 13:51:31,015 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0513322529889838, 'max_depth': 5, 'subsample': 0.9210088247730271, 'colsample_bytree': 0.8832631612297385, 'gamma': 3.0259175699407814, 'reg_lambda': 1.2016209885599494e-05, 'reg_alpha': 0.00026565252689970004}
2025-11-30 13:51:31,016 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:51:33,201 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 13:51:33,201 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:51:33,445 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:51:33,481 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:51:33,490 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:51:33,490 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:51:33,490 - INFO - Training model...
2025-11-30 13:51:34,796 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:51:40,335 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:51:40,335 - INFO - AUROC: 0.7513 (0.6339 - 0.8460)
2025-11-30 13:51:40,335 - INFO - AUPRC: 0.1227 (0.0183 - 0.4000)
2025-11-30 13:51:40,335 - INFO - Brier Score: 0.0159 (0.0103 - 0.0262)
2025-11-30 13:51:40,335 - INFO - Accuracy: 0.9783 (0.8633 - 0.9913)
2025-11-30 13:51:40,335 - INFO - Precision: 0.2727 (0.0086 - 1.0000)
2025-11-30 13:51:40,335 - INFO - Sensitivity (Recall): 0.3000 (0.0500 - 0.5000)
2025-11-30 13:51:40,335 - INFO - F1-Score: 0.2857 (0.0156 - 0.5333)
2025-11-30 13:51:40,336 - INFO - Best Threshold: 0.2100 (0.0160 - 0.8400)
2025-11-30 13:51:40,336 - INFO - Specificity: 0.9883 (0.8717 - 1.0000)
2025-11-30 13:51:40,344 - INFO - Calculating SHAP values...
2025-11-30 13:51:41,379 - INFO - SHAP plots saved.
2025-11-30 13:51:41,380 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:51:42,589 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 13:51:42,589 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:51:42,784 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:51:42,820 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:51:42,828 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:51:42,828 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.333651:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.333651:   1%|          | 1/100 [00:03<06:04,  3.68s/it]Best trial: 0. Best value: 0.333651:   1%|          | 1/100 [00:06<06:04,  3.68s/it]Best trial: 0. Best value: 0.333651:   2%|▏         | 2/100 [00:06<05:31,  3.39s/it]Best trial: 0. Best value: 0.333651:   2%|▏         | 2/100 [00:09<05:31,  3.39s/it]Best trial: 0. Best value: 0.333651:   3%|▎         | 3/100 [00:09<05:15,  3.25s/it]Best trial: 0. Best value: 0.333651:   3%|▎         | 3/100 [00:13<05:15,  3.25s/it]Best trial: 0. Best value: 0.333651:   4%|▍         | 4/100 [00:13<05:35,  3.50s/it]Best trial: 0. Best value: 0.333651:   4%|▍         | 4/100 [00:16<05:35,  3.50s/it]Best trial: 0. Best value: 0.333651:   5%|▌         | 5/100 [00:16<05:03,  3.20s/it]Best trial: 5. Best value: 0.400353:   5%|▌         | 5/100 [00:21<05:03,  3.20s/it]Best trial: 5. Best value: 0.400353:   6%|▌         | 6/100 [00:21<06:06,  3.90s/it]Best trial: 5. Best value: 0.400353:   6%|▌         | 6/100 [00:24<06:06,  3.90s/it]Best trial: 5. Best value: 0.400353:   7%|▋         | 7/100 [00:24<05:30,  3.56s/it]Best trial: 5. Best value: 0.400353:   7%|▋         | 7/100 [00:26<05:30,  3.56s/it]Best trial: 5. Best value: 0.400353:   8%|▊         | 8/100 [00:26<04:50,  3.16s/it]Best trial: 5. Best value: 0.400353:   8%|▊         | 8/100 [00:30<04:50,  3.16s/it]Best trial: 5. Best value: 0.400353:   9%|▉         | 9/100 [00:30<04:52,  3.22s/it]Best trial: 5. Best value: 0.400353:   9%|▉         | 9/100 [00:33<04:52,  3.22s/it]Best trial: 5. Best value: 0.400353:  10%|█         | 10/100 [00:33<04:43,  3.15s/it]Best trial: 5. Best value: 0.400353:  10%|█         | 10/100 [00:35<04:43,  3.15s/it]Best trial: 5. Best value: 0.400353:  11%|█         | 11/100 [00:35<04:14,  2.86s/it]Best trial: 5. Best value: 0.400353:  11%|█         | 11/100 [00:38<04:14,  2.86s/it]Best trial: 5. Best value: 0.400353:  12%|█▏        | 12/100 [00:38<04:15,  2.90s/it]Best trial: 5. Best value: 0.400353:  12%|█▏        | 12/100 [00:41<04:15,  2.90s/it]Best trial: 5. Best value: 0.400353:  13%|█▎        | 13/100 [00:41<04:25,  3.05s/it]Best trial: 5. Best value: 0.400353:  13%|█▎        | 13/100 [00:45<04:25,  3.05s/it]Best trial: 5. Best value: 0.400353:  14%|█▍        | 14/100 [00:45<04:41,  3.28s/it]Best trial: 5. Best value: 0.400353:  14%|█▍        | 14/100 [00:49<04:41,  3.28s/it]Best trial: 5. Best value: 0.400353:  15%|█▌        | 15/100 [00:49<04:41,  3.31s/it]Best trial: 5. Best value: 0.400353:  15%|█▌        | 15/100 [00:51<04:41,  3.31s/it]Best trial: 5. Best value: 0.400353:  16%|█▌        | 16/100 [00:51<04:23,  3.14s/it]Best trial: 5. Best value: 0.400353:  16%|█▌        | 16/100 [00:55<04:23,  3.14s/it]Best trial: 5. Best value: 0.400353:  17%|█▋        | 17/100 [00:55<04:26,  3.21s/it]Best trial: 5. Best value: 0.400353:  17%|█▋        | 17/100 [00:58<04:26,  3.21s/it]Best trial: 5. Best value: 0.400353:  18%|█▊        | 18/100 [00:58<04:22,  3.20s/it]Best trial: 5. Best value: 0.400353:  18%|█▊        | 18/100 [01:01<04:22,  3.20s/it]Best trial: 5. Best value: 0.400353:  19%|█▉        | 19/100 [01:01<04:18,  3.19s/it]Best trial: 5. Best value: 0.400353:  19%|█▉        | 19/100 [01:05<04:18,  3.19s/it]Best trial: 5. Best value: 0.400353:  20%|██        | 20/100 [01:05<04:30,  3.38s/it]Best trial: 5. Best value: 0.400353:  20%|██        | 20/100 [01:09<04:30,  3.38s/it]Best trial: 5. Best value: 0.400353:  21%|██        | 21/100 [01:09<04:44,  3.60s/it]Best trial: 5. Best value: 0.400353:  21%|██        | 21/100 [01:16<04:44,  3.60s/it]Best trial: 5. Best value: 0.400353:  22%|██▏       | 22/100 [01:16<05:56,  4.57s/it]Best trial: 5. Best value: 0.400353:  22%|██▏       | 22/100 [01:21<05:56,  4.57s/it]Best trial: 5. Best value: 0.400353:  23%|██▎       | 23/100 [01:21<06:01,  4.70s/it]Best trial: 5. Best value: 0.400353:  23%|██▎       | 23/100 [01:27<06:01,  4.70s/it]Best trial: 5. Best value: 0.400353:  24%|██▍       | 24/100 [01:27<06:31,  5.15s/it]Best trial: 5. Best value: 0.400353:  24%|██▍       | 24/100 [01:32<06:31,  5.15s/it]Best trial: 5. Best value: 0.400353:  25%|██▌       | 25/100 [01:32<06:34,  5.26s/it]Best trial: 25. Best value: 0.430816:  25%|██▌       | 25/100 [01:36<06:34,  5.26s/it]Best trial: 25. Best value: 0.430816:  26%|██▌       | 26/100 [01:36<05:46,  4.69s/it]Best trial: 25. Best value: 0.430816:  26%|██▌       | 26/100 [01:39<05:46,  4.69s/it]Best trial: 25. Best value: 0.430816:  27%|██▋       | 27/100 [01:39<05:07,  4.22s/it]Best trial: 25. Best value: 0.430816:  27%|██▋       | 27/100 [01:43<05:07,  4.22s/it]Best trial: 25. Best value: 0.430816:  28%|██▊       | 28/100 [01:43<04:52,  4.07s/it]Best trial: 25. Best value: 0.430816:  28%|██▊       | 28/100 [01:48<04:52,  4.07s/it]Best trial: 25. Best value: 0.430816:  29%|██▉       | 29/100 [01:48<05:09,  4.36s/it]Best trial: 25. Best value: 0.430816:  29%|██▉       | 29/100 [01:52<05:09,  4.36s/it]Best trial: 25. Best value: 0.430816:  30%|███       | 30/100 [01:52<05:12,  4.46s/it]Best trial: 25. Best value: 0.430816:  30%|███       | 30/100 [01:58<05:12,  4.46s/it]Best trial: 25. Best value: 0.430816:  31%|███       | 31/100 [01:58<05:33,  4.84s/it]Best trial: 25. Best value: 0.430816:  31%|███       | 31/100 [02:02<05:33,  4.84s/it]Best trial: 25. Best value: 0.430816:  32%|███▏      | 32/100 [02:02<05:06,  4.51s/it]Best trial: 25. Best value: 0.430816:  32%|███▏      | 32/100 [02:06<05:06,  4.51s/it]Best trial: 25. Best value: 0.430816:  33%|███▎      | 33/100 [02:06<04:58,  4.45s/it]Best trial: 25. Best value: 0.430816:  33%|███▎      | 33/100 [02:09<04:58,  4.45s/it]Best trial: 25. Best value: 0.430816:  34%|███▍      | 34/100 [02:09<04:29,  4.09s/it]Best trial: 25. Best value: 0.430816:  34%|███▍      | 34/100 [02:15<04:29,  4.09s/it]Best trial: 25. Best value: 0.430816:  35%|███▌      | 35/100 [02:15<05:00,  4.62s/it]Best trial: 25. Best value: 0.430816:  35%|███▌      | 35/100 [02:22<05:00,  4.62s/it]Best trial: 25. Best value: 0.430816:  36%|███▌      | 36/100 [02:22<05:29,  5.15s/it]Best trial: 25. Best value: 0.430816:  36%|███▌      | 36/100 [02:26<05:29,  5.15s/it]Best trial: 25. Best value: 0.430816:  37%|███▋      | 37/100 [02:26<05:15,  5.01s/it]Best trial: 25. Best value: 0.430816:  37%|███▋      | 37/100 [02:29<05:15,  5.01s/it]Best trial: 25. Best value: 0.430816:  38%|███▊      | 38/100 [02:29<04:30,  4.37s/it]Best trial: 25. Best value: 0.430816:  38%|███▊      | 38/100 [02:34<04:30,  4.37s/it]Best trial: 25. Best value: 0.430816:  39%|███▉      | 39/100 [02:34<04:32,  4.47s/it]Best trial: 25. Best value: 0.430816:  39%|███▉      | 39/100 [02:37<04:32,  4.47s/it]Best trial: 25. Best value: 0.430816:  40%|████      | 40/100 [02:37<03:58,  3.98s/it]Best trial: 25. Best value: 0.430816:  40%|████      | 40/100 [02:42<03:58,  3.98s/it]Best trial: 25. Best value: 0.430816:  41%|████      | 41/100 [02:42<04:09,  4.22s/it]Best trial: 25. Best value: 0.430816:  41%|████      | 41/100 [02:45<04:09,  4.22s/it]Best trial: 25. Best value: 0.430816:  42%|████▏     | 42/100 [02:45<03:56,  4.08s/it]Best trial: 42. Best value: 0.433581:  42%|████▏     | 42/100 [02:50<03:56,  4.08s/it]Best trial: 42. Best value: 0.433581:  43%|████▎     | 43/100 [02:50<03:57,  4.17s/it]Best trial: 42. Best value: 0.433581:  43%|████▎     | 43/100 [02:56<03:57,  4.17s/it]Best trial: 42. Best value: 0.433581:  44%|████▍     | 44/100 [02:56<04:35,  4.93s/it]Best trial: 42. Best value: 0.433581:  44%|████▍     | 44/100 [03:01<04:35,  4.93s/it]Best trial: 42. Best value: 0.433581:  45%|████▌     | 45/100 [03:01<04:18,  4.71s/it]Best trial: 42. Best value: 0.433581:  45%|████▌     | 45/100 [03:06<04:18,  4.71s/it]Best trial: 42. Best value: 0.433581:  46%|████▌     | 46/100 [03:06<04:26,  4.94s/it]Best trial: 42. Best value: 0.433581:  46%|████▌     | 46/100 [03:10<04:26,  4.94s/it]Best trial: 42. Best value: 0.433581:  47%|████▋     | 47/100 [03:10<04:08,  4.69s/it]Best trial: 47. Best value: 0.450003:  47%|████▋     | 47/100 [03:16<04:08,  4.69s/it]Best trial: 47. Best value: 0.450003:  48%|████▊     | 48/100 [03:16<04:27,  5.15s/it]Best trial: 47. Best value: 0.450003:  48%|████▊     | 48/100 [03:23<04:27,  5.15s/it]Best trial: 47. Best value: 0.450003:  49%|████▉     | 49/100 [03:23<04:37,  5.44s/it]Best trial: 47. Best value: 0.450003:  49%|████▉     | 49/100 [03:26<04:37,  5.44s/it]Best trial: 47. Best value: 0.450003:  50%|█████     | 50/100 [03:26<04:08,  4.97s/it]Best trial: 47. Best value: 0.450003:  50%|█████     | 50/100 [03:30<04:08,  4.97s/it]Best trial: 47. Best value: 0.450003:  51%|█████     | 51/100 [03:30<03:49,  4.68s/it]Best trial: 47. Best value: 0.450003:  51%|█████     | 51/100 [03:34<03:49,  4.68s/it]Best trial: 47. Best value: 0.450003:  52%|█████▏    | 52/100 [03:34<03:34,  4.47s/it]Best trial: 47. Best value: 0.450003:  52%|█████▏    | 52/100 [03:39<03:34,  4.47s/it]Best trial: 47. Best value: 0.450003:  53%|█████▎    | 53/100 [03:39<03:29,  4.45s/it]Best trial: 47. Best value: 0.450003:  53%|█████▎    | 53/100 [03:43<03:29,  4.45s/it]Best trial: 47. Best value: 0.450003:  54%|█████▍    | 54/100 [03:43<03:18,  4.30s/it]Best trial: 47. Best value: 0.450003:  54%|█████▍    | 54/100 [03:48<03:18,  4.30s/it]Best trial: 47. Best value: 0.450003:  55%|█████▌    | 55/100 [03:48<03:21,  4.47s/it]Best trial: 47. Best value: 0.450003:  55%|█████▌    | 55/100 [03:53<03:21,  4.47s/it]Best trial: 47. Best value: 0.450003:  56%|█████▌    | 56/100 [03:53<03:23,  4.63s/it]Best trial: 47. Best value: 0.450003:  56%|█████▌    | 56/100 [03:58<03:23,  4.63s/it]Best trial: 47. Best value: 0.450003:  57%|█████▋    | 57/100 [03:58<03:27,  4.82s/it]Best trial: 47. Best value: 0.450003:  57%|█████▋    | 57/100 [04:02<03:27,  4.82s/it]Best trial: 47. Best value: 0.450003:  58%|█████▊    | 58/100 [04:02<03:14,  4.62s/it]Best trial: 47. Best value: 0.450003:  58%|█████▊    | 58/100 [04:08<03:14,  4.62s/it]Best trial: 47. Best value: 0.450003:  59%|█████▉    | 59/100 [04:08<03:22,  4.93s/it]Best trial: 47. Best value: 0.450003:  59%|█████▉    | 59/100 [04:11<03:22,  4.93s/it]Best trial: 47. Best value: 0.450003:  60%|██████    | 60/100 [04:11<02:55,  4.40s/it]Best trial: 47. Best value: 0.450003:  60%|██████    | 60/100 [04:14<02:55,  4.40s/it]Best trial: 47. Best value: 0.450003:  61%|██████    | 61/100 [04:14<02:40,  4.11s/it]Best trial: 47. Best value: 0.450003:  61%|██████    | 61/100 [04:20<02:40,  4.11s/it]Best trial: 47. Best value: 0.450003:  62%|██████▏   | 62/100 [04:20<02:52,  4.54s/it]Best trial: 47. Best value: 0.450003:  62%|██████▏   | 62/100 [04:26<02:52,  4.54s/it]Best trial: 47. Best value: 0.450003:  63%|██████▎   | 63/100 [04:26<03:01,  4.91s/it]Best trial: 47. Best value: 0.450003:  63%|██████▎   | 63/100 [04:31<03:01,  4.91s/it]Best trial: 47. Best value: 0.450003:  64%|██████▍   | 64/100 [04:31<02:57,  4.94s/it]Best trial: 47. Best value: 0.450003:  64%|██████▍   | 64/100 [04:36<02:57,  4.94s/it]Best trial: 47. Best value: 0.450003:  65%|██████▌   | 65/100 [04:36<02:58,  5.10s/it]Best trial: 47. Best value: 0.450003:  65%|██████▌   | 65/100 [04:39<02:58,  5.10s/it]Best trial: 47. Best value: 0.450003:  66%|██████▌   | 66/100 [04:39<02:28,  4.37s/it]Best trial: 47. Best value: 0.450003:  66%|██████▌   | 66/100 [04:48<02:28,  4.37s/it]Best trial: 47. Best value: 0.450003:  67%|██████▋   | 67/100 [04:48<03:08,  5.72s/it]Best trial: 67. Best value: 0.453363:  67%|██████▋   | 67/100 [04:59<03:08,  5.72s/it]Best trial: 67. Best value: 0.453363:  68%|██████▊   | 68/100 [04:59<03:58,  7.44s/it]Best trial: 67. Best value: 0.453363:  68%|██████▊   | 68/100 [05:06<03:58,  7.44s/it]Best trial: 67. Best value: 0.453363:  69%|██████▉   | 69/100 [05:06<03:45,  7.26s/it]Best trial: 67. Best value: 0.453363:  69%|██████▉   | 69/100 [05:10<03:45,  7.26s/it]Best trial: 67. Best value: 0.453363:  70%|███████   | 70/100 [05:10<03:07,  6.26s/it]Best trial: 67. Best value: 0.453363:  70%|███████   | 70/100 [05:15<03:07,  6.26s/it]Best trial: 67. Best value: 0.453363:  71%|███████   | 71/100 [05:15<02:50,  5.88s/it]Best trial: 67. Best value: 0.453363:  71%|███████   | 71/100 [05:20<02:50,  5.88s/it]Best trial: 67. Best value: 0.453363:  72%|███████▏  | 72/100 [05:20<02:42,  5.80s/it]Best trial: 67. Best value: 0.453363:  72%|███████▏  | 72/100 [05:24<02:42,  5.80s/it]Best trial: 67. Best value: 0.453363:  73%|███████▎  | 73/100 [05:24<02:20,  5.22s/it]Best trial: 67. Best value: 0.453363:  73%|███████▎  | 73/100 [05:31<02:20,  5.22s/it]Best trial: 67. Best value: 0.453363:  74%|███████▍  | 74/100 [05:31<02:23,  5.52s/it]Best trial: 67. Best value: 0.453363:  74%|███████▍  | 74/100 [05:36<02:23,  5.52s/it]Best trial: 67. Best value: 0.453363:  75%|███████▌  | 75/100 [05:36<02:20,  5.62s/it]Best trial: 67. Best value: 0.453363:  75%|███████▌  | 75/100 [05:41<02:20,  5.62s/it]Best trial: 67. Best value: 0.453363:  76%|███████▌  | 76/100 [05:41<02:08,  5.35s/it]Best trial: 67. Best value: 0.453363:  76%|███████▌  | 76/100 [05:45<02:08,  5.35s/it]Best trial: 67. Best value: 0.453363:  77%|███████▋  | 77/100 [05:45<01:56,  5.05s/it]Best trial: 67. Best value: 0.453363:  77%|███████▋  | 77/100 [05:51<01:56,  5.05s/it]Best trial: 67. Best value: 0.453363:  78%|███████▊  | 78/100 [05:51<01:51,  5.05s/it]Best trial: 78. Best value: 0.494236:  78%|███████▊  | 78/100 [05:55<01:51,  5.05s/it]Best trial: 78. Best value: 0.494236:  79%|███████▉  | 79/100 [05:55<01:42,  4.90s/it]Best trial: 78. Best value: 0.494236:  79%|███████▉  | 79/100 [06:02<01:42,  4.90s/it]Best trial: 78. Best value: 0.494236:  80%|████████  | 80/100 [06:02<01:50,  5.51s/it]Best trial: 78. Best value: 0.494236:  80%|████████  | 80/100 [06:06<01:50,  5.51s/it]Best trial: 78. Best value: 0.494236:  81%|████████  | 81/100 [06:06<01:33,  4.93s/it]Best trial: 78. Best value: 0.494236:  81%|████████  | 81/100 [06:10<01:33,  4.93s/it]Best trial: 78. Best value: 0.494236:  82%|████████▏ | 82/100 [06:10<01:28,  4.90s/it]Best trial: 78. Best value: 0.494236:  82%|████████▏ | 82/100 [06:14<01:28,  4.90s/it]Best trial: 78. Best value: 0.494236:  83%|████████▎ | 83/100 [06:14<01:19,  4.66s/it]Best trial: 78. Best value: 0.494236:  83%|████████▎ | 83/100 [06:19<01:19,  4.66s/it]Best trial: 78. Best value: 0.494236:  84%|████████▍ | 84/100 [06:19<01:12,  4.54s/it]Best trial: 78. Best value: 0.494236:  84%|████████▍ | 84/100 [06:24<01:12,  4.54s/it]Best trial: 78. Best value: 0.494236:  85%|████████▌ | 85/100 [06:24<01:12,  4.83s/it]Best trial: 78. Best value: 0.494236:  85%|████████▌ | 85/100 [06:28<01:12,  4.83s/it]Best trial: 78. Best value: 0.494236:  86%|████████▌ | 86/100 [06:28<01:03,  4.56s/it]Best trial: 78. Best value: 0.494236:  86%|████████▌ | 86/100 [06:33<01:03,  4.56s/it]Best trial: 78. Best value: 0.494236:  87%|████████▋ | 87/100 [06:33<01:00,  4.62s/it]Best trial: 87. Best value: 0.506246:  87%|████████▋ | 87/100 [06:37<01:00,  4.62s/it]Best trial: 87. Best value: 0.506246:  88%|████████▊ | 88/100 [06:37<00:54,  4.57s/it]Best trial: 87. Best value: 0.506246:  88%|████████▊ | 88/100 [06:41<00:54,  4.57s/it]Best trial: 87. Best value: 0.506246:  89%|████████▉ | 89/100 [06:41<00:48,  4.40s/it]Best trial: 87. Best value: 0.506246:  89%|████████▉ | 89/100 [06:46<00:48,  4.40s/it]Best trial: 87. Best value: 0.506246:  90%|█████████ | 90/100 [06:46<00:43,  4.33s/it]Best trial: 87. Best value: 0.506246:  90%|█████████ | 90/100 [06:50<00:43,  4.33s/it]Best trial: 87. Best value: 0.506246:  91%|█████████ | 91/100 [06:50<00:38,  4.24s/it]Best trial: 87. Best value: 0.506246:  91%|█████████ | 91/100 [06:54<00:38,  4.24s/it]Best trial: 87. Best value: 0.506246:  92%|█████████▏| 92/100 [06:54<00:35,  4.39s/it]Best trial: 87. Best value: 0.506246:  92%|█████████▏| 92/100 [06:59<00:35,  4.39s/it]Best trial: 87. Best value: 0.506246:  93%|█████████▎| 93/100 [06:59<00:30,  4.36s/it]Best trial: 87. Best value: 0.506246:  93%|█████████▎| 93/100 [07:03<00:30,  4.36s/it]Best trial: 87. Best value: 0.506246:  94%|█████████▍| 94/100 [07:03<00:25,  4.29s/it]Best trial: 87. Best value: 0.506246:  94%|█████████▍| 94/100 [07:06<00:25,  4.29s/it]Best trial: 87. Best value: 0.506246:  95%|█████████▌| 95/100 [07:06<00:20,  4.12s/it]Best trial: 87. Best value: 0.506246:  95%|█████████▌| 95/100 [07:10<00:20,  4.12s/it]Best trial: 87. Best value: 0.506246:  96%|█████████▌| 96/100 [07:10<00:15,  3.93s/it]Best trial: 87. Best value: 0.506246:  96%|█████████▌| 96/100 [07:14<00:15,  3.93s/it]Best trial: 87. Best value: 0.506246:  97%|█████████▋| 97/100 [07:14<00:11,  3.84s/it]Best trial: 87. Best value: 0.506246:  97%|█████████▋| 97/100 [07:18<00:11,  3.84s/it]Best trial: 87. Best value: 0.506246:  98%|█████████▊| 98/100 [07:18<00:07,  3.92s/it]Best trial: 87. Best value: 0.506246:  98%|█████████▊| 98/100 [07:22<00:07,  3.92s/it]Best trial: 87. Best value: 0.506246:  99%|█████████▉| 99/100 [07:22<00:04,  4.01s/it]Best trial: 87. Best value: 0.506246:  99%|█████████▉| 99/100 [07:26<00:04,  4.01s/it]Best trial: 87. Best value: 0.506246: 100%|██████████| 100/100 [07:26<00:00,  4.11s/it]Best trial: 87. Best value: 0.506246: 100%|██████████| 100/100 [07:26<00:00,  4.47s/it]
2025-11-30 13:59:09,587 - INFO - HPO Complete. Best AUPRC: 0.5062
2025-11-30 13:59:09,587 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.08506804389146146, 'max_depth': 10, 'subsample': 0.988973408354571, 'colsample_bytree': 0.6161220965445524, 'gamma': 0.2274018604933192, 'reg_lambda': 0.5037388412593834, 'reg_alpha': 7.405909945792003e-08}
2025-11-30 13:59:09,588 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 13:59:11,758 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 13:59:11,759 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:59:11,987 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:59:12,025 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:59:12,034 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 13:59:12,034 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 13:59:12,034 - INFO - Training model...
2025-11-30 13:59:13,401 - INFO - Evaluating model with bootstrapping...
2025-11-30 13:59:19,064 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 13:59:19,065 - INFO - AUROC: 0.7582 (0.5906 - 0.9102)
2025-11-30 13:59:19,065 - INFO - AUPRC: 0.1498 (0.0226 - 0.4766)
2025-11-30 13:59:19,065 - INFO - Brier Score: 0.0153 (0.0097 - 0.0263)
2025-11-30 13:59:19,065 - INFO - Accuracy: 0.9855 (0.9373 - 0.9931)
2025-11-30 13:59:19,065 - INFO - Precision: 0.5000 (0.0000 - 1.0000)
2025-11-30 13:59:19,065 - INFO - Sensitivity (Recall): 0.2000 (0.0000 - 0.5000)
2025-11-30 13:59:19,065 - INFO - F1-Score: 0.2857 (0.0000 - 0.6095)
2025-11-30 13:59:19,065 - INFO - Best Threshold: 0.4000 (0.0100 - 0.9800)
2025-11-30 13:59:19,065 - INFO - Specificity: 0.9971 (0.9474 - 1.0000)
2025-11-30 13:59:19,076 - INFO - Calculating SHAP values...
2025-11-30 13:59:20,201 - INFO - SHAP plots saved.
2025-11-30 13:59:20,203 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 13:59:21,598 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 13:59:21,598 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 13:59:21,805 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 13:59:21,870 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 13:59:21,882 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 13:59:21,882 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.225245:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.225245:   1%|          | 1/100 [00:05<09:25,  5.71s/it]Best trial: 1. Best value: 0.227623:   1%|          | 1/100 [00:12<09:25,  5.71s/it]Best trial: 1. Best value: 0.227623:   2%|▏         | 2/100 [00:12<10:07,  6.20s/it]Best trial: 1. Best value: 0.227623:   2%|▏         | 2/100 [00:21<10:07,  6.20s/it]Best trial: 1. Best value: 0.227623:   3%|▎         | 3/100 [00:21<12:30,  7.73s/it]Best trial: 3. Best value: 0.272838:   3%|▎         | 3/100 [00:28<12:30,  7.73s/it]Best trial: 3. Best value: 0.272838:   4%|▍         | 4/100 [00:28<11:55,  7.45s/it]Best trial: 3. Best value: 0.272838:   4%|▍         | 4/100 [00:34<11:55,  7.45s/it]Best trial: 3. Best value: 0.272838:   5%|▌         | 5/100 [00:34<10:57,  6.92s/it]Best trial: 3. Best value: 0.272838:   5%|▌         | 5/100 [00:40<10:57,  6.92s/it]Best trial: 3. Best value: 0.272838:   6%|▌         | 6/100 [00:40<10:04,  6.43s/it]Best trial: 3. Best value: 0.272838:   6%|▌         | 6/100 [00:47<10:04,  6.43s/it]Best trial: 3. Best value: 0.272838:   7%|▋         | 7/100 [00:47<10:27,  6.74s/it]Best trial: 3. Best value: 0.272838:   7%|▋         | 7/100 [00:54<10:27,  6.74s/it]Best trial: 3. Best value: 0.272838:   8%|▊         | 8/100 [00:54<10:14,  6.68s/it]Best trial: 3. Best value: 0.272838:   8%|▊         | 8/100 [01:03<10:14,  6.68s/it]Best trial: 3. Best value: 0.272838:   9%|▉         | 9/100 [01:03<11:24,  7.52s/it]Best trial: 3. Best value: 0.272838:   9%|▉         | 9/100 [01:14<11:24,  7.52s/it]Best trial: 3. Best value: 0.272838:  10%|█         | 10/100 [01:14<12:53,  8.60s/it]Best trial: 10. Best value: 0.368155:  10%|█         | 10/100 [01:20<12:53,  8.60s/it]Best trial: 10. Best value: 0.368155:  11%|█         | 11/100 [01:20<11:21,  7.66s/it]Best trial: 11. Best value: 0.377755:  11%|█         | 11/100 [01:24<11:21,  7.66s/it]Best trial: 11. Best value: 0.377755:  12%|█▏        | 12/100 [01:24<09:49,  6.70s/it]Best trial: 11. Best value: 0.377755:  12%|█▏        | 12/100 [01:29<09:49,  6.70s/it]Best trial: 11. Best value: 0.377755:  13%|█▎        | 13/100 [01:29<09:01,  6.23s/it]Best trial: 11. Best value: 0.377755:  13%|█▎        | 13/100 [01:34<09:01,  6.23s/it]Best trial: 11. Best value: 0.377755:  14%|█▍        | 14/100 [01:34<08:21,  5.83s/it]Best trial: 11. Best value: 0.377755:  14%|█▍        | 14/100 [01:39<08:21,  5.83s/it]Best trial: 11. Best value: 0.377755:  15%|█▌        | 15/100 [01:39<07:40,  5.42s/it]Best trial: 11. Best value: 0.377755:  15%|█▌        | 15/100 [01:47<07:40,  5.42s/it]Best trial: 11. Best value: 0.377755:  16%|█▌        | 16/100 [01:47<08:47,  6.28s/it]Best trial: 11. Best value: 0.377755:  16%|█▌        | 16/100 [01:52<08:47,  6.28s/it]Best trial: 11. Best value: 0.377755:  17%|█▋        | 17/100 [01:52<08:02,  5.81s/it]Best trial: 11. Best value: 0.377755:  17%|█▋        | 17/100 [01:58<08:02,  5.81s/it]Best trial: 11. Best value: 0.377755:  18%|█▊        | 18/100 [01:58<08:01,  5.87s/it]Best trial: 11. Best value: 0.377755:  18%|█▊        | 18/100 [02:03<08:01,  5.87s/it]Best trial: 11. Best value: 0.377755:  19%|█▉        | 19/100 [02:03<07:32,  5.59s/it]Best trial: 11. Best value: 0.377755:  19%|█▉        | 19/100 [02:10<07:32,  5.59s/it]Best trial: 11. Best value: 0.377755:  20%|██        | 20/100 [02:10<08:03,  6.05s/it]Best trial: 11. Best value: 0.377755:  20%|██        | 20/100 [02:15<08:03,  6.05s/it]Best trial: 11. Best value: 0.377755:  21%|██        | 21/100 [02:15<07:48,  5.93s/it]Best trial: 11. Best value: 0.377755:  21%|██        | 21/100 [02:20<07:48,  5.93s/it]Best trial: 11. Best value: 0.377755:  22%|██▏       | 22/100 [02:20<07:08,  5.50s/it]Best trial: 11. Best value: 0.377755:  22%|██▏       | 22/100 [02:24<07:08,  5.50s/it]Best trial: 11. Best value: 0.377755:  23%|██▎       | 23/100 [02:24<06:34,  5.13s/it]Best trial: 11. Best value: 0.377755:  23%|██▎       | 23/100 [02:30<06:34,  5.13s/it]Best trial: 11. Best value: 0.377755:  24%|██▍       | 24/100 [02:30<06:38,  5.24s/it]Best trial: 11. Best value: 0.377755:  24%|██▍       | 24/100 [02:35<06:38,  5.24s/it]Best trial: 11. Best value: 0.377755:  25%|██▌       | 25/100 [02:35<06:27,  5.16s/it]Best trial: 11. Best value: 0.377755:  25%|██▌       | 25/100 [02:40<06:27,  5.16s/it]Best trial: 11. Best value: 0.377755:  26%|██▌       | 26/100 [02:40<06:27,  5.23s/it]Best trial: 11. Best value: 0.377755:  26%|██▌       | 26/100 [02:47<06:27,  5.23s/it]Best trial: 11. Best value: 0.377755:  27%|██▋       | 27/100 [02:47<06:56,  5.71s/it]Best trial: 11. Best value: 0.377755:  27%|██▋       | 27/100 [02:53<06:56,  5.71s/it]Best trial: 11. Best value: 0.377755:  28%|██▊       | 28/100 [02:53<07:04,  5.89s/it]Best trial: 11. Best value: 0.377755:  28%|██▊       | 28/100 [02:58<07:04,  5.89s/it]Best trial: 11. Best value: 0.377755:  29%|██▉       | 29/100 [02:58<06:37,  5.60s/it]Best trial: 11. Best value: 0.377755:  29%|██▉       | 29/100 [03:04<06:37,  5.60s/it]Best trial: 11. Best value: 0.377755:  30%|███       | 30/100 [03:04<06:32,  5.60s/it]Best trial: 11. Best value: 0.377755:  30%|███       | 30/100 [03:08<06:32,  5.60s/it]Best trial: 11. Best value: 0.377755:  31%|███       | 31/100 [03:08<05:57,  5.19s/it]Best trial: 11. Best value: 0.377755:  31%|███       | 31/100 [03:13<05:57,  5.19s/it]Best trial: 11. Best value: 0.377755:  32%|███▏      | 32/100 [03:13<05:54,  5.21s/it]Best trial: 11. Best value: 0.377755:  32%|███▏      | 32/100 [03:18<05:54,  5.21s/it]Best trial: 11. Best value: 0.377755:  33%|███▎      | 33/100 [03:18<05:38,  5.05s/it]Best trial: 11. Best value: 0.377755:  33%|███▎      | 33/100 [03:23<05:38,  5.05s/it]Best trial: 11. Best value: 0.377755:  34%|███▍      | 34/100 [03:23<05:29,  5.00s/it]Best trial: 11. Best value: 0.377755:  34%|███▍      | 34/100 [03:27<05:29,  5.00s/it]Best trial: 11. Best value: 0.377755:  35%|███▌      | 35/100 [03:27<05:10,  4.77s/it]Best trial: 11. Best value: 0.377755:  35%|███▌      | 35/100 [03:32<05:10,  4.77s/it]Best trial: 11. Best value: 0.377755:  36%|███▌      | 36/100 [03:32<05:08,  4.82s/it]Best trial: 11. Best value: 0.377755:  36%|███▌      | 36/100 [03:37<05:08,  4.82s/it]Best trial: 11. Best value: 0.377755:  37%|███▋      | 37/100 [03:37<05:14,  4.99s/it]Best trial: 11. Best value: 0.377755:  37%|███▋      | 37/100 [03:45<05:14,  4.99s/it]Best trial: 11. Best value: 0.377755:  38%|███▊      | 38/100 [03:45<05:55,  5.73s/it]Best trial: 11. Best value: 0.377755:  38%|███▊      | 38/100 [03:52<05:55,  5.73s/it]Best trial: 11. Best value: 0.377755:  39%|███▉      | 39/100 [03:52<06:24,  6.31s/it]Best trial: 11. Best value: 0.377755:  39%|███▉      | 39/100 [03:58<06:24,  6.31s/it]Best trial: 11. Best value: 0.377755:  40%|████      | 40/100 [03:58<06:04,  6.07s/it]Best trial: 11. Best value: 0.377755:  40%|████      | 40/100 [04:03<06:04,  6.07s/it]Best trial: 11. Best value: 0.377755:  41%|████      | 41/100 [04:03<05:45,  5.86s/it]Best trial: 11. Best value: 0.377755:  41%|████      | 41/100 [04:08<05:45,  5.86s/it]Best trial: 11. Best value: 0.377755:  42%|████▏     | 42/100 [04:08<05:19,  5.50s/it]Best trial: 11. Best value: 0.377755:  42%|████▏     | 42/100 [04:13<05:19,  5.50s/it]Best trial: 11. Best value: 0.377755:  43%|████▎     | 43/100 [04:13<05:13,  5.51s/it]Best trial: 11. Best value: 0.377755:  43%|████▎     | 43/100 [04:18<05:13,  5.51s/it]Best trial: 11. Best value: 0.377755:  44%|████▍     | 44/100 [04:18<04:50,  5.19s/it]Best trial: 11. Best value: 0.377755:  44%|████▍     | 44/100 [04:24<04:50,  5.19s/it]Best trial: 11. Best value: 0.377755:  45%|████▌     | 45/100 [04:24<04:52,  5.31s/it]Best trial: 11. Best value: 0.377755:  45%|████▌     | 45/100 [04:27<04:52,  5.31s/it]Best trial: 11. Best value: 0.377755:  46%|████▌     | 46/100 [04:27<04:23,  4.87s/it]Best trial: 11. Best value: 0.377755:  46%|████▌     | 46/100 [04:34<04:23,  4.87s/it]Best trial: 11. Best value: 0.377755:  47%|████▋     | 47/100 [04:34<04:40,  5.29s/it]Best trial: 11. Best value: 0.377755:  47%|████▋     | 47/100 [04:40<04:40,  5.29s/it]Best trial: 11. Best value: 0.377755:  48%|████▊     | 48/100 [04:40<04:51,  5.61s/it]Best trial: 11. Best value: 0.377755:  48%|████▊     | 48/100 [04:46<04:51,  5.61s/it]Best trial: 11. Best value: 0.377755:  49%|████▉     | 49/100 [04:46<04:46,  5.62s/it]Best trial: 11. Best value: 0.377755:  49%|████▉     | 49/100 [04:52<04:46,  5.62s/it]Best trial: 11. Best value: 0.377755:  50%|█████     | 50/100 [04:52<04:45,  5.71s/it]Best trial: 11. Best value: 0.377755:  50%|█████     | 50/100 [04:57<04:45,  5.71s/it]Best trial: 11. Best value: 0.377755:  51%|█████     | 51/100 [04:57<04:37,  5.66s/it]Best trial: 11. Best value: 0.377755:  51%|█████     | 51/100 [05:02<04:37,  5.66s/it]Best trial: 11. Best value: 0.377755:  52%|█████▏    | 52/100 [05:02<04:26,  5.55s/it]Best trial: 11. Best value: 0.377755:  52%|█████▏    | 52/100 [05:08<04:26,  5.55s/it]Best trial: 11. Best value: 0.377755:  53%|█████▎    | 53/100 [05:08<04:17,  5.47s/it]Best trial: 11. Best value: 0.377755:  53%|█████▎    | 53/100 [05:12<04:17,  5.47s/it]Best trial: 11. Best value: 0.377755:  54%|█████▍    | 54/100 [05:12<04:02,  5.26s/it]Best trial: 11. Best value: 0.377755:  54%|█████▍    | 54/100 [05:17<04:02,  5.26s/it]Best trial: 11. Best value: 0.377755:  55%|█████▌    | 55/100 [05:17<03:41,  4.93s/it]Best trial: 11. Best value: 0.377755:  55%|█████▌    | 55/100 [05:23<03:41,  4.93s/it]Best trial: 11. Best value: 0.377755:  56%|█████▌    | 56/100 [05:23<03:58,  5.42s/it]Best trial: 56. Best value: 0.379357:  56%|█████▌    | 56/100 [05:29<03:58,  5.42s/it]Best trial: 56. Best value: 0.379357:  57%|█████▋    | 57/100 [05:29<04:02,  5.63s/it]Best trial: 56. Best value: 0.379357:  57%|█████▋    | 57/100 [05:35<04:02,  5.63s/it]Best trial: 56. Best value: 0.379357:  58%|█████▊    | 58/100 [05:35<03:58,  5.69s/it]Best trial: 56. Best value: 0.379357:  58%|█████▊    | 58/100 [05:41<03:58,  5.69s/it]Best trial: 56. Best value: 0.379357:  59%|█████▉    | 59/100 [05:41<03:59,  5.84s/it]Best trial: 56. Best value: 0.379357:  59%|█████▉    | 59/100 [05:47<03:59,  5.84s/it]Best trial: 56. Best value: 0.379357:  60%|██████    | 60/100 [05:47<03:49,  5.74s/it]Best trial: 56. Best value: 0.379357:  60%|██████    | 60/100 [05:51<03:49,  5.74s/it]Best trial: 56. Best value: 0.379357:  61%|██████    | 61/100 [05:51<03:25,  5.27s/it]Best trial: 56. Best value: 0.379357:  61%|██████    | 61/100 [05:56<03:25,  5.27s/it]Best trial: 56. Best value: 0.379357:  62%|██████▏   | 62/100 [05:56<03:21,  5.29s/it]Best trial: 56. Best value: 0.379357:  62%|██████▏   | 62/100 [06:01<03:21,  5.29s/it]Best trial: 56. Best value: 0.379357:  63%|██████▎   | 63/100 [06:01<03:05,  5.02s/it]Best trial: 56. Best value: 0.379357:  63%|██████▎   | 63/100 [06:06<03:05,  5.02s/it]Best trial: 56. Best value: 0.379357:  64%|██████▍   | 64/100 [06:06<03:02,  5.06s/it]Best trial: 56. Best value: 0.379357:  64%|██████▍   | 64/100 [06:11<03:02,  5.06s/it]Best trial: 56. Best value: 0.379357:  65%|██████▌   | 65/100 [06:11<02:54,  4.99s/it]Best trial: 56. Best value: 0.379357:  65%|██████▌   | 65/100 [06:16<02:54,  4.99s/it]Best trial: 56. Best value: 0.379357:  66%|██████▌   | 66/100 [06:16<02:54,  5.14s/it]Best trial: 56. Best value: 0.379357:  66%|██████▌   | 66/100 [06:22<02:54,  5.14s/it]Best trial: 56. Best value: 0.379357:  67%|██████▋   | 67/100 [06:22<02:58,  5.42s/it]Best trial: 56. Best value: 0.379357:  67%|██████▋   | 67/100 [06:26<02:58,  5.42s/it]Best trial: 56. Best value: 0.379357:  68%|██████▊   | 68/100 [06:26<02:41,  5.03s/it]Best trial: 56. Best value: 0.379357:  68%|██████▊   | 68/100 [06:34<02:41,  5.03s/it]Best trial: 56. Best value: 0.379357:  69%|██████▉   | 69/100 [06:34<03:02,  5.90s/it]Best trial: 56. Best value: 0.379357:  69%|██████▉   | 69/100 [06:41<03:02,  5.90s/it]Best trial: 56. Best value: 0.379357:  70%|███████   | 70/100 [06:41<03:02,  6.09s/it]Best trial: 56. Best value: 0.379357:  70%|███████   | 70/100 [06:46<03:02,  6.09s/it]Best trial: 56. Best value: 0.379357:  71%|███████   | 71/100 [06:46<02:52,  5.94s/it]Best trial: 56. Best value: 0.379357:  71%|███████   | 71/100 [06:51<02:52,  5.94s/it]Best trial: 56. Best value: 0.379357:  72%|███████▏  | 72/100 [06:51<02:32,  5.44s/it]Best trial: 56. Best value: 0.379357:  72%|███████▏  | 72/100 [06:56<02:32,  5.44s/it]Best trial: 56. Best value: 0.379357:  73%|███████▎  | 73/100 [06:56<02:25,  5.38s/it]Best trial: 56. Best value: 0.379357:  73%|███████▎  | 73/100 [07:01<02:25,  5.38s/it]Best trial: 56. Best value: 0.379357:  74%|███████▍  | 74/100 [07:01<02:16,  5.25s/it]Best trial: 56. Best value: 0.379357:  74%|███████▍  | 74/100 [07:06<02:16,  5.25s/it]Best trial: 56. Best value: 0.379357:  75%|███████▌  | 75/100 [07:06<02:08,  5.15s/it]Best trial: 56. Best value: 0.379357:  75%|███████▌  | 75/100 [07:13<02:08,  5.15s/it]Best trial: 56. Best value: 0.379357:  76%|███████▌  | 76/100 [07:13<02:15,  5.64s/it]Best trial: 56. Best value: 0.379357:  76%|███████▌  | 76/100 [07:17<02:15,  5.64s/it]Best trial: 56. Best value: 0.379357:  77%|███████▋  | 77/100 [07:17<02:02,  5.33s/it]Best trial: 56. Best value: 0.379357:  77%|███████▋  | 77/100 [07:22<02:02,  5.33s/it]Best trial: 56. Best value: 0.379357:  78%|███████▊  | 78/100 [07:22<01:55,  5.25s/it]Best trial: 56. Best value: 0.379357:  78%|███████▊  | 78/100 [07:27<01:55,  5.25s/it]Best trial: 56. Best value: 0.379357:  79%|███████▉  | 79/100 [07:27<01:45,  5.03s/it]Best trial: 56. Best value: 0.379357:  79%|███████▉  | 79/100 [07:32<01:45,  5.03s/it]Best trial: 56. Best value: 0.379357:  80%|████████  | 80/100 [07:32<01:39,  4.96s/it]Best trial: 56. Best value: 0.379357:  80%|████████  | 80/100 [07:38<01:39,  4.96s/it]Best trial: 56. Best value: 0.379357:  81%|████████  | 81/100 [07:38<01:41,  5.36s/it]Best trial: 56. Best value: 0.379357:  81%|████████  | 81/100 [07:44<01:41,  5.36s/it]Best trial: 56. Best value: 0.379357:  82%|████████▏ | 82/100 [07:44<01:38,  5.47s/it]Best trial: 56. Best value: 0.379357:  82%|████████▏ | 82/100 [07:48<01:38,  5.47s/it]Best trial: 56. Best value: 0.379357:  83%|████████▎ | 83/100 [07:48<01:29,  5.29s/it]Best trial: 56. Best value: 0.379357:  83%|████████▎ | 83/100 [07:53<01:29,  5.29s/it]Best trial: 56. Best value: 0.379357:  84%|████████▍ | 84/100 [07:53<01:22,  5.18s/it]Best trial: 56. Best value: 0.379357:  84%|████████▍ | 84/100 [07:57<01:22,  5.18s/it]Best trial: 56. Best value: 0.379357:  85%|████████▌ | 85/100 [07:57<01:12,  4.81s/it]Best trial: 56. Best value: 0.379357:  85%|████████▌ | 85/100 [08:03<01:12,  4.81s/it]Best trial: 56. Best value: 0.379357:  86%|████████▌ | 86/100 [08:03<01:10,  5.05s/it]Best trial: 56. Best value: 0.379357:  86%|████████▌ | 86/100 [08:08<01:10,  5.05s/it]Best trial: 56. Best value: 0.379357:  87%|████████▋ | 87/100 [08:08<01:06,  5.11s/it]Best trial: 56. Best value: 0.379357:  87%|████████▋ | 87/100 [08:12<01:06,  5.11s/it]Best trial: 56. Best value: 0.379357:  88%|████████▊ | 88/100 [08:12<00:56,  4.74s/it]Best trial: 56. Best value: 0.379357:  88%|████████▊ | 88/100 [08:18<00:56,  4.74s/it]Best trial: 56. Best value: 0.379357:  89%|████████▉ | 89/100 [08:18<00:56,  5.16s/it]Best trial: 56. Best value: 0.379357:  89%|████████▉ | 89/100 [08:26<00:56,  5.16s/it]Best trial: 56. Best value: 0.379357:  90%|█████████ | 90/100 [08:26<00:58,  5.81s/it]Best trial: 56. Best value: 0.379357:  90%|█████████ | 90/100 [08:31<00:58,  5.81s/it]Best trial: 56. Best value: 0.379357:  91%|█████████ | 91/100 [08:31<00:51,  5.68s/it]Best trial: 56. Best value: 0.379357:  91%|█████████ | 91/100 [08:35<00:51,  5.68s/it]Best trial: 56. Best value: 0.379357:  92%|█████████▏| 92/100 [08:35<00:41,  5.20s/it]Best trial: 56. Best value: 0.379357:  92%|█████████▏| 92/100 [08:39<00:41,  5.20s/it]Best trial: 56. Best value: 0.379357:  93%|█████████▎| 93/100 [08:39<00:33,  4.80s/it]Best trial: 56. Best value: 0.379357:  93%|█████████▎| 93/100 [08:44<00:33,  4.80s/it]Best trial: 56. Best value: 0.379357:  94%|█████████▍| 94/100 [08:44<00:29,  4.92s/it]Best trial: 56. Best value: 0.379357:  94%|█████████▍| 94/100 [08:49<00:29,  4.92s/it]Best trial: 56. Best value: 0.379357:  95%|█████████▌| 95/100 [08:49<00:24,  4.97s/it]Best trial: 56. Best value: 0.379357:  95%|█████████▌| 95/100 [08:53<00:24,  4.97s/it]Best trial: 56. Best value: 0.379357:  96%|█████████▌| 96/100 [08:53<00:18,  4.58s/it]Best trial: 56. Best value: 0.379357:  96%|█████████▌| 96/100 [08:58<00:18,  4.58s/it]Best trial: 56. Best value: 0.379357:  97%|█████████▋| 97/100 [08:58<00:14,  4.83s/it]Best trial: 56. Best value: 0.379357:  97%|█████████▋| 97/100 [09:05<00:14,  4.83s/it]Best trial: 56. Best value: 0.379357:  98%|█████████▊| 98/100 [09:05<00:11,  5.52s/it]Best trial: 56. Best value: 0.379357:  98%|█████████▊| 98/100 [09:11<00:11,  5.52s/it]Best trial: 56. Best value: 0.379357:  99%|█████████▉| 99/100 [09:11<00:05,  5.45s/it]Best trial: 56. Best value: 0.379357:  99%|█████████▉| 99/100 [09:16<00:05,  5.45s/it]Best trial: 56. Best value: 0.379357: 100%|██████████| 100/100 [09:16<00:00,  5.41s/it]Best trial: 56. Best value: 0.379357: 100%|██████████| 100/100 [09:16<00:00,  5.56s/it]
2025-11-30 14:08:38,354 - INFO - HPO Complete. Best AUPRC: 0.3794
2025-11-30 14:08:38,354 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.09794401997184116, 'max_depth': 3, 'subsample': 0.6698828949374843, 'colsample_bytree': 0.8822364732717476, 'gamma': 2.24070099534587, 'reg_lambda': 1.875495142678151e-05, 'reg_alpha': 1.2098188656096284e-07}
2025-11-30 14:08:38,355 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:08:40,228 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 14:08:40,228 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:08:40,437 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:08:40,503 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:08:40,517 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:08:40,517 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 14:08:40,517 - INFO - Training model...
2025-11-30 14:08:42,871 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:08:49,303 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:08:49,303 - INFO - AUROC: 0.7507 (0.6623 - 0.8260)
2025-11-30 14:08:49,303 - INFO - AUPRC: 0.1414 (0.0240 - 0.4551)
2025-11-30 14:08:49,303 - INFO - Brier Score: 0.0142 (0.0082 - 0.0262)
2025-11-30 14:08:49,303 - INFO - Accuracy: 0.9870 (0.8838 - 0.9931)
2025-11-30 14:08:49,303 - INFO - Precision: 0.6667 (0.0000 - 1.0000)
2025-11-30 14:08:49,304 - INFO - Sensitivity (Recall): 0.2000 (0.0000 - 0.4571)
2025-11-30 14:08:49,304 - INFO - F1-Score: 0.3077 (0.0000 - 0.6095)
2025-11-30 14:08:49,304 - INFO - Best Threshold: 0.4600 (0.0100 - 0.4600)
2025-11-30 14:08:49,304 - INFO - Specificity: 0.9985 (0.8934 - 1.0000)
2025-11-30 14:08:49,312 - INFO - Calculating SHAP values...
2025-11-30 14:08:50,320 - INFO - SHAP plots saved.
2025-11-30 14:08:50,323 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:08:51,773 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 14:08:51,773 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:08:51,976 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:08:52,043 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:08:52,055 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:08:52,055 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.259782:   0%|          | 0/100 [00:10<?, ?it/s]Best trial: 0. Best value: 0.259782:   1%|          | 1/100 [00:10<16:36, 10.07s/it]Best trial: 1. Best value: 0.293801:   1%|          | 1/100 [00:16<16:36, 10.07s/it]Best trial: 1. Best value: 0.293801:   2%|▏         | 2/100 [00:16<13:10,  8.07s/it]Best trial: 1. Best value: 0.293801:   2%|▏         | 2/100 [00:22<13:10,  8.07s/it]Best trial: 1. Best value: 0.293801:   3%|▎         | 3/100 [00:22<11:18,  6.99s/it]Best trial: 3. Best value: 0.320713:   3%|▎         | 3/100 [00:28<11:18,  6.99s/it]Best trial: 3. Best value: 0.320713:   4%|▍         | 4/100 [00:28<10:40,  6.68s/it]Best trial: 3. Best value: 0.320713:   4%|▍         | 4/100 [00:35<10:40,  6.68s/it]Best trial: 3. Best value: 0.320713:   5%|▌         | 5/100 [00:35<10:36,  6.70s/it]Best trial: 3. Best value: 0.320713:   5%|▌         | 5/100 [00:40<10:36,  6.70s/it]Best trial: 3. Best value: 0.320713:   6%|▌         | 6/100 [00:40<09:41,  6.18s/it]Best trial: 3. Best value: 0.320713:   6%|▌         | 6/100 [00:46<09:41,  6.18s/it]Best trial: 3. Best value: 0.320713:   7%|▋         | 7/100 [00:46<09:20,  6.03s/it]Best trial: 3. Best value: 0.320713:   7%|▋         | 7/100 [00:51<09:20,  6.03s/it]Best trial: 3. Best value: 0.320713:   8%|▊         | 8/100 [00:51<08:50,  5.76s/it]Best trial: 3. Best value: 0.320713:   8%|▊         | 8/100 [00:58<08:50,  5.76s/it]Best trial: 3. Best value: 0.320713:   9%|▉         | 9/100 [00:58<09:20,  6.16s/it]Best trial: 3. Best value: 0.320713:   9%|▉         | 9/100 [01:05<09:20,  6.16s/it]Best trial: 3. Best value: 0.320713:  10%|█         | 10/100 [01:05<09:41,  6.46s/it]Best trial: 3. Best value: 0.320713:  10%|█         | 10/100 [01:17<09:41,  6.46s/it]Best trial: 3. Best value: 0.320713:  11%|█         | 11/100 [01:17<11:50,  7.98s/it]Best trial: 11. Best value: 0.338828:  11%|█         | 11/100 [01:22<11:50,  7.98s/it]Best trial: 11. Best value: 0.338828:  12%|█▏        | 12/100 [01:22<10:23,  7.09s/it]Best trial: 11. Best value: 0.338828:  12%|█▏        | 12/100 [01:29<10:23,  7.09s/it]Best trial: 11. Best value: 0.338828:  13%|█▎        | 13/100 [01:29<10:12,  7.04s/it]Best trial: 13. Best value: 0.369975:  13%|█▎        | 13/100 [01:33<10:12,  7.04s/it]Best trial: 13. Best value: 0.369975:  14%|█▍        | 14/100 [01:33<09:03,  6.32s/it]Best trial: 13. Best value: 0.369975:  14%|█▍        | 14/100 [01:37<09:03,  6.32s/it]Best trial: 13. Best value: 0.369975:  15%|█▌        | 15/100 [01:37<08:03,  5.68s/it]Best trial: 15. Best value: 0.400238:  15%|█▌        | 15/100 [01:41<08:03,  5.68s/it]Best trial: 15. Best value: 0.400238:  16%|█▌        | 16/100 [01:41<07:09,  5.11s/it]Best trial: 15. Best value: 0.400238:  16%|█▌        | 16/100 [01:45<07:09,  5.11s/it]Best trial: 15. Best value: 0.400238:  17%|█▋        | 17/100 [01:45<06:27,  4.67s/it]Best trial: 15. Best value: 0.400238:  17%|█▋        | 17/100 [01:50<06:27,  4.67s/it]Best trial: 15. Best value: 0.400238:  18%|█▊        | 18/100 [01:50<06:32,  4.79s/it]Best trial: 15. Best value: 0.400238:  18%|█▊        | 18/100 [01:54<06:32,  4.79s/it]Best trial: 15. Best value: 0.400238:  19%|█▉        | 19/100 [01:54<06:08,  4.54s/it]Best trial: 15. Best value: 0.400238:  19%|█▉        | 19/100 [01:59<06:08,  4.54s/it]Best trial: 15. Best value: 0.400238:  20%|██        | 20/100 [01:59<06:10,  4.63s/it]Best trial: 15. Best value: 0.400238:  20%|██        | 20/100 [02:05<06:10,  4.63s/it]Best trial: 15. Best value: 0.400238:  21%|██        | 21/100 [02:05<06:43,  5.11s/it]Best trial: 15. Best value: 0.400238:  21%|██        | 21/100 [02:09<06:43,  5.11s/it]Best trial: 15. Best value: 0.400238:  22%|██▏       | 22/100 [02:09<06:10,  4.75s/it]Best trial: 15. Best value: 0.400238:  22%|██▏       | 22/100 [02:13<06:10,  4.75s/it]Best trial: 15. Best value: 0.400238:  23%|██▎       | 23/100 [02:13<05:57,  4.64s/it]Best trial: 15. Best value: 0.400238:  23%|██▎       | 23/100 [02:18<05:57,  4.64s/it]Best trial: 15. Best value: 0.400238:  24%|██▍       | 24/100 [02:18<05:51,  4.63s/it]Best trial: 15. Best value: 0.400238:  24%|██▍       | 24/100 [02:22<05:51,  4.63s/it]Best trial: 15. Best value: 0.400238:  25%|██▌       | 25/100 [02:22<05:45,  4.61s/it]Best trial: 15. Best value: 0.400238:  25%|██▌       | 25/100 [02:26<05:45,  4.61s/it]Best trial: 15. Best value: 0.400238:  26%|██▌       | 26/100 [02:26<05:23,  4.38s/it]Best trial: 15. Best value: 0.400238:  26%|██▌       | 26/100 [02:31<05:23,  4.38s/it]Best trial: 15. Best value: 0.400238:  27%|██▋       | 27/100 [02:31<05:30,  4.53s/it]Best trial: 15. Best value: 0.400238:  27%|██▋       | 27/100 [02:35<05:30,  4.53s/it]Best trial: 15. Best value: 0.400238:  28%|██▊       | 28/100 [02:35<05:12,  4.34s/it]Best trial: 15. Best value: 0.400238:  28%|██▊       | 28/100 [02:40<05:12,  4.34s/it]Best trial: 15. Best value: 0.400238:  29%|██▉       | 29/100 [02:40<05:20,  4.51s/it]Best trial: 15. Best value: 0.400238:  29%|██▉       | 29/100 [02:45<05:20,  4.51s/it]Best trial: 15. Best value: 0.400238:  30%|███       | 30/100 [02:45<05:27,  4.69s/it]Best trial: 15. Best value: 0.400238:  30%|███       | 30/100 [02:50<05:27,  4.69s/it]Best trial: 15. Best value: 0.400238:  31%|███       | 31/100 [02:50<05:33,  4.84s/it]Best trial: 15. Best value: 0.400238:  31%|███       | 31/100 [02:54<05:33,  4.84s/it]Best trial: 15. Best value: 0.400238:  32%|███▏      | 32/100 [02:54<05:14,  4.63s/it]Best trial: 15. Best value: 0.400238:  32%|███▏      | 32/100 [03:00<05:14,  4.63s/it]Best trial: 15. Best value: 0.400238:  33%|███▎      | 33/100 [03:00<05:33,  4.98s/it]Best trial: 15. Best value: 0.400238:  33%|███▎      | 33/100 [03:04<05:33,  4.98s/it]Best trial: 15. Best value: 0.400238:  34%|███▍      | 34/100 [03:04<05:10,  4.71s/it]Best trial: 15. Best value: 0.400238:  34%|███▍      | 34/100 [03:08<05:10,  4.71s/it]Best trial: 15. Best value: 0.400238:  35%|███▌      | 35/100 [03:08<04:56,  4.56s/it]Best trial: 15. Best value: 0.400238:  35%|███▌      | 35/100 [03:14<04:56,  4.56s/it]Best trial: 15. Best value: 0.400238:  36%|███▌      | 36/100 [03:14<05:17,  4.97s/it]Best trial: 15. Best value: 0.400238:  36%|███▌      | 36/100 [03:19<05:17,  4.97s/it]Best trial: 15. Best value: 0.400238:  37%|███▋      | 37/100 [03:19<05:15,  5.01s/it]Best trial: 15. Best value: 0.400238:  37%|███▋      | 37/100 [03:25<05:15,  5.01s/it]Best trial: 15. Best value: 0.400238:  38%|███▊      | 38/100 [03:25<05:14,  5.07s/it]Best trial: 15. Best value: 0.400238:  38%|███▊      | 38/100 [03:29<05:14,  5.07s/it]Best trial: 15. Best value: 0.400238:  39%|███▉      | 39/100 [03:29<04:54,  4.83s/it]Best trial: 15. Best value: 0.400238:  39%|███▉      | 39/100 [03:33<04:54,  4.83s/it]Best trial: 15. Best value: 0.400238:  40%|████      | 40/100 [03:33<04:44,  4.74s/it]Best trial: 15. Best value: 0.400238:  40%|████      | 40/100 [03:37<04:44,  4.74s/it]Best trial: 15. Best value: 0.400238:  41%|████      | 41/100 [03:37<04:26,  4.52s/it]Best trial: 15. Best value: 0.400238:  41%|████      | 41/100 [03:42<04:26,  4.52s/it]Best trial: 15. Best value: 0.400238:  42%|████▏     | 42/100 [03:42<04:18,  4.46s/it]Best trial: 15. Best value: 0.400238:  42%|████▏     | 42/100 [03:47<04:18,  4.46s/it]Best trial: 15. Best value: 0.400238:  43%|████▎     | 43/100 [03:47<04:18,  4.54s/it]Best trial: 15. Best value: 0.400238:  43%|████▎     | 43/100 [03:52<04:18,  4.54s/it]Best trial: 15. Best value: 0.400238:  44%|████▍     | 44/100 [03:52<04:37,  4.95s/it]Best trial: 15. Best value: 0.400238:  44%|████▍     | 44/100 [03:57<04:37,  4.95s/it]Best trial: 15. Best value: 0.400238:  45%|████▌     | 45/100 [03:57<04:23,  4.79s/it]Best trial: 15. Best value: 0.400238:  45%|████▌     | 45/100 [04:02<04:23,  4.79s/it]Best trial: 15. Best value: 0.400238:  46%|████▌     | 46/100 [04:02<04:17,  4.76s/it]Best trial: 15. Best value: 0.400238:  46%|████▌     | 46/100 [04:09<04:17,  4.76s/it]Best trial: 15. Best value: 0.400238:  47%|████▋     | 47/100 [04:09<04:48,  5.44s/it]Best trial: 15. Best value: 0.400238:  47%|████▋     | 47/100 [04:17<04:48,  5.44s/it]Best trial: 15. Best value: 0.400238:  48%|████▊     | 48/100 [04:17<05:22,  6.20s/it]Best trial: 15. Best value: 0.400238:  48%|████▊     | 48/100 [04:24<05:22,  6.20s/it]Best trial: 15. Best value: 0.400238:  49%|████▉     | 49/100 [04:24<05:32,  6.51s/it]Best trial: 15. Best value: 0.400238:  49%|████▉     | 49/100 [04:29<05:32,  6.51s/it]Best trial: 15. Best value: 0.400238:  50%|█████     | 50/100 [04:29<05:00,  6.01s/it]Best trial: 15. Best value: 0.400238:  50%|█████     | 50/100 [04:34<05:00,  6.01s/it]Best trial: 15. Best value: 0.400238:  51%|█████     | 51/100 [04:34<04:49,  5.92s/it]Best trial: 15. Best value: 0.400238:  51%|█████     | 51/100 [04:38<04:49,  5.92s/it]Best trial: 15. Best value: 0.400238:  52%|█████▏    | 52/100 [04:38<04:13,  5.29s/it]Best trial: 15. Best value: 0.400238:  52%|█████▏    | 52/100 [04:42<04:13,  5.29s/it]Best trial: 15. Best value: 0.400238:  53%|█████▎    | 53/100 [04:42<03:51,  4.92s/it]Best trial: 15. Best value: 0.400238:  53%|█████▎    | 53/100 [04:49<03:51,  4.92s/it]Best trial: 15. Best value: 0.400238:  54%|█████▍    | 54/100 [04:49<04:12,  5.49s/it]Best trial: 15. Best value: 0.400238:  54%|█████▍    | 54/100 [04:53<04:12,  5.49s/it]Best trial: 15. Best value: 0.400238:  55%|█████▌    | 55/100 [04:53<03:44,  5.00s/it]Best trial: 15. Best value: 0.400238:  55%|█████▌    | 55/100 [04:57<03:44,  5.00s/it]Best trial: 15. Best value: 0.400238:  56%|█████▌    | 56/100 [04:57<03:25,  4.68s/it]Best trial: 15. Best value: 0.400238:  56%|█████▌    | 56/100 [05:03<03:25,  4.68s/it]Best trial: 15. Best value: 0.400238:  57%|█████▋    | 57/100 [05:03<03:36,  5.04s/it]Best trial: 15. Best value: 0.400238:  57%|█████▋    | 57/100 [05:09<03:36,  5.04s/it]Best trial: 15. Best value: 0.400238:  58%|█████▊    | 58/100 [05:09<03:47,  5.42s/it]Best trial: 15. Best value: 0.400238:  58%|█████▊    | 58/100 [05:13<03:47,  5.42s/it]Best trial: 15. Best value: 0.400238:  59%|█████▉    | 59/100 [05:13<03:24,  5.00s/it]Best trial: 15. Best value: 0.400238:  59%|█████▉    | 59/100 [05:18<03:24,  5.00s/it]Best trial: 15. Best value: 0.400238:  60%|██████    | 60/100 [05:18<03:21,  5.04s/it]Best trial: 15. Best value: 0.400238:  60%|██████    | 60/100 [05:22<03:21,  5.04s/it]Best trial: 15. Best value: 0.400238:  61%|██████    | 61/100 [05:22<03:03,  4.70s/it]Best trial: 15. Best value: 0.400238:  61%|██████    | 61/100 [05:26<03:03,  4.70s/it]Best trial: 15. Best value: 0.400238:  62%|██████▏   | 62/100 [05:26<02:50,  4.48s/it]Best trial: 15. Best value: 0.400238:  62%|██████▏   | 62/100 [05:30<02:50,  4.48s/it]Best trial: 15. Best value: 0.400238:  63%|██████▎   | 63/100 [05:30<02:39,  4.30s/it]Best trial: 15. Best value: 0.400238:  63%|██████▎   | 63/100 [05:34<02:39,  4.30s/it]Best trial: 15. Best value: 0.400238:  64%|██████▍   | 64/100 [05:34<02:30,  4.19s/it]Best trial: 15. Best value: 0.400238:  64%|██████▍   | 64/100 [05:39<02:30,  4.19s/it]Best trial: 15. Best value: 0.400238:  65%|██████▌   | 65/100 [05:39<02:41,  4.63s/it]Best trial: 15. Best value: 0.400238:  65%|██████▌   | 65/100 [05:45<02:41,  4.63s/it]Best trial: 15. Best value: 0.400238:  66%|██████▌   | 66/100 [05:45<02:42,  4.78s/it]Best trial: 15. Best value: 0.400238:  66%|██████▌   | 66/100 [05:50<02:42,  4.78s/it]Best trial: 15. Best value: 0.400238:  67%|██████▋   | 67/100 [05:50<02:40,  4.85s/it]Best trial: 15. Best value: 0.400238:  67%|██████▋   | 67/100 [05:55<02:40,  4.85s/it]Best trial: 15. Best value: 0.400238:  68%|██████▊   | 68/100 [05:55<02:38,  4.96s/it]Best trial: 15. Best value: 0.400238:  68%|██████▊   | 68/100 [05:59<02:38,  4.96s/it]Best trial: 15. Best value: 0.400238:  69%|██████▉   | 69/100 [05:59<02:23,  4.64s/it]Best trial: 15. Best value: 0.400238:  69%|██████▉   | 69/100 [06:04<02:23,  4.64s/it]Best trial: 15. Best value: 0.400238:  70%|███████   | 70/100 [06:04<02:28,  4.94s/it]Best trial: 15. Best value: 0.400238:  70%|███████   | 70/100 [06:08<02:28,  4.94s/it]Best trial: 15. Best value: 0.400238:  71%|███████   | 71/100 [06:08<02:14,  4.65s/it]Best trial: 15. Best value: 0.400238:  71%|███████   | 71/100 [06:12<02:14,  4.65s/it]Best trial: 15. Best value: 0.400238:  72%|███████▏  | 72/100 [06:12<02:05,  4.47s/it]Best trial: 15. Best value: 0.400238:  72%|███████▏  | 72/100 [06:17<02:05,  4.47s/it]Best trial: 15. Best value: 0.400238:  73%|███████▎  | 73/100 [06:17<02:00,  4.46s/it]Best trial: 15. Best value: 0.400238:  73%|███████▎  | 73/100 [06:21<02:00,  4.46s/it]Best trial: 15. Best value: 0.400238:  74%|███████▍  | 74/100 [06:21<01:54,  4.42s/it]Best trial: 15. Best value: 0.400238:  74%|███████▍  | 74/100 [06:25<01:54,  4.42s/it]Best trial: 15. Best value: 0.400238:  75%|███████▌  | 75/100 [06:25<01:46,  4.26s/it]Best trial: 15. Best value: 0.400238:  75%|███████▌  | 75/100 [06:29<01:46,  4.26s/it]Best trial: 15. Best value: 0.400238:  76%|███████▌  | 76/100 [06:29<01:43,  4.32s/it]Best trial: 15. Best value: 0.400238:  76%|███████▌  | 76/100 [06:37<01:43,  4.32s/it]Best trial: 15. Best value: 0.400238:  77%|███████▋  | 77/100 [06:37<02:03,  5.38s/it]Best trial: 15. Best value: 0.400238:  77%|███████▋  | 77/100 [06:42<02:03,  5.38s/it]Best trial: 15. Best value: 0.400238:  78%|███████▊  | 78/100 [06:42<01:51,  5.08s/it]Best trial: 15. Best value: 0.400238:  78%|███████▊  | 78/100 [06:45<01:51,  5.08s/it]Best trial: 15. Best value: 0.400238:  79%|███████▉  | 79/100 [06:45<01:38,  4.67s/it]Best trial: 15. Best value: 0.400238:  79%|███████▉  | 79/100 [06:49<01:38,  4.67s/it]Best trial: 15. Best value: 0.400238:  80%|████████  | 80/100 [06:49<01:27,  4.37s/it]Best trial: 15. Best value: 0.400238:  80%|████████  | 80/100 [06:56<01:27,  4.37s/it]Best trial: 15. Best value: 0.400238:  81%|████████  | 81/100 [06:56<01:38,  5.21s/it]Best trial: 15. Best value: 0.400238:  81%|████████  | 81/100 [07:00<01:38,  5.21s/it]Best trial: 15. Best value: 0.400238:  82%|████████▏ | 82/100 [07:00<01:28,  4.91s/it]Best trial: 15. Best value: 0.400238:  82%|████████▏ | 82/100 [07:05<01:28,  4.91s/it]Best trial: 15. Best value: 0.400238:  83%|████████▎ | 83/100 [07:05<01:20,  4.71s/it]Best trial: 15. Best value: 0.400238:  83%|████████▎ | 83/100 [07:10<01:20,  4.71s/it]Best trial: 15. Best value: 0.400238:  84%|████████▍ | 84/100 [07:10<01:16,  4.76s/it]Best trial: 15. Best value: 0.400238:  84%|████████▍ | 84/100 [07:14<01:16,  4.76s/it]Best trial: 15. Best value: 0.400238:  85%|████████▌ | 85/100 [07:14<01:09,  4.66s/it]Best trial: 15. Best value: 0.400238:  85%|████████▌ | 85/100 [07:19<01:09,  4.66s/it]Best trial: 15. Best value: 0.400238:  86%|████████▌ | 86/100 [07:19<01:06,  4.74s/it]Best trial: 15. Best value: 0.400238:  86%|████████▌ | 86/100 [07:23<01:06,  4.74s/it]Best trial: 15. Best value: 0.400238:  87%|████████▋ | 87/100 [07:23<01:00,  4.62s/it]Best trial: 15. Best value: 0.400238:  87%|████████▋ | 87/100 [07:27<01:00,  4.62s/it]Best trial: 15. Best value: 0.400238:  88%|████████▊ | 88/100 [07:27<00:53,  4.44s/it]Best trial: 15. Best value: 0.400238:  88%|████████▊ | 88/100 [07:32<00:53,  4.44s/it]Best trial: 15. Best value: 0.400238:  89%|████████▉ | 89/100 [07:32<00:48,  4.36s/it]Best trial: 15. Best value: 0.400238:  89%|████████▉ | 89/100 [07:37<00:48,  4.36s/it]Best trial: 15. Best value: 0.400238:  90%|█████████ | 90/100 [07:37<00:48,  4.83s/it]Best trial: 15. Best value: 0.400238:  90%|█████████ | 90/100 [07:42<00:48,  4.83s/it]Best trial: 15. Best value: 0.400238:  91%|█████████ | 91/100 [07:42<00:43,  4.78s/it]Best trial: 15. Best value: 0.400238:  91%|█████████ | 91/100 [07:46<00:43,  4.78s/it]Best trial: 15. Best value: 0.400238:  92%|█████████▏| 92/100 [07:46<00:35,  4.44s/it]Best trial: 15. Best value: 0.400238:  92%|█████████▏| 92/100 [07:50<00:35,  4.44s/it]Best trial: 15. Best value: 0.400238:  93%|█████████▎| 93/100 [07:50<00:29,  4.28s/it]Best trial: 93. Best value: 0.401075:  93%|█████████▎| 93/100 [07:54<00:29,  4.28s/it]Best trial: 93. Best value: 0.401075:  94%|█████████▍| 94/100 [07:54<00:24,  4.16s/it]Best trial: 94. Best value: 0.404492:  94%|█████████▍| 94/100 [07:58<00:24,  4.16s/it]Best trial: 94. Best value: 0.404492:  95%|█████████▌| 95/100 [07:58<00:20,  4.18s/it]Best trial: 94. Best value: 0.404492:  95%|█████████▌| 95/100 [08:02<00:20,  4.18s/it]Best trial: 94. Best value: 0.404492:  96%|█████████▌| 96/100 [08:02<00:16,  4.20s/it]Best trial: 94. Best value: 0.404492:  96%|█████████▌| 96/100 [08:06<00:16,  4.20s/it]Best trial: 94. Best value: 0.404492:  97%|█████████▋| 97/100 [08:06<00:12,  4.24s/it]Best trial: 94. Best value: 0.404492:  97%|█████████▋| 97/100 [08:11<00:12,  4.24s/it]Best trial: 94. Best value: 0.404492:  98%|█████████▊| 98/100 [08:11<00:08,  4.32s/it]Best trial: 94. Best value: 0.404492:  98%|█████████▊| 98/100 [08:15<00:08,  4.32s/it]Best trial: 94. Best value: 0.404492:  99%|█████████▉| 99/100 [08:15<00:04,  4.25s/it]Best trial: 94. Best value: 0.404492:  99%|█████████▉| 99/100 [08:20<00:04,  4.25s/it]Best trial: 94. Best value: 0.404492: 100%|██████████| 100/100 [08:20<00:00,  4.54s/it]Best trial: 94. Best value: 0.404492: 100%|██████████| 100/100 [08:20<00:00,  5.01s/it]
2025-11-30 14:17:12,691 - INFO - HPO Complete. Best AUPRC: 0.4045
2025-11-30 14:17:12,691 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.0004517624055889525, 'max_depth': 3, 'subsample': 0.6081383053528502, 'colsample_bytree': 0.681542898878527, 'gamma': 0.8097118558261898, 'reg_lambda': 1.3473824452576904e-08, 'reg_alpha': 0.0044246808979824335}
2025-11-30 14:17:12,693 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:17:14,708 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 14:17:14,708 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:17:14,904 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:17:14,969 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:17:14,983 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:17:14,983 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 14:17:14,985 - INFO - Training model...
2025-11-30 14:17:19,079 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:17:26,019 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:17:26,019 - INFO - AUROC: 0.7279 (0.4973 - 0.8890)
2025-11-30 14:17:26,019 - INFO - AUPRC: 0.1949 (0.0311 - 0.4624)
2025-11-30 14:17:26,019 - INFO - Brier Score: 0.1610 (0.1595 - 0.1634)
2025-11-30 14:17:26,019 - INFO - Accuracy: 0.9769 (0.8916 - 0.9939)
2025-11-30 14:17:26,019 - INFO - Precision: 0.2500 (0.0671 - 1.0000)
2025-11-30 14:17:26,019 - INFO - Sensitivity (Recall): 0.3000 (0.1302 - 0.5333)
2025-11-30 14:17:26,019 - INFO - F1-Score: 0.2727 (0.1048 - 0.5778)
2025-11-30 14:17:26,019 - INFO - Best Threshold: 0.5200 (0.4580 - 0.5500)
2025-11-30 14:17:26,019 - INFO - Specificity: 0.9868 (0.8993 - 1.0000)
2025-11-30 14:17:26,036 - INFO - Calculating SHAP values...
2025-11-30 14:17:27,238 - INFO - SHAP plots saved.
2025-11-30 14:17:27,241 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:17:28,676 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 14:17:28,676 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:17:28,881 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:17:28,946 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:17:28,959 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:17:28,959 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.258606:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.258606:   1%|          | 1/100 [00:06<10:59,  6.66s/it]Best trial: 1. Best value: 0.297843:   1%|          | 1/100 [00:14<10:59,  6.66s/it]Best trial: 1. Best value: 0.297843:   2%|▏         | 2/100 [00:14<11:37,  7.11s/it]Best trial: 1. Best value: 0.297843:   2%|▏         | 2/100 [00:18<11:37,  7.11s/it]Best trial: 1. Best value: 0.297843:   3%|▎         | 3/100 [00:18<09:21,  5.79s/it]Best trial: 1. Best value: 0.297843:   3%|▎         | 3/100 [00:24<09:21,  5.79s/it]Best trial: 1. Best value: 0.297843:   4%|▍         | 4/100 [00:24<09:27,  5.91s/it]Best trial: 1. Best value: 0.297843:   4%|▍         | 4/100 [00:30<09:27,  5.91s/it]Best trial: 1. Best value: 0.297843:   5%|▌         | 5/100 [00:30<09:35,  6.06s/it]Best trial: 1. Best value: 0.297843:   5%|▌         | 5/100 [00:36<09:35,  6.06s/it]Best trial: 1. Best value: 0.297843:   6%|▌         | 6/100 [00:36<09:22,  5.98s/it]Best trial: 1. Best value: 0.297843:   6%|▌         | 6/100 [00:42<09:22,  5.98s/it]Best trial: 1. Best value: 0.297843:   7%|▋         | 7/100 [00:42<09:26,  6.09s/it]Best trial: 7. Best value: 0.30139:   7%|▋         | 7/100 [00:49<09:26,  6.09s/it] Best trial: 7. Best value: 0.30139:   8%|▊         | 8/100 [00:49<09:23,  6.12s/it]Best trial: 7. Best value: 0.30139:   8%|▊         | 8/100 [00:55<09:23,  6.12s/it]Best trial: 7. Best value: 0.30139:   9%|▉         | 9/100 [00:55<09:12,  6.07s/it]Best trial: 7. Best value: 0.30139:   9%|▉         | 9/100 [01:02<09:12,  6.07s/it]Best trial: 7. Best value: 0.30139:  10%|█         | 10/100 [01:02<09:36,  6.41s/it]Best trial: 10. Best value: 0.394577:  10%|█         | 10/100 [01:05<09:36,  6.41s/it]Best trial: 10. Best value: 0.394577:  11%|█         | 11/100 [01:05<08:17,  5.59s/it]Best trial: 11. Best value: 0.421121:  11%|█         | 11/100 [01:09<08:17,  5.59s/it]Best trial: 11. Best value: 0.421121:  12%|█▏        | 12/100 [01:09<07:27,  5.09s/it]Best trial: 11. Best value: 0.421121:  12%|█▏        | 12/100 [01:14<07:27,  5.09s/it]Best trial: 11. Best value: 0.421121:  13%|█▎        | 13/100 [01:14<07:10,  4.95s/it]Best trial: 11. Best value: 0.421121:  13%|█▎        | 13/100 [01:18<07:10,  4.95s/it]Best trial: 11. Best value: 0.421121:  14%|█▍        | 14/100 [01:18<06:38,  4.63s/it]Best trial: 11. Best value: 0.421121:  14%|█▍        | 14/100 [01:24<06:38,  4.63s/it]Best trial: 11. Best value: 0.421121:  15%|█▌        | 15/100 [01:24<07:07,  5.03s/it]Best trial: 11. Best value: 0.421121:  15%|█▌        | 15/100 [01:28<07:07,  5.03s/it]Best trial: 11. Best value: 0.421121:  16%|█▌        | 16/100 [01:28<06:46,  4.84s/it]Best trial: 11. Best value: 0.421121:  16%|█▌        | 16/100 [01:35<06:46,  4.84s/it]Best trial: 11. Best value: 0.421121:  17%|█▋        | 17/100 [01:35<07:19,  5.30s/it]Best trial: 11. Best value: 0.421121:  17%|█▋        | 17/100 [01:39<07:19,  5.30s/it]Best trial: 11. Best value: 0.421121:  18%|█▊        | 18/100 [01:39<06:50,  5.01s/it]Best trial: 11. Best value: 0.421121:  18%|█▊        | 18/100 [01:45<06:50,  5.01s/it]Best trial: 11. Best value: 0.421121:  19%|█▉        | 19/100 [01:45<07:12,  5.33s/it]Best trial: 11. Best value: 0.421121:  19%|█▉        | 19/100 [01:48<07:12,  5.33s/it]Best trial: 11. Best value: 0.421121:  20%|██        | 20/100 [01:48<06:17,  4.72s/it]Best trial: 11. Best value: 0.421121:  20%|██        | 20/100 [01:54<06:17,  4.72s/it]Best trial: 11. Best value: 0.421121:  21%|██        | 21/100 [01:54<06:29,  4.93s/it]Best trial: 11. Best value: 0.421121:  21%|██        | 21/100 [01:58<06:29,  4.93s/it]Best trial: 11. Best value: 0.421121:  22%|██▏       | 22/100 [01:58<06:01,  4.63s/it]Best trial: 11. Best value: 0.421121:  22%|██▏       | 22/100 [02:01<06:01,  4.63s/it]Best trial: 11. Best value: 0.421121:  23%|██▎       | 23/100 [02:01<05:38,  4.39s/it]Best trial: 11. Best value: 0.421121:  23%|██▎       | 23/100 [02:05<05:38,  4.39s/it]Best trial: 11. Best value: 0.421121:  24%|██▍       | 24/100 [02:05<05:22,  4.25s/it]Best trial: 11. Best value: 0.421121:  24%|██▍       | 24/100 [02:09<05:22,  4.25s/it]Best trial: 11. Best value: 0.421121:  25%|██▌       | 25/100 [02:09<05:12,  4.16s/it]Best trial: 11. Best value: 0.421121:  25%|██▌       | 25/100 [02:14<05:12,  4.16s/it]Best trial: 11. Best value: 0.421121:  26%|██▌       | 26/100 [02:14<05:16,  4.28s/it]Best trial: 11. Best value: 0.421121:  26%|██▌       | 26/100 [02:19<05:16,  4.28s/it]Best trial: 11. Best value: 0.421121:  27%|██▋       | 27/100 [02:19<05:35,  4.59s/it]Best trial: 11. Best value: 0.421121:  27%|██▋       | 27/100 [02:24<05:35,  4.59s/it]Best trial: 11. Best value: 0.421121:  28%|██▊       | 28/100 [02:24<05:25,  4.52s/it]Best trial: 11. Best value: 0.421121:  28%|██▊       | 28/100 [02:33<05:25,  4.52s/it]Best trial: 11. Best value: 0.421121:  29%|██▉       | 29/100 [02:33<07:00,  5.92s/it]Best trial: 11. Best value: 0.421121:  29%|██▉       | 29/100 [02:39<07:00,  5.92s/it]Best trial: 11. Best value: 0.421121:  30%|███       | 30/100 [02:39<07:00,  6.01s/it]Best trial: 11. Best value: 0.421121:  30%|███       | 30/100 [02:44<07:00,  6.01s/it]Best trial: 11. Best value: 0.421121:  31%|███       | 31/100 [02:44<06:42,  5.83s/it]Best trial: 11. Best value: 0.421121:  31%|███       | 31/100 [02:49<06:42,  5.83s/it]Best trial: 11. Best value: 0.421121:  32%|███▏      | 32/100 [02:49<06:01,  5.32s/it]Best trial: 11. Best value: 0.421121:  32%|███▏      | 32/100 [02:53<06:01,  5.32s/it]Best trial: 11. Best value: 0.421121:  33%|███▎      | 33/100 [02:53<05:33,  4.98s/it]Best trial: 11. Best value: 0.421121:  33%|███▎      | 33/100 [02:57<05:33,  4.98s/it]Best trial: 11. Best value: 0.421121:  34%|███▍      | 34/100 [02:57<05:14,  4.76s/it]Best trial: 11. Best value: 0.421121:  34%|███▍      | 34/100 [03:01<05:14,  4.76s/it]Best trial: 11. Best value: 0.421121:  35%|███▌      | 35/100 [03:01<04:57,  4.57s/it]Best trial: 11. Best value: 0.421121:  35%|███▌      | 35/100 [03:05<04:57,  4.57s/it]Best trial: 11. Best value: 0.421121:  36%|███▌      | 36/100 [03:05<04:43,  4.43s/it]Best trial: 11. Best value: 0.421121:  36%|███▌      | 36/100 [03:11<04:43,  4.43s/it]Best trial: 11. Best value: 0.421121:  37%|███▋      | 37/100 [03:11<04:57,  4.72s/it]Best trial: 11. Best value: 0.421121:  37%|███▋      | 37/100 [03:16<04:57,  4.72s/it]Best trial: 11. Best value: 0.421121:  38%|███▊      | 38/100 [03:16<05:02,  4.87s/it]Best trial: 11. Best value: 0.421121:  38%|███▊      | 38/100 [03:21<05:02,  4.87s/it]Best trial: 11. Best value: 0.421121:  39%|███▉      | 39/100 [03:21<05:03,  4.97s/it]Best trial: 11. Best value: 0.421121:  39%|███▉      | 39/100 [03:27<05:03,  4.97s/it]Best trial: 11. Best value: 0.421121:  40%|████      | 40/100 [03:27<05:08,  5.15s/it]Best trial: 11. Best value: 0.421121:  40%|████      | 40/100 [03:31<05:08,  5.15s/it]Best trial: 11. Best value: 0.421121:  41%|████      | 41/100 [03:31<04:56,  5.03s/it]Best trial: 11. Best value: 0.421121:  41%|████      | 41/100 [03:35<04:56,  5.03s/it]Best trial: 11. Best value: 0.421121:  42%|████▏     | 42/100 [03:35<04:36,  4.76s/it]Best trial: 11. Best value: 0.421121:  42%|████▏     | 42/100 [03:40<04:36,  4.76s/it]Best trial: 11. Best value: 0.421121:  43%|████▎     | 43/100 [03:40<04:22,  4.61s/it]Best trial: 11. Best value: 0.421121:  43%|████▎     | 43/100 [03:45<04:22,  4.61s/it]Best trial: 11. Best value: 0.421121:  44%|████▍     | 44/100 [03:45<04:22,  4.68s/it]Best trial: 11. Best value: 0.421121:  44%|████▍     | 44/100 [03:54<04:22,  4.68s/it]Best trial: 11. Best value: 0.421121:  45%|████▌     | 45/100 [03:54<05:27,  5.95s/it]Best trial: 11. Best value: 0.421121:  45%|████▌     | 45/100 [03:58<05:27,  5.95s/it]Best trial: 11. Best value: 0.421121:  46%|████▌     | 46/100 [03:58<04:59,  5.55s/it]Best trial: 11. Best value: 0.421121:  46%|████▌     | 46/100 [04:07<04:59,  5.55s/it]Best trial: 11. Best value: 0.421121:  47%|████▋     | 47/100 [04:07<05:53,  6.67s/it]Best trial: 11. Best value: 0.421121:  47%|████▋     | 47/100 [04:12<05:53,  6.67s/it]Best trial: 11. Best value: 0.421121:  48%|████▊     | 48/100 [04:12<05:18,  6.12s/it]Best trial: 11. Best value: 0.421121:  48%|████▊     | 48/100 [04:17<05:18,  6.12s/it]Best trial: 11. Best value: 0.421121:  49%|████▉     | 49/100 [04:17<04:50,  5.69s/it]Best trial: 11. Best value: 0.421121:  49%|████▉     | 49/100 [04:22<04:50,  5.69s/it]Best trial: 11. Best value: 0.421121:  50%|█████     | 50/100 [04:22<04:29,  5.40s/it]Best trial: 11. Best value: 0.421121:  50%|█████     | 50/100 [04:27<04:29,  5.40s/it]Best trial: 11. Best value: 0.421121:  51%|█████     | 51/100 [04:27<04:20,  5.31s/it]Best trial: 11. Best value: 0.421121:  51%|█████     | 51/100 [04:31<04:20,  5.31s/it]Best trial: 11. Best value: 0.421121:  52%|█████▏    | 52/100 [04:31<03:55,  4.91s/it]Best trial: 11. Best value: 0.421121:  52%|█████▏    | 52/100 [04:36<03:55,  4.91s/it]Best trial: 11. Best value: 0.421121:  53%|█████▎    | 53/100 [04:36<03:50,  4.90s/it]Best trial: 11. Best value: 0.421121:  53%|█████▎    | 53/100 [04:41<03:50,  4.90s/it]Best trial: 11. Best value: 0.421121:  54%|█████▍    | 54/100 [04:41<03:45,  4.91s/it]Best trial: 11. Best value: 0.421121:  54%|█████▍    | 54/100 [04:45<03:45,  4.91s/it]Best trial: 11. Best value: 0.421121:  55%|█████▌    | 55/100 [04:45<03:33,  4.75s/it]Best trial: 11. Best value: 0.421121:  55%|█████▌    | 55/100 [04:51<03:33,  4.75s/it]Best trial: 11. Best value: 0.421121:  56%|█████▌    | 56/100 [04:51<03:46,  5.16s/it]Best trial: 11. Best value: 0.421121:  56%|█████▌    | 56/100 [04:55<03:46,  5.16s/it]Best trial: 11. Best value: 0.421121:  57%|█████▋    | 57/100 [04:55<03:32,  4.93s/it]Best trial: 11. Best value: 0.421121:  57%|█████▋    | 57/100 [05:00<03:32,  4.93s/it]Best trial: 11. Best value: 0.421121:  58%|█████▊    | 58/100 [05:00<03:19,  4.76s/it]Best trial: 11. Best value: 0.421121:  58%|█████▊    | 58/100 [05:05<03:19,  4.76s/it]Best trial: 11. Best value: 0.421121:  59%|█████▉    | 59/100 [05:05<03:17,  4.81s/it]Best trial: 11. Best value: 0.421121:  59%|█████▉    | 59/100 [05:08<03:17,  4.81s/it]Best trial: 11. Best value: 0.421121:  60%|██████    | 60/100 [05:08<02:57,  4.43s/it]Best trial: 11. Best value: 0.421121:  60%|██████    | 60/100 [05:13<02:57,  4.43s/it]Best trial: 11. Best value: 0.421121:  61%|██████    | 61/100 [05:13<02:55,  4.50s/it]Best trial: 11. Best value: 0.421121:  61%|██████    | 61/100 [05:17<02:55,  4.50s/it]Best trial: 11. Best value: 0.421121:  62%|██████▏   | 62/100 [05:17<02:48,  4.42s/it]Best trial: 11. Best value: 0.421121:  62%|██████▏   | 62/100 [05:22<02:48,  4.42s/it]Best trial: 11. Best value: 0.421121:  63%|██████▎   | 63/100 [05:22<02:46,  4.51s/it]Best trial: 11. Best value: 0.421121:  63%|██████▎   | 63/100 [05:26<02:46,  4.51s/it]Best trial: 11. Best value: 0.421121:  64%|██████▍   | 64/100 [05:26<02:37,  4.38s/it]Best trial: 11. Best value: 0.421121:  64%|██████▍   | 64/100 [05:30<02:37,  4.38s/it]Best trial: 11. Best value: 0.421121:  65%|██████▌   | 65/100 [05:30<02:26,  4.20s/it]Best trial: 11. Best value: 0.421121:  65%|██████▌   | 65/100 [05:34<02:26,  4.20s/it]Best trial: 11. Best value: 0.421121:  66%|██████▌   | 66/100 [05:34<02:27,  4.35s/it]Best trial: 11. Best value: 0.421121:  66%|██████▌   | 66/100 [05:39<02:27,  4.35s/it]Best trial: 11. Best value: 0.421121:  67%|██████▋   | 67/100 [05:39<02:28,  4.49s/it]Best trial: 11. Best value: 0.421121:  67%|██████▋   | 67/100 [05:43<02:28,  4.49s/it]Best trial: 11. Best value: 0.421121:  68%|██████▊   | 68/100 [05:43<02:20,  4.40s/it]Best trial: 11. Best value: 0.421121:  68%|██████▊   | 68/100 [05:52<02:20,  4.40s/it]Best trial: 11. Best value: 0.421121:  69%|██████▉   | 69/100 [05:52<02:59,  5.78s/it]Best trial: 11. Best value: 0.421121:  69%|██████▉   | 69/100 [05:56<02:59,  5.78s/it]Best trial: 11. Best value: 0.421121:  70%|███████   | 70/100 [05:56<02:35,  5.20s/it]Best trial: 11. Best value: 0.421121:  70%|███████   | 70/100 [06:02<02:35,  5.20s/it]Best trial: 11. Best value: 0.421121:  71%|███████   | 71/100 [06:02<02:31,  5.23s/it]Best trial: 11. Best value: 0.421121:  71%|███████   | 71/100 [06:06<02:31,  5.23s/it]Best trial: 11. Best value: 0.421121:  72%|███████▏  | 72/100 [06:06<02:16,  4.87s/it]Best trial: 11. Best value: 0.421121:  72%|███████▏  | 72/100 [06:11<02:16,  4.87s/it]Best trial: 11. Best value: 0.421121:  73%|███████▎  | 73/100 [06:11<02:11,  4.88s/it]Best trial: 11. Best value: 0.421121:  73%|███████▎  | 73/100 [06:14<02:11,  4.88s/it]Best trial: 11. Best value: 0.421121:  74%|███████▍  | 74/100 [06:14<01:58,  4.57s/it]Best trial: 11. Best value: 0.421121:  74%|███████▍  | 74/100 [06:20<01:58,  4.57s/it]Best trial: 11. Best value: 0.421121:  75%|███████▌  | 75/100 [06:20<02:05,  5.01s/it]Best trial: 75. Best value: 0.421796:  75%|███████▌  | 75/100 [06:24<02:05,  5.01s/it]Best trial: 75. Best value: 0.421796:  76%|███████▌  | 76/100 [06:24<01:52,  4.70s/it]Best trial: 75. Best value: 0.421796:  76%|███████▌  | 76/100 [06:33<01:52,  4.70s/it]Best trial: 75. Best value: 0.421796:  77%|███████▋  | 77/100 [06:33<02:13,  5.81s/it]Best trial: 75. Best value: 0.421796:  77%|███████▋  | 77/100 [06:37<02:13,  5.81s/it]Best trial: 75. Best value: 0.421796:  78%|███████▊  | 78/100 [06:37<01:57,  5.32s/it]Best trial: 75. Best value: 0.421796:  78%|███████▊  | 78/100 [06:43<01:57,  5.32s/it]Best trial: 75. Best value: 0.421796:  79%|███████▉  | 79/100 [06:43<01:54,  5.46s/it]Best trial: 75. Best value: 0.421796:  79%|███████▉  | 79/100 [06:48<01:54,  5.46s/it]Best trial: 75. Best value: 0.421796:  80%|████████  | 80/100 [06:48<01:45,  5.27s/it]Best trial: 75. Best value: 0.421796:  80%|████████  | 80/100 [06:52<01:45,  5.27s/it]Best trial: 75. Best value: 0.421796:  81%|████████  | 81/100 [06:52<01:36,  5.07s/it]Best trial: 75. Best value: 0.421796:  81%|████████  | 81/100 [06:56<01:36,  5.07s/it]Best trial: 75. Best value: 0.421796:  82%|████████▏ | 82/100 [06:56<01:27,  4.84s/it]Best trial: 82. Best value: 0.426024:  82%|████████▏ | 82/100 [07:00<01:27,  4.84s/it]Best trial: 82. Best value: 0.426024:  83%|████████▎ | 83/100 [07:00<01:17,  4.58s/it]Best trial: 82. Best value: 0.426024:  83%|████████▎ | 83/100 [07:05<01:17,  4.58s/it]Best trial: 82. Best value: 0.426024:  84%|████████▍ | 84/100 [07:05<01:11,  4.49s/it]Best trial: 82. Best value: 0.426024:  84%|████████▍ | 84/100 [07:09<01:11,  4.49s/it]Best trial: 82. Best value: 0.426024:  85%|████████▌ | 85/100 [07:09<01:05,  4.37s/it]Best trial: 82. Best value: 0.426024:  85%|████████▌ | 85/100 [07:13<01:05,  4.37s/it]Best trial: 82. Best value: 0.426024:  86%|████████▌ | 86/100 [07:13<01:00,  4.31s/it]Best trial: 82. Best value: 0.426024:  86%|████████▌ | 86/100 [07:19<01:00,  4.31s/it]Best trial: 82. Best value: 0.426024:  87%|████████▋ | 87/100 [07:19<01:02,  4.80s/it]Best trial: 82. Best value: 0.426024:  87%|████████▋ | 87/100 [07:23<01:02,  4.80s/it]Best trial: 82. Best value: 0.426024:  88%|████████▊ | 88/100 [07:23<00:55,  4.59s/it]Best trial: 82. Best value: 0.426024:  88%|████████▊ | 88/100 [07:27<00:55,  4.59s/it]Best trial: 82. Best value: 0.426024:  89%|████████▉ | 89/100 [07:27<00:48,  4.37s/it]Best trial: 82. Best value: 0.426024:  89%|████████▉ | 89/100 [07:31<00:48,  4.37s/it]Best trial: 82. Best value: 0.426024:  90%|█████████ | 90/100 [07:31<00:43,  4.37s/it]Best trial: 82. Best value: 0.426024:  90%|█████████ | 90/100 [07:35<00:43,  4.37s/it]Best trial: 82. Best value: 0.426024:  91%|█████████ | 91/100 [07:35<00:39,  4.34s/it]Best trial: 82. Best value: 0.426024:  91%|█████████ | 91/100 [07:39<00:39,  4.34s/it]Best trial: 82. Best value: 0.426024:  92%|█████████▏| 92/100 [07:39<00:33,  4.22s/it]Best trial: 82. Best value: 0.426024:  92%|█████████▏| 92/100 [07:44<00:33,  4.22s/it]Best trial: 82. Best value: 0.426024:  93%|█████████▎| 93/100 [07:44<00:29,  4.25s/it]Best trial: 82. Best value: 0.426024:  93%|█████████▎| 93/100 [07:52<00:29,  4.25s/it]Best trial: 82. Best value: 0.426024:  94%|█████████▍| 94/100 [07:52<00:32,  5.43s/it]Best trial: 82. Best value: 0.426024:  94%|█████████▍| 94/100 [07:57<00:32,  5.43s/it]Best trial: 82. Best value: 0.426024:  95%|█████████▌| 95/100 [07:57<00:25,  5.17s/it]Best trial: 82. Best value: 0.426024:  95%|█████████▌| 95/100 [08:01<00:25,  5.17s/it]Best trial: 82. Best value: 0.426024:  96%|█████████▌| 96/100 [08:01<00:19,  4.98s/it]Best trial: 82. Best value: 0.426024:  96%|█████████▌| 96/100 [08:05<00:19,  4.98s/it]Best trial: 82. Best value: 0.426024:  97%|█████████▋| 97/100 [08:05<00:14,  4.78s/it]Best trial: 82. Best value: 0.426024:  97%|█████████▋| 97/100 [08:09<00:14,  4.78s/it]Best trial: 82. Best value: 0.426024:  98%|█████████▊| 98/100 [08:09<00:09,  4.57s/it]Best trial: 82. Best value: 0.426024:  98%|█████████▊| 98/100 [08:14<00:09,  4.57s/it]Best trial: 82. Best value: 0.426024:  99%|█████████▉| 99/100 [08:14<00:04,  4.43s/it]Best trial: 82. Best value: 0.426024:  99%|█████████▉| 99/100 [08:18<00:04,  4.43s/it]Best trial: 82. Best value: 0.426024: 100%|██████████| 100/100 [08:18<00:00,  4.52s/it]Best trial: 82. Best value: 0.426024: 100%|██████████| 100/100 [08:18<00:00,  4.99s/it]
2025-11-30 14:25:47,713 - INFO - HPO Complete. Best AUPRC: 0.4260
2025-11-30 14:25:47,713 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.00028155851794636923, 'max_depth': 3, 'subsample': 0.6355489302989998, 'colsample_bytree': 0.8011540758849997, 'gamma': 0.8935693498016303, 'reg_lambda': 9.349812135695269e-06, 'reg_alpha': 0.026751852264801094}
2025-11-30 14:25:47,714 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:25:49,695 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 14:25:49,696 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:25:49,898 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:25:49,964 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:25:49,977 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:25:49,977 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 14:25:49,977 - INFO - Training model...
2025-11-30 14:25:55,492 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:26:01,978 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:26:01,978 - INFO - AUROC: 0.7352 (0.5168 - 0.8874)
2025-11-30 14:26:01,978 - INFO - AUPRC: 0.0977 (0.0308 - 0.2482)
2025-11-30 14:26:01,978 - INFO - Brier Score: 0.1687 (0.1672 - 0.1709)
2025-11-30 14:26:01,978 - INFO - Accuracy: 0.9682 (0.8980 - 0.9876)
2025-11-30 14:26:01,978 - INFO - Precision: 0.1667 (0.0532 - 0.4400)
2025-11-30 14:26:01,978 - INFO - Sensitivity (Recall): 0.3000 (0.1495 - 0.5833)
2025-11-30 14:26:01,978 - INFO - F1-Score: 0.2143 (0.0886 - 0.4114)
2025-11-30 14:26:01,978 - INFO - Best Threshold: 0.5100 (0.4400 - 0.5400)
2025-11-30 14:26:01,978 - INFO - Specificity: 0.9780 (0.9047 - 0.9947)
2025-11-30 14:26:01,999 - INFO - Calculating SHAP values...
2025-11-30 14:26:03,139 - INFO - SHAP plots saved.
2025-11-30 14:26:03,141 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=severe_aki | Branch=windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:26:04,456 - INFO - Starting HPO for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 14:26:04,456 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:26:04,657 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:26:04,725 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:26:04,738 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:26:04,738 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.304746:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.304746:   1%|          | 1/100 [00:06<11:18,  6.86s/it]Best trial: 1. Best value: 0.323028:   1%|          | 1/100 [00:11<11:18,  6.86s/it]Best trial: 1. Best value: 0.323028:   2%|▏         | 2/100 [00:11<08:45,  5.36s/it]Best trial: 1. Best value: 0.323028:   2%|▏         | 2/100 [00:17<08:45,  5.36s/it]Best trial: 1. Best value: 0.323028:   3%|▎         | 3/100 [00:17<09:05,  5.63s/it]Best trial: 3. Best value: 0.327241:   3%|▎         | 3/100 [00:20<09:05,  5.63s/it]Best trial: 3. Best value: 0.327241:   4%|▍         | 4/100 [00:20<07:51,  4.91s/it]Best trial: 3. Best value: 0.327241:   4%|▍         | 4/100 [00:27<07:51,  4.91s/it]Best trial: 3. Best value: 0.327241:   5%|▌         | 5/100 [00:27<08:31,  5.38s/it]Best trial: 3. Best value: 0.327241:   5%|▌         | 5/100 [00:36<08:31,  5.38s/it]Best trial: 3. Best value: 0.327241:   6%|▌         | 6/100 [00:36<10:23,  6.63s/it]Best trial: 3. Best value: 0.327241:   6%|▌         | 6/100 [00:41<10:23,  6.63s/it]Best trial: 3. Best value: 0.327241:   7%|▋         | 7/100 [00:41<09:25,  6.08s/it]Best trial: 3. Best value: 0.327241:   7%|▋         | 7/100 [00:47<09:25,  6.08s/it]Best trial: 3. Best value: 0.327241:   8%|▊         | 8/100 [00:47<09:17,  6.06s/it]Best trial: 3. Best value: 0.327241:   8%|▊         | 8/100 [00:51<09:17,  6.06s/it]Best trial: 3. Best value: 0.327241:   9%|▉         | 9/100 [00:51<08:35,  5.67s/it]Best trial: 3. Best value: 0.327241:   9%|▉         | 9/100 [00:56<08:35,  5.67s/it]Best trial: 3. Best value: 0.327241:  10%|█         | 10/100 [00:56<08:09,  5.44s/it]Best trial: 3. Best value: 0.327241:  10%|█         | 10/100 [01:02<08:09,  5.44s/it]Best trial: 3. Best value: 0.327241:  11%|█         | 11/100 [01:02<07:59,  5.39s/it]Best trial: 11. Best value: 0.35371:  11%|█         | 11/100 [01:07<07:59,  5.39s/it]Best trial: 11. Best value: 0.35371:  12%|█▏        | 12/100 [01:07<07:57,  5.43s/it]Best trial: 11. Best value: 0.35371:  12%|█▏        | 12/100 [01:13<07:57,  5.43s/it]Best trial: 11. Best value: 0.35371:  13%|█▎        | 13/100 [01:13<07:54,  5.45s/it]Best trial: 11. Best value: 0.35371:  13%|█▎        | 13/100 [01:18<07:54,  5.45s/it]Best trial: 11. Best value: 0.35371:  14%|█▍        | 14/100 [01:18<07:37,  5.32s/it]Best trial: 11. Best value: 0.35371:  14%|█▍        | 14/100 [01:25<07:37,  5.32s/it]Best trial: 11. Best value: 0.35371:  15%|█▌        | 15/100 [01:25<08:18,  5.86s/it]Best trial: 11. Best value: 0.35371:  15%|█▌        | 15/100 [01:31<08:18,  5.86s/it]Best trial: 11. Best value: 0.35371:  16%|█▌        | 16/100 [01:31<08:11,  5.85s/it]Best trial: 11. Best value: 0.35371:  16%|█▌        | 16/100 [01:35<08:11,  5.85s/it]Best trial: 11. Best value: 0.35371:  17%|█▋        | 17/100 [01:35<07:38,  5.53s/it]Best trial: 11. Best value: 0.35371:  17%|█▋        | 17/100 [01:41<07:38,  5.53s/it]Best trial: 11. Best value: 0.35371:  18%|█▊        | 18/100 [01:41<07:42,  5.65s/it]Best trial: 11. Best value: 0.35371:  18%|█▊        | 18/100 [01:47<07:42,  5.65s/it]Best trial: 11. Best value: 0.35371:  19%|█▉        | 19/100 [01:47<07:32,  5.59s/it]Best trial: 11. Best value: 0.35371:  19%|█▉        | 19/100 [01:54<07:32,  5.59s/it]Best trial: 11. Best value: 0.35371:  20%|██        | 20/100 [01:54<08:12,  6.15s/it]Best trial: 11. Best value: 0.35371:  20%|██        | 20/100 [02:01<08:12,  6.15s/it]Best trial: 11. Best value: 0.35371:  21%|██        | 21/100 [02:01<08:10,  6.21s/it]Best trial: 11. Best value: 0.35371:  21%|██        | 21/100 [02:05<08:10,  6.21s/it]Best trial: 11. Best value: 0.35371:  22%|██▏       | 22/100 [02:05<07:27,  5.74s/it]Best trial: 11. Best value: 0.35371:  22%|██▏       | 22/100 [02:09<07:27,  5.74s/it]Best trial: 11. Best value: 0.35371:  23%|██▎       | 23/100 [02:09<06:37,  5.16s/it]Best trial: 11. Best value: 0.35371:  23%|██▎       | 23/100 [02:14<06:37,  5.16s/it]Best trial: 11. Best value: 0.35371:  24%|██▍       | 24/100 [02:14<06:34,  5.20s/it]Best trial: 11. Best value: 0.35371:  24%|██▍       | 24/100 [02:20<06:34,  5.20s/it]Best trial: 11. Best value: 0.35371:  25%|██▌       | 25/100 [02:20<06:37,  5.30s/it]Best trial: 11. Best value: 0.35371:  25%|██▌       | 25/100 [02:24<06:37,  5.30s/it]Best trial: 11. Best value: 0.35371:  26%|██▌       | 26/100 [02:24<05:59,  4.86s/it]Best trial: 11. Best value: 0.35371:  26%|██▌       | 26/100 [02:29<05:59,  4.86s/it]Best trial: 11. Best value: 0.35371:  27%|██▋       | 27/100 [02:29<06:10,  5.07s/it]Best trial: 11. Best value: 0.35371:  27%|██▋       | 27/100 [02:34<06:10,  5.07s/it]Best trial: 11. Best value: 0.35371:  28%|██▊       | 28/100 [02:34<05:51,  4.89s/it]Best trial: 11. Best value: 0.35371:  28%|██▊       | 28/100 [02:38<05:51,  4.89s/it]Best trial: 11. Best value: 0.35371:  29%|██▉       | 29/100 [02:38<05:31,  4.67s/it]Best trial: 11. Best value: 0.35371:  29%|██▉       | 29/100 [02:45<05:31,  4.67s/it]Best trial: 11. Best value: 0.35371:  30%|███       | 30/100 [02:45<06:09,  5.28s/it]Best trial: 11. Best value: 0.35371:  30%|███       | 30/100 [02:49<06:09,  5.28s/it]Best trial: 11. Best value: 0.35371:  31%|███       | 31/100 [02:49<05:54,  5.13s/it]Best trial: 11. Best value: 0.35371:  31%|███       | 31/100 [02:53<05:54,  5.13s/it]Best trial: 11. Best value: 0.35371:  32%|███▏      | 32/100 [02:53<05:24,  4.78s/it]Best trial: 11. Best value: 0.35371:  32%|███▏      | 32/100 [02:59<05:24,  4.78s/it]Best trial: 11. Best value: 0.35371:  33%|███▎      | 33/100 [02:59<05:43,  5.13s/it]Best trial: 11. Best value: 0.35371:  33%|███▎      | 33/100 [03:03<05:43,  5.13s/it]Best trial: 11. Best value: 0.35371:  34%|███▍      | 34/100 [03:03<05:15,  4.78s/it]Best trial: 11. Best value: 0.35371:  34%|███▍      | 34/100 [03:08<05:15,  4.78s/it]Best trial: 11. Best value: 0.35371:  35%|███▌      | 35/100 [03:08<05:14,  4.84s/it]Best trial: 11. Best value: 0.35371:  35%|███▌      | 35/100 [03:15<05:14,  4.84s/it]Best trial: 11. Best value: 0.35371:  36%|███▌      | 36/100 [03:15<05:39,  5.30s/it]Best trial: 11. Best value: 0.35371:  36%|███▌      | 36/100 [03:21<05:39,  5.30s/it]Best trial: 11. Best value: 0.35371:  37%|███▋      | 37/100 [03:21<06:02,  5.75s/it]Best trial: 11. Best value: 0.35371:  37%|███▋      | 37/100 [03:27<06:02,  5.75s/it]Best trial: 11. Best value: 0.35371:  38%|███▊      | 38/100 [03:27<06:02,  5.84s/it]Best trial: 11. Best value: 0.35371:  38%|███▊      | 38/100 [03:34<06:02,  5.84s/it]Best trial: 11. Best value: 0.35371:  39%|███▉      | 39/100 [03:34<06:07,  6.02s/it]Best trial: 11. Best value: 0.35371:  39%|███▉      | 39/100 [03:44<06:07,  6.02s/it]Best trial: 11. Best value: 0.35371:  40%|████      | 40/100 [03:44<07:12,  7.21s/it]Best trial: 11. Best value: 0.35371:  40%|████      | 40/100 [03:51<07:12,  7.21s/it]Best trial: 11. Best value: 0.35371:  41%|████      | 41/100 [03:51<06:59,  7.11s/it]Best trial: 11. Best value: 0.35371:  41%|████      | 41/100 [03:59<06:59,  7.11s/it]Best trial: 11. Best value: 0.35371:  42%|████▏     | 42/100 [03:59<07:03,  7.30s/it]Best trial: 11. Best value: 0.35371:  42%|████▏     | 42/100 [04:05<07:03,  7.30s/it]Best trial: 11. Best value: 0.35371:  43%|████▎     | 43/100 [04:05<06:39,  7.00s/it]Best trial: 11. Best value: 0.35371:  43%|████▎     | 43/100 [04:11<06:39,  7.00s/it]Best trial: 11. Best value: 0.35371:  44%|████▍     | 44/100 [04:11<06:15,  6.71s/it]Best trial: 11. Best value: 0.35371:  44%|████▍     | 44/100 [04:18<06:15,  6.71s/it]Best trial: 11. Best value: 0.35371:  45%|████▌     | 45/100 [04:18<06:10,  6.74s/it]Best trial: 11. Best value: 0.35371:  45%|████▌     | 45/100 [04:23<06:10,  6.74s/it]Best trial: 11. Best value: 0.35371:  46%|████▌     | 46/100 [04:23<05:38,  6.28s/it]Best trial: 11. Best value: 0.35371:  46%|████▌     | 46/100 [04:29<05:38,  6.28s/it]Best trial: 11. Best value: 0.35371:  47%|████▋     | 47/100 [04:29<05:29,  6.21s/it]Best trial: 11. Best value: 0.35371:  47%|████▋     | 47/100 [04:35<05:29,  6.21s/it]Best trial: 11. Best value: 0.35371:  48%|████▊     | 48/100 [04:35<05:18,  6.13s/it]Best trial: 11. Best value: 0.35371:  48%|████▊     | 48/100 [04:41<05:18,  6.13s/it]Best trial: 11. Best value: 0.35371:  49%|████▉     | 49/100 [04:41<05:09,  6.06s/it]Best trial: 11. Best value: 0.35371:  49%|████▉     | 49/100 [04:48<05:09,  6.06s/it]Best trial: 11. Best value: 0.35371:  50%|█████     | 50/100 [04:48<05:19,  6.39s/it]Best trial: 11. Best value: 0.35371:  50%|█████     | 50/100 [04:56<05:19,  6.39s/it]Best trial: 11. Best value: 0.35371:  51%|█████     | 51/100 [04:56<05:31,  6.77s/it]Best trial: 11. Best value: 0.35371:  51%|█████     | 51/100 [05:00<05:31,  6.77s/it]Best trial: 11. Best value: 0.35371:  52%|█████▏    | 52/100 [05:00<04:57,  6.19s/it]Best trial: 11. Best value: 0.35371:  52%|█████▏    | 52/100 [05:05<04:57,  6.19s/it]Best trial: 11. Best value: 0.35371:  53%|█████▎    | 53/100 [05:05<04:22,  5.60s/it]Best trial: 11. Best value: 0.35371:  53%|█████▎    | 53/100 [05:10<04:22,  5.60s/it]Best trial: 11. Best value: 0.35371:  54%|█████▍    | 54/100 [05:10<04:18,  5.61s/it]Best trial: 11. Best value: 0.35371:  54%|█████▍    | 54/100 [05:15<04:18,  5.61s/it]Best trial: 11. Best value: 0.35371:  55%|█████▌    | 55/100 [05:15<03:55,  5.23s/it]Best trial: 11. Best value: 0.35371:  55%|█████▌    | 55/100 [05:21<03:55,  5.23s/it]Best trial: 11. Best value: 0.35371:  56%|█████▌    | 56/100 [05:21<04:10,  5.70s/it]Best trial: 11. Best value: 0.35371:  56%|█████▌    | 56/100 [05:27<04:10,  5.70s/it]Best trial: 11. Best value: 0.35371:  57%|█████▋    | 57/100 [05:27<04:02,  5.65s/it]Best trial: 11. Best value: 0.35371:  57%|█████▋    | 57/100 [05:33<04:02,  5.65s/it]Best trial: 11. Best value: 0.35371:  58%|█████▊    | 58/100 [05:33<04:04,  5.82s/it]Best trial: 11. Best value: 0.35371:  58%|█████▊    | 58/100 [05:40<04:04,  5.82s/it]Best trial: 11. Best value: 0.35371:  59%|█████▉    | 59/100 [05:40<04:11,  6.12s/it]Best trial: 11. Best value: 0.35371:  59%|█████▉    | 59/100 [05:46<04:11,  6.12s/it]Best trial: 11. Best value: 0.35371:  60%|██████    | 60/100 [05:46<03:58,  5.95s/it]Best trial: 11. Best value: 0.35371:  60%|██████    | 60/100 [05:50<03:58,  5.95s/it]Best trial: 11. Best value: 0.35371:  61%|██████    | 61/100 [05:50<03:34,  5.51s/it]Best trial: 61. Best value: 0.364661:  61%|██████    | 61/100 [05:55<03:34,  5.51s/it]Best trial: 61. Best value: 0.364661:  62%|██████▏   | 62/100 [05:55<03:27,  5.45s/it]Best trial: 61. Best value: 0.364661:  62%|██████▏   | 62/100 [06:01<03:27,  5.45s/it]Best trial: 61. Best value: 0.364661:  63%|██████▎   | 63/100 [06:01<03:21,  5.45s/it]Best trial: 61. Best value: 0.364661:  63%|██████▎   | 63/100 [06:05<03:21,  5.45s/it]Best trial: 61. Best value: 0.364661:  64%|██████▍   | 64/100 [06:05<03:02,  5.07s/it]Best trial: 61. Best value: 0.364661:  64%|██████▍   | 64/100 [06:11<03:02,  5.07s/it]Best trial: 61. Best value: 0.364661:  65%|██████▌   | 65/100 [06:11<03:10,  5.44s/it]Best trial: 61. Best value: 0.364661:  65%|██████▌   | 65/100 [06:18<03:10,  5.44s/it]Best trial: 61. Best value: 0.364661:  66%|██████▌   | 66/100 [06:18<03:19,  5.88s/it]Best trial: 61. Best value: 0.364661:  66%|██████▌   | 66/100 [06:23<03:19,  5.88s/it]Best trial: 61. Best value: 0.364661:  67%|██████▋   | 67/100 [06:23<03:03,  5.55s/it]Best trial: 61. Best value: 0.364661:  67%|██████▋   | 67/100 [06:27<03:03,  5.55s/it]Best trial: 61. Best value: 0.364661:  68%|██████▊   | 68/100 [06:27<02:45,  5.19s/it]Best trial: 61. Best value: 0.364661:  68%|██████▊   | 68/100 [06:32<02:45,  5.19s/it]Best trial: 61. Best value: 0.364661:  69%|██████▉   | 69/100 [06:32<02:40,  5.19s/it]Best trial: 61. Best value: 0.364661:  69%|██████▉   | 69/100 [06:37<02:40,  5.19s/it]Best trial: 61. Best value: 0.364661:  70%|███████   | 70/100 [06:37<02:33,  5.13s/it]Best trial: 61. Best value: 0.364661:  70%|███████   | 70/100 [06:42<02:33,  5.13s/it]Best trial: 61. Best value: 0.364661:  71%|███████   | 71/100 [06:42<02:26,  5.05s/it]Best trial: 71. Best value: 0.37608:  71%|███████   | 71/100 [06:47<02:26,  5.05s/it] Best trial: 71. Best value: 0.37608:  72%|███████▏  | 72/100 [06:47<02:20,  5.03s/it]Best trial: 71. Best value: 0.37608:  72%|███████▏  | 72/100 [06:52<02:20,  5.03s/it]Best trial: 71. Best value: 0.37608:  73%|███████▎  | 73/100 [06:52<02:16,  5.04s/it]Best trial: 71. Best value: 0.37608:  73%|███████▎  | 73/100 [06:57<02:16,  5.04s/it]Best trial: 71. Best value: 0.37608:  74%|███████▍  | 74/100 [06:57<02:09,  4.99s/it]Best trial: 71. Best value: 0.37608:  74%|███████▍  | 74/100 [07:03<02:09,  4.99s/it]Best trial: 71. Best value: 0.37608:  75%|███████▌  | 75/100 [07:03<02:08,  5.16s/it]Best trial: 71. Best value: 0.37608:  75%|███████▌  | 75/100 [07:07<02:08,  5.16s/it]Best trial: 71. Best value: 0.37608:  76%|███████▌  | 76/100 [07:07<01:55,  4.80s/it]Best trial: 71. Best value: 0.37608:  76%|███████▌  | 76/100 [07:11<01:55,  4.80s/it]Best trial: 71. Best value: 0.37608:  77%|███████▋  | 77/100 [07:11<01:48,  4.72s/it]Best trial: 71. Best value: 0.37608:  77%|███████▋  | 77/100 [07:16<01:48,  4.72s/it]Best trial: 71. Best value: 0.37608:  78%|███████▊  | 78/100 [07:16<01:42,  4.66s/it]Best trial: 71. Best value: 0.37608:  78%|███████▊  | 78/100 [07:20<01:42,  4.66s/it]Best trial: 71. Best value: 0.37608:  79%|███████▉  | 79/100 [07:20<01:35,  4.54s/it]Best trial: 71. Best value: 0.37608:  79%|███████▉  | 79/100 [07:26<01:35,  4.54s/it]Best trial: 71. Best value: 0.37608:  80%|████████  | 80/100 [07:26<01:36,  4.84s/it]Best trial: 71. Best value: 0.37608:  80%|████████  | 80/100 [07:30<01:36,  4.84s/it]Best trial: 71. Best value: 0.37608:  81%|████████  | 81/100 [07:30<01:31,  4.80s/it]Best trial: 71. Best value: 0.37608:  81%|████████  | 81/100 [07:35<01:31,  4.80s/it]Best trial: 71. Best value: 0.37608:  82%|████████▏ | 82/100 [07:35<01:26,  4.80s/it]Best trial: 71. Best value: 0.37608:  82%|████████▏ | 82/100 [07:40<01:26,  4.80s/it]Best trial: 71. Best value: 0.37608:  83%|████████▎ | 83/100 [07:40<01:21,  4.80s/it]Best trial: 71. Best value: 0.37608:  83%|████████▎ | 83/100 [07:44<01:21,  4.80s/it]Best trial: 71. Best value: 0.37608:  84%|████████▍ | 84/100 [07:44<01:14,  4.65s/it]Best trial: 71. Best value: 0.37608:  84%|████████▍ | 84/100 [07:49<01:14,  4.65s/it]Best trial: 71. Best value: 0.37608:  85%|████████▌ | 85/100 [07:49<01:08,  4.54s/it]Best trial: 71. Best value: 0.37608:  85%|████████▌ | 85/100 [07:53<01:08,  4.54s/it]Best trial: 71. Best value: 0.37608:  86%|████████▌ | 86/100 [07:53<01:05,  4.66s/it]Best trial: 71. Best value: 0.37608:  86%|████████▌ | 86/100 [07:59<01:05,  4.66s/it]Best trial: 71. Best value: 0.37608:  87%|████████▋ | 87/100 [07:59<01:03,  4.87s/it]Best trial: 71. Best value: 0.37608:  87%|████████▋ | 87/100 [08:04<01:03,  4.87s/it]Best trial: 71. Best value: 0.37608:  88%|████████▊ | 88/100 [08:04<01:00,  5.01s/it]Best trial: 71. Best value: 0.37608:  88%|████████▊ | 88/100 [08:10<01:00,  5.01s/it]Best trial: 71. Best value: 0.37608:  89%|████████▉ | 89/100 [08:10<00:57,  5.22s/it]Best trial: 71. Best value: 0.37608:  89%|████████▉ | 89/100 [08:16<00:57,  5.22s/it]Best trial: 71. Best value: 0.37608:  90%|█████████ | 90/100 [08:16<00:54,  5.49s/it]Best trial: 71. Best value: 0.37608:  90%|█████████ | 90/100 [08:21<00:54,  5.49s/it]Best trial: 71. Best value: 0.37608:  91%|█████████ | 91/100 [08:21<00:48,  5.38s/it]Best trial: 71. Best value: 0.37608:  91%|█████████ | 91/100 [08:25<00:48,  5.38s/it]Best trial: 71. Best value: 0.37608:  92%|█████████▏| 92/100 [08:25<00:40,  5.06s/it]Best trial: 71. Best value: 0.37608:  92%|█████████▏| 92/100 [08:31<00:40,  5.06s/it]Best trial: 71. Best value: 0.37608:  93%|█████████▎| 93/100 [08:31<00:35,  5.12s/it]Best trial: 71. Best value: 0.37608:  93%|█████████▎| 93/100 [08:35<00:35,  5.12s/it]Best trial: 71. Best value: 0.37608:  94%|█████████▍| 94/100 [08:35<00:28,  4.83s/it]Best trial: 71. Best value: 0.37608:  94%|█████████▍| 94/100 [08:39<00:28,  4.83s/it]Best trial: 71. Best value: 0.37608:  95%|█████████▌| 95/100 [08:39<00:23,  4.70s/it]Best trial: 71. Best value: 0.37608:  95%|█████████▌| 95/100 [08:44<00:23,  4.70s/it]Best trial: 71. Best value: 0.37608:  96%|█████████▌| 96/100 [08:44<00:19,  4.84s/it]Best trial: 71. Best value: 0.37608:  96%|█████████▌| 96/100 [08:50<00:19,  4.84s/it]Best trial: 71. Best value: 0.37608:  97%|█████████▋| 97/100 [08:50<00:15,  5.09s/it]Best trial: 71. Best value: 0.37608:  97%|█████████▋| 97/100 [08:56<00:15,  5.09s/it]Best trial: 71. Best value: 0.37608:  98%|█████████▊| 98/100 [08:56<00:10,  5.40s/it]Best trial: 71. Best value: 0.37608:  98%|█████████▊| 98/100 [09:00<00:10,  5.40s/it]Best trial: 71. Best value: 0.37608:  99%|█████████▉| 99/100 [09:00<00:05,  5.07s/it]Best trial: 71. Best value: 0.37608:  99%|█████████▉| 99/100 [09:05<00:05,  5.07s/it]Best trial: 71. Best value: 0.37608: 100%|██████████| 100/100 [09:05<00:00,  4.96s/it]Best trial: 71. Best value: 0.37608: 100%|██████████| 100/100 [09:05<00:00,  5.46s/it]
2025-11-30 14:35:10,426 - INFO - HPO Complete. Best AUPRC: 0.3761
2025-11-30 14:35:10,426 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.0008748166711057594, 'max_depth': 4, 'subsample': 0.6838063870015906, 'colsample_bytree': 0.8087473241078201, 'gamma': 1.9660612950053626, 'reg_lambda': 1.7609743889404224e-06, 'reg_alpha': 0.0051966247246009335}
2025-11-30 14:35:10,427 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/severe_aki/windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:35:12,430 - INFO - Starting Training/Evaluation for Outcome: severe_aki, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 14:35:12,430 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 14:35:12,637 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 14:35:12,704 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:35:12,717 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 14:35:12,717 - INFO - Positive samples in train: 39, Negative: 2722, Scale Pos Weight: 69.7949
2025-11-30 14:35:12,717 - INFO - Training model...
2025-11-30 14:35:16,002 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:35:22,532 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:35:22,533 - INFO - AUROC: 0.7120 (0.5114 - 0.8560)
2025-11-30 14:35:22,533 - INFO - AUPRC: 0.1117 (0.0277 - 0.2526)
2025-11-30 14:35:22,533 - INFO - Brier Score: 0.1437 (0.1419 - 0.1465)
2025-11-30 14:35:22,533 - INFO - Accuracy: 0.9451 (0.8685 - 0.9905)
2025-11-30 14:35:22,533 - INFO - Precision: 0.1111 (0.0515 - 0.6000)
2025-11-30 14:35:22,533 - INFO - Sensitivity (Recall): 0.4000 (0.1058 - 0.6167)
2025-11-30 14:35:22,533 - INFO - F1-Score: 0.1739 (0.0721 - 0.3933)
2025-11-30 14:35:22,533 - INFO - Best Threshold: 0.4500 (0.3900 - 0.5500)
2025-11-30 14:35:22,533 - INFO - Specificity: 0.9531 (0.8748 - 0.9985)
2025-11-30 14:35:22,544 - INFO - Calculating SHAP values...
2025-11-30 14:35:23,634 - INFO - SHAP plots saved.
2025-11-30 14:35:23,635 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/severe_aki/windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:35:24,934 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_only
2025-11-30 14:35:24,934 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:35:25,040 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:35:25,061 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:35:25,066 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 14:35:25,066 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.128874:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.128874:   1%|          | 1/100 [00:01<01:56,  1.18s/it]Best trial: 0. Best value: 0.128874:   1%|          | 1/100 [00:02<01:56,  1.18s/it]Best trial: 0. Best value: 0.128874:   2%|▏         | 2/100 [00:02<01:51,  1.14s/it]Best trial: 0. Best value: 0.128874:   2%|▏         | 2/100 [00:04<01:51,  1.14s/it]Best trial: 0. Best value: 0.128874:   3%|▎         | 3/100 [00:04<02:19,  1.44s/it]Best trial: 0. Best value: 0.128874:   3%|▎         | 3/100 [00:05<02:19,  1.44s/it]Best trial: 0. Best value: 0.128874:   4%|▍         | 4/100 [00:05<02:07,  1.33s/it]Best trial: 4. Best value: 0.15039:   4%|▍         | 4/100 [00:06<02:07,  1.33s/it] Best trial: 4. Best value: 0.15039:   5%|▌         | 5/100 [00:06<02:06,  1.33s/it]Best trial: 4. Best value: 0.15039:   5%|▌         | 5/100 [00:07<02:06,  1.33s/it]Best trial: 4. Best value: 0.15039:   6%|▌         | 6/100 [00:07<02:05,  1.33s/it]Best trial: 4. Best value: 0.15039:   6%|▌         | 6/100 [00:09<02:05,  1.33s/it]Best trial: 4. Best value: 0.15039:   7%|▋         | 7/100 [00:09<02:12,  1.43s/it]Best trial: 4. Best value: 0.15039:   7%|▋         | 7/100 [00:11<02:12,  1.43s/it]Best trial: 4. Best value: 0.15039:   8%|▊         | 8/100 [00:11<02:26,  1.60s/it]Best trial: 4. Best value: 0.15039:   8%|▊         | 8/100 [00:13<02:26,  1.60s/it]Best trial: 4. Best value: 0.15039:   9%|▉         | 9/100 [00:13<02:26,  1.61s/it]Best trial: 4. Best value: 0.15039:   9%|▉         | 9/100 [00:14<02:26,  1.61s/it]Best trial: 4. Best value: 0.15039:  10%|█         | 10/100 [00:14<02:18,  1.54s/it]Best trial: 4. Best value: 0.15039:  10%|█         | 10/100 [00:16<02:18,  1.54s/it]Best trial: 4. Best value: 0.15039:  11%|█         | 11/100 [00:16<02:27,  1.66s/it]Best trial: 4. Best value: 0.15039:  11%|█         | 11/100 [00:18<02:27,  1.66s/it]Best trial: 4. Best value: 0.15039:  12%|█▏        | 12/100 [00:18<02:28,  1.68s/it]Best trial: 4. Best value: 0.15039:  12%|█▏        | 12/100 [00:19<02:28,  1.68s/it]Best trial: 4. Best value: 0.15039:  13%|█▎        | 13/100 [00:19<02:24,  1.66s/it]Best trial: 4. Best value: 0.15039:  13%|█▎        | 13/100 [00:21<02:24,  1.66s/it]Best trial: 4. Best value: 0.15039:  14%|█▍        | 14/100 [00:21<02:18,  1.62s/it]Best trial: 4. Best value: 0.15039:  14%|█▍        | 14/100 [00:23<02:18,  1.62s/it]Best trial: 4. Best value: 0.15039:  15%|█▌        | 15/100 [00:23<02:23,  1.68s/it]Best trial: 4. Best value: 0.15039:  15%|█▌        | 15/100 [00:24<02:23,  1.68s/it]Best trial: 4. Best value: 0.15039:  16%|█▌        | 16/100 [00:24<02:17,  1.64s/it]Best trial: 4. Best value: 0.15039:  16%|█▌        | 16/100 [00:25<02:17,  1.64s/it]Best trial: 4. Best value: 0.15039:  17%|█▋        | 17/100 [00:25<02:02,  1.48s/it]Best trial: 4. Best value: 0.15039:  17%|█▋        | 17/100 [00:27<02:02,  1.48s/it]Best trial: 4. Best value: 0.15039:  18%|█▊        | 18/100 [00:27<01:58,  1.44s/it]Best trial: 4. Best value: 0.15039:  18%|█▊        | 18/100 [00:28<01:58,  1.44s/it]Best trial: 4. Best value: 0.15039:  19%|█▉        | 19/100 [00:28<02:03,  1.52s/it]Best trial: 4. Best value: 0.15039:  19%|█▉        | 19/100 [00:30<02:03,  1.52s/it]Best trial: 4. Best value: 0.15039:  20%|██        | 20/100 [00:30<02:04,  1.55s/it]Best trial: 4. Best value: 0.15039:  20%|██        | 20/100 [00:32<02:04,  1.55s/it]Best trial: 4. Best value: 0.15039:  21%|██        | 21/100 [00:32<02:09,  1.64s/it]Best trial: 21. Best value: 0.169517:  21%|██        | 21/100 [00:33<02:09,  1.64s/it]Best trial: 21. Best value: 0.169517:  22%|██▏       | 22/100 [00:33<02:02,  1.57s/it]Best trial: 21. Best value: 0.169517:  22%|██▏       | 22/100 [00:35<02:02,  1.57s/it]Best trial: 21. Best value: 0.169517:  23%|██▎       | 23/100 [00:35<01:59,  1.55s/it]Best trial: 21. Best value: 0.169517:  23%|██▎       | 23/100 [00:37<01:59,  1.55s/it]Best trial: 21. Best value: 0.169517:  24%|██▍       | 24/100 [00:37<02:05,  1.65s/it]Best trial: 21. Best value: 0.169517:  24%|██▍       | 24/100 [00:38<02:05,  1.65s/it]Best trial: 21. Best value: 0.169517:  25%|██▌       | 25/100 [00:38<02:01,  1.63s/it]Best trial: 25. Best value: 0.186642:  25%|██▌       | 25/100 [00:39<02:01,  1.63s/it]Best trial: 25. Best value: 0.186642:  26%|██▌       | 26/100 [00:39<01:51,  1.50s/it]Best trial: 25. Best value: 0.186642:  26%|██▌       | 26/100 [00:41<01:51,  1.50s/it]Best trial: 25. Best value: 0.186642:  27%|██▋       | 27/100 [00:41<01:42,  1.40s/it]Best trial: 25. Best value: 0.186642:  27%|██▋       | 27/100 [00:42<01:42,  1.40s/it]Best trial: 25. Best value: 0.186642:  28%|██▊       | 28/100 [00:42<01:40,  1.40s/it]Best trial: 25. Best value: 0.186642:  28%|██▊       | 28/100 [00:43<01:40,  1.40s/it]Best trial: 25. Best value: 0.186642:  29%|██▉       | 29/100 [00:43<01:38,  1.38s/it]Best trial: 25. Best value: 0.186642:  29%|██▉       | 29/100 [00:45<01:38,  1.38s/it]Best trial: 25. Best value: 0.186642:  30%|███       | 30/100 [00:45<01:38,  1.40s/it]Best trial: 25. Best value: 0.186642:  30%|███       | 30/100 [00:46<01:38,  1.40s/it]Best trial: 25. Best value: 0.186642:  31%|███       | 31/100 [00:46<01:28,  1.29s/it]Best trial: 25. Best value: 0.186642:  31%|███       | 31/100 [00:47<01:28,  1.29s/it]Best trial: 25. Best value: 0.186642:  32%|███▏      | 32/100 [00:47<01:32,  1.37s/it]Best trial: 25. Best value: 0.186642:  32%|███▏      | 32/100 [00:49<01:32,  1.37s/it]Best trial: 25. Best value: 0.186642:  33%|███▎      | 33/100 [00:49<01:33,  1.40s/it]Best trial: 25. Best value: 0.186642:  33%|███▎      | 33/100 [00:50<01:33,  1.40s/it]Best trial: 25. Best value: 0.186642:  34%|███▍      | 34/100 [00:50<01:28,  1.34s/it]Best trial: 25. Best value: 0.186642:  34%|███▍      | 34/100 [00:51<01:28,  1.34s/it]Best trial: 25. Best value: 0.186642:  35%|███▌      | 35/100 [00:51<01:22,  1.27s/it]Best trial: 25. Best value: 0.186642:  35%|███▌      | 35/100 [00:53<01:22,  1.27s/it]Best trial: 25. Best value: 0.186642:  36%|███▌      | 36/100 [00:53<01:26,  1.35s/it]Best trial: 25. Best value: 0.186642:  36%|███▌      | 36/100 [00:54<01:26,  1.35s/it]Best trial: 25. Best value: 0.186642:  37%|███▋      | 37/100 [00:54<01:22,  1.30s/it]Best trial: 25. Best value: 0.186642:  37%|███▋      | 37/100 [00:55<01:22,  1.30s/it]Best trial: 25. Best value: 0.186642:  38%|███▊      | 38/100 [00:55<01:22,  1.34s/it]Best trial: 25. Best value: 0.186642:  38%|███▊      | 38/100 [00:57<01:22,  1.34s/it]Best trial: 25. Best value: 0.186642:  39%|███▉      | 39/100 [00:57<01:24,  1.39s/it]Best trial: 25. Best value: 0.186642:  39%|███▉      | 39/100 [00:58<01:24,  1.39s/it]Best trial: 25. Best value: 0.186642:  40%|████      | 40/100 [00:58<01:22,  1.37s/it]Best trial: 25. Best value: 0.186642:  40%|████      | 40/100 [00:59<01:22,  1.37s/it]Best trial: 25. Best value: 0.186642:  41%|████      | 41/100 [00:59<01:19,  1.35s/it]Best trial: 25. Best value: 0.186642:  41%|████      | 41/100 [01:01<01:19,  1.35s/it]Best trial: 25. Best value: 0.186642:  42%|████▏     | 42/100 [01:01<01:18,  1.36s/it]Best trial: 25. Best value: 0.186642:  42%|████▏     | 42/100 [01:02<01:18,  1.36s/it]Best trial: 25. Best value: 0.186642:  43%|████▎     | 43/100 [01:02<01:13,  1.29s/it]Best trial: 25. Best value: 0.186642:  43%|████▎     | 43/100 [01:03<01:13,  1.29s/it]Best trial: 25. Best value: 0.186642:  44%|████▍     | 44/100 [01:03<01:09,  1.24s/it]Best trial: 25. Best value: 0.186642:  44%|████▍     | 44/100 [01:05<01:09,  1.24s/it]Best trial: 25. Best value: 0.186642:  45%|████▌     | 45/100 [01:05<01:13,  1.34s/it]Best trial: 25. Best value: 0.186642:  45%|████▌     | 45/100 [01:06<01:13,  1.34s/it]Best trial: 25. Best value: 0.186642:  46%|████▌     | 46/100 [01:06<01:10,  1.31s/it]Best trial: 25. Best value: 0.186642:  46%|████▌     | 46/100 [01:07<01:10,  1.31s/it]Best trial: 25. Best value: 0.186642:  47%|████▋     | 47/100 [01:07<01:09,  1.31s/it]Best trial: 25. Best value: 0.186642:  47%|████▋     | 47/100 [01:08<01:09,  1.31s/it]Best trial: 25. Best value: 0.186642:  48%|████▊     | 48/100 [01:08<01:07,  1.31s/it]Best trial: 25. Best value: 0.186642:  48%|████▊     | 48/100 [01:11<01:07,  1.31s/it]Best trial: 25. Best value: 0.186642:  49%|████▉     | 49/100 [01:11<01:20,  1.58s/it]Best trial: 25. Best value: 0.186642:  49%|████▉     | 49/100 [01:12<01:20,  1.58s/it]Best trial: 25. Best value: 0.186642:  50%|█████     | 50/100 [01:12<01:18,  1.57s/it]Best trial: 25. Best value: 0.186642:  50%|█████     | 50/100 [01:14<01:18,  1.57s/it]Best trial: 25. Best value: 0.186642:  51%|█████     | 51/100 [01:14<01:14,  1.51s/it]Best trial: 25. Best value: 0.186642:  51%|█████     | 51/100 [01:15<01:14,  1.51s/it]Best trial: 25. Best value: 0.186642:  52%|█████▏    | 52/100 [01:15<01:08,  1.43s/it]Best trial: 25. Best value: 0.186642:  52%|█████▏    | 52/100 [01:16<01:08,  1.43s/it]Best trial: 25. Best value: 0.186642:  53%|█████▎    | 53/100 [01:16<01:04,  1.37s/it]Best trial: 25. Best value: 0.186642:  53%|█████▎    | 53/100 [01:17<01:04,  1.37s/it]Best trial: 25. Best value: 0.186642:  54%|█████▍    | 54/100 [01:17<01:00,  1.32s/it]Best trial: 25. Best value: 0.186642:  54%|█████▍    | 54/100 [01:18<01:00,  1.32s/it]Best trial: 25. Best value: 0.186642:  55%|█████▌    | 55/100 [01:18<00:58,  1.29s/it]Best trial: 25. Best value: 0.186642:  55%|█████▌    | 55/100 [01:20<00:58,  1.29s/it]Best trial: 25. Best value: 0.186642:  56%|█████▌    | 56/100 [01:20<00:59,  1.35s/it]Best trial: 25. Best value: 0.186642:  56%|█████▌    | 56/100 [01:21<00:59,  1.35s/it]Best trial: 25. Best value: 0.186642:  57%|█████▋    | 57/100 [01:21<00:56,  1.31s/it]Best trial: 25. Best value: 0.186642:  57%|█████▋    | 57/100 [01:22<00:56,  1.31s/it]Best trial: 25. Best value: 0.186642:  58%|█████▊    | 58/100 [01:22<00:54,  1.30s/it]Best trial: 25. Best value: 0.186642:  58%|█████▊    | 58/100 [01:24<00:54,  1.30s/it]Best trial: 25. Best value: 0.186642:  59%|█████▉    | 59/100 [01:24<00:59,  1.45s/it]Best trial: 25. Best value: 0.186642:  59%|█████▉    | 59/100 [01:26<00:59,  1.45s/it]Best trial: 25. Best value: 0.186642:  60%|██████    | 60/100 [01:26<01:03,  1.59s/it]Best trial: 25. Best value: 0.186642:  60%|██████    | 60/100 [01:28<01:03,  1.59s/it]Best trial: 25. Best value: 0.186642:  61%|██████    | 61/100 [01:28<01:07,  1.73s/it]Best trial: 61. Best value: 0.204474:  61%|██████    | 61/100 [01:29<01:07,  1.73s/it]Best trial: 61. Best value: 0.204474:  62%|██████▏   | 62/100 [01:29<00:59,  1.56s/it]Best trial: 61. Best value: 0.204474:  62%|██████▏   | 62/100 [01:31<00:59,  1.56s/it]Best trial: 61. Best value: 0.204474:  63%|██████▎   | 63/100 [01:31<00:53,  1.46s/it]Best trial: 61. Best value: 0.204474:  63%|██████▎   | 63/100 [01:32<00:53,  1.46s/it]Best trial: 61. Best value: 0.204474:  64%|██████▍   | 64/100 [01:32<00:49,  1.38s/it]Best trial: 61. Best value: 0.204474:  64%|██████▍   | 64/100 [01:33<00:49,  1.38s/it]Best trial: 61. Best value: 0.204474:  65%|██████▌   | 65/100 [01:33<00:45,  1.31s/it]Best trial: 61. Best value: 0.204474:  65%|██████▌   | 65/100 [01:34<00:45,  1.31s/it]Best trial: 61. Best value: 0.204474:  66%|██████▌   | 66/100 [01:34<00:45,  1.33s/it]Best trial: 61. Best value: 0.204474:  66%|██████▌   | 66/100 [01:35<00:45,  1.33s/it]Best trial: 61. Best value: 0.204474:  67%|██████▋   | 67/100 [01:35<00:41,  1.27s/it]Best trial: 61. Best value: 0.204474:  67%|██████▋   | 67/100 [01:37<00:41,  1.27s/it]Best trial: 61. Best value: 0.204474:  68%|██████▊   | 68/100 [01:37<00:43,  1.36s/it]Best trial: 61. Best value: 0.204474:  68%|██████▊   | 68/100 [01:38<00:43,  1.36s/it]Best trial: 61. Best value: 0.204474:  69%|██████▉   | 69/100 [01:38<00:40,  1.30s/it]Best trial: 61. Best value: 0.204474:  69%|██████▉   | 69/100 [01:39<00:40,  1.30s/it]Best trial: 61. Best value: 0.204474:  70%|███████   | 70/100 [01:39<00:38,  1.29s/it]Best trial: 61. Best value: 0.204474:  70%|███████   | 70/100 [01:41<00:38,  1.29s/it]Best trial: 61. Best value: 0.204474:  71%|███████   | 71/100 [01:41<00:36,  1.25s/it]Best trial: 61. Best value: 0.204474:  71%|███████   | 71/100 [01:42<00:36,  1.25s/it]Best trial: 61. Best value: 0.204474:  72%|███████▏  | 72/100 [01:42<00:36,  1.30s/it]Best trial: 61. Best value: 0.204474:  72%|███████▏  | 72/100 [01:43<00:36,  1.30s/it]Best trial: 61. Best value: 0.204474:  73%|███████▎  | 73/100 [01:43<00:33,  1.22s/it]Best trial: 61. Best value: 0.204474:  73%|███████▎  | 73/100 [01:44<00:33,  1.22s/it]Best trial: 61. Best value: 0.204474:  74%|███████▍  | 74/100 [01:44<00:31,  1.20s/it]Best trial: 61. Best value: 0.204474:  74%|███████▍  | 74/100 [01:45<00:31,  1.20s/it]Best trial: 61. Best value: 0.204474:  75%|███████▌  | 75/100 [01:45<00:29,  1.17s/it]Best trial: 61. Best value: 0.204474:  75%|███████▌  | 75/100 [01:47<00:29,  1.17s/it]Best trial: 61. Best value: 0.204474:  76%|███████▌  | 76/100 [01:47<00:28,  1.18s/it]Best trial: 61. Best value: 0.204474:  76%|███████▌  | 76/100 [01:48<00:28,  1.18s/it]Best trial: 61. Best value: 0.204474:  77%|███████▋  | 77/100 [01:48<00:26,  1.15s/it]Best trial: 61. Best value: 0.204474:  77%|███████▋  | 77/100 [01:49<00:26,  1.15s/it]Best trial: 61. Best value: 0.204474:  78%|███████▊  | 78/100 [01:49<00:24,  1.12s/it]Best trial: 61. Best value: 0.204474:  78%|███████▊  | 78/100 [01:50<00:24,  1.12s/it]Best trial: 61. Best value: 0.204474:  79%|███████▉  | 79/100 [01:50<00:22,  1.10s/it]Best trial: 61. Best value: 0.204474:  79%|███████▉  | 79/100 [01:51<00:22,  1.10s/it]Best trial: 61. Best value: 0.204474:  80%|████████  | 80/100 [01:51<00:21,  1.08s/it]Best trial: 61. Best value: 0.204474:  80%|████████  | 80/100 [01:52<00:21,  1.08s/it]Best trial: 61. Best value: 0.204474:  81%|████████  | 81/100 [01:52<00:19,  1.04s/it]Best trial: 61. Best value: 0.204474:  81%|████████  | 81/100 [01:53<00:19,  1.04s/it]Best trial: 61. Best value: 0.204474:  82%|████████▏ | 82/100 [01:53<00:18,  1.02s/it]Best trial: 61. Best value: 0.204474:  82%|████████▏ | 82/100 [01:54<00:18,  1.02s/it]Best trial: 61. Best value: 0.204474:  83%|████████▎ | 83/100 [01:54<00:17,  1.01s/it]Best trial: 61. Best value: 0.204474:  83%|████████▎ | 83/100 [01:55<00:17,  1.01s/it]Best trial: 61. Best value: 0.204474:  84%|████████▍ | 84/100 [01:55<00:15,  1.03it/s]Best trial: 61. Best value: 0.204474:  84%|████████▍ | 84/100 [01:56<00:15,  1.03it/s]Best trial: 61. Best value: 0.204474:  85%|████████▌ | 85/100 [01:56<00:15,  1.01s/it]Best trial: 61. Best value: 0.204474:  85%|████████▌ | 85/100 [01:57<00:15,  1.01s/it]Best trial: 61. Best value: 0.204474:  86%|████████▌ | 86/100 [01:57<00:13,  1.03it/s]Best trial: 61. Best value: 0.204474:  86%|████████▌ | 86/100 [01:58<00:13,  1.03it/s]Best trial: 61. Best value: 0.204474:  87%|████████▋ | 87/100 [01:58<00:14,  1.08s/it]Best trial: 61. Best value: 0.204474:  87%|████████▋ | 87/100 [01:59<00:14,  1.08s/it]Best trial: 61. Best value: 0.204474:  88%|████████▊ | 88/100 [01:59<00:12,  1.02s/it]Best trial: 61. Best value: 0.204474:  88%|████████▊ | 88/100 [02:00<00:12,  1.02s/it]Best trial: 61. Best value: 0.204474:  89%|████████▉ | 89/100 [02:00<00:11,  1.01s/it]Best trial: 61. Best value: 0.204474:  89%|████████▉ | 89/100 [02:01<00:11,  1.01s/it]Best trial: 61. Best value: 0.204474:  90%|█████████ | 90/100 [02:01<00:10,  1.02s/it]Best trial: 61. Best value: 0.204474:  90%|█████████ | 90/100 [02:02<00:10,  1.02s/it]Best trial: 61. Best value: 0.204474:  91%|█████████ | 91/100 [02:02<00:09,  1.02s/it]Best trial: 61. Best value: 0.204474:  91%|█████████ | 91/100 [02:03<00:09,  1.02s/it]Best trial: 61. Best value: 0.204474:  92%|█████████▏| 92/100 [02:03<00:08,  1.01s/it]Best trial: 92. Best value: 0.205693:  92%|█████████▏| 92/100 [02:04<00:08,  1.01s/it]Best trial: 92. Best value: 0.205693:  93%|█████████▎| 93/100 [02:04<00:06,  1.03it/s]Best trial: 92. Best value: 0.205693:  93%|█████████▎| 93/100 [02:05<00:06,  1.03it/s]Best trial: 92. Best value: 0.205693:  94%|█████████▍| 94/100 [02:05<00:05,  1.05it/s]Best trial: 92. Best value: 0.205693:  94%|█████████▍| 94/100 [02:06<00:05,  1.05it/s]Best trial: 92. Best value: 0.205693:  95%|█████████▌| 95/100 [02:06<00:05,  1.01s/it]Best trial: 92. Best value: 0.205693:  95%|█████████▌| 95/100 [02:07<00:05,  1.01s/it]Best trial: 92. Best value: 0.205693:  96%|█████████▌| 96/100 [02:07<00:03,  1.00it/s]Best trial: 92. Best value: 0.205693:  96%|█████████▌| 96/100 [02:08<00:03,  1.00it/s]Best trial: 92. Best value: 0.205693:  97%|█████████▋| 97/100 [02:08<00:03,  1.02s/it]Best trial: 92. Best value: 0.205693:  97%|█████████▋| 97/100 [02:09<00:03,  1.02s/it]Best trial: 92. Best value: 0.205693:  98%|█████████▊| 98/100 [02:09<00:01,  1.01it/s]Best trial: 92. Best value: 0.205693:  98%|█████████▊| 98/100 [02:10<00:01,  1.01it/s]Best trial: 92. Best value: 0.205693:  99%|█████████▉| 99/100 [02:10<00:01,  1.04s/it]Best trial: 92. Best value: 0.205693:  99%|█████████▉| 99/100 [02:11<00:01,  1.04s/it]Best trial: 92. Best value: 0.205693: 100%|██████████| 100/100 [02:11<00:00,  1.02s/it]Best trial: 92. Best value: 0.205693: 100%|██████████| 100/100 [02:11<00:00,  1.31s/it]
2025-11-30 14:37:36,373 - INFO - HPO Complete. Best AUPRC: 0.2057
2025-11-30 14:37:36,373 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.07326531819430826, 'max_depth': 3, 'subsample': 0.8077726657106434, 'colsample_bytree': 0.7934617624704894, 'gamma': 1.2586149048998942, 'reg_lambda': 3.0179370697550434e-07, 'reg_alpha': 6.992866434622002e-05}
2025-11-30 14:37:36,373 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:37:38,675 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_only
2025-11-30 14:37:38,676 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:37:38,782 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:37:38,806 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:37:38,812 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 14:37:38,812 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:37:38,812 - INFO - Training model...
2025-11-30 14:37:39,851 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:37:45,049 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:37:45,049 - INFO - AUROC: 0.6793 (0.4280 - 0.8355)
2025-11-30 14:37:45,049 - INFO - AUPRC: 0.0245 (0.0073 - 0.0627)
2025-11-30 14:37:45,049 - INFO - Brier Score: 0.0105 (0.0063 - 0.0176)
2025-11-30 14:37:45,049 - INFO - Accuracy: 0.9075 (0.8910 - 0.9578)
2025-11-30 14:37:45,049 - INFO - Precision: 0.0323 (0.0000 - 0.0795)
2025-11-30 14:37:45,049 - INFO - Sensitivity (Recall): 0.3333 (0.0000 - 0.6667)
2025-11-30 14:37:45,049 - INFO - F1-Score: 0.0588 (0.0000 - 0.1399)
2025-11-30 14:37:45,049 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0200)
2025-11-30 14:37:45,049 - INFO - Specificity: 0.9125 (0.8961 - 0.9607)
2025-11-30 14:37:45,061 - INFO - Calculating SHAP values...
2025-11-30 14:37:46,051 - INFO - SHAP plots saved.
2025-11-30 14:37:46,053 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:37:47,361 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 14:37:47,361 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:37:47,464 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:37:47,479 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:37:47,482 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:37:47,482 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0450388:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0450388:   1%|          | 1/100 [00:01<02:20,  1.42s/it]Best trial: 1. Best value: 0.0846626:   1%|          | 1/100 [00:02<02:20,  1.42s/it]Best trial: 1. Best value: 0.0846626:   2%|▏         | 2/100 [00:02<02:18,  1.41s/it]Best trial: 1. Best value: 0.0846626:   2%|▏         | 2/100 [00:04<02:18,  1.41s/it]Best trial: 1. Best value: 0.0846626:   3%|▎         | 3/100 [00:04<02:13,  1.37s/it]Best trial: 3. Best value: 0.10891:   3%|▎         | 3/100 [00:04<02:13,  1.37s/it]  Best trial: 3. Best value: 0.10891:   4%|▍         | 4/100 [00:04<01:50,  1.15s/it]Best trial: 3. Best value: 0.10891:   4%|▍         | 4/100 [00:06<01:50,  1.15s/it]Best trial: 3. Best value: 0.10891:   5%|▌         | 5/100 [00:06<01:48,  1.15s/it]Best trial: 3. Best value: 0.10891:   5%|▌         | 5/100 [00:07<01:48,  1.15s/it]Best trial: 3. Best value: 0.10891:   6%|▌         | 6/100 [00:07<01:43,  1.10s/it]Best trial: 3. Best value: 0.10891:   6%|▌         | 6/100 [00:08<01:43,  1.10s/it]Best trial: 3. Best value: 0.10891:   7%|▋         | 7/100 [00:08<01:54,  1.23s/it]Best trial: 3. Best value: 0.10891:   7%|▋         | 7/100 [00:09<01:54,  1.23s/it]Best trial: 3. Best value: 0.10891:   8%|▊         | 8/100 [00:09<01:47,  1.17s/it]Best trial: 3. Best value: 0.10891:   8%|▊         | 8/100 [00:11<01:47,  1.17s/it]Best trial: 3. Best value: 0.10891:   9%|▉         | 9/100 [00:11<01:56,  1.28s/it]Best trial: 3. Best value: 0.10891:   9%|▉         | 9/100 [00:12<01:56,  1.28s/it]Best trial: 3. Best value: 0.10891:  10%|█         | 10/100 [00:12<02:02,  1.36s/it]Best trial: 3. Best value: 0.10891:  10%|█         | 10/100 [00:14<02:02,  1.36s/it]Best trial: 3. Best value: 0.10891:  11%|█         | 11/100 [00:14<02:02,  1.38s/it]Best trial: 3. Best value: 0.10891:  11%|█         | 11/100 [00:14<02:02,  1.38s/it]Best trial: 3. Best value: 0.10891:  12%|█▏        | 12/100 [00:14<01:47,  1.22s/it]Best trial: 3. Best value: 0.10891:  12%|█▏        | 12/100 [00:15<01:47,  1.22s/it]Best trial: 3. Best value: 0.10891:  13%|█▎        | 13/100 [00:15<01:39,  1.14s/it]Best trial: 3. Best value: 0.10891:  13%|█▎        | 13/100 [00:17<01:39,  1.14s/it]Best trial: 3. Best value: 0.10891:  14%|█▍        | 14/100 [00:17<01:36,  1.12s/it]Best trial: 3. Best value: 0.10891:  14%|█▍        | 14/100 [00:17<01:36,  1.12s/it]Best trial: 3. Best value: 0.10891:  15%|█▌        | 15/100 [00:17<01:25,  1.00s/it]Best trial: 15. Best value: 0.138499:  15%|█▌        | 15/100 [00:18<01:25,  1.00s/it]Best trial: 15. Best value: 0.138499:  16%|█▌        | 16/100 [00:18<01:28,  1.06s/it]Best trial: 15. Best value: 0.138499:  16%|█▌        | 16/100 [00:19<01:28,  1.06s/it]Best trial: 15. Best value: 0.138499:  17%|█▋        | 17/100 [00:19<01:21,  1.02it/s]Best trial: 15. Best value: 0.138499:  17%|█▋        | 17/100 [00:20<01:21,  1.02it/s]Best trial: 15. Best value: 0.138499:  18%|█▊        | 18/100 [00:20<01:19,  1.03it/s]Best trial: 15. Best value: 0.138499:  18%|█▊        | 18/100 [00:21<01:19,  1.03it/s]Best trial: 15. Best value: 0.138499:  19%|█▉        | 19/100 [00:21<01:12,  1.12it/s]Best trial: 15. Best value: 0.138499:  19%|█▉        | 19/100 [00:22<01:12,  1.12it/s]Best trial: 15. Best value: 0.138499:  20%|██        | 20/100 [00:22<01:25,  1.06s/it]Best trial: 15. Best value: 0.138499:  20%|██        | 20/100 [00:23<01:25,  1.06s/it]Best trial: 15. Best value: 0.138499:  21%|██        | 21/100 [00:23<01:23,  1.06s/it]Best trial: 15. Best value: 0.138499:  21%|██        | 21/100 [00:24<01:23,  1.06s/it]Best trial: 15. Best value: 0.138499:  22%|██▏       | 22/100 [00:24<01:17,  1.01it/s]Best trial: 15. Best value: 0.138499:  22%|██▏       | 22/100 [00:25<01:17,  1.01it/s]Best trial: 15. Best value: 0.138499:  23%|██▎       | 23/100 [00:25<01:12,  1.06it/s]Best trial: 15. Best value: 0.138499:  23%|██▎       | 23/100 [00:26<01:12,  1.06it/s]Best trial: 15. Best value: 0.138499:  24%|██▍       | 24/100 [00:26<01:21,  1.07s/it]Best trial: 15. Best value: 0.138499:  24%|██▍       | 24/100 [00:28<01:21,  1.07s/it]Best trial: 15. Best value: 0.138499:  25%|██▌       | 25/100 [00:28<01:22,  1.10s/it]Best trial: 15. Best value: 0.138499:  25%|██▌       | 25/100 [00:29<01:22,  1.10s/it]Best trial: 15. Best value: 0.138499:  26%|██▌       | 26/100 [00:29<01:20,  1.09s/it]Best trial: 15. Best value: 0.138499:  26%|██▌       | 26/100 [00:30<01:20,  1.09s/it]Best trial: 15. Best value: 0.138499:  27%|██▋       | 27/100 [00:30<01:20,  1.11s/it]Best trial: 15. Best value: 0.138499:  27%|██▋       | 27/100 [00:31<01:20,  1.11s/it]Best trial: 15. Best value: 0.138499:  28%|██▊       | 28/100 [00:31<01:13,  1.02s/it]Best trial: 28. Best value: 0.150007:  28%|██▊       | 28/100 [00:32<01:13,  1.02s/it]Best trial: 28. Best value: 0.150007:  29%|██▉       | 29/100 [00:32<01:11,  1.01s/it]Best trial: 28. Best value: 0.150007:  29%|██▉       | 29/100 [00:33<01:11,  1.01s/it]Best trial: 28. Best value: 0.150007:  30%|███       | 30/100 [00:33<01:12,  1.03s/it]Best trial: 28. Best value: 0.150007:  30%|███       | 30/100 [00:34<01:12,  1.03s/it]Best trial: 28. Best value: 0.150007:  31%|███       | 31/100 [00:34<01:16,  1.11s/it]Best trial: 31. Best value: 0.171676:  31%|███       | 31/100 [00:35<01:16,  1.11s/it]Best trial: 31. Best value: 0.171676:  32%|███▏      | 32/100 [00:35<01:15,  1.11s/it]Best trial: 31. Best value: 0.171676:  32%|███▏      | 32/100 [00:36<01:15,  1.11s/it]Best trial: 31. Best value: 0.171676:  33%|███▎      | 33/100 [00:36<01:11,  1.06s/it]Best trial: 31. Best value: 0.171676:  33%|███▎      | 33/100 [00:37<01:11,  1.06s/it]Best trial: 31. Best value: 0.171676:  34%|███▍      | 34/100 [00:37<01:07,  1.02s/it]Best trial: 31. Best value: 0.171676:  34%|███▍      | 34/100 [00:38<01:07,  1.02s/it]Best trial: 31. Best value: 0.171676:  35%|███▌      | 35/100 [00:38<01:08,  1.05s/it]Best trial: 31. Best value: 0.171676:  35%|███▌      | 35/100 [00:39<01:08,  1.05s/it]Best trial: 31. Best value: 0.171676:  36%|███▌      | 36/100 [00:39<01:06,  1.04s/it]Best trial: 31. Best value: 0.171676:  36%|███▌      | 36/100 [00:40<01:06,  1.04s/it]Best trial: 31. Best value: 0.171676:  37%|███▋      | 37/100 [00:40<01:03,  1.00s/it]Best trial: 31. Best value: 0.171676:  37%|███▋      | 37/100 [00:42<01:03,  1.00s/it]Best trial: 31. Best value: 0.171676:  38%|███▊      | 38/100 [00:42<01:17,  1.24s/it]Best trial: 31. Best value: 0.171676:  38%|███▊      | 38/100 [00:43<01:17,  1.24s/it]Best trial: 31. Best value: 0.171676:  39%|███▉      | 39/100 [00:43<01:13,  1.20s/it]Best trial: 31. Best value: 0.171676:  39%|███▉      | 39/100 [00:44<01:13,  1.20s/it]Best trial: 31. Best value: 0.171676:  40%|████      | 40/100 [00:44<01:05,  1.09s/it]Best trial: 31. Best value: 0.171676:  40%|████      | 40/100 [00:45<01:05,  1.09s/it]Best trial: 31. Best value: 0.171676:  41%|████      | 41/100 [00:45<01:03,  1.07s/it]Best trial: 31. Best value: 0.171676:  41%|████      | 41/100 [00:46<01:03,  1.07s/it]Best trial: 31. Best value: 0.171676:  42%|████▏     | 42/100 [00:46<01:03,  1.09s/it]Best trial: 31. Best value: 0.171676:  42%|████▏     | 42/100 [00:47<01:03,  1.09s/it]Best trial: 31. Best value: 0.171676:  43%|████▎     | 43/100 [00:47<01:00,  1.05s/it]Best trial: 31. Best value: 0.171676:  43%|████▎     | 43/100 [00:48<01:00,  1.05s/it]Best trial: 31. Best value: 0.171676:  44%|████▍     | 44/100 [00:48<00:54,  1.03it/s]Best trial: 31. Best value: 0.171676:  44%|████▍     | 44/100 [00:49<00:54,  1.03it/s]Best trial: 31. Best value: 0.171676:  45%|████▌     | 45/100 [00:49<00:52,  1.05it/s]Best trial: 31. Best value: 0.171676:  45%|████▌     | 45/100 [00:50<00:52,  1.05it/s]Best trial: 31. Best value: 0.171676:  46%|████▌     | 46/100 [00:50<00:56,  1.05s/it]Best trial: 31. Best value: 0.171676:  46%|████▌     | 46/100 [00:51<00:56,  1.05s/it]Best trial: 31. Best value: 0.171676:  47%|████▋     | 47/100 [00:51<00:51,  1.02it/s]Best trial: 31. Best value: 0.171676:  47%|████▋     | 47/100 [00:52<00:51,  1.02it/s]Best trial: 31. Best value: 0.171676:  48%|████▊     | 48/100 [00:52<00:52,  1.01s/it]Best trial: 31. Best value: 0.171676:  48%|████▊     | 48/100 [00:53<00:52,  1.01s/it]Best trial: 31. Best value: 0.171676:  49%|████▉     | 49/100 [00:53<00:56,  1.10s/it]Best trial: 31. Best value: 0.171676:  49%|████▉     | 49/100 [00:54<00:56,  1.10s/it]Best trial: 31. Best value: 0.171676:  50%|█████     | 50/100 [00:54<00:53,  1.07s/it]Best trial: 31. Best value: 0.171676:  50%|█████     | 50/100 [00:55<00:53,  1.07s/it]Best trial: 31. Best value: 0.171676:  51%|█████     | 51/100 [00:55<00:53,  1.09s/it]Best trial: 31. Best value: 0.171676:  51%|█████     | 51/100 [00:56<00:53,  1.09s/it]Best trial: 31. Best value: 0.171676:  52%|█████▏    | 52/100 [00:56<00:52,  1.10s/it]Best trial: 31. Best value: 0.171676:  52%|█████▏    | 52/100 [00:57<00:52,  1.10s/it]Best trial: 31. Best value: 0.171676:  53%|█████▎    | 53/100 [00:57<00:49,  1.06s/it]Best trial: 31. Best value: 0.171676:  53%|█████▎    | 53/100 [00:58<00:49,  1.06s/it]Best trial: 31. Best value: 0.171676:  54%|█████▍    | 54/100 [00:58<00:46,  1.01s/it]Best trial: 31. Best value: 0.171676:  54%|█████▍    | 54/100 [00:59<00:46,  1.01s/it]Best trial: 31. Best value: 0.171676:  55%|█████▌    | 55/100 [00:59<00:48,  1.07s/it]Best trial: 31. Best value: 0.171676:  55%|█████▌    | 55/100 [01:00<00:48,  1.07s/it]Best trial: 31. Best value: 0.171676:  56%|█████▌    | 56/100 [01:00<00:43,  1.02it/s]Best trial: 31. Best value: 0.171676:  56%|█████▌    | 56/100 [01:01<00:43,  1.02it/s]Best trial: 31. Best value: 0.171676:  57%|█████▋    | 57/100 [01:01<00:44,  1.03s/it]Best trial: 31. Best value: 0.171676:  57%|█████▋    | 57/100 [01:02<00:44,  1.03s/it]Best trial: 31. Best value: 0.171676:  58%|█████▊    | 58/100 [01:02<00:45,  1.08s/it]Best trial: 31. Best value: 0.171676:  58%|█████▊    | 58/100 [01:03<00:45,  1.08s/it]Best trial: 31. Best value: 0.171676:  59%|█████▉    | 59/100 [01:03<00:41,  1.01s/it]Best trial: 31. Best value: 0.171676:  59%|█████▉    | 59/100 [01:05<00:41,  1.01s/it]Best trial: 31. Best value: 0.171676:  60%|██████    | 60/100 [01:05<00:44,  1.11s/it]Best trial: 31. Best value: 0.171676:  60%|██████    | 60/100 [01:06<00:44,  1.11s/it]Best trial: 31. Best value: 0.171676:  61%|██████    | 61/100 [01:06<00:40,  1.05s/it]Best trial: 31. Best value: 0.171676:  61%|██████    | 61/100 [01:07<00:40,  1.05s/it]Best trial: 31. Best value: 0.171676:  62%|██████▏   | 62/100 [01:07<00:39,  1.04s/it]Best trial: 31. Best value: 0.171676:  62%|██████▏   | 62/100 [01:08<00:39,  1.04s/it]Best trial: 31. Best value: 0.171676:  63%|██████▎   | 63/100 [01:08<00:38,  1.03s/it]Best trial: 31. Best value: 0.171676:  63%|██████▎   | 63/100 [01:09<00:38,  1.03s/it]Best trial: 31. Best value: 0.171676:  64%|██████▍   | 64/100 [01:09<00:35,  1.01it/s]Best trial: 31. Best value: 0.171676:  64%|██████▍   | 64/100 [01:10<00:35,  1.01it/s]Best trial: 31. Best value: 0.171676:  65%|██████▌   | 65/100 [01:10<00:36,  1.05s/it]Best trial: 31. Best value: 0.171676:  65%|██████▌   | 65/100 [01:11<00:36,  1.05s/it]Best trial: 31. Best value: 0.171676:  66%|██████▌   | 66/100 [01:11<00:38,  1.12s/it]Best trial: 31. Best value: 0.171676:  66%|██████▌   | 66/100 [01:12<00:38,  1.12s/it]Best trial: 31. Best value: 0.171676:  67%|██████▋   | 67/100 [01:12<00:34,  1.05s/it]Best trial: 31. Best value: 0.171676:  67%|██████▋   | 67/100 [01:13<00:34,  1.05s/it]Best trial: 31. Best value: 0.171676:  68%|██████▊   | 68/100 [01:13<00:32,  1.01s/it]Best trial: 31. Best value: 0.171676:  68%|██████▊   | 68/100 [01:14<00:32,  1.01s/it]Best trial: 31. Best value: 0.171676:  69%|██████▉   | 69/100 [01:14<00:37,  1.20s/it]Best trial: 31. Best value: 0.171676:  69%|██████▉   | 69/100 [01:16<00:37,  1.20s/it]Best trial: 31. Best value: 0.171676:  70%|███████   | 70/100 [01:16<00:36,  1.21s/it]Best trial: 31. Best value: 0.171676:  70%|███████   | 70/100 [01:17<00:36,  1.21s/it]Best trial: 31. Best value: 0.171676:  71%|███████   | 71/100 [01:17<00:34,  1.19s/it]Best trial: 31. Best value: 0.171676:  71%|███████   | 71/100 [01:18<00:34,  1.19s/it]Best trial: 31. Best value: 0.171676:  72%|███████▏  | 72/100 [01:18<00:32,  1.16s/it]Best trial: 31. Best value: 0.171676:  72%|███████▏  | 72/100 [01:19<00:32,  1.16s/it]Best trial: 31. Best value: 0.171676:  73%|███████▎  | 73/100 [01:19<00:28,  1.06s/it]Best trial: 31. Best value: 0.171676:  73%|███████▎  | 73/100 [01:20<00:28,  1.06s/it]Best trial: 31. Best value: 0.171676:  74%|███████▍  | 74/100 [01:20<00:27,  1.08s/it]Best trial: 31. Best value: 0.171676:  74%|███████▍  | 74/100 [01:21<00:27,  1.08s/it]Best trial: 31. Best value: 0.171676:  75%|███████▌  | 75/100 [01:21<00:28,  1.12s/it]Best trial: 31. Best value: 0.171676:  75%|███████▌  | 75/100 [01:22<00:28,  1.12s/it]Best trial: 31. Best value: 0.171676:  76%|███████▌  | 76/100 [01:22<00:24,  1.03s/it]Best trial: 31. Best value: 0.171676:  76%|███████▌  | 76/100 [01:23<00:24,  1.03s/it]Best trial: 31. Best value: 0.171676:  77%|███████▋  | 77/100 [01:23<00:22,  1.01it/s]Best trial: 31. Best value: 0.171676:  77%|███████▋  | 77/100 [01:24<00:22,  1.01it/s]Best trial: 31. Best value: 0.171676:  78%|███████▊  | 78/100 [01:24<00:24,  1.09s/it]Best trial: 31. Best value: 0.171676:  78%|███████▊  | 78/100 [01:25<00:24,  1.09s/it]Best trial: 31. Best value: 0.171676:  79%|███████▉  | 79/100 [01:25<00:23,  1.13s/it]Best trial: 31. Best value: 0.171676:  79%|███████▉  | 79/100 [01:26<00:23,  1.13s/it]Best trial: 31. Best value: 0.171676:  80%|████████  | 80/100 [01:26<00:21,  1.10s/it]Best trial: 31. Best value: 0.171676:  80%|████████  | 80/100 [01:27<00:21,  1.10s/it]Best trial: 31. Best value: 0.171676:  81%|████████  | 81/100 [01:27<00:19,  1.03s/it]Best trial: 31. Best value: 0.171676:  81%|████████  | 81/100 [01:28<00:19,  1.03s/it]Best trial: 31. Best value: 0.171676:  82%|████████▏ | 82/100 [01:28<00:18,  1.02s/it]Best trial: 31. Best value: 0.171676:  82%|████████▏ | 82/100 [01:29<00:18,  1.02s/it]Best trial: 31. Best value: 0.171676:  83%|████████▎ | 83/100 [01:29<00:17,  1.02s/it]Best trial: 31. Best value: 0.171676:  83%|████████▎ | 83/100 [01:30<00:17,  1.02s/it]Best trial: 31. Best value: 0.171676:  84%|████████▍ | 84/100 [01:30<00:16,  1.01s/it]Best trial: 31. Best value: 0.171676:  84%|████████▍ | 84/100 [01:31<00:16,  1.01s/it]Best trial: 31. Best value: 0.171676:  85%|████████▌ | 85/100 [01:31<00:14,  1.04it/s]Best trial: 31. Best value: 0.171676:  85%|████████▌ | 85/100 [01:32<00:14,  1.04it/s]Best trial: 31. Best value: 0.171676:  86%|████████▌ | 86/100 [01:32<00:14,  1.01s/it]Best trial: 31. Best value: 0.171676:  86%|████████▌ | 86/100 [01:33<00:14,  1.01s/it]Best trial: 31. Best value: 0.171676:  87%|████████▋ | 87/100 [01:33<00:12,  1.03it/s]Best trial: 31. Best value: 0.171676:  87%|████████▋ | 87/100 [01:34<00:12,  1.03it/s]Best trial: 31. Best value: 0.171676:  88%|████████▊ | 88/100 [01:34<00:12,  1.03s/it]Best trial: 31. Best value: 0.171676:  88%|████████▊ | 88/100 [01:35<00:12,  1.03s/it]Best trial: 31. Best value: 0.171676:  89%|████████▉ | 89/100 [01:35<00:10,  1.01it/s]Best trial: 31. Best value: 0.171676:  89%|████████▉ | 89/100 [01:36<00:10,  1.01it/s]Best trial: 31. Best value: 0.171676:  90%|█████████ | 90/100 [01:36<00:09,  1.01it/s]Best trial: 31. Best value: 0.171676:  90%|█████████ | 90/100 [01:37<00:09,  1.01it/s]Best trial: 31. Best value: 0.171676:  91%|█████████ | 91/100 [01:37<00:09,  1.09s/it]Best trial: 31. Best value: 0.171676:  91%|█████████ | 91/100 [01:38<00:09,  1.09s/it]Best trial: 31. Best value: 0.171676:  92%|█████████▏| 92/100 [01:38<00:08,  1.06s/it]Best trial: 31. Best value: 0.171676:  92%|█████████▏| 92/100 [01:40<00:08,  1.06s/it]Best trial: 31. Best value: 0.171676:  93%|█████████▎| 93/100 [01:40<00:07,  1.07s/it]Best trial: 31. Best value: 0.171676:  93%|█████████▎| 93/100 [01:41<00:07,  1.07s/it]Best trial: 31. Best value: 0.171676:  94%|█████████▍| 94/100 [01:41<00:06,  1.08s/it]Best trial: 31. Best value: 0.171676:  94%|█████████▍| 94/100 [01:42<00:06,  1.08s/it]Best trial: 31. Best value: 0.171676:  95%|█████████▌| 95/100 [01:42<00:05,  1.11s/it]Best trial: 31. Best value: 0.171676:  95%|█████████▌| 95/100 [01:43<00:05,  1.11s/it]Best trial: 31. Best value: 0.171676:  96%|█████████▌| 96/100 [01:43<00:04,  1.07s/it]Best trial: 31. Best value: 0.171676:  96%|█████████▌| 96/100 [01:44<00:04,  1.07s/it]Best trial: 31. Best value: 0.171676:  97%|█████████▋| 97/100 [01:44<00:03,  1.05s/it]Best trial: 31. Best value: 0.171676:  97%|█████████▋| 97/100 [01:45<00:03,  1.05s/it]Best trial: 31. Best value: 0.171676:  98%|█████████▊| 98/100 [01:45<00:02,  1.10s/it]Best trial: 31. Best value: 0.171676:  98%|█████████▊| 98/100 [01:46<00:02,  1.10s/it]Best trial: 31. Best value: 0.171676:  99%|█████████▉| 99/100 [01:46<00:01,  1.01s/it]Best trial: 31. Best value: 0.171676:  99%|█████████▉| 99/100 [01:47<00:01,  1.01s/it]Best trial: 31. Best value: 0.171676: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]Best trial: 31. Best value: 0.171676: 100%|██████████| 100/100 [01:47<00:00,  1.08s/it]
2025-11-30 14:39:35,030 - INFO - HPO Complete. Best AUPRC: 0.1717
2025-11-30 14:39:35,030 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0004307414223995883, 'max_depth': 4, 'subsample': 0.6189802366371092, 'colsample_bytree': 0.7447201076629323, 'gamma': 4.383293142962501, 'reg_lambda': 2.5695966726053527e-08, 'reg_alpha': 0.0014978492577157648}
2025-11-30 14:39:35,031 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:39:37,185 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 14:39:37,185 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:39:37,289 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:39:37,296 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:39:37,298 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:39:37,299 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:39:37,299 - INFO - Training model...
2025-11-30 14:39:39,907 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:39:44,616 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:39:44,616 - INFO - AUROC: 0.5508 (0.2043 - 0.7205)
2025-11-30 14:39:44,616 - INFO - AUPRC: 0.0433 (0.0045 - 0.2243)
2025-11-30 14:39:44,616 - INFO - Brier Score: 0.1400 (0.1383 - 0.1425)
2025-11-30 14:39:44,616 - INFO - Accuracy: 0.9870 (0.0104 - 0.9942)
2025-11-30 14:39:44,616 - INFO - Precision: 0.2000 (0.0052 - 0.5000)
2025-11-30 14:39:44,616 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 14:39:44,616 - INFO - F1-Score: 0.1818 (0.0104 - 0.4571)
2025-11-30 14:39:44,616 - INFO - Best Threshold: 0.4900 (0.0100 - 0.4900)
2025-11-30 14:39:44,616 - INFO - Specificity: 0.9942 (0.0000 - 0.9977)
2025-11-30 14:39:44,640 - INFO - Calculating SHAP values...
2025-11-30 14:39:45,886 - INFO - SHAP plots saved.
2025-11-30 14:39:45,890 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:39:47,383 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 14:39:47,384 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:39:47,489 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:39:47,498 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:39:47,501 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:39:47,501 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0243049:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0243049:   1%|          | 1/100 [00:01<01:44,  1.05s/it]Best trial: 1. Best value: 0.0965818:   1%|          | 1/100 [00:01<01:44,  1.05s/it]Best trial: 1. Best value: 0.0965818:   2%|▏         | 2/100 [00:01<01:24,  1.16it/s]Best trial: 2. Best value: 0.120147:   2%|▏         | 2/100 [00:02<01:24,  1.16it/s] Best trial: 2. Best value: 0.120147:   3%|▎         | 3/100 [00:02<01:21,  1.19it/s]Best trial: 2. Best value: 0.120147:   3%|▎         | 3/100 [00:03<01:21,  1.19it/s]Best trial: 2. Best value: 0.120147:   4%|▍         | 4/100 [00:03<01:21,  1.17it/s]Best trial: 2. Best value: 0.120147:   4%|▍         | 4/100 [00:04<01:21,  1.17it/s]Best trial: 2. Best value: 0.120147:   5%|▌         | 5/100 [00:04<01:14,  1.28it/s]Best trial: 2. Best value: 0.120147:   5%|▌         | 5/100 [00:05<01:14,  1.28it/s]Best trial: 2. Best value: 0.120147:   6%|▌         | 6/100 [00:05<01:17,  1.21it/s]Best trial: 2. Best value: 0.120147:   6%|▌         | 6/100 [00:05<01:17,  1.21it/s]Best trial: 2. Best value: 0.120147:   7%|▋         | 7/100 [00:05<01:10,  1.33it/s]Best trial: 2. Best value: 0.120147:   7%|▋         | 7/100 [00:06<01:10,  1.33it/s]Best trial: 2. Best value: 0.120147:   8%|▊         | 8/100 [00:06<01:10,  1.31it/s]Best trial: 2. Best value: 0.120147:   8%|▊         | 8/100 [00:07<01:10,  1.31it/s]Best trial: 2. Best value: 0.120147:   9%|▉         | 9/100 [00:07<01:26,  1.06it/s]Best trial: 2. Best value: 0.120147:   9%|▉         | 9/100 [00:08<01:26,  1.06it/s]Best trial: 2. Best value: 0.120147:  10%|█         | 10/100 [00:08<01:28,  1.02it/s]Best trial: 2. Best value: 0.120147:  10%|█         | 10/100 [00:10<01:28,  1.02it/s]Best trial: 2. Best value: 0.120147:  11%|█         | 11/100 [00:10<01:39,  1.11s/it]Best trial: 2. Best value: 0.120147:  11%|█         | 11/100 [00:11<01:39,  1.11s/it]Best trial: 2. Best value: 0.120147:  12%|█▏        | 12/100 [00:11<01:32,  1.06s/it]Best trial: 2. Best value: 0.120147:  12%|█▏        | 12/100 [00:11<01:32,  1.06s/it]Best trial: 2. Best value: 0.120147:  13%|█▎        | 13/100 [00:11<01:24,  1.03it/s]Best trial: 2. Best value: 0.120147:  13%|█▎        | 13/100 [00:12<01:24,  1.03it/s]Best trial: 2. Best value: 0.120147:  14%|█▍        | 14/100 [00:12<01:16,  1.13it/s]Best trial: 2. Best value: 0.120147:  14%|█▍        | 14/100 [00:13<01:16,  1.13it/s]Best trial: 2. Best value: 0.120147:  15%|█▌        | 15/100 [00:13<01:26,  1.02s/it]Best trial: 2. Best value: 0.120147:  15%|█▌        | 15/100 [00:14<01:26,  1.02s/it]Best trial: 2. Best value: 0.120147:  16%|█▌        | 16/100 [00:14<01:23,  1.01it/s]Best trial: 2. Best value: 0.120147:  16%|█▌        | 16/100 [00:15<01:23,  1.01it/s]Best trial: 2. Best value: 0.120147:  17%|█▋        | 17/100 [00:15<01:19,  1.05it/s]Best trial: 2. Best value: 0.120147:  17%|█▋        | 17/100 [00:16<01:19,  1.05it/s]Best trial: 2. Best value: 0.120147:  18%|█▊        | 18/100 [00:16<01:17,  1.06it/s]Best trial: 2. Best value: 0.120147:  18%|█▊        | 18/100 [00:17<01:17,  1.06it/s]Best trial: 2. Best value: 0.120147:  19%|█▉        | 19/100 [00:17<01:19,  1.02it/s]Best trial: 2. Best value: 0.120147:  19%|█▉        | 19/100 [00:18<01:19,  1.02it/s]Best trial: 2. Best value: 0.120147:  20%|██        | 20/100 [00:18<01:08,  1.16it/s]Best trial: 2. Best value: 0.120147:  20%|██        | 20/100 [00:19<01:08,  1.16it/s]Best trial: 2. Best value: 0.120147:  21%|██        | 21/100 [00:19<01:09,  1.14it/s]Best trial: 2. Best value: 0.120147:  21%|██        | 21/100 [00:19<01:09,  1.14it/s]Best trial: 2. Best value: 0.120147:  22%|██▏       | 22/100 [00:19<01:04,  1.20it/s]Best trial: 2. Best value: 0.120147:  22%|██▏       | 22/100 [00:20<01:04,  1.20it/s]Best trial: 2. Best value: 0.120147:  23%|██▎       | 23/100 [00:20<01:03,  1.22it/s]Best trial: 2. Best value: 0.120147:  23%|██▎       | 23/100 [00:21<01:03,  1.22it/s]Best trial: 2. Best value: 0.120147:  24%|██▍       | 24/100 [00:21<01:02,  1.22it/s]Best trial: 2. Best value: 0.120147:  24%|██▍       | 24/100 [00:22<01:02,  1.22it/s]Best trial: 2. Best value: 0.120147:  25%|██▌       | 25/100 [00:22<01:08,  1.10it/s]Best trial: 2. Best value: 0.120147:  25%|██▌       | 25/100 [00:23<01:08,  1.10it/s]Best trial: 2. Best value: 0.120147:  26%|██▌       | 26/100 [00:23<01:03,  1.17it/s]Best trial: 2. Best value: 0.120147:  26%|██▌       | 26/100 [00:24<01:03,  1.17it/s]Best trial: 2. Best value: 0.120147:  27%|██▋       | 27/100 [00:24<01:08,  1.07it/s]Best trial: 2. Best value: 0.120147:  27%|██▋       | 27/100 [00:25<01:08,  1.07it/s]Best trial: 2. Best value: 0.120147:  28%|██▊       | 28/100 [00:25<01:07,  1.06it/s]Best trial: 2. Best value: 0.120147:  28%|██▊       | 28/100 [00:26<01:07,  1.06it/s]Best trial: 2. Best value: 0.120147:  29%|██▉       | 29/100 [00:26<01:04,  1.10it/s]Best trial: 2. Best value: 0.120147:  29%|██▉       | 29/100 [00:27<01:04,  1.10it/s]Best trial: 2. Best value: 0.120147:  30%|███       | 30/100 [00:27<01:16,  1.10s/it]Best trial: 2. Best value: 0.120147:  30%|███       | 30/100 [00:28<01:16,  1.10s/it]Best trial: 2. Best value: 0.120147:  31%|███       | 31/100 [00:28<01:12,  1.05s/it]Best trial: 2. Best value: 0.120147:  31%|███       | 31/100 [00:30<01:12,  1.05s/it]Best trial: 2. Best value: 0.120147:  32%|███▏      | 32/100 [00:30<01:14,  1.09s/it]Best trial: 2. Best value: 0.120147:  32%|███▏      | 32/100 [00:30<01:14,  1.09s/it]Best trial: 2. Best value: 0.120147:  33%|███▎      | 33/100 [00:30<01:04,  1.04it/s]Best trial: 2. Best value: 0.120147:  33%|███▎      | 33/100 [00:31<01:04,  1.04it/s]Best trial: 2. Best value: 0.120147:  34%|███▍      | 34/100 [00:31<00:58,  1.14it/s]Best trial: 2. Best value: 0.120147:  34%|███▍      | 34/100 [00:32<00:58,  1.14it/s]Best trial: 2. Best value: 0.120147:  35%|███▌      | 35/100 [00:32<00:58,  1.11it/s]Best trial: 2. Best value: 0.120147:  35%|███▌      | 35/100 [00:33<00:58,  1.11it/s]Best trial: 2. Best value: 0.120147:  36%|███▌      | 36/100 [00:33<00:58,  1.09it/s]Best trial: 2. Best value: 0.120147:  36%|███▌      | 36/100 [00:34<00:58,  1.09it/s]Best trial: 2. Best value: 0.120147:  37%|███▋      | 37/100 [00:34<00:56,  1.12it/s]Best trial: 2. Best value: 0.120147:  37%|███▋      | 37/100 [00:35<00:56,  1.12it/s]Best trial: 2. Best value: 0.120147:  38%|███▊      | 38/100 [00:35<00:56,  1.09it/s]Best trial: 2. Best value: 0.120147:  38%|███▊      | 38/100 [00:35<00:56,  1.09it/s]Best trial: 2. Best value: 0.120147:  39%|███▉      | 39/100 [00:35<00:51,  1.19it/s]Best trial: 2. Best value: 0.120147:  39%|███▉      | 39/100 [00:36<00:51,  1.19it/s]Best trial: 2. Best value: 0.120147:  40%|████      | 40/100 [00:36<00:50,  1.19it/s]Best trial: 2. Best value: 0.120147:  40%|████      | 40/100 [00:37<00:50,  1.19it/s]Best trial: 2. Best value: 0.120147:  41%|████      | 41/100 [00:37<00:59,  1.00s/it]Best trial: 2. Best value: 0.120147:  41%|████      | 41/100 [00:39<00:59,  1.00s/it]Best trial: 2. Best value: 0.120147:  42%|████▏     | 42/100 [00:39<00:58,  1.02s/it]Best trial: 2. Best value: 0.120147:  42%|████▏     | 42/100 [00:40<00:58,  1.02s/it]Best trial: 2. Best value: 0.120147:  43%|████▎     | 43/100 [00:40<00:59,  1.05s/it]Best trial: 2. Best value: 0.120147:  43%|████▎     | 43/100 [00:41<00:59,  1.05s/it]Best trial: 2. Best value: 0.120147:  44%|████▍     | 44/100 [00:41<01:04,  1.15s/it]Best trial: 2. Best value: 0.120147:  44%|████▍     | 44/100 [00:43<01:04,  1.15s/it]Best trial: 2. Best value: 0.120147:  45%|████▌     | 45/100 [00:43<01:12,  1.33s/it]Best trial: 2. Best value: 0.120147:  45%|████▌     | 45/100 [00:44<01:12,  1.33s/it]Best trial: 2. Best value: 0.120147:  46%|████▌     | 46/100 [00:44<01:09,  1.29s/it]Best trial: 2. Best value: 0.120147:  46%|████▌     | 46/100 [00:45<01:09,  1.29s/it]Best trial: 2. Best value: 0.120147:  47%|████▋     | 47/100 [00:45<01:02,  1.18s/it]Best trial: 2. Best value: 0.120147:  47%|████▋     | 47/100 [00:46<01:02,  1.18s/it]Best trial: 2. Best value: 0.120147:  48%|████▊     | 48/100 [00:46<01:02,  1.20s/it]Best trial: 2. Best value: 0.120147:  48%|████▊     | 48/100 [00:47<01:02,  1.20s/it]Best trial: 2. Best value: 0.120147:  49%|████▉     | 49/100 [00:47<01:00,  1.19s/it]Best trial: 2. Best value: 0.120147:  49%|████▉     | 49/100 [00:48<01:00,  1.19s/it]Best trial: 2. Best value: 0.120147:  50%|█████     | 50/100 [00:48<00:51,  1.04s/it]Best trial: 2. Best value: 0.120147:  50%|█████     | 50/100 [00:49<00:51,  1.04s/it]Best trial: 2. Best value: 0.120147:  51%|█████     | 51/100 [00:49<00:45,  1.08it/s]Best trial: 2. Best value: 0.120147:  51%|█████     | 51/100 [00:49<00:45,  1.08it/s]Best trial: 2. Best value: 0.120147:  52%|█████▏    | 52/100 [00:49<00:41,  1.17it/s]Best trial: 2. Best value: 0.120147:  52%|█████▏    | 52/100 [00:50<00:41,  1.17it/s]Best trial: 2. Best value: 0.120147:  53%|█████▎    | 53/100 [00:50<00:37,  1.27it/s]Best trial: 2. Best value: 0.120147:  53%|█████▎    | 53/100 [00:51<00:37,  1.27it/s]Best trial: 2. Best value: 0.120147:  54%|█████▍    | 54/100 [00:51<00:39,  1.18it/s]Best trial: 2. Best value: 0.120147:  54%|█████▍    | 54/100 [00:52<00:39,  1.18it/s]Best trial: 2. Best value: 0.120147:  55%|█████▌    | 55/100 [00:52<00:39,  1.15it/s]Best trial: 2. Best value: 0.120147:  55%|█████▌    | 55/100 [00:53<00:39,  1.15it/s]Best trial: 2. Best value: 0.120147:  56%|█████▌    | 56/100 [00:53<00:36,  1.22it/s]Best trial: 2. Best value: 0.120147:  56%|█████▌    | 56/100 [00:54<00:36,  1.22it/s]Best trial: 2. Best value: 0.120147:  57%|█████▋    | 57/100 [00:54<00:37,  1.15it/s]Best trial: 2. Best value: 0.120147:  57%|█████▋    | 57/100 [00:54<00:37,  1.15it/s]Best trial: 2. Best value: 0.120147:  58%|█████▊    | 58/100 [00:54<00:35,  1.17it/s]Best trial: 2. Best value: 0.120147:  58%|█████▊    | 58/100 [00:56<00:35,  1.17it/s]Best trial: 2. Best value: 0.120147:  59%|█████▉    | 59/100 [00:56<00:44,  1.08s/it]Best trial: 2. Best value: 0.120147:  59%|█████▉    | 59/100 [00:57<00:44,  1.08s/it]Best trial: 2. Best value: 0.120147:  60%|██████    | 60/100 [00:57<00:41,  1.05s/it]Best trial: 2. Best value: 0.120147:  60%|██████    | 60/100 [00:58<00:41,  1.05s/it]Best trial: 2. Best value: 0.120147:  61%|██████    | 61/100 [00:58<00:39,  1.00s/it]Best trial: 2. Best value: 0.120147:  61%|██████    | 61/100 [00:59<00:39,  1.00s/it]Best trial: 2. Best value: 0.120147:  62%|██████▏   | 62/100 [00:59<00:36,  1.03it/s]Best trial: 2. Best value: 0.120147:  62%|██████▏   | 62/100 [01:00<00:36,  1.03it/s]Best trial: 2. Best value: 0.120147:  63%|██████▎   | 63/100 [01:00<00:34,  1.07it/s]Best trial: 2. Best value: 0.120147:  63%|██████▎   | 63/100 [01:00<00:34,  1.07it/s]Best trial: 2. Best value: 0.120147:  64%|██████▍   | 64/100 [01:00<00:31,  1.15it/s]Best trial: 2. Best value: 0.120147:  64%|██████▍   | 64/100 [01:01<00:31,  1.15it/s]Best trial: 2. Best value: 0.120147:  65%|██████▌   | 65/100 [01:01<00:30,  1.16it/s]Best trial: 2. Best value: 0.120147:  65%|██████▌   | 65/100 [01:02<00:30,  1.16it/s]Best trial: 2. Best value: 0.120147:  66%|██████▌   | 66/100 [01:02<00:30,  1.13it/s]Best trial: 2. Best value: 0.120147:  66%|██████▌   | 66/100 [01:03<00:30,  1.13it/s]Best trial: 2. Best value: 0.120147:  67%|██████▋   | 67/100 [01:03<00:29,  1.13it/s]Best trial: 2. Best value: 0.120147:  67%|██████▋   | 67/100 [01:04<00:29,  1.13it/s]Best trial: 2. Best value: 0.120147:  68%|██████▊   | 68/100 [01:04<00:25,  1.25it/s]Best trial: 2. Best value: 0.120147:  68%|██████▊   | 68/100 [01:05<00:25,  1.25it/s]Best trial: 2. Best value: 0.120147:  69%|██████▉   | 69/100 [01:05<00:26,  1.18it/s]Best trial: 2. Best value: 0.120147:  69%|██████▉   | 69/100 [01:06<00:26,  1.18it/s]Best trial: 2. Best value: 0.120147:  70%|███████   | 70/100 [01:06<00:32,  1.07s/it]Best trial: 2. Best value: 0.120147:  70%|███████   | 70/100 [01:07<00:32,  1.07s/it]Best trial: 2. Best value: 0.120147:  71%|███████   | 71/100 [01:07<00:28,  1.01it/s]Best trial: 2. Best value: 0.120147:  71%|███████   | 71/100 [01:08<00:28,  1.01it/s]Best trial: 2. Best value: 0.120147:  72%|███████▏  | 72/100 [01:08<00:29,  1.04s/it]Best trial: 2. Best value: 0.120147:  72%|███████▏  | 72/100 [01:09<00:29,  1.04s/it]Best trial: 2. Best value: 0.120147:  73%|███████▎  | 73/100 [01:09<00:27,  1.00s/it]Best trial: 73. Best value: 0.143449:  73%|███████▎  | 73/100 [01:10<00:27,  1.00s/it]Best trial: 73. Best value: 0.143449:  74%|███████▍  | 74/100 [01:10<00:23,  1.12it/s]Best trial: 73. Best value: 0.143449:  74%|███████▍  | 74/100 [01:11<00:23,  1.12it/s]Best trial: 73. Best value: 0.143449:  75%|███████▌  | 75/100 [01:11<00:23,  1.09it/s]Best trial: 73. Best value: 0.143449:  75%|███████▌  | 75/100 [01:12<00:23,  1.09it/s]Best trial: 73. Best value: 0.143449:  76%|███████▌  | 76/100 [01:12<00:22,  1.05it/s]Best trial: 73. Best value: 0.143449:  76%|███████▌  | 76/100 [01:13<00:22,  1.05it/s]Best trial: 73. Best value: 0.143449:  77%|███████▋  | 77/100 [01:13<00:21,  1.05it/s]Best trial: 73. Best value: 0.143449:  77%|███████▋  | 77/100 [01:13<00:21,  1.05it/s]Best trial: 73. Best value: 0.143449:  78%|███████▊  | 78/100 [01:13<00:20,  1.07it/s]Best trial: 73. Best value: 0.143449:  78%|███████▊  | 78/100 [01:14<00:20,  1.07it/s]Best trial: 73. Best value: 0.143449:  79%|███████▉  | 79/100 [01:14<00:17,  1.17it/s]Best trial: 73. Best value: 0.143449:  79%|███████▉  | 79/100 [01:15<00:17,  1.17it/s]Best trial: 73. Best value: 0.143449:  80%|████████  | 80/100 [01:15<00:16,  1.20it/s]Best trial: 73. Best value: 0.143449:  80%|████████  | 80/100 [01:16<00:16,  1.20it/s]Best trial: 73. Best value: 0.143449:  81%|████████  | 81/100 [01:16<00:14,  1.28it/s]Best trial: 73. Best value: 0.143449:  81%|████████  | 81/100 [01:16<00:14,  1.28it/s]Best trial: 73. Best value: 0.143449:  82%|████████▏ | 82/100 [01:16<00:13,  1.35it/s]Best trial: 73. Best value: 0.143449:  82%|████████▏ | 82/100 [01:17<00:13,  1.35it/s]Best trial: 73. Best value: 0.143449:  83%|████████▎ | 83/100 [01:17<00:14,  1.14it/s]Best trial: 73. Best value: 0.143449:  83%|████████▎ | 83/100 [01:18<00:14,  1.14it/s]Best trial: 73. Best value: 0.143449:  84%|████████▍ | 84/100 [01:18<00:13,  1.22it/s]Best trial: 73. Best value: 0.143449:  84%|████████▍ | 84/100 [01:19<00:13,  1.22it/s]Best trial: 73. Best value: 0.143449:  85%|████████▌ | 85/100 [01:19<00:13,  1.13it/s]Best trial: 73. Best value: 0.143449:  85%|████████▌ | 85/100 [01:20<00:13,  1.13it/s]Best trial: 73. Best value: 0.143449:  86%|████████▌ | 86/100 [01:20<00:12,  1.13it/s]Best trial: 73. Best value: 0.143449:  86%|████████▌ | 86/100 [01:21<00:12,  1.13it/s]Best trial: 73. Best value: 0.143449:  87%|████████▋ | 87/100 [01:21<00:10,  1.19it/s]Best trial: 73. Best value: 0.143449:  87%|████████▋ | 87/100 [01:22<00:10,  1.19it/s]Best trial: 73. Best value: 0.143449:  88%|████████▊ | 88/100 [01:22<00:11,  1.03it/s]Best trial: 73. Best value: 0.143449:  88%|████████▊ | 88/100 [01:23<00:11,  1.03it/s]Best trial: 73. Best value: 0.143449:  89%|████████▉ | 89/100 [01:23<00:09,  1.11it/s]Best trial: 73. Best value: 0.143449:  89%|████████▉ | 89/100 [01:24<00:09,  1.11it/s]Best trial: 73. Best value: 0.143449:  90%|█████████ | 90/100 [01:24<00:09,  1.08it/s]Best trial: 73. Best value: 0.143449:  90%|█████████ | 90/100 [01:25<00:09,  1.08it/s]Best trial: 73. Best value: 0.143449:  91%|█████████ | 91/100 [01:25<00:07,  1.13it/s]Best trial: 73. Best value: 0.143449:  91%|█████████ | 91/100 [01:25<00:07,  1.13it/s]Best trial: 73. Best value: 0.143449:  92%|█████████▏| 92/100 [01:25<00:06,  1.24it/s]Best trial: 73. Best value: 0.143449:  92%|█████████▏| 92/100 [01:26<00:06,  1.24it/s]Best trial: 73. Best value: 0.143449:  93%|█████████▎| 93/100 [01:26<00:05,  1.22it/s]Best trial: 73. Best value: 0.143449:  93%|█████████▎| 93/100 [01:27<00:05,  1.22it/s]Best trial: 73. Best value: 0.143449:  94%|█████████▍| 94/100 [01:27<00:04,  1.33it/s]Best trial: 73. Best value: 0.143449:  94%|█████████▍| 94/100 [01:28<00:04,  1.33it/s]Best trial: 73. Best value: 0.143449:  95%|█████████▌| 95/100 [01:28<00:04,  1.25it/s]Best trial: 73. Best value: 0.143449:  95%|█████████▌| 95/100 [01:28<00:04,  1.25it/s]Best trial: 73. Best value: 0.143449:  96%|█████████▌| 96/100 [01:28<00:03,  1.28it/s]Best trial: 73. Best value: 0.143449:  96%|█████████▌| 96/100 [01:29<00:03,  1.28it/s]Best trial: 73. Best value: 0.143449:  97%|█████████▋| 97/100 [01:29<00:02,  1.38it/s]Best trial: 73. Best value: 0.143449:  97%|█████████▋| 97/100 [01:30<00:02,  1.38it/s]Best trial: 73. Best value: 0.143449:  98%|█████████▊| 98/100 [01:30<00:01,  1.27it/s]Best trial: 73. Best value: 0.143449:  98%|█████████▊| 98/100 [01:30<00:01,  1.27it/s]Best trial: 73. Best value: 0.143449:  99%|█████████▉| 99/100 [01:30<00:00,  1.35it/s]Best trial: 73. Best value: 0.143449:  99%|█████████▉| 99/100 [01:32<00:00,  1.35it/s]Best trial: 73. Best value: 0.143449: 100%|██████████| 100/100 [01:32<00:00,  1.12it/s]Best trial: 73. Best value: 0.143449: 100%|██████████| 100/100 [01:32<00:00,  1.08it/s]
2025-11-30 14:41:19,703 - INFO - HPO Complete. Best AUPRC: 0.1434
2025-11-30 14:41:19,704 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.005841518344064521, 'max_depth': 3, 'subsample': 0.6308625937594602, 'colsample_bytree': 0.6703588611303402, 'gamma': 2.8770191152102944, 'reg_lambda': 0.0041601296547611, 'reg_alpha': 2.2215706520296632e-07}
2025-11-30 14:41:19,704 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:41:22,001 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 14:41:22,001 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:41:22,106 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:41:22,114 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:41:22,116 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:41:22,116 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:41:22,116 - INFO - Training model...
2025-11-30 14:41:23,116 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:41:27,857 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:41:27,858 - INFO - AUROC: 0.3727 (0.0809 - 0.6517)
2025-11-30 14:41:27,858 - INFO - AUPRC: 0.0248 (0.0033 - 0.1710)
2025-11-30 14:41:27,858 - INFO - Brier Score: 0.0372 (0.0330 - 0.0445)
2025-11-30 14:41:27,858 - INFO - Accuracy: 0.9812 (0.0303 - 0.9879)
2025-11-30 14:41:27,858 - INFO - Precision: 0.1111 (0.0040 - 0.3351)
2025-11-30 14:41:27,858 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 14:41:27,858 - INFO - F1-Score: 0.1333 (0.0079 - 0.3895)
2025-11-30 14:41:27,858 - INFO - Best Threshold: 0.5100 (0.0300 - 0.5100)
2025-11-30 14:41:27,858 - INFO - Specificity: 0.9883 (0.0207 - 0.9915)
2025-11-30 14:41:27,872 - INFO - Calculating SHAP values...
2025-11-30 14:41:29,086 - INFO - SHAP plots saved.
2025-11-30 14:41:29,087 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:41:30,724 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: co2_only
2025-11-30 14:41:30,724 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:41:30,831 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:41:30,841 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:41:30,843 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:41:30,843 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0394968:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0394968:   1%|          | 1/100 [00:01<02:04,  1.26s/it]Best trial: 0. Best value: 0.0394968:   1%|          | 1/100 [00:02<02:04,  1.26s/it]Best trial: 0. Best value: 0.0394968:   2%|▏         | 2/100 [00:02<01:53,  1.16s/it]Best trial: 0. Best value: 0.0394968:   2%|▏         | 2/100 [00:03<01:53,  1.16s/it]Best trial: 0. Best value: 0.0394968:   3%|▎         | 3/100 [00:03<02:07,  1.31s/it]Best trial: 0. Best value: 0.0394968:   3%|▎         | 3/100 [00:05<02:07,  1.31s/it]Best trial: 0. Best value: 0.0394968:   4%|▍         | 4/100 [00:05<02:02,  1.27s/it]Best trial: 4. Best value: 0.0442141:   4%|▍         | 4/100 [00:06<02:02,  1.27s/it]Best trial: 4. Best value: 0.0442141:   5%|▌         | 5/100 [00:06<01:57,  1.23s/it]Best trial: 5. Best value: 0.0642011:   5%|▌         | 5/100 [00:07<01:57,  1.23s/it]Best trial: 5. Best value: 0.0642011:   6%|▌         | 6/100 [00:07<01:50,  1.17s/it]Best trial: 5. Best value: 0.0642011:   6%|▌         | 6/100 [00:08<01:50,  1.17s/it]Best trial: 5. Best value: 0.0642011:   7%|▋         | 7/100 [00:08<01:58,  1.28s/it]Best trial: 5. Best value: 0.0642011:   7%|▋         | 7/100 [00:09<01:58,  1.28s/it]Best trial: 5. Best value: 0.0642011:   8%|▊         | 8/100 [00:09<01:39,  1.09s/it]Best trial: 5. Best value: 0.0642011:   8%|▊         | 8/100 [00:10<01:39,  1.09s/it]Best trial: 5. Best value: 0.0642011:   9%|▉         | 9/100 [00:10<01:45,  1.16s/it]Best trial: 5. Best value: 0.0642011:   9%|▉         | 9/100 [00:11<01:45,  1.16s/it]Best trial: 5. Best value: 0.0642011:  10%|█         | 10/100 [00:11<01:45,  1.17s/it]Best trial: 5. Best value: 0.0642011:  10%|█         | 10/100 [00:12<01:45,  1.17s/it]Best trial: 5. Best value: 0.0642011:  11%|█         | 11/100 [00:12<01:29,  1.00s/it]Best trial: 5. Best value: 0.0642011:  11%|█         | 11/100 [00:13<01:29,  1.00s/it]Best trial: 5. Best value: 0.0642011:  12%|█▏        | 12/100 [00:13<01:26,  1.02it/s]Best trial: 5. Best value: 0.0642011:  12%|█▏        | 12/100 [00:14<01:26,  1.02it/s]Best trial: 5. Best value: 0.0642011:  13%|█▎        | 13/100 [00:14<01:32,  1.06s/it]Best trial: 5. Best value: 0.0642011:  13%|█▎        | 13/100 [00:16<01:32,  1.06s/it]Best trial: 5. Best value: 0.0642011:  14%|█▍        | 14/100 [00:16<01:45,  1.22s/it]Best trial: 5. Best value: 0.0642011:  14%|█▍        | 14/100 [00:17<01:45,  1.22s/it]Best trial: 5. Best value: 0.0642011:  15%|█▌        | 15/100 [00:17<01:37,  1.15s/it]Best trial: 5. Best value: 0.0642011:  15%|█▌        | 15/100 [00:18<01:37,  1.15s/it]Best trial: 5. Best value: 0.0642011:  16%|█▌        | 16/100 [00:18<01:38,  1.17s/it]Best trial: 5. Best value: 0.0642011:  16%|█▌        | 16/100 [00:19<01:38,  1.17s/it]Best trial: 5. Best value: 0.0642011:  17%|█▋        | 17/100 [00:19<01:29,  1.08s/it]Best trial: 5. Best value: 0.0642011:  17%|█▋        | 17/100 [00:21<01:29,  1.08s/it]Best trial: 5. Best value: 0.0642011:  18%|█▊        | 18/100 [00:21<01:44,  1.28s/it]Best trial: 5. Best value: 0.0642011:  18%|█▊        | 18/100 [00:22<01:44,  1.28s/it]Best trial: 5. Best value: 0.0642011:  19%|█▉        | 19/100 [00:22<01:40,  1.25s/it]Best trial: 5. Best value: 0.0642011:  19%|█▉        | 19/100 [00:23<01:40,  1.25s/it]Best trial: 5. Best value: 0.0642011:  20%|██        | 20/100 [00:23<01:37,  1.22s/it]Best trial: 5. Best value: 0.0642011:  20%|██        | 20/100 [00:24<01:37,  1.22s/it]Best trial: 5. Best value: 0.0642011:  21%|██        | 21/100 [00:24<01:29,  1.13s/it]Best trial: 5. Best value: 0.0642011:  21%|██        | 21/100 [00:25<01:29,  1.13s/it]Best trial: 5. Best value: 0.0642011:  22%|██▏       | 22/100 [00:25<01:22,  1.06s/it]Best trial: 5. Best value: 0.0642011:  22%|██▏       | 22/100 [00:26<01:22,  1.06s/it]Best trial: 5. Best value: 0.0642011:  23%|██▎       | 23/100 [00:26<01:15,  1.02it/s]Best trial: 23. Best value: 0.066713:  23%|██▎       | 23/100 [00:27<01:15,  1.02it/s]Best trial: 23. Best value: 0.066713:  24%|██▍       | 24/100 [00:27<01:15,  1.01it/s]Best trial: 23. Best value: 0.066713:  24%|██▍       | 24/100 [00:28<01:15,  1.01it/s]Best trial: 23. Best value: 0.066713:  25%|██▌       | 25/100 [00:28<01:13,  1.02it/s]Best trial: 23. Best value: 0.066713:  25%|██▌       | 25/100 [00:29<01:13,  1.02it/s]Best trial: 23. Best value: 0.066713:  26%|██▌       | 26/100 [00:29<01:31,  1.24s/it]Best trial: 23. Best value: 0.066713:  26%|██▌       | 26/100 [00:31<01:31,  1.24s/it]Best trial: 23. Best value: 0.066713:  27%|██▋       | 27/100 [00:31<01:29,  1.23s/it]Best trial: 23. Best value: 0.066713:  27%|██▋       | 27/100 [00:32<01:29,  1.23s/it]Best trial: 23. Best value: 0.066713:  28%|██▊       | 28/100 [00:32<01:25,  1.19s/it]Best trial: 23. Best value: 0.066713:  28%|██▊       | 28/100 [00:33<01:25,  1.19s/it]Best trial: 23. Best value: 0.066713:  29%|██▉       | 29/100 [00:33<01:24,  1.19s/it]Best trial: 23. Best value: 0.066713:  29%|██▉       | 29/100 [00:34<01:24,  1.19s/it]Best trial: 23. Best value: 0.066713:  30%|███       | 30/100 [00:34<01:18,  1.13s/it]Best trial: 23. Best value: 0.066713:  30%|███       | 30/100 [00:35<01:18,  1.13s/it]Best trial: 23. Best value: 0.066713:  31%|███       | 31/100 [00:35<01:18,  1.14s/it]Best trial: 23. Best value: 0.066713:  31%|███       | 31/100 [00:37<01:18,  1.14s/it]Best trial: 23. Best value: 0.066713:  32%|███▏      | 32/100 [00:37<01:29,  1.32s/it]Best trial: 23. Best value: 0.066713:  32%|███▏      | 32/100 [00:38<01:29,  1.32s/it]Best trial: 23. Best value: 0.066713:  33%|███▎      | 33/100 [00:38<01:30,  1.35s/it]Best trial: 23. Best value: 0.066713:  33%|███▎      | 33/100 [00:40<01:30,  1.35s/it]Best trial: 23. Best value: 0.066713:  34%|███▍      | 34/100 [00:40<01:31,  1.39s/it]Best trial: 23. Best value: 0.066713:  34%|███▍      | 34/100 [00:41<01:31,  1.39s/it]Best trial: 23. Best value: 0.066713:  35%|███▌      | 35/100 [00:41<01:25,  1.31s/it]Best trial: 23. Best value: 0.066713:  35%|███▌      | 35/100 [00:43<01:25,  1.31s/it]Best trial: 23. Best value: 0.066713:  36%|███▌      | 36/100 [00:43<01:34,  1.47s/it]Best trial: 23. Best value: 0.066713:  36%|███▌      | 36/100 [00:44<01:34,  1.47s/it]Best trial: 23. Best value: 0.066713:  37%|███▋      | 37/100 [00:44<01:27,  1.39s/it]Best trial: 23. Best value: 0.066713:  37%|███▋      | 37/100 [00:45<01:27,  1.39s/it]Best trial: 23. Best value: 0.066713:  38%|███▊      | 38/100 [00:45<01:21,  1.32s/it]Best trial: 23. Best value: 0.066713:  38%|███▊      | 38/100 [00:47<01:21,  1.32s/it]Best trial: 23. Best value: 0.066713:  39%|███▉      | 39/100 [00:47<01:24,  1.39s/it]Best trial: 23. Best value: 0.066713:  39%|███▉      | 39/100 [00:48<01:24,  1.39s/it]Best trial: 23. Best value: 0.066713:  40%|████      | 40/100 [00:48<01:18,  1.31s/it]Best trial: 23. Best value: 0.066713:  40%|████      | 40/100 [00:49<01:18,  1.31s/it]Best trial: 23. Best value: 0.066713:  41%|████      | 41/100 [00:49<01:11,  1.21s/it]Best trial: 23. Best value: 0.066713:  41%|████      | 41/100 [00:50<01:11,  1.21s/it]Best trial: 23. Best value: 0.066713:  42%|████▏     | 42/100 [00:50<01:13,  1.27s/it]Best trial: 23. Best value: 0.066713:  42%|████▏     | 42/100 [00:51<01:13,  1.27s/it]Best trial: 23. Best value: 0.066713:  43%|████▎     | 43/100 [00:51<01:14,  1.30s/it]Best trial: 23. Best value: 0.066713:  43%|████▎     | 43/100 [00:53<01:14,  1.30s/it]Best trial: 23. Best value: 0.066713:  44%|████▍     | 44/100 [00:53<01:13,  1.32s/it]Best trial: 44. Best value: 0.0758453:  44%|████▍     | 44/100 [00:54<01:13,  1.32s/it]Best trial: 44. Best value: 0.0758453:  45%|████▌     | 45/100 [00:54<01:07,  1.23s/it]Best trial: 45. Best value: 0.0866616:  45%|████▌     | 45/100 [00:55<01:07,  1.23s/it]Best trial: 45. Best value: 0.0866616:  46%|████▌     | 46/100 [00:55<01:04,  1.19s/it]Best trial: 45. Best value: 0.0866616:  46%|████▌     | 46/100 [00:56<01:04,  1.19s/it]Best trial: 45. Best value: 0.0866616:  47%|████▋     | 47/100 [00:56<01:00,  1.14s/it]Best trial: 45. Best value: 0.0866616:  47%|████▋     | 47/100 [00:57<01:00,  1.14s/it]Best trial: 45. Best value: 0.0866616:  48%|████▊     | 48/100 [00:57<00:57,  1.10s/it]Best trial: 45. Best value: 0.0866616:  48%|████▊     | 48/100 [00:58<00:57,  1.10s/it]Best trial: 45. Best value: 0.0866616:  49%|████▉     | 49/100 [00:58<00:59,  1.17s/it]Best trial: 45. Best value: 0.0866616:  49%|████▉     | 49/100 [00:59<00:59,  1.17s/it]Best trial: 45. Best value: 0.0866616:  50%|█████     | 50/100 [00:59<00:57,  1.14s/it]Best trial: 45. Best value: 0.0866616:  50%|█████     | 50/100 [01:00<00:57,  1.14s/it]Best trial: 45. Best value: 0.0866616:  51%|█████     | 51/100 [01:00<00:54,  1.11s/it]Best trial: 45. Best value: 0.0866616:  51%|█████     | 51/100 [01:02<00:54,  1.11s/it]Best trial: 45. Best value: 0.0866616:  52%|█████▏    | 52/100 [01:02<00:54,  1.15s/it]Best trial: 45. Best value: 0.0866616:  52%|█████▏    | 52/100 [01:03<00:54,  1.15s/it]Best trial: 45. Best value: 0.0866616:  53%|█████▎    | 53/100 [01:03<00:50,  1.08s/it]Best trial: 45. Best value: 0.0866616:  53%|█████▎    | 53/100 [01:04<00:50,  1.08s/it]Best trial: 45. Best value: 0.0866616:  54%|█████▍    | 54/100 [01:04<00:49,  1.08s/it]Best trial: 45. Best value: 0.0866616:  54%|█████▍    | 54/100 [01:05<00:49,  1.08s/it]Best trial: 45. Best value: 0.0866616:  55%|█████▌    | 55/100 [01:05<00:50,  1.13s/it]Best trial: 45. Best value: 0.0866616:  55%|█████▌    | 55/100 [01:06<00:50,  1.13s/it]Best trial: 45. Best value: 0.0866616:  56%|█████▌    | 56/100 [01:06<00:47,  1.07s/it]Best trial: 45. Best value: 0.0866616:  56%|█████▌    | 56/100 [01:07<00:47,  1.07s/it]Best trial: 45. Best value: 0.0866616:  57%|█████▋    | 57/100 [01:07<00:41,  1.03it/s]Best trial: 45. Best value: 0.0866616:  57%|█████▋    | 57/100 [01:08<00:41,  1.03it/s]Best trial: 45. Best value: 0.0866616:  58%|█████▊    | 58/100 [01:08<00:44,  1.05s/it]Best trial: 45. Best value: 0.0866616:  58%|█████▊    | 58/100 [01:09<00:44,  1.05s/it]Best trial: 45. Best value: 0.0866616:  59%|█████▉    | 59/100 [01:09<00:43,  1.06s/it]Best trial: 45. Best value: 0.0866616:  59%|█████▉    | 59/100 [01:10<00:43,  1.06s/it]Best trial: 45. Best value: 0.0866616:  60%|██████    | 60/100 [01:10<00:42,  1.06s/it]Best trial: 45. Best value: 0.0866616:  60%|██████    | 60/100 [01:11<00:42,  1.06s/it]Best trial: 45. Best value: 0.0866616:  61%|██████    | 61/100 [01:11<00:39,  1.02s/it]Best trial: 45. Best value: 0.0866616:  61%|██████    | 61/100 [01:12<00:39,  1.02s/it]Best trial: 45. Best value: 0.0866616:  62%|██████▏   | 62/100 [01:12<00:39,  1.04s/it]Best trial: 45. Best value: 0.0866616:  62%|██████▏   | 62/100 [01:13<00:39,  1.04s/it]Best trial: 45. Best value: 0.0866616:  63%|██████▎   | 63/100 [01:13<00:39,  1.07s/it]Best trial: 45. Best value: 0.0866616:  63%|██████▎   | 63/100 [01:14<00:39,  1.07s/it]Best trial: 45. Best value: 0.0866616:  64%|██████▍   | 64/100 [01:14<00:38,  1.08s/it]Best trial: 45. Best value: 0.0866616:  64%|██████▍   | 64/100 [01:15<00:38,  1.08s/it]Best trial: 45. Best value: 0.0866616:  65%|██████▌   | 65/100 [01:15<00:35,  1.03s/it]Best trial: 45. Best value: 0.0866616:  65%|██████▌   | 65/100 [01:16<00:35,  1.03s/it]Best trial: 45. Best value: 0.0866616:  66%|██████▌   | 66/100 [01:16<00:35,  1.05s/it]Best trial: 66. Best value: 0.0939863:  66%|██████▌   | 66/100 [01:17<00:35,  1.05s/it]Best trial: 66. Best value: 0.0939863:  67%|██████▋   | 67/100 [01:17<00:33,  1.01s/it]Best trial: 66. Best value: 0.0939863:  67%|██████▋   | 67/100 [01:18<00:33,  1.01s/it]Best trial: 66. Best value: 0.0939863:  68%|██████▊   | 68/100 [01:18<00:32,  1.01s/it]Best trial: 66. Best value: 0.0939863:  68%|██████▊   | 68/100 [01:19<00:32,  1.01s/it]Best trial: 66. Best value: 0.0939863:  69%|██████▉   | 69/100 [01:19<00:30,  1.00it/s]Best trial: 66. Best value: 0.0939863:  69%|██████▉   | 69/100 [01:20<00:30,  1.00it/s]Best trial: 66. Best value: 0.0939863:  70%|███████   | 70/100 [01:20<00:30,  1.01s/it]Best trial: 66. Best value: 0.0939863:  70%|███████   | 70/100 [01:21<00:30,  1.01s/it]Best trial: 66. Best value: 0.0939863:  71%|███████   | 71/100 [01:21<00:29,  1.02s/it]Best trial: 66. Best value: 0.0939863:  71%|███████   | 71/100 [01:22<00:29,  1.02s/it]Best trial: 66. Best value: 0.0939863:  72%|███████▏  | 72/100 [01:22<00:28,  1.02s/it]Best trial: 66. Best value: 0.0939863:  72%|███████▏  | 72/100 [01:23<00:28,  1.02s/it]Best trial: 66. Best value: 0.0939863:  73%|███████▎  | 73/100 [01:23<00:25,  1.04it/s]Best trial: 66. Best value: 0.0939863:  73%|███████▎  | 73/100 [01:24<00:25,  1.04it/s]Best trial: 66. Best value: 0.0939863:  74%|███████▍  | 74/100 [01:24<00:23,  1.10it/s]Best trial: 66. Best value: 0.0939863:  74%|███████▍  | 74/100 [01:25<00:23,  1.10it/s]Best trial: 66. Best value: 0.0939863:  75%|███████▌  | 75/100 [01:25<00:21,  1.15it/s]Best trial: 66. Best value: 0.0939863:  75%|███████▌  | 75/100 [01:26<00:21,  1.15it/s]Best trial: 66. Best value: 0.0939863:  76%|███████▌  | 76/100 [01:26<00:21,  1.13it/s]Best trial: 66. Best value: 0.0939863:  76%|███████▌  | 76/100 [01:26<00:21,  1.13it/s]Best trial: 66. Best value: 0.0939863:  77%|███████▋  | 77/100 [01:26<00:19,  1.16it/s]Best trial: 66. Best value: 0.0939863:  77%|███████▋  | 77/100 [01:27<00:19,  1.16it/s]Best trial: 66. Best value: 0.0939863:  78%|███████▊  | 78/100 [01:27<00:19,  1.10it/s]Best trial: 66. Best value: 0.0939863:  78%|███████▊  | 78/100 [01:28<00:19,  1.10it/s]Best trial: 66. Best value: 0.0939863:  79%|███████▉  | 79/100 [01:28<00:19,  1.10it/s]Best trial: 66. Best value: 0.0939863:  79%|███████▉  | 79/100 [01:29<00:19,  1.10it/s]Best trial: 66. Best value: 0.0939863:  80%|████████  | 80/100 [01:29<00:18,  1.08it/s]Best trial: 66. Best value: 0.0939863:  80%|████████  | 80/100 [01:30<00:18,  1.08it/s]Best trial: 66. Best value: 0.0939863:  81%|████████  | 81/100 [01:30<00:18,  1.05it/s]Best trial: 66. Best value: 0.0939863:  81%|████████  | 81/100 [01:31<00:18,  1.05it/s]Best trial: 66. Best value: 0.0939863:  82%|████████▏ | 82/100 [01:31<00:17,  1.01it/s]Best trial: 66. Best value: 0.0939863:  82%|████████▏ | 82/100 [01:33<00:17,  1.01it/s]Best trial: 66. Best value: 0.0939863:  83%|████████▎ | 83/100 [01:33<00:18,  1.12s/it]Best trial: 66. Best value: 0.0939863:  83%|████████▎ | 83/100 [01:35<00:18,  1.12s/it]Best trial: 66. Best value: 0.0939863:  84%|████████▍ | 84/100 [01:35<00:20,  1.31s/it]Best trial: 66. Best value: 0.0939863:  84%|████████▍ | 84/100 [01:36<00:20,  1.31s/it]Best trial: 66. Best value: 0.0939863:  85%|████████▌ | 85/100 [01:36<00:21,  1.43s/it]Best trial: 66. Best value: 0.0939863:  85%|████████▌ | 85/100 [01:38<00:21,  1.43s/it]Best trial: 66. Best value: 0.0939863:  86%|████████▌ | 86/100 [01:38<00:20,  1.45s/it]Best trial: 66. Best value: 0.0939863:  86%|████████▌ | 86/100 [01:40<00:20,  1.45s/it]Best trial: 66. Best value: 0.0939863:  87%|████████▋ | 87/100 [01:40<00:22,  1.72s/it]Best trial: 66. Best value: 0.0939863:  87%|████████▋ | 87/100 [01:42<00:22,  1.72s/it]Best trial: 66. Best value: 0.0939863:  88%|████████▊ | 88/100 [01:42<00:20,  1.73s/it]Best trial: 66. Best value: 0.0939863:  88%|████████▊ | 88/100 [01:43<00:20,  1.73s/it]Best trial: 66. Best value: 0.0939863:  89%|████████▉ | 89/100 [01:43<00:18,  1.69s/it]Best trial: 66. Best value: 0.0939863:  89%|████████▉ | 89/100 [01:45<00:18,  1.69s/it]Best trial: 66. Best value: 0.0939863:  90%|█████████ | 90/100 [01:45<00:15,  1.55s/it]Best trial: 66. Best value: 0.0939863:  90%|█████████ | 90/100 [01:46<00:15,  1.55s/it]Best trial: 66. Best value: 0.0939863:  91%|█████████ | 91/100 [01:46<00:13,  1.49s/it]Best trial: 66. Best value: 0.0939863:  91%|█████████ | 91/100 [01:47<00:13,  1.49s/it]Best trial: 66. Best value: 0.0939863:  92%|█████████▏| 92/100 [01:47<00:10,  1.35s/it]Best trial: 66. Best value: 0.0939863:  92%|█████████▏| 92/100 [01:48<00:10,  1.35s/it]Best trial: 66. Best value: 0.0939863:  93%|█████████▎| 93/100 [01:48<00:09,  1.35s/it]Best trial: 66. Best value: 0.0939863:  93%|█████████▎| 93/100 [01:50<00:09,  1.35s/it]Best trial: 66. Best value: 0.0939863:  94%|█████████▍| 94/100 [01:50<00:08,  1.42s/it]Best trial: 66. Best value: 0.0939863:  94%|█████████▍| 94/100 [01:52<00:08,  1.42s/it]Best trial: 66. Best value: 0.0939863:  95%|█████████▌| 95/100 [01:52<00:07,  1.51s/it]Best trial: 66. Best value: 0.0939863:  95%|█████████▌| 95/100 [01:53<00:07,  1.51s/it]Best trial: 66. Best value: 0.0939863:  96%|█████████▌| 96/100 [01:53<00:06,  1.50s/it]Best trial: 96. Best value: 0.0949332:  96%|█████████▌| 96/100 [01:54<00:06,  1.50s/it]Best trial: 96. Best value: 0.0949332:  97%|█████████▋| 97/100 [01:54<00:04,  1.43s/it]Best trial: 96. Best value: 0.0949332:  97%|█████████▋| 97/100 [01:55<00:04,  1.43s/it]Best trial: 96. Best value: 0.0949332:  98%|█████████▊| 98/100 [01:55<00:02,  1.29s/it]Best trial: 96. Best value: 0.0949332:  98%|█████████▊| 98/100 [01:56<00:02,  1.29s/it]Best trial: 96. Best value: 0.0949332:  99%|█████████▉| 99/100 [01:56<00:01,  1.23s/it]Best trial: 96. Best value: 0.0949332:  99%|█████████▉| 99/100 [01:58<00:01,  1.23s/it]Best trial: 96. Best value: 0.0949332: 100%|██████████| 100/100 [01:58<00:00,  1.27s/it]Best trial: 96. Best value: 0.0949332: 100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
2025-11-30 14:43:29,161 - INFO - HPO Complete. Best AUPRC: 0.0949
2025-11-30 14:43:29,161 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.0003087944742791453, 'max_depth': 5, 'subsample': 0.9735556526698191, 'colsample_bytree': 0.6281539362909668, 'gamma': 2.8548796134605814, 'reg_lambda': 0.15712028128934274, 'reg_alpha': 1.629132511715013e-05}
2025-11-30 14:43:29,163 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:43:31,139 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: co2_only
2025-11-30 14:43:31,139 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:43:31,222 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:43:31,228 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:43:31,230 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:43:31,230 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:43:31,230 - INFO - Training model...
2025-11-30 14:43:31,817 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:43:36,428 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:43:36,428 - INFO - AUROC: 0.4981 (0.2085 - 0.7056)
2025-11-30 14:43:36,428 - INFO - AUPRC: 0.0111 (0.0042 - 0.0259)
2025-11-30 14:43:36,428 - INFO - Brier Score: 0.2291 (0.2286 - 0.2296)
2025-11-30 14:43:36,428 - INFO - Accuracy: 0.7110 (0.0110 - 0.7332)
2025-11-30 14:43:36,428 - INFO - Precision: 0.0101 (0.0044 - 0.0217)
2025-11-30 14:43:36,428 - INFO - Sensitivity (Recall): 0.3333 (0.2943 - 1.0000)
2025-11-30 14:43:36,428 - INFO - F1-Score: 0.0196 (0.0087 - 0.0413)
2025-11-30 14:43:36,428 - INFO - Best Threshold: 0.4800 (0.4700 - 0.4800)
2025-11-30 14:43:36,428 - INFO - Specificity: 0.7143 (0.0044 - 0.7377)
2025-11-30 14:43:36,436 - INFO - Calculating SHAP values...
2025-11-30 14:43:37,473 - INFO - SHAP plots saved.
2025-11-30 14:43:37,473 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:43:38,796 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: awp_only
2025-11-30 14:43:38,796 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:43:38,883 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:43:38,892 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:43:38,894 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:43:38,894 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0162704:   0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0162704:   1%|          | 1/100 [00:00<01:29,  1.11it/s]Best trial: 1. Best value: 0.0184775:   1%|          | 1/100 [00:01<01:29,  1.11it/s]Best trial: 1. Best value: 0.0184775:   2%|▏         | 2/100 [00:01<01:18,  1.25it/s]Best trial: 2. Best value: 0.0206674:   2%|▏         | 2/100 [00:02<01:18,  1.25it/s]Best trial: 2. Best value: 0.0206674:   3%|▎         | 3/100 [00:02<01:21,  1.19it/s]Best trial: 2. Best value: 0.0206674:   3%|▎         | 3/100 [00:03<01:21,  1.19it/s]Best trial: 2. Best value: 0.0206674:   4%|▍         | 4/100 [00:03<01:29,  1.07it/s]Best trial: 2. Best value: 0.0206674:   4%|▍         | 4/100 [00:04<01:29,  1.07it/s]Best trial: 2. Best value: 0.0206674:   5%|▌         | 5/100 [00:04<01:34,  1.00it/s]Best trial: 2. Best value: 0.0206674:   5%|▌         | 5/100 [00:05<01:34,  1.00it/s]Best trial: 2. Best value: 0.0206674:   6%|▌         | 6/100 [00:05<01:36,  1.02s/it]Best trial: 2. Best value: 0.0206674:   6%|▌         | 6/100 [00:06<01:36,  1.02s/it]Best trial: 2. Best value: 0.0206674:   7%|▋         | 7/100 [00:06<01:33,  1.01s/it]Best trial: 7. Best value: 0.0233329:   7%|▋         | 7/100 [00:07<01:33,  1.01s/it]Best trial: 7. Best value: 0.0233329:   8%|▊         | 8/100 [00:07<01:22,  1.12it/s]Best trial: 7. Best value: 0.0233329:   8%|▊         | 8/100 [00:08<01:22,  1.12it/s]Best trial: 7. Best value: 0.0233329:   9%|▉         | 9/100 [00:08<01:25,  1.06it/s]Best trial: 7. Best value: 0.0233329:   9%|▉         | 9/100 [00:09<01:25,  1.06it/s]Best trial: 7. Best value: 0.0233329:  10%|█         | 10/100 [00:09<01:23,  1.07it/s]Best trial: 10. Best value: 0.04293:  10%|█         | 10/100 [00:10<01:23,  1.07it/s] Best trial: 10. Best value: 0.04293:  11%|█         | 11/100 [00:10<01:15,  1.18it/s]Best trial: 11. Best value: 0.0429345:  11%|█         | 11/100 [00:10<01:15,  1.18it/s]Best trial: 11. Best value: 0.0429345:  12%|█▏        | 12/100 [00:10<01:10,  1.25it/s]Best trial: 12. Best value: 0.0435775:  12%|█▏        | 12/100 [00:11<01:10,  1.25it/s]Best trial: 12. Best value: 0.0435775:  13%|█▎        | 13/100 [00:11<01:10,  1.23it/s]Best trial: 13. Best value: 0.0448441:  13%|█▎        | 13/100 [00:12<01:10,  1.23it/s]Best trial: 13. Best value: 0.0448441:  14%|█▍        | 14/100 [00:12<01:11,  1.21it/s]Best trial: 13. Best value: 0.0448441:  14%|█▍        | 14/100 [00:13<01:11,  1.21it/s]Best trial: 13. Best value: 0.0448441:  15%|█▌        | 15/100 [00:13<01:13,  1.16it/s]Best trial: 13. Best value: 0.0448441:  15%|█▌        | 15/100 [00:14<01:13,  1.16it/s]Best trial: 13. Best value: 0.0448441:  16%|█▌        | 16/100 [00:14<01:15,  1.11it/s]Best trial: 13. Best value: 0.0448441:  16%|█▌        | 16/100 [00:15<01:15,  1.11it/s]Best trial: 13. Best value: 0.0448441:  17%|█▋        | 17/100 [00:15<01:14,  1.11it/s]Best trial: 13. Best value: 0.0448441:  17%|█▋        | 17/100 [00:16<01:14,  1.11it/s]Best trial: 13. Best value: 0.0448441:  18%|█▊        | 18/100 [00:16<01:14,  1.11it/s]Best trial: 18. Best value: 0.0555122:  18%|█▊        | 18/100 [00:16<01:14,  1.11it/s]Best trial: 18. Best value: 0.0555122:  19%|█▉        | 19/100 [00:16<01:04,  1.25it/s]Best trial: 18. Best value: 0.0555122:  19%|█▉        | 19/100 [00:17<01:04,  1.25it/s]Best trial: 18. Best value: 0.0555122:  20%|██        | 20/100 [00:17<00:58,  1.36it/s]Best trial: 20. Best value: 0.0828643:  20%|██        | 20/100 [00:18<00:58,  1.36it/s]Best trial: 20. Best value: 0.0828643:  21%|██        | 21/100 [00:18<00:59,  1.33it/s]Best trial: 20. Best value: 0.0828643:  21%|██        | 21/100 [00:18<00:59,  1.33it/s]Best trial: 20. Best value: 0.0828643:  22%|██▏       | 22/100 [00:18<00:59,  1.31it/s]Best trial: 20. Best value: 0.0828643:  22%|██▏       | 22/100 [00:19<00:59,  1.31it/s]Best trial: 20. Best value: 0.0828643:  23%|██▎       | 23/100 [00:19<00:54,  1.42it/s]Best trial: 20. Best value: 0.0828643:  23%|██▎       | 23/100 [00:20<00:54,  1.42it/s]Best trial: 20. Best value: 0.0828643:  24%|██▍       | 24/100 [00:20<00:53,  1.41it/s]Best trial: 20. Best value: 0.0828643:  24%|██▍       | 24/100 [00:20<00:53,  1.41it/s]Best trial: 20. Best value: 0.0828643:  25%|██▌       | 25/100 [00:20<00:51,  1.45it/s]Best trial: 20. Best value: 0.0828643:  25%|██▌       | 25/100 [00:21<00:51,  1.45it/s]Best trial: 20. Best value: 0.0828643:  26%|██▌       | 26/100 [00:21<00:50,  1.45it/s]Best trial: 20. Best value: 0.0828643:  26%|██▌       | 26/100 [00:22<00:50,  1.45it/s]Best trial: 20. Best value: 0.0828643:  27%|██▋       | 27/100 [00:22<00:51,  1.41it/s]Best trial: 20. Best value: 0.0828643:  27%|██▋       | 27/100 [00:22<00:51,  1.41it/s]Best trial: 20. Best value: 0.0828643:  28%|██▊       | 28/100 [00:22<00:51,  1.39it/s]Best trial: 20. Best value: 0.0828643:  28%|██▊       | 28/100 [00:23<00:51,  1.39it/s]Best trial: 20. Best value: 0.0828643:  29%|██▉       | 29/100 [00:23<00:49,  1.43it/s]Best trial: 20. Best value: 0.0828643:  29%|██▉       | 29/100 [00:24<00:49,  1.43it/s]Best trial: 20. Best value: 0.0828643:  30%|███       | 30/100 [00:24<00:48,  1.44it/s]Best trial: 20. Best value: 0.0828643:  30%|███       | 30/100 [00:24<00:48,  1.44it/s]Best trial: 20. Best value: 0.0828643:  31%|███       | 31/100 [00:24<00:47,  1.46it/s]Best trial: 20. Best value: 0.0828643:  31%|███       | 31/100 [00:25<00:47,  1.46it/s]Best trial: 20. Best value: 0.0828643:  32%|███▏      | 32/100 [00:25<00:43,  1.55it/s]Best trial: 20. Best value: 0.0828643:  32%|███▏      | 32/100 [00:26<00:43,  1.55it/s]Best trial: 20. Best value: 0.0828643:  33%|███▎      | 33/100 [00:26<00:43,  1.53it/s]Best trial: 20. Best value: 0.0828643:  33%|███▎      | 33/100 [00:26<00:43,  1.53it/s]Best trial: 20. Best value: 0.0828643:  34%|███▍      | 34/100 [00:26<00:43,  1.53it/s]Best trial: 20. Best value: 0.0828643:  34%|███▍      | 34/100 [00:27<00:43,  1.53it/s]Best trial: 20. Best value: 0.0828643:  35%|███▌      | 35/100 [00:27<00:41,  1.56it/s]Best trial: 20. Best value: 0.0828643:  35%|███▌      | 35/100 [00:28<00:41,  1.56it/s]Best trial: 20. Best value: 0.0828643:  36%|███▌      | 36/100 [00:28<00:53,  1.19it/s]Best trial: 20. Best value: 0.0828643:  36%|███▌      | 36/100 [00:29<00:53,  1.19it/s]Best trial: 20. Best value: 0.0828643:  37%|███▋      | 37/100 [00:29<00:52,  1.19it/s]Best trial: 20. Best value: 0.0828643:  37%|███▋      | 37/100 [00:30<00:52,  1.19it/s]Best trial: 20. Best value: 0.0828643:  38%|███▊      | 38/100 [00:30<00:48,  1.27it/s]Best trial: 20. Best value: 0.0828643:  38%|███▊      | 38/100 [00:31<00:48,  1.27it/s]Best trial: 20. Best value: 0.0828643:  39%|███▉      | 39/100 [00:31<00:47,  1.28it/s]Best trial: 20. Best value: 0.0828643:  39%|███▉      | 39/100 [00:32<00:47,  1.28it/s]Best trial: 20. Best value: 0.0828643:  40%|████      | 40/100 [00:32<00:54,  1.11it/s]Best trial: 20. Best value: 0.0828643:  40%|████      | 40/100 [00:33<00:54,  1.11it/s]Best trial: 20. Best value: 0.0828643:  41%|████      | 41/100 [00:33<01:06,  1.13s/it]Best trial: 20. Best value: 0.0828643:  41%|████      | 41/100 [00:34<01:06,  1.13s/it]Best trial: 20. Best value: 0.0828643:  42%|████▏     | 42/100 [00:34<00:56,  1.02it/s]Best trial: 20. Best value: 0.0828643:  42%|████▏     | 42/100 [00:35<00:56,  1.02it/s]Best trial: 20. Best value: 0.0828643:  43%|████▎     | 43/100 [00:35<00:50,  1.14it/s]Best trial: 20. Best value: 0.0828643:  43%|████▎     | 43/100 [00:35<00:50,  1.14it/s]Best trial: 20. Best value: 0.0828643:  44%|████▍     | 44/100 [00:35<00:47,  1.18it/s]Best trial: 20. Best value: 0.0828643:  44%|████▍     | 44/100 [00:36<00:47,  1.18it/s]Best trial: 20. Best value: 0.0828643:  45%|████▌     | 45/100 [00:36<00:44,  1.23it/s]Best trial: 20. Best value: 0.0828643:  45%|████▌     | 45/100 [00:37<00:44,  1.23it/s]Best trial: 20. Best value: 0.0828643:  46%|████▌     | 46/100 [00:37<00:44,  1.21it/s]Best trial: 20. Best value: 0.0828643:  46%|████▌     | 46/100 [00:38<00:44,  1.21it/s]Best trial: 20. Best value: 0.0828643:  47%|████▋     | 47/100 [00:38<00:44,  1.19it/s]Best trial: 20. Best value: 0.0828643:  47%|████▋     | 47/100 [00:39<00:44,  1.19it/s]Best trial: 20. Best value: 0.0828643:  48%|████▊     | 48/100 [00:39<00:46,  1.12it/s]Best trial: 20. Best value: 0.0828643:  48%|████▊     | 48/100 [00:40<00:46,  1.12it/s]Best trial: 20. Best value: 0.0828643:  49%|████▉     | 49/100 [00:40<00:45,  1.11it/s]Best trial: 20. Best value: 0.0828643:  49%|████▉     | 49/100 [00:41<00:45,  1.11it/s]Best trial: 20. Best value: 0.0828643:  50%|█████     | 50/100 [00:41<00:45,  1.11it/s]Best trial: 20. Best value: 0.0828643:  50%|█████     | 50/100 [00:42<00:45,  1.11it/s]Best trial: 20. Best value: 0.0828643:  51%|█████     | 51/100 [00:42<00:46,  1.06it/s]Best trial: 20. Best value: 0.0828643:  51%|█████     | 51/100 [00:43<00:46,  1.06it/s]Best trial: 20. Best value: 0.0828643:  52%|█████▏    | 52/100 [00:43<00:45,  1.05it/s]Best trial: 20. Best value: 0.0828643:  52%|█████▏    | 52/100 [00:44<00:45,  1.05it/s]Best trial: 20. Best value: 0.0828643:  53%|█████▎    | 53/100 [00:44<00:43,  1.08it/s]Best trial: 20. Best value: 0.0828643:  53%|█████▎    | 53/100 [00:45<00:43,  1.08it/s]Best trial: 20. Best value: 0.0828643:  54%|█████▍    | 54/100 [00:45<00:41,  1.10it/s]Best trial: 20. Best value: 0.0828643:  54%|█████▍    | 54/100 [00:45<00:41,  1.10it/s]Best trial: 20. Best value: 0.0828643:  55%|█████▌    | 55/100 [00:45<00:41,  1.08it/s]Best trial: 20. Best value: 0.0828643:  55%|█████▌    | 55/100 [00:46<00:41,  1.08it/s]Best trial: 20. Best value: 0.0828643:  56%|█████▌    | 56/100 [00:46<00:41,  1.07it/s]Best trial: 20. Best value: 0.0828643:  56%|█████▌    | 56/100 [00:48<00:41,  1.07it/s]Best trial: 20. Best value: 0.0828643:  57%|█████▋    | 57/100 [00:48<00:43,  1.00s/it]Best trial: 20. Best value: 0.0828643:  57%|█████▋    | 57/100 [00:49<00:43,  1.00s/it]Best trial: 20. Best value: 0.0828643:  58%|█████▊    | 58/100 [00:49<00:42,  1.02s/it]Best trial: 20. Best value: 0.0828643:  58%|█████▊    | 58/100 [00:50<00:42,  1.02s/it]Best trial: 20. Best value: 0.0828643:  59%|█████▉    | 59/100 [00:50<00:40,  1.01it/s]Best trial: 20. Best value: 0.0828643:  59%|█████▉    | 59/100 [00:51<00:40,  1.01it/s]Best trial: 20. Best value: 0.0828643:  60%|██████    | 60/100 [00:51<00:38,  1.03it/s]Best trial: 20. Best value: 0.0828643:  60%|██████    | 60/100 [00:51<00:38,  1.03it/s]Best trial: 20. Best value: 0.0828643:  61%|██████    | 61/100 [00:51<00:37,  1.03it/s]Best trial: 20. Best value: 0.0828643:  61%|██████    | 61/100 [00:52<00:37,  1.03it/s]Best trial: 20. Best value: 0.0828643:  62%|██████▏   | 62/100 [00:52<00:35,  1.07it/s]Best trial: 20. Best value: 0.0828643:  62%|██████▏   | 62/100 [00:53<00:35,  1.07it/s]Best trial: 20. Best value: 0.0828643:  63%|██████▎   | 63/100 [00:53<00:34,  1.07it/s]Best trial: 20. Best value: 0.0828643:  63%|██████▎   | 63/100 [00:54<00:34,  1.07it/s]Best trial: 20. Best value: 0.0828643:  64%|██████▍   | 64/100 [00:54<00:36,  1.01s/it]Best trial: 20. Best value: 0.0828643:  64%|██████▍   | 64/100 [00:55<00:36,  1.01s/it]Best trial: 20. Best value: 0.0828643:  65%|██████▌   | 65/100 [00:55<00:34,  1.00it/s]Best trial: 20. Best value: 0.0828643:  65%|██████▌   | 65/100 [00:56<00:34,  1.00it/s]Best trial: 20. Best value: 0.0828643:  66%|██████▌   | 66/100 [00:56<00:33,  1.02it/s]Best trial: 20. Best value: 0.0828643:  66%|██████▌   | 66/100 [00:57<00:33,  1.02it/s]Best trial: 20. Best value: 0.0828643:  67%|██████▋   | 67/100 [00:57<00:29,  1.12it/s]Best trial: 20. Best value: 0.0828643:  67%|██████▋   | 67/100 [00:58<00:29,  1.12it/s]Best trial: 20. Best value: 0.0828643:  68%|██████▊   | 68/100 [00:58<00:27,  1.17it/s]Best trial: 20. Best value: 0.0828643:  68%|██████▊   | 68/100 [00:58<00:27,  1.17it/s]Best trial: 20. Best value: 0.0828643:  69%|██████▉   | 69/100 [00:58<00:24,  1.28it/s]Best trial: 20. Best value: 0.0828643:  69%|██████▉   | 69/100 [00:59<00:24,  1.28it/s]Best trial: 20. Best value: 0.0828643:  70%|███████   | 70/100 [00:59<00:25,  1.19it/s]Best trial: 20. Best value: 0.0828643:  70%|███████   | 70/100 [01:00<00:25,  1.19it/s]Best trial: 20. Best value: 0.0828643:  71%|███████   | 71/100 [01:00<00:22,  1.31it/s]Best trial: 20. Best value: 0.0828643:  71%|███████   | 71/100 [01:01<00:22,  1.31it/s]Best trial: 20. Best value: 0.0828643:  72%|███████▏  | 72/100 [01:01<00:22,  1.24it/s]Best trial: 20. Best value: 0.0828643:  72%|███████▏  | 72/100 [01:02<00:22,  1.24it/s]Best trial: 20. Best value: 0.0828643:  73%|███████▎  | 73/100 [01:02<00:23,  1.14it/s]Best trial: 20. Best value: 0.0828643:  73%|███████▎  | 73/100 [01:03<00:23,  1.14it/s]Best trial: 20. Best value: 0.0828643:  74%|███████▍  | 74/100 [01:03<00:22,  1.14it/s]Best trial: 20. Best value: 0.0828643:  74%|███████▍  | 74/100 [01:04<00:22,  1.14it/s]Best trial: 20. Best value: 0.0828643:  75%|███████▌  | 75/100 [01:04<00:23,  1.07it/s]Best trial: 20. Best value: 0.0828643:  75%|███████▌  | 75/100 [01:05<00:23,  1.07it/s]Best trial: 20. Best value: 0.0828643:  76%|███████▌  | 76/100 [01:05<00:22,  1.08it/s]Best trial: 20. Best value: 0.0828643:  76%|███████▌  | 76/100 [01:05<00:22,  1.08it/s]Best trial: 20. Best value: 0.0828643:  77%|███████▋  | 77/100 [01:05<00:19,  1.21it/s]Best trial: 20. Best value: 0.0828643:  77%|███████▋  | 77/100 [01:06<00:19,  1.21it/s]Best trial: 20. Best value: 0.0828643:  78%|███████▊  | 78/100 [01:06<00:17,  1.27it/s]Best trial: 20. Best value: 0.0828643:  78%|███████▊  | 78/100 [01:07<00:17,  1.27it/s]Best trial: 20. Best value: 0.0828643:  79%|███████▉  | 79/100 [01:07<00:15,  1.38it/s]Best trial: 20. Best value: 0.0828643:  79%|███████▉  | 79/100 [01:07<00:15,  1.38it/s]Best trial: 20. Best value: 0.0828643:  80%|████████  | 80/100 [01:07<00:14,  1.38it/s]Best trial: 20. Best value: 0.0828643:  80%|████████  | 80/100 [01:08<00:14,  1.38it/s]Best trial: 20. Best value: 0.0828643:  81%|████████  | 81/100 [01:08<00:13,  1.39it/s]Best trial: 20. Best value: 0.0828643:  81%|████████  | 81/100 [01:09<00:13,  1.39it/s]Best trial: 20. Best value: 0.0828643:  82%|████████▏ | 82/100 [01:09<00:12,  1.41it/s]Best trial: 20. Best value: 0.0828643:  82%|████████▏ | 82/100 [01:09<00:12,  1.41it/s]Best trial: 20. Best value: 0.0828643:  83%|████████▎ | 83/100 [01:09<00:11,  1.43it/s]Best trial: 20. Best value: 0.0828643:  83%|████████▎ | 83/100 [01:10<00:11,  1.43it/s]Best trial: 20. Best value: 0.0828643:  84%|████████▍ | 84/100 [01:10<00:10,  1.50it/s]Best trial: 20. Best value: 0.0828643:  84%|████████▍ | 84/100 [01:11<00:10,  1.50it/s]Best trial: 20. Best value: 0.0828643:  85%|████████▌ | 85/100 [01:11<00:09,  1.55it/s]Best trial: 20. Best value: 0.0828643:  85%|████████▌ | 85/100 [01:11<00:09,  1.55it/s]Best trial: 20. Best value: 0.0828643:  86%|████████▌ | 86/100 [01:11<00:09,  1.46it/s]Best trial: 20. Best value: 0.0828643:  86%|████████▌ | 86/100 [01:12<00:09,  1.46it/s]Best trial: 20. Best value: 0.0828643:  87%|████████▋ | 87/100 [01:12<00:08,  1.45it/s]Best trial: 20. Best value: 0.0828643:  87%|████████▋ | 87/100 [01:13<00:08,  1.45it/s]Best trial: 20. Best value: 0.0828643:  88%|████████▊ | 88/100 [01:13<00:08,  1.40it/s]Best trial: 20. Best value: 0.0828643:  88%|████████▊ | 88/100 [01:14<00:08,  1.40it/s]Best trial: 20. Best value: 0.0828643:  89%|████████▉ | 89/100 [01:14<00:07,  1.44it/s]Best trial: 20. Best value: 0.0828643:  89%|████████▉ | 89/100 [01:14<00:07,  1.44it/s]Best trial: 20. Best value: 0.0828643:  90%|█████████ | 90/100 [01:14<00:06,  1.47it/s]Best trial: 20. Best value: 0.0828643:  90%|█████████ | 90/100 [01:15<00:06,  1.47it/s]Best trial: 20. Best value: 0.0828643:  91%|█████████ | 91/100 [01:15<00:05,  1.54it/s]Best trial: 20. Best value: 0.0828643:  91%|█████████ | 91/100 [01:16<00:05,  1.54it/s]Best trial: 20. Best value: 0.0828643:  92%|█████████▏| 92/100 [01:16<00:05,  1.46it/s]Best trial: 20. Best value: 0.0828643:  92%|█████████▏| 92/100 [01:16<00:05,  1.46it/s]Best trial: 20. Best value: 0.0828643:  93%|█████████▎| 93/100 [01:16<00:04,  1.45it/s]Best trial: 20. Best value: 0.0828643:  93%|█████████▎| 93/100 [01:17<00:04,  1.45it/s]Best trial: 20. Best value: 0.0828643:  94%|█████████▍| 94/100 [01:17<00:04,  1.44it/s]Best trial: 20. Best value: 0.0828643:  94%|█████████▍| 94/100 [01:18<00:04,  1.44it/s]Best trial: 20. Best value: 0.0828643:  95%|█████████▌| 95/100 [01:18<00:03,  1.43it/s]Best trial: 20. Best value: 0.0828643:  95%|█████████▌| 95/100 [01:18<00:03,  1.43it/s]Best trial: 20. Best value: 0.0828643:  96%|█████████▌| 96/100 [01:18<00:02,  1.41it/s]Best trial: 20. Best value: 0.0828643:  96%|█████████▌| 96/100 [01:19<00:02,  1.41it/s]Best trial: 20. Best value: 0.0828643:  97%|█████████▋| 97/100 [01:19<00:02,  1.42it/s]Best trial: 20. Best value: 0.0828643:  97%|█████████▋| 97/100 [01:20<00:02,  1.42it/s]Best trial: 20. Best value: 0.0828643:  98%|█████████▊| 98/100 [01:20<00:01,  1.42it/s]Best trial: 20. Best value: 0.0828643:  98%|█████████▊| 98/100 [01:21<00:01,  1.42it/s]Best trial: 20. Best value: 0.0828643:  99%|█████████▉| 99/100 [01:21<00:00,  1.37it/s]Best trial: 20. Best value: 0.0828643:  99%|█████████▉| 99/100 [01:21<00:00,  1.37it/s]Best trial: 20. Best value: 0.0828643: 100%|██████████| 100/100 [01:21<00:00,  1.45it/s]Best trial: 20. Best value: 0.0828643: 100%|██████████| 100/100 [01:21<00:00,  1.23it/s]
2025-11-30 14:45:00,526 - INFO - HPO Complete. Best AUPRC: 0.0829
2025-11-30 14:45:00,527 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.0005666856232968541, 'max_depth': 3, 'subsample': 0.7696180750922609, 'colsample_bytree': 0.9810305838010772, 'gamma': 2.2782266750911253, 'reg_lambda': 0.0500872416373338, 'reg_alpha': 0.0006328713488736357}
2025-11-30 14:45:00,527 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:45:02,308 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: awp_only
2025-11-30 14:45:02,308 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:45:02,391 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:45:02,397 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:45:02,399 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 14:45:02,399 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:45:02,399 - INFO - Training model...
2025-11-30 14:45:03,166 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:45:07,782 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:45:07,782 - INFO - AUROC: 0.5114 (0.3864 - 0.5861)
2025-11-30 14:45:07,782 - INFO - AUPRC: 0.0098 (0.0052 - 0.0203)
2025-11-30 14:45:07,782 - INFO - Brier Score: 0.2155 (0.2134 - 0.2170)
2025-11-30 14:45:07,782 - INFO - Accuracy: 0.3223 (0.2971 - 0.5393)
2025-11-30 14:45:07,782 - INFO - Precision: 0.0126 (0.0061 - 0.0250)
2025-11-30 14:45:07,782 - INFO - Sensitivity (Recall): 1.0000 (0.7800 - 1.0000)
2025-11-30 14:45:07,783 - INFO - F1-Score: 0.0249 (0.0121 - 0.0486)
2025-11-30 14:45:07,783 - INFO - Best Threshold: 0.4500 (0.4500 - 0.4700)
2025-11-30 14:45:07,783 - INFO - Specificity: 0.3163 (0.2925 - 0.5368)
2025-11-30 14:45:07,790 - INFO - Calculating SHAP values...
2025-11-30 14:45:08,821 - INFO - SHAP plots saved.
2025-11-30 14:45:08,821 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:45:10,115 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 14:45:10,115 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:45:10,226 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:45:10,249 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:45:10,253 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 14:45:10,254 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.02863:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.02863:   1%|          | 1/100 [00:02<04:20,  2.64s/it]Best trial: 1. Best value: 0.0319961:   1%|          | 1/100 [00:05<04:20,  2.64s/it]Best trial: 1. Best value: 0.0319961:   2%|▏         | 2/100 [00:05<04:03,  2.49s/it]Best trial: 2. Best value: 0.0479669:   2%|▏         | 2/100 [00:06<04:03,  2.49s/it]Best trial: 2. Best value: 0.0479669:   3%|▎         | 3/100 [00:06<03:24,  2.11s/it]Best trial: 2. Best value: 0.0479669:   3%|▎         | 3/100 [00:08<03:24,  2.11s/it]Best trial: 2. Best value: 0.0479669:   4%|▍         | 4/100 [00:08<03:24,  2.13s/it]Best trial: 2. Best value: 0.0479669:   4%|▍         | 4/100 [00:10<03:24,  2.13s/it]Best trial: 2. Best value: 0.0479669:   5%|▌         | 5/100 [00:10<03:11,  2.01s/it]Best trial: 2. Best value: 0.0479669:   5%|▌         | 5/100 [00:14<03:11,  2.01s/it]Best trial: 2. Best value: 0.0479669:   6%|▌         | 6/100 [00:14<03:54,  2.50s/it]Best trial: 6. Best value: 0.0742681:   6%|▌         | 6/100 [00:16<03:54,  2.50s/it]Best trial: 6. Best value: 0.0742681:   7%|▋         | 7/100 [00:16<04:00,  2.59s/it]Best trial: 6. Best value: 0.0742681:   7%|▋         | 7/100 [00:19<04:00,  2.59s/it]Best trial: 6. Best value: 0.0742681:   8%|▊         | 8/100 [00:19<04:13,  2.76s/it]Best trial: 6. Best value: 0.0742681:   8%|▊         | 8/100 [00:22<04:13,  2.76s/it]Best trial: 6. Best value: 0.0742681:   9%|▉         | 9/100 [00:22<04:02,  2.66s/it]Best trial: 6. Best value: 0.0742681:   9%|▉         | 9/100 [00:25<04:02,  2.66s/it]Best trial: 6. Best value: 0.0742681:  10%|█         | 10/100 [00:25<04:00,  2.67s/it]Best trial: 10. Best value: 0.0794374:  10%|█         | 10/100 [00:26<04:00,  2.67s/it]Best trial: 10. Best value: 0.0794374:  11%|█         | 11/100 [00:26<03:23,  2.29s/it]Best trial: 10. Best value: 0.0794374:  11%|█         | 11/100 [00:28<03:23,  2.29s/it]Best trial: 10. Best value: 0.0794374:  12%|█▏        | 12/100 [00:28<03:07,  2.13s/it]Best trial: 10. Best value: 0.0794374:  12%|█▏        | 12/100 [00:29<03:07,  2.13s/it]Best trial: 10. Best value: 0.0794374:  13%|█▎        | 13/100 [00:29<02:48,  1.94s/it]Best trial: 10. Best value: 0.0794374:  13%|█▎        | 13/100 [00:31<02:48,  1.94s/it]Best trial: 10. Best value: 0.0794374:  14%|█▍        | 14/100 [00:31<02:48,  1.96s/it]Best trial: 10. Best value: 0.0794374:  14%|█▍        | 14/100 [00:33<02:48,  1.96s/it]Best trial: 10. Best value: 0.0794374:  15%|█▌        | 15/100 [00:33<02:35,  1.83s/it]Best trial: 10. Best value: 0.0794374:  15%|█▌        | 15/100 [00:35<02:35,  1.83s/it]Best trial: 10. Best value: 0.0794374:  16%|█▌        | 16/100 [00:35<02:51,  2.04s/it]Best trial: 10. Best value: 0.0794374:  16%|█▌        | 16/100 [00:38<02:51,  2.04s/it]Best trial: 10. Best value: 0.0794374:  17%|█▋        | 17/100 [00:38<02:53,  2.09s/it]Best trial: 10. Best value: 0.0794374:  17%|█▋        | 17/100 [00:40<02:53,  2.09s/it]Best trial: 10. Best value: 0.0794374:  18%|█▊        | 18/100 [00:40<02:47,  2.04s/it]Best trial: 10. Best value: 0.0794374:  18%|█▊        | 18/100 [00:41<02:47,  2.04s/it]Best trial: 10. Best value: 0.0794374:  19%|█▉        | 19/100 [00:41<02:39,  1.97s/it]Best trial: 10. Best value: 0.0794374:  19%|█▉        | 19/100 [00:43<02:39,  1.97s/it]Best trial: 10. Best value: 0.0794374:  20%|██        | 20/100 [00:43<02:37,  1.97s/it]Best trial: 10. Best value: 0.0794374:  20%|██        | 20/100 [00:46<02:37,  1.97s/it]Best trial: 10. Best value: 0.0794374:  21%|██        | 21/100 [00:46<02:48,  2.13s/it]Best trial: 10. Best value: 0.0794374:  21%|██        | 21/100 [00:49<02:48,  2.13s/it]Best trial: 10. Best value: 0.0794374:  22%|██▏       | 22/100 [00:49<03:00,  2.31s/it]Best trial: 10. Best value: 0.0794374:  22%|██▏       | 22/100 [00:52<03:00,  2.31s/it]Best trial: 10. Best value: 0.0794374:  23%|██▎       | 23/100 [00:52<03:16,  2.56s/it]Best trial: 10. Best value: 0.0794374:  23%|██▎       | 23/100 [00:54<03:16,  2.56s/it]Best trial: 10. Best value: 0.0794374:  24%|██▍       | 24/100 [00:54<03:11,  2.53s/it]Best trial: 24. Best value: 0.089404:  24%|██▍       | 24/100 [00:56<03:11,  2.53s/it] Best trial: 24. Best value: 0.089404:  25%|██▌       | 25/100 [00:56<02:58,  2.38s/it]Best trial: 24. Best value: 0.089404:  25%|██▌       | 25/100 [00:58<02:58,  2.38s/it]Best trial: 24. Best value: 0.089404:  26%|██▌       | 26/100 [00:58<02:41,  2.18s/it]Best trial: 24. Best value: 0.089404:  26%|██▌       | 26/100 [01:00<02:41,  2.18s/it]Best trial: 24. Best value: 0.089404:  27%|██▋       | 27/100 [01:00<02:40,  2.20s/it]Best trial: 24. Best value: 0.089404:  27%|██▋       | 27/100 [01:02<02:40,  2.20s/it]Best trial: 24. Best value: 0.089404:  28%|██▊       | 28/100 [01:02<02:31,  2.11s/it]Best trial: 24. Best value: 0.089404:  28%|██▊       | 28/100 [01:04<02:31,  2.11s/it]Best trial: 24. Best value: 0.089404:  29%|██▉       | 29/100 [01:04<02:30,  2.12s/it]Best trial: 24. Best value: 0.089404:  29%|██▉       | 29/100 [01:07<02:30,  2.12s/it]Best trial: 24. Best value: 0.089404:  30%|███       | 30/100 [01:07<02:34,  2.21s/it]Best trial: 24. Best value: 0.089404:  30%|███       | 30/100 [01:08<02:34,  2.21s/it]Best trial: 24. Best value: 0.089404:  31%|███       | 31/100 [01:08<02:24,  2.09s/it]Best trial: 24. Best value: 0.089404:  31%|███       | 31/100 [01:10<02:24,  2.09s/it]Best trial: 24. Best value: 0.089404:  32%|███▏      | 32/100 [01:10<02:12,  1.95s/it]Best trial: 24. Best value: 0.089404:  32%|███▏      | 32/100 [01:11<02:12,  1.95s/it]Best trial: 24. Best value: 0.089404:  33%|███▎      | 33/100 [01:11<02:00,  1.81s/it]Best trial: 24. Best value: 0.089404:  33%|███▎      | 33/100 [01:13<02:00,  1.81s/it]Best trial: 24. Best value: 0.089404:  34%|███▍      | 34/100 [01:13<01:56,  1.76s/it]Best trial: 24. Best value: 0.089404:  34%|███▍      | 34/100 [01:15<01:56,  1.76s/it]Best trial: 24. Best value: 0.089404:  35%|███▌      | 35/100 [01:15<02:05,  1.93s/it]Best trial: 24. Best value: 0.089404:  35%|███▌      | 35/100 [01:18<02:05,  1.93s/it]Best trial: 24. Best value: 0.089404:  36%|███▌      | 36/100 [01:18<02:21,  2.21s/it]Best trial: 24. Best value: 0.089404:  36%|███▌      | 36/100 [01:20<02:21,  2.21s/it]Best trial: 24. Best value: 0.089404:  37%|███▋      | 37/100 [01:20<02:11,  2.09s/it]Best trial: 24. Best value: 0.089404:  37%|███▋      | 37/100 [01:22<02:11,  2.09s/it]Best trial: 24. Best value: 0.089404:  38%|███▊      | 38/100 [01:22<02:08,  2.07s/it]Best trial: 24. Best value: 0.089404:  38%|███▊      | 38/100 [01:26<02:08,  2.07s/it]Best trial: 24. Best value: 0.089404:  39%|███▉      | 39/100 [01:26<02:36,  2.56s/it]Best trial: 24. Best value: 0.089404:  39%|███▉      | 39/100 [01:28<02:36,  2.56s/it]Best trial: 24. Best value: 0.089404:  40%|████      | 40/100 [01:28<02:30,  2.50s/it]Best trial: 24. Best value: 0.089404:  40%|████      | 40/100 [01:32<02:30,  2.50s/it]Best trial: 24. Best value: 0.089404:  41%|████      | 41/100 [01:32<02:48,  2.85s/it]Best trial: 24. Best value: 0.089404:  41%|████      | 41/100 [01:34<02:48,  2.85s/it]Best trial: 24. Best value: 0.089404:  42%|████▏     | 42/100 [01:34<02:28,  2.55s/it]Best trial: 24. Best value: 0.089404:  42%|████▏     | 42/100 [01:36<02:28,  2.55s/it]Best trial: 24. Best value: 0.089404:  43%|████▎     | 43/100 [01:36<02:13,  2.34s/it]Best trial: 24. Best value: 0.089404:  43%|████▎     | 43/100 [01:37<02:13,  2.34s/it]Best trial: 24. Best value: 0.089404:  44%|████▍     | 44/100 [01:37<02:00,  2.16s/it]Best trial: 24. Best value: 0.089404:  44%|████▍     | 44/100 [01:40<02:00,  2.16s/it]Best trial: 24. Best value: 0.089404:  45%|████▌     | 45/100 [01:40<01:59,  2.17s/it]Best trial: 24. Best value: 0.089404:  45%|████▌     | 45/100 [01:42<01:59,  2.17s/it]Best trial: 24. Best value: 0.089404:  46%|████▌     | 46/100 [01:42<01:57,  2.18s/it]Best trial: 24. Best value: 0.089404:  46%|████▌     | 46/100 [01:43<01:57,  2.18s/it]Best trial: 24. Best value: 0.089404:  47%|████▋     | 47/100 [01:43<01:48,  2.05s/it]Best trial: 47. Best value: 0.092864:  47%|████▋     | 47/100 [01:46<01:48,  2.05s/it]Best trial: 47. Best value: 0.092864:  48%|████▊     | 48/100 [01:46<01:49,  2.10s/it]Best trial: 47. Best value: 0.092864:  48%|████▊     | 48/100 [01:48<01:49,  2.10s/it]Best trial: 47. Best value: 0.092864:  49%|████▉     | 49/100 [01:48<01:51,  2.18s/it]Best trial: 49. Best value: 0.102259:  49%|████▉     | 49/100 [01:50<01:51,  2.18s/it]Best trial: 49. Best value: 0.102259:  50%|█████     | 50/100 [01:50<01:47,  2.16s/it]Best trial: 49. Best value: 0.102259:  50%|█████     | 50/100 [01:53<01:47,  2.16s/it]Best trial: 49. Best value: 0.102259:  51%|█████     | 51/100 [01:53<01:51,  2.28s/it]Best trial: 49. Best value: 0.102259:  51%|█████     | 51/100 [01:55<01:51,  2.28s/it]Best trial: 49. Best value: 0.102259:  52%|█████▏    | 52/100 [01:55<01:45,  2.21s/it]Best trial: 49. Best value: 0.102259:  52%|█████▏    | 52/100 [01:57<01:45,  2.21s/it]Best trial: 49. Best value: 0.102259:  53%|█████▎    | 53/100 [01:57<01:40,  2.14s/it]Best trial: 49. Best value: 0.102259:  53%|█████▎    | 53/100 [01:58<01:40,  2.14s/it]Best trial: 49. Best value: 0.102259:  54%|█████▍    | 54/100 [01:58<01:32,  2.02s/it]Best trial: 49. Best value: 0.102259:  54%|█████▍    | 54/100 [02:01<01:32,  2.02s/it]Best trial: 49. Best value: 0.102259:  55%|█████▌    | 55/100 [02:01<01:33,  2.08s/it]Best trial: 49. Best value: 0.102259:  55%|█████▌    | 55/100 [02:03<01:33,  2.08s/it]Best trial: 49. Best value: 0.102259:  56%|█████▌    | 56/100 [02:03<01:34,  2.15s/it]Best trial: 49. Best value: 0.102259:  56%|█████▌    | 56/100 [02:05<01:34,  2.15s/it]Best trial: 49. Best value: 0.102259:  57%|█████▋    | 57/100 [02:05<01:27,  2.03s/it]Best trial: 49. Best value: 0.102259:  57%|█████▋    | 57/100 [02:07<01:27,  2.03s/it]Best trial: 49. Best value: 0.102259:  58%|█████▊    | 58/100 [02:07<01:28,  2.11s/it]Best trial: 49. Best value: 0.102259:  58%|█████▊    | 58/100 [02:09<01:28,  2.11s/it]Best trial: 49. Best value: 0.102259:  59%|█████▉    | 59/100 [02:09<01:29,  2.19s/it]Best trial: 49. Best value: 0.102259:  59%|█████▉    | 59/100 [02:11<01:29,  2.19s/it]Best trial: 49. Best value: 0.102259:  60%|██████    | 60/100 [02:11<01:25,  2.14s/it]Best trial: 49. Best value: 0.102259:  60%|██████    | 60/100 [02:13<01:25,  2.14s/it]Best trial: 49. Best value: 0.102259:  61%|██████    | 61/100 [02:13<01:21,  2.09s/it]Best trial: 49. Best value: 0.102259:  61%|██████    | 61/100 [02:15<01:21,  2.09s/it]Best trial: 49. Best value: 0.102259:  62%|██████▏   | 62/100 [02:15<01:18,  2.06s/it]Best trial: 49. Best value: 0.102259:  62%|██████▏   | 62/100 [02:18<01:18,  2.06s/it]Best trial: 49. Best value: 0.102259:  63%|██████▎   | 63/100 [02:18<01:16,  2.07s/it]Best trial: 49. Best value: 0.102259:  63%|██████▎   | 63/100 [02:20<01:16,  2.07s/it]Best trial: 49. Best value: 0.102259:  64%|██████▍   | 64/100 [02:20<01:16,  2.12s/it]Best trial: 49. Best value: 0.102259:  64%|██████▍   | 64/100 [02:22<01:16,  2.12s/it]Best trial: 49. Best value: 0.102259:  65%|██████▌   | 65/100 [02:22<01:14,  2.12s/it]Best trial: 49. Best value: 0.102259:  65%|██████▌   | 65/100 [02:24<01:14,  2.12s/it]Best trial: 49. Best value: 0.102259:  66%|██████▌   | 66/100 [02:24<01:13,  2.16s/it]Best trial: 49. Best value: 0.102259:  66%|██████▌   | 66/100 [02:26<01:13,  2.16s/it]Best trial: 49. Best value: 0.102259:  67%|██████▋   | 67/100 [02:26<01:08,  2.07s/it]Best trial: 49. Best value: 0.102259:  67%|██████▋   | 67/100 [02:28<01:08,  2.07s/it]Best trial: 49. Best value: 0.102259:  68%|██████▊   | 68/100 [02:28<01:08,  2.14s/it]Best trial: 49. Best value: 0.102259:  68%|██████▊   | 68/100 [02:31<01:08,  2.14s/it]Best trial: 49. Best value: 0.102259:  69%|██████▉   | 69/100 [02:31<01:06,  2.16s/it]Best trial: 49. Best value: 0.102259:  69%|██████▉   | 69/100 [02:33<01:06,  2.16s/it]Best trial: 49. Best value: 0.102259:  70%|███████   | 70/100 [02:33<01:05,  2.19s/it]Best trial: 49. Best value: 0.102259:  70%|███████   | 70/100 [02:35<01:05,  2.19s/it]Best trial: 49. Best value: 0.102259:  71%|███████   | 71/100 [02:35<01:01,  2.13s/it]Best trial: 49. Best value: 0.102259:  71%|███████   | 71/100 [02:37<01:01,  2.13s/it]Best trial: 49. Best value: 0.102259:  72%|███████▏  | 72/100 [02:37<00:59,  2.14s/it]Best trial: 49. Best value: 0.102259:  72%|███████▏  | 72/100 [02:39<00:59,  2.14s/it]Best trial: 49. Best value: 0.102259:  73%|███████▎  | 73/100 [02:39<01:00,  2.23s/it]Best trial: 49. Best value: 0.102259:  73%|███████▎  | 73/100 [02:42<01:00,  2.23s/it]Best trial: 49. Best value: 0.102259:  74%|███████▍  | 74/100 [02:42<00:57,  2.21s/it]Best trial: 49. Best value: 0.102259:  74%|███████▍  | 74/100 [02:43<00:57,  2.21s/it]Best trial: 49. Best value: 0.102259:  75%|███████▌  | 75/100 [02:43<00:53,  2.12s/it]Best trial: 49. Best value: 0.102259:  75%|███████▌  | 75/100 [02:46<00:53,  2.12s/it]Best trial: 49. Best value: 0.102259:  76%|███████▌  | 76/100 [02:46<00:50,  2.10s/it]Best trial: 49. Best value: 0.102259:  76%|███████▌  | 76/100 [02:48<00:50,  2.10s/it]Best trial: 49. Best value: 0.102259:  77%|███████▋  | 77/100 [02:48<00:51,  2.23s/it]Best trial: 49. Best value: 0.102259:  77%|███████▋  | 77/100 [02:51<00:51,  2.23s/it]Best trial: 49. Best value: 0.102259:  78%|███████▊  | 78/100 [02:51<00:51,  2.36s/it]Best trial: 78. Best value: 0.103636:  78%|███████▊  | 78/100 [02:52<00:51,  2.36s/it]Best trial: 78. Best value: 0.103636:  79%|███████▉  | 79/100 [02:52<00:43,  2.09s/it]Best trial: 78. Best value: 0.103636:  79%|███████▉  | 79/100 [02:53<00:43,  2.09s/it]Best trial: 78. Best value: 0.103636:  80%|████████  | 80/100 [02:53<00:36,  1.82s/it]Best trial: 78. Best value: 0.103636:  80%|████████  | 80/100 [02:55<00:36,  1.82s/it]Best trial: 78. Best value: 0.103636:  81%|████████  | 81/100 [02:55<00:33,  1.76s/it]Best trial: 78. Best value: 0.103636:  81%|████████  | 81/100 [02:57<00:33,  1.76s/it]Best trial: 78. Best value: 0.103636:  82%|████████▏ | 82/100 [02:57<00:30,  1.70s/it]Best trial: 78. Best value: 0.103636:  82%|████████▏ | 82/100 [02:59<00:30,  1.70s/it]Best trial: 78. Best value: 0.103636:  83%|████████▎ | 83/100 [02:59<00:32,  1.93s/it]Best trial: 78. Best value: 0.103636:  83%|████████▎ | 83/100 [03:01<00:32,  1.93s/it]Best trial: 78. Best value: 0.103636:  84%|████████▍ | 84/100 [03:01<00:31,  1.98s/it]Best trial: 78. Best value: 0.103636:  84%|████████▍ | 84/100 [03:03<00:31,  1.98s/it]Best trial: 78. Best value: 0.103636:  85%|████████▌ | 85/100 [03:03<00:30,  2.01s/it]Best trial: 78. Best value: 0.103636:  85%|████████▌ | 85/100 [03:05<00:30,  2.01s/it]Best trial: 78. Best value: 0.103636:  86%|████████▌ | 86/100 [03:05<00:29,  2.08s/it]Best trial: 78. Best value: 0.103636:  86%|████████▌ | 86/100 [03:07<00:29,  2.08s/it]Best trial: 78. Best value: 0.103636:  87%|████████▋ | 87/100 [03:07<00:26,  2.05s/it]Best trial: 78. Best value: 0.103636:  87%|████████▋ | 87/100 [03:10<00:26,  2.05s/it]Best trial: 78. Best value: 0.103636:  88%|████████▊ | 88/100 [03:10<00:27,  2.28s/it]Best trial: 78. Best value: 0.103636:  88%|████████▊ | 88/100 [03:13<00:27,  2.28s/it]Best trial: 78. Best value: 0.103636:  89%|████████▉ | 89/100 [03:13<00:26,  2.39s/it]Best trial: 78. Best value: 0.103636:  89%|████████▉ | 89/100 [03:17<00:26,  2.39s/it]Best trial: 78. Best value: 0.103636:  90%|█████████ | 90/100 [03:17<00:28,  2.83s/it]Best trial: 78. Best value: 0.103636:  90%|█████████ | 90/100 [03:19<00:28,  2.83s/it]Best trial: 78. Best value: 0.103636:  91%|█████████ | 91/100 [03:19<00:24,  2.77s/it]Best trial: 78. Best value: 0.103636:  91%|█████████ | 91/100 [03:22<00:24,  2.77s/it]Best trial: 78. Best value: 0.103636:  92%|█████████▏| 92/100 [03:22<00:21,  2.74s/it]Best trial: 78. Best value: 0.103636:  92%|█████████▏| 92/100 [03:25<00:21,  2.74s/it]Best trial: 78. Best value: 0.103636:  93%|█████████▎| 93/100 [03:25<00:20,  2.95s/it]Best trial: 78. Best value: 0.103636:  93%|█████████▎| 93/100 [03:28<00:20,  2.95s/it]Best trial: 78. Best value: 0.103636:  94%|█████████▍| 94/100 [03:28<00:16,  2.79s/it]Best trial: 78. Best value: 0.103636:  94%|█████████▍| 94/100 [03:31<00:16,  2.79s/it]Best trial: 78. Best value: 0.103636:  95%|█████████▌| 95/100 [03:31<00:14,  2.83s/it]Best trial: 78. Best value: 0.103636:  95%|█████████▌| 95/100 [03:33<00:14,  2.83s/it]Best trial: 78. Best value: 0.103636:  96%|█████████▌| 96/100 [03:33<00:11,  2.77s/it]Best trial: 78. Best value: 0.103636:  96%|█████████▌| 96/100 [03:35<00:11,  2.77s/it]Best trial: 78. Best value: 0.103636:  97%|█████████▋| 97/100 [03:35<00:07,  2.46s/it]Best trial: 78. Best value: 0.103636:  97%|█████████▋| 97/100 [03:37<00:07,  2.46s/it]Best trial: 78. Best value: 0.103636:  98%|█████████▊| 98/100 [03:37<00:04,  2.24s/it]Best trial: 78. Best value: 0.103636:  98%|█████████▊| 98/100 [03:40<00:04,  2.24s/it]Best trial: 78. Best value: 0.103636:  99%|█████████▉| 99/100 [03:40<00:02,  2.37s/it]Best trial: 78. Best value: 0.103636:  99%|█████████▉| 99/100 [03:44<00:02,  2.37s/it]Best trial: 78. Best value: 0.103636: 100%|██████████| 100/100 [03:44<00:00,  2.88s/it]Best trial: 78. Best value: 0.103636: 100%|██████████| 100/100 [03:44<00:00,  2.24s/it]
2025-11-30 14:48:54,366 - INFO - HPO Complete. Best AUPRC: 0.1036
2025-11-30 14:48:54,366 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.00557482663811458, 'max_depth': 4, 'subsample': 0.8416443349794142, 'colsample_bytree': 0.9296857573503293, 'gamma': 1.9779473542993313, 'reg_lambda': 0.000181187092047486, 'reg_alpha': 3.3697790350059216e-08}
2025-11-30 14:48:54,367 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:48:56,336 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 14:48:56,336 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:48:56,419 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:48:56,439 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:48:56,443 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 14:48:56,443 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:48:56,443 - INFO - Training model...
2025-11-30 14:48:59,725 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:49:04,818 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:49:04,818 - INFO - AUROC: 0.4837 (0.0643 - 0.7091)
2025-11-30 14:49:04,818 - INFO - AUPRC: 0.0927 (0.0037 - 0.5450)
2025-11-30 14:49:04,818 - INFO - Brier Score: 0.0138 (0.0106 - 0.0211)
2025-11-30 14:49:04,818 - INFO - Accuracy: 0.9913 (0.0072 - 0.9962)
2025-11-30 14:49:04,818 - INFO - Precision: 0.5000 (0.0043 - 1.0000)
2025-11-30 14:49:04,818 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 14:49:04,818 - INFO - F1-Score: 0.2500 (0.0087 - 0.7000)
2025-11-30 14:49:04,819 - INFO - Best Threshold: 0.4900 (0.0100 - 0.4900)
2025-11-30 14:49:04,819 - INFO - Specificity: 0.9985 (0.0029 - 1.0000)
2025-11-30 14:49:04,832 - INFO - Calculating SHAP values...
2025-11-30 14:49:05,938 - INFO - SHAP plots saved.
2025-11-30 14:49:05,939 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:49:07,264 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 14:49:07,264 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:49:07,370 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:49:07,418 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:49:07,433 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 14:49:07,434 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.108526:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.108526:   1%|          | 1/100 [00:04<06:53,  4.18s/it]Best trial: 0. Best value: 0.108526:   1%|          | 1/100 [00:07<06:53,  4.18s/it]Best trial: 0. Best value: 0.108526:   2%|▏         | 2/100 [00:07<06:12,  3.80s/it]Best trial: 2. Best value: 0.130403:   2%|▏         | 2/100 [00:11<06:12,  3.80s/it]Best trial: 2. Best value: 0.130403:   3%|▎         | 3/100 [00:11<06:04,  3.75s/it]Best trial: 2. Best value: 0.130403:   3%|▎         | 3/100 [00:14<06:04,  3.75s/it]Best trial: 2. Best value: 0.130403:   4%|▍         | 4/100 [00:14<05:27,  3.42s/it]Best trial: 4. Best value: 0.169131:   4%|▍         | 4/100 [00:16<05:27,  3.42s/it]Best trial: 4. Best value: 0.169131:   5%|▌         | 5/100 [00:16<04:47,  3.02s/it]Best trial: 4. Best value: 0.169131:   5%|▌         | 5/100 [00:19<04:47,  3.02s/it]Best trial: 4. Best value: 0.169131:   6%|▌         | 6/100 [00:19<04:51,  3.10s/it]Best trial: 4. Best value: 0.169131:   6%|▌         | 6/100 [00:22<04:51,  3.10s/it]Best trial: 4. Best value: 0.169131:   7%|▋         | 7/100 [00:22<04:23,  2.83s/it]Best trial: 4. Best value: 0.169131:   7%|▋         | 7/100 [00:24<04:23,  2.83s/it]Best trial: 4. Best value: 0.169131:   8%|▊         | 8/100 [00:24<04:09,  2.71s/it]Best trial: 4. Best value: 0.169131:   8%|▊         | 8/100 [00:26<04:09,  2.71s/it]Best trial: 4. Best value: 0.169131:   9%|▉         | 9/100 [00:26<03:56,  2.60s/it]Best trial: 4. Best value: 0.169131:   9%|▉         | 9/100 [00:28<03:56,  2.60s/it]Best trial: 4. Best value: 0.169131:  10%|█         | 10/100 [00:28<03:33,  2.38s/it]Best trial: 4. Best value: 0.169131:  10%|█         | 10/100 [00:31<03:33,  2.38s/it]Best trial: 4. Best value: 0.169131:  11%|█         | 11/100 [00:31<03:45,  2.53s/it]Best trial: 4. Best value: 0.169131:  11%|█         | 11/100 [00:34<03:45,  2.53s/it]Best trial: 4. Best value: 0.169131:  12%|█▏        | 12/100 [00:34<03:44,  2.55s/it]Best trial: 4. Best value: 0.169131:  12%|█▏        | 12/100 [00:36<03:44,  2.55s/it]Best trial: 4. Best value: 0.169131:  13%|█▎        | 13/100 [00:36<03:43,  2.57s/it]Best trial: 4. Best value: 0.169131:  13%|█▎        | 13/100 [00:40<03:43,  2.57s/it]Best trial: 4. Best value: 0.169131:  14%|█▍        | 14/100 [00:40<03:57,  2.76s/it]Best trial: 4. Best value: 0.169131:  14%|█▍        | 14/100 [00:44<03:57,  2.76s/it]Best trial: 4. Best value: 0.169131:  15%|█▌        | 15/100 [00:44<04:28,  3.16s/it]Best trial: 4. Best value: 0.169131:  15%|█▌        | 15/100 [00:48<04:28,  3.16s/it]Best trial: 4. Best value: 0.169131:  16%|█▌        | 16/100 [00:48<04:44,  3.39s/it]Best trial: 4. Best value: 0.169131:  16%|█▌        | 16/100 [00:50<04:44,  3.39s/it]Best trial: 4. Best value: 0.169131:  17%|█▋        | 17/100 [00:50<04:17,  3.10s/it]Best trial: 4. Best value: 0.169131:  17%|█▋        | 17/100 [00:53<04:17,  3.10s/it]Best trial: 4. Best value: 0.169131:  18%|█▊        | 18/100 [00:53<04:00,  2.94s/it]Best trial: 4. Best value: 0.169131:  18%|█▊        | 18/100 [00:55<04:00,  2.94s/it]Best trial: 4. Best value: 0.169131:  19%|█▉        | 19/100 [00:55<03:55,  2.90s/it]Best trial: 4. Best value: 0.169131:  19%|█▉        | 19/100 [00:58<03:55,  2.90s/it]Best trial: 4. Best value: 0.169131:  20%|██        | 20/100 [00:58<03:42,  2.78s/it]Best trial: 4. Best value: 0.169131:  20%|██        | 20/100 [01:01<03:42,  2.78s/it]Best trial: 4. Best value: 0.169131:  21%|██        | 21/100 [01:01<03:46,  2.87s/it]Best trial: 21. Best value: 0.178998:  21%|██        | 21/100 [01:06<03:46,  2.87s/it]Best trial: 21. Best value: 0.178998:  22%|██▏       | 22/100 [01:06<04:26,  3.41s/it]Best trial: 21. Best value: 0.178998:  22%|██▏       | 22/100 [01:09<04:26,  3.41s/it]Best trial: 21. Best value: 0.178998:  23%|██▎       | 23/100 [01:09<04:16,  3.33s/it]Best trial: 21. Best value: 0.178998:  23%|██▎       | 23/100 [01:11<04:16,  3.33s/it]Best trial: 21. Best value: 0.178998:  24%|██▍       | 24/100 [01:11<03:46,  2.97s/it]Best trial: 24. Best value: 0.197892:  24%|██▍       | 24/100 [01:15<03:46,  2.97s/it]Best trial: 24. Best value: 0.197892:  25%|██▌       | 25/100 [01:15<03:58,  3.18s/it]Best trial: 24. Best value: 0.197892:  25%|██▌       | 25/100 [01:18<03:58,  3.18s/it]Best trial: 24. Best value: 0.197892:  26%|██▌       | 26/100 [01:18<03:55,  3.19s/it]Best trial: 24. Best value: 0.197892:  26%|██▌       | 26/100 [01:23<03:55,  3.19s/it]Best trial: 24. Best value: 0.197892:  27%|██▋       | 27/100 [01:23<04:26,  3.65s/it]Best trial: 24. Best value: 0.197892:  27%|██▋       | 27/100 [01:26<04:26,  3.65s/it]Best trial: 24. Best value: 0.197892:  28%|██▊       | 28/100 [01:26<04:09,  3.47s/it]Best trial: 24. Best value: 0.197892:  28%|██▊       | 28/100 [01:28<04:09,  3.47s/it]Best trial: 24. Best value: 0.197892:  29%|██▉       | 29/100 [01:28<03:47,  3.21s/it]Best trial: 24. Best value: 0.197892:  29%|██▉       | 29/100 [01:31<03:47,  3.21s/it]Best trial: 24. Best value: 0.197892:  30%|███       | 30/100 [01:31<03:25,  2.94s/it]Best trial: 24. Best value: 0.197892:  30%|███       | 30/100 [01:34<03:25,  2.94s/it]Best trial: 24. Best value: 0.197892:  31%|███       | 31/100 [01:34<03:35,  3.12s/it]Best trial: 24. Best value: 0.197892:  31%|███       | 31/100 [01:38<03:35,  3.12s/it]Best trial: 24. Best value: 0.197892:  32%|███▏      | 32/100 [01:38<03:39,  3.23s/it]Best trial: 24. Best value: 0.197892:  32%|███▏      | 32/100 [01:41<03:39,  3.23s/it]Best trial: 24. Best value: 0.197892:  33%|███▎      | 33/100 [01:41<03:42,  3.32s/it]Best trial: 24. Best value: 0.197892:  33%|███▎      | 33/100 [01:44<03:42,  3.32s/it]Best trial: 24. Best value: 0.197892:  34%|███▍      | 34/100 [01:44<03:21,  3.05s/it]Best trial: 24. Best value: 0.197892:  34%|███▍      | 34/100 [01:48<03:21,  3.05s/it]Best trial: 24. Best value: 0.197892:  35%|███▌      | 35/100 [01:48<03:49,  3.54s/it]Best trial: 24. Best value: 0.197892:  35%|███▌      | 35/100 [01:52<03:49,  3.54s/it]Best trial: 24. Best value: 0.197892:  36%|███▌      | 36/100 [01:52<04:00,  3.76s/it]Best trial: 24. Best value: 0.197892:  36%|███▌      | 36/100 [01:55<04:00,  3.76s/it]Best trial: 24. Best value: 0.197892:  37%|███▋      | 37/100 [01:55<03:41,  3.51s/it]Best trial: 24. Best value: 0.197892:  37%|███▋      | 37/100 [01:58<03:41,  3.51s/it]Best trial: 24. Best value: 0.197892:  38%|███▊      | 38/100 [01:58<03:16,  3.18s/it]Best trial: 24. Best value: 0.197892:  38%|███▊      | 38/100 [02:01<03:16,  3.18s/it]Best trial: 24. Best value: 0.197892:  39%|███▉      | 39/100 [02:01<03:17,  3.23s/it]Best trial: 24. Best value: 0.197892:  39%|███▉      | 39/100 [02:04<03:17,  3.23s/it]Best trial: 24. Best value: 0.197892:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]Best trial: 24. Best value: 0.197892:  40%|████      | 40/100 [02:08<03:08,  3.15s/it]Best trial: 24. Best value: 0.197892:  41%|████      | 41/100 [02:08<03:15,  3.31s/it]Best trial: 24. Best value: 0.197892:  41%|████      | 41/100 [02:11<03:15,  3.31s/it]Best trial: 24. Best value: 0.197892:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]Best trial: 24. Best value: 0.197892:  42%|████▏     | 42/100 [02:13<03:02,  3.15s/it]Best trial: 24. Best value: 0.197892:  43%|████▎     | 43/100 [02:13<02:48,  2.95s/it]Best trial: 24. Best value: 0.197892:  43%|████▎     | 43/100 [02:15<02:48,  2.95s/it]Best trial: 24. Best value: 0.197892:  44%|████▍     | 44/100 [02:15<02:36,  2.79s/it]Best trial: 24. Best value: 0.197892:  44%|████▍     | 44/100 [02:18<02:36,  2.79s/it]Best trial: 24. Best value: 0.197892:  45%|████▌     | 45/100 [02:18<02:25,  2.65s/it]Best trial: 24. Best value: 0.197892:  45%|████▌     | 45/100 [02:20<02:25,  2.65s/it]Best trial: 24. Best value: 0.197892:  46%|████▌     | 46/100 [02:20<02:20,  2.60s/it]Best trial: 24. Best value: 0.197892:  46%|████▌     | 46/100 [02:23<02:20,  2.60s/it]Best trial: 24. Best value: 0.197892:  47%|████▋     | 47/100 [02:23<02:17,  2.59s/it]Best trial: 24. Best value: 0.197892:  47%|████▋     | 47/100 [02:25<02:17,  2.59s/it]Best trial: 24. Best value: 0.197892:  48%|████▊     | 48/100 [02:25<02:12,  2.56s/it]Best trial: 24. Best value: 0.197892:  48%|████▊     | 48/100 [02:28<02:12,  2.56s/it]Best trial: 24. Best value: 0.197892:  49%|████▉     | 49/100 [02:28<02:15,  2.66s/it]Best trial: 24. Best value: 0.197892:  49%|████▉     | 49/100 [02:30<02:15,  2.66s/it]Best trial: 24. Best value: 0.197892:  50%|█████     | 50/100 [02:30<02:06,  2.53s/it]Best trial: 24. Best value: 0.197892:  50%|█████     | 50/100 [02:33<02:06,  2.53s/it]Best trial: 24. Best value: 0.197892:  51%|█████     | 51/100 [02:33<02:08,  2.63s/it]Best trial: 24. Best value: 0.197892:  51%|█████     | 51/100 [02:36<02:08,  2.63s/it]Best trial: 24. Best value: 0.197892:  52%|█████▏    | 52/100 [02:36<02:00,  2.50s/it]Best trial: 24. Best value: 0.197892:  52%|█████▏    | 52/100 [02:38<02:00,  2.50s/it]Best trial: 24. Best value: 0.197892:  53%|█████▎    | 53/100 [02:38<01:52,  2.40s/it]Best trial: 24. Best value: 0.197892:  53%|█████▎    | 53/100 [02:40<01:52,  2.40s/it]Best trial: 24. Best value: 0.197892:  54%|█████▍    | 54/100 [02:40<01:51,  2.43s/it]Best trial: 24. Best value: 0.197892:  54%|█████▍    | 54/100 [02:43<01:51,  2.43s/it]Best trial: 24. Best value: 0.197892:  55%|█████▌    | 55/100 [02:43<01:53,  2.51s/it]Best trial: 24. Best value: 0.197892:  55%|█████▌    | 55/100 [02:45<01:53,  2.51s/it]Best trial: 24. Best value: 0.197892:  56%|█████▌    | 56/100 [02:45<01:50,  2.52s/it]Best trial: 24. Best value: 0.197892:  56%|█████▌    | 56/100 [02:48<01:50,  2.52s/it]Best trial: 24. Best value: 0.197892:  57%|█████▋    | 57/100 [02:48<01:50,  2.58s/it]Best trial: 24. Best value: 0.197892:  57%|█████▋    | 57/100 [02:51<01:50,  2.58s/it]Best trial: 24. Best value: 0.197892:  58%|█████▊    | 58/100 [02:51<01:49,  2.60s/it]Best trial: 24. Best value: 0.197892:  58%|█████▊    | 58/100 [02:54<01:49,  2.60s/it]Best trial: 24. Best value: 0.197892:  59%|█████▉    | 59/100 [02:54<01:51,  2.72s/it]Best trial: 24. Best value: 0.197892:  59%|█████▉    | 59/100 [02:56<01:51,  2.72s/it]Best trial: 24. Best value: 0.197892:  60%|██████    | 60/100 [02:56<01:47,  2.69s/it]Best trial: 24. Best value: 0.197892:  60%|██████    | 60/100 [02:59<01:47,  2.69s/it]Best trial: 24. Best value: 0.197892:  61%|██████    | 61/100 [02:59<01:48,  2.77s/it]Best trial: 24. Best value: 0.197892:  61%|██████    | 61/100 [03:02<01:48,  2.77s/it]Best trial: 24. Best value: 0.197892:  62%|██████▏   | 62/100 [03:02<01:40,  2.64s/it]Best trial: 24. Best value: 0.197892:  62%|██████▏   | 62/100 [03:04<01:40,  2.64s/it]Best trial: 24. Best value: 0.197892:  63%|██████▎   | 63/100 [03:04<01:36,  2.60s/it]Best trial: 24. Best value: 0.197892:  63%|██████▎   | 63/100 [03:06<01:36,  2.60s/it]Best trial: 24. Best value: 0.197892:  64%|██████▍   | 64/100 [03:06<01:29,  2.49s/it]Best trial: 24. Best value: 0.197892:  64%|██████▍   | 64/100 [03:09<01:29,  2.49s/it]Best trial: 24. Best value: 0.197892:  65%|██████▌   | 65/100 [03:09<01:32,  2.65s/it]Best trial: 24. Best value: 0.197892:  65%|██████▌   | 65/100 [03:12<01:32,  2.65s/it]Best trial: 24. Best value: 0.197892:  66%|██████▌   | 66/100 [03:12<01:32,  2.72s/it]Best trial: 24. Best value: 0.197892:  66%|██████▌   | 66/100 [03:15<01:32,  2.72s/it]Best trial: 24. Best value: 0.197892:  67%|██████▋   | 67/100 [03:15<01:30,  2.73s/it]Best trial: 24. Best value: 0.197892:  67%|██████▋   | 67/100 [03:18<01:30,  2.73s/it]Best trial: 24. Best value: 0.197892:  68%|██████▊   | 68/100 [03:18<01:27,  2.73s/it]Best trial: 24. Best value: 0.197892:  68%|██████▊   | 68/100 [03:21<01:27,  2.73s/it]Best trial: 24. Best value: 0.197892:  69%|██████▉   | 69/100 [03:21<01:25,  2.76s/it]Best trial: 24. Best value: 0.197892:  69%|██████▉   | 69/100 [03:23<01:25,  2.76s/it]Best trial: 24. Best value: 0.197892:  70%|███████   | 70/100 [03:23<01:17,  2.59s/it]Best trial: 24. Best value: 0.197892:  70%|███████   | 70/100 [03:25<01:17,  2.59s/it]Best trial: 24. Best value: 0.197892:  71%|███████   | 71/100 [03:25<01:11,  2.48s/it]Best trial: 24. Best value: 0.197892:  71%|███████   | 71/100 [03:28<01:11,  2.48s/it]Best trial: 24. Best value: 0.197892:  72%|███████▏  | 72/100 [03:28<01:16,  2.72s/it]Best trial: 24. Best value: 0.197892:  72%|███████▏  | 72/100 [03:32<01:16,  2.72s/it]Best trial: 24. Best value: 0.197892:  73%|███████▎  | 73/100 [03:32<01:19,  2.94s/it]Best trial: 24. Best value: 0.197892:  73%|███████▎  | 73/100 [03:35<01:19,  2.94s/it]Best trial: 24. Best value: 0.197892:  74%|███████▍  | 74/100 [03:35<01:15,  2.92s/it]Best trial: 24. Best value: 0.197892:  74%|███████▍  | 74/100 [03:38<01:15,  2.92s/it]Best trial: 24. Best value: 0.197892:  75%|███████▌  | 75/100 [03:38<01:14,  2.98s/it]Best trial: 24. Best value: 0.197892:  75%|███████▌  | 75/100 [03:41<01:14,  2.98s/it]Best trial: 24. Best value: 0.197892:  76%|███████▌  | 76/100 [03:41<01:12,  3.03s/it]Best trial: 24. Best value: 0.197892:  76%|███████▌  | 76/100 [03:44<01:12,  3.03s/it]Best trial: 24. Best value: 0.197892:  77%|███████▋  | 77/100 [03:44<01:07,  2.95s/it]Best trial: 24. Best value: 0.197892:  77%|███████▋  | 77/100 [03:46<01:07,  2.95s/it]Best trial: 24. Best value: 0.197892:  78%|███████▊  | 78/100 [03:46<01:01,  2.81s/it]Best trial: 24. Best value: 0.197892:  78%|███████▊  | 78/100 [03:49<01:01,  2.81s/it]Best trial: 24. Best value: 0.197892:  79%|███████▉  | 79/100 [03:49<00:57,  2.75s/it]Best trial: 24. Best value: 0.197892:  79%|███████▉  | 79/100 [03:52<00:57,  2.75s/it]Best trial: 24. Best value: 0.197892:  80%|████████  | 80/100 [03:52<00:57,  2.88s/it]Best trial: 24. Best value: 0.197892:  80%|████████  | 80/100 [03:55<00:57,  2.88s/it]Best trial: 24. Best value: 0.197892:  81%|████████  | 81/100 [03:55<00:55,  2.91s/it]Best trial: 24. Best value: 0.197892:  81%|████████  | 81/100 [03:58<00:55,  2.91s/it]Best trial: 24. Best value: 0.197892:  82%|████████▏ | 82/100 [03:58<00:51,  2.86s/it]Best trial: 24. Best value: 0.197892:  82%|████████▏ | 82/100 [04:01<00:51,  2.86s/it]Best trial: 24. Best value: 0.197892:  83%|████████▎ | 83/100 [04:01<00:50,  2.96s/it]Best trial: 24. Best value: 0.197892:  83%|████████▎ | 83/100 [04:04<00:50,  2.96s/it]Best trial: 24. Best value: 0.197892:  84%|████████▍ | 84/100 [04:04<00:45,  2.87s/it]Best trial: 24. Best value: 0.197892:  84%|████████▍ | 84/100 [04:06<00:45,  2.87s/it]Best trial: 24. Best value: 0.197892:  85%|████████▌ | 85/100 [04:06<00:42,  2.81s/it]Best trial: 24. Best value: 0.197892:  85%|████████▌ | 85/100 [04:10<00:42,  2.81s/it]Best trial: 24. Best value: 0.197892:  86%|████████▌ | 86/100 [04:10<00:41,  2.97s/it]Best trial: 24. Best value: 0.197892:  86%|████████▌ | 86/100 [04:12<00:41,  2.97s/it]Best trial: 24. Best value: 0.197892:  87%|████████▋ | 87/100 [04:12<00:38,  2.96s/it]Best trial: 24. Best value: 0.197892:  87%|████████▋ | 87/100 [04:15<00:38,  2.96s/it]Best trial: 24. Best value: 0.197892:  88%|████████▊ | 88/100 [04:15<00:35,  2.95s/it]Best trial: 24. Best value: 0.197892:  88%|████████▊ | 88/100 [04:18<00:35,  2.95s/it]Best trial: 24. Best value: 0.197892:  89%|████████▉ | 89/100 [04:18<00:30,  2.77s/it]Best trial: 24. Best value: 0.197892:  89%|████████▉ | 89/100 [04:21<00:30,  2.77s/it]Best trial: 24. Best value: 0.197892:  90%|█████████ | 90/100 [04:21<00:29,  2.98s/it]Best trial: 24. Best value: 0.197892:  90%|█████████ | 90/100 [04:24<00:29,  2.98s/it]Best trial: 24. Best value: 0.197892:  91%|█████████ | 91/100 [04:24<00:25,  2.87s/it]Best trial: 24. Best value: 0.197892:  91%|█████████ | 91/100 [04:27<00:25,  2.87s/it]Best trial: 24. Best value: 0.197892:  92%|█████████▏| 92/100 [04:27<00:22,  2.82s/it]Best trial: 24. Best value: 0.197892:  92%|█████████▏| 92/100 [04:29<00:22,  2.82s/it]Best trial: 24. Best value: 0.197892:  93%|█████████▎| 93/100 [04:29<00:19,  2.77s/it]Best trial: 24. Best value: 0.197892:  93%|█████████▎| 93/100 [04:32<00:19,  2.77s/it]Best trial: 24. Best value: 0.197892:  94%|█████████▍| 94/100 [04:32<00:16,  2.69s/it]Best trial: 24. Best value: 0.197892:  94%|█████████▍| 94/100 [04:35<00:16,  2.69s/it]Best trial: 24. Best value: 0.197892:  95%|█████████▌| 95/100 [04:35<00:13,  2.79s/it]Best trial: 24. Best value: 0.197892:  95%|█████████▌| 95/100 [04:38<00:13,  2.79s/it]Best trial: 24. Best value: 0.197892:  96%|█████████▌| 96/100 [04:38<00:11,  2.87s/it]Best trial: 24. Best value: 0.197892:  96%|█████████▌| 96/100 [04:41<00:11,  2.87s/it]Best trial: 24. Best value: 0.197892:  97%|█████████▋| 97/100 [04:41<00:09,  3.05s/it]Best trial: 24. Best value: 0.197892:  97%|█████████▋| 97/100 [04:44<00:09,  3.05s/it]Best trial: 24. Best value: 0.197892:  98%|█████████▊| 98/100 [04:44<00:05,  2.93s/it]Best trial: 24. Best value: 0.197892:  98%|█████████▊| 98/100 [04:47<00:05,  2.93s/it]Best trial: 24. Best value: 0.197892:  99%|█████████▉| 99/100 [04:47<00:02,  2.96s/it]Best trial: 24. Best value: 0.197892:  99%|█████████▉| 99/100 [04:50<00:02,  2.96s/it]Best trial: 24. Best value: 0.197892: 100%|██████████| 100/100 [04:50<00:00,  3.10s/it]Best trial: 24. Best value: 0.197892: 100%|██████████| 100/100 [04:50<00:00,  2.91s/it]
2025-11-30 14:53:58,322 - INFO - HPO Complete. Best AUPRC: 0.1979
2025-11-30 14:53:58,322 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.019252930965542273, 'max_depth': 9, 'subsample': 0.7136900987403343, 'colsample_bytree': 0.7180959561643252, 'gamma': 4.447565810903299, 'reg_lambda': 0.011787247872023657, 'reg_alpha': 7.532884859226907e-05}
2025-11-30 14:53:58,323 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:54:00,160 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 14:54:00,160 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:54:00,245 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:54:00,281 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:54:00,293 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 14:54:00,293 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:54:00,293 - INFO - Training model...
2025-11-30 14:54:02,831 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:54:08,409 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:54:08,409 - INFO - AUROC: 0.3980 (0.0577 - 0.6495)
2025-11-30 14:54:08,409 - INFO - AUPRC: 0.0173 (0.0036 - 0.0926)
2025-11-30 14:54:08,409 - INFO - Brier Score: 0.0090 (0.0043 - 0.0153)
2025-11-30 14:54:08,409 - INFO - Accuracy: 0.9682 (0.6676 - 0.9751)
2025-11-30 14:54:08,409 - INFO - Precision: 0.0556 (0.0000 - 0.1567)
2025-11-30 14:54:08,409 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.6267)
2025-11-30 14:54:08,409 - INFO - F1-Score: 0.0833 (0.0000 - 0.2440)
2025-11-30 14:54:08,409 - INFO - Best Threshold: 0.0700 (0.0100 - 0.0700)
2025-11-30 14:54:08,409 - INFO - Specificity: 0.9752 (0.6679 - 0.9822)
2025-11-30 14:54:08,418 - INFO - Calculating SHAP values...
2025-11-30 14:54:09,463 - INFO - SHAP plots saved.
2025-11-30 14:54:09,463 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:54:10,652 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 14:54:10,653 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:54:10,738 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:54:10,750 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:54:10,752 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 14:54:10,752 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.020254:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.020254:   1%|          | 1/100 [00:01<02:48,  1.70s/it]Best trial: 1. Best value: 0.0403202:   1%|          | 1/100 [00:03<02:48,  1.70s/it]Best trial: 1. Best value: 0.0403202:   2%|▏         | 2/100 [00:03<02:31,  1.55s/it]Best trial: 2. Best value: 0.0704992:   2%|▏         | 2/100 [00:04<02:31,  1.55s/it]Best trial: 2. Best value: 0.0704992:   3%|▎         | 3/100 [00:04<02:14,  1.38s/it]Best trial: 2. Best value: 0.0704992:   3%|▎         | 3/100 [00:06<02:14,  1.38s/it]Best trial: 2. Best value: 0.0704992:   4%|▍         | 4/100 [00:06<02:51,  1.79s/it]Best trial: 2. Best value: 0.0704992:   4%|▍         | 4/100 [00:08<02:51,  1.79s/it]Best trial: 2. Best value: 0.0704992:   5%|▌         | 5/100 [00:08<02:45,  1.74s/it]Best trial: 2. Best value: 0.0704992:   5%|▌         | 5/100 [00:09<02:45,  1.74s/it]Best trial: 2. Best value: 0.0704992:   6%|▌         | 6/100 [00:09<02:33,  1.63s/it]Best trial: 2. Best value: 0.0704992:   6%|▌         | 6/100 [00:11<02:33,  1.63s/it]Best trial: 2. Best value: 0.0704992:   7%|▋         | 7/100 [00:11<02:22,  1.53s/it]Best trial: 2. Best value: 0.0704992:   7%|▋         | 7/100 [00:12<02:22,  1.53s/it]Best trial: 2. Best value: 0.0704992:   8%|▊         | 8/100 [00:12<02:15,  1.47s/it]Best trial: 2. Best value: 0.0704992:   8%|▊         | 8/100 [00:14<02:15,  1.47s/it]Best trial: 2. Best value: 0.0704992:   9%|▉         | 9/100 [00:14<02:27,  1.62s/it]Best trial: 2. Best value: 0.0704992:   9%|▉         | 9/100 [00:15<02:27,  1.62s/it]Best trial: 2. Best value: 0.0704992:  10%|█         | 10/100 [00:15<02:19,  1.55s/it]Best trial: 2. Best value: 0.0704992:  10%|█         | 10/100 [00:16<02:19,  1.55s/it]Best trial: 2. Best value: 0.0704992:  11%|█         | 11/100 [00:16<02:05,  1.42s/it]Best trial: 2. Best value: 0.0704992:  11%|█         | 11/100 [00:18<02:05,  1.42s/it]Best trial: 2. Best value: 0.0704992:  12%|█▏        | 12/100 [00:18<02:04,  1.41s/it]Best trial: 2. Best value: 0.0704992:  12%|█▏        | 12/100 [00:19<02:04,  1.41s/it]Best trial: 2. Best value: 0.0704992:  13%|█▎        | 13/100 [00:19<01:53,  1.30s/it]Best trial: 2. Best value: 0.0704992:  13%|█▎        | 13/100 [00:20<01:53,  1.30s/it]Best trial: 2. Best value: 0.0704992:  14%|█▍        | 14/100 [00:20<01:53,  1.31s/it]Best trial: 2. Best value: 0.0704992:  14%|█▍        | 14/100 [00:22<01:53,  1.31s/it]Best trial: 2. Best value: 0.0704992:  15%|█▌        | 15/100 [00:22<01:57,  1.38s/it]Best trial: 2. Best value: 0.0704992:  15%|█▌        | 15/100 [00:23<01:57,  1.38s/it]Best trial: 2. Best value: 0.0704992:  16%|█▌        | 16/100 [00:23<01:50,  1.31s/it]Best trial: 2. Best value: 0.0704992:  16%|█▌        | 16/100 [00:24<01:50,  1.31s/it]Best trial: 2. Best value: 0.0704992:  17%|█▋        | 17/100 [00:24<01:52,  1.35s/it]Best trial: 2. Best value: 0.0704992:  17%|█▋        | 17/100 [00:25<01:52,  1.35s/it]Best trial: 2. Best value: 0.0704992:  18%|█▊        | 18/100 [00:25<01:45,  1.28s/it]Best trial: 2. Best value: 0.0704992:  18%|█▊        | 18/100 [00:27<01:45,  1.28s/it]Best trial: 2. Best value: 0.0704992:  19%|█▉        | 19/100 [00:27<01:45,  1.31s/it]Best trial: 2. Best value: 0.0704992:  19%|█▉        | 19/100 [00:28<01:45,  1.31s/it]Best trial: 2. Best value: 0.0704992:  20%|██        | 20/100 [00:28<01:49,  1.37s/it]Best trial: 2. Best value: 0.0704992:  20%|██        | 20/100 [00:30<01:49,  1.37s/it]Best trial: 2. Best value: 0.0704992:  21%|██        | 21/100 [00:30<01:43,  1.32s/it]Best trial: 2. Best value: 0.0704992:  21%|██        | 21/100 [00:31<01:43,  1.32s/it]Best trial: 2. Best value: 0.0704992:  22%|██▏       | 22/100 [00:31<01:45,  1.35s/it]Best trial: 2. Best value: 0.0704992:  22%|██▏       | 22/100 [00:32<01:45,  1.35s/it]Best trial: 2. Best value: 0.0704992:  23%|██▎       | 23/100 [00:32<01:42,  1.33s/it]Best trial: 2. Best value: 0.0704992:  23%|██▎       | 23/100 [00:33<01:42,  1.33s/it]Best trial: 2. Best value: 0.0704992:  24%|██▍       | 24/100 [00:33<01:36,  1.27s/it]Best trial: 2. Best value: 0.0704992:  24%|██▍       | 24/100 [00:35<01:36,  1.27s/it]Best trial: 2. Best value: 0.0704992:  25%|██▌       | 25/100 [00:35<01:37,  1.30s/it]Best trial: 25. Best value: 0.0732481:  25%|██▌       | 25/100 [00:36<01:37,  1.30s/it]Best trial: 25. Best value: 0.0732481:  26%|██▌       | 26/100 [00:36<01:45,  1.43s/it]Best trial: 25. Best value: 0.0732481:  26%|██▌       | 26/100 [00:38<01:45,  1.43s/it]Best trial: 25. Best value: 0.0732481:  27%|██▋       | 27/100 [00:38<01:44,  1.43s/it]Best trial: 25. Best value: 0.0732481:  27%|██▋       | 27/100 [00:39<01:44,  1.43s/it]Best trial: 25. Best value: 0.0732481:  28%|██▊       | 28/100 [00:39<01:43,  1.44s/it]Best trial: 25. Best value: 0.0732481:  28%|██▊       | 28/100 [00:41<01:43,  1.44s/it]Best trial: 25. Best value: 0.0732481:  29%|██▉       | 29/100 [00:41<01:42,  1.44s/it]Best trial: 25. Best value: 0.0732481:  29%|██▉       | 29/100 [00:43<01:42,  1.44s/it]Best trial: 25. Best value: 0.0732481:  30%|███       | 30/100 [00:43<01:45,  1.51s/it]Best trial: 25. Best value: 0.0732481:  30%|███       | 30/100 [00:44<01:45,  1.51s/it]Best trial: 25. Best value: 0.0732481:  31%|███       | 31/100 [00:44<01:37,  1.41s/it]Best trial: 25. Best value: 0.0732481:  31%|███       | 31/100 [00:45<01:37,  1.41s/it]Best trial: 25. Best value: 0.0732481:  32%|███▏      | 32/100 [00:45<01:30,  1.33s/it]Best trial: 32. Best value: 0.0811337:  32%|███▏      | 32/100 [00:46<01:30,  1.33s/it]Best trial: 32. Best value: 0.0811337:  33%|███▎      | 33/100 [00:46<01:27,  1.30s/it]Best trial: 32. Best value: 0.0811337:  33%|███▎      | 33/100 [00:47<01:27,  1.30s/it]Best trial: 32. Best value: 0.0811337:  34%|███▍      | 34/100 [00:47<01:21,  1.24s/it]Best trial: 32. Best value: 0.0811337:  34%|███▍      | 34/100 [00:48<01:21,  1.24s/it]Best trial: 32. Best value: 0.0811337:  35%|███▌      | 35/100 [00:48<01:20,  1.24s/it]Best trial: 32. Best value: 0.0811337:  35%|███▌      | 35/100 [00:50<01:20,  1.24s/it]Best trial: 32. Best value: 0.0811337:  36%|███▌      | 36/100 [00:50<01:18,  1.23s/it]Best trial: 32. Best value: 0.0811337:  36%|███▌      | 36/100 [00:51<01:18,  1.23s/it]Best trial: 32. Best value: 0.0811337:  37%|███▋      | 37/100 [00:51<01:22,  1.30s/it]Best trial: 32. Best value: 0.0811337:  37%|███▋      | 37/100 [00:53<01:22,  1.30s/it]Best trial: 32. Best value: 0.0811337:  38%|███▊      | 38/100 [00:53<01:31,  1.48s/it]Best trial: 32. Best value: 0.0811337:  38%|███▊      | 38/100 [00:55<01:31,  1.48s/it]Best trial: 32. Best value: 0.0811337:  39%|███▉      | 39/100 [00:55<01:32,  1.51s/it]Best trial: 32. Best value: 0.0811337:  39%|███▉      | 39/100 [00:56<01:32,  1.51s/it]Best trial: 32. Best value: 0.0811337:  40%|████      | 40/100 [00:56<01:32,  1.54s/it]Best trial: 32. Best value: 0.0811337:  40%|████      | 40/100 [00:58<01:32,  1.54s/it]Best trial: 32. Best value: 0.0811337:  41%|████      | 41/100 [00:58<01:27,  1.48s/it]Best trial: 32. Best value: 0.0811337:  41%|████      | 41/100 [00:59<01:27,  1.48s/it]Best trial: 32. Best value: 0.0811337:  42%|████▏     | 42/100 [00:59<01:25,  1.48s/it]Best trial: 32. Best value: 0.0811337:  42%|████▏     | 42/100 [01:00<01:25,  1.48s/it]Best trial: 32. Best value: 0.0811337:  43%|████▎     | 43/100 [01:00<01:17,  1.37s/it]Best trial: 32. Best value: 0.0811337:  43%|████▎     | 43/100 [01:01<01:17,  1.37s/it]Best trial: 32. Best value: 0.0811337:  44%|████▍     | 44/100 [01:01<01:15,  1.35s/it]Best trial: 32. Best value: 0.0811337:  44%|████▍     | 44/100 [01:03<01:15,  1.35s/it]Best trial: 32. Best value: 0.0811337:  45%|████▌     | 45/100 [01:03<01:13,  1.34s/it]Best trial: 32. Best value: 0.0811337:  45%|████▌     | 45/100 [01:04<01:13,  1.34s/it]Best trial: 32. Best value: 0.0811337:  46%|████▌     | 46/100 [01:04<01:12,  1.34s/it]Best trial: 32. Best value: 0.0811337:  46%|████▌     | 46/100 [01:05<01:12,  1.34s/it]Best trial: 32. Best value: 0.0811337:  47%|████▋     | 47/100 [01:05<01:08,  1.30s/it]Best trial: 32. Best value: 0.0811337:  47%|████▋     | 47/100 [01:07<01:08,  1.30s/it]Best trial: 32. Best value: 0.0811337:  48%|████▊     | 48/100 [01:07<01:10,  1.35s/it]Best trial: 32. Best value: 0.0811337:  48%|████▊     | 48/100 [01:08<01:10,  1.35s/it]Best trial: 32. Best value: 0.0811337:  49%|████▉     | 49/100 [01:08<01:08,  1.34s/it]Best trial: 32. Best value: 0.0811337:  49%|████▉     | 49/100 [01:09<01:08,  1.34s/it]Best trial: 32. Best value: 0.0811337:  50%|█████     | 50/100 [01:09<01:07,  1.36s/it]Best trial: 32. Best value: 0.0811337:  50%|█████     | 50/100 [01:11<01:07,  1.36s/it]Best trial: 32. Best value: 0.0811337:  51%|█████     | 51/100 [01:11<01:13,  1.51s/it]Best trial: 32. Best value: 0.0811337:  51%|█████     | 51/100 [01:13<01:13,  1.51s/it]Best trial: 32. Best value: 0.0811337:  52%|█████▏    | 52/100 [01:13<01:09,  1.44s/it]Best trial: 32. Best value: 0.0811337:  52%|█████▏    | 52/100 [01:14<01:09,  1.44s/it]Best trial: 32. Best value: 0.0811337:  53%|█████▎    | 53/100 [01:14<01:03,  1.35s/it]Best trial: 32. Best value: 0.0811337:  53%|█████▎    | 53/100 [01:15<01:03,  1.35s/it]Best trial: 32. Best value: 0.0811337:  54%|█████▍    | 54/100 [01:15<01:07,  1.47s/it]Best trial: 32. Best value: 0.0811337:  54%|█████▍    | 54/100 [01:17<01:07,  1.47s/it]Best trial: 32. Best value: 0.0811337:  55%|█████▌    | 55/100 [01:17<01:04,  1.43s/it]Best trial: 55. Best value: 0.0826975:  55%|█████▌    | 55/100 [01:18<01:04,  1.43s/it]Best trial: 55. Best value: 0.0826975:  56%|█████▌    | 56/100 [01:18<01:02,  1.42s/it]Best trial: 55. Best value: 0.0826975:  56%|█████▌    | 56/100 [01:20<01:02,  1.42s/it]Best trial: 55. Best value: 0.0826975:  57%|█████▋    | 57/100 [01:20<01:03,  1.47s/it]Best trial: 55. Best value: 0.0826975:  57%|█████▋    | 57/100 [01:21<01:03,  1.47s/it]Best trial: 55. Best value: 0.0826975:  58%|█████▊    | 58/100 [01:21<00:59,  1.42s/it]Best trial: 55. Best value: 0.0826975:  58%|█████▊    | 58/100 [01:22<00:59,  1.42s/it]Best trial: 55. Best value: 0.0826975:  59%|█████▉    | 59/100 [01:22<00:57,  1.41s/it]Best trial: 55. Best value: 0.0826975:  59%|█████▉    | 59/100 [01:24<00:57,  1.41s/it]Best trial: 55. Best value: 0.0826975:  60%|██████    | 60/100 [01:24<01:00,  1.51s/it]Best trial: 55. Best value: 0.0826975:  60%|██████    | 60/100 [01:26<01:00,  1.51s/it]Best trial: 55. Best value: 0.0826975:  61%|██████    | 61/100 [01:26<01:00,  1.55s/it]Best trial: 55. Best value: 0.0826975:  61%|██████    | 61/100 [01:27<01:00,  1.55s/it]Best trial: 55. Best value: 0.0826975:  62%|██████▏   | 62/100 [01:27<00:58,  1.55s/it]Best trial: 55. Best value: 0.0826975:  62%|██████▏   | 62/100 [01:29<00:58,  1.55s/it]Best trial: 55. Best value: 0.0826975:  63%|██████▎   | 63/100 [01:29<00:53,  1.46s/it]Best trial: 55. Best value: 0.0826975:  63%|██████▎   | 63/100 [01:30<00:53,  1.46s/it]Best trial: 55. Best value: 0.0826975:  64%|██████▍   | 64/100 [01:30<00:51,  1.42s/it]Best trial: 55. Best value: 0.0826975:  64%|██████▍   | 64/100 [01:32<00:51,  1.42s/it]Best trial: 55. Best value: 0.0826975:  65%|██████▌   | 65/100 [01:32<00:51,  1.48s/it]Best trial: 55. Best value: 0.0826975:  65%|██████▌   | 65/100 [01:33<00:51,  1.48s/it]Best trial: 55. Best value: 0.0826975:  66%|██████▌   | 66/100 [01:33<00:47,  1.39s/it]Best trial: 55. Best value: 0.0826975:  66%|██████▌   | 66/100 [01:34<00:47,  1.39s/it]Best trial: 55. Best value: 0.0826975:  67%|██████▋   | 67/100 [01:34<00:42,  1.28s/it]Best trial: 55. Best value: 0.0826975:  67%|██████▋   | 67/100 [01:35<00:42,  1.28s/it]Best trial: 55. Best value: 0.0826975:  68%|██████▊   | 68/100 [01:35<00:39,  1.23s/it]Best trial: 55. Best value: 0.0826975:  68%|██████▊   | 68/100 [01:36<00:39,  1.23s/it]Best trial: 55. Best value: 0.0826975:  69%|██████▉   | 69/100 [01:36<00:36,  1.19s/it]Best trial: 55. Best value: 0.0826975:  69%|██████▉   | 69/100 [01:37<00:36,  1.19s/it]Best trial: 55. Best value: 0.0826975:  70%|███████   | 70/100 [01:37<00:34,  1.16s/it]Best trial: 55. Best value: 0.0826975:  70%|███████   | 70/100 [01:39<00:34,  1.16s/it]Best trial: 55. Best value: 0.0826975:  71%|███████   | 71/100 [01:39<00:40,  1.41s/it]Best trial: 55. Best value: 0.0826975:  71%|███████   | 71/100 [01:41<00:40,  1.41s/it]Best trial: 55. Best value: 0.0826975:  72%|███████▏  | 72/100 [01:41<00:40,  1.43s/it]Best trial: 55. Best value: 0.0826975:  72%|███████▏  | 72/100 [01:42<00:40,  1.43s/it]Best trial: 55. Best value: 0.0826975:  73%|███████▎  | 73/100 [01:42<00:36,  1.36s/it]Best trial: 55. Best value: 0.0826975:  73%|███████▎  | 73/100 [01:43<00:36,  1.36s/it]Best trial: 55. Best value: 0.0826975:  74%|███████▍  | 74/100 [01:43<00:35,  1.36s/it]Best trial: 74. Best value: 0.0920524:  74%|███████▍  | 74/100 [01:44<00:35,  1.36s/it]Best trial: 74. Best value: 0.0920524:  75%|███████▌  | 75/100 [01:44<00:33,  1.32s/it]Best trial: 74. Best value: 0.0920524:  75%|███████▌  | 75/100 [01:45<00:33,  1.32s/it]Best trial: 74. Best value: 0.0920524:  76%|███████▌  | 76/100 [01:45<00:30,  1.25s/it]Best trial: 74. Best value: 0.0920524:  76%|███████▌  | 76/100 [01:47<00:30,  1.25s/it]Best trial: 74. Best value: 0.0920524:  77%|███████▋  | 77/100 [01:47<00:30,  1.31s/it]Best trial: 74. Best value: 0.0920524:  77%|███████▋  | 77/100 [01:48<00:30,  1.31s/it]Best trial: 74. Best value: 0.0920524:  78%|███████▊  | 78/100 [01:48<00:29,  1.34s/it]Best trial: 74. Best value: 0.0920524:  78%|███████▊  | 78/100 [01:50<00:29,  1.34s/it]Best trial: 74. Best value: 0.0920524:  79%|███████▉  | 79/100 [01:50<00:29,  1.40s/it]Best trial: 74. Best value: 0.0920524:  79%|███████▉  | 79/100 [01:51<00:29,  1.40s/it]Best trial: 74. Best value: 0.0920524:  80%|████████  | 80/100 [01:51<00:26,  1.33s/it]Best trial: 74. Best value: 0.0920524:  80%|████████  | 80/100 [01:52<00:26,  1.33s/it]Best trial: 74. Best value: 0.0920524:  81%|████████  | 81/100 [01:52<00:25,  1.36s/it]Best trial: 74. Best value: 0.0920524:  81%|████████  | 81/100 [01:54<00:25,  1.36s/it]Best trial: 74. Best value: 0.0920524:  82%|████████▏ | 82/100 [01:54<00:26,  1.48s/it]Best trial: 74. Best value: 0.0920524:  82%|████████▏ | 82/100 [01:56<00:26,  1.48s/it]Best trial: 74. Best value: 0.0920524:  83%|████████▎ | 83/100 [01:56<00:25,  1.49s/it]Best trial: 74. Best value: 0.0920524:  83%|████████▎ | 83/100 [01:57<00:25,  1.49s/it]Best trial: 74. Best value: 0.0920524:  84%|████████▍ | 84/100 [01:57<00:23,  1.50s/it]Best trial: 74. Best value: 0.0920524:  84%|████████▍ | 84/100 [01:59<00:23,  1.50s/it]Best trial: 74. Best value: 0.0920524:  85%|████████▌ | 85/100 [01:59<00:21,  1.44s/it]Best trial: 74. Best value: 0.0920524:  85%|████████▌ | 85/100 [02:00<00:21,  1.44s/it]Best trial: 74. Best value: 0.0920524:  86%|████████▌ | 86/100 [02:00<00:19,  1.43s/it]Best trial: 74. Best value: 0.0920524:  86%|████████▌ | 86/100 [02:01<00:19,  1.43s/it]Best trial: 74. Best value: 0.0920524:  87%|████████▋ | 87/100 [02:01<00:17,  1.35s/it]Best trial: 74. Best value: 0.0920524:  87%|████████▋ | 87/100 [02:02<00:17,  1.35s/it]Best trial: 74. Best value: 0.0920524:  88%|████████▊ | 88/100 [02:02<00:15,  1.28s/it]Best trial: 88. Best value: 0.0979352:  88%|████████▊ | 88/100 [02:04<00:15,  1.28s/it]Best trial: 88. Best value: 0.0979352:  89%|████████▉ | 89/100 [02:04<00:14,  1.31s/it]Best trial: 88. Best value: 0.0979352:  89%|████████▉ | 89/100 [02:05<00:14,  1.31s/it]Best trial: 88. Best value: 0.0979352:  90%|█████████ | 90/100 [02:05<00:13,  1.40s/it]Best trial: 88. Best value: 0.0979352:  90%|█████████ | 90/100 [02:07<00:13,  1.40s/it]Best trial: 88. Best value: 0.0979352:  91%|█████████ | 91/100 [02:07<00:12,  1.44s/it]Best trial: 88. Best value: 0.0979352:  91%|█████████ | 91/100 [02:09<00:12,  1.44s/it]Best trial: 88. Best value: 0.0979352:  92%|█████████▏| 92/100 [02:09<00:12,  1.53s/it]Best trial: 88. Best value: 0.0979352:  92%|█████████▏| 92/100 [02:10<00:12,  1.53s/it]Best trial: 88. Best value: 0.0979352:  93%|█████████▎| 93/100 [02:10<00:10,  1.43s/it]Best trial: 88. Best value: 0.0979352:  93%|█████████▎| 93/100 [02:11<00:10,  1.43s/it]Best trial: 88. Best value: 0.0979352:  94%|█████████▍| 94/100 [02:11<00:08,  1.35s/it]Best trial: 88. Best value: 0.0979352:  94%|█████████▍| 94/100 [02:12<00:08,  1.35s/it]Best trial: 88. Best value: 0.0979352:  95%|█████████▌| 95/100 [02:12<00:06,  1.35s/it]Best trial: 88. Best value: 0.0979352:  95%|█████████▌| 95/100 [02:14<00:06,  1.35s/it]Best trial: 88. Best value: 0.0979352:  96%|█████████▌| 96/100 [02:14<00:05,  1.48s/it]Best trial: 88. Best value: 0.0979352:  96%|█████████▌| 96/100 [02:16<00:05,  1.48s/it]Best trial: 88. Best value: 0.0979352:  97%|█████████▋| 97/100 [02:16<00:04,  1.56s/it]Best trial: 88. Best value: 0.0979352:  97%|█████████▋| 97/100 [02:18<00:04,  1.56s/it]Best trial: 88. Best value: 0.0979352:  98%|█████████▊| 98/100 [02:18<00:03,  1.71s/it]Best trial: 88. Best value: 0.0979352:  98%|█████████▊| 98/100 [02:20<00:03,  1.71s/it]Best trial: 88. Best value: 0.0979352:  99%|█████████▉| 99/100 [02:20<00:01,  1.74s/it]Best trial: 88. Best value: 0.0979352:  99%|█████████▉| 99/100 [02:22<00:01,  1.74s/it]Best trial: 88. Best value: 0.0979352: 100%|██████████| 100/100 [02:22<00:00,  1.84s/it]Best trial: 88. Best value: 0.0979352: 100%|██████████| 100/100 [02:22<00:00,  1.42s/it]
2025-11-30 14:56:32,937 - INFO - HPO Complete. Best AUPRC: 0.0979
2025-11-30 14:56:32,938 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.0008706681875779768, 'max_depth': 6, 'subsample': 0.6505550232259772, 'colsample_bytree': 0.6264643976857772, 'gamma': 0.5907040164028613, 'reg_lambda': 0.00020461089450992092, 'reg_alpha': 4.019714271336862e-05}
2025-11-30 14:56:32,939 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 14:56:34,861 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 14:56:34,861 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:56:34,944 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:56:34,956 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:56:34,958 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 14:56:34,958 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 14:56:34,958 - INFO - Training model...
2025-11-30 14:56:37,261 - INFO - Evaluating model with bootstrapping...
2025-11-30 14:56:42,086 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 14:56:42,086 - INFO - AUROC: 0.4672 (0.1329 - 0.6713)
2025-11-30 14:56:42,086 - INFO - AUPRC: 0.0128 (0.0039 - 0.0400)
2025-11-30 14:56:42,086 - INFO - Brier Score: 0.1049 (0.1024 - 0.1079)
2025-11-30 14:56:42,086 - INFO - Accuracy: 0.9147 (0.0223 - 0.9257)
2025-11-30 14:56:42,086 - INFO - Precision: 0.0182 (0.0044 - 0.0564)
2025-11-30 14:56:42,086 - INFO - Sensitivity (Recall): 0.1667 (0.1429 - 1.0000)
2025-11-30 14:56:42,086 - INFO - F1-Score: 0.0328 (0.0088 - 0.0965)
2025-11-30 14:56:42,086 - INFO - Best Threshold: 0.3800 (0.2700 - 0.3800)
2025-11-30 14:56:42,086 - INFO - Specificity: 0.9213 (0.0134 - 0.9320)
2025-11-30 14:56:42,104 - INFO - Calculating SHAP values...
2025-11-30 14:56:43,243 - INFO - SHAP plots saved.
2025-11-30 14:56:43,244 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 14:56:44,453 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 14:56:44,454 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 14:56:44,539 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 14:56:44,551 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 14:56:44,554 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 14:56:44,554 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0692881:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0692881:   1%|          | 1/100 [00:01<02:31,  1.53s/it]Best trial: 0. Best value: 0.0692881:   1%|          | 1/100 [00:03<02:31,  1.53s/it]Best trial: 0. Best value: 0.0692881:   2%|▏         | 2/100 [00:03<02:41,  1.64s/it]Best trial: 0. Best value: 0.0692881:   2%|▏         | 2/100 [00:05<02:41,  1.64s/it]Best trial: 0. Best value: 0.0692881:   3%|▎         | 3/100 [00:05<03:01,  1.87s/it]Best trial: 0. Best value: 0.0692881:   3%|▎         | 3/100 [00:06<03:01,  1.87s/it]Best trial: 0. Best value: 0.0692881:   4%|▍         | 4/100 [00:06<02:47,  1.75s/it]Best trial: 0. Best value: 0.0692881:   4%|▍         | 4/100 [00:08<02:47,  1.75s/it]Best trial: 0. Best value: 0.0692881:   5%|▌         | 5/100 [00:08<02:31,  1.60s/it]Best trial: 0. Best value: 0.0692881:   5%|▌         | 5/100 [00:10<02:31,  1.60s/it]Best trial: 0. Best value: 0.0692881:   6%|▌         | 6/100 [00:10<02:52,  1.84s/it]Best trial: 6. Best value: 0.103354:   6%|▌         | 6/100 [00:12<02:52,  1.84s/it] Best trial: 6. Best value: 0.103354:   7%|▋         | 7/100 [00:12<02:39,  1.71s/it]Best trial: 6. Best value: 0.103354:   7%|▋         | 7/100 [00:14<02:39,  1.71s/it]Best trial: 6. Best value: 0.103354:   8%|▊         | 8/100 [00:14<02:51,  1.86s/it]Best trial: 6. Best value: 0.103354:   8%|▊         | 8/100 [00:16<02:51,  1.86s/it]Best trial: 6. Best value: 0.103354:   9%|▉         | 9/100 [00:16<03:09,  2.08s/it]Best trial: 6. Best value: 0.103354:   9%|▉         | 9/100 [00:19<03:09,  2.08s/it]Best trial: 6. Best value: 0.103354:  10%|█         | 10/100 [00:19<03:26,  2.30s/it]Best trial: 6. Best value: 0.103354:  10%|█         | 10/100 [00:21<03:26,  2.30s/it]Best trial: 6. Best value: 0.103354:  11%|█         | 11/100 [00:21<03:26,  2.32s/it]Best trial: 6. Best value: 0.103354:  11%|█         | 11/100 [00:24<03:26,  2.32s/it]Best trial: 6. Best value: 0.103354:  12%|█▏        | 12/100 [00:24<03:17,  2.25s/it]Best trial: 6. Best value: 0.103354:  12%|█▏        | 12/100 [00:26<03:17,  2.25s/it]Best trial: 6. Best value: 0.103354:  13%|█▎        | 13/100 [00:26<03:23,  2.34s/it]Best trial: 6. Best value: 0.103354:  13%|█▎        | 13/100 [00:29<03:23,  2.34s/it]Best trial: 6. Best value: 0.103354:  14%|█▍        | 14/100 [00:29<03:28,  2.42s/it]Best trial: 6. Best value: 0.103354:  14%|█▍        | 14/100 [00:32<03:28,  2.42s/it]Best trial: 6. Best value: 0.103354:  15%|█▌        | 15/100 [00:32<03:39,  2.58s/it]Best trial: 6. Best value: 0.103354:  15%|█▌        | 15/100 [00:35<03:39,  2.58s/it]Best trial: 6. Best value: 0.103354:  16%|█▌        | 16/100 [00:35<03:57,  2.83s/it]Best trial: 6. Best value: 0.103354:  16%|█▌        | 16/100 [00:38<03:57,  2.83s/it]Best trial: 6. Best value: 0.103354:  17%|█▋        | 17/100 [00:38<03:53,  2.82s/it]Best trial: 6. Best value: 0.103354:  17%|█▋        | 17/100 [00:40<03:53,  2.82s/it]Best trial: 6. Best value: 0.103354:  18%|█▊        | 18/100 [00:40<03:46,  2.77s/it]Best trial: 6. Best value: 0.103354:  18%|█▊        | 18/100 [00:43<03:46,  2.77s/it]Best trial: 6. Best value: 0.103354:  19%|█▉        | 19/100 [00:43<03:30,  2.60s/it]Best trial: 6. Best value: 0.103354:  19%|█▉        | 19/100 [00:46<03:30,  2.60s/it]Best trial: 6. Best value: 0.103354:  20%|██        | 20/100 [00:46<03:40,  2.76s/it]Best trial: 6. Best value: 0.103354:  20%|██        | 20/100 [00:48<03:40,  2.76s/it]Best trial: 6. Best value: 0.103354:  21%|██        | 21/100 [00:48<03:18,  2.51s/it]Best trial: 6. Best value: 0.103354:  21%|██        | 21/100 [00:51<03:18,  2.51s/it]Best trial: 6. Best value: 0.103354:  22%|██▏       | 22/100 [00:51<03:35,  2.76s/it]Best trial: 6. Best value: 0.103354:  22%|██▏       | 22/100 [00:54<03:35,  2.76s/it]Best trial: 6. Best value: 0.103354:  23%|██▎       | 23/100 [00:54<03:25,  2.67s/it]Best trial: 6. Best value: 0.103354:  23%|██▎       | 23/100 [00:56<03:25,  2.67s/it]Best trial: 6. Best value: 0.103354:  24%|██▍       | 24/100 [00:56<03:16,  2.59s/it]Best trial: 6. Best value: 0.103354:  24%|██▍       | 24/100 [00:58<03:16,  2.59s/it]Best trial: 6. Best value: 0.103354:  25%|██▌       | 25/100 [00:58<03:05,  2.48s/it]Best trial: 6. Best value: 0.103354:  25%|██▌       | 25/100 [01:01<03:05,  2.48s/it]Best trial: 6. Best value: 0.103354:  26%|██▌       | 26/100 [01:01<03:09,  2.56s/it]Best trial: 6. Best value: 0.103354:  26%|██▌       | 26/100 [01:03<03:09,  2.56s/it]Best trial: 6. Best value: 0.103354:  27%|██▋       | 27/100 [01:03<03:00,  2.47s/it]Best trial: 6. Best value: 0.103354:  27%|██▋       | 27/100 [01:06<03:00,  2.47s/it]Best trial: 6. Best value: 0.103354:  28%|██▊       | 28/100 [01:06<03:03,  2.55s/it]Best trial: 6. Best value: 0.103354:  28%|██▊       | 28/100 [01:09<03:03,  2.55s/it]Best trial: 6. Best value: 0.103354:  29%|██▉       | 29/100 [01:09<03:07,  2.65s/it]Best trial: 6. Best value: 0.103354:  29%|██▉       | 29/100 [01:11<03:07,  2.65s/it]Best trial: 6. Best value: 0.103354:  30%|███       | 30/100 [01:11<02:46,  2.39s/it]Best trial: 6. Best value: 0.103354:  30%|███       | 30/100 [01:13<02:46,  2.39s/it]Best trial: 6. Best value: 0.103354:  31%|███       | 31/100 [01:13<02:47,  2.43s/it]Best trial: 6. Best value: 0.103354:  31%|███       | 31/100 [01:16<02:47,  2.43s/it]Best trial: 6. Best value: 0.103354:  32%|███▏      | 32/100 [01:16<02:50,  2.51s/it]Best trial: 6. Best value: 0.103354:  32%|███▏      | 32/100 [01:18<02:50,  2.51s/it]Best trial: 6. Best value: 0.103354:  33%|███▎      | 33/100 [01:18<02:45,  2.47s/it]Best trial: 6. Best value: 0.103354:  33%|███▎      | 33/100 [01:20<02:45,  2.47s/it]Best trial: 6. Best value: 0.103354:  34%|███▍      | 34/100 [01:20<02:38,  2.40s/it]Best trial: 6. Best value: 0.103354:  34%|███▍      | 34/100 [01:22<02:38,  2.40s/it]Best trial: 6. Best value: 0.103354:  35%|███▌      | 35/100 [01:22<02:23,  2.21s/it]Best trial: 6. Best value: 0.103354:  35%|███▌      | 35/100 [01:25<02:23,  2.21s/it]Best trial: 6. Best value: 0.103354:  36%|███▌      | 36/100 [01:25<02:40,  2.50s/it]Best trial: 6. Best value: 0.103354:  36%|███▌      | 36/100 [01:28<02:40,  2.50s/it]Best trial: 6. Best value: 0.103354:  37%|███▋      | 37/100 [01:28<02:36,  2.48s/it]Best trial: 6. Best value: 0.103354:  37%|███▋      | 37/100 [01:31<02:36,  2.48s/it]Best trial: 6. Best value: 0.103354:  38%|███▊      | 38/100 [01:31<02:38,  2.56s/it]Best trial: 6. Best value: 0.103354:  38%|███▊      | 38/100 [01:33<02:38,  2.56s/it]Best trial: 6. Best value: 0.103354:  39%|███▉      | 39/100 [01:33<02:27,  2.41s/it]Best trial: 6. Best value: 0.103354:  39%|███▉      | 39/100 [01:34<02:27,  2.41s/it]Best trial: 6. Best value: 0.103354:  40%|████      | 40/100 [01:34<02:14,  2.25s/it]Best trial: 6. Best value: 0.103354:  40%|████      | 40/100 [01:37<02:14,  2.25s/it]Best trial: 6. Best value: 0.103354:  41%|████      | 41/100 [01:37<02:19,  2.37s/it]Best trial: 6. Best value: 0.103354:  41%|████      | 41/100 [01:40<02:19,  2.37s/it]Best trial: 6. Best value: 0.103354:  42%|████▏     | 42/100 [01:40<02:21,  2.45s/it]Best trial: 6. Best value: 0.103354:  42%|████▏     | 42/100 [01:42<02:21,  2.45s/it]Best trial: 6. Best value: 0.103354:  43%|████▎     | 43/100 [01:42<02:15,  2.38s/it]Best trial: 6. Best value: 0.103354:  43%|████▎     | 43/100 [01:44<02:15,  2.38s/it]Best trial: 6. Best value: 0.103354:  44%|████▍     | 44/100 [01:44<02:13,  2.39s/it]Best trial: 6. Best value: 0.103354:  44%|████▍     | 44/100 [01:47<02:13,  2.39s/it]Best trial: 6. Best value: 0.103354:  45%|████▌     | 45/100 [01:47<02:08,  2.34s/it]Best trial: 6. Best value: 0.103354:  45%|████▌     | 45/100 [01:50<02:08,  2.34s/it]Best trial: 6. Best value: 0.103354:  46%|████▌     | 46/100 [01:50<02:15,  2.51s/it]Best trial: 6. Best value: 0.103354:  46%|████▌     | 46/100 [01:52<02:15,  2.51s/it]Best trial: 6. Best value: 0.103354:  47%|████▋     | 47/100 [01:52<02:08,  2.42s/it]Best trial: 6. Best value: 0.103354:  47%|████▋     | 47/100 [01:54<02:08,  2.42s/it]Best trial: 6. Best value: 0.103354:  48%|████▊     | 48/100 [01:54<02:10,  2.52s/it]Best trial: 48. Best value: 0.134525:  48%|████▊     | 48/100 [01:56<02:10,  2.52s/it]Best trial: 48. Best value: 0.134525:  49%|████▉     | 49/100 [01:56<01:58,  2.32s/it]Best trial: 48. Best value: 0.134525:  49%|████▉     | 49/100 [01:58<01:58,  2.32s/it]Best trial: 48. Best value: 0.134525:  50%|█████     | 50/100 [01:58<01:47,  2.15s/it]Best trial: 50. Best value: 0.134718:  50%|█████     | 50/100 [02:00<01:47,  2.15s/it]Best trial: 50. Best value: 0.134718:  51%|█████     | 51/100 [02:00<01:44,  2.13s/it]Best trial: 51. Best value: 0.135363:  51%|█████     | 51/100 [02:02<01:44,  2.13s/it]Best trial: 51. Best value: 0.135363:  52%|█████▏    | 52/100 [02:02<01:41,  2.12s/it]Best trial: 51. Best value: 0.135363:  52%|█████▏    | 52/100 [02:05<01:41,  2.12s/it]Best trial: 51. Best value: 0.135363:  53%|█████▎    | 53/100 [02:05<01:41,  2.16s/it]Best trial: 51. Best value: 0.135363:  53%|█████▎    | 53/100 [02:07<01:41,  2.16s/it]Best trial: 51. Best value: 0.135363:  54%|█████▍    | 54/100 [02:07<01:38,  2.14s/it]Best trial: 54. Best value: 0.147905:  54%|█████▍    | 54/100 [02:09<01:38,  2.14s/it]Best trial: 54. Best value: 0.147905:  55%|█████▌    | 55/100 [02:09<01:37,  2.16s/it]Best trial: 54. Best value: 0.147905:  55%|█████▌    | 55/100 [02:11<01:37,  2.16s/it]Best trial: 54. Best value: 0.147905:  56%|█████▌    | 56/100 [02:11<01:33,  2.13s/it]Best trial: 54. Best value: 0.147905:  56%|█████▌    | 56/100 [02:13<01:33,  2.13s/it]Best trial: 54. Best value: 0.147905:  57%|█████▋    | 57/100 [02:13<01:25,  1.98s/it]Best trial: 54. Best value: 0.147905:  57%|█████▋    | 57/100 [02:15<01:25,  1.98s/it]Best trial: 54. Best value: 0.147905:  58%|█████▊    | 58/100 [02:15<01:33,  2.22s/it]Best trial: 54. Best value: 0.147905:  58%|█████▊    | 58/100 [02:17<01:33,  2.22s/it]Best trial: 54. Best value: 0.147905:  59%|█████▉    | 59/100 [02:17<01:29,  2.18s/it]Best trial: 54. Best value: 0.147905:  59%|█████▉    | 59/100 [02:19<01:29,  2.18s/it]Best trial: 54. Best value: 0.147905:  60%|██████    | 60/100 [02:19<01:18,  1.96s/it]Best trial: 54. Best value: 0.147905:  60%|██████    | 60/100 [02:21<01:18,  1.96s/it]Best trial: 54. Best value: 0.147905:  61%|██████    | 61/100 [02:21<01:17,  1.99s/it]Best trial: 54. Best value: 0.147905:  61%|██████    | 61/100 [02:22<01:17,  1.99s/it]Best trial: 54. Best value: 0.147905:  62%|██████▏   | 62/100 [02:22<01:10,  1.85s/it]Best trial: 54. Best value: 0.147905:  62%|██████▏   | 62/100 [02:24<01:10,  1.85s/it]Best trial: 54. Best value: 0.147905:  63%|██████▎   | 63/100 [02:24<01:09,  1.88s/it]Best trial: 54. Best value: 0.147905:  63%|██████▎   | 63/100 [02:26<01:09,  1.88s/it]Best trial: 54. Best value: 0.147905:  64%|██████▍   | 64/100 [02:26<01:05,  1.82s/it]Best trial: 54. Best value: 0.147905:  64%|██████▍   | 64/100 [02:28<01:05,  1.82s/it]Best trial: 54. Best value: 0.147905:  65%|██████▌   | 65/100 [02:28<01:04,  1.83s/it]Best trial: 54. Best value: 0.147905:  65%|██████▌   | 65/100 [02:30<01:04,  1.83s/it]Best trial: 54. Best value: 0.147905:  66%|██████▌   | 66/100 [02:30<01:00,  1.77s/it]Best trial: 54. Best value: 0.147905:  66%|██████▌   | 66/100 [02:31<01:00,  1.77s/it]Best trial: 54. Best value: 0.147905:  67%|██████▋   | 67/100 [02:31<00:56,  1.72s/it]Best trial: 54. Best value: 0.147905:  67%|██████▋   | 67/100 [02:33<00:56,  1.72s/it]Best trial: 54. Best value: 0.147905:  68%|██████▊   | 68/100 [02:33<00:54,  1.71s/it]Best trial: 54. Best value: 0.147905:  68%|██████▊   | 68/100 [02:35<00:54,  1.71s/it]Best trial: 54. Best value: 0.147905:  69%|██████▉   | 69/100 [02:35<00:53,  1.73s/it]Best trial: 54. Best value: 0.147905:  69%|██████▉   | 69/100 [02:37<00:53,  1.73s/it]Best trial: 54. Best value: 0.147905:  70%|███████   | 70/100 [02:37<00:55,  1.85s/it]Best trial: 54. Best value: 0.147905:  70%|███████   | 70/100 [02:38<00:55,  1.85s/it]Best trial: 54. Best value: 0.147905:  71%|███████   | 71/100 [02:38<00:50,  1.74s/it]Best trial: 71. Best value: 0.148433:  71%|███████   | 71/100 [02:40<00:50,  1.74s/it]Best trial: 71. Best value: 0.148433:  72%|███████▏  | 72/100 [02:40<00:52,  1.87s/it]Best trial: 71. Best value: 0.148433:  72%|███████▏  | 72/100 [02:42<00:52,  1.87s/it]Best trial: 71. Best value: 0.148433:  73%|███████▎  | 73/100 [02:42<00:47,  1.77s/it]Best trial: 71. Best value: 0.148433:  73%|███████▎  | 73/100 [02:44<00:47,  1.77s/it]Best trial: 71. Best value: 0.148433:  74%|███████▍  | 74/100 [02:44<00:45,  1.76s/it]Best trial: 71. Best value: 0.148433:  74%|███████▍  | 74/100 [02:46<00:45,  1.76s/it]Best trial: 71. Best value: 0.148433:  75%|███████▌  | 75/100 [02:46<00:47,  1.89s/it]Best trial: 71. Best value: 0.148433:  75%|███████▌  | 75/100 [02:47<00:47,  1.89s/it]Best trial: 71. Best value: 0.148433:  76%|███████▌  | 76/100 [02:47<00:43,  1.80s/it]Best trial: 71. Best value: 0.148433:  76%|███████▌  | 76/100 [02:50<00:43,  1.80s/it]Best trial: 71. Best value: 0.148433:  77%|███████▋  | 77/100 [02:50<00:44,  1.95s/it]Best trial: 71. Best value: 0.148433:  77%|███████▋  | 77/100 [02:51<00:44,  1.95s/it]Best trial: 71. Best value: 0.148433:  78%|███████▊  | 78/100 [02:51<00:40,  1.82s/it]Best trial: 71. Best value: 0.148433:  78%|███████▊  | 78/100 [02:54<00:40,  1.82s/it]Best trial: 71. Best value: 0.148433:  79%|███████▉  | 79/100 [02:54<00:42,  2.02s/it]Best trial: 71. Best value: 0.148433:  79%|███████▉  | 79/100 [02:56<00:42,  2.02s/it]Best trial: 71. Best value: 0.148433:  80%|████████  | 80/100 [02:56<00:40,  2.03s/it]Best trial: 71. Best value: 0.148433:  80%|████████  | 80/100 [02:57<00:40,  2.03s/it]Best trial: 71. Best value: 0.148433:  81%|████████  | 81/100 [02:57<00:34,  1.82s/it]Best trial: 71. Best value: 0.148433:  81%|████████  | 81/100 [02:59<00:34,  1.82s/it]Best trial: 71. Best value: 0.148433:  82%|████████▏ | 82/100 [02:59<00:31,  1.76s/it]Best trial: 71. Best value: 0.148433:  82%|████████▏ | 82/100 [03:00<00:31,  1.76s/it]Best trial: 71. Best value: 0.148433:  83%|████████▎ | 83/100 [03:00<00:28,  1.66s/it]Best trial: 71. Best value: 0.148433:  83%|████████▎ | 83/100 [03:03<00:28,  1.66s/it]Best trial: 71. Best value: 0.148433:  84%|████████▍ | 84/100 [03:03<00:31,  1.99s/it]Best trial: 71. Best value: 0.148433:  84%|████████▍ | 84/100 [03:05<00:31,  1.99s/it]Best trial: 71. Best value: 0.148433:  85%|████████▌ | 85/100 [03:05<00:31,  2.10s/it]Best trial: 71. Best value: 0.148433:  85%|████████▌ | 85/100 [03:08<00:31,  2.10s/it]Best trial: 71. Best value: 0.148433:  86%|████████▌ | 86/100 [03:08<00:30,  2.19s/it]Best trial: 71. Best value: 0.148433:  86%|████████▌ | 86/100 [03:10<00:30,  2.19s/it]Best trial: 71. Best value: 0.148433:  87%|████████▋ | 87/100 [03:10<00:27,  2.08s/it]Best trial: 71. Best value: 0.148433:  87%|████████▋ | 87/100 [03:11<00:27,  2.08s/it]Best trial: 71. Best value: 0.148433:  88%|████████▊ | 88/100 [03:11<00:23,  1.94s/it]Best trial: 71. Best value: 0.148433:  88%|████████▊ | 88/100 [03:13<00:23,  1.94s/it]Best trial: 71. Best value: 0.148433:  89%|████████▉ | 89/100 [03:13<00:20,  1.84s/it]Best trial: 71. Best value: 0.148433:  89%|████████▉ | 89/100 [03:15<00:20,  1.84s/it]Best trial: 71. Best value: 0.148433:  90%|█████████ | 90/100 [03:15<00:19,  1.98s/it]Best trial: 71. Best value: 0.148433:  90%|█████████ | 90/100 [03:17<00:19,  1.98s/it]Best trial: 71. Best value: 0.148433:  91%|█████████ | 91/100 [03:17<00:18,  2.10s/it]Best trial: 71. Best value: 0.148433:  91%|█████████ | 91/100 [03:19<00:18,  2.10s/it]Best trial: 71. Best value: 0.148433:  92%|█████████▏| 92/100 [03:19<00:16,  2.06s/it]Best trial: 71. Best value: 0.148433:  92%|█████████▏| 92/100 [03:21<00:16,  2.06s/it]Best trial: 71. Best value: 0.148433:  93%|█████████▎| 93/100 [03:21<00:13,  1.92s/it]Best trial: 71. Best value: 0.148433:  93%|█████████▎| 93/100 [03:23<00:13,  1.92s/it]Best trial: 71. Best value: 0.148433:  94%|█████████▍| 94/100 [03:23<00:11,  1.90s/it]Best trial: 71. Best value: 0.148433:  94%|█████████▍| 94/100 [03:25<00:11,  1.90s/it]Best trial: 71. Best value: 0.148433:  95%|█████████▌| 95/100 [03:25<00:10,  2.05s/it]Best trial: 71. Best value: 0.148433:  95%|█████████▌| 95/100 [03:28<00:10,  2.05s/it]Best trial: 71. Best value: 0.148433:  96%|█████████▌| 96/100 [03:28<00:08,  2.23s/it]Best trial: 71. Best value: 0.148433:  96%|█████████▌| 96/100 [03:30<00:08,  2.23s/it]Best trial: 71. Best value: 0.148433:  97%|█████████▋| 97/100 [03:30<00:06,  2.20s/it]Best trial: 71. Best value: 0.148433:  97%|█████████▋| 97/100 [03:32<00:06,  2.20s/it]Best trial: 71. Best value: 0.148433:  98%|█████████▊| 98/100 [03:32<00:04,  2.21s/it]Best trial: 71. Best value: 0.148433:  98%|█████████▊| 98/100 [03:34<00:04,  2.21s/it]Best trial: 71. Best value: 0.148433:  99%|█████████▉| 99/100 [03:34<00:02,  2.12s/it]Best trial: 71. Best value: 0.148433:  99%|█████████▉| 99/100 [03:36<00:02,  2.12s/it]Best trial: 71. Best value: 0.148433: 100%|██████████| 100/100 [03:36<00:00,  2.08s/it]Best trial: 71. Best value: 0.148433: 100%|██████████| 100/100 [03:36<00:00,  2.17s/it]
2025-11-30 15:00:21,199 - INFO - HPO Complete. Best AUPRC: 0.1484
2025-11-30 15:00:21,199 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.000960288417888082, 'max_depth': 6, 'subsample': 0.9338009973192958, 'colsample_bytree': 0.6365901449742237, 'gamma': 0.033573682432616214, 'reg_lambda': 0.0007183406344996833, 'reg_alpha': 0.0002022117353849253}
2025-11-30 15:00:21,200 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:00:23,260 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 15:00:23,260 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:00:23,346 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:00:23,357 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:00:23,360 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 15:00:23,360 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:00:23,360 - INFO - Training model...
2025-11-30 15:00:28,302 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:00:33,095 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:00:33,096 - INFO - AUROC: 0.5090 (0.1641 - 0.7093)
2025-11-30 15:00:33,096 - INFO - AUPRC: 0.0949 (0.0041 - 0.4781)
2025-11-30 15:00:33,096 - INFO - Brier Score: 0.0615 (0.0592 - 0.0664)
2025-11-30 15:00:33,096 - INFO - Accuracy: 0.9913 (0.0905 - 0.9957)
2025-11-30 15:00:33,096 - INFO - Precision: 0.5000 (0.0048 - 1.0000)
2025-11-30 15:00:33,096 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 15:00:33,096 - INFO - F1-Score: 0.2500 (0.0095 - 0.6667)
2025-11-30 15:00:33,096 - INFO - Best Threshold: 0.5300 (0.1900 - 0.5300)
2025-11-30 15:00:33,096 - INFO - Specificity: 0.9985 (0.0815 - 1.0000)
2025-11-30 15:00:33,130 - INFO - Calculating SHAP values...
2025-11-30 15:00:34,494 - INFO - SHAP plots saved.
2025-11-30 15:00:34,496 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:00:35,844 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 15:00:35,845 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:00:35,949 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:00:35,977 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:00:35,984 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:00:35,984 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.12879:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.12879:   1%|          | 1/100 [00:02<04:11,  2.54s/it]Best trial: 1. Best value: 0.172316:   1%|          | 1/100 [00:04<04:11,  2.54s/it]Best trial: 1. Best value: 0.172316:   2%|▏         | 2/100 [00:04<03:42,  2.27s/it]Best trial: 1. Best value: 0.172316:   2%|▏         | 2/100 [00:06<03:42,  2.27s/it]Best trial: 1. Best value: 0.172316:   3%|▎         | 3/100 [00:06<03:38,  2.25s/it]Best trial: 1. Best value: 0.172316:   3%|▎         | 3/100 [00:08<03:38,  2.25s/it]Best trial: 1. Best value: 0.172316:   4%|▍         | 4/100 [00:08<03:13,  2.01s/it]Best trial: 1. Best value: 0.172316:   4%|▍         | 4/100 [00:10<03:13,  2.01s/it]Best trial: 1. Best value: 0.172316:   5%|▌         | 5/100 [00:10<03:10,  2.01s/it]Best trial: 5. Best value: 0.1874:   5%|▌         | 5/100 [00:12<03:10,  2.01s/it]  Best trial: 5. Best value: 0.1874:   6%|▌         | 6/100 [00:12<03:19,  2.13s/it]Best trial: 5. Best value: 0.1874:   6%|▌         | 6/100 [00:14<03:19,  2.13s/it]Best trial: 5. Best value: 0.1874:   7%|▋         | 7/100 [00:14<03:06,  2.01s/it]Best trial: 5. Best value: 0.1874:   7%|▋         | 7/100 [00:16<03:06,  2.01s/it]Best trial: 5. Best value: 0.1874:   8%|▊         | 8/100 [00:16<03:12,  2.09s/it]Best trial: 5. Best value: 0.1874:   8%|▊         | 8/100 [00:19<03:12,  2.09s/it]Best trial: 5. Best value: 0.1874:   9%|▉         | 9/100 [00:19<03:16,  2.16s/it]Best trial: 5. Best value: 0.1874:   9%|▉         | 9/100 [00:21<03:16,  2.16s/it]Best trial: 5. Best value: 0.1874:  10%|█         | 10/100 [00:21<03:10,  2.12s/it]Best trial: 5. Best value: 0.1874:  10%|█         | 10/100 [00:23<03:10,  2.12s/it]Best trial: 5. Best value: 0.1874:  11%|█         | 11/100 [00:23<03:06,  2.10s/it]Best trial: 11. Best value: 0.215054:  11%|█         | 11/100 [00:24<03:06,  2.10s/it]Best trial: 11. Best value: 0.215054:  12%|█▏        | 12/100 [00:24<02:47,  1.91s/it]Best trial: 11. Best value: 0.215054:  12%|█▏        | 12/100 [00:26<02:47,  1.91s/it]Best trial: 11. Best value: 0.215054:  13%|█▎        | 13/100 [00:26<02:35,  1.79s/it]Best trial: 11. Best value: 0.215054:  13%|█▎        | 13/100 [00:27<02:35,  1.79s/it]Best trial: 11. Best value: 0.215054:  14%|█▍        | 14/100 [00:27<02:27,  1.71s/it]Best trial: 11. Best value: 0.215054:  14%|█▍        | 14/100 [00:29<02:27,  1.71s/it]Best trial: 11. Best value: 0.215054:  15%|█▌        | 15/100 [00:29<02:31,  1.79s/it]Best trial: 11. Best value: 0.215054:  15%|█▌        | 15/100 [00:31<02:31,  1.79s/it]Best trial: 11. Best value: 0.215054:  16%|█▌        | 16/100 [00:31<02:24,  1.72s/it]Best trial: 11. Best value: 0.215054:  16%|█▌        | 16/100 [00:32<02:24,  1.72s/it]Best trial: 11. Best value: 0.215054:  17%|█▋        | 17/100 [00:32<02:21,  1.70s/it]Best trial: 11. Best value: 0.215054:  17%|█▋        | 17/100 [00:35<02:21,  1.70s/it]Best trial: 11. Best value: 0.215054:  18%|█▊        | 18/100 [00:35<02:34,  1.88s/it]Best trial: 11. Best value: 0.215054:  18%|█▊        | 18/100 [00:37<02:34,  1.88s/it]Best trial: 11. Best value: 0.215054:  19%|█▉        | 19/100 [00:37<02:30,  1.85s/it]Best trial: 11. Best value: 0.215054:  19%|█▉        | 19/100 [00:38<02:30,  1.85s/it]Best trial: 11. Best value: 0.215054:  20%|██        | 20/100 [00:38<02:21,  1.77s/it]Best trial: 11. Best value: 0.215054:  20%|██        | 20/100 [00:40<02:21,  1.77s/it]Best trial: 11. Best value: 0.215054:  21%|██        | 21/100 [00:40<02:12,  1.68s/it]Best trial: 11. Best value: 0.215054:  21%|██        | 21/100 [00:41<02:12,  1.68s/it]Best trial: 11. Best value: 0.215054:  22%|██▏       | 22/100 [00:41<02:14,  1.73s/it]Best trial: 11. Best value: 0.215054:  22%|██▏       | 22/100 [00:43<02:14,  1.73s/it]Best trial: 11. Best value: 0.215054:  23%|██▎       | 23/100 [00:43<02:13,  1.73s/it]Best trial: 11. Best value: 0.215054:  23%|██▎       | 23/100 [00:45<02:13,  1.73s/it]Best trial: 11. Best value: 0.215054:  24%|██▍       | 24/100 [00:45<02:09,  1.70s/it]Best trial: 11. Best value: 0.215054:  24%|██▍       | 24/100 [00:46<02:09,  1.70s/it]Best trial: 11. Best value: 0.215054:  25%|██▌       | 25/100 [00:46<02:04,  1.66s/it]Best trial: 11. Best value: 0.215054:  25%|██▌       | 25/100 [00:48<02:04,  1.66s/it]Best trial: 11. Best value: 0.215054:  26%|██▌       | 26/100 [00:48<02:07,  1.72s/it]Best trial: 11. Best value: 0.215054:  26%|██▌       | 26/100 [00:50<02:07,  1.72s/it]Best trial: 11. Best value: 0.215054:  27%|██▋       | 27/100 [00:50<02:08,  1.77s/it]Best trial: 11. Best value: 0.215054:  27%|██▋       | 27/100 [00:52<02:08,  1.77s/it]Best trial: 11. Best value: 0.215054:  28%|██▊       | 28/100 [00:52<02:11,  1.82s/it]Best trial: 11. Best value: 0.215054:  28%|██▊       | 28/100 [00:54<02:11,  1.82s/it]Best trial: 11. Best value: 0.215054:  29%|██▉       | 29/100 [00:54<02:13,  1.89s/it]Best trial: 11. Best value: 0.215054:  29%|██▉       | 29/100 [00:55<02:13,  1.89s/it]Best trial: 11. Best value: 0.215054:  30%|███       | 30/100 [00:55<01:58,  1.69s/it]Best trial: 11. Best value: 0.215054:  30%|███       | 30/100 [00:57<01:58,  1.69s/it]Best trial: 11. Best value: 0.215054:  31%|███       | 31/100 [00:57<02:05,  1.83s/it]Best trial: 11. Best value: 0.215054:  31%|███       | 31/100 [00:59<02:05,  1.83s/it]Best trial: 11. Best value: 0.215054:  32%|███▏      | 32/100 [00:59<02:05,  1.84s/it]Best trial: 11. Best value: 0.215054:  32%|███▏      | 32/100 [01:01<02:05,  1.84s/it]Best trial: 11. Best value: 0.215054:  33%|███▎      | 33/100 [01:01<01:56,  1.74s/it]Best trial: 11. Best value: 0.215054:  33%|███▎      | 33/100 [01:02<01:56,  1.74s/it]Best trial: 11. Best value: 0.215054:  34%|███▍      | 34/100 [01:02<01:51,  1.70s/it]Best trial: 11. Best value: 0.215054:  34%|███▍      | 34/100 [01:04<01:51,  1.70s/it]Best trial: 11. Best value: 0.215054:  35%|███▌      | 35/100 [01:04<01:48,  1.67s/it]Best trial: 11. Best value: 0.215054:  35%|███▌      | 35/100 [01:06<01:48,  1.67s/it]Best trial: 11. Best value: 0.215054:  36%|███▌      | 36/100 [01:06<01:44,  1.63s/it]Best trial: 11. Best value: 0.215054:  36%|███▌      | 36/100 [01:07<01:44,  1.63s/it]Best trial: 11. Best value: 0.215054:  37%|███▋      | 37/100 [01:07<01:41,  1.61s/it]Best trial: 11. Best value: 0.215054:  37%|███▋      | 37/100 [01:09<01:41,  1.61s/it]Best trial: 11. Best value: 0.215054:  38%|███▊      | 38/100 [01:09<01:36,  1.55s/it]Best trial: 11. Best value: 0.215054:  38%|███▊      | 38/100 [01:10<01:36,  1.55s/it]Best trial: 11. Best value: 0.215054:  39%|███▉      | 39/100 [01:10<01:31,  1.51s/it]Best trial: 11. Best value: 0.215054:  39%|███▉      | 39/100 [01:12<01:31,  1.51s/it]Best trial: 11. Best value: 0.215054:  40%|████      | 40/100 [01:12<01:30,  1.52s/it]Best trial: 11. Best value: 0.215054:  40%|████      | 40/100 [01:13<01:30,  1.52s/it]Best trial: 11. Best value: 0.215054:  41%|████      | 41/100 [01:13<01:29,  1.52s/it]Best trial: 11. Best value: 0.215054:  41%|████      | 41/100 [01:15<01:29,  1.52s/it]Best trial: 11. Best value: 0.215054:  42%|████▏     | 42/100 [01:15<01:28,  1.53s/it]Best trial: 42. Best value: 0.231864:  42%|████▏     | 42/100 [01:16<01:28,  1.53s/it]Best trial: 42. Best value: 0.231864:  43%|████▎     | 43/100 [01:16<01:26,  1.52s/it]Best trial: 42. Best value: 0.231864:  43%|████▎     | 43/100 [01:18<01:26,  1.52s/it]Best trial: 42. Best value: 0.231864:  44%|████▍     | 44/100 [01:18<01:24,  1.51s/it]Best trial: 42. Best value: 0.231864:  44%|████▍     | 44/100 [01:19<01:24,  1.51s/it]Best trial: 42. Best value: 0.231864:  45%|████▌     | 45/100 [01:19<01:25,  1.55s/it]Best trial: 42. Best value: 0.231864:  45%|████▌     | 45/100 [01:21<01:25,  1.55s/it]Best trial: 42. Best value: 0.231864:  46%|████▌     | 46/100 [01:21<01:23,  1.55s/it]Best trial: 42. Best value: 0.231864:  46%|████▌     | 46/100 [01:22<01:23,  1.55s/it]Best trial: 42. Best value: 0.231864:  47%|████▋     | 47/100 [01:22<01:23,  1.57s/it]Best trial: 42. Best value: 0.231864:  47%|████▋     | 47/100 [01:25<01:23,  1.57s/it]Best trial: 42. Best value: 0.231864:  48%|████▊     | 48/100 [01:25<01:30,  1.73s/it]Best trial: 42. Best value: 0.231864:  48%|████▊     | 48/100 [01:27<01:30,  1.73s/it]Best trial: 42. Best value: 0.231864:  49%|████▉     | 49/100 [01:27<01:33,  1.83s/it]Best trial: 42. Best value: 0.231864:  49%|████▉     | 49/100 [01:28<01:33,  1.83s/it]Best trial: 42. Best value: 0.231864:  50%|█████     | 50/100 [01:28<01:26,  1.74s/it]Best trial: 42. Best value: 0.231864:  50%|█████     | 50/100 [01:30<01:26,  1.74s/it]Best trial: 42. Best value: 0.231864:  51%|█████     | 51/100 [01:30<01:22,  1.68s/it]Best trial: 42. Best value: 0.231864:  51%|█████     | 51/100 [01:31<01:22,  1.68s/it]Best trial: 42. Best value: 0.231864:  52%|█████▏    | 52/100 [01:31<01:16,  1.59s/it]Best trial: 52. Best value: 0.233683:  52%|█████▏    | 52/100 [01:33<01:16,  1.59s/it]Best trial: 52. Best value: 0.233683:  53%|█████▎    | 53/100 [01:33<01:18,  1.67s/it]Best trial: 52. Best value: 0.233683:  53%|█████▎    | 53/100 [01:35<01:18,  1.67s/it]Best trial: 52. Best value: 0.233683:  54%|█████▍    | 54/100 [01:35<01:24,  1.84s/it]Best trial: 52. Best value: 0.233683:  54%|█████▍    | 54/100 [01:37<01:24,  1.84s/it]Best trial: 52. Best value: 0.233683:  55%|█████▌    | 55/100 [01:37<01:18,  1.73s/it]Best trial: 52. Best value: 0.233683:  55%|█████▌    | 55/100 [01:38<01:18,  1.73s/it]Best trial: 52. Best value: 0.233683:  56%|█████▌    | 56/100 [01:38<01:13,  1.67s/it]Best trial: 52. Best value: 0.233683:  56%|█████▌    | 56/100 [01:40<01:13,  1.67s/it]Best trial: 52. Best value: 0.233683:  57%|█████▋    | 57/100 [01:40<01:08,  1.60s/it]Best trial: 52. Best value: 0.233683:  57%|█████▋    | 57/100 [01:42<01:08,  1.60s/it]Best trial: 52. Best value: 0.233683:  58%|█████▊    | 58/100 [01:42<01:15,  1.80s/it]Best trial: 52. Best value: 0.233683:  58%|█████▊    | 58/100 [01:44<01:15,  1.80s/it]Best trial: 52. Best value: 0.233683:  59%|█████▉    | 59/100 [01:44<01:14,  1.81s/it]Best trial: 52. Best value: 0.233683:  59%|█████▉    | 59/100 [01:45<01:14,  1.81s/it]Best trial: 52. Best value: 0.233683:  60%|██████    | 60/100 [01:45<01:12,  1.82s/it]Best trial: 52. Best value: 0.233683:  60%|██████    | 60/100 [01:48<01:12,  1.82s/it]Best trial: 52. Best value: 0.233683:  61%|██████    | 61/100 [01:48<01:14,  1.90s/it]Best trial: 52. Best value: 0.233683:  61%|██████    | 61/100 [01:49<01:14,  1.90s/it]Best trial: 52. Best value: 0.233683:  62%|██████▏   | 62/100 [01:49<01:07,  1.79s/it]Best trial: 52. Best value: 0.233683:  62%|██████▏   | 62/100 [01:50<01:07,  1.79s/it]Best trial: 52. Best value: 0.233683:  63%|██████▎   | 63/100 [01:50<01:01,  1.66s/it]Best trial: 63. Best value: 0.241915:  63%|██████▎   | 63/100 [01:52<01:01,  1.66s/it]Best trial: 63. Best value: 0.241915:  64%|██████▍   | 64/100 [01:52<00:59,  1.64s/it]Best trial: 63. Best value: 0.241915:  64%|██████▍   | 64/100 [01:54<00:59,  1.64s/it]Best trial: 63. Best value: 0.241915:  65%|██████▌   | 65/100 [01:54<00:56,  1.61s/it]Best trial: 63. Best value: 0.241915:  65%|██████▌   | 65/100 [01:55<00:56,  1.61s/it]Best trial: 63. Best value: 0.241915:  66%|██████▌   | 66/100 [01:55<00:51,  1.52s/it]Best trial: 63. Best value: 0.241915:  66%|██████▌   | 66/100 [01:56<00:51,  1.52s/it]Best trial: 63. Best value: 0.241915:  67%|██████▋   | 67/100 [01:56<00:49,  1.49s/it]Best trial: 63. Best value: 0.241915:  67%|██████▋   | 67/100 [01:58<00:49,  1.49s/it]Best trial: 63. Best value: 0.241915:  68%|██████▊   | 68/100 [01:58<00:48,  1.51s/it]Best trial: 63. Best value: 0.241915:  68%|██████▊   | 68/100 [01:59<00:48,  1.51s/it]Best trial: 63. Best value: 0.241915:  69%|██████▉   | 69/100 [01:59<00:46,  1.50s/it]Best trial: 63. Best value: 0.241915:  69%|██████▉   | 69/100 [02:01<00:46,  1.50s/it]Best trial: 63. Best value: 0.241915:  70%|███████   | 70/100 [02:01<00:45,  1.52s/it]Best trial: 63. Best value: 0.241915:  70%|███████   | 70/100 [02:03<00:45,  1.52s/it]Best trial: 63. Best value: 0.241915:  71%|███████   | 71/100 [02:03<00:45,  1.56s/it]Best trial: 63. Best value: 0.241915:  71%|███████   | 71/100 [02:04<00:45,  1.56s/it]Best trial: 63. Best value: 0.241915:  72%|███████▏  | 72/100 [02:04<00:44,  1.59s/it]Best trial: 63. Best value: 0.241915:  72%|███████▏  | 72/100 [02:06<00:44,  1.59s/it]Best trial: 63. Best value: 0.241915:  73%|███████▎  | 73/100 [02:06<00:43,  1.61s/it]Best trial: 63. Best value: 0.241915:  73%|███████▎  | 73/100 [02:07<00:43,  1.61s/it]Best trial: 63. Best value: 0.241915:  74%|███████▍  | 74/100 [02:07<00:41,  1.59s/it]Best trial: 63. Best value: 0.241915:  74%|███████▍  | 74/100 [02:09<00:41,  1.59s/it]Best trial: 63. Best value: 0.241915:  75%|███████▌  | 75/100 [02:09<00:39,  1.58s/it]Best trial: 63. Best value: 0.241915:  75%|███████▌  | 75/100 [02:11<00:39,  1.58s/it]Best trial: 63. Best value: 0.241915:  76%|███████▌  | 76/100 [02:11<00:38,  1.59s/it]Best trial: 63. Best value: 0.241915:  76%|███████▌  | 76/100 [02:12<00:38,  1.59s/it]Best trial: 63. Best value: 0.241915:  77%|███████▋  | 77/100 [02:12<00:36,  1.60s/it]Best trial: 63. Best value: 0.241915:  77%|███████▋  | 77/100 [02:14<00:36,  1.60s/it]Best trial: 63. Best value: 0.241915:  78%|███████▊  | 78/100 [02:14<00:36,  1.64s/it]Best trial: 63. Best value: 0.241915:  78%|███████▊  | 78/100 [02:16<00:36,  1.64s/it]Best trial: 63. Best value: 0.241915:  79%|███████▉  | 79/100 [02:16<00:35,  1.67s/it]Best trial: 79. Best value: 0.266817:  79%|███████▉  | 79/100 [02:17<00:35,  1.67s/it]Best trial: 79. Best value: 0.266817:  80%|████████  | 80/100 [02:17<00:30,  1.52s/it]Best trial: 79. Best value: 0.266817:  80%|████████  | 80/100 [02:18<00:30,  1.52s/it]Best trial: 79. Best value: 0.266817:  81%|████████  | 81/100 [02:18<00:29,  1.53s/it]Best trial: 81. Best value: 0.269243:  81%|████████  | 81/100 [02:20<00:29,  1.53s/it]Best trial: 81. Best value: 0.269243:  82%|████████▏ | 82/100 [02:20<00:27,  1.53s/it]Best trial: 81. Best value: 0.269243:  82%|████████▏ | 82/100 [02:21<00:27,  1.53s/it]Best trial: 81. Best value: 0.269243:  83%|████████▎ | 83/100 [02:21<00:25,  1.48s/it]Best trial: 81. Best value: 0.269243:  83%|████████▎ | 83/100 [02:23<00:25,  1.48s/it]Best trial: 81. Best value: 0.269243:  84%|████████▍ | 84/100 [02:23<00:23,  1.49s/it]Best trial: 81. Best value: 0.269243:  84%|████████▍ | 84/100 [02:24<00:23,  1.49s/it]Best trial: 81. Best value: 0.269243:  85%|████████▌ | 85/100 [02:24<00:22,  1.49s/it]Best trial: 81. Best value: 0.269243:  85%|████████▌ | 85/100 [02:26<00:22,  1.49s/it]Best trial: 81. Best value: 0.269243:  86%|████████▌ | 86/100 [02:26<00:20,  1.44s/it]Best trial: 81. Best value: 0.269243:  86%|████████▌ | 86/100 [02:27<00:20,  1.44s/it]Best trial: 81. Best value: 0.269243:  87%|████████▋ | 87/100 [02:27<00:19,  1.47s/it]Best trial: 81. Best value: 0.269243:  87%|████████▋ | 87/100 [02:29<00:19,  1.47s/it]Best trial: 81. Best value: 0.269243:  88%|████████▊ | 88/100 [02:29<00:17,  1.45s/it]Best trial: 81. Best value: 0.269243:  88%|████████▊ | 88/100 [02:30<00:17,  1.45s/it]Best trial: 81. Best value: 0.269243:  89%|████████▉ | 89/100 [02:30<00:17,  1.57s/it]Best trial: 81. Best value: 0.269243:  89%|████████▉ | 89/100 [02:32<00:17,  1.57s/it]Best trial: 81. Best value: 0.269243:  90%|█████████ | 90/100 [02:32<00:15,  1.51s/it]Best trial: 81. Best value: 0.269243:  90%|█████████ | 90/100 [02:33<00:15,  1.51s/it]Best trial: 81. Best value: 0.269243:  91%|█████████ | 91/100 [02:33<00:13,  1.45s/it]Best trial: 81. Best value: 0.269243:  91%|█████████ | 91/100 [02:35<00:13,  1.45s/it]Best trial: 81. Best value: 0.269243:  92%|█████████▏| 92/100 [02:35<00:11,  1.46s/it]Best trial: 81. Best value: 0.269243:  92%|█████████▏| 92/100 [02:36<00:11,  1.46s/it]Best trial: 81. Best value: 0.269243:  93%|█████████▎| 93/100 [02:36<00:10,  1.45s/it]Best trial: 81. Best value: 0.269243:  93%|█████████▎| 93/100 [02:37<00:10,  1.45s/it]Best trial: 81. Best value: 0.269243:  94%|█████████▍| 94/100 [02:37<00:08,  1.43s/it]Best trial: 81. Best value: 0.269243:  94%|█████████▍| 94/100 [02:39<00:08,  1.43s/it]Best trial: 81. Best value: 0.269243:  95%|█████████▌| 95/100 [02:39<00:06,  1.39s/it]Best trial: 81. Best value: 0.269243:  95%|█████████▌| 95/100 [02:40<00:06,  1.39s/it]Best trial: 81. Best value: 0.269243:  96%|█████████▌| 96/100 [02:40<00:05,  1.44s/it]Best trial: 81. Best value: 0.269243:  96%|█████████▌| 96/100 [02:42<00:05,  1.44s/it]Best trial: 81. Best value: 0.269243:  97%|█████████▋| 97/100 [02:42<00:04,  1.42s/it]Best trial: 81. Best value: 0.269243:  97%|█████████▋| 97/100 [02:43<00:04,  1.42s/it]Best trial: 81. Best value: 0.269243:  98%|█████████▊| 98/100 [02:43<00:02,  1.40s/it]Best trial: 81. Best value: 0.269243:  98%|█████████▊| 98/100 [02:44<00:02,  1.40s/it]Best trial: 81. Best value: 0.269243:  99%|█████████▉| 99/100 [02:44<00:01,  1.40s/it]Best trial: 81. Best value: 0.269243:  99%|█████████▉| 99/100 [02:46<00:01,  1.40s/it]Best trial: 81. Best value: 0.269243: 100%|██████████| 100/100 [02:46<00:00,  1.41s/it]Best trial: 81. Best value: 0.269243: 100%|██████████| 100/100 [02:46<00:00,  1.66s/it]
2025-11-30 15:03:22,306 - INFO - HPO Complete. Best AUPRC: 0.2692
2025-11-30 15:03:22,307 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.020461460022298514, 'max_depth': 3, 'subsample': 0.6415788452371467, 'colsample_bytree': 0.7327792904448982, 'gamma': 4.6884858774113995, 'reg_lambda': 5.907270580873372e-05, 'reg_alpha': 3.1328260857017778e-06}
2025-11-30 15:03:22,307 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:03:24,212 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 15:03:24,212 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:03:24,295 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:03:24,317 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:03:24,322 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:03:24,322 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:03:24,323 - INFO - Training model...
2025-11-30 15:03:26,395 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:03:31,735 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:03:31,735 - INFO - AUROC: 0.5892 (0.1838 - 0.7585)
2025-11-30 15:03:31,735 - INFO - AUPRC: 0.1075 (0.0045 - 0.4869)
2025-11-30 15:03:31,735 - INFO - Brier Score: 0.0100 (0.0063 - 0.0170)
2025-11-30 15:03:31,735 - INFO - Accuracy: 0.9913 (0.8090 - 0.9954)
2025-11-30 15:03:31,735 - INFO - Precision: 0.5000 (0.0000 - 1.0000)
2025-11-30 15:03:31,736 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.6267)
2025-11-30 15:03:31,736 - INFO - F1-Score: 0.2500 (0.0000 - 0.6600)
2025-11-30 15:03:31,736 - INFO - Best Threshold: 0.4000 (0.0100 - 0.4000)
2025-11-30 15:03:31,736 - INFO - Specificity: 0.9985 (0.8146 - 1.0000)
2025-11-30 15:03:31,750 - INFO - Calculating SHAP values...
2025-11-30 15:03:32,738 - INFO - SHAP plots saved.
2025-11-30 15:03:32,740 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:03:33,925 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 15:03:33,925 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:03:34,009 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:03:34,033 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:03:34,039 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:03:34,039 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.091673:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.091673:   1%|          | 1/100 [00:02<04:16,  2.59s/it]Best trial: 0. Best value: 0.091673:   1%|          | 1/100 [00:05<04:16,  2.59s/it]Best trial: 0. Best value: 0.091673:   2%|▏         | 2/100 [00:05<04:04,  2.49s/it]Best trial: 0. Best value: 0.091673:   2%|▏         | 2/100 [00:07<04:04,  2.49s/it]Best trial: 0. Best value: 0.091673:   3%|▎         | 3/100 [00:07<03:48,  2.36s/it]Best trial: 3. Best value: 0.118177:   3%|▎         | 3/100 [00:09<03:48,  2.36s/it]Best trial: 3. Best value: 0.118177:   4%|▍         | 4/100 [00:09<03:29,  2.18s/it]Best trial: 4. Best value: 0.12791:   4%|▍         | 4/100 [00:10<03:29,  2.18s/it] Best trial: 4. Best value: 0.12791:   5%|▌         | 5/100 [00:10<03:06,  1.96s/it]Best trial: 4. Best value: 0.12791:   5%|▌         | 5/100 [00:12<03:06,  1.96s/it]Best trial: 4. Best value: 0.12791:   6%|▌         | 6/100 [00:12<03:03,  1.95s/it]Best trial: 4. Best value: 0.12791:   6%|▌         | 6/100 [00:14<03:03,  1.95s/it]Best trial: 4. Best value: 0.12791:   7%|▋         | 7/100 [00:14<02:51,  1.84s/it]Best trial: 7. Best value: 0.144202:   7%|▋         | 7/100 [00:16<02:51,  1.84s/it]Best trial: 7. Best value: 0.144202:   8%|▊         | 8/100 [00:16<03:10,  2.07s/it]Best trial: 7. Best value: 0.144202:   8%|▊         | 8/100 [00:18<03:10,  2.07s/it]Best trial: 7. Best value: 0.144202:   9%|▉         | 9/100 [00:18<03:03,  2.02s/it]Best trial: 7. Best value: 0.144202:   9%|▉         | 9/100 [00:21<03:03,  2.02s/it]Best trial: 7. Best value: 0.144202:  10%|█         | 10/100 [00:21<03:09,  2.11s/it]Best trial: 7. Best value: 0.144202:  10%|█         | 10/100 [00:23<03:09,  2.11s/it]Best trial: 7. Best value: 0.144202:  11%|█         | 11/100 [00:23<03:09,  2.13s/it]Best trial: 7. Best value: 0.144202:  11%|█         | 11/100 [00:25<03:09,  2.13s/it]Best trial: 7. Best value: 0.144202:  12%|█▏        | 12/100 [00:25<02:58,  2.03s/it]Best trial: 7. Best value: 0.144202:  12%|█▏        | 12/100 [00:26<02:58,  2.03s/it]Best trial: 7. Best value: 0.144202:  13%|█▎        | 13/100 [00:26<02:51,  1.97s/it]Best trial: 13. Best value: 0.162531:  13%|█▎        | 13/100 [00:28<02:51,  1.97s/it]Best trial: 13. Best value: 0.162531:  14%|█▍        | 14/100 [00:28<02:50,  1.99s/it]Best trial: 13. Best value: 0.162531:  14%|█▍        | 14/100 [00:31<02:50,  1.99s/it]Best trial: 13. Best value: 0.162531:  15%|█▌        | 15/100 [00:31<03:10,  2.24s/it]Best trial: 13. Best value: 0.162531:  15%|█▌        | 15/100 [00:34<03:10,  2.24s/it]Best trial: 13. Best value: 0.162531:  16%|█▌        | 16/100 [00:34<03:29,  2.49s/it]Best trial: 13. Best value: 0.162531:  16%|█▌        | 16/100 [00:36<03:29,  2.49s/it]Best trial: 13. Best value: 0.162531:  17%|█▋        | 17/100 [00:36<03:13,  2.34s/it]Best trial: 13. Best value: 0.162531:  17%|█▋        | 17/100 [00:39<03:13,  2.34s/it]Best trial: 13. Best value: 0.162531:  18%|█▊        | 18/100 [00:39<03:19,  2.44s/it]Best trial: 13. Best value: 0.162531:  18%|█▊        | 18/100 [00:41<03:19,  2.44s/it]Best trial: 13. Best value: 0.162531:  19%|█▉        | 19/100 [00:41<03:07,  2.31s/it]Best trial: 19. Best value: 0.179551:  19%|█▉        | 19/100 [00:43<03:07,  2.31s/it]Best trial: 19. Best value: 0.179551:  20%|██        | 20/100 [00:43<02:50,  2.13s/it]Best trial: 19. Best value: 0.179551:  20%|██        | 20/100 [00:45<02:50,  2.13s/it]Best trial: 19. Best value: 0.179551:  21%|██        | 21/100 [00:45<02:53,  2.19s/it]Best trial: 19. Best value: 0.179551:  21%|██        | 21/100 [00:47<02:53,  2.19s/it]Best trial: 19. Best value: 0.179551:  22%|██▏       | 22/100 [00:47<02:39,  2.05s/it]Best trial: 19. Best value: 0.179551:  22%|██▏       | 22/100 [00:48<02:39,  2.05s/it]Best trial: 19. Best value: 0.179551:  23%|██▎       | 23/100 [00:48<02:26,  1.91s/it]Best trial: 19. Best value: 0.179551:  23%|██▎       | 23/100 [00:51<02:26,  1.91s/it]Best trial: 19. Best value: 0.179551:  24%|██▍       | 24/100 [00:51<02:51,  2.26s/it]Best trial: 19. Best value: 0.179551:  24%|██▍       | 24/100 [00:53<02:51,  2.26s/it]Best trial: 19. Best value: 0.179551:  25%|██▌       | 25/100 [00:53<02:40,  2.14s/it]Best trial: 19. Best value: 0.179551:  25%|██▌       | 25/100 [00:55<02:40,  2.14s/it]Best trial: 19. Best value: 0.179551:  26%|██▌       | 26/100 [00:55<02:34,  2.09s/it]Best trial: 19. Best value: 0.179551:  26%|██▌       | 26/100 [00:57<02:34,  2.09s/it]Best trial: 19. Best value: 0.179551:  27%|██▋       | 27/100 [00:57<02:30,  2.07s/it]Best trial: 19. Best value: 0.179551:  27%|██▋       | 27/100 [01:00<02:30,  2.07s/it]Best trial: 19. Best value: 0.179551:  28%|██▊       | 28/100 [01:00<02:42,  2.26s/it]Best trial: 19. Best value: 0.179551:  28%|██▊       | 28/100 [01:02<02:42,  2.26s/it]Best trial: 19. Best value: 0.179551:  29%|██▉       | 29/100 [01:02<02:32,  2.15s/it]Best trial: 19. Best value: 0.179551:  29%|██▉       | 29/100 [01:04<02:32,  2.15s/it]Best trial: 19. Best value: 0.179551:  30%|███       | 30/100 [01:04<02:22,  2.03s/it]Best trial: 19. Best value: 0.179551:  30%|███       | 30/100 [01:06<02:22,  2.03s/it]Best trial: 19. Best value: 0.179551:  31%|███       | 31/100 [01:06<02:19,  2.02s/it]Best trial: 19. Best value: 0.179551:  31%|███       | 31/100 [01:08<02:19,  2.02s/it]Best trial: 19. Best value: 0.179551:  32%|███▏      | 32/100 [01:08<02:16,  2.01s/it]Best trial: 19. Best value: 0.179551:  32%|███▏      | 32/100 [01:09<02:16,  2.01s/it]Best trial: 19. Best value: 0.179551:  33%|███▎      | 33/100 [01:09<01:59,  1.78s/it]Best trial: 33. Best value: 0.187816:  33%|███▎      | 33/100 [01:11<01:59,  1.78s/it]Best trial: 33. Best value: 0.187816:  34%|███▍      | 34/100 [01:11<02:06,  1.91s/it]Best trial: 33. Best value: 0.187816:  34%|███▍      | 34/100 [01:13<02:06,  1.91s/it]Best trial: 33. Best value: 0.187816:  35%|███▌      | 35/100 [01:13<02:01,  1.87s/it]Best trial: 33. Best value: 0.187816:  35%|███▌      | 35/100 [01:15<02:01,  1.87s/it]Best trial: 33. Best value: 0.187816:  36%|███▌      | 36/100 [01:15<01:58,  1.85s/it]Best trial: 33. Best value: 0.187816:  36%|███▌      | 36/100 [01:16<01:58,  1.85s/it]Best trial: 33. Best value: 0.187816:  37%|███▋      | 37/100 [01:16<01:58,  1.87s/it]Best trial: 33. Best value: 0.187816:  37%|███▋      | 37/100 [01:18<01:58,  1.87s/it]Best trial: 33. Best value: 0.187816:  38%|███▊      | 38/100 [01:18<01:48,  1.74s/it]Best trial: 33. Best value: 0.187816:  38%|███▊      | 38/100 [01:20<01:48,  1.74s/it]Best trial: 33. Best value: 0.187816:  39%|███▉      | 39/100 [01:20<02:00,  1.97s/it]Best trial: 33. Best value: 0.187816:  39%|███▉      | 39/100 [01:23<02:00,  1.97s/it]Best trial: 33. Best value: 0.187816:  40%|████      | 40/100 [01:23<02:11,  2.20s/it]Best trial: 33. Best value: 0.187816:  40%|████      | 40/100 [01:25<02:11,  2.20s/it]Best trial: 33. Best value: 0.187816:  41%|████      | 41/100 [01:25<02:00,  2.04s/it]Best trial: 33. Best value: 0.187816:  41%|████      | 41/100 [01:27<02:00,  2.04s/it]Best trial: 33. Best value: 0.187816:  42%|████▏     | 42/100 [01:27<02:05,  2.17s/it]Best trial: 33. Best value: 0.187816:  42%|████▏     | 42/100 [01:30<02:05,  2.17s/it]Best trial: 33. Best value: 0.187816:  43%|████▎     | 43/100 [01:30<02:17,  2.41s/it]Best trial: 43. Best value: 0.206263:  43%|████▎     | 43/100 [01:33<02:17,  2.41s/it]Best trial: 43. Best value: 0.206263:  44%|████▍     | 44/100 [01:33<02:15,  2.42s/it]Best trial: 43. Best value: 0.206263:  44%|████▍     | 44/100 [01:35<02:15,  2.42s/it]Best trial: 43. Best value: 0.206263:  45%|████▌     | 45/100 [01:35<02:03,  2.24s/it]Best trial: 43. Best value: 0.206263:  45%|████▌     | 45/100 [01:37<02:03,  2.24s/it]Best trial: 43. Best value: 0.206263:  46%|████▌     | 46/100 [01:37<01:58,  2.19s/it]Best trial: 43. Best value: 0.206263:  46%|████▌     | 46/100 [01:39<01:58,  2.19s/it]Best trial: 43. Best value: 0.206263:  47%|████▋     | 47/100 [01:39<01:57,  2.21s/it]Best trial: 43. Best value: 0.206263:  47%|████▋     | 47/100 [01:41<01:57,  2.21s/it]Best trial: 43. Best value: 0.206263:  48%|████▊     | 48/100 [01:41<01:54,  2.21s/it]Best trial: 43. Best value: 0.206263:  48%|████▊     | 48/100 [01:43<01:54,  2.21s/it]Best trial: 43. Best value: 0.206263:  49%|████▉     | 49/100 [01:43<01:52,  2.21s/it]Best trial: 43. Best value: 0.206263:  49%|████▉     | 49/100 [01:46<01:52,  2.21s/it]Best trial: 43. Best value: 0.206263:  50%|█████     | 50/100 [01:46<01:53,  2.26s/it]Best trial: 43. Best value: 0.206263:  50%|█████     | 50/100 [01:49<01:53,  2.26s/it]Best trial: 43. Best value: 0.206263:  51%|█████     | 51/100 [01:49<02:03,  2.53s/it]Best trial: 43. Best value: 0.206263:  51%|█████     | 51/100 [01:51<02:03,  2.53s/it]Best trial: 43. Best value: 0.206263:  52%|█████▏    | 52/100 [01:51<01:53,  2.37s/it]Best trial: 43. Best value: 0.206263:  52%|█████▏    | 52/100 [01:53<01:53,  2.37s/it]Best trial: 43. Best value: 0.206263:  53%|█████▎    | 53/100 [01:53<01:53,  2.41s/it]Best trial: 43. Best value: 0.206263:  53%|█████▎    | 53/100 [01:56<01:53,  2.41s/it]Best trial: 43. Best value: 0.206263:  54%|█████▍    | 54/100 [01:56<01:53,  2.46s/it]Best trial: 43. Best value: 0.206263:  54%|█████▍    | 54/100 [01:58<01:53,  2.46s/it]Best trial: 43. Best value: 0.206263:  55%|█████▌    | 55/100 [01:58<01:41,  2.26s/it]Best trial: 43. Best value: 0.206263:  55%|█████▌    | 55/100 [02:00<01:41,  2.26s/it]Best trial: 43. Best value: 0.206263:  56%|█████▌    | 56/100 [02:00<01:37,  2.22s/it]Best trial: 43. Best value: 0.206263:  56%|█████▌    | 56/100 [02:02<01:37,  2.22s/it]Best trial: 43. Best value: 0.206263:  57%|█████▋    | 57/100 [02:02<01:41,  2.36s/it]Best trial: 43. Best value: 0.206263:  57%|█████▋    | 57/100 [02:05<01:41,  2.36s/it]Best trial: 43. Best value: 0.206263:  58%|█████▊    | 58/100 [02:05<01:39,  2.36s/it]Best trial: 43. Best value: 0.206263:  58%|█████▊    | 58/100 [02:07<01:39,  2.36s/it]Best trial: 43. Best value: 0.206263:  59%|█████▉    | 59/100 [02:07<01:37,  2.38s/it]Best trial: 43. Best value: 0.206263:  59%|█████▉    | 59/100 [02:10<01:37,  2.38s/it]Best trial: 43. Best value: 0.206263:  60%|██████    | 60/100 [02:10<01:35,  2.39s/it]Best trial: 43. Best value: 0.206263:  60%|██████    | 60/100 [02:13<01:35,  2.39s/it]Best trial: 43. Best value: 0.206263:  61%|██████    | 61/100 [02:13<01:43,  2.66s/it]Best trial: 43. Best value: 0.206263:  61%|██████    | 61/100 [02:16<01:43,  2.66s/it]Best trial: 43. Best value: 0.206263:  62%|██████▏   | 62/100 [02:16<01:44,  2.74s/it]Best trial: 43. Best value: 0.206263:  62%|██████▏   | 62/100 [02:18<01:44,  2.74s/it]Best trial: 43. Best value: 0.206263:  63%|██████▎   | 63/100 [02:18<01:39,  2.68s/it]Best trial: 43. Best value: 0.206263:  63%|██████▎   | 63/100 [02:21<01:39,  2.68s/it]Best trial: 43. Best value: 0.206263:  64%|██████▍   | 64/100 [02:21<01:35,  2.67s/it]Best trial: 43. Best value: 0.206263:  64%|██████▍   | 64/100 [02:24<01:35,  2.67s/it]Best trial: 43. Best value: 0.206263:  65%|██████▌   | 65/100 [02:24<01:31,  2.62s/it]Best trial: 43. Best value: 0.206263:  65%|██████▌   | 65/100 [02:27<01:31,  2.62s/it]Best trial: 43. Best value: 0.206263:  66%|██████▌   | 66/100 [02:27<01:33,  2.74s/it]Best trial: 43. Best value: 0.206263:  66%|██████▌   | 66/100 [02:29<01:33,  2.74s/it]Best trial: 43. Best value: 0.206263:  67%|██████▋   | 67/100 [02:29<01:25,  2.59s/it]Best trial: 43. Best value: 0.206263:  67%|██████▋   | 67/100 [02:32<01:25,  2.59s/it]Best trial: 43. Best value: 0.206263:  68%|██████▊   | 68/100 [02:32<01:25,  2.68s/it]Best trial: 43. Best value: 0.206263:  68%|██████▊   | 68/100 [02:34<01:25,  2.68s/it]Best trial: 43. Best value: 0.206263:  69%|██████▉   | 69/100 [02:34<01:16,  2.47s/it]Best trial: 43. Best value: 0.206263:  69%|██████▉   | 69/100 [02:36<01:16,  2.47s/it]Best trial: 43. Best value: 0.206263:  70%|███████   | 70/100 [02:36<01:14,  2.49s/it]Best trial: 43. Best value: 0.206263:  70%|███████   | 70/100 [02:39<01:14,  2.49s/it]Best trial: 43. Best value: 0.206263:  71%|███████   | 71/100 [02:39<01:12,  2.49s/it]Best trial: 43. Best value: 0.206263:  71%|███████   | 71/100 [02:42<01:12,  2.49s/it]Best trial: 43. Best value: 0.206263:  72%|███████▏  | 72/100 [02:42<01:13,  2.63s/it]Best trial: 43. Best value: 0.206263:  72%|███████▏  | 72/100 [02:45<01:13,  2.63s/it]Best trial: 43. Best value: 0.206263:  73%|███████▎  | 73/100 [02:45<01:13,  2.72s/it]Best trial: 43. Best value: 0.206263:  73%|███████▎  | 73/100 [02:47<01:13,  2.72s/it]Best trial: 43. Best value: 0.206263:  74%|███████▍  | 74/100 [02:47<01:09,  2.67s/it]Best trial: 43. Best value: 0.206263:  74%|███████▍  | 74/100 [02:50<01:09,  2.67s/it]Best trial: 43. Best value: 0.206263:  75%|███████▌  | 75/100 [02:50<01:06,  2.67s/it]Best trial: 43. Best value: 0.206263:  75%|███████▌  | 75/100 [02:53<01:06,  2.67s/it]Best trial: 43. Best value: 0.206263:  76%|███████▌  | 76/100 [02:53<01:06,  2.76s/it]Best trial: 43. Best value: 0.206263:  76%|███████▌  | 76/100 [02:56<01:06,  2.76s/it]Best trial: 43. Best value: 0.206263:  77%|███████▋  | 77/100 [02:56<01:07,  2.92s/it]Best trial: 43. Best value: 0.206263:  77%|███████▋  | 77/100 [02:58<01:07,  2.92s/it]Best trial: 43. Best value: 0.206263:  78%|███████▊  | 78/100 [02:58<01:00,  2.73s/it]Best trial: 43. Best value: 0.206263:  78%|███████▊  | 78/100 [03:01<01:00,  2.73s/it]Best trial: 43. Best value: 0.206263:  79%|███████▉  | 79/100 [03:01<00:59,  2.82s/it]Best trial: 43. Best value: 0.206263:  79%|███████▉  | 79/100 [03:04<00:59,  2.82s/it]Best trial: 43. Best value: 0.206263:  80%|████████  | 80/100 [03:04<00:53,  2.67s/it]Best trial: 43. Best value: 0.206263:  80%|████████  | 80/100 [03:06<00:53,  2.67s/it]Best trial: 43. Best value: 0.206263:  81%|████████  | 81/100 [03:06<00:50,  2.65s/it]Best trial: 43. Best value: 0.206263:  81%|████████  | 81/100 [03:09<00:50,  2.65s/it]Best trial: 43. Best value: 0.206263:  82%|████████▏ | 82/100 [03:09<00:47,  2.66s/it]Best trial: 43. Best value: 0.206263:  82%|████████▏ | 82/100 [03:12<00:47,  2.66s/it]Best trial: 43. Best value: 0.206263:  83%|████████▎ | 83/100 [03:12<00:45,  2.70s/it]Best trial: 43. Best value: 0.206263:  83%|████████▎ | 83/100 [03:14<00:45,  2.70s/it]Best trial: 43. Best value: 0.206263:  84%|████████▍ | 84/100 [03:14<00:41,  2.62s/it]Best trial: 84. Best value: 0.238582:  84%|████████▍ | 84/100 [03:18<00:41,  2.62s/it]Best trial: 84. Best value: 0.238582:  85%|████████▌ | 85/100 [03:18<00:42,  2.86s/it]Best trial: 84. Best value: 0.238582:  85%|████████▌ | 85/100 [03:20<00:42,  2.86s/it]Best trial: 84. Best value: 0.238582:  86%|████████▌ | 86/100 [03:20<00:37,  2.67s/it]Best trial: 84. Best value: 0.238582:  86%|████████▌ | 86/100 [03:23<00:37,  2.67s/it]Best trial: 84. Best value: 0.238582:  87%|████████▋ | 87/100 [03:23<00:34,  2.66s/it]Best trial: 84. Best value: 0.238582:  87%|████████▋ | 87/100 [03:25<00:34,  2.66s/it]Best trial: 84. Best value: 0.238582:  88%|████████▊ | 88/100 [03:25<00:29,  2.46s/it]Best trial: 84. Best value: 0.238582:  88%|████████▊ | 88/100 [03:27<00:29,  2.46s/it]Best trial: 84. Best value: 0.238582:  89%|████████▉ | 89/100 [03:27<00:27,  2.46s/it]Best trial: 84. Best value: 0.238582:  89%|████████▉ | 89/100 [03:29<00:27,  2.46s/it]Best trial: 84. Best value: 0.238582:  90%|█████████ | 90/100 [03:29<00:24,  2.45s/it]Best trial: 84. Best value: 0.238582:  90%|█████████ | 90/100 [03:33<00:24,  2.45s/it]Best trial: 84. Best value: 0.238582:  91%|█████████ | 91/100 [03:33<00:24,  2.73s/it]Best trial: 84. Best value: 0.238582:  91%|█████████ | 91/100 [03:36<00:24,  2.73s/it]Best trial: 84. Best value: 0.238582:  92%|█████████▏| 92/100 [03:36<00:23,  2.95s/it]Best trial: 84. Best value: 0.238582:  92%|█████████▏| 92/100 [03:38<00:23,  2.95s/it]Best trial: 84. Best value: 0.238582:  93%|█████████▎| 93/100 [03:38<00:18,  2.70s/it]Best trial: 84. Best value: 0.238582:  93%|█████████▎| 93/100 [03:41<00:18,  2.70s/it]Best trial: 84. Best value: 0.238582:  94%|█████████▍| 94/100 [03:41<00:16,  2.79s/it]Best trial: 84. Best value: 0.238582:  94%|█████████▍| 94/100 [03:44<00:16,  2.79s/it]Best trial: 84. Best value: 0.238582:  95%|█████████▌| 95/100 [03:44<00:13,  2.75s/it]Best trial: 84. Best value: 0.238582:  95%|█████████▌| 95/100 [03:46<00:13,  2.75s/it]Best trial: 84. Best value: 0.238582:  96%|█████████▌| 96/100 [03:46<00:10,  2.62s/it]Best trial: 84. Best value: 0.238582:  96%|█████████▌| 96/100 [03:49<00:10,  2.62s/it]Best trial: 84. Best value: 0.238582:  97%|█████████▋| 97/100 [03:49<00:07,  2.67s/it]Best trial: 84. Best value: 0.238582:  97%|█████████▋| 97/100 [03:51<00:07,  2.67s/it]Best trial: 84. Best value: 0.238582:  98%|█████████▊| 98/100 [03:51<00:05,  2.56s/it]Best trial: 84. Best value: 0.238582:  98%|█████████▊| 98/100 [03:55<00:05,  2.56s/it]Best trial: 84. Best value: 0.238582:  99%|█████████▉| 99/100 [03:55<00:02,  2.72s/it]Best trial: 84. Best value: 0.238582:  99%|█████████▉| 99/100 [03:58<00:02,  2.72s/it]Best trial: 84. Best value: 0.238582: 100%|██████████| 100/100 [03:58<00:00,  2.88s/it]Best trial: 84. Best value: 0.238582: 100%|██████████| 100/100 [03:58<00:00,  2.38s/it]
2025-11-30 15:07:32,328 - INFO - HPO Complete. Best AUPRC: 0.2386
2025-11-30 15:07:32,329 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.000186070222402308, 'max_depth': 8, 'subsample': 0.6203916976580374, 'colsample_bytree': 0.8686190886811389, 'gamma': 2.9172545644394465, 'reg_lambda': 1.3085455013562983e-07, 'reg_alpha': 5.313808460469706e-08}
2025-11-30 15:07:32,329 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:07:34,207 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 15:07:34,207 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:07:34,290 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:07:34,313 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:07:34,318 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:07:34,318 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:07:34,318 - INFO - Training model...
2025-11-30 15:07:35,769 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:07:41,050 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:07:41,050 - INFO - AUROC: 0.5312 (0.0788 - 0.7741)
2025-11-30 15:07:41,050 - INFO - AUPRC: 0.0132 (0.0046 - 0.0353)
2025-11-30 15:07:41,050 - INFO - Brier Score: 0.2260 (0.2257 - 0.2264)
2025-11-30 15:07:41,050 - INFO - Accuracy: 0.0087 (0.0038 - 0.0150)
2025-11-30 15:07:41,051 - INFO - Precision: 0.0087 (0.0038 - 0.0150)
2025-11-30 15:07:41,051 - INFO - Sensitivity (Recall): 1.0000 (1.0000 - 1.0000)
2025-11-30 15:07:41,051 - INFO - F1-Score: 0.0172 (0.0075 - 0.0296)
2025-11-30 15:07:41,051 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0100)
2025-11-30 15:07:41,051 - INFO - Specificity: 0.0000 (0.0000 - 0.0000)
2025-11-30 15:07:41,060 - INFO - Calculating SHAP values...
2025-11-30 15:07:42,040 - INFO - SHAP plots saved.
2025-11-30 15:07:42,040 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:07:43,205 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 15:07:43,205 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:07:43,289 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:07:43,312 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:07:43,318 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:07:43,318 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.104443:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.104443:   1%|          | 1/100 [00:02<03:42,  2.25s/it]Best trial: 1. Best value: 0.12837:   1%|          | 1/100 [00:03<03:42,  2.25s/it] Best trial: 1. Best value: 0.12837:   2%|▏         | 2/100 [00:03<02:49,  1.73s/it]Best trial: 1. Best value: 0.12837:   2%|▏         | 2/100 [00:05<02:49,  1.73s/it]Best trial: 1. Best value: 0.12837:   3%|▎         | 3/100 [00:05<02:54,  1.80s/it]Best trial: 1. Best value: 0.12837:   3%|▎         | 3/100 [00:07<02:54,  1.80s/it]Best trial: 1. Best value: 0.12837:   4%|▍         | 4/100 [00:07<03:05,  1.93s/it]Best trial: 1. Best value: 0.12837:   4%|▍         | 4/100 [00:09<03:05,  1.93s/it]Best trial: 1. Best value: 0.12837:   5%|▌         | 5/100 [00:09<03:04,  1.94s/it]Best trial: 1. Best value: 0.12837:   5%|▌         | 5/100 [00:11<03:04,  1.94s/it]Best trial: 1. Best value: 0.12837:   6%|▌         | 6/100 [00:11<03:02,  1.94s/it]Best trial: 1. Best value: 0.12837:   6%|▌         | 6/100 [00:12<03:02,  1.94s/it]Best trial: 1. Best value: 0.12837:   7%|▋         | 7/100 [00:12<02:40,  1.73s/it]Best trial: 1. Best value: 0.12837:   7%|▋         | 7/100 [00:15<02:40,  1.73s/it]Best trial: 1. Best value: 0.12837:   8%|▊         | 8/100 [00:15<02:55,  1.90s/it]Best trial: 1. Best value: 0.12837:   8%|▊         | 8/100 [00:16<02:55,  1.90s/it]Best trial: 1. Best value: 0.12837:   9%|▉         | 9/100 [00:16<02:47,  1.84s/it]Best trial: 1. Best value: 0.12837:   9%|▉         | 9/100 [00:18<02:47,  1.84s/it]Best trial: 1. Best value: 0.12837:  10%|█         | 10/100 [00:18<02:32,  1.69s/it]Best trial: 1. Best value: 0.12837:  10%|█         | 10/100 [00:20<02:32,  1.69s/it]Best trial: 1. Best value: 0.12837:  11%|█         | 11/100 [00:20<02:41,  1.81s/it]Best trial: 1. Best value: 0.12837:  11%|█         | 11/100 [00:22<02:41,  1.81s/it]Best trial: 1. Best value: 0.12837:  12%|█▏        | 12/100 [00:22<02:53,  1.97s/it]Best trial: 12. Best value: 0.131881:  12%|█▏        | 12/100 [00:25<02:53,  1.97s/it]Best trial: 12. Best value: 0.131881:  13%|█▎        | 13/100 [00:25<03:06,  2.15s/it]Best trial: 13. Best value: 0.15841:  13%|█▎        | 13/100 [00:26<03:06,  2.15s/it] Best trial: 13. Best value: 0.15841:  14%|█▍        | 14/100 [00:26<02:53,  2.02s/it]Best trial: 13. Best value: 0.15841:  14%|█▍        | 14/100 [00:29<02:53,  2.02s/it]Best trial: 13. Best value: 0.15841:  15%|█▌        | 15/100 [00:29<02:56,  2.07s/it]Best trial: 13. Best value: 0.15841:  15%|█▌        | 15/100 [00:32<02:56,  2.07s/it]Best trial: 13. Best value: 0.15841:  16%|█▌        | 16/100 [00:32<03:24,  2.44s/it]Best trial: 13. Best value: 0.15841:  16%|█▌        | 16/100 [00:34<03:24,  2.44s/it]Best trial: 13. Best value: 0.15841:  17%|█▋        | 17/100 [00:34<03:08,  2.27s/it]Best trial: 17. Best value: 0.185564:  17%|█▋        | 17/100 [00:36<03:08,  2.27s/it]Best trial: 17. Best value: 0.185564:  18%|█▊        | 18/100 [00:36<03:16,  2.40s/it]Best trial: 17. Best value: 0.185564:  18%|█▊        | 18/100 [00:38<03:16,  2.40s/it]Best trial: 17. Best value: 0.185564:  19%|█▉        | 19/100 [00:38<03:03,  2.26s/it]Best trial: 17. Best value: 0.185564:  19%|█▉        | 19/100 [00:42<03:03,  2.26s/it]Best trial: 17. Best value: 0.185564:  20%|██        | 20/100 [00:42<03:27,  2.59s/it]Best trial: 17. Best value: 0.185564:  20%|██        | 20/100 [00:43<03:27,  2.59s/it]Best trial: 17. Best value: 0.185564:  21%|██        | 21/100 [00:43<03:04,  2.34s/it]Best trial: 17. Best value: 0.185564:  21%|██        | 21/100 [00:47<03:04,  2.34s/it]Best trial: 17. Best value: 0.185564:  22%|██▏       | 22/100 [00:47<03:37,  2.79s/it]Best trial: 17. Best value: 0.185564:  22%|██▏       | 22/100 [00:51<03:37,  2.79s/it]Best trial: 17. Best value: 0.185564:  23%|██▎       | 23/100 [00:51<03:44,  2.91s/it]Best trial: 17. Best value: 0.185564:  23%|██▎       | 23/100 [00:53<03:44,  2.91s/it]Best trial: 17. Best value: 0.185564:  24%|██▍       | 24/100 [00:53<03:38,  2.87s/it]Best trial: 17. Best value: 0.185564:  24%|██▍       | 24/100 [00:55<03:38,  2.87s/it]Best trial: 17. Best value: 0.185564:  25%|██▌       | 25/100 [00:55<03:19,  2.67s/it]Best trial: 17. Best value: 0.185564:  25%|██▌       | 25/100 [00:58<03:19,  2.67s/it]Best trial: 17. Best value: 0.185564:  26%|██▌       | 26/100 [00:58<03:05,  2.50s/it]Best trial: 17. Best value: 0.185564:  26%|██▌       | 26/100 [01:00<03:05,  2.50s/it]Best trial: 17. Best value: 0.185564:  27%|██▋       | 27/100 [01:00<02:59,  2.46s/it]Best trial: 17. Best value: 0.185564:  27%|██▋       | 27/100 [01:02<02:59,  2.46s/it]Best trial: 17. Best value: 0.185564:  28%|██▊       | 28/100 [01:02<02:57,  2.47s/it]Best trial: 17. Best value: 0.185564:  28%|██▊       | 28/100 [01:05<02:57,  2.47s/it]Best trial: 17. Best value: 0.185564:  29%|██▉       | 29/100 [01:05<02:51,  2.42s/it]Best trial: 17. Best value: 0.185564:  29%|██▉       | 29/100 [01:07<02:51,  2.42s/it]Best trial: 17. Best value: 0.185564:  30%|███       | 30/100 [01:07<02:38,  2.26s/it]Best trial: 17. Best value: 0.185564:  30%|███       | 30/100 [01:09<02:38,  2.26s/it]Best trial: 17. Best value: 0.185564:  31%|███       | 31/100 [01:09<02:47,  2.43s/it]Best trial: 17. Best value: 0.185564:  31%|███       | 31/100 [01:11<02:47,  2.43s/it]Best trial: 17. Best value: 0.185564:  32%|███▏      | 32/100 [01:11<02:35,  2.29s/it]Best trial: 17. Best value: 0.185564:  32%|███▏      | 32/100 [01:13<02:35,  2.29s/it]Best trial: 17. Best value: 0.185564:  33%|███▎      | 33/100 [01:13<02:25,  2.17s/it]Best trial: 17. Best value: 0.185564:  33%|███▎      | 33/100 [01:15<02:25,  2.17s/it]Best trial: 17. Best value: 0.185564:  34%|███▍      | 34/100 [01:15<02:20,  2.13s/it]Best trial: 17. Best value: 0.185564:  34%|███▍      | 34/100 [01:17<02:20,  2.13s/it]Best trial: 17. Best value: 0.185564:  35%|███▌      | 35/100 [01:17<02:17,  2.12s/it]Best trial: 17. Best value: 0.185564:  35%|███▌      | 35/100 [01:20<02:17,  2.12s/it]Best trial: 17. Best value: 0.185564:  36%|███▌      | 36/100 [01:20<02:31,  2.36s/it]Best trial: 17. Best value: 0.185564:  36%|███▌      | 36/100 [01:23<02:31,  2.36s/it]Best trial: 17. Best value: 0.185564:  37%|███▋      | 37/100 [01:23<02:36,  2.49s/it]Best trial: 17. Best value: 0.185564:  37%|███▋      | 37/100 [01:26<02:36,  2.49s/it]Best trial: 17. Best value: 0.185564:  38%|███▊      | 38/100 [01:26<02:32,  2.46s/it]Best trial: 17. Best value: 0.185564:  38%|███▊      | 38/100 [01:28<02:32,  2.46s/it]Best trial: 17. Best value: 0.185564:  39%|███▉      | 39/100 [01:28<02:27,  2.41s/it]Best trial: 17. Best value: 0.185564:  39%|███▉      | 39/100 [01:30<02:27,  2.41s/it]Best trial: 17. Best value: 0.185564:  40%|████      | 40/100 [01:30<02:22,  2.37s/it]Best trial: 17. Best value: 0.185564:  40%|████      | 40/100 [01:32<02:22,  2.37s/it]Best trial: 17. Best value: 0.185564:  41%|████      | 41/100 [01:32<02:17,  2.32s/it]Best trial: 17. Best value: 0.185564:  41%|████      | 41/100 [01:34<02:17,  2.32s/it]Best trial: 17. Best value: 0.185564:  42%|████▏     | 42/100 [01:34<02:06,  2.19s/it]Best trial: 17. Best value: 0.185564:  42%|████▏     | 42/100 [01:36<02:06,  2.19s/it]Best trial: 17. Best value: 0.185564:  43%|████▎     | 43/100 [01:36<01:57,  2.06s/it]Best trial: 17. Best value: 0.185564:  43%|████▎     | 43/100 [01:38<01:57,  2.06s/it]Best trial: 17. Best value: 0.185564:  44%|████▍     | 44/100 [01:38<01:49,  1.95s/it]Best trial: 17. Best value: 0.185564:  44%|████▍     | 44/100 [01:40<01:49,  1.95s/it]Best trial: 17. Best value: 0.185564:  45%|████▌     | 45/100 [01:40<01:51,  2.03s/it]Best trial: 17. Best value: 0.185564:  45%|████▌     | 45/100 [01:41<01:51,  2.03s/it]Best trial: 17. Best value: 0.185564:  46%|████▌     | 46/100 [01:41<01:42,  1.90s/it]Best trial: 17. Best value: 0.185564:  46%|████▌     | 46/100 [01:44<01:42,  1.90s/it]Best trial: 17. Best value: 0.185564:  47%|████▋     | 47/100 [01:44<01:50,  2.09s/it]Best trial: 17. Best value: 0.185564:  47%|████▋     | 47/100 [01:46<01:50,  2.09s/it]Best trial: 17. Best value: 0.185564:  48%|████▊     | 48/100 [01:46<01:47,  2.06s/it]Best trial: 17. Best value: 0.185564:  48%|████▊     | 48/100 [01:49<01:47,  2.06s/it]Best trial: 17. Best value: 0.185564:  49%|████▉     | 49/100 [01:49<01:53,  2.23s/it]Best trial: 17. Best value: 0.185564:  49%|████▉     | 49/100 [01:51<01:53,  2.23s/it]Best trial: 17. Best value: 0.185564:  50%|█████     | 50/100 [01:51<01:48,  2.17s/it]Best trial: 17. Best value: 0.185564:  50%|█████     | 50/100 [01:53<01:48,  2.17s/it]Best trial: 17. Best value: 0.185564:  51%|█████     | 51/100 [01:53<01:44,  2.14s/it]Best trial: 17. Best value: 0.185564:  51%|█████     | 51/100 [01:54<01:44,  2.14s/it]Best trial: 17. Best value: 0.185564:  52%|█████▏    | 52/100 [01:54<01:36,  2.01s/it]Best trial: 17. Best value: 0.185564:  52%|█████▏    | 52/100 [01:56<01:36,  2.01s/it]Best trial: 17. Best value: 0.185564:  53%|█████▎    | 53/100 [01:56<01:31,  1.95s/it]Best trial: 17. Best value: 0.185564:  53%|█████▎    | 53/100 [01:58<01:31,  1.95s/it]Best trial: 17. Best value: 0.185564:  54%|█████▍    | 54/100 [01:58<01:31,  1.99s/it]Best trial: 17. Best value: 0.185564:  54%|█████▍    | 54/100 [02:00<01:31,  1.99s/it]Best trial: 17. Best value: 0.185564:  55%|█████▌    | 55/100 [02:00<01:29,  2.00s/it]Best trial: 17. Best value: 0.185564:  55%|█████▌    | 55/100 [02:03<01:29,  2.00s/it]Best trial: 17. Best value: 0.185564:  56%|█████▌    | 56/100 [02:03<01:31,  2.09s/it]Best trial: 17. Best value: 0.185564:  56%|█████▌    | 56/100 [02:05<01:31,  2.09s/it]Best trial: 17. Best value: 0.185564:  57%|█████▋    | 57/100 [02:05<01:37,  2.26s/it]Best trial: 17. Best value: 0.185564:  57%|█████▋    | 57/100 [02:08<01:37,  2.26s/it]Best trial: 17. Best value: 0.185564:  58%|█████▊    | 58/100 [02:08<01:39,  2.36s/it]Best trial: 17. Best value: 0.185564:  58%|█████▊    | 58/100 [02:10<01:39,  2.36s/it]Best trial: 17. Best value: 0.185564:  59%|█████▉    | 59/100 [02:10<01:39,  2.43s/it]Best trial: 17. Best value: 0.185564:  59%|█████▉    | 59/100 [02:12<01:39,  2.43s/it]Best trial: 17. Best value: 0.185564:  60%|██████    | 60/100 [02:12<01:30,  2.25s/it]Best trial: 17. Best value: 0.185564:  60%|██████    | 60/100 [02:15<01:30,  2.25s/it]Best trial: 17. Best value: 0.185564:  61%|██████    | 61/100 [02:15<01:27,  2.24s/it]Best trial: 17. Best value: 0.185564:  61%|██████    | 61/100 [02:17<01:27,  2.24s/it]Best trial: 17. Best value: 0.185564:  62%|██████▏   | 62/100 [02:17<01:28,  2.33s/it]Best trial: 17. Best value: 0.185564:  62%|██████▏   | 62/100 [02:20<01:28,  2.33s/it]Best trial: 17. Best value: 0.185564:  63%|██████▎   | 63/100 [02:20<01:31,  2.48s/it]Best trial: 17. Best value: 0.185564:  63%|██████▎   | 63/100 [02:23<01:31,  2.48s/it]Best trial: 17. Best value: 0.185564:  64%|██████▍   | 64/100 [02:23<01:32,  2.58s/it]Best trial: 17. Best value: 0.185564:  64%|██████▍   | 64/100 [02:26<01:32,  2.58s/it]Best trial: 17. Best value: 0.185564:  65%|██████▌   | 65/100 [02:26<01:36,  2.75s/it]Best trial: 17. Best value: 0.185564:  65%|██████▌   | 65/100 [02:28<01:36,  2.75s/it]Best trial: 17. Best value: 0.185564:  66%|██████▌   | 66/100 [02:28<01:31,  2.68s/it]Best trial: 17. Best value: 0.185564:  66%|██████▌   | 66/100 [02:31<01:31,  2.68s/it]Best trial: 17. Best value: 0.185564:  67%|██████▋   | 67/100 [02:31<01:27,  2.65s/it]Best trial: 17. Best value: 0.185564:  67%|██████▋   | 67/100 [02:34<01:27,  2.65s/it]Best trial: 17. Best value: 0.185564:  68%|██████▊   | 68/100 [02:34<01:31,  2.85s/it]Best trial: 17. Best value: 0.185564:  68%|██████▊   | 68/100 [02:37<01:31,  2.85s/it]Best trial: 17. Best value: 0.185564:  69%|██████▉   | 69/100 [02:37<01:27,  2.81s/it]Best trial: 17. Best value: 0.185564:  69%|██████▉   | 69/100 [02:40<01:27,  2.81s/it]Best trial: 17. Best value: 0.185564:  70%|███████   | 70/100 [02:40<01:26,  2.89s/it]Best trial: 17. Best value: 0.185564:  70%|███████   | 70/100 [02:43<01:26,  2.89s/it]Best trial: 17. Best value: 0.185564:  71%|███████   | 71/100 [02:43<01:22,  2.85s/it]Best trial: 17. Best value: 0.185564:  71%|███████   | 71/100 [02:46<01:22,  2.85s/it]Best trial: 17. Best value: 0.185564:  72%|███████▏  | 72/100 [02:46<01:19,  2.84s/it]Best trial: 17. Best value: 0.185564:  72%|███████▏  | 72/100 [02:49<01:19,  2.84s/it]Best trial: 17. Best value: 0.185564:  73%|███████▎  | 73/100 [02:49<01:20,  2.98s/it]Best trial: 17. Best value: 0.185564:  73%|███████▎  | 73/100 [02:51<01:20,  2.98s/it]Best trial: 17. Best value: 0.185564:  74%|███████▍  | 74/100 [02:51<01:11,  2.76s/it]Best trial: 17. Best value: 0.185564:  74%|███████▍  | 74/100 [02:54<01:11,  2.76s/it]Best trial: 17. Best value: 0.185564:  75%|███████▌  | 75/100 [02:54<01:10,  2.84s/it]Best trial: 17. Best value: 0.185564:  75%|███████▌  | 75/100 [02:57<01:10,  2.84s/it]Best trial: 17. Best value: 0.185564:  76%|███████▌  | 76/100 [02:57<01:04,  2.70s/it]Best trial: 17. Best value: 0.185564:  76%|███████▌  | 76/100 [02:59<01:04,  2.70s/it]Best trial: 17. Best value: 0.185564:  77%|███████▋  | 77/100 [02:59<01:00,  2.62s/it]Best trial: 17. Best value: 0.185564:  77%|███████▋  | 77/100 [03:02<01:00,  2.62s/it]Best trial: 17. Best value: 0.185564:  78%|███████▊  | 78/100 [03:02<00:56,  2.59s/it]Best trial: 17. Best value: 0.185564:  78%|███████▊  | 78/100 [03:04<00:56,  2.59s/it]Best trial: 17. Best value: 0.185564:  79%|███████▉  | 79/100 [03:04<00:54,  2.60s/it]Best trial: 17. Best value: 0.185564:  79%|███████▉  | 79/100 [03:07<00:54,  2.60s/it]Best trial: 17. Best value: 0.185564:  80%|████████  | 80/100 [03:07<00:52,  2.63s/it]Best trial: 17. Best value: 0.185564:  80%|████████  | 80/100 [03:09<00:52,  2.63s/it]Best trial: 17. Best value: 0.185564:  81%|████████  | 81/100 [03:09<00:49,  2.59s/it]Best trial: 17. Best value: 0.185564:  81%|████████  | 81/100 [03:12<00:49,  2.59s/it]Best trial: 17. Best value: 0.185564:  82%|████████▏ | 82/100 [03:12<00:46,  2.56s/it]Best trial: 17. Best value: 0.185564:  82%|████████▏ | 82/100 [03:14<00:46,  2.56s/it]Best trial: 17. Best value: 0.185564:  83%|████████▎ | 83/100 [03:14<00:41,  2.45s/it]Best trial: 17. Best value: 0.185564:  83%|████████▎ | 83/100 [03:16<00:41,  2.45s/it]Best trial: 17. Best value: 0.185564:  84%|████████▍ | 84/100 [03:16<00:38,  2.43s/it]Best trial: 17. Best value: 0.185564:  84%|████████▍ | 84/100 [03:18<00:38,  2.43s/it]Best trial: 17. Best value: 0.185564:  85%|████████▌ | 85/100 [03:18<00:34,  2.29s/it]Best trial: 17. Best value: 0.185564:  85%|████████▌ | 85/100 [03:21<00:34,  2.29s/it]Best trial: 17. Best value: 0.185564:  86%|████████▌ | 86/100 [03:21<00:34,  2.45s/it]Best trial: 17. Best value: 0.185564:  86%|████████▌ | 86/100 [03:23<00:34,  2.45s/it]Best trial: 17. Best value: 0.185564:  87%|████████▋ | 87/100 [03:23<00:28,  2.20s/it]Best trial: 17. Best value: 0.185564:  87%|████████▋ | 87/100 [03:26<00:28,  2.20s/it]Best trial: 17. Best value: 0.185564:  88%|████████▊ | 88/100 [03:26<00:28,  2.40s/it]Best trial: 17. Best value: 0.185564:  88%|████████▊ | 88/100 [03:28<00:28,  2.40s/it]Best trial: 17. Best value: 0.185564:  89%|████████▉ | 89/100 [03:28<00:26,  2.38s/it]Best trial: 17. Best value: 0.185564:  89%|████████▉ | 89/100 [03:30<00:26,  2.38s/it]Best trial: 17. Best value: 0.185564:  90%|█████████ | 90/100 [03:30<00:22,  2.25s/it]Best trial: 17. Best value: 0.185564:  90%|█████████ | 90/100 [03:32<00:22,  2.25s/it]Best trial: 17. Best value: 0.185564:  91%|█████████ | 91/100 [03:32<00:20,  2.30s/it]Best trial: 17. Best value: 0.185564:  91%|█████████ | 91/100 [03:35<00:20,  2.30s/it]Best trial: 17. Best value: 0.185564:  92%|█████████▏| 92/100 [03:35<00:19,  2.38s/it]Best trial: 17. Best value: 0.185564:  92%|█████████▏| 92/100 [03:38<00:19,  2.38s/it]Best trial: 17. Best value: 0.185564:  93%|█████████▎| 93/100 [03:38<00:18,  2.59s/it]Best trial: 93. Best value: 0.200694:  93%|█████████▎| 93/100 [03:40<00:18,  2.59s/it]Best trial: 93. Best value: 0.200694:  94%|█████████▍| 94/100 [03:40<00:14,  2.45s/it]Best trial: 93. Best value: 0.200694:  94%|█████████▍| 94/100 [03:43<00:14,  2.45s/it]Best trial: 93. Best value: 0.200694:  95%|█████████▌| 95/100 [03:43<00:13,  2.68s/it]Best trial: 93. Best value: 0.200694:  95%|█████████▌| 95/100 [03:45<00:13,  2.68s/it]Best trial: 93. Best value: 0.200694:  96%|█████████▌| 96/100 [03:45<00:09,  2.42s/it]Best trial: 93. Best value: 0.200694:  96%|█████████▌| 96/100 [03:47<00:09,  2.42s/it]Best trial: 93. Best value: 0.200694:  97%|█████████▋| 97/100 [03:47<00:06,  2.31s/it]Best trial: 93. Best value: 0.200694:  97%|█████████▋| 97/100 [03:50<00:06,  2.31s/it]Best trial: 93. Best value: 0.200694:  98%|█████████▊| 98/100 [03:50<00:04,  2.49s/it]Best trial: 93. Best value: 0.200694:  98%|█████████▊| 98/100 [03:52<00:04,  2.49s/it]Best trial: 93. Best value: 0.200694:  99%|█████████▉| 99/100 [03:52<00:02,  2.39s/it]Best trial: 93. Best value: 0.200694:  99%|█████████▉| 99/100 [03:55<00:02,  2.39s/it]Best trial: 93. Best value: 0.200694: 100%|██████████| 100/100 [03:55<00:00,  2.53s/it]Best trial: 93. Best value: 0.200694: 100%|██████████| 100/100 [03:55<00:00,  2.36s/it]
2025-11-30 15:11:38,967 - INFO - HPO Complete. Best AUPRC: 0.2007
2025-11-30 15:11:38,967 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.0001597179440314515, 'max_depth': 4, 'subsample': 0.6851359778275335, 'colsample_bytree': 0.6440425828010745, 'gamma': 3.9610854200802033, 'reg_lambda': 3.0937222574036874e-08, 'reg_alpha': 2.350040469277068e-06}
2025-11-30 15:11:38,968 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:11:40,889 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 15:11:40,889 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:11:40,973 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:11:40,996 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:11:41,001 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:11:41,001 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:11:41,001 - INFO - Training model...
2025-11-30 15:11:41,975 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:11:47,180 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:11:47,180 - INFO - AUROC: 0.7221 (0.3829 - 0.8770)
2025-11-30 15:11:47,180 - INFO - AUPRC: 0.0362 (0.0120 - 0.1104)
2025-11-30 15:11:47,180 - INFO - Brier Score: 0.2328 (0.2326 - 0.2332)
2025-11-30 15:11:47,180 - INFO - Accuracy: 0.9480 (0.0043 - 0.9572)
2025-11-30 15:11:47,180 - INFO - Precision: 0.0588 (0.0043 - 0.1283)
2025-11-30 15:11:47,180 - INFO - Sensitivity (Recall): 0.3333 (0.1067 - 1.0000)
2025-11-30 15:11:47,180 - INFO - F1-Score: 0.1000 (0.0086 - 0.2100)
2025-11-30 15:11:47,180 - INFO - Best Threshold: 0.4900 (0.0100 - 0.4900)
2025-11-30 15:11:47,180 - INFO - Specificity: 0.9534 (0.0000 - 0.9633)
2025-11-30 15:11:47,190 - INFO - Calculating SHAP values...
2025-11-30 15:11:48,130 - INFO - SHAP plots saved.
2025-11-30 15:11:48,131 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:11:49,703 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 15:11:49,704 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:11:49,797 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:11:49,821 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:11:49,827 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:11:49,828 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0817535:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0817535:   1%|          | 1/100 [00:01<03:00,  1.82s/it]Best trial: 1. Best value: 0.14307:   1%|          | 1/100 [00:03<03:00,  1.82s/it]  Best trial: 1. Best value: 0.14307:   2%|▏         | 2/100 [00:03<02:39,  1.63s/it]Best trial: 1. Best value: 0.14307:   2%|▏         | 2/100 [00:05<02:39,  1.63s/it]Best trial: 1. Best value: 0.14307:   3%|▎         | 3/100 [00:05<03:00,  1.86s/it]Best trial: 1. Best value: 0.14307:   3%|▎         | 3/100 [00:07<03:00,  1.86s/it]Best trial: 1. Best value: 0.14307:   4%|▍         | 4/100 [00:07<02:57,  1.85s/it]Best trial: 1. Best value: 0.14307:   4%|▍         | 4/100 [00:09<02:57,  1.85s/it]Best trial: 1. Best value: 0.14307:   5%|▌         | 5/100 [00:09<02:59,  1.89s/it]Best trial: 1. Best value: 0.14307:   5%|▌         | 5/100 [00:10<02:59,  1.89s/it]Best trial: 1. Best value: 0.14307:   6%|▌         | 6/100 [00:10<02:41,  1.72s/it]Best trial: 1. Best value: 0.14307:   6%|▌         | 6/100 [00:13<02:41,  1.72s/it]Best trial: 1. Best value: 0.14307:   7%|▋         | 7/100 [00:13<03:17,  2.12s/it]Best trial: 1. Best value: 0.14307:   7%|▋         | 7/100 [00:16<03:17,  2.12s/it]Best trial: 1. Best value: 0.14307:   8%|▊         | 8/100 [00:16<03:25,  2.24s/it]Best trial: 1. Best value: 0.14307:   8%|▊         | 8/100 [00:17<03:25,  2.24s/it]Best trial: 1. Best value: 0.14307:   9%|▉         | 9/100 [00:17<02:56,  1.94s/it]Best trial: 1. Best value: 0.14307:   9%|▉         | 9/100 [00:19<02:56,  1.94s/it]Best trial: 1. Best value: 0.14307:  10%|█         | 10/100 [00:19<02:55,  1.95s/it]Best trial: 1. Best value: 0.14307:  10%|█         | 10/100 [00:22<02:55,  1.95s/it]Best trial: 1. Best value: 0.14307:  11%|█         | 11/100 [00:22<03:21,  2.26s/it]Best trial: 1. Best value: 0.14307:  11%|█         | 11/100 [00:24<03:21,  2.26s/it]Best trial: 1. Best value: 0.14307:  12%|█▏        | 12/100 [00:24<03:24,  2.32s/it]Best trial: 1. Best value: 0.14307:  12%|█▏        | 12/100 [00:27<03:24,  2.32s/it]Best trial: 1. Best value: 0.14307:  13%|█▎        | 13/100 [00:27<03:24,  2.36s/it]Best trial: 1. Best value: 0.14307:  13%|█▎        | 13/100 [00:28<03:24,  2.36s/it]Best trial: 1. Best value: 0.14307:  14%|█▍        | 14/100 [00:28<03:07,  2.18s/it]Best trial: 1. Best value: 0.14307:  14%|█▍        | 14/100 [00:30<03:07,  2.18s/it]Best trial: 1. Best value: 0.14307:  15%|█▌        | 15/100 [00:30<02:57,  2.09s/it]Best trial: 1. Best value: 0.14307:  15%|█▌        | 15/100 [00:32<02:57,  2.09s/it]Best trial: 1. Best value: 0.14307:  16%|█▌        | 16/100 [00:32<02:56,  2.10s/it]Best trial: 16. Best value: 0.176112:  16%|█▌        | 16/100 [00:34<02:56,  2.10s/it]Best trial: 16. Best value: 0.176112:  17%|█▋        | 17/100 [00:34<02:39,  1.93s/it]Best trial: 17. Best value: 0.202626:  17%|█▋        | 17/100 [00:36<02:39,  1.93s/it]Best trial: 17. Best value: 0.202626:  18%|█▊        | 18/100 [00:36<02:33,  1.87s/it]Best trial: 17. Best value: 0.202626:  18%|█▊        | 18/100 [00:37<02:33,  1.87s/it]Best trial: 17. Best value: 0.202626:  19%|█▉        | 19/100 [00:37<02:23,  1.77s/it]Best trial: 17. Best value: 0.202626:  19%|█▉        | 19/100 [00:39<02:23,  1.77s/it]Best trial: 17. Best value: 0.202626:  20%|██        | 20/100 [00:39<02:14,  1.68s/it]Best trial: 17. Best value: 0.202626:  20%|██        | 20/100 [00:41<02:14,  1.68s/it]Best trial: 17. Best value: 0.202626:  21%|██        | 21/100 [00:41<02:24,  1.83s/it]Best trial: 17. Best value: 0.202626:  21%|██        | 21/100 [00:43<02:24,  1.83s/it]Best trial: 17. Best value: 0.202626:  22%|██▏       | 22/100 [00:43<02:19,  1.79s/it]Best trial: 17. Best value: 0.202626:  22%|██▏       | 22/100 [00:44<02:19,  1.79s/it]Best trial: 17. Best value: 0.202626:  23%|██▎       | 23/100 [00:44<02:16,  1.77s/it]Best trial: 17. Best value: 0.202626:  23%|██▎       | 23/100 [00:46<02:16,  1.77s/it]Best trial: 17. Best value: 0.202626:  24%|██▍       | 24/100 [00:46<02:19,  1.84s/it]Best trial: 17. Best value: 0.202626:  24%|██▍       | 24/100 [00:48<02:19,  1.84s/it]Best trial: 17. Best value: 0.202626:  25%|██▌       | 25/100 [00:48<02:19,  1.85s/it]Best trial: 17. Best value: 0.202626:  25%|██▌       | 25/100 [00:52<02:19,  1.85s/it]Best trial: 17. Best value: 0.202626:  26%|██▌       | 26/100 [00:52<02:53,  2.35s/it]Best trial: 17. Best value: 0.202626:  26%|██▌       | 26/100 [00:54<02:53,  2.35s/it]Best trial: 17. Best value: 0.202626:  27%|██▋       | 27/100 [00:54<02:48,  2.30s/it]Best trial: 17. Best value: 0.202626:  27%|██▋       | 27/100 [00:56<02:48,  2.30s/it]Best trial: 17. Best value: 0.202626:  28%|██▊       | 28/100 [00:56<02:36,  2.18s/it]Best trial: 17. Best value: 0.202626:  28%|██▊       | 28/100 [00:58<02:36,  2.18s/it]Best trial: 17. Best value: 0.202626:  29%|██▉       | 29/100 [00:58<02:31,  2.13s/it]Best trial: 17. Best value: 0.202626:  29%|██▉       | 29/100 [01:00<02:31,  2.13s/it]Best trial: 17. Best value: 0.202626:  30%|███       | 30/100 [01:00<02:32,  2.17s/it]Best trial: 17. Best value: 0.202626:  30%|███       | 30/100 [01:02<02:32,  2.17s/it]Best trial: 17. Best value: 0.202626:  31%|███       | 31/100 [01:02<02:34,  2.23s/it]Best trial: 17. Best value: 0.202626:  31%|███       | 31/100 [01:04<02:34,  2.23s/it]Best trial: 17. Best value: 0.202626:  32%|███▏      | 32/100 [01:04<02:20,  2.07s/it]Best trial: 17. Best value: 0.202626:  32%|███▏      | 32/100 [01:06<02:20,  2.07s/it]Best trial: 17. Best value: 0.202626:  33%|███▎      | 33/100 [01:06<02:20,  2.10s/it]Best trial: 17. Best value: 0.202626:  33%|███▎      | 33/100 [01:08<02:20,  2.10s/it]Best trial: 17. Best value: 0.202626:  34%|███▍      | 34/100 [01:08<02:15,  2.05s/it]Best trial: 17. Best value: 0.202626:  34%|███▍      | 34/100 [01:10<02:15,  2.05s/it]Best trial: 17. Best value: 0.202626:  35%|███▌      | 35/100 [01:10<02:09,  1.99s/it]Best trial: 17. Best value: 0.202626:  35%|███▌      | 35/100 [01:13<02:09,  1.99s/it]Best trial: 17. Best value: 0.202626:  36%|███▌      | 36/100 [01:13<02:16,  2.13s/it]Best trial: 17. Best value: 0.202626:  36%|███▌      | 36/100 [01:15<02:16,  2.13s/it]Best trial: 17. Best value: 0.202626:  37%|███▋      | 37/100 [01:15<02:10,  2.07s/it]Best trial: 17. Best value: 0.202626:  37%|███▋      | 37/100 [01:17<02:10,  2.07s/it]Best trial: 17. Best value: 0.202626:  38%|███▊      | 38/100 [01:17<02:11,  2.12s/it]Best trial: 17. Best value: 0.202626:  38%|███▊      | 38/100 [01:19<02:11,  2.12s/it]Best trial: 17. Best value: 0.202626:  39%|███▉      | 39/100 [01:19<02:18,  2.27s/it]Best trial: 17. Best value: 0.202626:  39%|███▉      | 39/100 [01:22<02:18,  2.27s/it]Best trial: 17. Best value: 0.202626:  40%|████      | 40/100 [01:22<02:16,  2.27s/it]Best trial: 17. Best value: 0.202626:  40%|████      | 40/100 [01:24<02:16,  2.27s/it]Best trial: 17. Best value: 0.202626:  41%|████      | 41/100 [01:24<02:13,  2.26s/it]Best trial: 17. Best value: 0.202626:  41%|████      | 41/100 [01:26<02:13,  2.26s/it]Best trial: 17. Best value: 0.202626:  42%|████▏     | 42/100 [01:26<02:01,  2.10s/it]Best trial: 17. Best value: 0.202626:  42%|████▏     | 42/100 [01:27<02:01,  2.10s/it]Best trial: 17. Best value: 0.202626:  43%|████▎     | 43/100 [01:27<01:54,  2.00s/it]Best trial: 17. Best value: 0.202626:  43%|████▎     | 43/100 [01:29<01:54,  2.00s/it]Best trial: 17. Best value: 0.202626:  44%|████▍     | 44/100 [01:29<01:52,  2.02s/it]Best trial: 44. Best value: 0.212103:  44%|████▍     | 44/100 [01:31<01:52,  2.02s/it]Best trial: 44. Best value: 0.212103:  45%|████▌     | 45/100 [01:31<01:50,  2.00s/it]Best trial: 44. Best value: 0.212103:  45%|████▌     | 45/100 [01:33<01:50,  2.00s/it]Best trial: 44. Best value: 0.212103:  46%|████▌     | 46/100 [01:33<01:47,  1.99s/it]Best trial: 44. Best value: 0.212103:  46%|████▌     | 46/100 [01:35<01:47,  1.99s/it]Best trial: 44. Best value: 0.212103:  47%|████▋     | 47/100 [01:35<01:42,  1.93s/it]Best trial: 44. Best value: 0.212103:  47%|████▋     | 47/100 [01:38<01:42,  1.93s/it]Best trial: 44. Best value: 0.212103:  48%|████▊     | 48/100 [01:38<01:49,  2.10s/it]Best trial: 44. Best value: 0.212103:  48%|████▊     | 48/100 [01:39<01:49,  2.10s/it]Best trial: 44. Best value: 0.212103:  49%|████▉     | 49/100 [01:39<01:42,  2.00s/it]Best trial: 44. Best value: 0.212103:  49%|████▉     | 49/100 [01:41<01:42,  2.00s/it]Best trial: 44. Best value: 0.212103:  50%|█████     | 50/100 [01:41<01:40,  2.02s/it]Best trial: 44. Best value: 0.212103:  50%|█████     | 50/100 [01:43<01:40,  2.02s/it]Best trial: 44. Best value: 0.212103:  51%|█████     | 51/100 [01:43<01:35,  1.94s/it]Best trial: 44. Best value: 0.212103:  51%|█████     | 51/100 [01:45<01:35,  1.94s/it]Best trial: 44. Best value: 0.212103:  52%|█████▏    | 52/100 [01:45<01:30,  1.89s/it]Best trial: 44. Best value: 0.212103:  52%|█████▏    | 52/100 [01:47<01:30,  1.89s/it]Best trial: 44. Best value: 0.212103:  53%|█████▎    | 53/100 [01:47<01:28,  1.89s/it]Best trial: 44. Best value: 0.212103:  53%|█████▎    | 53/100 [01:50<01:28,  1.89s/it]Best trial: 44. Best value: 0.212103:  54%|█████▍    | 54/100 [01:50<01:37,  2.13s/it]Best trial: 44. Best value: 0.212103:  54%|█████▍    | 54/100 [01:51<01:37,  2.13s/it]Best trial: 44. Best value: 0.212103:  55%|█████▌    | 55/100 [01:51<01:31,  2.04s/it]Best trial: 44. Best value: 0.212103:  55%|█████▌    | 55/100 [01:54<01:31,  2.04s/it]Best trial: 44. Best value: 0.212103:  56%|█████▌    | 56/100 [01:54<01:37,  2.20s/it]Best trial: 44. Best value: 0.212103:  56%|█████▌    | 56/100 [01:56<01:37,  2.20s/it]Best trial: 44. Best value: 0.212103:  57%|█████▋    | 57/100 [01:56<01:31,  2.12s/it]Best trial: 44. Best value: 0.212103:  57%|█████▋    | 57/100 [01:58<01:31,  2.12s/it]Best trial: 44. Best value: 0.212103:  58%|█████▊    | 58/100 [01:58<01:28,  2.10s/it]Best trial: 44. Best value: 0.212103:  58%|█████▊    | 58/100 [02:00<01:28,  2.10s/it]Best trial: 44. Best value: 0.212103:  59%|█████▉    | 59/100 [02:00<01:26,  2.10s/it]Best trial: 44. Best value: 0.212103:  59%|█████▉    | 59/100 [02:02<01:26,  2.10s/it]Best trial: 44. Best value: 0.212103:  60%|██████    | 60/100 [02:02<01:23,  2.08s/it]Best trial: 44. Best value: 0.212103:  60%|██████    | 60/100 [02:04<01:23,  2.08s/it]Best trial: 44. Best value: 0.212103:  61%|██████    | 61/100 [02:04<01:20,  2.06s/it]Best trial: 44. Best value: 0.212103:  61%|██████    | 61/100 [02:07<01:20,  2.06s/it]Best trial: 44. Best value: 0.212103:  62%|██████▏   | 62/100 [02:07<01:22,  2.18s/it]Best trial: 44. Best value: 0.212103:  62%|██████▏   | 62/100 [02:08<01:22,  2.18s/it]Best trial: 44. Best value: 0.212103:  63%|██████▎   | 63/100 [02:08<01:15,  2.04s/it]Best trial: 44. Best value: 0.212103:  63%|██████▎   | 63/100 [02:10<01:15,  2.04s/it]Best trial: 44. Best value: 0.212103:  64%|██████▍   | 64/100 [02:10<01:10,  1.97s/it]Best trial: 44. Best value: 0.212103:  64%|██████▍   | 64/100 [02:12<01:10,  1.97s/it]Best trial: 44. Best value: 0.212103:  65%|██████▌   | 65/100 [02:12<01:06,  1.91s/it]Best trial: 44. Best value: 0.212103:  65%|██████▌   | 65/100 [02:14<01:06,  1.91s/it]Best trial: 44. Best value: 0.212103:  66%|██████▌   | 66/100 [02:14<01:05,  1.94s/it]Best trial: 44. Best value: 0.212103:  66%|██████▌   | 66/100 [02:16<01:05,  1.94s/it]Best trial: 44. Best value: 0.212103:  67%|██████▋   | 67/100 [02:16<01:01,  1.87s/it]Best trial: 44. Best value: 0.212103:  67%|██████▋   | 67/100 [02:17<01:01,  1.87s/it]Best trial: 44. Best value: 0.212103:  68%|██████▊   | 68/100 [02:17<00:59,  1.87s/it]Best trial: 44. Best value: 0.212103:  68%|██████▊   | 68/100 [02:20<00:59,  1.87s/it]Best trial: 44. Best value: 0.212103:  69%|██████▉   | 69/100 [02:20<01:00,  1.95s/it]Best trial: 44. Best value: 0.212103:  69%|██████▉   | 69/100 [02:22<01:00,  1.95s/it]Best trial: 44. Best value: 0.212103:  70%|███████   | 70/100 [02:22<00:58,  1.96s/it]Best trial: 44. Best value: 0.212103:  70%|███████   | 70/100 [02:23<00:58,  1.96s/it]Best trial: 44. Best value: 0.212103:  71%|███████   | 71/100 [02:23<00:53,  1.84s/it]Best trial: 44. Best value: 0.212103:  71%|███████   | 71/100 [02:25<00:53,  1.84s/it]Best trial: 44. Best value: 0.212103:  72%|███████▏  | 72/100 [02:25<00:51,  1.83s/it]Best trial: 44. Best value: 0.212103:  72%|███████▏  | 72/100 [02:27<00:51,  1.83s/it]Best trial: 44. Best value: 0.212103:  73%|███████▎  | 73/100 [02:27<00:50,  1.87s/it]Best trial: 44. Best value: 0.212103:  73%|███████▎  | 73/100 [02:29<00:50,  1.87s/it]Best trial: 44. Best value: 0.212103:  74%|███████▍  | 74/100 [02:29<00:48,  1.86s/it]Best trial: 44. Best value: 0.212103:  74%|███████▍  | 74/100 [02:31<00:48,  1.86s/it]Best trial: 44. Best value: 0.212103:  75%|███████▌  | 75/100 [02:31<00:52,  2.09s/it]Best trial: 44. Best value: 0.212103:  75%|███████▌  | 75/100 [02:33<00:52,  2.09s/it]Best trial: 44. Best value: 0.212103:  76%|███████▌  | 76/100 [02:33<00:47,  1.97s/it]Best trial: 44. Best value: 0.212103:  76%|███████▌  | 76/100 [02:35<00:47,  1.97s/it]Best trial: 44. Best value: 0.212103:  77%|███████▋  | 77/100 [02:35<00:45,  1.97s/it]Best trial: 44. Best value: 0.212103:  77%|███████▋  | 77/100 [02:37<00:45,  1.97s/it]Best trial: 44. Best value: 0.212103:  78%|███████▊  | 78/100 [02:37<00:42,  1.95s/it]Best trial: 44. Best value: 0.212103:  78%|███████▊  | 78/100 [02:38<00:42,  1.95s/it]Best trial: 44. Best value: 0.212103:  79%|███████▉  | 79/100 [02:38<00:38,  1.82s/it]Best trial: 44. Best value: 0.212103:  79%|███████▉  | 79/100 [02:40<00:38,  1.82s/it]Best trial: 44. Best value: 0.212103:  80%|████████  | 80/100 [02:40<00:37,  1.86s/it]Best trial: 44. Best value: 0.212103:  80%|████████  | 80/100 [02:42<00:37,  1.86s/it]Best trial: 44. Best value: 0.212103:  81%|████████  | 81/100 [02:42<00:34,  1.83s/it]Best trial: 44. Best value: 0.212103:  81%|████████  | 81/100 [02:44<00:34,  1.83s/it]Best trial: 44. Best value: 0.212103:  82%|████████▏ | 82/100 [02:44<00:32,  1.78s/it]Best trial: 44. Best value: 0.212103:  82%|████████▏ | 82/100 [02:46<00:32,  1.78s/it]Best trial: 44. Best value: 0.212103:  83%|████████▎ | 83/100 [02:46<00:33,  1.98s/it]Best trial: 44. Best value: 0.212103:  83%|████████▎ | 83/100 [02:48<00:33,  1.98s/it]Best trial: 44. Best value: 0.212103:  84%|████████▍ | 84/100 [02:48<00:30,  1.94s/it]Best trial: 44. Best value: 0.212103:  84%|████████▍ | 84/100 [02:50<00:30,  1.94s/it]Best trial: 44. Best value: 0.212103:  85%|████████▌ | 85/100 [02:50<00:30,  2.01s/it]Best trial: 44. Best value: 0.212103:  85%|████████▌ | 85/100 [02:52<00:30,  2.01s/it]Best trial: 44. Best value: 0.212103:  86%|████████▌ | 86/100 [02:52<00:27,  1.95s/it]Best trial: 44. Best value: 0.212103:  86%|████████▌ | 86/100 [02:53<00:27,  1.95s/it]Best trial: 44. Best value: 0.212103:  87%|████████▋ | 87/100 [02:53<00:23,  1.79s/it]Best trial: 44. Best value: 0.212103:  87%|████████▋ | 87/100 [02:56<00:23,  1.79s/it]Best trial: 44. Best value: 0.212103:  88%|████████▊ | 88/100 [02:56<00:23,  1.96s/it]Best trial: 44. Best value: 0.212103:  88%|████████▊ | 88/100 [02:57<00:23,  1.96s/it]Best trial: 44. Best value: 0.212103:  89%|████████▉ | 89/100 [02:57<00:20,  1.83s/it]Best trial: 44. Best value: 0.212103:  89%|████████▉ | 89/100 [02:59<00:20,  1.83s/it]Best trial: 44. Best value: 0.212103:  90%|█████████ | 90/100 [02:59<00:18,  1.83s/it]Best trial: 44. Best value: 0.212103:  90%|█████████ | 90/100 [03:01<00:18,  1.83s/it]Best trial: 44. Best value: 0.212103:  91%|█████████ | 91/100 [03:01<00:15,  1.74s/it]Best trial: 44. Best value: 0.212103:  91%|█████████ | 91/100 [03:03<00:15,  1.74s/it]Best trial: 44. Best value: 0.212103:  92%|█████████▏| 92/100 [03:03<00:14,  1.84s/it]Best trial: 44. Best value: 0.212103:  92%|█████████▏| 92/100 [03:04<00:14,  1.84s/it]Best trial: 44. Best value: 0.212103:  93%|█████████▎| 93/100 [03:04<00:11,  1.68s/it]Best trial: 93. Best value: 0.232361:  93%|█████████▎| 93/100 [03:06<00:11,  1.68s/it]Best trial: 93. Best value: 0.232361:  94%|█████████▍| 94/100 [03:06<00:10,  1.74s/it]Best trial: 94. Best value: 0.250045:  94%|█████████▍| 94/100 [03:08<00:10,  1.74s/it]Best trial: 94. Best value: 0.250045:  95%|█████████▌| 95/100 [03:08<00:08,  1.74s/it]Best trial: 94. Best value: 0.250045:  95%|█████████▌| 95/100 [03:10<00:08,  1.74s/it]Best trial: 94. Best value: 0.250045:  96%|█████████▌| 96/100 [03:10<00:07,  1.77s/it]Best trial: 96. Best value: 0.251744:  96%|█████████▌| 96/100 [03:11<00:07,  1.77s/it]Best trial: 96. Best value: 0.251744:  97%|█████████▋| 97/100 [03:11<00:05,  1.69s/it]Best trial: 96. Best value: 0.251744:  97%|█████████▋| 97/100 [03:13<00:05,  1.69s/it]Best trial: 96. Best value: 0.251744:  98%|█████████▊| 98/100 [03:13<00:03,  1.65s/it]Best trial: 96. Best value: 0.251744:  98%|█████████▊| 98/100 [03:14<00:03,  1.65s/it]Best trial: 96. Best value: 0.251744:  99%|█████████▉| 99/100 [03:14<00:01,  1.71s/it]Best trial: 96. Best value: 0.251744:  99%|█████████▉| 99/100 [03:17<00:01,  1.71s/it]Best trial: 96. Best value: 0.251744: 100%|██████████| 100/100 [03:17<00:00,  1.85s/it]Best trial: 96. Best value: 0.251744: 100%|██████████| 100/100 [03:17<00:00,  1.97s/it]
2025-11-30 15:15:06,986 - INFO - HPO Complete. Best AUPRC: 0.2517
2025-11-30 15:15:06,986 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0020429361211397627, 'max_depth': 3, 'subsample': 0.6983588029248277, 'colsample_bytree': 0.6006614178954947, 'gamma': 4.72694365194811, 'reg_lambda': 1.7640404219206304e-08, 'reg_alpha': 0.002021208587114761}
2025-11-30 15:15:06,987 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:15:08,810 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 15:15:08,810 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:15:08,893 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:15:08,915 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:15:08,921 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 15:15:08,921 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:15:08,921 - INFO - Training model...
2025-11-30 15:15:10,517 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:15:15,756 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:15:15,756 - INFO - AUROC: 0.7308 (0.4361 - 0.8609)
2025-11-30 15:15:15,756 - INFO - AUPRC: 0.0314 (0.0077 - 0.1066)
2025-11-30 15:15:15,756 - INFO - Brier Score: 0.0893 (0.0863 - 0.0930)
2025-11-30 15:15:15,756 - INFO - Accuracy: 0.9668 (0.4457 - 0.9717)
2025-11-30 15:15:15,756 - INFO - Precision: 0.0526 (0.0092 - 0.1500)
2025-11-30 15:15:15,756 - INFO - Sensitivity (Recall): 0.1667 (0.1444 - 1.0000)
2025-11-30 15:15:15,757 - INFO - F1-Score: 0.0800 (0.0179 - 0.2130)
2025-11-30 15:15:15,757 - INFO - Best Threshold: 0.4500 (0.2660 - 0.4500)
2025-11-30 15:15:15,757 - INFO - Specificity: 0.9738 (0.4402 - 0.9821)
2025-11-30 15:15:15,767 - INFO - Calculating SHAP values...
2025-11-30 15:15:16,719 - INFO - SHAP plots saved.
2025-11-30 15:15:16,720 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:15:17,889 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 15:15:17,889 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:15:17,973 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:15:18,004 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:15:18,011 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:15:18,011 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0248019:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.0248019:   1%|          | 1/100 [00:03<06:00,  3.64s/it]Best trial: 1. Best value: 0.110503:   1%|          | 1/100 [00:06<06:00,  3.64s/it] Best trial: 1. Best value: 0.110503:   2%|▏         | 2/100 [00:06<04:51,  2.98s/it]Best trial: 1. Best value: 0.110503:   2%|▏         | 2/100 [00:09<04:51,  2.98s/it]Best trial: 1. Best value: 0.110503:   3%|▎         | 3/100 [00:09<04:48,  2.98s/it]Best trial: 1. Best value: 0.110503:   3%|▎         | 3/100 [00:11<04:48,  2.98s/it]Best trial: 1. Best value: 0.110503:   4%|▍         | 4/100 [00:11<04:33,  2.85s/it]Best trial: 1. Best value: 0.110503:   4%|▍         | 4/100 [00:14<04:33,  2.85s/it]Best trial: 1. Best value: 0.110503:   5%|▌         | 5/100 [00:14<04:39,  2.94s/it]Best trial: 1. Best value: 0.110503:   5%|▌         | 5/100 [00:18<04:39,  2.94s/it]Best trial: 1. Best value: 0.110503:   6%|▌         | 6/100 [00:18<04:44,  3.02s/it]Best trial: 1. Best value: 0.110503:   6%|▌         | 6/100 [00:20<04:44,  3.02s/it]Best trial: 1. Best value: 0.110503:   7%|▋         | 7/100 [00:20<04:16,  2.76s/it]Best trial: 1. Best value: 0.110503:   7%|▋         | 7/100 [00:25<04:16,  2.76s/it]Best trial: 1. Best value: 0.110503:   8%|▊         | 8/100 [00:25<05:13,  3.41s/it]Best trial: 1. Best value: 0.110503:   8%|▊         | 8/100 [00:27<05:13,  3.41s/it]Best trial: 1. Best value: 0.110503:   9%|▉         | 9/100 [00:27<04:46,  3.15s/it]Best trial: 1. Best value: 0.110503:   9%|▉         | 9/100 [00:30<04:46,  3.15s/it]Best trial: 1. Best value: 0.110503:  10%|█         | 10/100 [00:30<04:31,  3.01s/it]Best trial: 10. Best value: 0.132883:  10%|█         | 10/100 [00:32<04:31,  3.01s/it]Best trial: 10. Best value: 0.132883:  11%|█         | 11/100 [00:32<04:12,  2.83s/it]Best trial: 11. Best value: 0.133016:  11%|█         | 11/100 [00:34<04:12,  2.83s/it]Best trial: 11. Best value: 0.133016:  12%|█▏        | 12/100 [00:34<03:51,  2.63s/it]Best trial: 11. Best value: 0.133016:  12%|█▏        | 12/100 [00:37<03:51,  2.63s/it]Best trial: 11. Best value: 0.133016:  13%|█▎        | 13/100 [00:37<03:34,  2.47s/it]Best trial: 11. Best value: 0.133016:  13%|█▎        | 13/100 [00:39<03:34,  2.47s/it]Best trial: 11. Best value: 0.133016:  14%|█▍        | 14/100 [00:39<03:37,  2.53s/it]Best trial: 11. Best value: 0.133016:  14%|█▍        | 14/100 [00:42<03:37,  2.53s/it]Best trial: 11. Best value: 0.133016:  15%|█▌        | 15/100 [00:42<03:29,  2.47s/it]Best trial: 11. Best value: 0.133016:  15%|█▌        | 15/100 [00:44<03:29,  2.47s/it]Best trial: 11. Best value: 0.133016:  16%|█▌        | 16/100 [00:44<03:24,  2.43s/it]Best trial: 11. Best value: 0.133016:  16%|█▌        | 16/100 [00:46<03:24,  2.43s/it]Best trial: 11. Best value: 0.133016:  17%|█▋        | 17/100 [00:46<03:12,  2.32s/it]Best trial: 11. Best value: 0.133016:  17%|█▋        | 17/100 [00:48<03:12,  2.32s/it]Best trial: 11. Best value: 0.133016:  18%|█▊        | 18/100 [00:48<03:11,  2.34s/it]Best trial: 11. Best value: 0.133016:  18%|█▊        | 18/100 [00:51<03:11,  2.34s/it]Best trial: 11. Best value: 0.133016:  19%|█▉        | 19/100 [00:51<03:12,  2.38s/it]Best trial: 11. Best value: 0.133016:  19%|█▉        | 19/100 [00:54<03:12,  2.38s/it]Best trial: 11. Best value: 0.133016:  20%|██        | 20/100 [00:54<03:19,  2.49s/it]Best trial: 11. Best value: 0.133016:  20%|██        | 20/100 [00:56<03:19,  2.49s/it]Best trial: 11. Best value: 0.133016:  21%|██        | 21/100 [00:56<03:06,  2.36s/it]Best trial: 11. Best value: 0.133016:  21%|██        | 21/100 [00:58<03:06,  2.36s/it]Best trial: 11. Best value: 0.133016:  22%|██▏       | 22/100 [00:58<02:58,  2.29s/it]Best trial: 22. Best value: 0.135308:  22%|██▏       | 22/100 [01:00<02:58,  2.29s/it]Best trial: 22. Best value: 0.135308:  23%|██▎       | 23/100 [01:00<02:54,  2.26s/it]Best trial: 22. Best value: 0.135308:  23%|██▎       | 23/100 [01:02<02:54,  2.26s/it]Best trial: 22. Best value: 0.135308:  24%|██▍       | 24/100 [01:02<02:42,  2.14s/it]Best trial: 22. Best value: 0.135308:  24%|██▍       | 24/100 [01:04<02:42,  2.14s/it]Best trial: 22. Best value: 0.135308:  25%|██▌       | 25/100 [01:04<02:36,  2.09s/it]Best trial: 22. Best value: 0.135308:  25%|██▌       | 25/100 [01:06<02:36,  2.09s/it]Best trial: 22. Best value: 0.135308:  26%|██▌       | 26/100 [01:06<02:43,  2.21s/it]Best trial: 22. Best value: 0.135308:  26%|██▌       | 26/100 [01:08<02:43,  2.21s/it]Best trial: 22. Best value: 0.135308:  27%|██▋       | 27/100 [01:08<02:35,  2.12s/it]Best trial: 27. Best value: 0.196376:  27%|██▋       | 27/100 [01:11<02:35,  2.12s/it]Best trial: 27. Best value: 0.196376:  28%|██▊       | 28/100 [01:11<02:41,  2.25s/it]Best trial: 27. Best value: 0.196376:  28%|██▊       | 28/100 [01:13<02:41,  2.25s/it]Best trial: 27. Best value: 0.196376:  29%|██▉       | 29/100 [01:13<02:46,  2.35s/it]Best trial: 27. Best value: 0.196376:  29%|██▉       | 29/100 [01:15<02:46,  2.35s/it]Best trial: 27. Best value: 0.196376:  30%|███       | 30/100 [01:15<02:39,  2.28s/it]Best trial: 27. Best value: 0.196376:  30%|███       | 30/100 [01:19<02:39,  2.28s/it]Best trial: 27. Best value: 0.196376:  31%|███       | 31/100 [01:19<03:02,  2.64s/it]Best trial: 27. Best value: 0.196376:  31%|███       | 31/100 [01:21<03:02,  2.64s/it]Best trial: 27. Best value: 0.196376:  32%|███▏      | 32/100 [01:21<02:49,  2.50s/it]Best trial: 27. Best value: 0.196376:  32%|███▏      | 32/100 [01:24<02:49,  2.50s/it]Best trial: 27. Best value: 0.196376:  33%|███▎      | 33/100 [01:24<02:47,  2.50s/it]Best trial: 27. Best value: 0.196376:  33%|███▎      | 33/100 [01:26<02:47,  2.50s/it]Best trial: 27. Best value: 0.196376:  34%|███▍      | 34/100 [01:26<02:51,  2.60s/it]Best trial: 27. Best value: 0.196376:  34%|███▍      | 34/100 [01:29<02:51,  2.60s/it]Best trial: 27. Best value: 0.196376:  35%|███▌      | 35/100 [01:29<02:41,  2.49s/it]Best trial: 27. Best value: 0.196376:  35%|███▌      | 35/100 [01:32<02:41,  2.49s/it]Best trial: 27. Best value: 0.196376:  36%|███▌      | 36/100 [01:32<02:46,  2.60s/it]Best trial: 27. Best value: 0.196376:  36%|███▌      | 36/100 [01:34<02:46,  2.60s/it]Best trial: 27. Best value: 0.196376:  37%|███▋      | 37/100 [01:34<02:44,  2.60s/it]Best trial: 27. Best value: 0.196376:  37%|███▋      | 37/100 [01:37<02:44,  2.60s/it]Best trial: 27. Best value: 0.196376:  38%|███▊      | 38/100 [01:37<02:43,  2.63s/it]Best trial: 27. Best value: 0.196376:  38%|███▊      | 38/100 [01:39<02:43,  2.63s/it]Best trial: 27. Best value: 0.196376:  39%|███▉      | 39/100 [01:39<02:40,  2.63s/it]Best trial: 27. Best value: 0.196376:  39%|███▉      | 39/100 [01:42<02:40,  2.63s/it]Best trial: 27. Best value: 0.196376:  40%|████      | 40/100 [01:42<02:41,  2.69s/it]Best trial: 27. Best value: 0.196376:  40%|████      | 40/100 [01:45<02:41,  2.69s/it]Best trial: 27. Best value: 0.196376:  41%|████      | 41/100 [01:45<02:36,  2.66s/it]Best trial: 27. Best value: 0.196376:  41%|████      | 41/100 [01:47<02:36,  2.66s/it]Best trial: 27. Best value: 0.196376:  42%|████▏     | 42/100 [01:47<02:32,  2.62s/it]Best trial: 27. Best value: 0.196376:  42%|████▏     | 42/100 [01:50<02:32,  2.62s/it]Best trial: 27. Best value: 0.196376:  43%|████▎     | 43/100 [01:50<02:33,  2.70s/it]Best trial: 27. Best value: 0.196376:  43%|████▎     | 43/100 [01:53<02:33,  2.70s/it]Best trial: 27. Best value: 0.196376:  44%|████▍     | 44/100 [01:53<02:35,  2.77s/it]Best trial: 27. Best value: 0.196376:  44%|████▍     | 44/100 [01:56<02:35,  2.77s/it]Best trial: 27. Best value: 0.196376:  45%|████▌     | 45/100 [01:56<02:25,  2.65s/it]Best trial: 27. Best value: 0.196376:  45%|████▌     | 45/100 [01:58<02:25,  2.65s/it]Best trial: 27. Best value: 0.196376:  46%|████▌     | 46/100 [01:58<02:22,  2.64s/it]Best trial: 27. Best value: 0.196376:  46%|████▌     | 46/100 [02:01<02:22,  2.64s/it]Best trial: 27. Best value: 0.196376:  47%|████▋     | 47/100 [02:01<02:16,  2.58s/it]Best trial: 27. Best value: 0.196376:  47%|████▋     | 47/100 [02:03<02:16,  2.58s/it]Best trial: 27. Best value: 0.196376:  48%|████▊     | 48/100 [02:03<02:15,  2.61s/it]Best trial: 27. Best value: 0.196376:  48%|████▊     | 48/100 [02:05<02:15,  2.61s/it]Best trial: 27. Best value: 0.196376:  49%|████▉     | 49/100 [02:05<02:04,  2.43s/it]Best trial: 27. Best value: 0.196376:  49%|████▉     | 49/100 [02:08<02:04,  2.43s/it]Best trial: 27. Best value: 0.196376:  50%|█████     | 50/100 [02:08<02:08,  2.57s/it]Best trial: 27. Best value: 0.196376:  50%|█████     | 50/100 [02:11<02:08,  2.57s/it]Best trial: 27. Best value: 0.196376:  51%|█████     | 51/100 [02:11<02:04,  2.54s/it]Best trial: 27. Best value: 0.196376:  51%|█████     | 51/100 [02:14<02:04,  2.54s/it]Best trial: 27. Best value: 0.196376:  52%|█████▏    | 52/100 [02:14<02:06,  2.65s/it]Best trial: 27. Best value: 0.196376:  52%|█████▏    | 52/100 [02:16<02:06,  2.65s/it]Best trial: 27. Best value: 0.196376:  53%|█████▎    | 53/100 [02:16<02:02,  2.61s/it]Best trial: 27. Best value: 0.196376:  53%|█████▎    | 53/100 [02:19<02:02,  2.61s/it]Best trial: 27. Best value: 0.196376:  54%|█████▍    | 54/100 [02:19<01:58,  2.58s/it]Best trial: 27. Best value: 0.196376:  54%|█████▍    | 54/100 [02:21<01:58,  2.58s/it]Best trial: 27. Best value: 0.196376:  55%|█████▌    | 55/100 [02:21<01:54,  2.54s/it]Best trial: 27. Best value: 0.196376:  55%|█████▌    | 55/100 [02:23<01:54,  2.54s/it]Best trial: 27. Best value: 0.196376:  56%|█████▌    | 56/100 [02:23<01:47,  2.44s/it]Best trial: 27. Best value: 0.196376:  56%|█████▌    | 56/100 [02:26<01:47,  2.44s/it]Best trial: 27. Best value: 0.196376:  57%|█████▋    | 57/100 [02:26<01:44,  2.42s/it]Best trial: 27. Best value: 0.196376:  57%|█████▋    | 57/100 [02:28<01:44,  2.42s/it]Best trial: 27. Best value: 0.196376:  58%|█████▊    | 58/100 [02:28<01:44,  2.49s/it]Best trial: 27. Best value: 0.196376:  58%|█████▊    | 58/100 [02:30<01:44,  2.49s/it]Best trial: 27. Best value: 0.196376:  59%|█████▉    | 59/100 [02:30<01:36,  2.36s/it]Best trial: 27. Best value: 0.196376:  59%|█████▉    | 59/100 [02:32<01:36,  2.36s/it]Best trial: 27. Best value: 0.196376:  60%|██████    | 60/100 [02:32<01:28,  2.21s/it]Best trial: 27. Best value: 0.196376:  60%|██████    | 60/100 [02:34<01:28,  2.21s/it]Best trial: 27. Best value: 0.196376:  61%|██████    | 61/100 [02:34<01:22,  2.10s/it]Best trial: 27. Best value: 0.196376:  61%|██████    | 61/100 [02:36<01:22,  2.10s/it]Best trial: 27. Best value: 0.196376:  62%|██████▏   | 62/100 [02:36<01:23,  2.19s/it]Best trial: 27. Best value: 0.196376:  62%|██████▏   | 62/100 [02:39<01:23,  2.19s/it]Best trial: 27. Best value: 0.196376:  63%|██████▎   | 63/100 [02:39<01:24,  2.27s/it]Best trial: 27. Best value: 0.196376:  63%|██████▎   | 63/100 [02:41<01:24,  2.27s/it]Best trial: 27. Best value: 0.196376:  64%|██████▍   | 64/100 [02:41<01:17,  2.17s/it]Best trial: 27. Best value: 0.196376:  64%|██████▍   | 64/100 [02:43<01:17,  2.17s/it]Best trial: 27. Best value: 0.196376:  65%|██████▌   | 65/100 [02:43<01:19,  2.26s/it]Best trial: 27. Best value: 0.196376:  65%|██████▌   | 65/100 [02:46<01:19,  2.26s/it]Best trial: 27. Best value: 0.196376:  66%|██████▌   | 66/100 [02:46<01:21,  2.40s/it]Best trial: 27. Best value: 0.196376:  66%|██████▌   | 66/100 [02:48<01:21,  2.40s/it]Best trial: 27. Best value: 0.196376:  67%|██████▋   | 67/100 [02:48<01:16,  2.31s/it]Best trial: 27. Best value: 0.196376:  67%|██████▋   | 67/100 [02:51<01:16,  2.31s/it]Best trial: 27. Best value: 0.196376:  68%|██████▊   | 68/100 [02:51<01:15,  2.35s/it]Best trial: 27. Best value: 0.196376:  68%|██████▊   | 68/100 [02:53<01:15,  2.35s/it]Best trial: 27. Best value: 0.196376:  69%|██████▉   | 69/100 [02:53<01:13,  2.36s/it]Best trial: 27. Best value: 0.196376:  69%|██████▉   | 69/100 [02:56<01:13,  2.36s/it]Best trial: 27. Best value: 0.196376:  70%|███████   | 70/100 [02:56<01:13,  2.44s/it]Best trial: 27. Best value: 0.196376:  70%|███████   | 70/100 [02:58<01:13,  2.44s/it]Best trial: 27. Best value: 0.196376:  71%|███████   | 71/100 [02:58<01:13,  2.53s/it]Best trial: 27. Best value: 0.196376:  71%|███████   | 71/100 [03:01<01:13,  2.53s/it]Best trial: 27. Best value: 0.196376:  72%|███████▏  | 72/100 [03:01<01:11,  2.54s/it]Best trial: 27. Best value: 0.196376:  72%|███████▏  | 72/100 [03:06<01:11,  2.54s/it]Best trial: 27. Best value: 0.196376:  73%|███████▎  | 73/100 [03:06<01:25,  3.16s/it]Best trial: 27. Best value: 0.196376:  73%|███████▎  | 73/100 [03:08<01:25,  3.16s/it]Best trial: 27. Best value: 0.196376:  74%|███████▍  | 74/100 [03:08<01:19,  3.08s/it]Best trial: 27. Best value: 0.196376:  74%|███████▍  | 74/100 [03:11<01:19,  3.08s/it]Best trial: 27. Best value: 0.196376:  75%|███████▌  | 75/100 [03:11<01:16,  3.07s/it]Best trial: 27. Best value: 0.196376:  75%|███████▌  | 75/100 [03:14<01:16,  3.07s/it]Best trial: 27. Best value: 0.196376:  76%|███████▌  | 76/100 [03:14<01:08,  2.87s/it]Best trial: 27. Best value: 0.196376:  76%|███████▌  | 76/100 [03:17<01:08,  2.87s/it]Best trial: 27. Best value: 0.196376:  77%|███████▋  | 77/100 [03:17<01:06,  2.88s/it]Best trial: 27. Best value: 0.196376:  77%|███████▋  | 77/100 [03:19<01:06,  2.88s/it]Best trial: 27. Best value: 0.196376:  78%|███████▊  | 78/100 [03:19<01:01,  2.80s/it]Best trial: 27. Best value: 0.196376:  78%|███████▊  | 78/100 [03:22<01:01,  2.80s/it]Best trial: 27. Best value: 0.196376:  79%|███████▉  | 79/100 [03:22<00:54,  2.60s/it]Best trial: 27. Best value: 0.196376:  79%|███████▉  | 79/100 [03:24<00:54,  2.60s/it]Best trial: 27. Best value: 0.196376:  80%|████████  | 80/100 [03:24<00:50,  2.55s/it]Best trial: 27. Best value: 0.196376:  80%|████████  | 80/100 [03:28<00:50,  2.55s/it]Best trial: 27. Best value: 0.196376:  81%|████████  | 81/100 [03:28<00:54,  2.88s/it]Best trial: 27. Best value: 0.196376:  81%|████████  | 81/100 [03:30<00:54,  2.88s/it]Best trial: 27. Best value: 0.196376:  82%|████████▏ | 82/100 [03:30<00:48,  2.70s/it]Best trial: 82. Best value: 0.217972:  82%|████████▏ | 82/100 [03:32<00:48,  2.70s/it]Best trial: 82. Best value: 0.217972:  83%|████████▎ | 83/100 [03:32<00:44,  2.62s/it]Best trial: 82. Best value: 0.217972:  83%|████████▎ | 83/100 [03:36<00:44,  2.62s/it]Best trial: 82. Best value: 0.217972:  84%|████████▍ | 84/100 [03:36<00:47,  2.98s/it]Best trial: 82. Best value: 0.217972:  84%|████████▍ | 84/100 [03:39<00:47,  2.98s/it]Best trial: 82. Best value: 0.217972:  85%|████████▌ | 85/100 [03:39<00:44,  2.98s/it]Best trial: 82. Best value: 0.217972:  85%|████████▌ | 85/100 [03:42<00:44,  2.98s/it]Best trial: 82. Best value: 0.217972:  86%|████████▌ | 86/100 [03:42<00:41,  2.94s/it]Best trial: 82. Best value: 0.217972:  86%|████████▌ | 86/100 [03:45<00:41,  2.94s/it]Best trial: 82. Best value: 0.217972:  87%|████████▋ | 87/100 [03:45<00:37,  2.85s/it]Best trial: 82. Best value: 0.217972:  87%|████████▋ | 87/100 [03:48<00:37,  2.85s/it]Best trial: 82. Best value: 0.217972:  88%|████████▊ | 88/100 [03:48<00:38,  3.17s/it]Best trial: 82. Best value: 0.217972:  88%|████████▊ | 88/100 [03:51<00:38,  3.17s/it]Best trial: 82. Best value: 0.217972:  89%|████████▉ | 89/100 [03:51<00:34,  3.10s/it]Best trial: 82. Best value: 0.217972:  89%|████████▉ | 89/100 [03:54<00:34,  3.10s/it]Best trial: 82. Best value: 0.217972:  90%|█████████ | 90/100 [03:54<00:29,  2.91s/it]Best trial: 82. Best value: 0.217972:  90%|█████████ | 90/100 [03:57<00:29,  2.91s/it]Best trial: 82. Best value: 0.217972:  91%|█████████ | 91/100 [03:57<00:26,  2.97s/it]Best trial: 82. Best value: 0.217972:  91%|█████████ | 91/100 [04:00<00:26,  2.97s/it]Best trial: 82. Best value: 0.217972:  92%|█████████▏| 92/100 [04:00<00:24,  3.03s/it]Best trial: 82. Best value: 0.217972:  92%|█████████▏| 92/100 [04:03<00:24,  3.03s/it]Best trial: 82. Best value: 0.217972:  93%|█████████▎| 93/100 [04:03<00:21,  3.05s/it]Best trial: 82. Best value: 0.217972:  93%|█████████▎| 93/100 [04:06<00:21,  3.05s/it]Best trial: 82. Best value: 0.217972:  94%|█████████▍| 94/100 [04:06<00:17,  2.95s/it]Best trial: 82. Best value: 0.217972:  94%|█████████▍| 94/100 [04:10<00:17,  2.95s/it]Best trial: 82. Best value: 0.217972:  95%|█████████▌| 95/100 [04:10<00:16,  3.21s/it]Best trial: 82. Best value: 0.217972:  95%|█████████▌| 95/100 [04:13<00:16,  3.21s/it]Best trial: 82. Best value: 0.217972:  96%|█████████▌| 96/100 [04:13<00:12,  3.14s/it]Best trial: 82. Best value: 0.217972:  96%|█████████▌| 96/100 [04:16<00:12,  3.14s/it]Best trial: 82. Best value: 0.217972:  97%|█████████▋| 97/100 [04:16<00:09,  3.07s/it]Best trial: 82. Best value: 0.217972:  97%|█████████▋| 97/100 [04:19<00:09,  3.07s/it]Best trial: 82. Best value: 0.217972:  98%|█████████▊| 98/100 [04:19<00:06,  3.05s/it]Best trial: 82. Best value: 0.217972:  98%|█████████▊| 98/100 [04:21<00:06,  3.05s/it]Best trial: 82. Best value: 0.217972:  99%|█████████▉| 99/100 [04:21<00:02,  2.84s/it]Best trial: 82. Best value: 0.217972:  99%|█████████▉| 99/100 [04:24<00:02,  2.84s/it]Best trial: 82. Best value: 0.217972: 100%|██████████| 100/100 [04:24<00:00,  2.88s/it]Best trial: 82. Best value: 0.217972: 100%|██████████| 100/100 [04:24<00:00,  2.65s/it]
2025-11-30 15:19:42,541 - INFO - HPO Complete. Best AUPRC: 0.2180
2025-11-30 15:19:42,542 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.004209915489892148, 'max_depth': 4, 'subsample': 0.7545625116856033, 'colsample_bytree': 0.7990994491590433, 'gamma': 4.8523113842473125, 'reg_lambda': 0.042374669187581995, 'reg_alpha': 0.000299052548609276}
2025-11-30 15:19:42,544 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:19:44,545 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 15:19:44,545 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:19:44,631 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:19:44,671 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:19:44,681 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:19:44,681 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:19:44,681 - INFO - Training model...
2025-11-30 15:19:49,169 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:19:54,742 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:19:54,743 - INFO - AUROC: 0.4553 (0.0552 - 0.6677)
2025-11-30 15:19:54,743 - INFO - AUPRC: 0.0370 (0.0036 - 0.2406)
2025-11-30 15:19:54,743 - INFO - Brier Score: 0.0140 (0.0098 - 0.0203)
2025-11-30 15:19:54,743 - INFO - Accuracy: 0.9855 (0.0110 - 0.9919)
2025-11-30 15:19:54,743 - INFO - Precision: 0.1667 (0.0044 - 0.4250)
2025-11-30 15:19:54,743 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 15:19:54,743 - INFO - F1-Score: 0.1667 (0.0087 - 0.4769)
2025-11-30 15:19:54,743 - INFO - Best Threshold: 0.2700 (0.0200 - 0.2700)
2025-11-30 15:19:54,743 - INFO - Specificity: 0.9927 (0.0047 - 0.9971)
2025-11-30 15:19:54,762 - INFO - Calculating SHAP values...
2025-11-30 15:19:55,824 - INFO - SHAP plots saved.
2025-11-30 15:19:55,827 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:19:57,423 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 15:19:57,423 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:19:57,516 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:19:57,548 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:19:57,556 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:19:57,556 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.138157:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.138157:   1%|          | 1/100 [00:02<04:10,  2.53s/it]Best trial: 0. Best value: 0.138157:   1%|          | 1/100 [00:05<04:10,  2.53s/it]Best trial: 0. Best value: 0.138157:   2%|▏         | 2/100 [00:05<04:49,  2.95s/it]Best trial: 0. Best value: 0.138157:   2%|▏         | 2/100 [00:08<04:49,  2.95s/it]Best trial: 0. Best value: 0.138157:   3%|▎         | 3/100 [00:08<04:52,  3.01s/it]Best trial: 0. Best value: 0.138157:   3%|▎         | 3/100 [00:11<04:52,  3.01s/it]Best trial: 0. Best value: 0.138157:   4%|▍         | 4/100 [00:11<04:19,  2.70s/it]Best trial: 0. Best value: 0.138157:   4%|▍         | 4/100 [00:14<04:19,  2.70s/it]Best trial: 0. Best value: 0.138157:   5%|▌         | 5/100 [00:14<04:49,  3.05s/it]Best trial: 0. Best value: 0.138157:   5%|▌         | 5/100 [00:17<04:49,  3.05s/it]Best trial: 0. Best value: 0.138157:   6%|▌         | 6/100 [00:17<04:45,  3.04s/it]Best trial: 0. Best value: 0.138157:   6%|▌         | 6/100 [00:19<04:45,  3.04s/it]Best trial: 0. Best value: 0.138157:   7%|▋         | 7/100 [00:19<04:14,  2.73s/it]Best trial: 0. Best value: 0.138157:   7%|▋         | 7/100 [00:23<04:14,  2.73s/it]Best trial: 0. Best value: 0.138157:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]Best trial: 0. Best value: 0.138157:   8%|▊         | 8/100 [00:26<04:33,  2.97s/it]Best trial: 0. Best value: 0.138157:   9%|▉         | 9/100 [00:26<04:33,  3.01s/it]Best trial: 0. Best value: 0.138157:   9%|▉         | 9/100 [00:29<04:33,  3.01s/it]Best trial: 0. Best value: 0.138157:  10%|█         | 10/100 [00:29<04:29,  2.99s/it]Best trial: 0. Best value: 0.138157:  10%|█         | 10/100 [00:31<04:29,  2.99s/it]Best trial: 0. Best value: 0.138157:  11%|█         | 11/100 [00:31<04:13,  2.85s/it]Best trial: 0. Best value: 0.138157:  11%|█         | 11/100 [00:33<04:13,  2.85s/it]Best trial: 0. Best value: 0.138157:  12%|█▏        | 12/100 [00:33<03:45,  2.56s/it]Best trial: 0. Best value: 0.138157:  12%|█▏        | 12/100 [00:36<03:45,  2.56s/it]Best trial: 0. Best value: 0.138157:  13%|█▎        | 13/100 [00:36<03:34,  2.46s/it]Best trial: 0. Best value: 0.138157:  13%|█▎        | 13/100 [00:38<03:34,  2.46s/it]Best trial: 0. Best value: 0.138157:  14%|█▍        | 14/100 [00:38<03:35,  2.50s/it]Best trial: 0. Best value: 0.138157:  14%|█▍        | 14/100 [00:41<03:35,  2.50s/it]Best trial: 0. Best value: 0.138157:  15%|█▌        | 15/100 [00:41<03:30,  2.47s/it]Best trial: 0. Best value: 0.138157:  15%|█▌        | 15/100 [00:44<03:30,  2.47s/it]Best trial: 0. Best value: 0.138157:  16%|█▌        | 16/100 [00:44<03:40,  2.63s/it]Best trial: 16. Best value: 0.141238:  16%|█▌        | 16/100 [00:46<03:40,  2.63s/it]Best trial: 16. Best value: 0.141238:  17%|█▋        | 17/100 [00:46<03:40,  2.66s/it]Best trial: 16. Best value: 0.141238:  17%|█▋        | 17/100 [00:49<03:40,  2.66s/it]Best trial: 16. Best value: 0.141238:  18%|█▊        | 18/100 [00:49<03:41,  2.70s/it]Best trial: 16. Best value: 0.141238:  18%|█▊        | 18/100 [00:52<03:41,  2.70s/it]Best trial: 16. Best value: 0.141238:  19%|█▉        | 19/100 [00:52<03:35,  2.65s/it]Best trial: 19. Best value: 0.151234:  19%|█▉        | 19/100 [00:55<03:35,  2.65s/it]Best trial: 19. Best value: 0.151234:  20%|██        | 20/100 [00:55<03:48,  2.86s/it]Best trial: 19. Best value: 0.151234:  20%|██        | 20/100 [00:58<03:48,  2.86s/it]Best trial: 19. Best value: 0.151234:  21%|██        | 21/100 [00:58<03:59,  3.03s/it]Best trial: 19. Best value: 0.151234:  21%|██        | 21/100 [01:00<03:59,  3.03s/it]Best trial: 19. Best value: 0.151234:  22%|██▏       | 22/100 [01:00<03:33,  2.74s/it]Best trial: 22. Best value: 0.171781:  22%|██▏       | 22/100 [01:03<03:33,  2.74s/it]Best trial: 22. Best value: 0.171781:  23%|██▎       | 23/100 [01:03<03:16,  2.55s/it]Best trial: 22. Best value: 0.171781:  23%|██▎       | 23/100 [01:05<03:16,  2.55s/it]Best trial: 22. Best value: 0.171781:  24%|██▍       | 24/100 [01:05<03:21,  2.66s/it]Best trial: 22. Best value: 0.171781:  24%|██▍       | 24/100 [01:08<03:21,  2.66s/it]Best trial: 22. Best value: 0.171781:  25%|██▌       | 25/100 [01:08<03:18,  2.65s/it]Best trial: 22. Best value: 0.171781:  25%|██▌       | 25/100 [01:12<03:18,  2.65s/it]Best trial: 22. Best value: 0.171781:  26%|██▌       | 26/100 [01:12<03:37,  2.94s/it]Best trial: 22. Best value: 0.171781:  26%|██▌       | 26/100 [01:14<03:37,  2.94s/it]Best trial: 22. Best value: 0.171781:  27%|██▋       | 27/100 [01:14<03:28,  2.86s/it]Best trial: 22. Best value: 0.171781:  27%|██▋       | 27/100 [01:17<03:28,  2.86s/it]Best trial: 22. Best value: 0.171781:  28%|██▊       | 28/100 [01:17<03:27,  2.88s/it]Best trial: 22. Best value: 0.171781:  28%|██▊       | 28/100 [01:21<03:27,  2.88s/it]Best trial: 22. Best value: 0.171781:  29%|██▉       | 29/100 [01:21<03:39,  3.09s/it]Best trial: 22. Best value: 0.171781:  29%|██▉       | 29/100 [01:23<03:39,  3.09s/it]Best trial: 22. Best value: 0.171781:  30%|███       | 30/100 [01:23<03:20,  2.86s/it]Best trial: 22. Best value: 0.171781:  30%|███       | 30/100 [01:26<03:20,  2.86s/it]Best trial: 22. Best value: 0.171781:  31%|███       | 31/100 [01:26<03:13,  2.81s/it]Best trial: 22. Best value: 0.171781:  31%|███       | 31/100 [01:28<03:13,  2.81s/it]Best trial: 22. Best value: 0.171781:  32%|███▏      | 32/100 [01:28<02:56,  2.60s/it]Best trial: 22. Best value: 0.171781:  32%|███▏      | 32/100 [01:30<02:56,  2.60s/it]Best trial: 22. Best value: 0.171781:  33%|███▎      | 33/100 [01:30<02:39,  2.38s/it]Best trial: 22. Best value: 0.171781:  33%|███▎      | 33/100 [01:32<02:39,  2.38s/it]Best trial: 22. Best value: 0.171781:  34%|███▍      | 34/100 [01:32<02:32,  2.32s/it]Best trial: 22. Best value: 0.171781:  34%|███▍      | 34/100 [01:34<02:32,  2.32s/it]Best trial: 22. Best value: 0.171781:  35%|███▌      | 35/100 [01:34<02:18,  2.13s/it]Best trial: 22. Best value: 0.171781:  35%|███▌      | 35/100 [01:37<02:18,  2.13s/it]Best trial: 22. Best value: 0.171781:  36%|███▌      | 36/100 [01:37<02:36,  2.45s/it]Best trial: 22. Best value: 0.171781:  36%|███▌      | 36/100 [01:41<02:36,  2.45s/it]Best trial: 22. Best value: 0.171781:  37%|███▋      | 37/100 [01:41<02:57,  2.81s/it]Best trial: 22. Best value: 0.171781:  37%|███▋      | 37/100 [01:43<02:57,  2.81s/it]Best trial: 22. Best value: 0.171781:  38%|███▊      | 38/100 [01:43<02:46,  2.68s/it]Best trial: 22. Best value: 0.171781:  38%|███▊      | 38/100 [01:45<02:46,  2.68s/it]Best trial: 22. Best value: 0.171781:  39%|███▉      | 39/100 [01:45<02:35,  2.55s/it]Best trial: 22. Best value: 0.171781:  39%|███▉      | 39/100 [01:47<02:35,  2.55s/it]Best trial: 22. Best value: 0.171781:  40%|████      | 40/100 [01:47<02:19,  2.33s/it]Best trial: 22. Best value: 0.171781:  40%|████      | 40/100 [01:50<02:19,  2.33s/it]Best trial: 22. Best value: 0.171781:  41%|████      | 41/100 [01:50<02:24,  2.45s/it]Best trial: 22. Best value: 0.171781:  41%|████      | 41/100 [01:52<02:24,  2.45s/it]Best trial: 22. Best value: 0.171781:  42%|████▏     | 42/100 [01:52<02:15,  2.33s/it]Best trial: 22. Best value: 0.171781:  42%|████▏     | 42/100 [01:54<02:15,  2.33s/it]Best trial: 22. Best value: 0.171781:  43%|████▎     | 43/100 [01:54<02:07,  2.24s/it]Best trial: 22. Best value: 0.171781:  43%|████▎     | 43/100 [01:57<02:07,  2.24s/it]Best trial: 22. Best value: 0.171781:  44%|████▍     | 44/100 [01:57<02:20,  2.52s/it]Best trial: 22. Best value: 0.171781:  44%|████▍     | 44/100 [01:59<02:20,  2.52s/it]Best trial: 22. Best value: 0.171781:  45%|████▌     | 45/100 [01:59<02:16,  2.49s/it]Best trial: 22. Best value: 0.171781:  45%|████▌     | 45/100 [02:01<02:16,  2.49s/it]Best trial: 22. Best value: 0.171781:  46%|████▌     | 46/100 [02:01<02:02,  2.26s/it]Best trial: 22. Best value: 0.171781:  46%|████▌     | 46/100 [02:04<02:02,  2.26s/it]Best trial: 22. Best value: 0.171781:  47%|████▋     | 47/100 [02:04<02:09,  2.44s/it]Best trial: 22. Best value: 0.171781:  47%|████▋     | 47/100 [02:06<02:09,  2.44s/it]Best trial: 22. Best value: 0.171781:  48%|████▊     | 48/100 [02:06<02:01,  2.34s/it]Best trial: 22. Best value: 0.171781:  48%|████▊     | 48/100 [02:08<02:01,  2.34s/it]Best trial: 22. Best value: 0.171781:  49%|████▉     | 49/100 [02:08<01:49,  2.15s/it]Best trial: 49. Best value: 0.173553:  49%|████▉     | 49/100 [02:10<01:49,  2.15s/it]Best trial: 49. Best value: 0.173553:  50%|█████     | 50/100 [02:10<01:48,  2.17s/it]Best trial: 50. Best value: 0.178206:  50%|█████     | 50/100 [02:13<01:48,  2.17s/it]Best trial: 50. Best value: 0.178206:  51%|█████     | 51/100 [02:13<01:54,  2.34s/it]Best trial: 50. Best value: 0.178206:  51%|█████     | 51/100 [02:16<01:54,  2.34s/it]Best trial: 50. Best value: 0.178206:  52%|█████▏    | 52/100 [02:16<01:59,  2.49s/it]Best trial: 50. Best value: 0.178206:  52%|█████▏    | 52/100 [02:19<01:59,  2.49s/it]Best trial: 50. Best value: 0.178206:  53%|█████▎    | 53/100 [02:19<02:03,  2.63s/it]Best trial: 50. Best value: 0.178206:  53%|█████▎    | 53/100 [02:21<02:03,  2.63s/it]Best trial: 50. Best value: 0.178206:  54%|█████▍    | 54/100 [02:21<02:00,  2.63s/it]Best trial: 50. Best value: 0.178206:  54%|█████▍    | 54/100 [02:24<02:00,  2.63s/it]Best trial: 50. Best value: 0.178206:  55%|█████▌    | 55/100 [02:24<02:00,  2.68s/it]Best trial: 50. Best value: 0.178206:  55%|█████▌    | 55/100 [02:27<02:00,  2.68s/it]Best trial: 50. Best value: 0.178206:  56%|█████▌    | 56/100 [02:27<01:56,  2.64s/it]Best trial: 50. Best value: 0.178206:  56%|█████▌    | 56/100 [02:29<01:56,  2.64s/it]Best trial: 50. Best value: 0.178206:  57%|█████▋    | 57/100 [02:29<01:55,  2.68s/it]Best trial: 50. Best value: 0.178206:  57%|█████▋    | 57/100 [02:32<01:55,  2.68s/it]Best trial: 50. Best value: 0.178206:  58%|█████▊    | 58/100 [02:32<01:51,  2.65s/it]Best trial: 50. Best value: 0.178206:  58%|█████▊    | 58/100 [02:35<01:51,  2.65s/it]Best trial: 50. Best value: 0.178206:  59%|█████▉    | 59/100 [02:35<01:51,  2.71s/it]Best trial: 50. Best value: 0.178206:  59%|█████▉    | 59/100 [02:38<01:51,  2.71s/it]Best trial: 50. Best value: 0.178206:  60%|██████    | 60/100 [02:38<01:53,  2.83s/it]Best trial: 60. Best value: 0.184203:  60%|██████    | 60/100 [02:41<01:53,  2.83s/it]Best trial: 60. Best value: 0.184203:  61%|██████    | 61/100 [02:41<01:58,  3.04s/it]Best trial: 60. Best value: 0.184203:  61%|██████    | 61/100 [02:44<01:58,  3.04s/it]Best trial: 60. Best value: 0.184203:  62%|██████▏   | 62/100 [02:44<01:50,  2.90s/it]Best trial: 60. Best value: 0.184203:  62%|██████▏   | 62/100 [02:46<01:50,  2.90s/it]Best trial: 60. Best value: 0.184203:  63%|██████▎   | 63/100 [02:46<01:41,  2.76s/it]Best trial: 60. Best value: 0.184203:  63%|██████▎   | 63/100 [02:49<01:41,  2.76s/it]Best trial: 60. Best value: 0.184203:  64%|██████▍   | 64/100 [02:49<01:40,  2.80s/it]Best trial: 60. Best value: 0.184203:  64%|██████▍   | 64/100 [02:55<01:40,  2.80s/it]Best trial: 60. Best value: 0.184203:  65%|██████▌   | 65/100 [02:55<02:06,  3.61s/it]Best trial: 60. Best value: 0.184203:  65%|██████▌   | 65/100 [02:58<02:06,  3.61s/it]Best trial: 60. Best value: 0.184203:  66%|██████▌   | 66/100 [02:58<01:59,  3.52s/it]Best trial: 60. Best value: 0.184203:  66%|██████▌   | 66/100 [03:01<01:59,  3.52s/it]Best trial: 60. Best value: 0.184203:  67%|██████▋   | 67/100 [03:01<01:48,  3.28s/it]Best trial: 60. Best value: 0.184203:  67%|██████▋   | 67/100 [03:04<01:48,  3.28s/it]Best trial: 60. Best value: 0.184203:  68%|██████▊   | 68/100 [03:04<01:40,  3.14s/it]Best trial: 60. Best value: 0.184203:  68%|██████▊   | 68/100 [03:07<01:40,  3.14s/it]Best trial: 60. Best value: 0.184203:  69%|██████▉   | 69/100 [03:07<01:43,  3.35s/it]Best trial: 60. Best value: 0.184203:  69%|██████▉   | 69/100 [03:11<01:43,  3.35s/it]Best trial: 60. Best value: 0.184203:  70%|███████   | 70/100 [03:11<01:38,  3.27s/it]Best trial: 60. Best value: 0.184203:  70%|███████   | 70/100 [03:14<01:38,  3.27s/it]Best trial: 60. Best value: 0.184203:  71%|███████   | 71/100 [03:14<01:40,  3.45s/it]Best trial: 60. Best value: 0.184203:  71%|███████   | 71/100 [03:18<01:40,  3.45s/it]Best trial: 60. Best value: 0.184203:  72%|███████▏  | 72/100 [03:18<01:34,  3.39s/it]Best trial: 60. Best value: 0.184203:  72%|███████▏  | 72/100 [03:21<01:34,  3.39s/it]Best trial: 60. Best value: 0.184203:  73%|███████▎  | 73/100 [03:21<01:33,  3.47s/it]Best trial: 60. Best value: 0.184203:  73%|███████▎  | 73/100 [03:24<01:33,  3.47s/it]Best trial: 60. Best value: 0.184203:  74%|███████▍  | 74/100 [03:24<01:26,  3.35s/it]Best trial: 60. Best value: 0.184203:  74%|███████▍  | 74/100 [03:28<01:26,  3.35s/it]Best trial: 60. Best value: 0.184203:  75%|███████▌  | 75/100 [03:28<01:22,  3.31s/it]Best trial: 60. Best value: 0.184203:  75%|███████▌  | 75/100 [03:31<01:22,  3.31s/it]Best trial: 60. Best value: 0.184203:  76%|███████▌  | 76/100 [03:31<01:16,  3.20s/it]Best trial: 60. Best value: 0.184203:  76%|███████▌  | 76/100 [03:34<01:16,  3.20s/it]Best trial: 60. Best value: 0.184203:  77%|███████▋  | 77/100 [03:34<01:12,  3.13s/it]Best trial: 60. Best value: 0.184203:  77%|███████▋  | 77/100 [03:36<01:12,  3.13s/it]Best trial: 60. Best value: 0.184203:  78%|███████▊  | 78/100 [03:36<01:02,  2.83s/it]Best trial: 60. Best value: 0.184203:  78%|███████▊  | 78/100 [03:39<01:02,  2.83s/it]Best trial: 60. Best value: 0.184203:  79%|███████▉  | 79/100 [03:39<01:01,  2.92s/it]Best trial: 79. Best value: 0.206121:  79%|███████▉  | 79/100 [03:43<01:01,  2.92s/it]Best trial: 79. Best value: 0.206121:  80%|████████  | 80/100 [03:43<01:03,  3.19s/it]Best trial: 79. Best value: 0.206121:  80%|████████  | 80/100 [03:46<01:03,  3.19s/it]Best trial: 79. Best value: 0.206121:  81%|████████  | 81/100 [03:46<01:03,  3.33s/it]Best trial: 79. Best value: 0.206121:  81%|████████  | 81/100 [03:49<01:03,  3.33s/it]Best trial: 79. Best value: 0.206121:  82%|████████▏ | 82/100 [03:49<00:56,  3.16s/it]Best trial: 79. Best value: 0.206121:  82%|████████▏ | 82/100 [03:53<00:56,  3.16s/it]Best trial: 79. Best value: 0.206121:  83%|████████▎ | 83/100 [03:53<00:56,  3.34s/it]Best trial: 79. Best value: 0.206121:  83%|████████▎ | 83/100 [03:55<00:56,  3.34s/it]Best trial: 79. Best value: 0.206121:  84%|████████▍ | 84/100 [03:55<00:47,  2.97s/it]Best trial: 79. Best value: 0.206121:  84%|████████▍ | 84/100 [03:57<00:47,  2.97s/it]Best trial: 79. Best value: 0.206121:  85%|████████▌ | 85/100 [03:57<00:40,  2.71s/it]Best trial: 79. Best value: 0.206121:  85%|████████▌ | 85/100 [04:00<00:40,  2.71s/it]Best trial: 79. Best value: 0.206121:  86%|████████▌ | 86/100 [04:00<00:39,  2.82s/it]Best trial: 79. Best value: 0.206121:  86%|████████▌ | 86/100 [04:03<00:39,  2.82s/it]Best trial: 79. Best value: 0.206121:  87%|████████▋ | 87/100 [04:03<00:37,  2.89s/it]Best trial: 79. Best value: 0.206121:  87%|████████▋ | 87/100 [04:07<00:37,  2.89s/it]Best trial: 79. Best value: 0.206121:  88%|████████▊ | 88/100 [04:07<00:36,  3.06s/it]Best trial: 79. Best value: 0.206121:  88%|████████▊ | 88/100 [04:10<00:36,  3.06s/it]Best trial: 79. Best value: 0.206121:  89%|████████▉ | 89/100 [04:10<00:33,  3.06s/it]Best trial: 79. Best value: 0.206121:  89%|████████▉ | 89/100 [04:13<00:33,  3.06s/it]Best trial: 79. Best value: 0.206121:  90%|█████████ | 90/100 [04:13<00:31,  3.12s/it]Best trial: 79. Best value: 0.206121:  90%|█████████ | 90/100 [04:16<00:31,  3.12s/it]Best trial: 79. Best value: 0.206121:  91%|█████████ | 91/100 [04:16<00:27,  3.02s/it]Best trial: 79. Best value: 0.206121:  91%|█████████ | 91/100 [04:19<00:27,  3.02s/it]Best trial: 79. Best value: 0.206121:  92%|█████████▏| 92/100 [04:19<00:25,  3.14s/it]Best trial: 79. Best value: 0.206121:  92%|█████████▏| 92/100 [04:22<00:25,  3.14s/it]Best trial: 79. Best value: 0.206121:  93%|█████████▎| 93/100 [04:22<00:20,  2.97s/it]Best trial: 79. Best value: 0.206121:  93%|█████████▎| 93/100 [04:25<00:20,  2.97s/it]Best trial: 79. Best value: 0.206121:  94%|█████████▍| 94/100 [04:25<00:17,  2.99s/it]Best trial: 79. Best value: 0.206121:  94%|█████████▍| 94/100 [04:28<00:17,  2.99s/it]Best trial: 79. Best value: 0.206121:  95%|█████████▌| 95/100 [04:28<00:15,  3.15s/it]Best trial: 79. Best value: 0.206121:  95%|█████████▌| 95/100 [04:32<00:15,  3.15s/it]Best trial: 79. Best value: 0.206121:  96%|█████████▌| 96/100 [04:32<00:13,  3.38s/it]Best trial: 79. Best value: 0.206121:  96%|█████████▌| 96/100 [04:35<00:13,  3.38s/it]Best trial: 79. Best value: 0.206121:  97%|█████████▋| 97/100 [04:35<00:09,  3.31s/it]Best trial: 79. Best value: 0.206121:  97%|█████████▋| 97/100 [04:39<00:09,  3.31s/it]Best trial: 79. Best value: 0.206121:  98%|█████████▊| 98/100 [04:39<00:06,  3.29s/it]Best trial: 79. Best value: 0.206121:  98%|█████████▊| 98/100 [04:41<00:06,  3.29s/it]Best trial: 79. Best value: 0.206121:  99%|█████████▉| 99/100 [04:41<00:03,  3.09s/it]Best trial: 79. Best value: 0.206121:  99%|█████████▉| 99/100 [04:44<00:03,  3.09s/it]Best trial: 79. Best value: 0.206121: 100%|██████████| 100/100 [04:44<00:00,  3.11s/it]Best trial: 79. Best value: 0.206121: 100%|██████████| 100/100 [04:44<00:00,  2.85s/it]
2025-11-30 15:24:42,383 - INFO - HPO Complete. Best AUPRC: 0.2061
2025-11-30 15:24:42,383 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0003363677579592939, 'max_depth': 4, 'subsample': 0.6094800114132133, 'colsample_bytree': 0.8824397306969278, 'gamma': 2.715190481046827, 'reg_lambda': 4.4968424751881005e-06, 'reg_alpha': 6.720108896998392e-08}
2025-11-30 15:24:42,384 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:24:44,572 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 15:24:44,573 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:24:44,660 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:24:44,692 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:24:44,702 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:24:44,702 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:24:44,702 - INFO - Training model...
2025-11-30 15:24:49,951 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:24:55,425 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:24:55,426 - INFO - AUROC: 0.6419 (0.2096 - 0.8680)
2025-11-30 15:24:55,426 - INFO - AUPRC: 0.0771 (0.0046 - 0.4824)
2025-11-30 15:24:55,426 - INFO - Brier Score: 0.1477 (0.1465 - 0.1498)
2025-11-30 15:24:55,426 - INFO - Accuracy: 0.9899 (0.0043 - 0.9954)
2025-11-30 15:24:55,426 - INFO - Precision: 0.3333 (0.0043 - 1.0000)
2025-11-30 15:24:55,426 - INFO - Sensitivity (Recall): 0.1667 (0.1067 - 1.0000)
2025-11-30 15:24:55,426 - INFO - F1-Score: 0.2222 (0.0086 - 0.6600)
2025-11-30 15:24:55,426 - INFO - Best Threshold: 0.4600 (0.0100 - 0.4600)
2025-11-30 15:24:55,426 - INFO - Specificity: 0.9971 (0.0000 - 1.0000)
2025-11-30 15:24:55,445 - INFO - Calculating SHAP values...
2025-11-30 15:24:56,536 - INFO - SHAP plots saved.
2025-11-30 15:24:56,538 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:24:57,699 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 15:24:57,699 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:24:57,785 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:24:57,816 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:24:57,824 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:24:57,824 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0770195:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0770195:   1%|          | 1/100 [00:02<04:51,  2.94s/it]Best trial: 0. Best value: 0.0770195:   1%|          | 1/100 [00:05<04:51,  2.94s/it]Best trial: 0. Best value: 0.0770195:   2%|▏         | 2/100 [00:05<04:36,  2.82s/it]Best trial: 2. Best value: 0.0811794:   2%|▏         | 2/100 [00:09<04:36,  2.82s/it]Best trial: 2. Best value: 0.0811794:   3%|▎         | 3/100 [00:09<05:14,  3.24s/it]Best trial: 2. Best value: 0.0811794:   3%|▎         | 3/100 [00:11<05:14,  3.24s/it]Best trial: 2. Best value: 0.0811794:   4%|▍         | 4/100 [00:11<04:25,  2.77s/it]Best trial: 4. Best value: 0.154279:   4%|▍         | 4/100 [00:13<04:25,  2.77s/it] Best trial: 4. Best value: 0.154279:   5%|▌         | 5/100 [00:13<04:12,  2.66s/it]Best trial: 4. Best value: 0.154279:   5%|▌         | 5/100 [00:16<04:12,  2.66s/it]Best trial: 4. Best value: 0.154279:   6%|▌         | 6/100 [00:16<04:19,  2.76s/it]Best trial: 4. Best value: 0.154279:   6%|▌         | 6/100 [00:19<04:19,  2.76s/it]Best trial: 4. Best value: 0.154279:   7%|▋         | 7/100 [00:19<04:19,  2.79s/it]Best trial: 4. Best value: 0.154279:   7%|▋         | 7/100 [00:23<04:19,  2.79s/it]Best trial: 4. Best value: 0.154279:   8%|▊         | 8/100 [00:23<04:59,  3.25s/it]Best trial: 4. Best value: 0.154279:   8%|▊         | 8/100 [00:27<04:59,  3.25s/it]Best trial: 4. Best value: 0.154279:   9%|▉         | 9/100 [00:27<04:56,  3.26s/it]Best trial: 4. Best value: 0.154279:   9%|▉         | 9/100 [00:30<04:56,  3.26s/it]Best trial: 4. Best value: 0.154279:  10%|█         | 10/100 [00:30<04:43,  3.15s/it]Best trial: 4. Best value: 0.154279:  10%|█         | 10/100 [00:34<04:43,  3.15s/it]Best trial: 4. Best value: 0.154279:  11%|█         | 11/100 [00:34<05:23,  3.64s/it]Best trial: 4. Best value: 0.154279:  11%|█         | 11/100 [00:38<05:23,  3.64s/it]Best trial: 4. Best value: 0.154279:  12%|█▏        | 12/100 [00:38<05:30,  3.75s/it]Best trial: 4. Best value: 0.154279:  12%|█▏        | 12/100 [00:42<05:30,  3.75s/it]Best trial: 4. Best value: 0.154279:  13%|█▎        | 13/100 [00:42<05:29,  3.79s/it]Best trial: 4. Best value: 0.154279:  13%|█▎        | 13/100 [00:46<05:29,  3.79s/it]Best trial: 4. Best value: 0.154279:  14%|█▍        | 14/100 [00:46<05:12,  3.63s/it]Best trial: 4. Best value: 0.154279:  14%|█▍        | 14/100 [00:49<05:12,  3.63s/it]Best trial: 4. Best value: 0.154279:  15%|█▌        | 15/100 [00:49<05:05,  3.60s/it]Best trial: 4. Best value: 0.154279:  15%|█▌        | 15/100 [00:51<05:05,  3.60s/it]Best trial: 4. Best value: 0.154279:  16%|█▌        | 16/100 [00:51<04:31,  3.23s/it]Best trial: 4. Best value: 0.154279:  16%|█▌        | 16/100 [00:55<04:31,  3.23s/it]Best trial: 4. Best value: 0.154279:  17%|█▋        | 17/100 [00:55<04:25,  3.20s/it]Best trial: 4. Best value: 0.154279:  17%|█▋        | 17/100 [00:58<04:25,  3.20s/it]Best trial: 4. Best value: 0.154279:  18%|█▊        | 18/100 [00:58<04:31,  3.31s/it]Best trial: 4. Best value: 0.154279:  18%|█▊        | 18/100 [01:02<04:31,  3.31s/it]Best trial: 4. Best value: 0.154279:  19%|█▉        | 19/100 [01:02<04:39,  3.45s/it]Best trial: 4. Best value: 0.154279:  19%|█▉        | 19/100 [01:06<04:39,  3.45s/it]Best trial: 4. Best value: 0.154279:  20%|██        | 20/100 [01:06<04:50,  3.63s/it]Best trial: 4. Best value: 0.154279:  20%|██        | 20/100 [01:09<04:50,  3.63s/it]Best trial: 4. Best value: 0.154279:  21%|██        | 21/100 [01:09<04:28,  3.40s/it]Best trial: 4. Best value: 0.154279:  21%|██        | 21/100 [01:12<04:28,  3.40s/it]Best trial: 4. Best value: 0.154279:  22%|██▏       | 22/100 [01:12<04:15,  3.27s/it]Best trial: 4. Best value: 0.154279:  22%|██▏       | 22/100 [01:15<04:15,  3.27s/it]Best trial: 4. Best value: 0.154279:  23%|██▎       | 23/100 [01:15<04:09,  3.24s/it]Best trial: 4. Best value: 0.154279:  23%|██▎       | 23/100 [01:18<04:09,  3.24s/it]Best trial: 4. Best value: 0.154279:  24%|██▍       | 24/100 [01:18<04:05,  3.24s/it]Best trial: 4. Best value: 0.154279:  24%|██▍       | 24/100 [01:22<04:05,  3.24s/it]Best trial: 4. Best value: 0.154279:  25%|██▌       | 25/100 [01:22<04:20,  3.48s/it]Best trial: 4. Best value: 0.154279:  25%|██▌       | 25/100 [01:26<04:20,  3.48s/it]Best trial: 4. Best value: 0.154279:  26%|██▌       | 26/100 [01:26<04:24,  3.57s/it]Best trial: 4. Best value: 0.154279:  26%|██▌       | 26/100 [01:30<04:24,  3.57s/it]Best trial: 4. Best value: 0.154279:  27%|██▋       | 27/100 [01:30<04:31,  3.72s/it]Best trial: 4. Best value: 0.154279:  27%|██▋       | 27/100 [01:33<04:31,  3.72s/it]Best trial: 4. Best value: 0.154279:  28%|██▊       | 28/100 [01:33<04:10,  3.48s/it]Best trial: 4. Best value: 0.154279:  28%|██▊       | 28/100 [01:37<04:10,  3.48s/it]Best trial: 4. Best value: 0.154279:  29%|██▉       | 29/100 [01:37<04:14,  3.58s/it]Best trial: 4. Best value: 0.154279:  29%|██▉       | 29/100 [01:40<04:14,  3.58s/it]Best trial: 4. Best value: 0.154279:  30%|███       | 30/100 [01:40<03:54,  3.36s/it]Best trial: 4. Best value: 0.154279:  30%|███       | 30/100 [01:43<03:54,  3.36s/it]Best trial: 4. Best value: 0.154279:  31%|███       | 31/100 [01:43<03:51,  3.36s/it]Best trial: 4. Best value: 0.154279:  31%|███       | 31/100 [01:46<03:51,  3.36s/it]Best trial: 4. Best value: 0.154279:  32%|███▏      | 32/100 [01:46<03:34,  3.15s/it]Best trial: 4. Best value: 0.154279:  32%|███▏      | 32/100 [01:49<03:34,  3.15s/it]Best trial: 4. Best value: 0.154279:  33%|███▎      | 33/100 [01:49<03:37,  3.25s/it]Best trial: 4. Best value: 0.154279:  33%|███▎      | 33/100 [01:54<03:37,  3.25s/it]Best trial: 4. Best value: 0.154279:  34%|███▍      | 34/100 [01:54<04:02,  3.67s/it]Best trial: 4. Best value: 0.154279:  34%|███▍      | 34/100 [01:57<04:02,  3.67s/it]Best trial: 4. Best value: 0.154279:  35%|███▌      | 35/100 [01:57<03:55,  3.63s/it]Best trial: 4. Best value: 0.154279:  35%|███▌      | 35/100 [02:00<03:55,  3.63s/it]Best trial: 4. Best value: 0.154279:  36%|███▌      | 36/100 [02:00<03:40,  3.45s/it]Best trial: 4. Best value: 0.154279:  36%|███▌      | 36/100 [02:03<03:40,  3.45s/it]Best trial: 4. Best value: 0.154279:  37%|███▋      | 37/100 [02:03<03:17,  3.13s/it]Best trial: 37. Best value: 0.165467:  37%|███▋      | 37/100 [02:05<03:17,  3.13s/it]Best trial: 37. Best value: 0.165467:  38%|███▊      | 38/100 [02:05<03:01,  2.93s/it]Best trial: 37. Best value: 0.165467:  38%|███▊      | 38/100 [02:08<03:01,  2.93s/it]Best trial: 37. Best value: 0.165467:  39%|███▉      | 39/100 [02:08<02:48,  2.76s/it]Best trial: 37. Best value: 0.165467:  39%|███▉      | 39/100 [02:10<02:48,  2.76s/it]Best trial: 37. Best value: 0.165467:  40%|████      | 40/100 [02:10<02:32,  2.54s/it]Best trial: 37. Best value: 0.165467:  40%|████      | 40/100 [02:12<02:32,  2.54s/it]Best trial: 37. Best value: 0.165467:  41%|████      | 41/100 [02:12<02:30,  2.55s/it]Best trial: 37. Best value: 0.165467:  41%|████      | 41/100 [02:15<02:30,  2.55s/it]Best trial: 37. Best value: 0.165467:  42%|████▏     | 42/100 [02:15<02:35,  2.69s/it]Best trial: 37. Best value: 0.165467:  42%|████▏     | 42/100 [02:18<02:35,  2.69s/it]Best trial: 37. Best value: 0.165467:  43%|████▎     | 43/100 [02:18<02:31,  2.66s/it]Best trial: 37. Best value: 0.165467:  43%|████▎     | 43/100 [02:21<02:31,  2.66s/it]Best trial: 37. Best value: 0.165467:  44%|████▍     | 44/100 [02:21<02:30,  2.68s/it]Best trial: 37. Best value: 0.165467:  44%|████▍     | 44/100 [02:23<02:30,  2.68s/it]Best trial: 37. Best value: 0.165467:  45%|████▌     | 45/100 [02:23<02:20,  2.55s/it]Best trial: 37. Best value: 0.165467:  45%|████▌     | 45/100 [02:25<02:20,  2.55s/it]Best trial: 37. Best value: 0.165467:  46%|████▌     | 46/100 [02:25<02:08,  2.37s/it]Best trial: 37. Best value: 0.165467:  46%|████▌     | 46/100 [02:27<02:08,  2.37s/it]Best trial: 37. Best value: 0.165467:  47%|████▋     | 47/100 [02:27<02:02,  2.31s/it]Best trial: 37. Best value: 0.165467:  47%|████▋     | 47/100 [02:30<02:02,  2.31s/it]Best trial: 37. Best value: 0.165467:  48%|████▊     | 48/100 [02:30<02:14,  2.58s/it]Best trial: 37. Best value: 0.165467:  48%|████▊     | 48/100 [02:33<02:14,  2.58s/it]Best trial: 37. Best value: 0.165467:  49%|████▉     | 49/100 [02:33<02:14,  2.63s/it]Best trial: 37. Best value: 0.165467:  49%|████▉     | 49/100 [02:37<02:14,  2.63s/it]Best trial: 37. Best value: 0.165467:  50%|█████     | 50/100 [02:37<02:28,  2.97s/it]Best trial: 37. Best value: 0.165467:  50%|█████     | 50/100 [02:39<02:28,  2.97s/it]Best trial: 37. Best value: 0.165467:  51%|█████     | 51/100 [02:39<02:15,  2.76s/it]Best trial: 37. Best value: 0.165467:  51%|█████     | 51/100 [02:41<02:15,  2.76s/it]Best trial: 37. Best value: 0.165467:  52%|█████▏    | 52/100 [02:41<02:06,  2.64s/it]Best trial: 37. Best value: 0.165467:  52%|█████▏    | 52/100 [02:43<02:06,  2.64s/it]Best trial: 37. Best value: 0.165467:  53%|█████▎    | 53/100 [02:43<01:56,  2.47s/it]Best trial: 37. Best value: 0.165467:  53%|█████▎    | 53/100 [02:45<01:56,  2.47s/it]Best trial: 37. Best value: 0.165467:  54%|█████▍    | 54/100 [02:45<01:47,  2.33s/it]Best trial: 37. Best value: 0.165467:  54%|█████▍    | 54/100 [02:48<01:47,  2.33s/it]Best trial: 37. Best value: 0.165467:  55%|█████▌    | 55/100 [02:48<01:49,  2.43s/it]Best trial: 37. Best value: 0.165467:  55%|█████▌    | 55/100 [02:51<01:49,  2.43s/it]Best trial: 37. Best value: 0.165467:  56%|█████▌    | 56/100 [02:51<01:50,  2.51s/it]Best trial: 37. Best value: 0.165467:  56%|█████▌    | 56/100 [02:53<01:50,  2.51s/it]Best trial: 37. Best value: 0.165467:  57%|█████▋    | 57/100 [02:53<01:45,  2.45s/it]Best trial: 37. Best value: 0.165467:  57%|█████▋    | 57/100 [02:56<01:45,  2.45s/it]Best trial: 37. Best value: 0.165467:  58%|█████▊    | 58/100 [02:56<01:45,  2.51s/it]Best trial: 37. Best value: 0.165467:  58%|█████▊    | 58/100 [02:59<01:45,  2.51s/it]Best trial: 37. Best value: 0.165467:  59%|█████▉    | 59/100 [02:59<01:47,  2.61s/it]Best trial: 37. Best value: 0.165467:  59%|█████▉    | 59/100 [03:01<01:47,  2.61s/it]Best trial: 37. Best value: 0.165467:  60%|██████    | 60/100 [03:01<01:42,  2.56s/it]Best trial: 37. Best value: 0.165467:  60%|██████    | 60/100 [03:04<01:42,  2.56s/it]Best trial: 37. Best value: 0.165467:  61%|██████    | 61/100 [03:04<01:44,  2.67s/it]Best trial: 37. Best value: 0.165467:  61%|██████    | 61/100 [03:07<01:44,  2.67s/it]Best trial: 37. Best value: 0.165467:  62%|██████▏   | 62/100 [03:07<01:41,  2.66s/it]Best trial: 37. Best value: 0.165467:  62%|██████▏   | 62/100 [03:09<01:41,  2.66s/it]Best trial: 37. Best value: 0.165467:  63%|██████▎   | 63/100 [03:09<01:35,  2.57s/it]Best trial: 37. Best value: 0.165467:  63%|██████▎   | 63/100 [03:12<01:35,  2.57s/it]Best trial: 37. Best value: 0.165467:  64%|██████▍   | 64/100 [03:12<01:36,  2.67s/it]Best trial: 64. Best value: 0.19251:  64%|██████▍   | 64/100 [03:14<01:36,  2.67s/it] Best trial: 64. Best value: 0.19251:  65%|██████▌   | 65/100 [03:14<01:29,  2.55s/it]Best trial: 64. Best value: 0.19251:  65%|██████▌   | 65/100 [03:16<01:29,  2.55s/it]Best trial: 64. Best value: 0.19251:  66%|██████▌   | 66/100 [03:16<01:22,  2.42s/it]Best trial: 64. Best value: 0.19251:  66%|██████▌   | 66/100 [03:18<01:22,  2.42s/it]Best trial: 64. Best value: 0.19251:  67%|██████▋   | 67/100 [03:18<01:16,  2.31s/it]Best trial: 64. Best value: 0.19251:  67%|██████▋   | 67/100 [03:20<01:16,  2.31s/it]Best trial: 64. Best value: 0.19251:  68%|██████▊   | 68/100 [03:20<01:09,  2.18s/it]Best trial: 64. Best value: 0.19251:  68%|██████▊   | 68/100 [03:22<01:09,  2.18s/it]Best trial: 64. Best value: 0.19251:  69%|██████▉   | 69/100 [03:22<01:07,  2.19s/it]Best trial: 64. Best value: 0.19251:  69%|██████▉   | 69/100 [03:25<01:07,  2.19s/it]Best trial: 64. Best value: 0.19251:  70%|███████   | 70/100 [03:25<01:05,  2.19s/it]Best trial: 64. Best value: 0.19251:  70%|███████   | 70/100 [03:30<01:05,  2.19s/it]Best trial: 64. Best value: 0.19251:  71%|███████   | 71/100 [03:30<01:35,  3.31s/it]Best trial: 71. Best value: 0.227846:  71%|███████   | 71/100 [03:33<01:35,  3.31s/it]Best trial: 71. Best value: 0.227846:  72%|███████▏  | 72/100 [03:33<01:28,  3.16s/it]Best trial: 71. Best value: 0.227846:  72%|███████▏  | 72/100 [03:36<01:28,  3.16s/it]Best trial: 71. Best value: 0.227846:  73%|███████▎  | 73/100 [03:36<01:20,  2.98s/it]Best trial: 71. Best value: 0.227846:  73%|███████▎  | 73/100 [03:39<01:20,  2.98s/it]Best trial: 71. Best value: 0.227846:  74%|███████▍  | 74/100 [03:39<01:15,  2.90s/it]Best trial: 71. Best value: 0.227846:  74%|███████▍  | 74/100 [03:41<01:15,  2.90s/it]Best trial: 71. Best value: 0.227846:  75%|███████▌  | 75/100 [03:41<01:05,  2.63s/it]Best trial: 71. Best value: 0.227846:  75%|███████▌  | 75/100 [03:43<01:05,  2.63s/it]Best trial: 71. Best value: 0.227846:  76%|███████▌  | 76/100 [03:43<01:04,  2.67s/it]Best trial: 71. Best value: 0.227846:  76%|███████▌  | 76/100 [03:46<01:04,  2.67s/it]Best trial: 71. Best value: 0.227846:  77%|███████▋  | 77/100 [03:46<01:01,  2.67s/it]Best trial: 71. Best value: 0.227846:  77%|███████▋  | 77/100 [03:49<01:01,  2.67s/it]Best trial: 71. Best value: 0.227846:  78%|███████▊  | 78/100 [03:49<01:00,  2.77s/it]Best trial: 71. Best value: 0.227846:  78%|███████▊  | 78/100 [03:51<01:00,  2.77s/it]Best trial: 71. Best value: 0.227846:  79%|███████▉  | 79/100 [03:51<00:56,  2.69s/it]Best trial: 71. Best value: 0.227846:  79%|███████▉  | 79/100 [03:55<00:56,  2.69s/it]Best trial: 71. Best value: 0.227846:  80%|████████  | 80/100 [03:55<00:56,  2.83s/it]Best trial: 71. Best value: 0.227846:  80%|████████  | 80/100 [03:57<00:56,  2.83s/it]Best trial: 71. Best value: 0.227846:  81%|████████  | 81/100 [03:57<00:50,  2.66s/it]Best trial: 71. Best value: 0.227846:  81%|████████  | 81/100 [03:59<00:50,  2.66s/it]Best trial: 71. Best value: 0.227846:  82%|████████▏ | 82/100 [03:59<00:45,  2.50s/it]Best trial: 71. Best value: 0.227846:  82%|████████▏ | 82/100 [04:02<00:45,  2.50s/it]Best trial: 71. Best value: 0.227846:  83%|████████▎ | 83/100 [04:02<00:42,  2.50s/it]Best trial: 71. Best value: 0.227846:  83%|████████▎ | 83/100 [04:04<00:42,  2.50s/it]Best trial: 71. Best value: 0.227846:  84%|████████▍ | 84/100 [04:04<00:38,  2.43s/it]Best trial: 71. Best value: 0.227846:  84%|████████▍ | 84/100 [04:06<00:38,  2.43s/it]Best trial: 71. Best value: 0.227846:  85%|████████▌ | 85/100 [04:06<00:37,  2.50s/it]Best trial: 71. Best value: 0.227846:  85%|████████▌ | 85/100 [04:09<00:37,  2.50s/it]Best trial: 71. Best value: 0.227846:  86%|████████▌ | 86/100 [04:09<00:36,  2.58s/it]Best trial: 71. Best value: 0.227846:  86%|████████▌ | 86/100 [04:12<00:36,  2.58s/it]Best trial: 71. Best value: 0.227846:  87%|████████▋ | 87/100 [04:12<00:35,  2.69s/it]Best trial: 71. Best value: 0.227846:  87%|████████▋ | 87/100 [04:14<00:35,  2.69s/it]Best trial: 71. Best value: 0.227846:  88%|████████▊ | 88/100 [04:14<00:30,  2.52s/it]Best trial: 71. Best value: 0.227846:  88%|████████▊ | 88/100 [04:17<00:30,  2.52s/it]Best trial: 71. Best value: 0.227846:  89%|████████▉ | 89/100 [04:17<00:29,  2.68s/it]Best trial: 71. Best value: 0.227846:  89%|████████▉ | 89/100 [04:20<00:29,  2.68s/it]Best trial: 71. Best value: 0.227846:  90%|█████████ | 90/100 [04:20<00:27,  2.75s/it]Best trial: 71. Best value: 0.227846:  90%|█████████ | 90/100 [04:23<00:27,  2.75s/it]Best trial: 71. Best value: 0.227846:  91%|█████████ | 91/100 [04:23<00:24,  2.72s/it]Best trial: 71. Best value: 0.227846:  91%|█████████ | 91/100 [04:26<00:24,  2.72s/it]Best trial: 71. Best value: 0.227846:  92%|█████████▏| 92/100 [04:26<00:22,  2.76s/it]Best trial: 71. Best value: 0.227846:  92%|█████████▏| 92/100 [04:28<00:22,  2.76s/it]Best trial: 71. Best value: 0.227846:  93%|█████████▎| 93/100 [04:28<00:17,  2.52s/it]Best trial: 71. Best value: 0.227846:  93%|█████████▎| 93/100 [04:30<00:17,  2.52s/it]Best trial: 71. Best value: 0.227846:  94%|█████████▍| 94/100 [04:30<00:14,  2.41s/it]Best trial: 71. Best value: 0.227846:  94%|█████████▍| 94/100 [04:32<00:14,  2.41s/it]Best trial: 71. Best value: 0.227846:  95%|█████████▌| 95/100 [04:32<00:11,  2.23s/it]Best trial: 71. Best value: 0.227846:  95%|█████████▌| 95/100 [04:34<00:11,  2.23s/it]Best trial: 71. Best value: 0.227846:  96%|█████████▌| 96/100 [04:34<00:08,  2.22s/it]Best trial: 71. Best value: 0.227846:  96%|█████████▌| 96/100 [04:36<00:08,  2.22s/it]Best trial: 71. Best value: 0.227846:  97%|█████████▋| 97/100 [04:36<00:06,  2.05s/it]Best trial: 71. Best value: 0.227846:  97%|█████████▋| 97/100 [04:37<00:06,  2.05s/it]Best trial: 71. Best value: 0.227846:  98%|█████████▊| 98/100 [04:37<00:03,  1.87s/it]Best trial: 71. Best value: 0.227846:  98%|█████████▊| 98/100 [04:39<00:03,  1.87s/it]Best trial: 71. Best value: 0.227846:  99%|█████████▉| 99/100 [04:39<00:01,  1.79s/it]Best trial: 71. Best value: 0.227846:  99%|█████████▉| 99/100 [04:40<00:01,  1.79s/it]Best trial: 71. Best value: 0.227846: 100%|██████████| 100/100 [04:40<00:00,  1.78s/it]Best trial: 71. Best value: 0.227846: 100%|██████████| 100/100 [04:40<00:00,  2.81s/it]
2025-11-30 15:29:38,688 - INFO - HPO Complete. Best AUPRC: 0.2278
2025-11-30 15:29:38,689 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.03218089035307295, 'max_depth': 3, 'subsample': 0.7952135639659905, 'colsample_bytree': 0.7650960117393115, 'gamma': 3.649177525203017, 'reg_lambda': 0.0074632172554936135, 'reg_alpha': 0.235874650577633}
2025-11-30 15:29:38,689 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:29:40,771 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 15:29:40,771 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:29:40,872 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:29:40,905 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:29:40,915 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:29:40,915 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:29:40,915 - INFO - Training model...
2025-11-30 15:29:42,411 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:29:48,037 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:29:48,038 - INFO - AUROC: 0.5112 (0.0179 - 0.7187)
2025-11-30 15:29:48,038 - INFO - AUPRC: 0.0467 (0.0039 - 0.3807)
2025-11-30 15:29:48,038 - INFO - Brier Score: 0.0091 (0.0047 - 0.0154)
2025-11-30 15:29:48,038 - INFO - Accuracy: 0.9870 (0.8194 - 0.9936)
2025-11-30 15:29:48,038 - INFO - Precision: 0.2000 (0.0000 - 0.7000)
2025-11-30 15:29:48,038 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.6267)
2025-11-30 15:29:48,038 - INFO - F1-Score: 0.1818 (0.0000 - 0.5769)
2025-11-30 15:29:48,038 - INFO - Best Threshold: 0.2000 (0.0100 - 0.2000)
2025-11-30 15:29:48,038 - INFO - Specificity: 0.9942 (0.8251 - 0.9991)
2025-11-30 15:29:48,048 - INFO - Calculating SHAP values...
2025-11-30 15:29:49,065 - INFO - SHAP plots saved.
2025-11-30 15:29:49,066 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=non_windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:29:50,274 - INFO - Starting HPO for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 15:29:50,274 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:29:50,360 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:29:50,392 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:29:50,399 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:29:50,399 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0697573:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0697573:   1%|          | 1/100 [00:01<02:59,  1.81s/it]Best trial: 1. Best value: 0.0735351:   1%|          | 1/100 [00:04<02:59,  1.81s/it]Best trial: 1. Best value: 0.0735351:   2%|▏         | 2/100 [00:04<03:23,  2.08s/it]Best trial: 1. Best value: 0.0735351:   2%|▏         | 2/100 [00:07<03:23,  2.08s/it]Best trial: 1. Best value: 0.0735351:   3%|▎         | 3/100 [00:07<04:07,  2.55s/it]Best trial: 1. Best value: 0.0735351:   3%|▎         | 3/100 [00:09<04:07,  2.55s/it]Best trial: 1. Best value: 0.0735351:   4%|▍         | 4/100 [00:09<03:41,  2.30s/it]Best trial: 4. Best value: 0.0740963:   4%|▍         | 4/100 [00:11<03:41,  2.30s/it]Best trial: 4. Best value: 0.0740963:   5%|▌         | 5/100 [00:11<03:25,  2.16s/it]Best trial: 5. Best value: 0.115177:   5%|▌         | 5/100 [00:13<03:25,  2.16s/it] Best trial: 5. Best value: 0.115177:   6%|▌         | 6/100 [00:13<03:26,  2.20s/it]Best trial: 5. Best value: 0.115177:   6%|▌         | 6/100 [00:15<03:26,  2.20s/it]Best trial: 5. Best value: 0.115177:   7%|▋         | 7/100 [00:15<03:36,  2.33s/it]Best trial: 5. Best value: 0.115177:   7%|▋         | 7/100 [00:18<03:36,  2.33s/it]Best trial: 5. Best value: 0.115177:   8%|▊         | 8/100 [00:18<03:52,  2.53s/it]Best trial: 5. Best value: 0.115177:   8%|▊         | 8/100 [00:21<03:52,  2.53s/it]Best trial: 5. Best value: 0.115177:   9%|▉         | 9/100 [00:21<03:43,  2.46s/it]Best trial: 9. Best value: 0.126406:   9%|▉         | 9/100 [00:22<03:43,  2.46s/it]Best trial: 9. Best value: 0.126406:  10%|█         | 10/100 [00:22<03:17,  2.20s/it]Best trial: 9. Best value: 0.126406:  10%|█         | 10/100 [00:24<03:17,  2.20s/it]Best trial: 9. Best value: 0.126406:  11%|█         | 11/100 [00:24<03:07,  2.10s/it]Best trial: 11. Best value: 0.129758:  11%|█         | 11/100 [00:26<03:07,  2.10s/it]Best trial: 11. Best value: 0.129758:  12%|█▏        | 12/100 [00:26<02:58,  2.03s/it]Best trial: 11. Best value: 0.129758:  12%|█▏        | 12/100 [00:28<02:58,  2.03s/it]Best trial: 11. Best value: 0.129758:  13%|█▎        | 13/100 [00:28<02:49,  1.95s/it]Best trial: 11. Best value: 0.129758:  13%|█▎        | 13/100 [00:29<02:49,  1.95s/it]Best trial: 11. Best value: 0.129758:  14%|█▍        | 14/100 [00:29<02:38,  1.84s/it]Best trial: 11. Best value: 0.129758:  14%|█▍        | 14/100 [00:31<02:38,  1.84s/it]Best trial: 11. Best value: 0.129758:  15%|█▌        | 15/100 [00:31<02:34,  1.82s/it]Best trial: 11. Best value: 0.129758:  15%|█▌        | 15/100 [00:33<02:34,  1.82s/it]Best trial: 11. Best value: 0.129758:  16%|█▌        | 16/100 [00:33<02:25,  1.74s/it]Best trial: 11. Best value: 0.129758:  16%|█▌        | 16/100 [00:34<02:25,  1.74s/it]Best trial: 11. Best value: 0.129758:  17%|█▋        | 17/100 [00:34<02:20,  1.69s/it]Best trial: 11. Best value: 0.129758:  17%|█▋        | 17/100 [00:36<02:20,  1.69s/it]Best trial: 11. Best value: 0.129758:  18%|█▊        | 18/100 [00:36<02:19,  1.70s/it]Best trial: 11. Best value: 0.129758:  18%|█▊        | 18/100 [00:38<02:19,  1.70s/it]Best trial: 11. Best value: 0.129758:  19%|█▉        | 19/100 [00:38<02:26,  1.80s/it]Best trial: 11. Best value: 0.129758:  19%|█▉        | 19/100 [00:40<02:26,  1.80s/it]Best trial: 11. Best value: 0.129758:  20%|██        | 20/100 [00:40<02:32,  1.90s/it]Best trial: 11. Best value: 0.129758:  20%|██        | 20/100 [00:42<02:32,  1.90s/it]Best trial: 11. Best value: 0.129758:  21%|██        | 21/100 [00:42<02:35,  1.97s/it]Best trial: 21. Best value: 0.142834:  21%|██        | 21/100 [00:44<02:35,  1.97s/it]Best trial: 21. Best value: 0.142834:  22%|██▏       | 22/100 [00:44<02:30,  1.93s/it]Best trial: 21. Best value: 0.142834:  22%|██▏       | 22/100 [00:46<02:30,  1.93s/it]Best trial: 21. Best value: 0.142834:  23%|██▎       | 23/100 [00:46<02:24,  1.88s/it]Best trial: 23. Best value: 0.168191:  23%|██▎       | 23/100 [00:47<02:24,  1.88s/it]Best trial: 23. Best value: 0.168191:  24%|██▍       | 24/100 [00:47<02:11,  1.73s/it]Best trial: 23. Best value: 0.168191:  24%|██▍       | 24/100 [00:49<02:11,  1.73s/it]Best trial: 23. Best value: 0.168191:  25%|██▌       | 25/100 [00:49<02:08,  1.72s/it]Best trial: 23. Best value: 0.168191:  25%|██▌       | 25/100 [00:50<02:08,  1.72s/it]Best trial: 23. Best value: 0.168191:  26%|██▌       | 26/100 [00:50<02:01,  1.64s/it]Best trial: 23. Best value: 0.168191:  26%|██▌       | 26/100 [00:52<02:01,  1.64s/it]Best trial: 23. Best value: 0.168191:  27%|██▋       | 27/100 [00:52<01:59,  1.64s/it]Best trial: 23. Best value: 0.168191:  27%|██▋       | 27/100 [00:54<01:59,  1.64s/it]Best trial: 23. Best value: 0.168191:  28%|██▊       | 28/100 [00:54<01:59,  1.66s/it]Best trial: 23. Best value: 0.168191:  28%|██▊       | 28/100 [00:56<01:59,  1.66s/it]Best trial: 23. Best value: 0.168191:  29%|██▉       | 29/100 [00:56<02:02,  1.73s/it]Best trial: 23. Best value: 0.168191:  29%|██▉       | 29/100 [00:58<02:02,  1.73s/it]Best trial: 23. Best value: 0.168191:  30%|███       | 30/100 [00:58<02:05,  1.80s/it]Best trial: 23. Best value: 0.168191:  30%|███       | 30/100 [00:59<02:05,  1.80s/it]Best trial: 23. Best value: 0.168191:  31%|███       | 31/100 [00:59<01:59,  1.73s/it]Best trial: 31. Best value: 0.198738:  31%|███       | 31/100 [01:01<01:59,  1.73s/it]Best trial: 31. Best value: 0.198738:  32%|███▏      | 32/100 [01:01<01:51,  1.64s/it]Best trial: 31. Best value: 0.198738:  32%|███▏      | 32/100 [01:02<01:51,  1.64s/it]Best trial: 31. Best value: 0.198738:  33%|███▎      | 33/100 [01:02<01:52,  1.68s/it]Best trial: 31. Best value: 0.198738:  33%|███▎      | 33/100 [01:04<01:52,  1.68s/it]Best trial: 31. Best value: 0.198738:  34%|███▍      | 34/100 [01:04<01:48,  1.64s/it]Best trial: 31. Best value: 0.198738:  34%|███▍      | 34/100 [01:06<01:48,  1.64s/it]Best trial: 31. Best value: 0.198738:  35%|███▌      | 35/100 [01:06<01:53,  1.75s/it]Best trial: 31. Best value: 0.198738:  35%|███▌      | 35/100 [01:07<01:53,  1.75s/it]Best trial: 31. Best value: 0.198738:  36%|███▌      | 36/100 [01:07<01:47,  1.68s/it]Best trial: 31. Best value: 0.198738:  36%|███▌      | 36/100 [01:09<01:47,  1.68s/it]Best trial: 31. Best value: 0.198738:  37%|███▋      | 37/100 [01:09<01:49,  1.74s/it]Best trial: 31. Best value: 0.198738:  37%|███▋      | 37/100 [01:11<01:49,  1.74s/it]Best trial: 31. Best value: 0.198738:  38%|███▊      | 38/100 [01:11<01:49,  1.77s/it]Best trial: 31. Best value: 0.198738:  38%|███▊      | 38/100 [01:13<01:49,  1.77s/it]Best trial: 31. Best value: 0.198738:  39%|███▉      | 39/100 [01:13<01:56,  1.90s/it]Best trial: 31. Best value: 0.198738:  39%|███▉      | 39/100 [01:15<01:56,  1.90s/it]Best trial: 31. Best value: 0.198738:  40%|████      | 40/100 [01:15<01:50,  1.84s/it]Best trial: 31. Best value: 0.198738:  40%|████      | 40/100 [01:17<01:50,  1.84s/it]Best trial: 31. Best value: 0.198738:  41%|████      | 41/100 [01:17<01:46,  1.80s/it]Best trial: 31. Best value: 0.198738:  41%|████      | 41/100 [01:18<01:46,  1.80s/it]Best trial: 31. Best value: 0.198738:  42%|████▏     | 42/100 [01:18<01:41,  1.75s/it]Best trial: 31. Best value: 0.198738:  42%|████▏     | 42/100 [01:20<01:41,  1.75s/it]Best trial: 31. Best value: 0.198738:  43%|████▎     | 43/100 [01:20<01:38,  1.73s/it]Best trial: 31. Best value: 0.198738:  43%|████▎     | 43/100 [01:22<01:38,  1.73s/it]Best trial: 31. Best value: 0.198738:  44%|████▍     | 44/100 [01:22<01:33,  1.66s/it]Best trial: 31. Best value: 0.198738:  44%|████▍     | 44/100 [01:23<01:33,  1.66s/it]Best trial: 31. Best value: 0.198738:  45%|████▌     | 45/100 [01:23<01:28,  1.62s/it]Best trial: 31. Best value: 0.198738:  45%|████▌     | 45/100 [01:25<01:28,  1.62s/it]Best trial: 31. Best value: 0.198738:  46%|████▌     | 46/100 [01:25<01:26,  1.61s/it]Best trial: 31. Best value: 0.198738:  46%|████▌     | 46/100 [01:27<01:26,  1.61s/it]Best trial: 31. Best value: 0.198738:  47%|████▋     | 47/100 [01:27<01:29,  1.70s/it]Best trial: 31. Best value: 0.198738:  47%|████▋     | 47/100 [01:28<01:29,  1.70s/it]Best trial: 31. Best value: 0.198738:  48%|████▊     | 48/100 [01:28<01:26,  1.67s/it]Best trial: 31. Best value: 0.198738:  48%|████▊     | 48/100 [01:30<01:26,  1.67s/it]Best trial: 31. Best value: 0.198738:  49%|████▉     | 49/100 [01:30<01:30,  1.77s/it]Best trial: 31. Best value: 0.198738:  49%|████▉     | 49/100 [01:32<01:30,  1.77s/it]Best trial: 31. Best value: 0.198738:  50%|█████     | 50/100 [01:32<01:22,  1.65s/it]Best trial: 31. Best value: 0.198738:  50%|█████     | 50/100 [01:33<01:22,  1.65s/it]Best trial: 31. Best value: 0.198738:  51%|█████     | 51/100 [01:33<01:18,  1.61s/it]Best trial: 31. Best value: 0.198738:  51%|█████     | 51/100 [01:35<01:18,  1.61s/it]Best trial: 31. Best value: 0.198738:  52%|█████▏    | 52/100 [01:35<01:17,  1.62s/it]Best trial: 31. Best value: 0.198738:  52%|█████▏    | 52/100 [01:36<01:17,  1.62s/it]Best trial: 31. Best value: 0.198738:  53%|█████▎    | 53/100 [01:36<01:15,  1.60s/it]Best trial: 31. Best value: 0.198738:  53%|█████▎    | 53/100 [01:39<01:15,  1.60s/it]Best trial: 31. Best value: 0.198738:  54%|█████▍    | 54/100 [01:39<01:23,  1.82s/it]Best trial: 31. Best value: 0.198738:  54%|█████▍    | 54/100 [01:40<01:23,  1.82s/it]Best trial: 31. Best value: 0.198738:  55%|█████▌    | 55/100 [01:40<01:18,  1.73s/it]Best trial: 31. Best value: 0.198738:  55%|█████▌    | 55/100 [01:42<01:18,  1.73s/it]Best trial: 31. Best value: 0.198738:  56%|█████▌    | 56/100 [01:42<01:13,  1.68s/it]Best trial: 31. Best value: 0.198738:  56%|█████▌    | 56/100 [01:43<01:13,  1.68s/it]Best trial: 31. Best value: 0.198738:  57%|█████▋    | 57/100 [01:43<01:13,  1.71s/it]Best trial: 31. Best value: 0.198738:  57%|█████▋    | 57/100 [01:45<01:13,  1.71s/it]Best trial: 31. Best value: 0.198738:  58%|█████▊    | 58/100 [01:45<01:10,  1.67s/it]Best trial: 31. Best value: 0.198738:  58%|█████▊    | 58/100 [01:47<01:10,  1.67s/it]Best trial: 31. Best value: 0.198738:  59%|█████▉    | 59/100 [01:47<01:06,  1.61s/it]Best trial: 31. Best value: 0.198738:  59%|█████▉    | 59/100 [01:48<01:06,  1.61s/it]Best trial: 31. Best value: 0.198738:  60%|██████    | 60/100 [01:48<01:06,  1.66s/it]Best trial: 31. Best value: 0.198738:  60%|██████    | 60/100 [01:50<01:06,  1.66s/it]Best trial: 31. Best value: 0.198738:  61%|██████    | 61/100 [01:50<01:07,  1.74s/it]Best trial: 31. Best value: 0.198738:  61%|██████    | 61/100 [01:52<01:07,  1.74s/it]Best trial: 31. Best value: 0.198738:  62%|██████▏   | 62/100 [01:52<01:06,  1.75s/it]Best trial: 62. Best value: 0.211422:  62%|██████▏   | 62/100 [01:54<01:06,  1.75s/it]Best trial: 62. Best value: 0.211422:  63%|██████▎   | 63/100 [01:54<01:02,  1.70s/it]Best trial: 62. Best value: 0.211422:  63%|██████▎   | 63/100 [01:55<01:02,  1.70s/it]Best trial: 62. Best value: 0.211422:  64%|██████▍   | 64/100 [01:55<01:00,  1.68s/it]Best trial: 62. Best value: 0.211422:  64%|██████▍   | 64/100 [01:57<01:00,  1.68s/it]Best trial: 62. Best value: 0.211422:  65%|██████▌   | 65/100 [01:57<00:58,  1.67s/it]Best trial: 62. Best value: 0.211422:  65%|██████▌   | 65/100 [01:58<00:58,  1.67s/it]Best trial: 62. Best value: 0.211422:  66%|██████▌   | 66/100 [01:58<00:53,  1.59s/it]Best trial: 62. Best value: 0.211422:  66%|██████▌   | 66/100 [02:00<00:53,  1.59s/it]Best trial: 62. Best value: 0.211422:  67%|██████▋   | 67/100 [02:00<00:53,  1.63s/it]Best trial: 62. Best value: 0.211422:  67%|██████▋   | 67/100 [02:02<00:53,  1.63s/it]Best trial: 62. Best value: 0.211422:  68%|██████▊   | 68/100 [02:02<00:51,  1.61s/it]Best trial: 62. Best value: 0.211422:  68%|██████▊   | 68/100 [02:03<00:51,  1.61s/it]Best trial: 62. Best value: 0.211422:  69%|██████▉   | 69/100 [02:03<00:50,  1.62s/it]Best trial: 62. Best value: 0.211422:  69%|██████▉   | 69/100 [02:05<00:50,  1.62s/it]Best trial: 62. Best value: 0.211422:  70%|███████   | 70/100 [02:05<00:53,  1.79s/it]Best trial: 62. Best value: 0.211422:  70%|███████   | 70/100 [02:07<00:53,  1.79s/it]Best trial: 62. Best value: 0.211422:  71%|███████   | 71/100 [02:07<00:51,  1.78s/it]Best trial: 62. Best value: 0.211422:  71%|███████   | 71/100 [02:09<00:51,  1.78s/it]Best trial: 62. Best value: 0.211422:  72%|███████▏  | 72/100 [02:09<00:48,  1.74s/it]Best trial: 62. Best value: 0.211422:  72%|███████▏  | 72/100 [02:10<00:48,  1.74s/it]Best trial: 62. Best value: 0.211422:  73%|███████▎  | 73/100 [02:10<00:46,  1.72s/it]Best trial: 62. Best value: 0.211422:  73%|███████▎  | 73/100 [02:12<00:46,  1.72s/it]Best trial: 62. Best value: 0.211422:  74%|███████▍  | 74/100 [02:12<00:45,  1.75s/it]Best trial: 62. Best value: 0.211422:  74%|███████▍  | 74/100 [02:14<00:45,  1.75s/it]Best trial: 62. Best value: 0.211422:  75%|███████▌  | 75/100 [02:14<00:43,  1.75s/it]Best trial: 62. Best value: 0.211422:  75%|███████▌  | 75/100 [02:16<00:43,  1.75s/it]Best trial: 62. Best value: 0.211422:  76%|███████▌  | 76/100 [02:16<00:42,  1.77s/it]Best trial: 62. Best value: 0.211422:  76%|███████▌  | 76/100 [02:17<00:42,  1.77s/it]Best trial: 62. Best value: 0.211422:  77%|███████▋  | 77/100 [02:17<00:39,  1.72s/it]Best trial: 62. Best value: 0.211422:  77%|███████▋  | 77/100 [02:19<00:39,  1.72s/it]Best trial: 62. Best value: 0.211422:  78%|███████▊  | 78/100 [02:19<00:37,  1.72s/it]Best trial: 62. Best value: 0.211422:  78%|███████▊  | 78/100 [02:21<00:37,  1.72s/it]Best trial: 62. Best value: 0.211422:  79%|███████▉  | 79/100 [02:21<00:35,  1.71s/it]Best trial: 62. Best value: 0.211422:  79%|███████▉  | 79/100 [02:22<00:35,  1.71s/it]Best trial: 62. Best value: 0.211422:  80%|████████  | 80/100 [02:22<00:32,  1.64s/it]Best trial: 62. Best value: 0.211422:  80%|████████  | 80/100 [02:24<00:32,  1.64s/it]Best trial: 62. Best value: 0.211422:  81%|████████  | 81/100 [02:24<00:30,  1.62s/it]Best trial: 62. Best value: 0.211422:  81%|████████  | 81/100 [02:26<00:30,  1.62s/it]Best trial: 62. Best value: 0.211422:  82%|████████▏ | 82/100 [02:26<00:30,  1.68s/it]Best trial: 62. Best value: 0.211422:  82%|████████▏ | 82/100 [02:27<00:30,  1.68s/it]Best trial: 62. Best value: 0.211422:  83%|████████▎ | 83/100 [02:27<00:28,  1.69s/it]Best trial: 62. Best value: 0.211422:  83%|████████▎ | 83/100 [02:29<00:28,  1.69s/it]Best trial: 62. Best value: 0.211422:  84%|████████▍ | 84/100 [02:29<00:27,  1.70s/it]Best trial: 62. Best value: 0.211422:  84%|████████▍ | 84/100 [02:31<00:27,  1.70s/it]Best trial: 62. Best value: 0.211422:  85%|████████▌ | 85/100 [02:31<00:26,  1.77s/it]Best trial: 62. Best value: 0.211422:  85%|████████▌ | 85/100 [02:33<00:26,  1.77s/it]Best trial: 62. Best value: 0.211422:  86%|████████▌ | 86/100 [02:33<00:26,  1.88s/it]Best trial: 62. Best value: 0.211422:  86%|████████▌ | 86/100 [02:35<00:26,  1.88s/it]Best trial: 62. Best value: 0.211422:  87%|████████▋ | 87/100 [02:35<00:24,  1.90s/it]Best trial: 62. Best value: 0.211422:  87%|████████▋ | 87/100 [02:37<00:24,  1.90s/it]Best trial: 62. Best value: 0.211422:  88%|████████▊ | 88/100 [02:37<00:22,  1.86s/it]Best trial: 62. Best value: 0.211422:  88%|████████▊ | 88/100 [02:39<00:22,  1.86s/it]Best trial: 62. Best value: 0.211422:  89%|████████▉ | 89/100 [02:39<00:21,  1.92s/it]Best trial: 62. Best value: 0.211422:  89%|████████▉ | 89/100 [02:41<00:21,  1.92s/it]Best trial: 62. Best value: 0.211422:  90%|█████████ | 90/100 [02:41<00:20,  2.05s/it]Best trial: 62. Best value: 0.211422:  90%|█████████ | 90/100 [02:43<00:20,  2.05s/it]Best trial: 62. Best value: 0.211422:  91%|█████████ | 91/100 [02:43<00:17,  1.97s/it]Best trial: 62. Best value: 0.211422:  91%|█████████ | 91/100 [02:45<00:17,  1.97s/it]Best trial: 62. Best value: 0.211422:  92%|█████████▏| 92/100 [02:45<00:15,  1.99s/it]Best trial: 62. Best value: 0.211422:  92%|█████████▏| 92/100 [02:47<00:15,  1.99s/it]Best trial: 62. Best value: 0.211422:  93%|█████████▎| 93/100 [02:47<00:13,  1.88s/it]Best trial: 62. Best value: 0.211422:  93%|█████████▎| 93/100 [02:49<00:13,  1.88s/it]Best trial: 62. Best value: 0.211422:  94%|█████████▍| 94/100 [02:49<00:11,  1.89s/it]Best trial: 62. Best value: 0.211422:  94%|█████████▍| 94/100 [02:50<00:11,  1.89s/it]Best trial: 62. Best value: 0.211422:  95%|█████████▌| 95/100 [02:50<00:08,  1.80s/it]Best trial: 62. Best value: 0.211422:  95%|█████████▌| 95/100 [02:52<00:08,  1.80s/it]Best trial: 62. Best value: 0.211422:  96%|█████████▌| 96/100 [02:52<00:07,  1.78s/it]Best trial: 62. Best value: 0.211422:  96%|█████████▌| 96/100 [02:54<00:07,  1.78s/it]Best trial: 62. Best value: 0.211422:  97%|█████████▋| 97/100 [02:54<00:05,  1.72s/it]Best trial: 62. Best value: 0.211422:  97%|█████████▋| 97/100 [02:55<00:05,  1.72s/it]Best trial: 62. Best value: 0.211422:  98%|█████████▊| 98/100 [02:55<00:03,  1.65s/it]Best trial: 62. Best value: 0.211422:  98%|█████████▊| 98/100 [02:57<00:03,  1.65s/it]Best trial: 62. Best value: 0.211422:  99%|█████████▉| 99/100 [02:57<00:01,  1.62s/it]Best trial: 62. Best value: 0.211422:  99%|█████████▉| 99/100 [02:59<00:01,  1.62s/it]Best trial: 62. Best value: 0.211422: 100%|██████████| 100/100 [02:59<00:00,  1.70s/it]Best trial: 62. Best value: 0.211422: 100%|██████████| 100/100 [02:59<00:00,  1.79s/it]
2025-11-30 15:32:49,459 - INFO - HPO Complete. Best AUPRC: 0.2114
2025-11-30 15:32:49,460 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.010498960674327266, 'max_depth': 5, 'subsample': 0.721436356370208, 'colsample_bytree': 0.6732298809168278, 'gamma': 0.9443482765148851, 'reg_lambda': 6.479519838158669e-05, 'reg_alpha': 2.0815962153036742e-08}
2025-11-30 15:32:49,461 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/non_windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:32:51,516 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 15:32:51,517 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 15:32:51,634 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 15:32:51,671 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:32:51,681 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 15:32:51,681 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:32:51,682 - INFO - Training model...
2025-11-30 15:32:52,408 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:32:58,006 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:32:58,006 - INFO - AUROC: 0.5078 (0.1140 - 0.7260)
2025-11-30 15:32:58,006 - INFO - AUPRC: 0.1838 (0.0038 - 0.5598)
2025-11-30 15:32:58,006 - INFO - Brier Score: 0.0187 (0.0156 - 0.0243)
2025-11-30 15:32:58,006 - INFO - Accuracy: 0.9928 (0.0191 - 0.9971)
2025-11-30 15:32:58,006 - INFO - Precision: 1.0000 (0.0044 - 1.0000)
2025-11-30 15:32:58,006 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 15:32:58,006 - INFO - F1-Score: 0.2857 (0.0088 - 0.7000)
2025-11-30 15:32:58,006 - INFO - Best Threshold: 0.3500 (0.0600 - 0.3500)
2025-11-30 15:32:58,006 - INFO - Specificity: 1.0000 (0.0102 - 1.0000)
2025-11-30 15:32:58,012 - INFO - Calculating SHAP values...
2025-11-30 15:32:58,973 - INFO - SHAP plots saved.
2025-11-30 15:32:58,973 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/non_windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:33:00,180 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_only
2025-11-30 15:33:00,180 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:33:00,376 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:33:00,394 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:33:00,399 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 15:33:00,399 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.196141:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.196141:   1%|          | 1/100 [00:01<02:03,  1.24s/it]Best trial: 0. Best value: 0.196141:   1%|          | 1/100 [00:02<02:03,  1.24s/it]Best trial: 0. Best value: 0.196141:   2%|▏         | 2/100 [00:02<01:43,  1.06s/it]Best trial: 0. Best value: 0.196141:   2%|▏         | 2/100 [00:03<01:43,  1.06s/it]Best trial: 0. Best value: 0.196141:   3%|▎         | 3/100 [00:03<01:45,  1.08s/it]Best trial: 0. Best value: 0.196141:   3%|▎         | 3/100 [00:04<01:45,  1.08s/it]Best trial: 0. Best value: 0.196141:   4%|▍         | 4/100 [00:04<01:44,  1.09s/it]Best trial: 0. Best value: 0.196141:   4%|▍         | 4/100 [00:05<01:44,  1.09s/it]Best trial: 0. Best value: 0.196141:   5%|▌         | 5/100 [00:05<01:47,  1.13s/it]Best trial: 0. Best value: 0.196141:   5%|▌         | 5/100 [00:06<01:47,  1.13s/it]Best trial: 0. Best value: 0.196141:   6%|▌         | 6/100 [00:06<01:48,  1.15s/it]Best trial: 0. Best value: 0.196141:   6%|▌         | 6/100 [00:07<01:48,  1.15s/it]Best trial: 0. Best value: 0.196141:   7%|▋         | 7/100 [00:07<01:47,  1.16s/it]Best trial: 0. Best value: 0.196141:   7%|▋         | 7/100 [00:08<01:47,  1.16s/it]Best trial: 0. Best value: 0.196141:   8%|▊         | 8/100 [00:08<01:43,  1.12s/it]Best trial: 0. Best value: 0.196141:   8%|▊         | 8/100 [00:10<01:43,  1.12s/it]Best trial: 0. Best value: 0.196141:   9%|▉         | 9/100 [00:10<01:40,  1.11s/it]Best trial: 0. Best value: 0.196141:   9%|▉         | 9/100 [00:11<01:40,  1.11s/it]Best trial: 0. Best value: 0.196141:  10%|█         | 10/100 [00:11<01:35,  1.06s/it]Best trial: 0. Best value: 0.196141:  10%|█         | 10/100 [00:12<01:35,  1.06s/it]Best trial: 0. Best value: 0.196141:  11%|█         | 11/100 [00:12<01:33,  1.05s/it]Best trial: 0. Best value: 0.196141:  11%|█         | 11/100 [00:13<01:33,  1.05s/it]Best trial: 0. Best value: 0.196141:  12%|█▏        | 12/100 [00:13<01:32,  1.06s/it]Best trial: 0. Best value: 0.196141:  12%|█▏        | 12/100 [00:14<01:32,  1.06s/it]Best trial: 0. Best value: 0.196141:  13%|█▎        | 13/100 [00:14<01:30,  1.04s/it]Best trial: 0. Best value: 0.196141:  13%|█▎        | 13/100 [00:15<01:30,  1.04s/it]Best trial: 0. Best value: 0.196141:  14%|█▍        | 14/100 [00:15<01:28,  1.03s/it]Best trial: 0. Best value: 0.196141:  14%|█▍        | 14/100 [00:16<01:28,  1.03s/it]Best trial: 0. Best value: 0.196141:  15%|█▌        | 15/100 [00:16<01:29,  1.05s/it]Best trial: 0. Best value: 0.196141:  15%|█▌        | 15/100 [00:17<01:29,  1.05s/it]Best trial: 0. Best value: 0.196141:  16%|█▌        | 16/100 [00:17<01:25,  1.01s/it]Best trial: 0. Best value: 0.196141:  16%|█▌        | 16/100 [00:18<01:25,  1.01s/it]Best trial: 0. Best value: 0.196141:  17%|█▋        | 17/100 [00:18<01:23,  1.00s/it]Best trial: 0. Best value: 0.196141:  17%|█▋        | 17/100 [00:19<01:23,  1.00s/it]Best trial: 0. Best value: 0.196141:  18%|█▊        | 18/100 [00:19<01:24,  1.03s/it]Best trial: 0. Best value: 0.196141:  18%|█▊        | 18/100 [00:20<01:24,  1.03s/it]Best trial: 0. Best value: 0.196141:  19%|█▉        | 19/100 [00:20<01:24,  1.04s/it]Best trial: 0. Best value: 0.196141:  19%|█▉        | 19/100 [00:21<01:24,  1.04s/it]Best trial: 0. Best value: 0.196141:  20%|██        | 20/100 [00:21<01:22,  1.03s/it]Best trial: 0. Best value: 0.196141:  20%|██        | 20/100 [00:22<01:22,  1.03s/it]Best trial: 0. Best value: 0.196141:  21%|██        | 21/100 [00:22<01:23,  1.06s/it]Best trial: 0. Best value: 0.196141:  21%|██        | 21/100 [00:23<01:23,  1.06s/it]Best trial: 0. Best value: 0.196141:  22%|██▏       | 22/100 [00:23<01:23,  1.07s/it]Best trial: 0. Best value: 0.196141:  22%|██▏       | 22/100 [00:24<01:23,  1.07s/it]Best trial: 0. Best value: 0.196141:  23%|██▎       | 23/100 [00:24<01:19,  1.03s/it]Best trial: 0. Best value: 0.196141:  23%|██▎       | 23/100 [00:25<01:19,  1.03s/it]Best trial: 0. Best value: 0.196141:  24%|██▍       | 24/100 [00:25<01:15,  1.00it/s]Best trial: 0. Best value: 0.196141:  24%|██▍       | 24/100 [00:26<01:15,  1.00it/s]Best trial: 0. Best value: 0.196141:  25%|██▌       | 25/100 [00:26<01:13,  1.02it/s]Best trial: 0. Best value: 0.196141:  25%|██▌       | 25/100 [00:27<01:13,  1.02it/s]Best trial: 0. Best value: 0.196141:  26%|██▌       | 26/100 [00:27<01:12,  1.02it/s]Best trial: 0. Best value: 0.196141:  26%|██▌       | 26/100 [00:28<01:12,  1.02it/s]Best trial: 0. Best value: 0.196141:  27%|██▋       | 27/100 [00:28<01:14,  1.03s/it]Best trial: 0. Best value: 0.196141:  27%|██▋       | 27/100 [00:29<01:14,  1.03s/it]Best trial: 0. Best value: 0.196141:  28%|██▊       | 28/100 [00:29<01:20,  1.12s/it]Best trial: 0. Best value: 0.196141:  28%|██▊       | 28/100 [00:30<01:20,  1.12s/it]Best trial: 0. Best value: 0.196141:  29%|██▉       | 29/100 [00:30<01:17,  1.09s/it]Best trial: 0. Best value: 0.196141:  29%|██▉       | 29/100 [00:31<01:17,  1.09s/it]Best trial: 0. Best value: 0.196141:  30%|███       | 30/100 [00:31<01:13,  1.05s/it]Best trial: 0. Best value: 0.196141:  30%|███       | 30/100 [00:32<01:13,  1.05s/it]Best trial: 0. Best value: 0.196141:  31%|███       | 31/100 [00:32<01:14,  1.08s/it]Best trial: 0. Best value: 0.196141:  31%|███       | 31/100 [00:33<01:14,  1.08s/it]Best trial: 0. Best value: 0.196141:  32%|███▏      | 32/100 [00:33<01:10,  1.04s/it]Best trial: 0. Best value: 0.196141:  32%|███▏      | 32/100 [00:34<01:10,  1.04s/it]Best trial: 0. Best value: 0.196141:  33%|███▎      | 33/100 [00:34<01:06,  1.01it/s]Best trial: 0. Best value: 0.196141:  33%|███▎      | 33/100 [00:35<01:06,  1.01it/s]Best trial: 0. Best value: 0.196141:  34%|███▍      | 34/100 [00:35<01:06,  1.01s/it]Best trial: 0. Best value: 0.196141:  34%|███▍      | 34/100 [00:36<01:06,  1.01s/it]Best trial: 0. Best value: 0.196141:  35%|███▌      | 35/100 [00:36<01:05,  1.00s/it]Best trial: 0. Best value: 0.196141:  35%|███▌      | 35/100 [00:37<01:05,  1.00s/it]Best trial: 0. Best value: 0.196141:  36%|███▌      | 36/100 [00:37<01:03,  1.00it/s]Best trial: 0. Best value: 0.196141:  36%|███▌      | 36/100 [00:38<01:03,  1.00it/s]Best trial: 0. Best value: 0.196141:  37%|███▋      | 37/100 [00:38<01:07,  1.07s/it]Best trial: 0. Best value: 0.196141:  37%|███▋      | 37/100 [00:39<01:07,  1.07s/it]Best trial: 0. Best value: 0.196141:  38%|███▊      | 38/100 [00:39<01:04,  1.04s/it]Best trial: 0. Best value: 0.196141:  38%|███▊      | 38/100 [00:41<01:04,  1.04s/it]Best trial: 0. Best value: 0.196141:  39%|███▉      | 39/100 [00:41<01:04,  1.06s/it]Best trial: 39. Best value: 0.199717:  39%|███▉      | 39/100 [00:42<01:04,  1.06s/it]Best trial: 39. Best value: 0.199717:  40%|████      | 40/100 [00:42<01:04,  1.08s/it]Best trial: 39. Best value: 0.199717:  40%|████      | 40/100 [00:43<01:04,  1.08s/it]Best trial: 39. Best value: 0.199717:  41%|████      | 41/100 [00:43<01:05,  1.11s/it]Best trial: 39. Best value: 0.199717:  41%|████      | 41/100 [00:44<01:05,  1.11s/it]Best trial: 39. Best value: 0.199717:  42%|████▏     | 42/100 [00:44<01:03,  1.10s/it]Best trial: 39. Best value: 0.199717:  42%|████▏     | 42/100 [00:45<01:03,  1.10s/it]Best trial: 39. Best value: 0.199717:  43%|████▎     | 43/100 [00:45<01:04,  1.13s/it]Best trial: 39. Best value: 0.199717:  43%|████▎     | 43/100 [00:46<01:04,  1.13s/it]Best trial: 39. Best value: 0.199717:  44%|████▍     | 44/100 [00:46<01:03,  1.13s/it]Best trial: 39. Best value: 0.199717:  44%|████▍     | 44/100 [00:47<01:03,  1.13s/it]Best trial: 39. Best value: 0.199717:  45%|████▌     | 45/100 [00:47<01:03,  1.15s/it]Best trial: 39. Best value: 0.199717:  45%|████▌     | 45/100 [00:49<01:03,  1.15s/it]Best trial: 39. Best value: 0.199717:  46%|████▌     | 46/100 [00:49<01:04,  1.20s/it]Best trial: 39. Best value: 0.199717:  46%|████▌     | 46/100 [00:50<01:04,  1.20s/it]Best trial: 39. Best value: 0.199717:  47%|████▋     | 47/100 [00:50<01:02,  1.18s/it]Best trial: 39. Best value: 0.199717:  47%|████▋     | 47/100 [00:51<01:02,  1.18s/it]Best trial: 39. Best value: 0.199717:  48%|████▊     | 48/100 [00:51<01:05,  1.27s/it]Best trial: 39. Best value: 0.199717:  48%|████▊     | 48/100 [00:52<01:05,  1.27s/it]Best trial: 39. Best value: 0.199717:  49%|████▉     | 49/100 [00:52<01:00,  1.18s/it]Best trial: 39. Best value: 0.199717:  49%|████▉     | 49/100 [00:53<01:00,  1.18s/it]Best trial: 39. Best value: 0.199717:  50%|█████     | 50/100 [00:53<00:55,  1.11s/it]Best trial: 39. Best value: 0.199717:  50%|█████     | 50/100 [00:54<00:55,  1.11s/it]Best trial: 39. Best value: 0.199717:  51%|█████     | 51/100 [00:54<00:55,  1.13s/it]Best trial: 39. Best value: 0.199717:  51%|█████     | 51/100 [00:55<00:55,  1.13s/it]Best trial: 39. Best value: 0.199717:  52%|█████▏    | 52/100 [00:55<00:51,  1.07s/it]Best trial: 39. Best value: 0.199717:  52%|█████▏    | 52/100 [00:56<00:51,  1.07s/it]Best trial: 39. Best value: 0.199717:  53%|█████▎    | 53/100 [00:56<00:50,  1.07s/it]Best trial: 39. Best value: 0.199717:  53%|█████▎    | 53/100 [00:57<00:50,  1.07s/it]Best trial: 39. Best value: 0.199717:  54%|█████▍    | 54/100 [00:57<00:47,  1.03s/it]Best trial: 39. Best value: 0.199717:  54%|█████▍    | 54/100 [00:58<00:47,  1.03s/it]Best trial: 39. Best value: 0.199717:  55%|█████▌    | 55/100 [00:58<00:44,  1.02it/s]Best trial: 39. Best value: 0.199717:  55%|█████▌    | 55/100 [00:59<00:44,  1.02it/s]Best trial: 39. Best value: 0.199717:  56%|█████▌    | 56/100 [00:59<00:44,  1.00s/it]Best trial: 39. Best value: 0.199717:  56%|█████▌    | 56/100 [01:00<00:44,  1.00s/it]Best trial: 39. Best value: 0.199717:  57%|█████▋    | 57/100 [01:00<00:41,  1.03it/s]Best trial: 39. Best value: 0.199717:  57%|█████▋    | 57/100 [01:01<00:41,  1.03it/s]Best trial: 39. Best value: 0.199717:  58%|█████▊    | 58/100 [01:01<00:40,  1.03it/s]Best trial: 39. Best value: 0.199717:  58%|█████▊    | 58/100 [01:02<00:40,  1.03it/s]Best trial: 39. Best value: 0.199717:  59%|█████▉    | 59/100 [01:02<00:38,  1.06it/s]Best trial: 39. Best value: 0.199717:  59%|█████▉    | 59/100 [01:03<00:38,  1.06it/s]Best trial: 39. Best value: 0.199717:  60%|██████    | 60/100 [01:03<00:42,  1.05s/it]Best trial: 39. Best value: 0.199717:  60%|██████    | 60/100 [01:05<00:42,  1.05s/it]Best trial: 39. Best value: 0.199717:  61%|██████    | 61/100 [01:05<00:42,  1.08s/it]Best trial: 39. Best value: 0.199717:  61%|██████    | 61/100 [01:05<00:42,  1.08s/it]Best trial: 39. Best value: 0.199717:  62%|██████▏   | 62/100 [01:05<00:39,  1.03s/it]Best trial: 39. Best value: 0.199717:  62%|██████▏   | 62/100 [01:06<00:39,  1.03s/it]Best trial: 39. Best value: 0.199717:  63%|██████▎   | 63/100 [01:06<00:36,  1.02it/s]Best trial: 39. Best value: 0.199717:  63%|██████▎   | 63/100 [01:07<00:36,  1.02it/s]Best trial: 39. Best value: 0.199717:  64%|██████▍   | 64/100 [01:07<00:35,  1.00it/s]Best trial: 39. Best value: 0.199717:  64%|██████▍   | 64/100 [01:08<00:35,  1.00it/s]Best trial: 39. Best value: 0.199717:  65%|██████▌   | 65/100 [01:08<00:34,  1.01it/s]Best trial: 39. Best value: 0.199717:  65%|██████▌   | 65/100 [01:09<00:34,  1.01it/s]Best trial: 39. Best value: 0.199717:  66%|██████▌   | 66/100 [01:09<00:34,  1.03s/it]Best trial: 39. Best value: 0.199717:  66%|██████▌   | 66/100 [01:11<00:34,  1.03s/it]Best trial: 39. Best value: 0.199717:  67%|██████▋   | 67/100 [01:11<00:34,  1.04s/it]Best trial: 39. Best value: 0.199717:  67%|██████▋   | 67/100 [01:11<00:34,  1.04s/it]Best trial: 39. Best value: 0.199717:  68%|██████▊   | 68/100 [01:11<00:31,  1.01it/s]Best trial: 39. Best value: 0.199717:  68%|██████▊   | 68/100 [01:12<00:31,  1.01it/s]Best trial: 39. Best value: 0.199717:  69%|██████▉   | 69/100 [01:12<00:29,  1.03it/s]Best trial: 39. Best value: 0.199717:  69%|██████▉   | 69/100 [01:13<00:29,  1.03it/s]Best trial: 39. Best value: 0.199717:  70%|███████   | 70/100 [01:13<00:30,  1.02s/it]Best trial: 39. Best value: 0.199717:  70%|███████   | 70/100 [01:14<00:30,  1.02s/it]Best trial: 39. Best value: 0.199717:  71%|███████   | 71/100 [01:14<00:28,  1.00it/s]Best trial: 71. Best value: 0.208123:  71%|███████   | 71/100 [01:15<00:28,  1.00it/s]Best trial: 71. Best value: 0.208123:  72%|███████▏  | 72/100 [01:15<00:27,  1.00it/s]Best trial: 71. Best value: 0.208123:  72%|███████▏  | 72/100 [01:16<00:27,  1.00it/s]Best trial: 71. Best value: 0.208123:  73%|███████▎  | 73/100 [01:16<00:27,  1.00s/it]Best trial: 71. Best value: 0.208123:  73%|███████▎  | 73/100 [01:17<00:27,  1.00s/it]Best trial: 71. Best value: 0.208123:  74%|███████▍  | 74/100 [01:17<00:26,  1.02s/it]Best trial: 71. Best value: 0.208123:  74%|███████▍  | 74/100 [01:18<00:26,  1.02s/it]Best trial: 71. Best value: 0.208123:  75%|███████▌  | 75/100 [01:18<00:25,  1.00s/it]Best trial: 71. Best value: 0.208123:  75%|███████▌  | 75/100 [01:19<00:25,  1.00s/it]Best trial: 71. Best value: 0.208123:  76%|███████▌  | 76/100 [01:19<00:24,  1.01s/it]Best trial: 71. Best value: 0.208123:  76%|███████▌  | 76/100 [01:20<00:24,  1.01s/it]Best trial: 71. Best value: 0.208123:  77%|███████▋  | 77/100 [01:20<00:22,  1.01it/s]Best trial: 71. Best value: 0.208123:  77%|███████▋  | 77/100 [01:22<00:22,  1.01it/s]Best trial: 71. Best value: 0.208123:  78%|███████▊  | 78/100 [01:22<00:22,  1.03s/it]Best trial: 71. Best value: 0.208123:  78%|███████▊  | 78/100 [01:22<00:22,  1.03s/it]Best trial: 71. Best value: 0.208123:  79%|███████▉  | 79/100 [01:22<00:21,  1.01s/it]Best trial: 71. Best value: 0.208123:  79%|███████▉  | 79/100 [01:23<00:21,  1.01s/it]Best trial: 71. Best value: 0.208123:  80%|████████  | 80/100 [01:23<00:19,  1.00it/s]Best trial: 71. Best value: 0.208123:  80%|████████  | 80/100 [01:24<00:19,  1.00it/s]Best trial: 71. Best value: 0.208123:  81%|████████  | 81/100 [01:24<00:18,  1.01it/s]Best trial: 71. Best value: 0.208123:  81%|████████  | 81/100 [01:25<00:18,  1.01it/s]Best trial: 71. Best value: 0.208123:  82%|████████▏ | 82/100 [01:25<00:17,  1.01it/s]Best trial: 71. Best value: 0.208123:  82%|████████▏ | 82/100 [01:26<00:17,  1.01it/s]Best trial: 71. Best value: 0.208123:  83%|████████▎ | 83/100 [01:26<00:16,  1.02it/s]Best trial: 71. Best value: 0.208123:  83%|████████▎ | 83/100 [01:27<00:16,  1.02it/s]Best trial: 71. Best value: 0.208123:  84%|████████▍ | 84/100 [01:27<00:15,  1.03it/s]Best trial: 71. Best value: 0.208123:  84%|████████▍ | 84/100 [01:28<00:15,  1.03it/s]Best trial: 71. Best value: 0.208123:  85%|████████▌ | 85/100 [01:28<00:14,  1.06it/s]Best trial: 71. Best value: 0.208123:  85%|████████▌ | 85/100 [01:29<00:14,  1.06it/s]Best trial: 71. Best value: 0.208123:  86%|████████▌ | 86/100 [01:29<00:13,  1.06it/s]Best trial: 71. Best value: 0.208123:  86%|████████▌ | 86/100 [01:30<00:13,  1.06it/s]Best trial: 71. Best value: 0.208123:  87%|████████▋ | 87/100 [01:30<00:12,  1.05it/s]Best trial: 71. Best value: 0.208123:  87%|████████▋ | 87/100 [01:31<00:12,  1.05it/s]Best trial: 71. Best value: 0.208123:  88%|████████▊ | 88/100 [01:31<00:11,  1.05it/s]Best trial: 71. Best value: 0.208123:  88%|████████▊ | 88/100 [01:32<00:11,  1.05it/s]Best trial: 71. Best value: 0.208123:  89%|████████▉ | 89/100 [01:32<00:10,  1.03it/s]Best trial: 71. Best value: 0.208123:  89%|████████▉ | 89/100 [01:33<00:10,  1.03it/s]Best trial: 71. Best value: 0.208123:  90%|█████████ | 90/100 [01:33<00:10,  1.01s/it]Best trial: 71. Best value: 0.208123:  90%|█████████ | 90/100 [01:34<00:10,  1.01s/it]Best trial: 71. Best value: 0.208123:  91%|█████████ | 91/100 [01:34<00:08,  1.01it/s]Best trial: 71. Best value: 0.208123:  91%|█████████ | 91/100 [01:35<00:08,  1.01it/s]Best trial: 71. Best value: 0.208123:  92%|█████████▏| 92/100 [01:35<00:07,  1.02it/s]Best trial: 71. Best value: 0.208123:  92%|█████████▏| 92/100 [01:36<00:07,  1.02it/s]Best trial: 71. Best value: 0.208123:  93%|█████████▎| 93/100 [01:36<00:06,  1.03it/s]Best trial: 71. Best value: 0.208123:  93%|█████████▎| 93/100 [01:37<00:06,  1.03it/s]Best trial: 71. Best value: 0.208123:  94%|█████████▍| 94/100 [01:37<00:05,  1.00it/s]Best trial: 71. Best value: 0.208123:  94%|█████████▍| 94/100 [01:38<00:05,  1.00it/s]Best trial: 71. Best value: 0.208123:  95%|█████████▌| 95/100 [01:38<00:05,  1.09s/it]Best trial: 71. Best value: 0.208123:  95%|█████████▌| 95/100 [01:39<00:05,  1.09s/it]Best trial: 71. Best value: 0.208123:  96%|█████████▌| 96/100 [01:39<00:04,  1.03s/it]Best trial: 71. Best value: 0.208123:  96%|█████████▌| 96/100 [01:40<00:04,  1.03s/it]Best trial: 71. Best value: 0.208123:  97%|█████████▋| 97/100 [01:40<00:03,  1.04s/it]Best trial: 71. Best value: 0.208123:  97%|█████████▋| 97/100 [01:41<00:03,  1.04s/it]Best trial: 71. Best value: 0.208123:  98%|█████████▊| 98/100 [01:41<00:02,  1.07s/it]Best trial: 71. Best value: 0.208123:  98%|█████████▊| 98/100 [01:42<00:02,  1.07s/it]Best trial: 71. Best value: 0.208123:  99%|█████████▉| 99/100 [01:42<00:01,  1.03s/it]Best trial: 71. Best value: 0.208123:  99%|█████████▉| 99/100 [01:43<00:01,  1.03s/it]Best trial: 71. Best value: 0.208123: 100%|██████████| 100/100 [01:43<00:00,  1.00it/s]Best trial: 71. Best value: 0.208123: 100%|██████████| 100/100 [01:43<00:00,  1.04s/it]
2025-11-30 15:34:44,244 - INFO - HPO Complete. Best AUPRC: 0.2081
2025-11-30 15:34:44,244 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.04765205930064113, 'max_depth': 4, 'subsample': 0.7695575049904703, 'colsample_bytree': 0.6114719344579795, 'gamma': 4.820328916140849, 'reg_lambda': 3.3513773306545185e-05, 'reg_alpha': 0.002994673239197764}
2025-11-30 15:34:44,245 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:34:46,028 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_only
2025-11-30 15:34:46,029 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:34:46,218 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:34:46,239 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:34:46,244 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 15:34:46,244 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:34:46,244 - INFO - Training model...
2025-11-30 15:34:46,817 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:34:51,953 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:34:51,953 - INFO - AUROC: 0.7330 (0.5103 - 0.8586)
2025-11-30 15:34:51,953 - INFO - AUPRC: 0.0274 (0.0079 - 0.0764)
2025-11-30 15:34:51,953 - INFO - Brier Score: 0.0119 (0.0078 - 0.0194)
2025-11-30 15:34:51,953 - INFO - Accuracy: 0.9639 (0.7604 - 0.9789)
2025-11-30 15:34:51,953 - INFO - Precision: 0.0476 (0.0000 - 0.1165)
2025-11-30 15:34:51,953 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.8800)
2025-11-30 15:34:51,953 - INFO - F1-Score: 0.0741 (0.0000 - 0.1917)
2025-11-30 15:34:51,953 - INFO - Best Threshold: 0.1100 (0.0100 - 0.1100)
2025-11-30 15:34:51,953 - INFO - Specificity: 0.9708 (0.7668 - 0.9803)
2025-11-30 15:34:51,962 - INFO - Calculating SHAP values...
2025-11-30 15:34:52,870 - INFO - SHAP plots saved.
2025-11-30 15:34:52,872 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:34:54,098 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: pleth_only
2025-11-30 15:34:54,098 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:34:54,333 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:34:54,355 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:34:54,360 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:34:54,360 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0813189:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.0813189:   1%|          | 1/100 [00:01<02:53,  1.75s/it]Best trial: 0. Best value: 0.0813189:   1%|          | 1/100 [00:03<02:53,  1.75s/it]Best trial: 0. Best value: 0.0813189:   2%|▏         | 2/100 [00:03<03:00,  1.84s/it]Best trial: 0. Best value: 0.0813189:   2%|▏         | 2/100 [00:05<03:00,  1.84s/it]Best trial: 0. Best value: 0.0813189:   3%|▎         | 3/100 [00:05<02:40,  1.65s/it]Best trial: 0. Best value: 0.0813189:   3%|▎         | 3/100 [00:06<02:40,  1.65s/it]Best trial: 0. Best value: 0.0813189:   4%|▍         | 4/100 [00:06<02:41,  1.68s/it]Best trial: 4. Best value: 0.152194:   4%|▍         | 4/100 [00:08<02:41,  1.68s/it] Best trial: 4. Best value: 0.152194:   5%|▌         | 5/100 [00:08<02:31,  1.60s/it]Best trial: 4. Best value: 0.152194:   5%|▌         | 5/100 [00:10<02:31,  1.60s/it]Best trial: 4. Best value: 0.152194:   6%|▌         | 6/100 [00:10<02:49,  1.80s/it]Best trial: 4. Best value: 0.152194:   6%|▌         | 6/100 [00:12<02:49,  1.80s/it]Best trial: 4. Best value: 0.152194:   7%|▋         | 7/100 [00:12<03:00,  1.94s/it]Best trial: 4. Best value: 0.152194:   7%|▋         | 7/100 [00:15<03:00,  1.94s/it]Best trial: 4. Best value: 0.152194:   8%|▊         | 8/100 [00:15<03:09,  2.06s/it]Best trial: 4. Best value: 0.152194:   8%|▊         | 8/100 [00:17<03:09,  2.06s/it]Best trial: 4. Best value: 0.152194:   9%|▉         | 9/100 [00:17<03:14,  2.14s/it]Best trial: 4. Best value: 0.152194:   9%|▉         | 9/100 [00:19<03:14,  2.14s/it]Best trial: 4. Best value: 0.152194:  10%|█         | 10/100 [00:19<03:03,  2.04s/it]Best trial: 4. Best value: 0.152194:  10%|█         | 10/100 [00:20<03:03,  2.04s/it]Best trial: 4. Best value: 0.152194:  11%|█         | 11/100 [00:20<02:42,  1.83s/it]Best trial: 4. Best value: 0.152194:  11%|█         | 11/100 [00:21<02:42,  1.83s/it]Best trial: 4. Best value: 0.152194:  12%|█▏        | 12/100 [00:21<02:25,  1.65s/it]Best trial: 4. Best value: 0.152194:  12%|█▏        | 12/100 [00:23<02:25,  1.65s/it]Best trial: 4. Best value: 0.152194:  13%|█▎        | 13/100 [00:23<02:19,  1.60s/it]Best trial: 4. Best value: 0.152194:  13%|█▎        | 13/100 [00:24<02:19,  1.60s/it]Best trial: 4. Best value: 0.152194:  14%|█▍        | 14/100 [00:24<02:15,  1.57s/it]Best trial: 4. Best value: 0.152194:  14%|█▍        | 14/100 [00:26<02:15,  1.57s/it]Best trial: 4. Best value: 0.152194:  15%|█▌        | 15/100 [00:26<02:14,  1.58s/it]Best trial: 4. Best value: 0.152194:  15%|█▌        | 15/100 [00:28<02:14,  1.58s/it]Best trial: 4. Best value: 0.152194:  16%|█▌        | 16/100 [00:28<02:19,  1.67s/it]Best trial: 4. Best value: 0.152194:  16%|█▌        | 16/100 [00:29<02:19,  1.67s/it]Best trial: 4. Best value: 0.152194:  17%|█▋        | 17/100 [00:29<02:08,  1.54s/it]Best trial: 4. Best value: 0.152194:  17%|█▋        | 17/100 [00:31<02:08,  1.54s/it]Best trial: 4. Best value: 0.152194:  18%|█▊        | 18/100 [00:31<02:08,  1.57s/it]Best trial: 4. Best value: 0.152194:  18%|█▊        | 18/100 [00:32<02:08,  1.57s/it]Best trial: 4. Best value: 0.152194:  19%|█▉        | 19/100 [00:32<02:09,  1.60s/it]Best trial: 4. Best value: 0.152194:  19%|█▉        | 19/100 [00:34<02:09,  1.60s/it]Best trial: 4. Best value: 0.152194:  20%|██        | 20/100 [00:34<02:05,  1.57s/it]Best trial: 4. Best value: 0.152194:  20%|██        | 20/100 [00:36<02:05,  1.57s/it]Best trial: 4. Best value: 0.152194:  21%|██        | 21/100 [00:36<02:18,  1.75s/it]Best trial: 4. Best value: 0.152194:  21%|██        | 21/100 [00:37<02:18,  1.75s/it]Best trial: 4. Best value: 0.152194:  22%|██▏       | 22/100 [00:37<02:10,  1.67s/it]Best trial: 4. Best value: 0.152194:  22%|██▏       | 22/100 [00:39<02:10,  1.67s/it]Best trial: 4. Best value: 0.152194:  23%|██▎       | 23/100 [00:39<02:02,  1.59s/it]Best trial: 4. Best value: 0.152194:  23%|██▎       | 23/100 [00:40<02:02,  1.59s/it]Best trial: 4. Best value: 0.152194:  24%|██▍       | 24/100 [00:40<01:51,  1.46s/it]Best trial: 4. Best value: 0.152194:  24%|██▍       | 24/100 [00:41<01:51,  1.46s/it]Best trial: 4. Best value: 0.152194:  25%|██▌       | 25/100 [00:41<01:50,  1.48s/it]Best trial: 4. Best value: 0.152194:  25%|██▌       | 25/100 [00:43<01:50,  1.48s/it]Best trial: 4. Best value: 0.152194:  26%|██▌       | 26/100 [00:43<01:46,  1.44s/it]Best trial: 4. Best value: 0.152194:  26%|██▌       | 26/100 [00:45<01:46,  1.44s/it]Best trial: 4. Best value: 0.152194:  27%|██▋       | 27/100 [00:45<01:50,  1.51s/it]Best trial: 4. Best value: 0.152194:  27%|██▋       | 27/100 [00:46<01:50,  1.51s/it]Best trial: 4. Best value: 0.152194:  28%|██▊       | 28/100 [00:46<01:51,  1.55s/it]Best trial: 28. Best value: 0.157162:  28%|██▊       | 28/100 [00:48<01:51,  1.55s/it]Best trial: 28. Best value: 0.157162:  29%|██▉       | 29/100 [00:48<01:50,  1.55s/it]Best trial: 28. Best value: 0.157162:  29%|██▉       | 29/100 [00:49<01:50,  1.55s/it]Best trial: 28. Best value: 0.157162:  30%|███       | 30/100 [00:49<01:49,  1.56s/it]Best trial: 28. Best value: 0.157162:  30%|███       | 30/100 [00:51<01:49,  1.56s/it]Best trial: 28. Best value: 0.157162:  31%|███       | 31/100 [00:51<01:53,  1.64s/it]Best trial: 28. Best value: 0.157162:  31%|███       | 31/100 [00:53<01:53,  1.64s/it]Best trial: 28. Best value: 0.157162:  32%|███▏      | 32/100 [00:53<01:47,  1.59s/it]Best trial: 28. Best value: 0.157162:  32%|███▏      | 32/100 [00:54<01:47,  1.59s/it]Best trial: 28. Best value: 0.157162:  33%|███▎      | 33/100 [00:54<01:40,  1.50s/it]Best trial: 28. Best value: 0.157162:  33%|███▎      | 33/100 [00:55<01:40,  1.50s/it]Best trial: 28. Best value: 0.157162:  34%|███▍      | 34/100 [00:55<01:36,  1.46s/it]Best trial: 28. Best value: 0.157162:  34%|███▍      | 34/100 [00:57<01:36,  1.46s/it]Best trial: 28. Best value: 0.157162:  35%|███▌      | 35/100 [00:57<01:35,  1.47s/it]Best trial: 28. Best value: 0.157162:  35%|███▌      | 35/100 [00:58<01:35,  1.47s/it]Best trial: 28. Best value: 0.157162:  36%|███▌      | 36/100 [00:58<01:35,  1.49s/it]Best trial: 28. Best value: 0.157162:  36%|███▌      | 36/100 [01:00<01:35,  1.49s/it]Best trial: 28. Best value: 0.157162:  37%|███▋      | 37/100 [01:00<01:40,  1.59s/it]Best trial: 28. Best value: 0.157162:  37%|███▋      | 37/100 [01:01<01:40,  1.59s/it]Best trial: 28. Best value: 0.157162:  38%|███▊      | 38/100 [01:01<01:33,  1.50s/it]Best trial: 28. Best value: 0.157162:  38%|███▊      | 38/100 [01:03<01:33,  1.50s/it]Best trial: 28. Best value: 0.157162:  39%|███▉      | 39/100 [01:03<01:36,  1.58s/it]Best trial: 28. Best value: 0.157162:  39%|███▉      | 39/100 [01:05<01:36,  1.58s/it]Best trial: 28. Best value: 0.157162:  40%|████      | 40/100 [01:05<01:34,  1.57s/it]Best trial: 28. Best value: 0.157162:  40%|████      | 40/100 [01:07<01:34,  1.57s/it]Best trial: 28. Best value: 0.157162:  41%|████      | 41/100 [01:07<01:40,  1.70s/it]Best trial: 28. Best value: 0.157162:  41%|████      | 41/100 [01:08<01:40,  1.70s/it]Best trial: 28. Best value: 0.157162:  42%|████▏     | 42/100 [01:08<01:29,  1.54s/it]Best trial: 28. Best value: 0.157162:  42%|████▏     | 42/100 [01:09<01:29,  1.54s/it]Best trial: 28. Best value: 0.157162:  43%|████▎     | 43/100 [01:09<01:21,  1.44s/it]Best trial: 28. Best value: 0.157162:  43%|████▎     | 43/100 [01:10<01:21,  1.44s/it]Best trial: 28. Best value: 0.157162:  44%|████▍     | 44/100 [01:10<01:20,  1.44s/it]Best trial: 28. Best value: 0.157162:  44%|████▍     | 44/100 [01:12<01:20,  1.44s/it]Best trial: 28. Best value: 0.157162:  45%|████▌     | 45/100 [01:12<01:26,  1.57s/it]Best trial: 28. Best value: 0.157162:  45%|████▌     | 45/100 [01:14<01:26,  1.57s/it]Best trial: 28. Best value: 0.157162:  46%|████▌     | 46/100 [01:14<01:22,  1.53s/it]Best trial: 28. Best value: 0.157162:  46%|████▌     | 46/100 [01:15<01:22,  1.53s/it]Best trial: 28. Best value: 0.157162:  47%|████▋     | 47/100 [01:15<01:22,  1.56s/it]Best trial: 28. Best value: 0.157162:  47%|████▋     | 47/100 [01:17<01:22,  1.56s/it]Best trial: 28. Best value: 0.157162:  48%|████▊     | 48/100 [01:17<01:17,  1.48s/it]Best trial: 28. Best value: 0.157162:  48%|████▊     | 48/100 [01:18<01:17,  1.48s/it]Best trial: 28. Best value: 0.157162:  49%|████▉     | 49/100 [01:18<01:17,  1.53s/it]Best trial: 28. Best value: 0.157162:  49%|████▉     | 49/100 [01:20<01:17,  1.53s/it]Best trial: 28. Best value: 0.157162:  50%|█████     | 50/100 [01:20<01:11,  1.44s/it]Best trial: 28. Best value: 0.157162:  50%|█████     | 50/100 [01:21<01:11,  1.44s/it]Best trial: 28. Best value: 0.157162:  51%|█████     | 51/100 [01:21<01:07,  1.39s/it]Best trial: 28. Best value: 0.157162:  51%|█████     | 51/100 [01:22<01:07,  1.39s/it]Best trial: 28. Best value: 0.157162:  52%|█████▏    | 52/100 [01:22<01:04,  1.35s/it]Best trial: 28. Best value: 0.157162:  52%|█████▏    | 52/100 [01:24<01:04,  1.35s/it]Best trial: 28. Best value: 0.157162:  53%|█████▎    | 53/100 [01:24<01:06,  1.41s/it]Best trial: 28. Best value: 0.157162:  53%|█████▎    | 53/100 [01:25<01:06,  1.41s/it]Best trial: 28. Best value: 0.157162:  54%|█████▍    | 54/100 [01:25<01:05,  1.42s/it]Best trial: 28. Best value: 0.157162:  54%|█████▍    | 54/100 [01:27<01:05,  1.42s/it]Best trial: 28. Best value: 0.157162:  55%|█████▌    | 55/100 [01:27<01:05,  1.46s/it]Best trial: 28. Best value: 0.157162:  55%|█████▌    | 55/100 [01:28<01:05,  1.46s/it]Best trial: 28. Best value: 0.157162:  56%|█████▌    | 56/100 [01:28<01:01,  1.40s/it]Best trial: 28. Best value: 0.157162:  56%|█████▌    | 56/100 [01:30<01:01,  1.40s/it]Best trial: 28. Best value: 0.157162:  57%|█████▋    | 57/100 [01:30<01:03,  1.48s/it]Best trial: 28. Best value: 0.157162:  57%|█████▋    | 57/100 [01:31<01:03,  1.48s/it]Best trial: 28. Best value: 0.157162:  58%|█████▊    | 58/100 [01:31<01:00,  1.44s/it]Best trial: 28. Best value: 0.157162:  58%|█████▊    | 58/100 [01:32<01:00,  1.44s/it]Best trial: 28. Best value: 0.157162:  59%|█████▉    | 59/100 [01:32<00:56,  1.38s/it]Best trial: 28. Best value: 0.157162:  59%|█████▉    | 59/100 [01:34<00:56,  1.38s/it]Best trial: 28. Best value: 0.157162:  60%|██████    | 60/100 [01:34<01:05,  1.64s/it]Best trial: 28. Best value: 0.157162:  60%|██████    | 60/100 [01:36<01:05,  1.64s/it]Best trial: 28. Best value: 0.157162:  61%|██████    | 61/100 [01:36<01:05,  1.68s/it]Best trial: 28. Best value: 0.157162:  61%|██████    | 61/100 [01:38<01:05,  1.68s/it]Best trial: 28. Best value: 0.157162:  62%|██████▏   | 62/100 [01:38<00:59,  1.57s/it]Best trial: 28. Best value: 0.157162:  62%|██████▏   | 62/100 [01:39<00:59,  1.57s/it]Best trial: 28. Best value: 0.157162:  63%|██████▎   | 63/100 [01:39<00:53,  1.44s/it]Best trial: 28. Best value: 0.157162:  63%|██████▎   | 63/100 [01:40<00:53,  1.44s/it]Best trial: 28. Best value: 0.157162:  64%|██████▍   | 64/100 [01:40<00:52,  1.45s/it]Best trial: 64. Best value: 0.172703:  64%|██████▍   | 64/100 [01:42<00:52,  1.45s/it]Best trial: 64. Best value: 0.172703:  65%|██████▌   | 65/100 [01:42<00:51,  1.46s/it]Best trial: 64. Best value: 0.172703:  65%|██████▌   | 65/100 [01:43<00:51,  1.46s/it]Best trial: 64. Best value: 0.172703:  66%|██████▌   | 66/100 [01:43<00:48,  1.43s/it]Best trial: 64. Best value: 0.172703:  66%|██████▌   | 66/100 [01:45<00:48,  1.43s/it]Best trial: 64. Best value: 0.172703:  67%|██████▋   | 67/100 [01:45<00:49,  1.49s/it]Best trial: 64. Best value: 0.172703:  67%|██████▋   | 67/100 [01:46<00:49,  1.49s/it]Best trial: 64. Best value: 0.172703:  68%|██████▊   | 68/100 [01:46<00:47,  1.47s/it]Best trial: 64. Best value: 0.172703:  68%|██████▊   | 68/100 [01:47<00:47,  1.47s/it]Best trial: 64. Best value: 0.172703:  69%|██████▉   | 69/100 [01:47<00:42,  1.38s/it]Best trial: 64. Best value: 0.172703:  69%|██████▉   | 69/100 [01:49<00:42,  1.38s/it]Best trial: 64. Best value: 0.172703:  70%|███████   | 70/100 [01:49<00:43,  1.45s/it]Best trial: 64. Best value: 0.172703:  70%|███████   | 70/100 [01:50<00:43,  1.45s/it]Best trial: 64. Best value: 0.172703:  71%|███████   | 71/100 [01:50<00:41,  1.42s/it]Best trial: 64. Best value: 0.172703:  71%|███████   | 71/100 [01:51<00:41,  1.42s/it]Best trial: 64. Best value: 0.172703:  72%|███████▏  | 72/100 [01:51<00:37,  1.34s/it]Best trial: 64. Best value: 0.172703:  72%|███████▏  | 72/100 [01:53<00:37,  1.34s/it]Best trial: 64. Best value: 0.172703:  73%|███████▎  | 73/100 [01:53<00:40,  1.50s/it]Best trial: 64. Best value: 0.172703:  73%|███████▎  | 73/100 [01:55<00:40,  1.50s/it]Best trial: 64. Best value: 0.172703:  74%|███████▍  | 74/100 [01:55<00:41,  1.58s/it]Best trial: 64. Best value: 0.172703:  74%|███████▍  | 74/100 [01:56<00:41,  1.58s/it]Best trial: 64. Best value: 0.172703:  75%|███████▌  | 75/100 [01:56<00:37,  1.51s/it]Best trial: 64. Best value: 0.172703:  75%|███████▌  | 75/100 [01:58<00:37,  1.51s/it]Best trial: 64. Best value: 0.172703:  76%|███████▌  | 76/100 [01:58<00:37,  1.56s/it]Best trial: 64. Best value: 0.172703:  76%|███████▌  | 76/100 [01:59<00:37,  1.56s/it]Best trial: 64. Best value: 0.172703:  77%|███████▋  | 77/100 [01:59<00:34,  1.50s/it]Best trial: 64. Best value: 0.172703:  77%|███████▋  | 77/100 [02:01<00:34,  1.50s/it]Best trial: 64. Best value: 0.172703:  78%|███████▊  | 78/100 [02:01<00:31,  1.41s/it]Best trial: 64. Best value: 0.172703:  78%|███████▊  | 78/100 [02:02<00:31,  1.41s/it]Best trial: 64. Best value: 0.172703:  79%|███████▉  | 79/100 [02:02<00:31,  1.51s/it]Best trial: 64. Best value: 0.172703:  79%|███████▉  | 79/100 [02:03<00:31,  1.51s/it]Best trial: 64. Best value: 0.172703:  80%|████████  | 80/100 [02:03<00:27,  1.38s/it]Best trial: 64. Best value: 0.172703:  80%|████████  | 80/100 [02:05<00:27,  1.38s/it]Best trial: 64. Best value: 0.172703:  81%|████████  | 81/100 [02:05<00:28,  1.49s/it]Best trial: 64. Best value: 0.172703:  81%|████████  | 81/100 [02:06<00:28,  1.49s/it]Best trial: 64. Best value: 0.172703:  82%|████████▏ | 82/100 [02:06<00:25,  1.41s/it]Best trial: 64. Best value: 0.172703:  82%|████████▏ | 82/100 [02:08<00:25,  1.41s/it]Best trial: 64. Best value: 0.172703:  83%|████████▎ | 83/100 [02:08<00:23,  1.37s/it]Best trial: 64. Best value: 0.172703:  83%|████████▎ | 83/100 [02:09<00:23,  1.37s/it]Best trial: 64. Best value: 0.172703:  84%|████████▍ | 84/100 [02:09<00:20,  1.31s/it]Best trial: 64. Best value: 0.172703:  84%|████████▍ | 84/100 [02:10<00:20,  1.31s/it]Best trial: 64. Best value: 0.172703:  85%|████████▌ | 85/100 [02:10<00:18,  1.27s/it]Best trial: 64. Best value: 0.172703:  85%|████████▌ | 85/100 [02:11<00:18,  1.27s/it]Best trial: 64. Best value: 0.172703:  86%|████████▌ | 86/100 [02:11<00:17,  1.25s/it]Best trial: 64. Best value: 0.172703:  86%|████████▌ | 86/100 [02:13<00:17,  1.25s/it]Best trial: 64. Best value: 0.172703:  87%|████████▋ | 87/100 [02:13<00:17,  1.38s/it]Best trial: 64. Best value: 0.172703:  87%|████████▋ | 87/100 [02:14<00:17,  1.38s/it]Best trial: 64. Best value: 0.172703:  88%|████████▊ | 88/100 [02:14<00:16,  1.41s/it]Best trial: 64. Best value: 0.172703:  88%|████████▊ | 88/100 [02:16<00:16,  1.41s/it]Best trial: 64. Best value: 0.172703:  89%|████████▉ | 89/100 [02:16<00:16,  1.46s/it]Best trial: 64. Best value: 0.172703:  89%|████████▉ | 89/100 [02:17<00:16,  1.46s/it]Best trial: 64. Best value: 0.172703:  90%|█████████ | 90/100 [02:17<00:14,  1.42s/it]Best trial: 64. Best value: 0.172703:  90%|█████████ | 90/100 [02:19<00:14,  1.42s/it]Best trial: 64. Best value: 0.172703:  91%|█████████ | 91/100 [02:19<00:12,  1.40s/it]Best trial: 64. Best value: 0.172703:  91%|█████████ | 91/100 [02:20<00:12,  1.40s/it]Best trial: 64. Best value: 0.172703:  92%|█████████▏| 92/100 [02:20<00:10,  1.32s/it]Best trial: 64. Best value: 0.172703:  92%|█████████▏| 92/100 [02:21<00:10,  1.32s/it]Best trial: 64. Best value: 0.172703:  93%|█████████▎| 93/100 [02:21<00:08,  1.26s/it]Best trial: 64. Best value: 0.172703:  93%|█████████▎| 93/100 [02:22<00:08,  1.26s/it]Best trial: 64. Best value: 0.172703:  94%|█████████▍| 94/100 [02:22<00:07,  1.27s/it]Best trial: 64. Best value: 0.172703:  94%|█████████▍| 94/100 [02:23<00:07,  1.27s/it]Best trial: 64. Best value: 0.172703:  95%|█████████▌| 95/100 [02:23<00:06,  1.26s/it]Best trial: 64. Best value: 0.172703:  95%|█████████▌| 95/100 [02:25<00:06,  1.26s/it]Best trial: 64. Best value: 0.172703:  96%|█████████▌| 96/100 [02:25<00:04,  1.23s/it]Best trial: 64. Best value: 0.172703:  96%|█████████▌| 96/100 [02:26<00:04,  1.23s/it]Best trial: 64. Best value: 0.172703:  97%|█████████▋| 97/100 [02:26<00:04,  1.38s/it]Best trial: 64. Best value: 0.172703:  97%|█████████▋| 97/100 [02:27<00:04,  1.38s/it]Best trial: 64. Best value: 0.172703:  98%|█████████▊| 98/100 [02:27<00:02,  1.34s/it]Best trial: 64. Best value: 0.172703:  98%|█████████▊| 98/100 [02:29<00:02,  1.34s/it]Best trial: 64. Best value: 0.172703:  99%|█████████▉| 99/100 [02:29<00:01,  1.39s/it]Best trial: 64. Best value: 0.172703:  99%|█████████▉| 99/100 [02:31<00:01,  1.39s/it]Best trial: 64. Best value: 0.172703: 100%|██████████| 100/100 [02:31<00:00,  1.48s/it]Best trial: 64. Best value: 0.172703: 100%|██████████| 100/100 [02:31<00:00,  1.51s/it]
2025-11-30 15:37:25,552 - INFO - HPO Complete. Best AUPRC: 0.1727
2025-11-30 15:37:25,552 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0003280509151169932, 'max_depth': 3, 'subsample': 0.699871273793533, 'colsample_bytree': 0.6792470867164441, 'gamma': 2.733286540052883, 'reg_lambda': 6.062816904714892e-05, 'reg_alpha': 3.8592302761422364e-08}
2025-11-30 15:37:25,553 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:37:27,416 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: pleth_only
2025-11-30 15:37:27,416 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:37:27,610 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:37:27,630 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:37:27,634 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:37:27,634 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:37:27,635 - INFO - Training model...
2025-11-30 15:37:28,724 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:37:33,678 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:37:33,678 - INFO - AUROC: 0.6217 (0.3440 - 0.8354)
2025-11-30 15:37:33,679 - INFO - AUPRC: 0.0153 (0.0048 - 0.0342)
2025-11-30 15:37:33,679 - INFO - Brier Score: 0.2091 (0.2077 - 0.2113)
2025-11-30 15:37:33,679 - INFO - Accuracy: 0.7500 (0.0061 - 0.8809)
2025-11-30 15:37:33,679 - INFO - Precision: 0.0173 (0.0049 - 0.0356)
2025-11-30 15:37:33,679 - INFO - Sensitivity (Recall): 0.5000 (0.2600 - 1.0000)
2025-11-30 15:37:33,679 - INFO - F1-Score: 0.0335 (0.0097 - 0.0660)
2025-11-30 15:37:33,679 - INFO - Best Threshold: 0.4800 (0.0100 - 0.5000)
2025-11-30 15:37:33,679 - INFO - Specificity: 0.7522 (0.0000 - 0.8869)
2025-11-30 15:37:33,688 - INFO - Calculating SHAP values...
2025-11-30 15:37:34,760 - INFO - SHAP plots saved.
2025-11-30 15:37:34,761 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:37:35,909 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: ecg_only
2025-11-30 15:37:35,910 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:37:36,104 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:37:36,125 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:37:36,130 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:37:36,130 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0636981:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0636981:   1%|          | 1/100 [00:02<04:02,  2.45s/it]Best trial: 1. Best value: 0.12856:   1%|          | 1/100 [00:04<04:02,  2.45s/it]  Best trial: 1. Best value: 0.12856:   2%|▏         | 2/100 [00:04<03:39,  2.24s/it]Best trial: 1. Best value: 0.12856:   2%|▏         | 2/100 [00:06<03:39,  2.24s/it]Best trial: 1. Best value: 0.12856:   3%|▎         | 3/100 [00:06<03:37,  2.24s/it]Best trial: 1. Best value: 0.12856:   3%|▎         | 3/100 [00:08<03:37,  2.24s/it]Best trial: 1. Best value: 0.12856:   4%|▍         | 4/100 [00:08<03:03,  1.91s/it]Best trial: 1. Best value: 0.12856:   4%|▍         | 4/100 [00:10<03:03,  1.91s/it]Best trial: 1. Best value: 0.12856:   5%|▌         | 5/100 [00:10<03:08,  1.99s/it]Best trial: 1. Best value: 0.12856:   5%|▌         | 5/100 [00:12<03:08,  1.99s/it]Best trial: 1. Best value: 0.12856:   6%|▌         | 6/100 [00:12<02:59,  1.90s/it]Best trial: 1. Best value: 0.12856:   6%|▌         | 6/100 [00:14<02:59,  1.90s/it]Best trial: 1. Best value: 0.12856:   7%|▋         | 7/100 [00:14<03:08,  2.03s/it]Best trial: 1. Best value: 0.12856:   7%|▋         | 7/100 [00:16<03:08,  2.03s/it]Best trial: 1. Best value: 0.12856:   8%|▊         | 8/100 [00:16<03:08,  2.05s/it]Best trial: 1. Best value: 0.12856:   8%|▊         | 8/100 [00:18<03:08,  2.05s/it]Best trial: 1. Best value: 0.12856:   9%|▉         | 9/100 [00:18<03:12,  2.12s/it]Best trial: 1. Best value: 0.12856:   9%|▉         | 9/100 [00:20<03:12,  2.12s/it]Best trial: 1. Best value: 0.12856:  10%|█         | 10/100 [00:20<02:58,  1.98s/it]Best trial: 1. Best value: 0.12856:  10%|█         | 10/100 [00:21<02:58,  1.98s/it]Best trial: 1. Best value: 0.12856:  11%|█         | 11/100 [00:21<02:40,  1.80s/it]Best trial: 11. Best value: 0.130393:  11%|█         | 11/100 [00:23<02:40,  1.80s/it]Best trial: 11. Best value: 0.130393:  12%|█▏        | 12/100 [00:23<02:33,  1.75s/it]Best trial: 12. Best value: 0.169262:  12%|█▏        | 12/100 [00:24<02:33,  1.75s/it]Best trial: 12. Best value: 0.169262:  13%|█▎        | 13/100 [00:24<02:27,  1.70s/it]Best trial: 12. Best value: 0.169262:  13%|█▎        | 13/100 [00:26<02:27,  1.70s/it]Best trial: 12. Best value: 0.169262:  14%|█▍        | 14/100 [00:26<02:29,  1.73s/it]Best trial: 12. Best value: 0.169262:  14%|█▍        | 14/100 [00:28<02:29,  1.73s/it]Best trial: 12. Best value: 0.169262:  15%|█▌        | 15/100 [00:28<02:21,  1.66s/it]Best trial: 12. Best value: 0.169262:  15%|█▌        | 15/100 [00:29<02:21,  1.66s/it]Best trial: 12. Best value: 0.169262:  16%|█▌        | 16/100 [00:29<02:18,  1.65s/it]Best trial: 12. Best value: 0.169262:  16%|█▌        | 16/100 [00:31<02:18,  1.65s/it]Best trial: 12. Best value: 0.169262:  17%|█▋        | 17/100 [00:31<02:21,  1.71s/it]Best trial: 12. Best value: 0.169262:  17%|█▋        | 17/100 [00:33<02:21,  1.71s/it]Best trial: 12. Best value: 0.169262:  18%|█▊        | 18/100 [00:33<02:21,  1.72s/it]Best trial: 12. Best value: 0.169262:  18%|█▊        | 18/100 [00:35<02:21,  1.72s/it]Best trial: 12. Best value: 0.169262:  19%|█▉        | 19/100 [00:35<02:14,  1.67s/it]Best trial: 12. Best value: 0.169262:  19%|█▉        | 19/100 [00:37<02:14,  1.67s/it]Best trial: 12. Best value: 0.169262:  20%|██        | 20/100 [00:37<02:23,  1.79s/it]Best trial: 12. Best value: 0.169262:  20%|██        | 20/100 [00:38<02:23,  1.79s/it]Best trial: 12. Best value: 0.169262:  21%|██        | 21/100 [00:38<02:14,  1.70s/it]Best trial: 12. Best value: 0.169262:  21%|██        | 21/100 [00:40<02:14,  1.70s/it]Best trial: 12. Best value: 0.169262:  22%|██▏       | 22/100 [00:40<02:17,  1.76s/it]Best trial: 12. Best value: 0.169262:  22%|██▏       | 22/100 [00:42<02:17,  1.76s/it]Best trial: 12. Best value: 0.169262:  23%|██▎       | 23/100 [00:42<02:17,  1.78s/it]Best trial: 12. Best value: 0.169262:  23%|██▎       | 23/100 [00:43<02:17,  1.78s/it]Best trial: 12. Best value: 0.169262:  24%|██▍       | 24/100 [00:43<02:09,  1.70s/it]Best trial: 12. Best value: 0.169262:  24%|██▍       | 24/100 [00:46<02:09,  1.70s/it]Best trial: 12. Best value: 0.169262:  25%|██▌       | 25/100 [00:46<02:27,  1.97s/it]Best trial: 12. Best value: 0.169262:  25%|██▌       | 25/100 [00:48<02:27,  1.97s/it]Best trial: 12. Best value: 0.169262:  26%|██▌       | 26/100 [00:48<02:19,  1.88s/it]Best trial: 12. Best value: 0.169262:  26%|██▌       | 26/100 [00:49<02:19,  1.88s/it]Best trial: 12. Best value: 0.169262:  27%|██▋       | 27/100 [00:49<02:14,  1.84s/it]Best trial: 12. Best value: 0.169262:  27%|██▋       | 27/100 [00:51<02:14,  1.84s/it]Best trial: 12. Best value: 0.169262:  28%|██▊       | 28/100 [00:51<02:09,  1.80s/it]Best trial: 12. Best value: 0.169262:  28%|██▊       | 28/100 [00:53<02:09,  1.80s/it]Best trial: 12. Best value: 0.169262:  29%|██▉       | 29/100 [00:53<02:02,  1.73s/it]Best trial: 12. Best value: 0.169262:  29%|██▉       | 29/100 [00:54<02:02,  1.73s/it]Best trial: 12. Best value: 0.169262:  30%|███       | 30/100 [00:54<01:57,  1.68s/it]Best trial: 12. Best value: 0.169262:  30%|███       | 30/100 [00:56<01:57,  1.68s/it]Best trial: 12. Best value: 0.169262:  31%|███       | 31/100 [00:56<01:59,  1.73s/it]Best trial: 12. Best value: 0.169262:  31%|███       | 31/100 [00:57<01:59,  1.73s/it]Best trial: 12. Best value: 0.169262:  32%|███▏      | 32/100 [00:57<01:45,  1.56s/it]Best trial: 12. Best value: 0.169262:  32%|███▏      | 32/100 [00:58<01:45,  1.56s/it]Best trial: 12. Best value: 0.169262:  33%|███▎      | 33/100 [00:58<01:38,  1.47s/it]Best trial: 12. Best value: 0.169262:  33%|███▎      | 33/100 [01:00<01:38,  1.47s/it]Best trial: 12. Best value: 0.169262:  34%|███▍      | 34/100 [01:00<01:43,  1.57s/it]Best trial: 12. Best value: 0.169262:  34%|███▍      | 34/100 [01:02<01:43,  1.57s/it]Best trial: 12. Best value: 0.169262:  35%|███▌      | 35/100 [01:02<01:51,  1.72s/it]Best trial: 12. Best value: 0.169262:  35%|███▌      | 35/100 [01:04<01:51,  1.72s/it]Best trial: 12. Best value: 0.169262:  36%|███▌      | 36/100 [01:04<01:46,  1.66s/it]Best trial: 12. Best value: 0.169262:  36%|███▌      | 36/100 [01:05<01:46,  1.66s/it]Best trial: 12. Best value: 0.169262:  37%|███▋      | 37/100 [01:05<01:41,  1.60s/it]Best trial: 12. Best value: 0.169262:  37%|███▋      | 37/100 [01:07<01:41,  1.60s/it]Best trial: 12. Best value: 0.169262:  38%|███▊      | 38/100 [01:07<01:43,  1.67s/it]Best trial: 12. Best value: 0.169262:  38%|███▊      | 38/100 [01:09<01:43,  1.67s/it]Best trial: 12. Best value: 0.169262:  39%|███▉      | 39/100 [01:09<01:42,  1.68s/it]Best trial: 12. Best value: 0.169262:  39%|███▉      | 39/100 [01:11<01:42,  1.68s/it]Best trial: 12. Best value: 0.169262:  40%|████      | 40/100 [01:11<01:40,  1.67s/it]Best trial: 12. Best value: 0.169262:  40%|████      | 40/100 [01:12<01:40,  1.67s/it]Best trial: 12. Best value: 0.169262:  41%|████      | 41/100 [01:12<01:39,  1.68s/it]Best trial: 12. Best value: 0.169262:  41%|████      | 41/100 [01:14<01:39,  1.68s/it]Best trial: 12. Best value: 0.169262:  42%|████▏     | 42/100 [01:14<01:34,  1.63s/it]Best trial: 12. Best value: 0.169262:  42%|████▏     | 42/100 [01:15<01:34,  1.63s/it]Best trial: 12. Best value: 0.169262:  43%|████▎     | 43/100 [01:15<01:29,  1.56s/it]Best trial: 12. Best value: 0.169262:  43%|████▎     | 43/100 [01:17<01:29,  1.56s/it]Best trial: 12. Best value: 0.169262:  44%|████▍     | 44/100 [01:17<01:30,  1.61s/it]Best trial: 12. Best value: 0.169262:  44%|████▍     | 44/100 [01:18<01:30,  1.61s/it]Best trial: 12. Best value: 0.169262:  45%|████▌     | 45/100 [01:18<01:26,  1.56s/it]Best trial: 12. Best value: 0.169262:  45%|████▌     | 45/100 [01:20<01:26,  1.56s/it]Best trial: 12. Best value: 0.169262:  46%|████▌     | 46/100 [01:20<01:25,  1.58s/it]Best trial: 12. Best value: 0.169262:  46%|████▌     | 46/100 [01:21<01:25,  1.58s/it]Best trial: 12. Best value: 0.169262:  47%|████▋     | 47/100 [01:21<01:22,  1.56s/it]Best trial: 12. Best value: 0.169262:  47%|████▋     | 47/100 [01:23<01:22,  1.56s/it]Best trial: 12. Best value: 0.169262:  48%|████▊     | 48/100 [01:23<01:18,  1.51s/it]Best trial: 12. Best value: 0.169262:  48%|████▊     | 48/100 [01:24<01:18,  1.51s/it]Best trial: 12. Best value: 0.169262:  49%|████▉     | 49/100 [01:24<01:17,  1.52s/it]Best trial: 12. Best value: 0.169262:  49%|████▉     | 49/100 [01:27<01:17,  1.52s/it]Best trial: 12. Best value: 0.169262:  50%|█████     | 50/100 [01:27<01:33,  1.87s/it]Best trial: 12. Best value: 0.169262:  50%|█████     | 50/100 [01:29<01:33,  1.87s/it]Best trial: 12. Best value: 0.169262:  51%|█████     | 51/100 [01:29<01:32,  1.88s/it]Best trial: 12. Best value: 0.169262:  51%|█████     | 51/100 [01:31<01:32,  1.88s/it]Best trial: 12. Best value: 0.169262:  52%|█████▏    | 52/100 [01:31<01:29,  1.86s/it]Best trial: 12. Best value: 0.169262:  52%|█████▏    | 52/100 [01:33<01:29,  1.86s/it]Best trial: 12. Best value: 0.169262:  53%|█████▎    | 53/100 [01:33<01:30,  1.92s/it]Best trial: 12. Best value: 0.169262:  53%|█████▎    | 53/100 [01:35<01:30,  1.92s/it]Best trial: 12. Best value: 0.169262:  54%|█████▍    | 54/100 [01:35<01:26,  1.89s/it]Best trial: 12. Best value: 0.169262:  54%|█████▍    | 54/100 [01:36<01:26,  1.89s/it]Best trial: 12. Best value: 0.169262:  55%|█████▌    | 55/100 [01:36<01:22,  1.84s/it]Best trial: 12. Best value: 0.169262:  55%|█████▌    | 55/100 [01:39<01:22,  1.84s/it]Best trial: 12. Best value: 0.169262:  56%|█████▌    | 56/100 [01:39<01:27,  1.99s/it]Best trial: 12. Best value: 0.169262:  56%|█████▌    | 56/100 [01:41<01:27,  1.99s/it]Best trial: 12. Best value: 0.169262:  57%|█████▋    | 57/100 [01:41<01:30,  2.10s/it]Best trial: 12. Best value: 0.169262:  57%|█████▋    | 57/100 [01:43<01:30,  2.10s/it]Best trial: 12. Best value: 0.169262:  58%|█████▊    | 58/100 [01:43<01:26,  2.07s/it]Best trial: 12. Best value: 0.169262:  58%|█████▊    | 58/100 [01:45<01:26,  2.07s/it]Best trial: 12. Best value: 0.169262:  59%|█████▉    | 59/100 [01:45<01:23,  2.04s/it]Best trial: 12. Best value: 0.169262:  59%|█████▉    | 59/100 [01:47<01:23,  2.04s/it]Best trial: 12. Best value: 0.169262:  60%|██████    | 60/100 [01:47<01:23,  2.09s/it]Best trial: 12. Best value: 0.169262:  60%|██████    | 60/100 [01:49<01:23,  2.09s/it]Best trial: 12. Best value: 0.169262:  61%|██████    | 61/100 [01:49<01:20,  2.06s/it]Best trial: 12. Best value: 0.169262:  61%|██████    | 61/100 [01:51<01:20,  2.06s/it]Best trial: 12. Best value: 0.169262:  62%|██████▏   | 62/100 [01:51<01:17,  2.04s/it]Best trial: 12. Best value: 0.169262:  62%|██████▏   | 62/100 [01:53<01:17,  2.04s/it]Best trial: 12. Best value: 0.169262:  63%|██████▎   | 63/100 [01:53<01:16,  2.06s/it]Best trial: 12. Best value: 0.169262:  63%|██████▎   | 63/100 [01:55<01:16,  2.06s/it]Best trial: 12. Best value: 0.169262:  64%|██████▍   | 64/100 [01:55<01:11,  1.98s/it]Best trial: 12. Best value: 0.169262:  64%|██████▍   | 64/100 [01:57<01:11,  1.98s/it]Best trial: 12. Best value: 0.169262:  65%|██████▌   | 65/100 [01:57<01:09,  1.98s/it]Best trial: 12. Best value: 0.169262:  65%|██████▌   | 65/100 [01:59<01:09,  1.98s/it]Best trial: 12. Best value: 0.169262:  66%|██████▌   | 66/100 [01:59<01:09,  2.05s/it]Best trial: 12. Best value: 0.169262:  66%|██████▌   | 66/100 [02:02<01:09,  2.05s/it]Best trial: 12. Best value: 0.169262:  67%|██████▋   | 67/100 [02:02<01:09,  2.10s/it]Best trial: 12. Best value: 0.169262:  67%|██████▋   | 67/100 [02:05<01:09,  2.10s/it]Best trial: 12. Best value: 0.169262:  68%|██████▊   | 68/100 [02:05<01:24,  2.64s/it]Best trial: 12. Best value: 0.169262:  68%|██████▊   | 68/100 [02:07<01:24,  2.64s/it]Best trial: 12. Best value: 0.169262:  69%|██████▉   | 69/100 [02:07<01:13,  2.36s/it]Best trial: 12. Best value: 0.169262:  69%|██████▉   | 69/100 [02:10<01:13,  2.36s/it]Best trial: 12. Best value: 0.169262:  70%|███████   | 70/100 [02:10<01:14,  2.47s/it]Best trial: 12. Best value: 0.169262:  70%|███████   | 70/100 [02:12<01:14,  2.47s/it]Best trial: 12. Best value: 0.169262:  71%|███████   | 71/100 [02:12<01:04,  2.22s/it]Best trial: 12. Best value: 0.169262:  71%|███████   | 71/100 [02:13<01:04,  2.22s/it]Best trial: 12. Best value: 0.169262:  72%|███████▏  | 72/100 [02:13<00:58,  2.09s/it]Best trial: 12. Best value: 0.169262:  72%|███████▏  | 72/100 [02:15<00:58,  2.09s/it]Best trial: 12. Best value: 0.169262:  73%|███████▎  | 73/100 [02:15<00:52,  1.96s/it]Best trial: 12. Best value: 0.169262:  73%|███████▎  | 73/100 [02:17<00:52,  1.96s/it]Best trial: 12. Best value: 0.169262:  74%|███████▍  | 74/100 [02:17<00:50,  1.93s/it]Best trial: 12. Best value: 0.169262:  74%|███████▍  | 74/100 [02:18<00:50,  1.93s/it]Best trial: 12. Best value: 0.169262:  75%|███████▌  | 75/100 [02:18<00:45,  1.82s/it]Best trial: 12. Best value: 0.169262:  75%|███████▌  | 75/100 [02:20<00:45,  1.82s/it]Best trial: 12. Best value: 0.169262:  76%|███████▌  | 76/100 [02:20<00:41,  1.74s/it]Best trial: 12. Best value: 0.169262:  76%|███████▌  | 76/100 [02:22<00:41,  1.74s/it]Best trial: 12. Best value: 0.169262:  77%|███████▋  | 77/100 [02:22<00:39,  1.73s/it]Best trial: 12. Best value: 0.169262:  77%|███████▋  | 77/100 [02:23<00:39,  1.73s/it]Best trial: 12. Best value: 0.169262:  78%|███████▊  | 78/100 [02:23<00:34,  1.55s/it]Best trial: 12. Best value: 0.169262:  78%|███████▊  | 78/100 [02:25<00:34,  1.55s/it]Best trial: 12. Best value: 0.169262:  79%|███████▉  | 79/100 [02:25<00:34,  1.64s/it]Best trial: 12. Best value: 0.169262:  79%|███████▉  | 79/100 [02:26<00:34,  1.64s/it]Best trial: 12. Best value: 0.169262:  80%|████████  | 80/100 [02:26<00:33,  1.68s/it]Best trial: 12. Best value: 0.169262:  80%|████████  | 80/100 [02:28<00:33,  1.68s/it]Best trial: 12. Best value: 0.169262:  81%|████████  | 81/100 [02:28<00:30,  1.62s/it]Best trial: 12. Best value: 0.169262:  81%|████████  | 81/100 [02:29<00:30,  1.62s/it]Best trial: 12. Best value: 0.169262:  82%|████████▏ | 82/100 [02:29<00:29,  1.62s/it]Best trial: 12. Best value: 0.169262:  82%|████████▏ | 82/100 [02:31<00:29,  1.62s/it]Best trial: 12. Best value: 0.169262:  83%|████████▎ | 83/100 [02:31<00:27,  1.63s/it]Best trial: 12. Best value: 0.169262:  83%|████████▎ | 83/100 [02:33<00:27,  1.63s/it]Best trial: 12. Best value: 0.169262:  84%|████████▍ | 84/100 [02:33<00:26,  1.65s/it]Best trial: 12. Best value: 0.169262:  84%|████████▍ | 84/100 [02:35<00:26,  1.65s/it]Best trial: 12. Best value: 0.169262:  85%|████████▌ | 85/100 [02:35<00:25,  1.70s/it]Best trial: 12. Best value: 0.169262:  85%|████████▌ | 85/100 [02:37<00:25,  1.70s/it]Best trial: 12. Best value: 0.169262:  86%|████████▌ | 86/100 [02:37<00:24,  1.75s/it]Best trial: 12. Best value: 0.169262:  86%|████████▌ | 86/100 [02:38<00:24,  1.75s/it]Best trial: 12. Best value: 0.169262:  87%|████████▋ | 87/100 [02:38<00:23,  1.78s/it]Best trial: 12. Best value: 0.169262:  87%|████████▋ | 87/100 [02:40<00:23,  1.78s/it]Best trial: 12. Best value: 0.169262:  88%|████████▊ | 88/100 [02:40<00:21,  1.77s/it]Best trial: 12. Best value: 0.169262:  88%|████████▊ | 88/100 [02:42<00:21,  1.77s/it]Best trial: 12. Best value: 0.169262:  89%|████████▉ | 89/100 [02:42<00:21,  1.93s/it]Best trial: 12. Best value: 0.169262:  89%|████████▉ | 89/100 [02:45<00:21,  1.93s/it]Best trial: 12. Best value: 0.169262:  90%|█████████ | 90/100 [02:45<00:21,  2.13s/it]Best trial: 12. Best value: 0.169262:  90%|█████████ | 90/100 [02:47<00:21,  2.13s/it]Best trial: 12. Best value: 0.169262:  91%|█████████ | 91/100 [02:47<00:18,  2.04s/it]Best trial: 12. Best value: 0.169262:  91%|█████████ | 91/100 [02:49<00:18,  2.04s/it]Best trial: 12. Best value: 0.169262:  92%|█████████▏| 92/100 [02:49<00:17,  2.16s/it]Best trial: 12. Best value: 0.169262:  92%|█████████▏| 92/100 [02:51<00:17,  2.16s/it]Best trial: 12. Best value: 0.169262:  93%|█████████▎| 93/100 [02:51<00:14,  2.14s/it]Best trial: 12. Best value: 0.169262:  93%|█████████▎| 93/100 [02:53<00:14,  2.14s/it]Best trial: 12. Best value: 0.169262:  94%|█████████▍| 94/100 [02:53<00:12,  2.08s/it]Best trial: 12. Best value: 0.169262:  94%|█████████▍| 94/100 [02:55<00:12,  2.08s/it]Best trial: 12. Best value: 0.169262:  95%|█████████▌| 95/100 [02:55<00:10,  2.02s/it]Best trial: 12. Best value: 0.169262:  95%|█████████▌| 95/100 [02:57<00:10,  2.02s/it]Best trial: 12. Best value: 0.169262:  96%|█████████▌| 96/100 [02:57<00:07,  1.99s/it]Best trial: 12. Best value: 0.169262:  96%|█████████▌| 96/100 [02:59<00:07,  1.99s/it]Best trial: 12. Best value: 0.169262:  97%|█████████▋| 97/100 [02:59<00:05,  1.95s/it]Best trial: 12. Best value: 0.169262:  97%|█████████▋| 97/100 [03:01<00:05,  1.95s/it]Best trial: 12. Best value: 0.169262:  98%|█████████▊| 98/100 [03:01<00:03,  1.94s/it]Best trial: 12. Best value: 0.169262:  98%|█████████▊| 98/100 [03:03<00:03,  1.94s/it]Best trial: 12. Best value: 0.169262:  99%|█████████▉| 99/100 [03:03<00:02,  2.09s/it]Best trial: 12. Best value: 0.169262:  99%|█████████▉| 99/100 [03:06<00:02,  2.09s/it]Best trial: 12. Best value: 0.169262: 100%|██████████| 100/100 [03:06<00:00,  2.24s/it]Best trial: 12. Best value: 0.169262: 100%|██████████| 100/100 [03:06<00:00,  1.86s/it]
2025-11-30 15:40:42,526 - INFO - HPO Complete. Best AUPRC: 0.1693
2025-11-30 15:40:42,526 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.00022976475612157679, 'max_depth': 5, 'subsample': 0.8935461071068814, 'colsample_bytree': 0.6219482968940958, 'gamma': 2.34642913878888, 'reg_lambda': 0.8500519647397952, 'reg_alpha': 0.01878479612449078}
2025-11-30 15:40:42,527 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:40:44,564 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: ecg_only
2025-11-30 15:40:44,564 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:40:44,746 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:40:44,767 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:40:44,771 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:40:44,772 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:40:44,772 - INFO - Training model...
2025-11-30 15:40:47,038 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:40:51,978 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:40:51,979 - INFO - AUROC: 0.5432 (0.2916 - 0.8032)
2025-11-30 15:40:51,979 - INFO - AUPRC: 0.0116 (0.0047 - 0.0258)
2025-11-30 15:40:51,979 - INFO - Brier Score: 0.1957 (0.1944 - 0.1967)
2025-11-30 15:40:51,979 - INFO - Accuracy: 0.7688 (0.0043 - 0.7968)
2025-11-30 15:40:51,979 - INFO - Precision: 0.0127 (0.0043 - 0.0296)
2025-11-30 15:40:51,979 - INFO - Sensitivity (Recall): 0.3333 (0.3855 - 1.0000)
2025-11-30 15:40:51,979 - INFO - F1-Score: 0.0244 (0.0086 - 0.0566)
2025-11-30 15:40:51,979 - INFO - Best Threshold: 0.4500 (0.0100 - 0.4500)
2025-11-30 15:40:51,979 - INFO - Specificity: 0.7726 (0.0000 - 0.7973)
2025-11-30 15:40:51,994 - INFO - Calculating SHAP values...
2025-11-30 15:40:53,163 - INFO - SHAP plots saved.
2025-11-30 15:40:53,164 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:40:54,440 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: co2_only
2025-11-30 15:40:54,440 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:40:54,669 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:40:54,689 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:40:54,697 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:40:54,697 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0220341:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0220341:   1%|          | 1/100 [00:02<03:22,  2.04s/it]Best trial: 1. Best value: 0.0264316:   1%|          | 1/100 [00:04<03:22,  2.04s/it]Best trial: 1. Best value: 0.0264316:   2%|▏         | 2/100 [00:04<04:04,  2.49s/it]Best trial: 1. Best value: 0.0264316:   2%|▏         | 2/100 [00:07<04:04,  2.49s/it]Best trial: 1. Best value: 0.0264316:   3%|▎         | 3/100 [00:07<03:53,  2.40s/it]Best trial: 3. Best value: 0.0692262:   3%|▎         | 3/100 [00:08<03:53,  2.40s/it]Best trial: 3. Best value: 0.0692262:   4%|▍         | 4/100 [00:08<03:26,  2.15s/it]Best trial: 3. Best value: 0.0692262:   4%|▍         | 4/100 [00:10<03:26,  2.15s/it]Best trial: 3. Best value: 0.0692262:   5%|▌         | 5/100 [00:10<03:01,  1.91s/it]Best trial: 3. Best value: 0.0692262:   5%|▌         | 5/100 [00:11<03:01,  1.91s/it]Best trial: 3. Best value: 0.0692262:   6%|▌         | 6/100 [00:11<02:49,  1.80s/it]Best trial: 3. Best value: 0.0692262:   6%|▌         | 6/100 [00:13<02:49,  1.80s/it]Best trial: 3. Best value: 0.0692262:   7%|▋         | 7/100 [00:13<02:51,  1.84s/it]Best trial: 3. Best value: 0.0692262:   7%|▋         | 7/100 [00:15<02:51,  1.84s/it]Best trial: 3. Best value: 0.0692262:   8%|▊         | 8/100 [00:15<02:33,  1.67s/it]Best trial: 3. Best value: 0.0692262:   8%|▊         | 8/100 [00:16<02:33,  1.67s/it]Best trial: 3. Best value: 0.0692262:   9%|▉         | 9/100 [00:16<02:29,  1.65s/it]Best trial: 3. Best value: 0.0692262:   9%|▉         | 9/100 [00:18<02:29,  1.65s/it]Best trial: 3. Best value: 0.0692262:  10%|█         | 10/100 [00:18<02:33,  1.70s/it]Best trial: 3. Best value: 0.0692262:  10%|█         | 10/100 [00:21<02:33,  1.70s/it]Best trial: 3. Best value: 0.0692262:  11%|█         | 11/100 [00:21<02:50,  1.92s/it]Best trial: 3. Best value: 0.0692262:  11%|█         | 11/100 [00:22<02:50,  1.92s/it]Best trial: 3. Best value: 0.0692262:  12%|█▏        | 12/100 [00:22<02:36,  1.78s/it]Best trial: 3. Best value: 0.0692262:  12%|█▏        | 12/100 [00:24<02:36,  1.78s/it]Best trial: 3. Best value: 0.0692262:  13%|█▎        | 13/100 [00:24<02:29,  1.72s/it]Best trial: 3. Best value: 0.0692262:  13%|█▎        | 13/100 [00:25<02:29,  1.72s/it]Best trial: 3. Best value: 0.0692262:  14%|█▍        | 14/100 [00:25<02:22,  1.66s/it]Best trial: 3. Best value: 0.0692262:  14%|█▍        | 14/100 [00:27<02:22,  1.66s/it]Best trial: 3. Best value: 0.0692262:  15%|█▌        | 15/100 [00:27<02:36,  1.84s/it]Best trial: 3. Best value: 0.0692262:  15%|█▌        | 15/100 [00:29<02:36,  1.84s/it]Best trial: 3. Best value: 0.0692262:  16%|█▌        | 16/100 [00:29<02:32,  1.82s/it]Best trial: 3. Best value: 0.0692262:  16%|█▌        | 16/100 [00:31<02:32,  1.82s/it]Best trial: 3. Best value: 0.0692262:  17%|█▋        | 17/100 [00:31<02:27,  1.77s/it]Best trial: 3. Best value: 0.0692262:  17%|█▋        | 17/100 [00:33<02:27,  1.77s/it]Best trial: 3. Best value: 0.0692262:  18%|█▊        | 18/100 [00:33<02:25,  1.77s/it]Best trial: 3. Best value: 0.0692262:  18%|█▊        | 18/100 [00:35<02:25,  1.77s/it]Best trial: 3. Best value: 0.0692262:  19%|█▉        | 19/100 [00:35<02:28,  1.83s/it]Best trial: 3. Best value: 0.0692262:  19%|█▉        | 19/100 [00:36<02:28,  1.83s/it]Best trial: 3. Best value: 0.0692262:  20%|██        | 20/100 [00:36<02:13,  1.67s/it]Best trial: 3. Best value: 0.0692262:  20%|██        | 20/100 [00:38<02:13,  1.67s/it]Best trial: 3. Best value: 0.0692262:  21%|██        | 21/100 [00:38<02:15,  1.72s/it]Best trial: 21. Best value: 0.0750213:  21%|██        | 21/100 [00:39<02:15,  1.72s/it]Best trial: 21. Best value: 0.0750213:  22%|██▏       | 22/100 [00:39<02:03,  1.58s/it]Best trial: 21. Best value: 0.0750213:  22%|██▏       | 22/100 [00:40<02:03,  1.58s/it]Best trial: 21. Best value: 0.0750213:  23%|██▎       | 23/100 [00:40<01:53,  1.47s/it]Best trial: 21. Best value: 0.0750213:  23%|██▎       | 23/100 [00:41<01:53,  1.47s/it]Best trial: 21. Best value: 0.0750213:  24%|██▍       | 24/100 [00:41<01:46,  1.40s/it]Best trial: 21. Best value: 0.0750213:  24%|██▍       | 24/100 [00:43<01:46,  1.40s/it]Best trial: 21. Best value: 0.0750213:  25%|██▌       | 25/100 [00:43<01:42,  1.37s/it]Best trial: 21. Best value: 0.0750213:  25%|██▌       | 25/100 [00:44<01:42,  1.37s/it]Best trial: 21. Best value: 0.0750213:  26%|██▌       | 26/100 [00:44<01:39,  1.34s/it]Best trial: 21. Best value: 0.0750213:  26%|██▌       | 26/100 [00:45<01:39,  1.34s/it]Best trial: 21. Best value: 0.0750213:  27%|██▋       | 27/100 [00:45<01:38,  1.35s/it]Best trial: 27. Best value: 0.0781945:  27%|██▋       | 27/100 [00:46<01:38,  1.35s/it]Best trial: 27. Best value: 0.0781945:  28%|██▊       | 28/100 [00:46<01:32,  1.29s/it]Best trial: 27. Best value: 0.0781945:  28%|██▊       | 28/100 [00:48<01:32,  1.29s/it]Best trial: 27. Best value: 0.0781945:  29%|██▉       | 29/100 [00:48<01:27,  1.24s/it]Best trial: 27. Best value: 0.0781945:  29%|██▉       | 29/100 [00:49<01:27,  1.24s/it]Best trial: 27. Best value: 0.0781945:  30%|███       | 30/100 [00:49<01:26,  1.24s/it]Best trial: 27. Best value: 0.0781945:  30%|███       | 30/100 [00:50<01:26,  1.24s/it]Best trial: 27. Best value: 0.0781945:  31%|███       | 31/100 [00:50<01:28,  1.28s/it]Best trial: 27. Best value: 0.0781945:  31%|███       | 31/100 [00:51<01:28,  1.28s/it]Best trial: 27. Best value: 0.0781945:  32%|███▏      | 32/100 [00:51<01:27,  1.28s/it]Best trial: 27. Best value: 0.0781945:  32%|███▏      | 32/100 [00:53<01:27,  1.28s/it]Best trial: 27. Best value: 0.0781945:  33%|███▎      | 33/100 [00:53<01:26,  1.29s/it]Best trial: 27. Best value: 0.0781945:  33%|███▎      | 33/100 [00:54<01:26,  1.29s/it]Best trial: 27. Best value: 0.0781945:  34%|███▍      | 34/100 [00:54<01:28,  1.34s/it]Best trial: 27. Best value: 0.0781945:  34%|███▍      | 34/100 [00:55<01:28,  1.34s/it]Best trial: 27. Best value: 0.0781945:  35%|███▌      | 35/100 [00:55<01:23,  1.28s/it]Best trial: 27. Best value: 0.0781945:  35%|███▌      | 35/100 [00:57<01:23,  1.28s/it]Best trial: 27. Best value: 0.0781945:  36%|███▌      | 36/100 [00:57<01:23,  1.30s/it]Best trial: 27. Best value: 0.0781945:  36%|███▌      | 36/100 [00:58<01:23,  1.30s/it]Best trial: 27. Best value: 0.0781945:  37%|███▋      | 37/100 [00:58<01:20,  1.28s/it]Best trial: 27. Best value: 0.0781945:  37%|███▋      | 37/100 [00:59<01:20,  1.28s/it]Best trial: 27. Best value: 0.0781945:  38%|███▊      | 38/100 [00:59<01:17,  1.26s/it]Best trial: 27. Best value: 0.0781945:  38%|███▊      | 38/100 [01:01<01:17,  1.26s/it]Best trial: 27. Best value: 0.0781945:  39%|███▉      | 39/100 [01:01<01:19,  1.31s/it]Best trial: 27. Best value: 0.0781945:  39%|███▉      | 39/100 [01:02<01:19,  1.31s/it]Best trial: 27. Best value: 0.0781945:  40%|████      | 40/100 [01:02<01:14,  1.25s/it]Best trial: 40. Best value: 0.082028:  40%|████      | 40/100 [01:03<01:14,  1.25s/it] Best trial: 40. Best value: 0.082028:  41%|████      | 41/100 [01:03<01:14,  1.27s/it]Best trial: 41. Best value: 0.0863842:  41%|████      | 41/100 [01:05<01:14,  1.27s/it]Best trial: 41. Best value: 0.0863842:  42%|████▏     | 42/100 [01:05<01:19,  1.37s/it]Best trial: 41. Best value: 0.0863842:  42%|████▏     | 42/100 [01:06<01:19,  1.37s/it]Best trial: 41. Best value: 0.0863842:  43%|████▎     | 43/100 [01:06<01:19,  1.40s/it]Best trial: 41. Best value: 0.0863842:  43%|████▎     | 43/100 [01:07<01:19,  1.40s/it]Best trial: 41. Best value: 0.0863842:  44%|████▍     | 44/100 [01:07<01:16,  1.37s/it]Best trial: 41. Best value: 0.0863842:  44%|████▍     | 44/100 [01:09<01:16,  1.37s/it]Best trial: 41. Best value: 0.0863842:  45%|████▌     | 45/100 [01:09<01:11,  1.29s/it]Best trial: 41. Best value: 0.0863842:  45%|████▌     | 45/100 [01:10<01:11,  1.29s/it]Best trial: 41. Best value: 0.0863842:  46%|████▌     | 46/100 [01:10<01:14,  1.39s/it]Best trial: 41. Best value: 0.0863842:  46%|████▌     | 46/100 [01:12<01:14,  1.39s/it]Best trial: 41. Best value: 0.0863842:  47%|████▋     | 47/100 [01:12<01:16,  1.44s/it]Best trial: 41. Best value: 0.0863842:  47%|████▋     | 47/100 [01:13<01:16,  1.44s/it]Best trial: 41. Best value: 0.0863842:  48%|████▊     | 48/100 [01:13<01:06,  1.29s/it]Best trial: 41. Best value: 0.0863842:  48%|████▊     | 48/100 [01:14<01:06,  1.29s/it]Best trial: 41. Best value: 0.0863842:  49%|████▉     | 49/100 [01:14<01:04,  1.27s/it]Best trial: 41. Best value: 0.0863842:  49%|████▉     | 49/100 [01:15<01:04,  1.27s/it]Best trial: 41. Best value: 0.0863842:  50%|█████     | 50/100 [01:15<01:01,  1.23s/it]Best trial: 41. Best value: 0.0863842:  50%|█████     | 50/100 [01:16<01:01,  1.23s/it]Best trial: 41. Best value: 0.0863842:  51%|█████     | 51/100 [01:16<01:00,  1.24s/it]Best trial: 41. Best value: 0.0863842:  51%|█████     | 51/100 [01:18<01:00,  1.24s/it]Best trial: 41. Best value: 0.0863842:  52%|█████▏    | 52/100 [01:18<01:01,  1.28s/it]Best trial: 41. Best value: 0.0863842:  52%|█████▏    | 52/100 [01:19<01:01,  1.28s/it]Best trial: 41. Best value: 0.0863842:  53%|█████▎    | 53/100 [01:19<01:01,  1.31s/it]Best trial: 41. Best value: 0.0863842:  53%|█████▎    | 53/100 [01:20<01:01,  1.31s/it]Best trial: 41. Best value: 0.0863842:  54%|█████▍    | 54/100 [01:20<00:58,  1.28s/it]Best trial: 41. Best value: 0.0863842:  54%|█████▍    | 54/100 [01:21<00:58,  1.28s/it]Best trial: 41. Best value: 0.0863842:  55%|█████▌    | 55/100 [01:21<00:57,  1.27s/it]Best trial: 55. Best value: 0.0880902:  55%|█████▌    | 55/100 [01:23<00:57,  1.27s/it]Best trial: 55. Best value: 0.0880902:  56%|█████▌    | 56/100 [01:23<00:56,  1.29s/it]Best trial: 55. Best value: 0.0880902:  56%|█████▌    | 56/100 [01:25<00:56,  1.29s/it]Best trial: 55. Best value: 0.0880902:  57%|█████▋    | 57/100 [01:25<01:07,  1.56s/it]Best trial: 55. Best value: 0.0880902:  57%|█████▋    | 57/100 [01:26<01:07,  1.56s/it]Best trial: 55. Best value: 0.0880902:  58%|█████▊    | 58/100 [01:26<01:03,  1.52s/it]Best trial: 55. Best value: 0.0880902:  58%|█████▊    | 58/100 [01:28<01:03,  1.52s/it]Best trial: 55. Best value: 0.0880902:  59%|█████▉    | 59/100 [01:28<00:58,  1.42s/it]Best trial: 55. Best value: 0.0880902:  59%|█████▉    | 59/100 [01:29<00:58,  1.42s/it]Best trial: 55. Best value: 0.0880902:  60%|██████    | 60/100 [01:29<00:53,  1.33s/it]Best trial: 55. Best value: 0.0880902:  60%|██████    | 60/100 [01:30<00:53,  1.33s/it]Best trial: 55. Best value: 0.0880902:  61%|██████    | 61/100 [01:30<00:54,  1.39s/it]Best trial: 55. Best value: 0.0880902:  61%|██████    | 61/100 [01:32<00:54,  1.39s/it]Best trial: 55. Best value: 0.0880902:  62%|██████▏   | 62/100 [01:32<00:55,  1.47s/it]Best trial: 62. Best value: 0.0969089:  62%|██████▏   | 62/100 [01:33<00:55,  1.47s/it]Best trial: 62. Best value: 0.0969089:  63%|██████▎   | 63/100 [01:33<00:51,  1.39s/it]Best trial: 62. Best value: 0.0969089:  63%|██████▎   | 63/100 [01:34<00:51,  1.39s/it]Best trial: 62. Best value: 0.0969089:  64%|██████▍   | 64/100 [01:34<00:48,  1.36s/it]Best trial: 62. Best value: 0.0969089:  64%|██████▍   | 64/100 [01:36<00:48,  1.36s/it]Best trial: 62. Best value: 0.0969089:  65%|██████▌   | 65/100 [01:36<00:45,  1.30s/it]Best trial: 62. Best value: 0.0969089:  65%|██████▌   | 65/100 [01:37<00:45,  1.30s/it]Best trial: 62. Best value: 0.0969089:  66%|██████▌   | 66/100 [01:37<00:45,  1.33s/it]Best trial: 62. Best value: 0.0969089:  66%|██████▌   | 66/100 [01:38<00:45,  1.33s/it]Best trial: 62. Best value: 0.0969089:  67%|██████▋   | 67/100 [01:38<00:42,  1.27s/it]Best trial: 62. Best value: 0.0969089:  67%|██████▋   | 67/100 [01:39<00:42,  1.27s/it]Best trial: 62. Best value: 0.0969089:  68%|██████▊   | 68/100 [01:39<00:40,  1.26s/it]Best trial: 62. Best value: 0.0969089:  68%|██████▊   | 68/100 [01:40<00:40,  1.26s/it]Best trial: 62. Best value: 0.0969089:  69%|██████▉   | 69/100 [01:40<00:38,  1.23s/it]Best trial: 62. Best value: 0.0969089:  69%|██████▉   | 69/100 [01:42<00:38,  1.23s/it]Best trial: 62. Best value: 0.0969089:  70%|███████   | 70/100 [01:42<00:37,  1.24s/it]Best trial: 62. Best value: 0.0969089:  70%|███████   | 70/100 [01:43<00:37,  1.24s/it]Best trial: 62. Best value: 0.0969089:  71%|███████   | 71/100 [01:43<00:36,  1.25s/it]Best trial: 62. Best value: 0.0969089:  71%|███████   | 71/100 [01:44<00:36,  1.25s/it]Best trial: 62. Best value: 0.0969089:  72%|███████▏  | 72/100 [01:44<00:35,  1.29s/it]Best trial: 62. Best value: 0.0969089:  72%|███████▏  | 72/100 [01:47<00:35,  1.29s/it]Best trial: 62. Best value: 0.0969089:  73%|███████▎  | 73/100 [01:47<00:42,  1.58s/it]Best trial: 62. Best value: 0.0969089:  73%|███████▎  | 73/100 [01:48<00:42,  1.58s/it]Best trial: 62. Best value: 0.0969089:  74%|███████▍  | 74/100 [01:48<00:39,  1.50s/it]Best trial: 62. Best value: 0.0969089:  74%|███████▍  | 74/100 [01:49<00:39,  1.50s/it]Best trial: 62. Best value: 0.0969089:  75%|███████▌  | 75/100 [01:49<00:36,  1.46s/it]Best trial: 62. Best value: 0.0969089:  75%|███████▌  | 75/100 [01:51<00:36,  1.46s/it]Best trial: 62. Best value: 0.0969089:  76%|███████▌  | 76/100 [01:51<00:34,  1.43s/it]Best trial: 62. Best value: 0.0969089:  76%|███████▌  | 76/100 [01:52<00:34,  1.43s/it]Best trial: 62. Best value: 0.0969089:  77%|███████▋  | 77/100 [01:52<00:32,  1.42s/it]Best trial: 62. Best value: 0.0969089:  77%|███████▋  | 77/100 [01:53<00:32,  1.42s/it]Best trial: 62. Best value: 0.0969089:  78%|███████▊  | 78/100 [01:53<00:29,  1.36s/it]Best trial: 62. Best value: 0.0969089:  78%|███████▊  | 78/100 [01:54<00:29,  1.36s/it]Best trial: 62. Best value: 0.0969089:  79%|███████▉  | 79/100 [01:54<00:26,  1.26s/it]Best trial: 62. Best value: 0.0969089:  79%|███████▉  | 79/100 [01:56<00:26,  1.26s/it]Best trial: 62. Best value: 0.0969089:  80%|████████  | 80/100 [01:56<00:26,  1.32s/it]Best trial: 62. Best value: 0.0969089:  80%|████████  | 80/100 [01:58<00:26,  1.32s/it]Best trial: 62. Best value: 0.0969089:  81%|████████  | 81/100 [01:58<00:30,  1.61s/it]Best trial: 62. Best value: 0.0969089:  81%|████████  | 81/100 [02:00<00:30,  1.61s/it]Best trial: 62. Best value: 0.0969089:  82%|████████▏ | 82/100 [02:00<00:28,  1.56s/it]Best trial: 62. Best value: 0.0969089:  82%|████████▏ | 82/100 [02:01<00:28,  1.56s/it]Best trial: 62. Best value: 0.0969089:  83%|████████▎ | 83/100 [02:01<00:24,  1.45s/it]Best trial: 62. Best value: 0.0969089:  83%|████████▎ | 83/100 [02:02<00:24,  1.45s/it]Best trial: 62. Best value: 0.0969089:  84%|████████▍ | 84/100 [02:02<00:21,  1.34s/it]Best trial: 62. Best value: 0.0969089:  84%|████████▍ | 84/100 [02:03<00:21,  1.34s/it]Best trial: 62. Best value: 0.0969089:  85%|████████▌ | 85/100 [02:03<00:19,  1.31s/it]Best trial: 62. Best value: 0.0969089:  85%|████████▌ | 85/100 [02:04<00:19,  1.31s/it]Best trial: 62. Best value: 0.0969089:  86%|████████▌ | 86/100 [02:04<00:18,  1.30s/it]Best trial: 62. Best value: 0.0969089:  86%|████████▌ | 86/100 [02:05<00:18,  1.30s/it]Best trial: 62. Best value: 0.0969089:  87%|████████▋ | 87/100 [02:05<00:16,  1.26s/it]Best trial: 62. Best value: 0.0969089:  87%|████████▋ | 87/100 [02:07<00:16,  1.26s/it]Best trial: 62. Best value: 0.0969089:  88%|████████▊ | 88/100 [02:07<00:16,  1.35s/it]Best trial: 62. Best value: 0.0969089:  88%|████████▊ | 88/100 [02:08<00:16,  1.35s/it]Best trial: 62. Best value: 0.0969089:  89%|████████▉ | 89/100 [02:08<00:14,  1.31s/it]Best trial: 62. Best value: 0.0969089:  89%|████████▉ | 89/100 [02:09<00:14,  1.31s/it]Best trial: 62. Best value: 0.0969089:  90%|█████████ | 90/100 [02:09<00:12,  1.28s/it]Best trial: 62. Best value: 0.0969089:  90%|█████████ | 90/100 [02:11<00:12,  1.28s/it]Best trial: 62. Best value: 0.0969089:  91%|█████████ | 91/100 [02:11<00:11,  1.26s/it]Best trial: 62. Best value: 0.0969089:  91%|█████████ | 91/100 [02:12<00:11,  1.26s/it]Best trial: 62. Best value: 0.0969089:  92%|█████████▏| 92/100 [02:12<00:10,  1.32s/it]Best trial: 62. Best value: 0.0969089:  92%|█████████▏| 92/100 [02:13<00:10,  1.32s/it]Best trial: 62. Best value: 0.0969089:  93%|█████████▎| 93/100 [02:13<00:09,  1.30s/it]Best trial: 62. Best value: 0.0969089:  93%|█████████▎| 93/100 [02:15<00:09,  1.30s/it]Best trial: 62. Best value: 0.0969089:  94%|█████████▍| 94/100 [02:15<00:07,  1.31s/it]Best trial: 62. Best value: 0.0969089:  94%|█████████▍| 94/100 [02:16<00:07,  1.31s/it]Best trial: 62. Best value: 0.0969089:  95%|█████████▌| 95/100 [02:16<00:06,  1.34s/it]Best trial: 62. Best value: 0.0969089:  95%|█████████▌| 95/100 [02:18<00:06,  1.34s/it]Best trial: 62. Best value: 0.0969089:  96%|█████████▌| 96/100 [02:18<00:05,  1.35s/it]Best trial: 62. Best value: 0.0969089:  96%|█████████▌| 96/100 [02:19<00:05,  1.35s/it]Best trial: 62. Best value: 0.0969089:  97%|█████████▋| 97/100 [02:19<00:03,  1.31s/it]Best trial: 62. Best value: 0.0969089:  97%|█████████▋| 97/100 [02:21<00:03,  1.31s/it]Best trial: 62. Best value: 0.0969089:  98%|█████████▊| 98/100 [02:21<00:03,  1.55s/it]Best trial: 62. Best value: 0.0969089:  98%|█████████▊| 98/100 [02:22<00:03,  1.55s/it]Best trial: 62. Best value: 0.0969089:  99%|█████████▉| 99/100 [02:22<00:01,  1.43s/it]Best trial: 62. Best value: 0.0969089:  99%|█████████▉| 99/100 [02:23<00:01,  1.43s/it]Best trial: 62. Best value: 0.0969089: 100%|██████████| 100/100 [02:23<00:00,  1.36s/it]Best trial: 62. Best value: 0.0969089: 100%|██████████| 100/100 [02:23<00:00,  1.44s/it]
2025-11-30 15:43:18,404 - INFO - HPO Complete. Best AUPRC: 0.0969
2025-11-30 15:43:18,404 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.0018510521629038403, 'max_depth': 3, 'subsample': 0.6386810020006237, 'colsample_bytree': 0.6281662645830344, 'gamma': 0.5216864581516024, 'reg_lambda': 0.0012768222273029648, 'reg_alpha': 5.440566508233135e-08}
2025-11-30 15:43:18,405 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:43:20,219 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: co2_only
2025-11-30 15:43:20,220 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:43:20,410 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:43:20,430 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:43:20,434 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:43:20,434 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:43:20,434 - INFO - Training model...
2025-11-30 15:43:22,331 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:43:27,378 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:43:27,378 - INFO - AUROC: 0.4716 (0.1659 - 0.7290)
2025-11-30 15:43:27,378 - INFO - AUPRC: 0.0110 (0.0042 - 0.0283)
2025-11-30 15:43:27,378 - INFO - Brier Score: 0.0560 (0.0519 - 0.0616)
2025-11-30 15:43:27,378 - INFO - Accuracy: 0.7876 (0.1182 - 0.8971)
2025-11-30 15:43:27,378 - INFO - Precision: 0.0138 (0.0049 - 0.0419)
2025-11-30 15:43:27,378 - INFO - Sensitivity (Recall): 0.3333 (0.1429 - 1.0000)
2025-11-30 15:43:27,378 - INFO - F1-Score: 0.0265 (0.0098 - 0.0773)
2025-11-30 15:43:27,378 - INFO - Best Threshold: 0.2600 (0.1400 - 0.3100)
2025-11-30 15:43:27,378 - INFO - Specificity: 0.7915 (0.1128 - 0.9022)
2025-11-30 15:43:27,392 - INFO - Calculating SHAP values...
2025-11-30 15:43:28,507 - INFO - SHAP plots saved.
2025-11-30 15:43:28,508 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:43:29,770 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: awp_only
2025-11-30 15:43:29,770 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:43:29,993 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:43:30,018 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:43:30,024 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:43:30,024 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0199603:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0199603:   1%|          | 1/100 [00:02<03:43,  2.25s/it]Best trial: 1. Best value: 0.0280775:   1%|          | 1/100 [00:03<03:43,  2.25s/it]Best trial: 1. Best value: 0.0280775:   2%|▏         | 2/100 [00:03<03:07,  1.92s/it]Best trial: 1. Best value: 0.0280775:   2%|▏         | 2/100 [00:05<03:07,  1.92s/it]Best trial: 1. Best value: 0.0280775:   3%|▎         | 3/100 [00:05<03:05,  1.91s/it]Best trial: 3. Best value: 0.0422156:   3%|▎         | 3/100 [00:07<03:05,  1.91s/it]Best trial: 3. Best value: 0.0422156:   4%|▍         | 4/100 [00:07<02:54,  1.82s/it]Best trial: 3. Best value: 0.0422156:   4%|▍         | 4/100 [00:09<02:54,  1.82s/it]Best trial: 3. Best value: 0.0422156:   5%|▌         | 5/100 [00:09<02:52,  1.82s/it]Best trial: 3. Best value: 0.0422156:   5%|▌         | 5/100 [00:10<02:52,  1.82s/it]Best trial: 3. Best value: 0.0422156:   6%|▌         | 6/100 [00:10<02:45,  1.76s/it]Best trial: 3. Best value: 0.0422156:   6%|▌         | 6/100 [00:13<02:45,  1.76s/it]Best trial: 3. Best value: 0.0422156:   7%|▋         | 7/100 [00:13<02:52,  1.85s/it]Best trial: 3. Best value: 0.0422156:   7%|▋         | 7/100 [00:14<02:52,  1.85s/it]Best trial: 3. Best value: 0.0422156:   8%|▊         | 8/100 [00:14<02:46,  1.81s/it]Best trial: 3. Best value: 0.0422156:   8%|▊         | 8/100 [00:16<02:46,  1.81s/it]Best trial: 3. Best value: 0.0422156:   9%|▉         | 9/100 [00:16<02:52,  1.90s/it]Best trial: 3. Best value: 0.0422156:   9%|▉         | 9/100 [00:18<02:52,  1.90s/it]Best trial: 3. Best value: 0.0422156:  10%|█         | 10/100 [00:18<02:43,  1.82s/it]Best trial: 10. Best value: 0.0849799:  10%|█         | 10/100 [00:19<02:43,  1.82s/it]Best trial: 10. Best value: 0.0849799:  11%|█         | 11/100 [00:19<02:29,  1.68s/it]Best trial: 10. Best value: 0.0849799:  11%|█         | 11/100 [00:21<02:29,  1.68s/it]Best trial: 10. Best value: 0.0849799:  12%|█▏        | 12/100 [00:21<02:18,  1.58s/it]Best trial: 12. Best value: 0.105279:  12%|█▏        | 12/100 [00:22<02:18,  1.58s/it] Best trial: 12. Best value: 0.105279:  13%|█▎        | 13/100 [00:22<02:21,  1.63s/it]Best trial: 12. Best value: 0.105279:  13%|█▎        | 13/100 [00:24<02:21,  1.63s/it]Best trial: 12. Best value: 0.105279:  14%|█▍        | 14/100 [00:24<02:30,  1.75s/it]Best trial: 12. Best value: 0.105279:  14%|█▍        | 14/100 [00:26<02:30,  1.75s/it]Best trial: 12. Best value: 0.105279:  15%|█▌        | 15/100 [00:26<02:15,  1.60s/it]Best trial: 12. Best value: 0.105279:  15%|█▌        | 15/100 [00:28<02:15,  1.60s/it]Best trial: 12. Best value: 0.105279:  16%|█▌        | 16/100 [00:28<02:24,  1.72s/it]Best trial: 12. Best value: 0.105279:  16%|█▌        | 16/100 [00:29<02:24,  1.72s/it]Best trial: 12. Best value: 0.105279:  17%|█▋        | 17/100 [00:29<02:08,  1.54s/it]Best trial: 12. Best value: 0.105279:  17%|█▋        | 17/100 [00:30<02:08,  1.54s/it]Best trial: 12. Best value: 0.105279:  18%|█▊        | 18/100 [00:30<02:02,  1.49s/it]Best trial: 12. Best value: 0.105279:  18%|█▊        | 18/100 [00:32<02:02,  1.49s/it]Best trial: 12. Best value: 0.105279:  19%|█▉        | 19/100 [00:32<02:04,  1.53s/it]Best trial: 12. Best value: 0.105279:  19%|█▉        | 19/100 [00:33<02:04,  1.53s/it]Best trial: 12. Best value: 0.105279:  20%|██        | 20/100 [00:33<01:55,  1.44s/it]Best trial: 12. Best value: 0.105279:  20%|██        | 20/100 [00:35<01:55,  1.44s/it]Best trial: 12. Best value: 0.105279:  21%|██        | 21/100 [00:35<02:05,  1.59s/it]Best trial: 12. Best value: 0.105279:  21%|██        | 21/100 [00:36<02:05,  1.59s/it]Best trial: 12. Best value: 0.105279:  22%|██▏       | 22/100 [00:36<01:58,  1.52s/it]Best trial: 12. Best value: 0.105279:  22%|██▏       | 22/100 [00:38<01:58,  1.52s/it]Best trial: 12. Best value: 0.105279:  23%|██▎       | 23/100 [00:38<01:50,  1.44s/it]Best trial: 12. Best value: 0.105279:  23%|██▎       | 23/100 [00:39<01:50,  1.44s/it]Best trial: 12. Best value: 0.105279:  24%|██▍       | 24/100 [00:39<01:43,  1.36s/it]Best trial: 12. Best value: 0.105279:  24%|██▍       | 24/100 [00:40<01:43,  1.36s/it]Best trial: 12. Best value: 0.105279:  25%|██▌       | 25/100 [00:40<01:41,  1.36s/it]Best trial: 12. Best value: 0.105279:  25%|██▌       | 25/100 [00:42<01:41,  1.36s/it]Best trial: 12. Best value: 0.105279:  26%|██▌       | 26/100 [00:42<01:51,  1.51s/it]Best trial: 12. Best value: 0.105279:  26%|██▌       | 26/100 [00:43<01:51,  1.51s/it]Best trial: 12. Best value: 0.105279:  27%|██▋       | 27/100 [00:43<01:46,  1.46s/it]Best trial: 12. Best value: 0.105279:  27%|██▋       | 27/100 [00:45<01:46,  1.46s/it]Best trial: 12. Best value: 0.105279:  28%|██▊       | 28/100 [00:45<01:47,  1.50s/it]Best trial: 12. Best value: 0.105279:  28%|██▊       | 28/100 [00:47<01:47,  1.50s/it]Best trial: 12. Best value: 0.105279:  29%|██▉       | 29/100 [00:47<02:02,  1.72s/it]Best trial: 12. Best value: 0.105279:  29%|██▉       | 29/100 [00:49<02:02,  1.72s/it]Best trial: 12. Best value: 0.105279:  30%|███       | 30/100 [00:49<02:03,  1.77s/it]Best trial: 12. Best value: 0.105279:  30%|███       | 30/100 [00:51<02:03,  1.77s/it]Best trial: 12. Best value: 0.105279:  31%|███       | 31/100 [00:51<01:55,  1.67s/it]Best trial: 12. Best value: 0.105279:  31%|███       | 31/100 [00:52<01:55,  1.67s/it]Best trial: 12. Best value: 0.105279:  32%|███▏      | 32/100 [00:52<01:48,  1.60s/it]Best trial: 12. Best value: 0.105279:  32%|███▏      | 32/100 [00:53<01:48,  1.60s/it]Best trial: 12. Best value: 0.105279:  33%|███▎      | 33/100 [00:53<01:42,  1.53s/it]Best trial: 12. Best value: 0.105279:  33%|███▎      | 33/100 [00:55<01:42,  1.53s/it]Best trial: 12. Best value: 0.105279:  34%|███▍      | 34/100 [00:55<01:36,  1.46s/it]Best trial: 12. Best value: 0.105279:  34%|███▍      | 34/100 [00:56<01:36,  1.46s/it]Best trial: 12. Best value: 0.105279:  35%|███▌      | 35/100 [00:56<01:32,  1.42s/it]Best trial: 12. Best value: 0.105279:  35%|███▌      | 35/100 [00:57<01:32,  1.42s/it]Best trial: 12. Best value: 0.105279:  36%|███▌      | 36/100 [00:57<01:30,  1.42s/it]Best trial: 12. Best value: 0.105279:  36%|███▌      | 36/100 [00:59<01:30,  1.42s/it]Best trial: 12. Best value: 0.105279:  37%|███▋      | 37/100 [00:59<01:35,  1.52s/it]Best trial: 12. Best value: 0.105279:  37%|███▋      | 37/100 [01:01<01:35,  1.52s/it]Best trial: 12. Best value: 0.105279:  38%|███▊      | 38/100 [01:01<01:36,  1.55s/it]Best trial: 12. Best value: 0.105279:  38%|███▊      | 38/100 [01:03<01:36,  1.55s/it]Best trial: 12. Best value: 0.105279:  39%|███▉      | 39/100 [01:03<01:52,  1.85s/it]Best trial: 12. Best value: 0.105279:  39%|███▉      | 39/100 [01:05<01:52,  1.85s/it]Best trial: 12. Best value: 0.105279:  40%|████      | 40/100 [01:05<01:42,  1.71s/it]Best trial: 12. Best value: 0.105279:  40%|████      | 40/100 [01:07<01:42,  1.71s/it]Best trial: 12. Best value: 0.105279:  41%|████      | 41/100 [01:07<01:45,  1.79s/it]Best trial: 12. Best value: 0.105279:  41%|████      | 41/100 [01:08<01:45,  1.79s/it]Best trial: 12. Best value: 0.105279:  42%|████▏     | 42/100 [01:08<01:35,  1.64s/it]Best trial: 12. Best value: 0.105279:  42%|████▏     | 42/100 [01:10<01:35,  1.64s/it]Best trial: 12. Best value: 0.105279:  43%|████▎     | 43/100 [01:10<01:34,  1.66s/it]Best trial: 12. Best value: 0.105279:  43%|████▎     | 43/100 [01:11<01:34,  1.66s/it]Best trial: 12. Best value: 0.105279:  44%|████▍     | 44/100 [01:11<01:28,  1.58s/it]Best trial: 12. Best value: 0.105279:  44%|████▍     | 44/100 [01:12<01:28,  1.58s/it]Best trial: 12. Best value: 0.105279:  45%|████▌     | 45/100 [01:12<01:21,  1.49s/it]Best trial: 12. Best value: 0.105279:  45%|████▌     | 45/100 [01:14<01:21,  1.49s/it]Best trial: 12. Best value: 0.105279:  46%|████▌     | 46/100 [01:14<01:26,  1.61s/it]Best trial: 12. Best value: 0.105279:  46%|████▌     | 46/100 [01:15<01:26,  1.61s/it]Best trial: 12. Best value: 0.105279:  47%|████▋     | 47/100 [01:15<01:18,  1.48s/it]Best trial: 12. Best value: 0.105279:  47%|████▋     | 47/100 [01:17<01:18,  1.48s/it]Best trial: 12. Best value: 0.105279:  48%|████▊     | 48/100 [01:17<01:13,  1.42s/it]Best trial: 12. Best value: 0.105279:  48%|████▊     | 48/100 [01:18<01:13,  1.42s/it]Best trial: 12. Best value: 0.105279:  49%|████▉     | 49/100 [01:18<01:11,  1.40s/it]Best trial: 12. Best value: 0.105279:  49%|████▉     | 49/100 [01:20<01:11,  1.40s/it]Best trial: 12. Best value: 0.105279:  50%|█████     | 50/100 [01:20<01:13,  1.47s/it]Best trial: 12. Best value: 0.105279:  50%|█████     | 50/100 [01:21<01:13,  1.47s/it]Best trial: 12. Best value: 0.105279:  51%|█████     | 51/100 [01:21<01:15,  1.54s/it]Best trial: 12. Best value: 0.105279:  51%|█████     | 51/100 [01:22<01:15,  1.54s/it]Best trial: 12. Best value: 0.105279:  52%|█████▏    | 52/100 [01:22<01:07,  1.42s/it]Best trial: 12. Best value: 0.105279:  52%|█████▏    | 52/100 [01:24<01:07,  1.42s/it]Best trial: 12. Best value: 0.105279:  53%|█████▎    | 53/100 [01:24<01:04,  1.38s/it]Best trial: 12. Best value: 0.105279:  53%|█████▎    | 53/100 [01:25<01:04,  1.38s/it]Best trial: 12. Best value: 0.105279:  54%|█████▍    | 54/100 [01:25<01:05,  1.43s/it]Best trial: 12. Best value: 0.105279:  54%|█████▍    | 54/100 [01:27<01:05,  1.43s/it]Best trial: 12. Best value: 0.105279:  55%|█████▌    | 55/100 [01:27<01:03,  1.42s/it]Best trial: 12. Best value: 0.105279:  55%|█████▌    | 55/100 [01:28<01:03,  1.42s/it]Best trial: 12. Best value: 0.105279:  56%|█████▌    | 56/100 [01:28<00:58,  1.33s/it]Best trial: 12. Best value: 0.105279:  56%|█████▌    | 56/100 [01:29<00:58,  1.33s/it]Best trial: 12. Best value: 0.105279:  57%|█████▋    | 57/100 [01:29<01:00,  1.42s/it]Best trial: 12. Best value: 0.105279:  57%|█████▋    | 57/100 [01:31<01:00,  1.42s/it]Best trial: 12. Best value: 0.105279:  58%|█████▊    | 58/100 [01:31<01:07,  1.61s/it]Best trial: 12. Best value: 0.105279:  58%|█████▊    | 58/100 [01:33<01:07,  1.61s/it]Best trial: 12. Best value: 0.105279:  59%|█████▉    | 59/100 [01:33<01:02,  1.53s/it]Best trial: 12. Best value: 0.105279:  59%|█████▉    | 59/100 [01:34<01:02,  1.53s/it]Best trial: 12. Best value: 0.105279:  60%|██████    | 60/100 [01:34<01:02,  1.55s/it]Best trial: 12. Best value: 0.105279:  60%|██████    | 60/100 [01:36<01:02,  1.55s/it]Best trial: 12. Best value: 0.105279:  61%|██████    | 61/100 [01:36<00:59,  1.52s/it]Best trial: 61. Best value: 0.119089:  61%|██████    | 61/100 [01:37<00:59,  1.52s/it]Best trial: 61. Best value: 0.119089:  62%|██████▏   | 62/100 [01:37<00:53,  1.40s/it]Best trial: 61. Best value: 0.119089:  62%|██████▏   | 62/100 [01:38<00:53,  1.40s/it]Best trial: 61. Best value: 0.119089:  63%|██████▎   | 63/100 [01:38<00:50,  1.37s/it]Best trial: 61. Best value: 0.119089:  63%|██████▎   | 63/100 [01:40<00:50,  1.37s/it]Best trial: 61. Best value: 0.119089:  64%|██████▍   | 64/100 [01:40<00:53,  1.48s/it]Best trial: 61. Best value: 0.119089:  64%|██████▍   | 64/100 [01:41<00:53,  1.48s/it]Best trial: 61. Best value: 0.119089:  65%|██████▌   | 65/100 [01:41<00:49,  1.42s/it]Best trial: 65. Best value: 0.153123:  65%|██████▌   | 65/100 [01:43<00:49,  1.42s/it]Best trial: 65. Best value: 0.153123:  66%|██████▌   | 66/100 [01:43<00:45,  1.35s/it]Best trial: 65. Best value: 0.153123:  66%|██████▌   | 66/100 [01:44<00:45,  1.35s/it]Best trial: 65. Best value: 0.153123:  67%|██████▋   | 67/100 [01:44<00:44,  1.36s/it]Best trial: 65. Best value: 0.153123:  67%|██████▋   | 67/100 [01:46<00:44,  1.36s/it]Best trial: 65. Best value: 0.153123:  68%|██████▊   | 68/100 [01:46<00:46,  1.47s/it]Best trial: 65. Best value: 0.153123:  68%|██████▊   | 68/100 [01:47<00:46,  1.47s/it]Best trial: 65. Best value: 0.153123:  69%|██████▉   | 69/100 [01:47<00:42,  1.38s/it]Best trial: 65. Best value: 0.153123:  69%|██████▉   | 69/100 [01:49<00:42,  1.38s/it]Best trial: 65. Best value: 0.153123:  70%|███████   | 70/100 [01:49<00:47,  1.58s/it]Best trial: 65. Best value: 0.153123:  70%|███████   | 70/100 [01:51<00:47,  1.58s/it]Best trial: 65. Best value: 0.153123:  71%|███████   | 71/100 [01:51<00:48,  1.69s/it]Best trial: 65. Best value: 0.153123:  71%|███████   | 71/100 [01:52<00:48,  1.69s/it]Best trial: 65. Best value: 0.153123:  72%|███████▏  | 72/100 [01:52<00:43,  1.55s/it]Best trial: 65. Best value: 0.153123:  72%|███████▏  | 72/100 [01:53<00:43,  1.55s/it]Best trial: 65. Best value: 0.153123:  73%|███████▎  | 73/100 [01:53<00:40,  1.49s/it]Best trial: 65. Best value: 0.153123:  73%|███████▎  | 73/100 [01:55<00:40,  1.49s/it]Best trial: 65. Best value: 0.153123:  74%|███████▍  | 74/100 [01:55<00:37,  1.46s/it]Best trial: 65. Best value: 0.153123:  74%|███████▍  | 74/100 [01:56<00:37,  1.46s/it]Best trial: 65. Best value: 0.153123:  75%|███████▌  | 75/100 [01:56<00:35,  1.40s/it]Best trial: 75. Best value: 0.175554:  75%|███████▌  | 75/100 [01:57<00:35,  1.40s/it]Best trial: 75. Best value: 0.175554:  76%|███████▌  | 76/100 [01:57<00:32,  1.34s/it]Best trial: 75. Best value: 0.175554:  76%|███████▌  | 76/100 [01:59<00:32,  1.34s/it]Best trial: 75. Best value: 0.175554:  77%|███████▋  | 77/100 [01:59<00:32,  1.41s/it]Best trial: 75. Best value: 0.175554:  77%|███████▋  | 77/100 [02:00<00:32,  1.41s/it]Best trial: 75. Best value: 0.175554:  78%|███████▊  | 78/100 [02:00<00:30,  1.37s/it]Best trial: 75. Best value: 0.175554:  78%|███████▊  | 78/100 [02:01<00:30,  1.37s/it]Best trial: 75. Best value: 0.175554:  79%|███████▉  | 79/100 [02:01<00:27,  1.31s/it]Best trial: 75. Best value: 0.175554:  79%|███████▉  | 79/100 [02:03<00:27,  1.31s/it]Best trial: 75. Best value: 0.175554:  80%|████████  | 80/100 [02:03<00:26,  1.33s/it]Best trial: 75. Best value: 0.175554:  80%|████████  | 80/100 [02:04<00:26,  1.33s/it]Best trial: 75. Best value: 0.175554:  81%|████████  | 81/100 [02:04<00:28,  1.47s/it]Best trial: 75. Best value: 0.175554:  81%|████████  | 81/100 [02:06<00:28,  1.47s/it]Best trial: 75. Best value: 0.175554:  82%|████████▏ | 82/100 [02:06<00:27,  1.52s/it]Best trial: 75. Best value: 0.175554:  82%|████████▏ | 82/100 [02:08<00:27,  1.52s/it]Best trial: 75. Best value: 0.175554:  83%|████████▎ | 83/100 [02:08<00:25,  1.51s/it]Best trial: 75. Best value: 0.175554:  83%|████████▎ | 83/100 [02:09<00:25,  1.51s/it]Best trial: 75. Best value: 0.175554:  84%|████████▍ | 84/100 [02:09<00:23,  1.44s/it]Best trial: 75. Best value: 0.175554:  84%|████████▍ | 84/100 [02:10<00:23,  1.44s/it]Best trial: 75. Best value: 0.175554:  85%|████████▌ | 85/100 [02:10<00:21,  1.43s/it]Best trial: 75. Best value: 0.175554:  85%|████████▌ | 85/100 [02:12<00:21,  1.43s/it]Best trial: 75. Best value: 0.175554:  86%|████████▌ | 86/100 [02:12<00:20,  1.49s/it]Best trial: 75. Best value: 0.175554:  86%|████████▌ | 86/100 [02:13<00:20,  1.49s/it]Best trial: 75. Best value: 0.175554:  87%|████████▋ | 87/100 [02:13<00:18,  1.40s/it]Best trial: 75. Best value: 0.175554:  87%|████████▋ | 87/100 [02:14<00:18,  1.40s/it]Best trial: 75. Best value: 0.175554:  88%|████████▊ | 88/100 [02:14<00:16,  1.41s/it]Best trial: 75. Best value: 0.175554:  88%|████████▊ | 88/100 [02:16<00:16,  1.41s/it]Best trial: 75. Best value: 0.175554:  89%|████████▉ | 89/100 [02:16<00:15,  1.44s/it]Best trial: 75. Best value: 0.175554:  89%|████████▉ | 89/100 [02:18<00:15,  1.44s/it]Best trial: 75. Best value: 0.175554:  90%|█████████ | 90/100 [02:18<00:14,  1.50s/it]Best trial: 75. Best value: 0.175554:  90%|█████████ | 90/100 [02:19<00:14,  1.50s/it]Best trial: 75. Best value: 0.175554:  91%|█████████ | 91/100 [02:19<00:12,  1.39s/it]Best trial: 75. Best value: 0.175554:  91%|█████████ | 91/100 [02:20<00:12,  1.39s/it]Best trial: 75. Best value: 0.175554:  92%|█████████▏| 92/100 [02:20<00:10,  1.31s/it]Best trial: 75. Best value: 0.175554:  92%|█████████▏| 92/100 [02:21<00:10,  1.31s/it]Best trial: 75. Best value: 0.175554:  93%|█████████▎| 93/100 [02:21<00:08,  1.26s/it]Best trial: 75. Best value: 0.175554:  93%|█████████▎| 93/100 [02:22<00:08,  1.26s/it]Best trial: 75. Best value: 0.175554:  94%|█████████▍| 94/100 [02:22<00:07,  1.24s/it]Best trial: 75. Best value: 0.175554:  94%|█████████▍| 94/100 [02:23<00:07,  1.24s/it]Best trial: 75. Best value: 0.175554:  95%|█████████▌| 95/100 [02:23<00:06,  1.21s/it]Best trial: 75. Best value: 0.175554:  95%|█████████▌| 95/100 [02:25<00:06,  1.21s/it]Best trial: 75. Best value: 0.175554:  96%|█████████▌| 96/100 [02:25<00:05,  1.49s/it]Best trial: 75. Best value: 0.175554:  96%|█████████▌| 96/100 [02:27<00:05,  1.49s/it]Best trial: 75. Best value: 0.175554:  97%|█████████▋| 97/100 [02:27<00:04,  1.39s/it]Best trial: 75. Best value: 0.175554:  97%|█████████▋| 97/100 [02:28<00:04,  1.39s/it]Best trial: 75. Best value: 0.175554:  98%|█████████▊| 98/100 [02:28<00:02,  1.37s/it]Best trial: 75. Best value: 0.175554:  98%|█████████▊| 98/100 [02:29<00:02,  1.37s/it]Best trial: 75. Best value: 0.175554:  99%|█████████▉| 99/100 [02:29<00:01,  1.32s/it]Best trial: 75. Best value: 0.175554:  99%|█████████▉| 99/100 [02:30<00:01,  1.32s/it]Best trial: 75. Best value: 0.175554: 100%|██████████| 100/100 [02:30<00:00,  1.27s/it]Best trial: 75. Best value: 0.175554: 100%|██████████| 100/100 [02:30<00:00,  1.51s/it]
2025-11-30 15:46:00,859 - INFO - HPO Complete. Best AUPRC: 0.1756
2025-11-30 15:46:00,859 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0007158849788817112, 'max_depth': 3, 'subsample': 0.8071194836743382, 'colsample_bytree': 0.931925547971307, 'gamma': 1.2006946916278798, 'reg_lambda': 1.6035477666263492e-05, 'reg_alpha': 0.10497840673955712}
2025-11-30 15:46:00,860 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:46:02,873 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: awp_only
2025-11-30 15:46:02,873 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:46:03,064 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:46:03,086 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:46:03,090 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 15:46:03,090 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:46:03,090 - INFO - Training model...
2025-11-30 15:46:05,204 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:46:10,224 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:46:10,224 - INFO - AUROC: 0.4198 (0.0900 - 0.8105)
2025-11-30 15:46:10,224 - INFO - AUPRC: 0.0137 (0.0035 - 0.0517)
2025-11-30 15:46:10,224 - INFO - Brier Score: 0.1259 (0.1223 - 0.1292)
2025-11-30 15:46:10,224 - INFO - Accuracy: 0.9451 (0.0104 - 0.9627)
2025-11-30 15:46:10,224 - INFO - Precision: 0.0294 (0.0044 - 0.0900)
2025-11-30 15:46:10,224 - INFO - Sensitivity (Recall): 0.1667 (0.1357 - 1.0000)
2025-11-30 15:46:10,224 - INFO - F1-Score: 0.0500 (0.0087 - 0.1436)
2025-11-30 15:46:10,224 - INFO - Best Threshold: 0.4600 (0.2600 - 0.4600)
2025-11-30 15:46:10,224 - INFO - Specificity: 0.9519 (0.0061 - 0.9682)
2025-11-30 15:46:10,240 - INFO - Calculating SHAP values...
2025-11-30 15:46:11,401 - INFO - SHAP plots saved.
2025-11-30 15:46:11,403 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:46:12,648 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: all_waveforms
2025-11-30 15:46:12,648 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:46:12,847 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:46:12,925 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:46:12,940 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 15:46:12,940 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0292556:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.0292556:   1%|          | 1/100 [00:05<09:08,  5.54s/it]Best trial: 1. Best value: 0.0498167:   1%|          | 1/100 [00:12<09:08,  5.54s/it]Best trial: 1. Best value: 0.0498167:   2%|▏         | 2/100 [00:12<10:52,  6.66s/it]Best trial: 2. Best value: 0.0566376:   2%|▏         | 2/100 [00:17<10:52,  6.66s/it]Best trial: 2. Best value: 0.0566376:   3%|▎         | 3/100 [00:17<09:08,  5.65s/it]Best trial: 3. Best value: 0.0609959:   3%|▎         | 3/100 [00:23<09:08,  5.65s/it]Best trial: 3. Best value: 0.0609959:   4%|▍         | 4/100 [00:23<09:01,  5.64s/it]Best trial: 3. Best value: 0.0609959:   4%|▍         | 4/100 [00:26<09:01,  5.64s/it]Best trial: 3. Best value: 0.0609959:   5%|▌         | 5/100 [00:26<07:52,  4.98s/it]Best trial: 3. Best value: 0.0609959:   5%|▌         | 5/100 [00:30<07:52,  4.98s/it]Best trial: 3. Best value: 0.0609959:   6%|▌         | 6/100 [00:30<07:13,  4.61s/it]Best trial: 6. Best value: 0.0619222:   6%|▌         | 6/100 [00:37<07:13,  4.61s/it]Best trial: 6. Best value: 0.0619222:   7%|▋         | 7/100 [00:37<08:22,  5.40s/it]Best trial: 7. Best value: 0.0635564:   7%|▋         | 7/100 [00:42<08:22,  5.40s/it]Best trial: 7. Best value: 0.0635564:   8%|▊         | 8/100 [00:42<08:07,  5.29s/it]Best trial: 7. Best value: 0.0635564:   8%|▊         | 8/100 [00:50<08:07,  5.29s/it]Best trial: 7. Best value: 0.0635564:   9%|▉         | 9/100 [00:50<08:57,  5.90s/it]Best trial: 9. Best value: 0.109197:   9%|▉         | 9/100 [00:56<08:57,  5.90s/it] Best trial: 9. Best value: 0.109197:  10%|█         | 10/100 [00:56<09:05,  6.06s/it]Best trial: 9. Best value: 0.109197:  10%|█         | 10/100 [01:04<09:05,  6.06s/it]Best trial: 9. Best value: 0.109197:  11%|█         | 11/100 [01:04<09:41,  6.54s/it]Best trial: 9. Best value: 0.109197:  11%|█         | 11/100 [01:11<09:41,  6.54s/it]Best trial: 9. Best value: 0.109197:  12%|█▏        | 12/100 [01:11<09:51,  6.72s/it]Best trial: 9. Best value: 0.109197:  12%|█▏        | 12/100 [01:18<09:51,  6.72s/it]Best trial: 9. Best value: 0.109197:  13%|█▎        | 13/100 [01:18<10:09,  7.00s/it]Best trial: 13. Best value: 0.114281:  13%|█▎        | 13/100 [01:25<10:09,  7.00s/it]Best trial: 13. Best value: 0.114281:  14%|█▍        | 14/100 [01:25<09:56,  6.93s/it]Best trial: 13. Best value: 0.114281:  14%|█▍        | 14/100 [01:31<09:56,  6.93s/it]Best trial: 13. Best value: 0.114281:  15%|█▌        | 15/100 [01:31<09:12,  6.50s/it]Best trial: 13. Best value: 0.114281:  15%|█▌        | 15/100 [01:36<09:12,  6.50s/it]Best trial: 13. Best value: 0.114281:  16%|█▌        | 16/100 [01:36<08:36,  6.15s/it]Best trial: 16. Best value: 0.131697:  16%|█▌        | 16/100 [01:42<08:36,  6.15s/it]Best trial: 16. Best value: 0.131697:  17%|█▋        | 17/100 [01:42<08:28,  6.13s/it]Best trial: 16. Best value: 0.131697:  17%|█▋        | 17/100 [01:48<08:28,  6.13s/it]Best trial: 16. Best value: 0.131697:  18%|█▊        | 18/100 [01:48<08:11,  6.00s/it]Best trial: 16. Best value: 0.131697:  18%|█▊        | 18/100 [01:53<08:11,  6.00s/it]Best trial: 16. Best value: 0.131697:  19%|█▉        | 19/100 [01:53<07:38,  5.66s/it]Best trial: 16. Best value: 0.131697:  19%|█▉        | 19/100 [02:00<07:38,  5.66s/it]Best trial: 16. Best value: 0.131697:  20%|██        | 20/100 [02:00<08:18,  6.24s/it]Best trial: 20. Best value: 0.139298:  20%|██        | 20/100 [02:06<08:18,  6.24s/it]Best trial: 20. Best value: 0.139298:  21%|██        | 21/100 [02:06<07:55,  6.02s/it]Best trial: 20. Best value: 0.139298:  21%|██        | 21/100 [02:11<07:55,  6.02s/it]Best trial: 20. Best value: 0.139298:  22%|██▏       | 22/100 [02:11<07:33,  5.82s/it]Best trial: 20. Best value: 0.139298:  22%|██▏       | 22/100 [02:17<07:33,  5.82s/it]Best trial: 20. Best value: 0.139298:  23%|██▎       | 23/100 [02:17<07:19,  5.71s/it]Best trial: 23. Best value: 0.147529:  23%|██▎       | 23/100 [02:21<07:19,  5.71s/it]Best trial: 23. Best value: 0.147529:  24%|██▍       | 24/100 [02:21<06:41,  5.28s/it]Best trial: 24. Best value: 0.173572:  24%|██▍       | 24/100 [02:26<06:41,  5.28s/it]Best trial: 24. Best value: 0.173572:  25%|██▌       | 25/100 [02:26<06:21,  5.09s/it]Best trial: 25. Best value: 0.184099:  25%|██▌       | 25/100 [02:31<06:21,  5.09s/it]Best trial: 25. Best value: 0.184099:  26%|██▌       | 26/100 [02:31<06:23,  5.18s/it]Best trial: 25. Best value: 0.184099:  26%|██▌       | 26/100 [02:35<06:23,  5.18s/it]Best trial: 25. Best value: 0.184099:  27%|██▋       | 27/100 [02:35<05:46,  4.74s/it]Best trial: 25. Best value: 0.184099:  27%|██▋       | 27/100 [02:40<05:46,  4.74s/it]Best trial: 25. Best value: 0.184099:  28%|██▊       | 28/100 [02:40<06:04,  5.06s/it]Best trial: 25. Best value: 0.184099:  28%|██▊       | 28/100 [02:44<06:04,  5.06s/it]Best trial: 25. Best value: 0.184099:  29%|██▉       | 29/100 [02:44<05:27,  4.61s/it]Best trial: 25. Best value: 0.184099:  29%|██▉       | 29/100 [02:49<05:27,  4.61s/it]Best trial: 25. Best value: 0.184099:  30%|███       | 30/100 [02:49<05:35,  4.80s/it]Best trial: 25. Best value: 0.184099:  30%|███       | 30/100 [02:53<05:35,  4.80s/it]Best trial: 25. Best value: 0.184099:  31%|███       | 31/100 [02:53<05:19,  4.63s/it]Best trial: 25. Best value: 0.184099:  31%|███       | 31/100 [02:59<05:19,  4.63s/it]Best trial: 25. Best value: 0.184099:  32%|███▏      | 32/100 [02:59<05:25,  4.78s/it]Best trial: 25. Best value: 0.184099:  32%|███▏      | 32/100 [03:02<05:25,  4.78s/it]Best trial: 25. Best value: 0.184099:  33%|███▎      | 33/100 [03:02<04:59,  4.46s/it]Best trial: 25. Best value: 0.184099:  33%|███▎      | 33/100 [03:06<04:59,  4.46s/it]Best trial: 25. Best value: 0.184099:  34%|███▍      | 34/100 [03:06<04:41,  4.27s/it]Best trial: 25. Best value: 0.184099:  34%|███▍      | 34/100 [03:10<04:41,  4.27s/it]Best trial: 25. Best value: 0.184099:  35%|███▌      | 35/100 [03:10<04:38,  4.28s/it]Best trial: 25. Best value: 0.184099:  35%|███▌      | 35/100 [03:14<04:38,  4.28s/it]Best trial: 25. Best value: 0.184099:  36%|███▌      | 36/100 [03:14<04:26,  4.16s/it]Best trial: 25. Best value: 0.184099:  36%|███▌      | 36/100 [03:18<04:26,  4.16s/it]Best trial: 25. Best value: 0.184099:  37%|███▋      | 37/100 [03:18<04:11,  3.99s/it]Best trial: 25. Best value: 0.184099:  37%|███▋      | 37/100 [03:23<04:11,  3.99s/it]Best trial: 25. Best value: 0.184099:  38%|███▊      | 38/100 [03:23<04:36,  4.46s/it]Best trial: 25. Best value: 0.184099:  38%|███▊      | 38/100 [03:28<04:36,  4.46s/it]Best trial: 25. Best value: 0.184099:  39%|███▉      | 39/100 [03:28<04:29,  4.41s/it]Best trial: 25. Best value: 0.184099:  39%|███▉      | 39/100 [03:32<04:29,  4.41s/it]Best trial: 25. Best value: 0.184099:  40%|████      | 40/100 [03:32<04:20,  4.34s/it]Best trial: 25. Best value: 0.184099:  40%|████      | 40/100 [03:37<04:20,  4.34s/it]Best trial: 25. Best value: 0.184099:  41%|████      | 41/100 [03:37<04:20,  4.42s/it]Best trial: 25. Best value: 0.184099:  41%|████      | 41/100 [03:41<04:20,  4.42s/it]Best trial: 25. Best value: 0.184099:  42%|████▏     | 42/100 [03:41<04:12,  4.36s/it]Best trial: 25. Best value: 0.184099:  42%|████▏     | 42/100 [03:44<04:12,  4.36s/it]Best trial: 25. Best value: 0.184099:  43%|████▎     | 43/100 [03:44<03:49,  4.02s/it]Best trial: 25. Best value: 0.184099:  43%|████▎     | 43/100 [03:49<03:49,  4.02s/it]Best trial: 25. Best value: 0.184099:  44%|████▍     | 44/100 [03:49<03:57,  4.25s/it]Best trial: 25. Best value: 0.184099:  44%|████▍     | 44/100 [03:53<03:57,  4.25s/it]Best trial: 25. Best value: 0.184099:  45%|████▌     | 45/100 [03:53<03:55,  4.29s/it]Best trial: 25. Best value: 0.184099:  45%|████▌     | 45/100 [03:58<03:55,  4.29s/it]Best trial: 25. Best value: 0.184099:  46%|████▌     | 46/100 [03:58<04:01,  4.48s/it]Best trial: 25. Best value: 0.184099:  46%|████▌     | 46/100 [04:03<04:01,  4.48s/it]Best trial: 25. Best value: 0.184099:  47%|████▋     | 47/100 [04:03<04:02,  4.58s/it]Best trial: 25. Best value: 0.184099:  47%|████▋     | 47/100 [04:07<04:02,  4.58s/it]Best trial: 25. Best value: 0.184099:  48%|████▊     | 48/100 [04:07<03:52,  4.48s/it]Best trial: 25. Best value: 0.184099:  48%|████▊     | 48/100 [04:11<03:52,  4.48s/it]Best trial: 25. Best value: 0.184099:  49%|████▉     | 49/100 [04:11<03:38,  4.28s/it]Best trial: 49. Best value: 0.188587:  49%|████▉     | 49/100 [04:15<03:38,  4.28s/it]Best trial: 49. Best value: 0.188587:  50%|█████     | 50/100 [04:15<03:29,  4.20s/it]Best trial: 49. Best value: 0.188587:  50%|█████     | 50/100 [04:18<03:29,  4.20s/it]Best trial: 49. Best value: 0.188587:  51%|█████     | 51/100 [04:18<03:15,  3.99s/it]Best trial: 49. Best value: 0.188587:  51%|█████     | 51/100 [04:22<03:15,  3.99s/it]Best trial: 49. Best value: 0.188587:  52%|█████▏    | 52/100 [04:22<03:08,  3.93s/it]Best trial: 49. Best value: 0.188587:  52%|█████▏    | 52/100 [04:27<03:08,  3.93s/it]Best trial: 49. Best value: 0.188587:  53%|█████▎    | 53/100 [04:27<03:09,  4.04s/it]Best trial: 49. Best value: 0.188587:  53%|█████▎    | 53/100 [04:30<03:09,  4.04s/it]Best trial: 49. Best value: 0.188587:  54%|█████▍    | 54/100 [04:30<03:02,  3.98s/it]Best trial: 49. Best value: 0.188587:  54%|█████▍    | 54/100 [04:35<03:02,  3.98s/it]Best trial: 49. Best value: 0.188587:  55%|█████▌    | 55/100 [04:35<03:11,  4.25s/it]Best trial: 49. Best value: 0.188587:  55%|█████▌    | 55/100 [04:39<03:11,  4.25s/it]Best trial: 49. Best value: 0.188587:  56%|█████▌    | 56/100 [04:39<03:06,  4.23s/it]Best trial: 49. Best value: 0.188587:  56%|█████▌    | 56/100 [04:44<03:06,  4.23s/it]Best trial: 49. Best value: 0.188587:  57%|█████▋    | 57/100 [04:44<03:06,  4.34s/it]Best trial: 49. Best value: 0.188587:  57%|█████▋    | 57/100 [04:49<03:06,  4.34s/it]Best trial: 49. Best value: 0.188587:  58%|█████▊    | 58/100 [04:49<03:10,  4.54s/it]Best trial: 49. Best value: 0.188587:  58%|█████▊    | 58/100 [04:55<03:10,  4.54s/it]Best trial: 49. Best value: 0.188587:  59%|█████▉    | 59/100 [04:55<03:24,  4.99s/it]Best trial: 49. Best value: 0.188587:  59%|█████▉    | 59/100 [04:59<03:24,  4.99s/it]Best trial: 49. Best value: 0.188587:  60%|██████    | 60/100 [04:59<03:09,  4.73s/it]Best trial: 49. Best value: 0.188587:  60%|██████    | 60/100 [05:07<03:09,  4.73s/it]Best trial: 49. Best value: 0.188587:  61%|██████    | 61/100 [05:07<03:39,  5.63s/it]Best trial: 49. Best value: 0.188587:  61%|██████    | 61/100 [05:11<03:39,  5.63s/it]Best trial: 49. Best value: 0.188587:  62%|██████▏   | 62/100 [05:11<03:21,  5.30s/it]Best trial: 49. Best value: 0.188587:  62%|██████▏   | 62/100 [05:16<03:21,  5.30s/it]Best trial: 49. Best value: 0.188587:  63%|██████▎   | 63/100 [05:16<03:07,  5.08s/it]Best trial: 49. Best value: 0.188587:  63%|██████▎   | 63/100 [05:21<03:07,  5.08s/it]Best trial: 49. Best value: 0.188587:  64%|██████▍   | 64/100 [05:21<03:05,  5.15s/it]Best trial: 49. Best value: 0.188587:  64%|██████▍   | 64/100 [05:27<03:05,  5.15s/it]Best trial: 49. Best value: 0.188587:  65%|██████▌   | 65/100 [05:27<03:00,  5.17s/it]Best trial: 49. Best value: 0.188587:  65%|██████▌   | 65/100 [05:32<03:00,  5.17s/it]Best trial: 49. Best value: 0.188587:  66%|██████▌   | 66/100 [05:32<02:58,  5.26s/it]Best trial: 49. Best value: 0.188587:  66%|██████▌   | 66/100 [05:38<02:58,  5.26s/it]Best trial: 49. Best value: 0.188587:  67%|██████▋   | 67/100 [05:38<03:00,  5.47s/it]Best trial: 49. Best value: 0.188587:  67%|██████▋   | 67/100 [05:45<03:00,  5.47s/it]Best trial: 49. Best value: 0.188587:  68%|██████▊   | 68/100 [05:45<03:07,  5.85s/it]Best trial: 49. Best value: 0.188587:  68%|██████▊   | 68/100 [05:50<03:07,  5.85s/it]Best trial: 49. Best value: 0.188587:  69%|██████▉   | 69/100 [05:50<02:52,  5.55s/it]Best trial: 49. Best value: 0.188587:  69%|██████▉   | 69/100 [05:54<02:52,  5.55s/it]Best trial: 49. Best value: 0.188587:  70%|███████   | 70/100 [05:54<02:32,  5.08s/it]Best trial: 49. Best value: 0.188587:  70%|███████   | 70/100 [06:00<02:32,  5.08s/it]Best trial: 49. Best value: 0.188587:  71%|███████   | 71/100 [06:00<02:34,  5.34s/it]Best trial: 49. Best value: 0.188587:  71%|███████   | 71/100 [06:04<02:34,  5.34s/it]Best trial: 49. Best value: 0.188587:  72%|███████▏  | 72/100 [06:04<02:19,  4.98s/it]Best trial: 49. Best value: 0.188587:  72%|███████▏  | 72/100 [06:08<02:19,  4.98s/it]Best trial: 49. Best value: 0.188587:  73%|███████▎  | 73/100 [06:08<02:08,  4.77s/it]Best trial: 73. Best value: 0.194189:  73%|███████▎  | 73/100 [06:13<02:08,  4.77s/it]Best trial: 73. Best value: 0.194189:  74%|███████▍  | 74/100 [06:13<02:04,  4.80s/it]Best trial: 73. Best value: 0.194189:  74%|███████▍  | 74/100 [06:18<02:04,  4.80s/it]Best trial: 73. Best value: 0.194189:  75%|███████▌  | 75/100 [06:18<02:01,  4.85s/it]Best trial: 73. Best value: 0.194189:  75%|███████▌  | 75/100 [06:24<02:01,  4.85s/it]Best trial: 73. Best value: 0.194189:  76%|███████▌  | 76/100 [06:24<02:08,  5.36s/it]Best trial: 73. Best value: 0.194189:  76%|███████▌  | 76/100 [06:29<02:08,  5.36s/it]Best trial: 73. Best value: 0.194189:  77%|███████▋  | 77/100 [06:29<02:00,  5.22s/it]Best trial: 73. Best value: 0.194189:  77%|███████▋  | 77/100 [06:34<02:00,  5.22s/it]Best trial: 73. Best value: 0.194189:  78%|███████▊  | 78/100 [06:34<01:49,  5.00s/it]Best trial: 73. Best value: 0.194189:  78%|███████▊  | 78/100 [06:38<01:49,  5.00s/it]Best trial: 73. Best value: 0.194189:  79%|███████▉  | 79/100 [06:38<01:41,  4.85s/it]Best trial: 73. Best value: 0.194189:  79%|███████▉  | 79/100 [06:43<01:41,  4.85s/it]Best trial: 73. Best value: 0.194189:  80%|████████  | 80/100 [06:43<01:36,  4.85s/it]Best trial: 73. Best value: 0.194189:  80%|████████  | 80/100 [06:48<01:36,  4.85s/it]Best trial: 73. Best value: 0.194189:  81%|████████  | 81/100 [06:48<01:33,  4.93s/it]Best trial: 81. Best value: 0.207272:  81%|████████  | 81/100 [06:53<01:33,  4.93s/it]Best trial: 81. Best value: 0.207272:  82%|████████▏ | 82/100 [06:53<01:27,  4.85s/it]Best trial: 81. Best value: 0.207272:  82%|████████▏ | 82/100 [06:59<01:27,  4.85s/it]Best trial: 81. Best value: 0.207272:  83%|████████▎ | 83/100 [06:59<01:29,  5.24s/it]Best trial: 81. Best value: 0.207272:  83%|████████▎ | 83/100 [07:04<01:29,  5.24s/it]Best trial: 81. Best value: 0.207272:  84%|████████▍ | 84/100 [07:04<01:21,  5.06s/it]Best trial: 81. Best value: 0.207272:  84%|████████▍ | 84/100 [07:09<01:21,  5.06s/it]Best trial: 81. Best value: 0.207272:  85%|████████▌ | 85/100 [07:09<01:16,  5.07s/it]Best trial: 81. Best value: 0.207272:  85%|████████▌ | 85/100 [07:14<01:16,  5.07s/it]Best trial: 81. Best value: 0.207272:  86%|████████▌ | 86/100 [07:14<01:12,  5.19s/it]Best trial: 81. Best value: 0.207272:  86%|████████▌ | 86/100 [07:19<01:12,  5.19s/it]Best trial: 81. Best value: 0.207272:  87%|████████▋ | 87/100 [07:19<01:06,  5.12s/it]Best trial: 81. Best value: 0.207272:  87%|████████▋ | 87/100 [07:24<01:06,  5.12s/it]Best trial: 81. Best value: 0.207272:  88%|████████▊ | 88/100 [07:24<01:00,  5.06s/it]Best trial: 81. Best value: 0.207272:  88%|████████▊ | 88/100 [07:30<01:00,  5.06s/it]Best trial: 81. Best value: 0.207272:  89%|████████▉ | 89/100 [07:30<00:57,  5.19s/it]Best trial: 81. Best value: 0.207272:  89%|████████▉ | 89/100 [07:35<00:57,  5.19s/it]Best trial: 81. Best value: 0.207272:  90%|█████████ | 90/100 [07:35<00:51,  5.20s/it]Best trial: 81. Best value: 0.207272:  90%|█████████ | 90/100 [07:40<00:51,  5.20s/it]Best trial: 81. Best value: 0.207272:  91%|█████████ | 91/100 [07:40<00:46,  5.18s/it]Best trial: 81. Best value: 0.207272:  91%|█████████ | 91/100 [07:44<00:46,  5.18s/it]Best trial: 81. Best value: 0.207272:  92%|█████████▏| 92/100 [07:44<00:39,  5.00s/it]Best trial: 81. Best value: 0.207272:  92%|█████████▏| 92/100 [07:49<00:39,  5.00s/it]Best trial: 81. Best value: 0.207272:  93%|█████████▎| 93/100 [07:49<00:33,  4.83s/it]Best trial: 81. Best value: 0.207272:  93%|█████████▎| 93/100 [07:54<00:33,  4.83s/it]Best trial: 81. Best value: 0.207272:  94%|█████████▍| 94/100 [07:54<00:29,  4.98s/it]Best trial: 81. Best value: 0.207272:  94%|█████████▍| 94/100 [07:59<00:29,  4.98s/it]Best trial: 81. Best value: 0.207272:  95%|█████████▌| 95/100 [07:59<00:24,  4.84s/it]Best trial: 81. Best value: 0.207272:  95%|█████████▌| 95/100 [08:03<00:24,  4.84s/it]Best trial: 81. Best value: 0.207272:  96%|█████████▌| 96/100 [08:03<00:18,  4.73s/it]Best trial: 96. Best value: 0.239635:  96%|█████████▌| 96/100 [08:07<00:18,  4.73s/it]Best trial: 96. Best value: 0.239635:  97%|█████████▋| 97/100 [08:07<00:13,  4.51s/it]Best trial: 96. Best value: 0.239635:  97%|█████████▋| 97/100 [08:12<00:13,  4.51s/it]Best trial: 96. Best value: 0.239635:  98%|█████████▊| 98/100 [08:12<00:08,  4.44s/it]Best trial: 96. Best value: 0.239635:  98%|█████████▊| 98/100 [08:15<00:08,  4.44s/it]Best trial: 96. Best value: 0.239635:  99%|█████████▉| 99/100 [08:15<00:04,  4.17s/it]Best trial: 96. Best value: 0.239635:  99%|█████████▉| 99/100 [08:20<00:04,  4.17s/it]Best trial: 96. Best value: 0.239635: 100%|██████████| 100/100 [08:20<00:00,  4.28s/it]Best trial: 96. Best value: 0.239635: 100%|██████████| 100/100 [08:20<00:00,  5.00s/it]
2025-11-30 15:54:33,035 - INFO - HPO Complete. Best AUPRC: 0.2396
2025-11-30 15:54:33,035 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0497776552405134, 'max_depth': 3, 'subsample': 0.6313579120327216, 'colsample_bytree': 0.730660349859271, 'gamma': 3.811610790406019, 'reg_lambda': 1.2811086421543614e-05, 'reg_alpha': 0.09037629034209235}
2025-11-30 15:54:33,036 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 15:54:34,865 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: all_waveforms
2025-11-30 15:54:34,865 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:54:35,073 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:54:35,141 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:54:35,154 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 15:54:35,154 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 15:54:35,154 - INFO - Training model...
2025-11-30 15:54:37,964 - INFO - Evaluating model with bootstrapping...
2025-11-30 15:54:44,236 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 15:54:44,237 - INFO - AUROC: 0.5192 (0.1067 - 0.8098)
2025-11-30 15:54:44,237 - INFO - AUPRC: 0.0115 (0.0039 - 0.0286)
2025-11-30 15:54:44,237 - INFO - Brier Score: 0.0090 (0.0040 - 0.0160)
2025-11-30 15:54:44,237 - INFO - Accuracy: 0.9017 (0.8780 - 0.9130)
2025-11-30 15:54:44,237 - INFO - Precision: 0.0000 (0.0000 - 0.0000)
2025-11-30 15:54:44,237 - INFO - Sensitivity (Recall): 0.0000 (0.0000 - 0.0000)
2025-11-30 15:54:44,237 - INFO - F1-Score: 0.0000 (0.0000 - 0.0000)
2025-11-30 15:54:44,237 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0100)
2025-11-30 15:54:44,237 - INFO - Specificity: 0.9096 (0.8865 - 0.9194)
2025-11-30 15:54:44,245 - INFO - Calculating SHAP values...
2025-11-30 15:54:45,300 - INFO - SHAP plots saved.
2025-11-30 15:54:45,301 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 15:54:46,546 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 15:54:46,546 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 15:54:46,773 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 15:54:46,864 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 15:54:46,888 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 15:54:46,889 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.157669:   0%|          | 0/100 [00:09<?, ?it/s]Best trial: 0. Best value: 0.157669:   1%|          | 1/100 [00:09<16:26,  9.96s/it]Best trial: 0. Best value: 0.157669:   1%|          | 1/100 [00:16<16:26,  9.96s/it]Best trial: 0. Best value: 0.157669:   2%|▏         | 2/100 [00:16<13:00,  7.97s/it]Best trial: 0. Best value: 0.157669:   2%|▏         | 2/100 [00:23<13:00,  7.97s/it]Best trial: 0. Best value: 0.157669:   3%|▎         | 3/100 [00:23<12:24,  7.68s/it]Best trial: 3. Best value: 0.190071:   3%|▎         | 3/100 [00:28<12:24,  7.68s/it]Best trial: 3. Best value: 0.190071:   4%|▍         | 4/100 [00:28<10:38,  6.65s/it]Best trial: 3. Best value: 0.190071:   4%|▍         | 4/100 [00:37<10:38,  6.65s/it]Best trial: 3. Best value: 0.190071:   5%|▌         | 5/100 [00:37<11:22,  7.19s/it]Best trial: 3. Best value: 0.190071:   5%|▌         | 5/100 [00:41<11:22,  7.19s/it]Best trial: 3. Best value: 0.190071:   6%|▌         | 6/100 [00:41<09:53,  6.31s/it]Best trial: 3. Best value: 0.190071:   6%|▌         | 6/100 [00:48<09:53,  6.31s/it]Best trial: 3. Best value: 0.190071:   7%|▋         | 7/100 [00:48<10:09,  6.56s/it]Best trial: 3. Best value: 0.190071:   7%|▋         | 7/100 [00:56<10:09,  6.56s/it]Best trial: 3. Best value: 0.190071:   8%|▊         | 8/100 [00:56<10:49,  7.06s/it]Best trial: 3. Best value: 0.190071:   8%|▊         | 8/100 [01:03<10:49,  7.06s/it]Best trial: 3. Best value: 0.190071:   9%|▉         | 9/100 [01:03<10:28,  6.91s/it]Best trial: 3. Best value: 0.190071:   9%|▉         | 9/100 [01:10<10:28,  6.91s/it]Best trial: 3. Best value: 0.190071:  10%|█         | 10/100 [01:10<10:38,  7.09s/it]Best trial: 3. Best value: 0.190071:  10%|█         | 10/100 [01:16<10:38,  7.09s/it]Best trial: 3. Best value: 0.190071:  11%|█         | 11/100 [01:16<09:39,  6.51s/it]Best trial: 3. Best value: 0.190071:  11%|█         | 11/100 [01:23<09:39,  6.51s/it]Best trial: 3. Best value: 0.190071:  12%|█▏        | 12/100 [01:23<09:45,  6.65s/it]Best trial: 3. Best value: 0.190071:  12%|█▏        | 12/100 [01:28<09:45,  6.65s/it]Best trial: 3. Best value: 0.190071:  13%|█▎        | 13/100 [01:28<09:01,  6.23s/it]Best trial: 13. Best value: 0.22983:  13%|█▎        | 13/100 [01:32<09:01,  6.23s/it]Best trial: 13. Best value: 0.22983:  14%|█▍        | 14/100 [01:32<08:07,  5.67s/it]Best trial: 13. Best value: 0.22983:  14%|█▍        | 14/100 [01:37<08:07,  5.67s/it]Best trial: 13. Best value: 0.22983:  15%|█▌        | 15/100 [01:37<07:36,  5.37s/it]Best trial: 13. Best value: 0.22983:  15%|█▌        | 15/100 [01:41<07:36,  5.37s/it]Best trial: 13. Best value: 0.22983:  16%|█▌        | 16/100 [01:41<07:08,  5.10s/it]Best trial: 13. Best value: 0.22983:  16%|█▌        | 16/100 [01:48<07:08,  5.10s/it]Best trial: 13. Best value: 0.22983:  17%|█▋        | 17/100 [01:48<07:39,  5.54s/it]Best trial: 13. Best value: 0.22983:  17%|█▋        | 17/100 [01:53<07:39,  5.54s/it]Best trial: 13. Best value: 0.22983:  18%|█▊        | 18/100 [01:53<07:19,  5.36s/it]Best trial: 13. Best value: 0.22983:  18%|█▊        | 18/100 [02:00<07:19,  5.36s/it]Best trial: 13. Best value: 0.22983:  19%|█▉        | 19/100 [02:00<07:48,  5.78s/it]Best trial: 13. Best value: 0.22983:  19%|█▉        | 19/100 [02:06<07:48,  5.78s/it]Best trial: 13. Best value: 0.22983:  20%|██        | 20/100 [02:06<07:49,  5.86s/it]Best trial: 13. Best value: 0.22983:  20%|██        | 20/100 [02:14<07:49,  5.86s/it]Best trial: 13. Best value: 0.22983:  21%|██        | 21/100 [02:14<08:34,  6.52s/it]Best trial: 13. Best value: 0.22983:  21%|██        | 21/100 [02:23<08:34,  6.52s/it]Best trial: 13. Best value: 0.22983:  22%|██▏       | 22/100 [02:23<09:20,  7.18s/it]Best trial: 13. Best value: 0.22983:  22%|██▏       | 22/100 [02:31<09:20,  7.18s/it]Best trial: 13. Best value: 0.22983:  23%|██▎       | 23/100 [02:31<09:42,  7.57s/it]Best trial: 13. Best value: 0.22983:  23%|██▎       | 23/100 [02:36<09:42,  7.57s/it]Best trial: 13. Best value: 0.22983:  24%|██▍       | 24/100 [02:36<08:26,  6.67s/it]Best trial: 13. Best value: 0.22983:  24%|██▍       | 24/100 [02:45<08:26,  6.67s/it]Best trial: 13. Best value: 0.22983:  25%|██▌       | 25/100 [02:45<09:15,  7.41s/it]Best trial: 13. Best value: 0.22983:  25%|██▌       | 25/100 [02:52<09:15,  7.41s/it]Best trial: 13. Best value: 0.22983:  26%|██▌       | 26/100 [02:52<09:07,  7.40s/it]Best trial: 13. Best value: 0.22983:  26%|██▌       | 26/100 [03:00<09:07,  7.40s/it]Best trial: 13. Best value: 0.22983:  27%|██▋       | 27/100 [03:00<09:17,  7.63s/it]Best trial: 13. Best value: 0.22983:  27%|██▋       | 27/100 [03:08<09:17,  7.63s/it]Best trial: 13. Best value: 0.22983:  28%|██▊       | 28/100 [03:08<09:19,  7.76s/it]Best trial: 13. Best value: 0.22983:  28%|██▊       | 28/100 [03:14<09:19,  7.76s/it]Best trial: 13. Best value: 0.22983:  29%|██▉       | 29/100 [03:14<08:36,  7.28s/it]Best trial: 13. Best value: 0.22983:  29%|██▉       | 29/100 [03:23<08:36,  7.28s/it]Best trial: 13. Best value: 0.22983:  30%|███       | 30/100 [03:23<09:02,  7.75s/it]Best trial: 13. Best value: 0.22983:  30%|███       | 30/100 [03:32<09:02,  7.75s/it]Best trial: 13. Best value: 0.22983:  31%|███       | 31/100 [03:32<09:20,  8.12s/it]Best trial: 13. Best value: 0.22983:  31%|███       | 31/100 [03:37<09:20,  8.12s/it]Best trial: 13. Best value: 0.22983:  32%|███▏      | 32/100 [03:37<08:03,  7.11s/it]Best trial: 13. Best value: 0.22983:  32%|███▏      | 32/100 [03:42<08:03,  7.11s/it]Best trial: 13. Best value: 0.22983:  33%|███▎      | 33/100 [03:42<07:21,  6.59s/it]Best trial: 13. Best value: 0.22983:  33%|███▎      | 33/100 [03:53<07:21,  6.59s/it]Best trial: 13. Best value: 0.22983:  34%|███▍      | 34/100 [03:53<08:30,  7.73s/it]Best trial: 13. Best value: 0.22983:  34%|███▍      | 34/100 [03:59<08:30,  7.73s/it]Best trial: 13. Best value: 0.22983:  35%|███▌      | 35/100 [03:59<07:53,  7.28s/it]Best trial: 13. Best value: 0.22983:  35%|███▌      | 35/100 [04:05<07:53,  7.28s/it]Best trial: 13. Best value: 0.22983:  36%|███▌      | 36/100 [04:05<07:28,  7.01s/it]Best trial: 13. Best value: 0.22983:  36%|███▌      | 36/100 [04:12<07:28,  7.01s/it]Best trial: 13. Best value: 0.22983:  37%|███▋      | 37/100 [04:12<07:13,  6.89s/it]Best trial: 13. Best value: 0.22983:  37%|███▋      | 37/100 [04:19<07:13,  6.89s/it]Best trial: 13. Best value: 0.22983:  38%|███▊      | 38/100 [04:19<06:59,  6.77s/it]Best trial: 13. Best value: 0.22983:  38%|███▊      | 38/100 [04:26<06:59,  6.77s/it]Best trial: 13. Best value: 0.22983:  39%|███▉      | 39/100 [04:26<07:08,  7.02s/it]Best trial: 13. Best value: 0.22983:  39%|███▉      | 39/100 [04:33<07:08,  7.02s/it]Best trial: 13. Best value: 0.22983:  40%|████      | 40/100 [04:33<07:04,  7.07s/it]Best trial: 13. Best value: 0.22983:  40%|████      | 40/100 [04:46<07:04,  7.07s/it]Best trial: 13. Best value: 0.22983:  41%|████      | 41/100 [04:46<08:32,  8.69s/it]Best trial: 13. Best value: 0.22983:  41%|████      | 41/100 [04:52<08:32,  8.69s/it]Best trial: 13. Best value: 0.22983:  42%|████▏     | 42/100 [04:52<07:36,  7.87s/it]Best trial: 13. Best value: 0.22983:  42%|████▏     | 42/100 [04:58<07:36,  7.87s/it]Best trial: 13. Best value: 0.22983:  43%|████▎     | 43/100 [04:58<06:54,  7.28s/it]Best trial: 13. Best value: 0.22983:  43%|████▎     | 43/100 [05:04<06:54,  7.28s/it]Best trial: 13. Best value: 0.22983:  44%|████▍     | 44/100 [05:04<06:26,  6.91s/it]Best trial: 13. Best value: 0.22983:  44%|████▍     | 44/100 [05:13<06:26,  6.91s/it]Best trial: 13. Best value: 0.22983:  45%|████▌     | 45/100 [05:13<07:07,  7.77s/it]Best trial: 13. Best value: 0.22983:  45%|████▌     | 45/100 [05:21<07:07,  7.77s/it]Best trial: 13. Best value: 0.22983:  46%|████▌     | 46/100 [05:21<06:55,  7.70s/it]Best trial: 13. Best value: 0.22983:  46%|████▌     | 46/100 [05:28<06:55,  7.70s/it]Best trial: 13. Best value: 0.22983:  47%|████▋     | 47/100 [05:28<06:29,  7.35s/it]Best trial: 13. Best value: 0.22983:  47%|████▋     | 47/100 [05:36<06:29,  7.35s/it]Best trial: 13. Best value: 0.22983:  48%|████▊     | 48/100 [05:36<06:35,  7.61s/it]Best trial: 13. Best value: 0.22983:  48%|████▊     | 48/100 [05:45<06:35,  7.61s/it]Best trial: 13. Best value: 0.22983:  49%|████▉     | 49/100 [05:45<06:46,  7.97s/it]Best trial: 13. Best value: 0.22983:  49%|████▉     | 49/100 [05:52<06:46,  7.97s/it]Best trial: 13. Best value: 0.22983:  50%|█████     | 50/100 [05:52<06:24,  7.70s/it]Best trial: 13. Best value: 0.22983:  50%|█████     | 50/100 [05:58<06:24,  7.70s/it]Best trial: 13. Best value: 0.22983:  51%|█████     | 51/100 [05:58<05:53,  7.21s/it]Best trial: 13. Best value: 0.22983:  51%|█████     | 51/100 [06:02<05:53,  7.21s/it]Best trial: 13. Best value: 0.22983:  52%|█████▏    | 52/100 [06:02<05:11,  6.48s/it]Best trial: 13. Best value: 0.22983:  52%|█████▏    | 52/100 [06:07<05:11,  6.48s/it]Best trial: 13. Best value: 0.22983:  53%|█████▎    | 53/100 [06:07<04:34,  5.84s/it]Best trial: 13. Best value: 0.22983:  53%|█████▎    | 53/100 [06:11<04:34,  5.84s/it]Best trial: 13. Best value: 0.22983:  54%|█████▍    | 54/100 [06:11<04:06,  5.36s/it]Best trial: 13. Best value: 0.22983:  54%|█████▍    | 54/100 [06:19<04:06,  5.36s/it]Best trial: 13. Best value: 0.22983:  55%|█████▌    | 55/100 [06:19<04:40,  6.24s/it]Best trial: 13. Best value: 0.22983:  55%|█████▌    | 55/100 [06:24<04:40,  6.24s/it]Best trial: 13. Best value: 0.22983:  56%|█████▌    | 56/100 [06:24<04:10,  5.69s/it]Best trial: 13. Best value: 0.22983:  56%|█████▌    | 56/100 [06:29<04:10,  5.69s/it]Best trial: 13. Best value: 0.22983:  57%|█████▋    | 57/100 [06:29<04:01,  5.62s/it]Best trial: 13. Best value: 0.22983:  57%|█████▋    | 57/100 [06:37<04:01,  5.62s/it]Best trial: 13. Best value: 0.22983:  58%|█████▊    | 58/100 [06:37<04:29,  6.42s/it]Best trial: 13. Best value: 0.22983:  58%|█████▊    | 58/100 [06:44<04:29,  6.42s/it]Best trial: 13. Best value: 0.22983:  59%|█████▉    | 59/100 [06:44<04:30,  6.59s/it]Best trial: 13. Best value: 0.22983:  59%|█████▉    | 59/100 [06:51<04:30,  6.59s/it]Best trial: 13. Best value: 0.22983:  60%|██████    | 60/100 [06:51<04:26,  6.67s/it]Best trial: 13. Best value: 0.22983:  60%|██████    | 60/100 [06:57<04:26,  6.67s/it]Best trial: 13. Best value: 0.22983:  61%|██████    | 61/100 [06:57<04:10,  6.43s/it]Best trial: 13. Best value: 0.22983:  61%|██████    | 61/100 [07:02<04:10,  6.43s/it]Best trial: 13. Best value: 0.22983:  62%|██████▏   | 62/100 [07:02<03:42,  5.86s/it]Best trial: 13. Best value: 0.22983:  62%|██████▏   | 62/100 [07:06<03:42,  5.86s/it]Best trial: 13. Best value: 0.22983:  63%|██████▎   | 63/100 [07:06<03:21,  5.44s/it]Best trial: 13. Best value: 0.22983:  63%|██████▎   | 63/100 [07:12<03:21,  5.44s/it]Best trial: 13. Best value: 0.22983:  64%|██████▍   | 64/100 [07:12<03:16,  5.47s/it]Best trial: 13. Best value: 0.22983:  64%|██████▍   | 64/100 [07:18<03:16,  5.47s/it]Best trial: 13. Best value: 0.22983:  65%|██████▌   | 65/100 [07:18<03:20,  5.73s/it]Best trial: 13. Best value: 0.22983:  65%|██████▌   | 65/100 [07:23<03:20,  5.73s/it]Best trial: 13. Best value: 0.22983:  66%|██████▌   | 66/100 [07:23<03:02,  5.37s/it]Best trial: 13. Best value: 0.22983:  66%|██████▌   | 66/100 [07:27<03:02,  5.37s/it]Best trial: 13. Best value: 0.22983:  67%|██████▋   | 67/100 [07:27<02:50,  5.16s/it]Best trial: 13. Best value: 0.22983:  67%|██████▋   | 67/100 [07:36<02:50,  5.16s/it]Best trial: 13. Best value: 0.22983:  68%|██████▊   | 68/100 [07:36<03:22,  6.32s/it]Best trial: 13. Best value: 0.22983:  68%|██████▊   | 68/100 [07:42<03:22,  6.32s/it]Best trial: 13. Best value: 0.22983:  69%|██████▉   | 69/100 [07:42<03:12,  6.21s/it]Best trial: 13. Best value: 0.22983:  69%|██████▉   | 69/100 [07:50<03:12,  6.21s/it]Best trial: 13. Best value: 0.22983:  70%|███████   | 70/100 [07:50<03:20,  6.67s/it]Best trial: 13. Best value: 0.22983:  70%|███████   | 70/100 [07:56<03:20,  6.67s/it]Best trial: 13. Best value: 0.22983:  71%|███████   | 71/100 [07:56<03:11,  6.60s/it]Best trial: 13. Best value: 0.22983:  71%|███████   | 71/100 [08:04<03:11,  6.60s/it]Best trial: 13. Best value: 0.22983:  72%|███████▏  | 72/100 [08:04<03:12,  6.89s/it]Best trial: 13. Best value: 0.22983:  72%|███████▏  | 72/100 [08:12<03:12,  6.89s/it]Best trial: 13. Best value: 0.22983:  73%|███████▎  | 73/100 [08:12<03:15,  7.24s/it]Best trial: 13. Best value: 0.22983:  73%|███████▎  | 73/100 [08:21<03:15,  7.24s/it]Best trial: 13. Best value: 0.22983:  74%|███████▍  | 74/100 [08:21<03:19,  7.68s/it]Best trial: 13. Best value: 0.22983:  74%|███████▍  | 74/100 [08:29<03:19,  7.68s/it]Best trial: 13. Best value: 0.22983:  75%|███████▌  | 75/100 [08:29<03:14,  7.77s/it]Best trial: 13. Best value: 0.22983:  75%|███████▌  | 75/100 [08:37<03:14,  7.77s/it]Best trial: 13. Best value: 0.22983:  76%|███████▌  | 76/100 [08:37<03:09,  7.92s/it]Best trial: 13. Best value: 0.22983:  76%|███████▌  | 76/100 [08:43<03:09,  7.92s/it]Best trial: 13. Best value: 0.22983:  77%|███████▋  | 77/100 [08:43<02:47,  7.27s/it]Best trial: 13. Best value: 0.22983:  77%|███████▋  | 77/100 [08:47<02:47,  7.27s/it]Best trial: 13. Best value: 0.22983:  78%|███████▊  | 78/100 [08:47<02:21,  6.44s/it]Best trial: 13. Best value: 0.22983:  78%|███████▊  | 78/100 [08:55<02:21,  6.44s/it]Best trial: 13. Best value: 0.22983:  79%|███████▉  | 79/100 [08:55<02:21,  6.75s/it]Best trial: 13. Best value: 0.22983:  79%|███████▉  | 79/100 [09:02<02:21,  6.75s/it]Best trial: 13. Best value: 0.22983:  80%|████████  | 80/100 [09:02<02:16,  6.82s/it]Best trial: 13. Best value: 0.22983:  80%|████████  | 80/100 [09:08<02:16,  6.82s/it]Best trial: 13. Best value: 0.22983:  81%|████████  | 81/100 [09:08<02:04,  6.56s/it]Best trial: 13. Best value: 0.22983:  81%|████████  | 81/100 [09:13<02:04,  6.56s/it]Best trial: 13. Best value: 0.22983:  82%|████████▏ | 82/100 [09:13<01:49,  6.07s/it]Best trial: 13. Best value: 0.22983:  82%|████████▏ | 82/100 [09:17<01:49,  6.07s/it]Best trial: 13. Best value: 0.22983:  83%|████████▎ | 83/100 [09:17<01:34,  5.58s/it]Best trial: 13. Best value: 0.22983:  83%|████████▎ | 83/100 [09:23<01:34,  5.58s/it]Best trial: 13. Best value: 0.22983:  84%|████████▍ | 84/100 [09:23<01:28,  5.56s/it]Best trial: 13. Best value: 0.22983:  84%|████████▍ | 84/100 [09:29<01:28,  5.56s/it]Best trial: 13. Best value: 0.22983:  85%|████████▌ | 85/100 [09:29<01:26,  5.75s/it]Best trial: 13. Best value: 0.22983:  85%|████████▌ | 85/100 [09:35<01:26,  5.75s/it]Best trial: 13. Best value: 0.22983:  86%|████████▌ | 86/100 [09:35<01:21,  5.82s/it]Best trial: 13. Best value: 0.22983:  86%|████████▌ | 86/100 [09:40<01:21,  5.82s/it]Best trial: 13. Best value: 0.22983:  87%|████████▋ | 87/100 [09:40<01:14,  5.73s/it]Best trial: 13. Best value: 0.22983:  87%|████████▋ | 87/100 [09:45<01:14,  5.73s/it]Best trial: 13. Best value: 0.22983:  88%|████████▊ | 88/100 [09:45<01:06,  5.56s/it]Best trial: 13. Best value: 0.22983:  88%|████████▊ | 88/100 [09:50<01:06,  5.56s/it]Best trial: 13. Best value: 0.22983:  89%|████████▉ | 89/100 [09:50<00:56,  5.15s/it]Best trial: 13. Best value: 0.22983:  89%|████████▉ | 89/100 [09:56<00:56,  5.15s/it]Best trial: 13. Best value: 0.22983:  90%|█████████ | 90/100 [09:56<00:55,  5.52s/it]Best trial: 90. Best value: 0.24392:  90%|█████████ | 90/100 [10:01<00:55,  5.52s/it]Best trial: 90. Best value: 0.24392:  91%|█████████ | 91/100 [10:01<00:48,  5.44s/it]Best trial: 90. Best value: 0.24392:  91%|█████████ | 91/100 [10:06<00:48,  5.44s/it]Best trial: 90. Best value: 0.24392:  92%|█████████▏| 92/100 [10:06<00:41,  5.17s/it]Best trial: 90. Best value: 0.24392:  92%|█████████▏| 92/100 [10:10<00:41,  5.17s/it]Best trial: 90. Best value: 0.24392:  93%|█████████▎| 93/100 [10:10<00:35,  5.01s/it]Best trial: 90. Best value: 0.24392:  93%|█████████▎| 93/100 [10:15<00:35,  5.01s/it]Best trial: 90. Best value: 0.24392:  94%|█████████▍| 94/100 [10:15<00:30,  5.01s/it]Best trial: 90. Best value: 0.24392:  94%|█████████▍| 94/100 [10:21<00:30,  5.01s/it]Best trial: 90. Best value: 0.24392:  95%|█████████▌| 95/100 [10:21<00:26,  5.26s/it]Best trial: 90. Best value: 0.24392:  95%|█████████▌| 95/100 [10:26<00:26,  5.26s/it]Best trial: 90. Best value: 0.24392:  96%|█████████▌| 96/100 [10:26<00:20,  5.24s/it]Best trial: 90. Best value: 0.24392:  96%|█████████▌| 96/100 [10:32<00:20,  5.24s/it]Best trial: 90. Best value: 0.24392:  97%|█████████▋| 97/100 [10:32<00:15,  5.32s/it]Best trial: 90. Best value: 0.24392:  97%|█████████▋| 97/100 [10:39<00:15,  5.32s/it]Best trial: 90. Best value: 0.24392:  98%|█████████▊| 98/100 [10:39<00:11,  5.71s/it]Best trial: 90. Best value: 0.24392:  98%|█████████▊| 98/100 [10:43<00:11,  5.71s/it]Best trial: 90. Best value: 0.24392:  99%|█████████▉| 99/100 [10:43<00:05,  5.28s/it]Best trial: 90. Best value: 0.24392:  99%|█████████▉| 99/100 [10:50<00:05,  5.28s/it]Best trial: 90. Best value: 0.24392: 100%|██████████| 100/100 [10:50<00:00,  5.69s/it]Best trial: 90. Best value: 0.24392: 100%|██████████| 100/100 [10:50<00:00,  6.50s/it]
2025-11-30 16:05:36,910 - INFO - HPO Complete. Best AUPRC: 0.2439
2025-11-30 16:05:36,910 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.0006663351193435727, 'max_depth': 3, 'subsample': 0.6402835325362882, 'colsample_bytree': 0.7713139359223133, 'gamma': 1.2846646427525754, 'reg_lambda': 0.001525741315210142, 'reg_alpha': 0.0005378054370133609}
2025-11-30 16:05:36,911 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:05:38,801 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 16:05:38,801 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:05:39,007 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:05:39,089 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:05:39,112 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 16:05:39,112 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:05:39,112 - INFO - Training model...
2025-11-30 16:05:45,064 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:05:52,038 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:05:52,038 - INFO - AUROC: 0.6212 (0.2611 - 0.9089)
2025-11-30 16:05:52,038 - INFO - AUPRC: 0.0399 (0.0054 - 0.1772)
2025-11-30 16:05:52,038 - INFO - Brier Score: 0.1209 (0.1193 - 0.1238)
2025-11-30 16:05:52,038 - INFO - Accuracy: 0.9827 (0.0702 - 0.9873)
2025-11-30 16:05:52,038 - INFO - Precision: 0.1250 (0.0055 - 0.3333)
2025-11-30 16:05:52,038 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 16:05:52,038 - INFO - F1-Score: 0.1429 (0.0109 - 0.3529)
2025-11-30 16:05:52,038 - INFO - Best Threshold: 0.4500 (0.3000 - 0.4500)
2025-11-30 16:05:52,038 - INFO - Specificity: 0.9898 (0.0605 - 0.9953)
2025-11-30 16:05:52,053 - INFO - Calculating SHAP values...
2025-11-30 16:05:53,152 - INFO - SHAP plots saved.
2025-11-30 16:05:53,153 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:05:54,313 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: ventilator_only
2025-11-30 16:05:54,314 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:05:54,507 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:05:54,543 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:05:54,550 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 16:05:54,550 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0350164:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.0350164:   1%|          | 1/100 [00:03<06:27,  3.91s/it]Best trial: 1. Best value: 0.0814221:   1%|          | 1/100 [00:06<06:27,  3.91s/it]Best trial: 1. Best value: 0.0814221:   2%|▏         | 2/100 [00:06<05:11,  3.17s/it]Best trial: 1. Best value: 0.0814221:   2%|▏         | 2/100 [00:10<05:11,  3.17s/it]Best trial: 1. Best value: 0.0814221:   3%|▎         | 3/100 [00:10<05:35,  3.46s/it]Best trial: 3. Best value: 0.094094:   3%|▎         | 3/100 [00:12<05:35,  3.46s/it] Best trial: 3. Best value: 0.094094:   4%|▍         | 4/100 [00:12<04:41,  2.93s/it]Best trial: 3. Best value: 0.094094:   4%|▍         | 4/100 [00:14<04:41,  2.93s/it]Best trial: 3. Best value: 0.094094:   5%|▌         | 5/100 [00:14<04:12,  2.66s/it]Best trial: 3. Best value: 0.094094:   5%|▌         | 5/100 [00:17<04:12,  2.66s/it]Best trial: 3. Best value: 0.094094:   6%|▌         | 6/100 [00:17<04:12,  2.69s/it]Best trial: 3. Best value: 0.094094:   6%|▌         | 6/100 [00:20<04:12,  2.69s/it]Best trial: 3. Best value: 0.094094:   7%|▋         | 7/100 [00:20<04:13,  2.73s/it]Best trial: 3. Best value: 0.094094:   7%|▋         | 7/100 [00:23<04:13,  2.73s/it]Best trial: 3. Best value: 0.094094:   8%|▊         | 8/100 [00:23<04:37,  3.01s/it]Best trial: 3. Best value: 0.094094:   8%|▊         | 8/100 [00:25<04:37,  3.01s/it]Best trial: 3. Best value: 0.094094:   9%|▉         | 9/100 [00:25<04:04,  2.69s/it]Best trial: 9. Best value: 0.107575:   9%|▉         | 9/100 [00:28<04:04,  2.69s/it]Best trial: 9. Best value: 0.107575:  10%|█         | 10/100 [00:28<03:53,  2.59s/it]Best trial: 9. Best value: 0.107575:  10%|█         | 10/100 [00:31<03:53,  2.59s/it]Best trial: 9. Best value: 0.107575:  11%|█         | 11/100 [00:31<03:58,  2.68s/it]Best trial: 9. Best value: 0.107575:  11%|█         | 11/100 [00:33<03:58,  2.68s/it]Best trial: 9. Best value: 0.107575:  12%|█▏        | 12/100 [00:33<03:48,  2.59s/it]Best trial: 9. Best value: 0.107575:  12%|█▏        | 12/100 [00:35<03:48,  2.59s/it]Best trial: 9. Best value: 0.107575:  13%|█▎        | 13/100 [00:35<03:35,  2.47s/it]Best trial: 13. Best value: 0.119563:  13%|█▎        | 13/100 [00:38<03:35,  2.47s/it]Best trial: 13. Best value: 0.119563:  14%|█▍        | 14/100 [00:38<03:47,  2.65s/it]Best trial: 14. Best value: 0.120745:  14%|█▍        | 14/100 [00:41<03:47,  2.65s/it]Best trial: 14. Best value: 0.120745:  15%|█▌        | 15/100 [00:41<03:41,  2.61s/it]Best trial: 14. Best value: 0.120745:  15%|█▌        | 15/100 [00:44<03:41,  2.61s/it]Best trial: 14. Best value: 0.120745:  16%|█▌        | 16/100 [00:44<04:00,  2.87s/it]Best trial: 16. Best value: 0.127131:  16%|█▌        | 16/100 [00:47<04:00,  2.87s/it]Best trial: 16. Best value: 0.127131:  17%|█▋        | 17/100 [00:47<03:51,  2.79s/it]Best trial: 16. Best value: 0.127131:  17%|█▋        | 17/100 [00:49<03:51,  2.79s/it]Best trial: 16. Best value: 0.127131:  18%|█▊        | 18/100 [00:49<03:44,  2.74s/it]Best trial: 18. Best value: 0.140122:  18%|█▊        | 18/100 [00:53<03:44,  2.74s/it]Best trial: 18. Best value: 0.140122:  19%|█▉        | 19/100 [00:53<03:59,  2.96s/it]Best trial: 18. Best value: 0.140122:  19%|█▉        | 19/100 [00:56<03:59,  2.96s/it]Best trial: 18. Best value: 0.140122:  20%|██        | 20/100 [00:56<03:50,  2.88s/it]Best trial: 18. Best value: 0.140122:  20%|██        | 20/100 [00:59<03:50,  2.88s/it]Best trial: 18. Best value: 0.140122:  21%|██        | 21/100 [00:59<04:08,  3.14s/it]Best trial: 18. Best value: 0.140122:  21%|██        | 21/100 [01:02<04:08,  3.14s/it]Best trial: 18. Best value: 0.140122:  22%|██▏       | 22/100 [01:02<03:50,  2.95s/it]Best trial: 18. Best value: 0.140122:  22%|██▏       | 22/100 [01:05<03:50,  2.95s/it]Best trial: 18. Best value: 0.140122:  23%|██▎       | 23/100 [01:05<03:57,  3.09s/it]Best trial: 18. Best value: 0.140122:  23%|██▎       | 23/100 [01:08<03:57,  3.09s/it]Best trial: 18. Best value: 0.140122:  24%|██▍       | 24/100 [01:08<03:47,  3.00s/it]Best trial: 18. Best value: 0.140122:  24%|██▍       | 24/100 [01:11<03:47,  3.00s/it]Best trial: 18. Best value: 0.140122:  25%|██▌       | 25/100 [01:11<03:51,  3.09s/it]Best trial: 18. Best value: 0.140122:  25%|██▌       | 25/100 [01:15<03:51,  3.09s/it]Best trial: 18. Best value: 0.140122:  26%|██▌       | 26/100 [01:15<04:09,  3.37s/it]Best trial: 26. Best value: 0.143329:  26%|██▌       | 26/100 [01:19<04:09,  3.37s/it]Best trial: 26. Best value: 0.143329:  27%|██▋       | 27/100 [01:19<04:04,  3.35s/it]Best trial: 26. Best value: 0.143329:  27%|██▋       | 27/100 [01:22<04:04,  3.35s/it]Best trial: 26. Best value: 0.143329:  28%|██▊       | 28/100 [01:22<03:56,  3.29s/it]Best trial: 26. Best value: 0.143329:  28%|██▊       | 28/100 [01:25<03:56,  3.29s/it]Best trial: 26. Best value: 0.143329:  29%|██▉       | 29/100 [01:25<03:41,  3.13s/it]Best trial: 26. Best value: 0.143329:  29%|██▉       | 29/100 [01:28<03:41,  3.13s/it]Best trial: 26. Best value: 0.143329:  30%|███       | 30/100 [01:28<03:51,  3.31s/it]Best trial: 26. Best value: 0.143329:  30%|███       | 30/100 [01:32<03:51,  3.31s/it]Best trial: 26. Best value: 0.143329:  31%|███       | 31/100 [01:32<03:58,  3.46s/it]Best trial: 26. Best value: 0.143329:  31%|███       | 31/100 [01:35<03:58,  3.46s/it]Best trial: 26. Best value: 0.143329:  32%|███▏      | 32/100 [01:35<03:42,  3.27s/it]Best trial: 26. Best value: 0.143329:  32%|███▏      | 32/100 [01:38<03:42,  3.27s/it]Best trial: 26. Best value: 0.143329:  33%|███▎      | 33/100 [01:38<03:39,  3.28s/it]Best trial: 33. Best value: 0.154506:  33%|███▎      | 33/100 [01:41<03:39,  3.28s/it]Best trial: 33. Best value: 0.154506:  34%|███▍      | 34/100 [01:41<03:31,  3.21s/it]Best trial: 33. Best value: 0.154506:  34%|███▍      | 34/100 [01:44<03:31,  3.21s/it]Best trial: 33. Best value: 0.154506:  35%|███▌      | 35/100 [01:44<03:17,  3.03s/it]Best trial: 33. Best value: 0.154506:  35%|███▌      | 35/100 [01:47<03:17,  3.03s/it]Best trial: 33. Best value: 0.154506:  36%|███▌      | 36/100 [01:47<03:07,  2.92s/it]Best trial: 33. Best value: 0.154506:  36%|███▌      | 36/100 [01:49<03:07,  2.92s/it]Best trial: 33. Best value: 0.154506:  37%|███▋      | 37/100 [01:49<02:56,  2.80s/it]Best trial: 37. Best value: 0.182235:  37%|███▋      | 37/100 [01:52<02:56,  2.80s/it]Best trial: 37. Best value: 0.182235:  38%|███▊      | 38/100 [01:52<02:50,  2.74s/it]Best trial: 37. Best value: 0.182235:  38%|███▊      | 38/100 [01:55<02:50,  2.74s/it]Best trial: 37. Best value: 0.182235:  39%|███▉      | 39/100 [01:55<02:54,  2.86s/it]Best trial: 37. Best value: 0.182235:  39%|███▉      | 39/100 [01:57<02:54,  2.86s/it]Best trial: 37. Best value: 0.182235:  40%|████      | 40/100 [01:57<02:43,  2.73s/it]Best trial: 37. Best value: 0.182235:  40%|████      | 40/100 [02:01<02:43,  2.73s/it]Best trial: 37. Best value: 0.182235:  41%|████      | 41/100 [02:01<02:56,  3.00s/it]Best trial: 37. Best value: 0.182235:  41%|████      | 41/100 [02:04<02:56,  3.00s/it]Best trial: 37. Best value: 0.182235:  42%|████▏     | 42/100 [02:04<02:51,  2.96s/it]Best trial: 37. Best value: 0.182235:  42%|████▏     | 42/100 [02:07<02:51,  2.96s/it]Best trial: 37. Best value: 0.182235:  43%|████▎     | 43/100 [02:07<02:47,  2.94s/it]Best trial: 37. Best value: 0.182235:  43%|████▎     | 43/100 [02:09<02:47,  2.94s/it]Best trial: 37. Best value: 0.182235:  44%|████▍     | 44/100 [02:09<02:32,  2.72s/it]Best trial: 37. Best value: 0.182235:  44%|████▍     | 44/100 [02:13<02:32,  2.72s/it]Best trial: 37. Best value: 0.182235:  45%|████▌     | 45/100 [02:13<02:47,  3.04s/it]Best trial: 37. Best value: 0.182235:  45%|████▌     | 45/100 [02:15<02:47,  3.04s/it]Best trial: 37. Best value: 0.182235:  46%|████▌     | 46/100 [02:15<02:36,  2.89s/it]Best trial: 37. Best value: 0.182235:  46%|████▌     | 46/100 [02:18<02:36,  2.89s/it]Best trial: 37. Best value: 0.182235:  47%|████▋     | 47/100 [02:18<02:36,  2.95s/it]Best trial: 37. Best value: 0.182235:  47%|████▋     | 47/100 [02:21<02:36,  2.95s/it]Best trial: 37. Best value: 0.182235:  48%|████▊     | 48/100 [02:21<02:32,  2.93s/it]Best trial: 37. Best value: 0.182235:  48%|████▊     | 48/100 [02:24<02:32,  2.93s/it]Best trial: 37. Best value: 0.182235:  49%|████▉     | 49/100 [02:24<02:25,  2.86s/it]Best trial: 37. Best value: 0.182235:  49%|████▉     | 49/100 [02:28<02:25,  2.86s/it]Best trial: 37. Best value: 0.182235:  50%|█████     | 50/100 [02:28<02:34,  3.10s/it]Best trial: 37. Best value: 0.182235:  50%|█████     | 50/100 [02:30<02:34,  3.10s/it]Best trial: 37. Best value: 0.182235:  51%|█████     | 51/100 [02:30<02:28,  3.04s/it]Best trial: 37. Best value: 0.182235:  51%|█████     | 51/100 [02:34<02:28,  3.04s/it]Best trial: 37. Best value: 0.182235:  52%|█████▏    | 52/100 [02:34<02:35,  3.23s/it]Best trial: 37. Best value: 0.182235:  52%|█████▏    | 52/100 [02:37<02:35,  3.23s/it]Best trial: 37. Best value: 0.182235:  53%|█████▎    | 53/100 [02:37<02:29,  3.18s/it]Best trial: 37. Best value: 0.182235:  53%|█████▎    | 53/100 [02:40<02:29,  3.18s/it]Best trial: 37. Best value: 0.182235:  54%|█████▍    | 54/100 [02:40<02:21,  3.09s/it]Best trial: 37. Best value: 0.182235:  54%|█████▍    | 54/100 [02:43<02:21,  3.09s/it]Best trial: 37. Best value: 0.182235:  55%|█████▌    | 55/100 [02:43<02:12,  2.95s/it]Best trial: 37. Best value: 0.182235:  55%|█████▌    | 55/100 [02:45<02:12,  2.95s/it]Best trial: 37. Best value: 0.182235:  56%|█████▌    | 56/100 [02:45<02:06,  2.88s/it]Best trial: 37. Best value: 0.182235:  56%|█████▌    | 56/100 [02:49<02:06,  2.88s/it]Best trial: 37. Best value: 0.182235:  57%|█████▋    | 57/100 [02:49<02:15,  3.16s/it]Best trial: 37. Best value: 0.182235:  57%|█████▋    | 57/100 [02:52<02:15,  3.16s/it]Best trial: 37. Best value: 0.182235:  58%|█████▊    | 58/100 [02:52<02:11,  3.12s/it]Best trial: 37. Best value: 0.182235:  58%|█████▊    | 58/100 [02:55<02:11,  3.12s/it]Best trial: 37. Best value: 0.182235:  59%|█████▉    | 59/100 [02:55<02:00,  2.94s/it]Best trial: 37. Best value: 0.182235:  59%|█████▉    | 59/100 [02:57<02:00,  2.94s/it]Best trial: 37. Best value: 0.182235:  60%|██████    | 60/100 [02:57<01:49,  2.74s/it]Best trial: 37. Best value: 0.182235:  60%|██████    | 60/100 [03:01<01:49,  2.74s/it]Best trial: 37. Best value: 0.182235:  61%|██████    | 61/100 [03:01<01:56,  2.98s/it]Best trial: 37. Best value: 0.182235:  61%|██████    | 61/100 [03:03<01:56,  2.98s/it]Best trial: 37. Best value: 0.182235:  62%|██████▏   | 62/100 [03:03<01:46,  2.80s/it]Best trial: 37. Best value: 0.182235:  62%|██████▏   | 62/100 [03:05<01:46,  2.80s/it]Best trial: 37. Best value: 0.182235:  63%|██████▎   | 63/100 [03:05<01:39,  2.68s/it]Best trial: 37. Best value: 0.182235:  63%|██████▎   | 63/100 [03:09<01:39,  2.68s/it]Best trial: 37. Best value: 0.182235:  64%|██████▍   | 64/100 [03:09<01:44,  2.89s/it]Best trial: 37. Best value: 0.182235:  64%|██████▍   | 64/100 [03:11<01:44,  2.89s/it]Best trial: 37. Best value: 0.182235:  65%|██████▌   | 65/100 [03:11<01:30,  2.58s/it]Best trial: 37. Best value: 0.182235:  65%|██████▌   | 65/100 [03:14<01:30,  2.58s/it]Best trial: 37. Best value: 0.182235:  66%|██████▌   | 66/100 [03:14<01:33,  2.76s/it]Best trial: 37. Best value: 0.182235:  66%|██████▌   | 66/100 [03:16<01:33,  2.76s/it]Best trial: 37. Best value: 0.182235:  67%|██████▋   | 67/100 [03:16<01:27,  2.67s/it]Best trial: 37. Best value: 0.182235:  67%|██████▋   | 67/100 [03:19<01:27,  2.67s/it]Best trial: 37. Best value: 0.182235:  68%|██████▊   | 68/100 [03:19<01:24,  2.65s/it]Best trial: 37. Best value: 0.182235:  68%|██████▊   | 68/100 [03:22<01:24,  2.65s/it]Best trial: 37. Best value: 0.182235:  69%|██████▉   | 69/100 [03:22<01:30,  2.94s/it]Best trial: 37. Best value: 0.182235:  69%|██████▉   | 69/100 [03:26<01:30,  2.94s/it]Best trial: 37. Best value: 0.182235:  70%|███████   | 70/100 [03:26<01:33,  3.12s/it]Best trial: 37. Best value: 0.182235:  70%|███████   | 70/100 [03:31<01:33,  3.12s/it]Best trial: 37. Best value: 0.182235:  71%|███████   | 71/100 [03:31<01:44,  3.60s/it]Best trial: 37. Best value: 0.182235:  71%|███████   | 71/100 [03:34<01:44,  3.60s/it]Best trial: 37. Best value: 0.182235:  72%|███████▏  | 72/100 [03:34<01:36,  3.45s/it]Best trial: 37. Best value: 0.182235:  72%|███████▏  | 72/100 [03:37<01:36,  3.45s/it]Best trial: 37. Best value: 0.182235:  73%|███████▎  | 73/100 [03:37<01:27,  3.25s/it]Best trial: 37. Best value: 0.182235:  73%|███████▎  | 73/100 [03:39<01:27,  3.25s/it]Best trial: 37. Best value: 0.182235:  74%|███████▍  | 74/100 [03:39<01:15,  2.90s/it]Best trial: 37. Best value: 0.182235:  74%|███████▍  | 74/100 [03:42<01:15,  2.90s/it]Best trial: 37. Best value: 0.182235:  75%|███████▌  | 75/100 [03:42<01:12,  2.91s/it]Best trial: 37. Best value: 0.182235:  75%|███████▌  | 75/100 [03:45<01:12,  2.91s/it]Best trial: 37. Best value: 0.182235:  76%|███████▌  | 76/100 [03:45<01:13,  3.05s/it]Best trial: 37. Best value: 0.182235:  76%|███████▌  | 76/100 [03:48<01:13,  3.05s/it]Best trial: 37. Best value: 0.182235:  77%|███████▋  | 77/100 [03:48<01:09,  3.01s/it]Best trial: 37. Best value: 0.182235:  77%|███████▋  | 77/100 [03:50<01:09,  3.01s/it]Best trial: 37. Best value: 0.182235:  78%|███████▊  | 78/100 [03:50<01:03,  2.88s/it]Best trial: 37. Best value: 0.182235:  78%|███████▊  | 78/100 [03:53<01:03,  2.88s/it]Best trial: 37. Best value: 0.182235:  79%|███████▉  | 79/100 [03:53<00:59,  2.85s/it]Best trial: 37. Best value: 0.182235:  79%|███████▉  | 79/100 [03:56<00:59,  2.85s/it]Best trial: 37. Best value: 0.182235:  80%|████████  | 80/100 [03:56<00:55,  2.77s/it]Best trial: 37. Best value: 0.182235:  80%|████████  | 80/100 [03:58<00:55,  2.77s/it]Best trial: 37. Best value: 0.182235:  81%|████████  | 81/100 [03:58<00:50,  2.66s/it]Best trial: 37. Best value: 0.182235:  81%|████████  | 81/100 [04:01<00:50,  2.66s/it]Best trial: 37. Best value: 0.182235:  82%|████████▏ | 82/100 [04:01<00:47,  2.63s/it]Best trial: 37. Best value: 0.182235:  82%|████████▏ | 82/100 [04:04<00:47,  2.63s/it]Best trial: 37. Best value: 0.182235:  83%|████████▎ | 83/100 [04:04<00:47,  2.82s/it]Best trial: 37. Best value: 0.182235:  83%|████████▎ | 83/100 [04:08<00:47,  2.82s/it]Best trial: 37. Best value: 0.182235:  84%|████████▍ | 84/100 [04:08<00:49,  3.07s/it]Best trial: 37. Best value: 0.182235:  84%|████████▍ | 84/100 [04:11<00:49,  3.07s/it]Best trial: 37. Best value: 0.182235:  85%|████████▌ | 85/100 [04:11<00:46,  3.08s/it]Best trial: 37. Best value: 0.182235:  85%|████████▌ | 85/100 [04:14<00:46,  3.08s/it]Best trial: 37. Best value: 0.182235:  86%|████████▌ | 86/100 [04:14<00:42,  3.05s/it]Best trial: 37. Best value: 0.182235:  86%|████████▌ | 86/100 [04:16<00:42,  3.05s/it]Best trial: 37. Best value: 0.182235:  87%|████████▋ | 87/100 [04:16<00:37,  2.91s/it]Best trial: 37. Best value: 0.182235:  87%|████████▋ | 87/100 [04:19<00:37,  2.91s/it]Best trial: 37. Best value: 0.182235:  88%|████████▊ | 88/100 [04:19<00:32,  2.72s/it]Best trial: 37. Best value: 0.182235:  88%|████████▊ | 88/100 [04:22<00:32,  2.72s/it]Best trial: 37. Best value: 0.182235:  89%|████████▉ | 89/100 [04:22<00:31,  2.86s/it]Best trial: 37. Best value: 0.182235:  89%|████████▉ | 89/100 [04:26<00:31,  2.86s/it]Best trial: 37. Best value: 0.182235:  90%|█████████ | 90/100 [04:26<00:31,  3.18s/it]Best trial: 37. Best value: 0.182235:  90%|█████████ | 90/100 [04:29<00:31,  3.18s/it]Best trial: 37. Best value: 0.182235:  91%|█████████ | 91/100 [04:29<00:29,  3.27s/it]Best trial: 37. Best value: 0.182235:  91%|█████████ | 91/100 [04:32<00:29,  3.27s/it]Best trial: 37. Best value: 0.182235:  92%|█████████▏| 92/100 [04:32<00:25,  3.22s/it]Best trial: 37. Best value: 0.182235:  92%|█████████▏| 92/100 [04:35<00:25,  3.22s/it]Best trial: 37. Best value: 0.182235:  93%|█████████▎| 93/100 [04:35<00:21,  3.12s/it]Best trial: 37. Best value: 0.182235:  93%|█████████▎| 93/100 [04:39<00:21,  3.12s/it]Best trial: 37. Best value: 0.182235:  94%|█████████▍| 94/100 [04:39<00:20,  3.35s/it]Best trial: 37. Best value: 0.182235:  94%|█████████▍| 94/100 [04:43<00:20,  3.35s/it]Best trial: 37. Best value: 0.182235:  95%|█████████▌| 95/100 [04:43<00:17,  3.42s/it]Best trial: 37. Best value: 0.182235:  95%|█████████▌| 95/100 [04:46<00:17,  3.42s/it]Best trial: 37. Best value: 0.182235:  96%|█████████▌| 96/100 [04:46<00:13,  3.27s/it]Best trial: 37. Best value: 0.182235:  96%|█████████▌| 96/100 [04:48<00:13,  3.27s/it]Best trial: 37. Best value: 0.182235:  97%|█████████▋| 97/100 [04:48<00:09,  3.11s/it]Best trial: 37. Best value: 0.182235:  97%|█████████▋| 97/100 [04:51<00:09,  3.11s/it]Best trial: 37. Best value: 0.182235:  98%|█████████▊| 98/100 [04:51<00:06,  3.03s/it]Best trial: 37. Best value: 0.182235:  98%|█████████▊| 98/100 [04:54<00:06,  3.03s/it]Best trial: 37. Best value: 0.182235:  99%|█████████▉| 99/100 [04:54<00:03,  3.10s/it]Best trial: 37. Best value: 0.182235:  99%|█████████▉| 99/100 [04:58<00:03,  3.10s/it]Best trial: 37. Best value: 0.182235: 100%|██████████| 100/100 [04:58<00:00,  3.10s/it]Best trial: 37. Best value: 0.182235: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
2025-11-30 16:10:52,620 - INFO - HPO Complete. Best AUPRC: 0.1822
2025-11-30 16:10:52,620 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.00042064104121225683, 'max_depth': 7, 'subsample': 0.6456305484786679, 'colsample_bytree': 0.8686359896853019, 'gamma': 1.263135109487195, 'reg_lambda': 6.271106192830785e-07, 'reg_alpha': 0.03848686905498478}
2025-11-30 16:10:52,620 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:10:54,468 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: ventilator_only
2025-11-30 16:10:54,468 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:10:54,662 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:10:54,699 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:10:54,706 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 16:10:54,706 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:10:54,706 - INFO - Training model...
2025-11-30 16:10:57,145 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:11:02,581 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:11:02,581 - INFO - AUROC: 0.4973 (0.1216 - 0.7027)
2025-11-30 16:11:02,581 - INFO - AUPRC: 0.0154 (0.0044 - 0.0423)
2025-11-30 16:11:02,581 - INFO - Brier Score: 0.2001 (0.1994 - 0.2011)
2025-11-30 16:11:02,581 - INFO - Accuracy: 0.8165 (0.0043 - 0.8341)
2025-11-30 16:11:02,581 - INFO - Precision: 0.0160 (0.0043 - 0.0301)
2025-11-30 16:11:02,581 - INFO - Sensitivity (Recall): 0.3333 (0.2300 - 1.0000)
2025-11-30 16:11:02,581 - INFO - F1-Score: 0.0305 (0.0086 - 0.0567)
2025-11-30 16:11:02,581 - INFO - Best Threshold: 0.4500 (0.0100 - 0.4500)
2025-11-30 16:11:02,581 - INFO - Specificity: 0.8207 (0.0000 - 0.8371)
2025-11-30 16:11:02,590 - INFO - Calculating SHAP values...
2025-11-30 16:11:03,736 - INFO - SHAP plots saved.
2025-11-30 16:11:03,738 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:11:05,159 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: monitors_only
2025-11-30 16:11:05,159 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:11:05,373 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:11:05,410 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:11:05,417 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 16:11:05,418 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.125336:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.125336:   1%|          | 1/100 [00:03<05:43,  3.47s/it]Best trial: 0. Best value: 0.125336:   1%|          | 1/100 [00:05<05:43,  3.47s/it]Best trial: 0. Best value: 0.125336:   2%|▏         | 2/100 [00:05<04:44,  2.91s/it]Best trial: 0. Best value: 0.125336:   2%|▏         | 2/100 [00:11<04:44,  2.91s/it]Best trial: 0. Best value: 0.125336:   3%|▎         | 3/100 [00:11<06:26,  3.98s/it]Best trial: 0. Best value: 0.125336:   3%|▎         | 3/100 [00:15<06:26,  3.98s/it]Best trial: 0. Best value: 0.125336:   4%|▍         | 4/100 [00:15<06:18,  3.94s/it]Best trial: 0. Best value: 0.125336:   4%|▍         | 4/100 [00:17<06:18,  3.94s/it]Best trial: 0. Best value: 0.125336:   5%|▌         | 5/100 [00:17<05:37,  3.55s/it]Best trial: 5. Best value: 0.172866:   5%|▌         | 5/100 [00:21<05:37,  3.55s/it]Best trial: 5. Best value: 0.172866:   6%|▌         | 6/100 [00:21<05:46,  3.69s/it]Best trial: 5. Best value: 0.172866:   6%|▌         | 6/100 [00:25<05:46,  3.69s/it]Best trial: 5. Best value: 0.172866:   7%|▋         | 7/100 [00:25<05:51,  3.78s/it]Best trial: 5. Best value: 0.172866:   7%|▋         | 7/100 [00:28<05:51,  3.78s/it]Best trial: 5. Best value: 0.172866:   8%|▊         | 8/100 [00:28<05:16,  3.44s/it]Best trial: 5. Best value: 0.172866:   8%|▊         | 8/100 [00:31<05:16,  3.44s/it]Best trial: 5. Best value: 0.172866:   9%|▉         | 9/100 [00:31<05:00,  3.30s/it]Best trial: 5. Best value: 0.172866:   9%|▉         | 9/100 [00:34<05:00,  3.30s/it]Best trial: 5. Best value: 0.172866:  10%|█         | 10/100 [00:34<04:51,  3.24s/it]Best trial: 5. Best value: 0.172866:  10%|█         | 10/100 [00:38<04:51,  3.24s/it]Best trial: 5. Best value: 0.172866:  11%|█         | 11/100 [00:38<05:02,  3.40s/it]Best trial: 5. Best value: 0.172866:  11%|█         | 11/100 [00:41<05:02,  3.40s/it]Best trial: 5. Best value: 0.172866:  12%|█▏        | 12/100 [00:41<04:47,  3.26s/it]Best trial: 5. Best value: 0.172866:  12%|█▏        | 12/100 [00:44<04:47,  3.26s/it]Best trial: 5. Best value: 0.172866:  13%|█▎        | 13/100 [00:44<04:42,  3.25s/it]Best trial: 5. Best value: 0.172866:  13%|█▎        | 13/100 [00:48<04:42,  3.25s/it]Best trial: 5. Best value: 0.172866:  14%|█▍        | 14/100 [00:48<05:00,  3.50s/it]Best trial: 5. Best value: 0.172866:  14%|█▍        | 14/100 [00:51<05:00,  3.50s/it]Best trial: 5. Best value: 0.172866:  15%|█▌        | 15/100 [00:51<04:41,  3.31s/it]Best trial: 5. Best value: 0.172866:  15%|█▌        | 15/100 [00:55<04:41,  3.31s/it]Best trial: 5. Best value: 0.172866:  16%|█▌        | 16/100 [00:55<04:43,  3.37s/it]Best trial: 5. Best value: 0.172866:  16%|█▌        | 16/100 [00:57<04:43,  3.37s/it]Best trial: 5. Best value: 0.172866:  17%|█▋        | 17/100 [00:57<04:23,  3.18s/it]Best trial: 5. Best value: 0.172866:  17%|█▋        | 17/100 [01:00<04:23,  3.18s/it]Best trial: 5. Best value: 0.172866:  18%|█▊        | 18/100 [01:00<04:15,  3.12s/it]Best trial: 5. Best value: 0.172866:  18%|█▊        | 18/100 [01:03<04:15,  3.12s/it]Best trial: 5. Best value: 0.172866:  19%|█▉        | 19/100 [01:03<04:12,  3.12s/it]Best trial: 5. Best value: 0.172866:  19%|█▉        | 19/100 [01:08<04:12,  3.12s/it]Best trial: 5. Best value: 0.172866:  20%|██        | 20/100 [01:08<04:38,  3.48s/it]Best trial: 5. Best value: 0.172866:  20%|██        | 20/100 [01:11<04:38,  3.48s/it]Best trial: 5. Best value: 0.172866:  21%|██        | 21/100 [01:11<04:25,  3.36s/it]Best trial: 5. Best value: 0.172866:  21%|██        | 21/100 [01:14<04:25,  3.36s/it]Best trial: 5. Best value: 0.172866:  22%|██▏       | 22/100 [01:14<04:20,  3.34s/it]Best trial: 5. Best value: 0.172866:  22%|██▏       | 22/100 [01:17<04:20,  3.34s/it]Best trial: 5. Best value: 0.172866:  23%|██▎       | 23/100 [01:17<04:00,  3.12s/it]Best trial: 5. Best value: 0.172866:  23%|██▎       | 23/100 [01:20<04:00,  3.12s/it]Best trial: 5. Best value: 0.172866:  24%|██▍       | 24/100 [01:20<03:57,  3.12s/it]Best trial: 5. Best value: 0.172866:  24%|██▍       | 24/100 [01:24<03:57,  3.12s/it]Best trial: 5. Best value: 0.172866:  25%|██▌       | 25/100 [01:24<04:16,  3.42s/it]Best trial: 5. Best value: 0.172866:  25%|██▌       | 25/100 [01:30<04:16,  3.42s/it]Best trial: 5. Best value: 0.172866:  26%|██▌       | 26/100 [01:30<05:10,  4.20s/it]Best trial: 5. Best value: 0.172866:  26%|██▌       | 26/100 [01:33<05:10,  4.20s/it]Best trial: 5. Best value: 0.172866:  27%|██▋       | 27/100 [01:33<04:47,  3.94s/it]Best trial: 5. Best value: 0.172866:  27%|██▋       | 27/100 [01:37<04:47,  3.94s/it]Best trial: 5. Best value: 0.172866:  28%|██▊       | 28/100 [01:37<04:28,  3.73s/it]Best trial: 5. Best value: 0.172866:  28%|██▊       | 28/100 [01:39<04:28,  3.73s/it]Best trial: 5. Best value: 0.172866:  29%|██▉       | 29/100 [01:39<04:03,  3.43s/it]Best trial: 5. Best value: 0.172866:  29%|██▉       | 29/100 [01:43<04:03,  3.43s/it]Best trial: 5. Best value: 0.172866:  30%|███       | 30/100 [01:43<04:11,  3.60s/it]Best trial: 5. Best value: 0.172866:  30%|███       | 30/100 [01:46<04:11,  3.60s/it]Best trial: 5. Best value: 0.172866:  31%|███       | 31/100 [01:46<03:43,  3.24s/it]Best trial: 5. Best value: 0.172866:  31%|███       | 31/100 [01:49<03:43,  3.24s/it]Best trial: 5. Best value: 0.172866:  32%|███▏      | 32/100 [01:49<03:43,  3.28s/it]Best trial: 32. Best value: 0.1749:  32%|███▏      | 32/100 [01:52<03:43,  3.28s/it] Best trial: 32. Best value: 0.1749:  33%|███▎      | 33/100 [01:52<03:41,  3.31s/it]Best trial: 32. Best value: 0.1749:  33%|███▎      | 33/100 [01:57<03:41,  3.31s/it]Best trial: 32. Best value: 0.1749:  34%|███▍      | 34/100 [01:57<03:59,  3.63s/it]Best trial: 32. Best value: 0.1749:  34%|███▍      | 34/100 [02:00<03:59,  3.63s/it]Best trial: 32. Best value: 0.1749:  35%|███▌      | 35/100 [02:00<03:47,  3.50s/it]Best trial: 32. Best value: 0.1749:  35%|███▌      | 35/100 [02:03<03:47,  3.50s/it]Best trial: 32. Best value: 0.1749:  36%|███▌      | 36/100 [02:03<03:38,  3.41s/it]Best trial: 32. Best value: 0.1749:  36%|███▌      | 36/100 [02:06<03:38,  3.41s/it]Best trial: 32. Best value: 0.1749:  37%|███▋      | 37/100 [02:06<03:26,  3.27s/it]Best trial: 32. Best value: 0.1749:  37%|███▋      | 37/100 [02:09<03:26,  3.27s/it]Best trial: 32. Best value: 0.1749:  38%|███▊      | 38/100 [02:09<03:07,  3.03s/it]Best trial: 32. Best value: 0.1749:  38%|███▊      | 38/100 [02:12<03:07,  3.03s/it]Best trial: 32. Best value: 0.1749:  39%|███▉      | 39/100 [02:12<03:03,  3.01s/it]Best trial: 32. Best value: 0.1749:  39%|███▉      | 39/100 [02:15<03:03,  3.01s/it]Best trial: 32. Best value: 0.1749:  40%|████      | 40/100 [02:15<03:01,  3.02s/it]Best trial: 32. Best value: 0.1749:  40%|████      | 40/100 [02:17<03:01,  3.02s/it]Best trial: 32. Best value: 0.1749:  41%|████      | 41/100 [02:17<02:52,  2.92s/it]Best trial: 32. Best value: 0.1749:  41%|████      | 41/100 [02:20<02:52,  2.92s/it]Best trial: 32. Best value: 0.1749:  42%|████▏     | 42/100 [02:20<02:49,  2.92s/it]Best trial: 32. Best value: 0.1749:  42%|████▏     | 42/100 [02:23<02:49,  2.92s/it]Best trial: 32. Best value: 0.1749:  43%|████▎     | 43/100 [02:23<02:36,  2.75s/it]Best trial: 32. Best value: 0.1749:  43%|████▎     | 43/100 [02:25<02:36,  2.75s/it]Best trial: 32. Best value: 0.1749:  44%|████▍     | 44/100 [02:25<02:36,  2.79s/it]Best trial: 32. Best value: 0.1749:  44%|████▍     | 44/100 [02:28<02:36,  2.79s/it]Best trial: 32. Best value: 0.1749:  45%|████▌     | 45/100 [02:28<02:28,  2.70s/it]Best trial: 32. Best value: 0.1749:  45%|████▌     | 45/100 [02:30<02:28,  2.70s/it]Best trial: 32. Best value: 0.1749:  46%|████▌     | 46/100 [02:30<02:22,  2.63s/it]Best trial: 32. Best value: 0.1749:  46%|████▌     | 46/100 [02:33<02:22,  2.63s/it]Best trial: 32. Best value: 0.1749:  47%|████▋     | 47/100 [02:33<02:24,  2.73s/it]Best trial: 32. Best value: 0.1749:  47%|████▋     | 47/100 [02:37<02:24,  2.73s/it]Best trial: 32. Best value: 0.1749:  48%|████▊     | 48/100 [02:37<02:28,  2.86s/it]Best trial: 32. Best value: 0.1749:  48%|████▊     | 48/100 [02:42<02:28,  2.86s/it]Best trial: 32. Best value: 0.1749:  49%|████▉     | 49/100 [02:42<03:07,  3.68s/it]Best trial: 32. Best value: 0.1749:  49%|████▉     | 49/100 [02:45<03:07,  3.68s/it]Best trial: 32. Best value: 0.1749:  50%|█████     | 50/100 [02:45<02:48,  3.37s/it]Best trial: 32. Best value: 0.1749:  50%|█████     | 50/100 [02:48<02:48,  3.37s/it]Best trial: 32. Best value: 0.1749:  51%|█████     | 51/100 [02:48<02:49,  3.45s/it]Best trial: 32. Best value: 0.1749:  51%|█████     | 51/100 [02:52<02:49,  3.45s/it]Best trial: 32. Best value: 0.1749:  52%|█████▏    | 52/100 [02:52<02:48,  3.52s/it]Best trial: 32. Best value: 0.1749:  52%|█████▏    | 52/100 [02:56<02:48,  3.52s/it]Best trial: 32. Best value: 0.1749:  53%|█████▎    | 53/100 [02:56<02:46,  3.55s/it]Best trial: 53. Best value: 0.178996:  53%|█████▎    | 53/100 [02:59<02:46,  3.55s/it]Best trial: 53. Best value: 0.178996:  54%|█████▍    | 54/100 [02:59<02:35,  3.39s/it]Best trial: 54. Best value: 0.182977:  54%|█████▍    | 54/100 [03:02<02:35,  3.39s/it]Best trial: 54. Best value: 0.182977:  55%|█████▌    | 55/100 [03:02<02:27,  3.29s/it]Best trial: 55. Best value: 0.18336:  55%|█████▌    | 55/100 [03:05<02:27,  3.29s/it] Best trial: 55. Best value: 0.18336:  56%|█████▌    | 56/100 [03:05<02:17,  3.12s/it]Best trial: 55. Best value: 0.18336:  56%|█████▌    | 56/100 [03:07<02:17,  3.12s/it]Best trial: 55. Best value: 0.18336:  57%|█████▋    | 57/100 [03:07<02:06,  2.95s/it]Best trial: 55. Best value: 0.18336:  57%|█████▋    | 57/100 [03:10<02:06,  2.95s/it]Best trial: 55. Best value: 0.18336:  58%|█████▊    | 58/100 [03:10<02:06,  3.01s/it]Best trial: 55. Best value: 0.18336:  58%|█████▊    | 58/100 [03:15<02:06,  3.01s/it]Best trial: 55. Best value: 0.18336:  59%|█████▉    | 59/100 [03:15<02:19,  3.40s/it]Best trial: 55. Best value: 0.18336:  59%|█████▉    | 59/100 [03:18<02:19,  3.40s/it]Best trial: 55. Best value: 0.18336:  60%|██████    | 60/100 [03:18<02:12,  3.32s/it]Best trial: 55. Best value: 0.18336:  60%|██████    | 60/100 [03:21<02:12,  3.32s/it]Best trial: 55. Best value: 0.18336:  61%|██████    | 61/100 [03:21<02:10,  3.34s/it]Best trial: 55. Best value: 0.18336:  61%|██████    | 61/100 [03:24<02:10,  3.34s/it]Best trial: 55. Best value: 0.18336:  62%|██████▏   | 62/100 [03:24<02:03,  3.26s/it]Best trial: 55. Best value: 0.18336:  62%|██████▏   | 62/100 [03:27<02:03,  3.26s/it]Best trial: 55. Best value: 0.18336:  63%|██████▎   | 63/100 [03:27<01:55,  3.13s/it]Best trial: 55. Best value: 0.18336:  63%|██████▎   | 63/100 [03:30<01:55,  3.13s/it]Best trial: 55. Best value: 0.18336:  64%|██████▍   | 64/100 [03:30<01:53,  3.16s/it]Best trial: 55. Best value: 0.18336:  64%|██████▍   | 64/100 [03:33<01:53,  3.16s/it]Best trial: 55. Best value: 0.18336:  65%|██████▌   | 65/100 [03:33<01:48,  3.10s/it]Best trial: 55. Best value: 0.18336:  65%|██████▌   | 65/100 [03:36<01:48,  3.10s/it]Best trial: 55. Best value: 0.18336:  66%|██████▌   | 66/100 [03:36<01:44,  3.08s/it]Best trial: 55. Best value: 0.18336:  66%|██████▌   | 66/100 [03:40<01:44,  3.08s/it]Best trial: 55. Best value: 0.18336:  67%|██████▋   | 67/100 [03:40<01:44,  3.17s/it]Best trial: 55. Best value: 0.18336:  67%|██████▋   | 67/100 [03:43<01:44,  3.17s/it]Best trial: 55. Best value: 0.18336:  68%|██████▊   | 68/100 [03:43<01:40,  3.13s/it]Best trial: 55. Best value: 0.18336:  68%|██████▊   | 68/100 [03:45<01:40,  3.13s/it]Best trial: 55. Best value: 0.18336:  69%|██████▉   | 69/100 [03:45<01:33,  3.02s/it]Best trial: 55. Best value: 0.18336:  69%|██████▉   | 69/100 [03:48<01:33,  3.02s/it]Best trial: 55. Best value: 0.18336:  70%|███████   | 70/100 [03:48<01:29,  2.99s/it]Best trial: 55. Best value: 0.18336:  70%|███████   | 70/100 [03:51<01:29,  2.99s/it]Best trial: 55. Best value: 0.18336:  71%|███████   | 71/100 [03:51<01:28,  3.05s/it]Best trial: 55. Best value: 0.18336:  71%|███████   | 71/100 [03:55<01:28,  3.05s/it]Best trial: 55. Best value: 0.18336:  72%|███████▏  | 72/100 [03:55<01:26,  3.08s/it]Best trial: 55. Best value: 0.18336:  72%|███████▏  | 72/100 [03:58<01:26,  3.08s/it]Best trial: 55. Best value: 0.18336:  73%|███████▎  | 73/100 [03:58<01:23,  3.11s/it]Best trial: 55. Best value: 0.18336:  73%|███████▎  | 73/100 [04:01<01:23,  3.11s/it]Best trial: 55. Best value: 0.18336:  74%|███████▍  | 74/100 [04:01<01:20,  3.10s/it]Best trial: 55. Best value: 0.18336:  74%|███████▍  | 74/100 [04:05<01:20,  3.10s/it]Best trial: 55. Best value: 0.18336:  75%|███████▌  | 75/100 [04:05<01:23,  3.35s/it]Best trial: 55. Best value: 0.18336:  75%|███████▌  | 75/100 [04:09<01:23,  3.35s/it]Best trial: 55. Best value: 0.18336:  76%|███████▌  | 76/100 [04:09<01:23,  3.48s/it]Best trial: 55. Best value: 0.18336:  76%|███████▌  | 76/100 [04:13<01:23,  3.48s/it]Best trial: 55. Best value: 0.18336:  77%|███████▋  | 77/100 [04:13<01:25,  3.72s/it]Best trial: 55. Best value: 0.18336:  77%|███████▋  | 77/100 [04:17<01:25,  3.72s/it]Best trial: 55. Best value: 0.18336:  78%|███████▊  | 78/100 [04:17<01:25,  3.90s/it]Best trial: 55. Best value: 0.18336:  78%|███████▊  | 78/100 [04:21<01:25,  3.90s/it]Best trial: 55. Best value: 0.18336:  79%|███████▉  | 79/100 [04:21<01:18,  3.72s/it]Best trial: 55. Best value: 0.18336:  79%|███████▉  | 79/100 [04:24<01:18,  3.72s/it]Best trial: 55. Best value: 0.18336:  80%|████████  | 80/100 [04:24<01:13,  3.68s/it]Best trial: 55. Best value: 0.18336:  80%|████████  | 80/100 [04:29<01:13,  3.68s/it]Best trial: 55. Best value: 0.18336:  81%|████████  | 81/100 [04:29<01:14,  3.94s/it]Best trial: 55. Best value: 0.18336:  81%|████████  | 81/100 [04:32<01:14,  3.94s/it]Best trial: 55. Best value: 0.18336:  82%|████████▏ | 82/100 [04:32<01:07,  3.75s/it]Best trial: 55. Best value: 0.18336:  82%|████████▏ | 82/100 [04:35<01:07,  3.75s/it]Best trial: 55. Best value: 0.18336:  83%|████████▎ | 83/100 [04:35<01:01,  3.63s/it]Best trial: 55. Best value: 0.18336:  83%|████████▎ | 83/100 [04:39<01:01,  3.63s/it]Best trial: 55. Best value: 0.18336:  84%|████████▍ | 84/100 [04:39<00:59,  3.71s/it]Best trial: 55. Best value: 0.18336:  84%|████████▍ | 84/100 [04:42<00:59,  3.71s/it]Best trial: 55. Best value: 0.18336:  85%|████████▌ | 85/100 [04:42<00:52,  3.47s/it]Best trial: 55. Best value: 0.18336:  85%|████████▌ | 85/100 [04:46<00:52,  3.47s/it]Best trial: 55. Best value: 0.18336:  86%|████████▌ | 86/100 [04:46<00:50,  3.62s/it]Best trial: 55. Best value: 0.18336:  86%|████████▌ | 86/100 [04:50<00:50,  3.62s/it]Best trial: 55. Best value: 0.18336:  87%|████████▋ | 87/100 [04:50<00:47,  3.63s/it]Best trial: 55. Best value: 0.18336:  87%|████████▋ | 87/100 [04:53<00:47,  3.63s/it]Best trial: 55. Best value: 0.18336:  88%|████████▊ | 88/100 [04:53<00:43,  3.62s/it]Best trial: 55. Best value: 0.18336:  88%|████████▊ | 88/100 [04:56<00:43,  3.62s/it]Best trial: 55. Best value: 0.18336:  89%|████████▉ | 89/100 [04:56<00:37,  3.41s/it]Best trial: 55. Best value: 0.18336:  89%|████████▉ | 89/100 [04:59<00:37,  3.41s/it]Best trial: 55. Best value: 0.18336:  90%|█████████ | 90/100 [04:59<00:32,  3.26s/it]Best trial: 55. Best value: 0.18336:  90%|█████████ | 90/100 [05:03<00:32,  3.26s/it]Best trial: 55. Best value: 0.18336:  91%|█████████ | 91/100 [05:03<00:30,  3.38s/it]Best trial: 55. Best value: 0.18336:  91%|█████████ | 91/100 [05:05<00:30,  3.38s/it]Best trial: 55. Best value: 0.18336:  92%|█████████▏| 92/100 [05:05<00:24,  3.12s/it]Best trial: 55. Best value: 0.18336:  92%|█████████▏| 92/100 [05:09<00:24,  3.12s/it]Best trial: 55. Best value: 0.18336:  93%|█████████▎| 93/100 [05:09<00:22,  3.24s/it]Best trial: 55. Best value: 0.18336:  93%|█████████▎| 93/100 [05:12<00:22,  3.24s/it]Best trial: 55. Best value: 0.18336:  94%|█████████▍| 94/100 [05:12<00:18,  3.15s/it]Best trial: 55. Best value: 0.18336:  94%|█████████▍| 94/100 [05:16<00:18,  3.15s/it]Best trial: 55. Best value: 0.18336:  95%|█████████▌| 95/100 [05:16<00:16,  3.36s/it]Best trial: 55. Best value: 0.18336:  95%|█████████▌| 95/100 [05:18<00:16,  3.36s/it]Best trial: 55. Best value: 0.18336:  96%|█████████▌| 96/100 [05:18<00:12,  3.18s/it]Best trial: 55. Best value: 0.18336:  96%|█████████▌| 96/100 [05:22<00:12,  3.18s/it]Best trial: 55. Best value: 0.18336:  97%|█████████▋| 97/100 [05:22<00:09,  3.28s/it]Best trial: 55. Best value: 0.18336:  97%|█████████▋| 97/100 [05:25<00:09,  3.28s/it]Best trial: 55. Best value: 0.18336:  98%|█████████▊| 98/100 [05:25<00:06,  3.17s/it]Best trial: 55. Best value: 0.18336:  98%|█████████▊| 98/100 [05:28<00:06,  3.17s/it]Best trial: 55. Best value: 0.18336:  99%|█████████▉| 99/100 [05:28<00:03,  3.11s/it]Best trial: 55. Best value: 0.18336:  99%|█████████▉| 99/100 [05:33<00:03,  3.11s/it]Best trial: 55. Best value: 0.18336: 100%|██████████| 100/100 [05:33<00:00,  3.65s/it]Best trial: 55. Best value: 0.18336: 100%|██████████| 100/100 [05:33<00:00,  3.33s/it]
2025-11-30 16:16:38,636 - INFO - HPO Complete. Best AUPRC: 0.1834
2025-11-30 16:16:38,636 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.0072653041774667915, 'max_depth': 5, 'subsample': 0.7250869509906894, 'colsample_bytree': 0.8863015790472807, 'gamma': 2.1732986010082573, 'reg_lambda': 0.001314915836669897, 'reg_alpha': 1.0248265854316461e-08}
2025-11-30 16:16:38,637 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:16:40,528 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: monitors_only
2025-11-30 16:16:40,528 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:16:40,728 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:16:40,765 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:16:40,772 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 16:16:40,773 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:16:40,773 - INFO - Training model...
2025-11-30 16:16:44,625 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:16:50,098 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:16:50,098 - INFO - AUROC: 0.5872 (0.3994 - 0.7889)
2025-11-30 16:16:50,098 - INFO - AUPRC: 0.0127 (0.0048 - 0.0337)
2025-11-30 16:16:50,098 - INFO - Brier Score: 0.0110 (0.0066 - 0.0179)
2025-11-30 16:16:50,098 - INFO - Accuracy: 0.8916 (0.4957 - 0.9116)
2025-11-30 16:16:50,098 - INFO - Precision: 0.0141 (0.0000 - 0.0408)
2025-11-30 16:16:50,098 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.8800)
2025-11-30 16:16:50,099 - INFO - F1-Score: 0.0260 (0.0000 - 0.0747)
2025-11-30 16:16:50,099 - INFO - Best Threshold: 0.0500 (0.0100 - 0.0500)
2025-11-30 16:16:50,099 - INFO - Specificity: 0.8980 (0.4972 - 0.9173)
2025-11-30 16:16:50,113 - INFO - Calculating SHAP values...
2025-11-30 16:16:51,264 - INFO - SHAP plots saved.
2025-11-30 16:16:51,265 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:16:52,705 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 16:16:52,705 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:16:52,922 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:16:52,959 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:16:52,967 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:16:52,968 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0952232:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.0952232:   1%|          | 1/100 [00:02<03:26,  2.09s/it]Best trial: 1. Best value: 0.140484:   1%|          | 1/100 [00:05<03:26,  2.09s/it] Best trial: 1. Best value: 0.140484:   2%|▏         | 2/100 [00:05<04:22,  2.68s/it]Best trial: 1. Best value: 0.140484:   2%|▏         | 2/100 [00:07<04:22,  2.68s/it]Best trial: 1. Best value: 0.140484:   3%|▎         | 3/100 [00:07<04:04,  2.52s/it]Best trial: 1. Best value: 0.140484:   3%|▎         | 3/100 [00:10<04:04,  2.52s/it]Best trial: 1. Best value: 0.140484:   4%|▍         | 4/100 [00:10<04:19,  2.70s/it]Best trial: 4. Best value: 0.174119:   4%|▍         | 4/100 [00:13<04:19,  2.70s/it]Best trial: 4. Best value: 0.174119:   5%|▌         | 5/100 [00:13<04:19,  2.73s/it]Best trial: 4. Best value: 0.174119:   5%|▌         | 5/100 [00:15<04:19,  2.73s/it]Best trial: 4. Best value: 0.174119:   6%|▌         | 6/100 [00:15<04:04,  2.60s/it]Best trial: 4. Best value: 0.174119:   6%|▌         | 6/100 [00:18<04:04,  2.60s/it]Best trial: 4. Best value: 0.174119:   7%|▋         | 7/100 [00:18<04:05,  2.64s/it]Best trial: 4. Best value: 0.174119:   7%|▋         | 7/100 [00:22<04:05,  2.64s/it]Best trial: 4. Best value: 0.174119:   8%|▊         | 8/100 [00:22<04:53,  3.19s/it]Best trial: 4. Best value: 0.174119:   8%|▊         | 8/100 [00:25<04:53,  3.19s/it]Best trial: 4. Best value: 0.174119:   9%|▉         | 9/100 [00:25<04:39,  3.07s/it]Best trial: 4. Best value: 0.174119:   9%|▉         | 9/100 [00:28<04:39,  3.07s/it]Best trial: 4. Best value: 0.174119:  10%|█         | 10/100 [00:28<04:33,  3.04s/it]Best trial: 4. Best value: 0.174119:  10%|█         | 10/100 [00:32<04:33,  3.04s/it]Best trial: 4. Best value: 0.174119:  11%|█         | 11/100 [00:32<04:51,  3.28s/it]Best trial: 4. Best value: 0.174119:  11%|█         | 11/100 [00:35<04:51,  3.28s/it]Best trial: 4. Best value: 0.174119:  12%|█▏        | 12/100 [00:35<04:40,  3.19s/it]Best trial: 12. Best value: 0.206033:  12%|█▏        | 12/100 [00:38<04:40,  3.19s/it]Best trial: 12. Best value: 0.206033:  13%|█▎        | 13/100 [00:38<04:33,  3.14s/it]Best trial: 12. Best value: 0.206033:  13%|█▎        | 13/100 [00:42<04:33,  3.14s/it]Best trial: 12. Best value: 0.206033:  14%|█▍        | 14/100 [00:42<04:46,  3.34s/it]Best trial: 12. Best value: 0.206033:  14%|█▍        | 14/100 [00:44<04:46,  3.34s/it]Best trial: 12. Best value: 0.206033:  15%|█▌        | 15/100 [00:44<04:15,  3.01s/it]Best trial: 12. Best value: 0.206033:  15%|█▌        | 15/100 [00:46<04:15,  3.01s/it]Best trial: 12. Best value: 0.206033:  16%|█▌        | 16/100 [00:46<04:02,  2.89s/it]Best trial: 12. Best value: 0.206033:  16%|█▌        | 16/100 [00:49<04:02,  2.89s/it]Best trial: 12. Best value: 0.206033:  17%|█▋        | 17/100 [00:49<03:54,  2.82s/it]Best trial: 12. Best value: 0.206033:  17%|█▋        | 17/100 [00:52<03:54,  2.82s/it]Best trial: 12. Best value: 0.206033:  18%|█▊        | 18/100 [00:52<03:58,  2.91s/it]Best trial: 12. Best value: 0.206033:  18%|█▊        | 18/100 [00:55<03:58,  2.91s/it]Best trial: 12. Best value: 0.206033:  19%|█▉        | 19/100 [00:55<03:44,  2.77s/it]Best trial: 12. Best value: 0.206033:  19%|█▉        | 19/100 [00:57<03:44,  2.77s/it]Best trial: 12. Best value: 0.206033:  20%|██        | 20/100 [00:57<03:31,  2.65s/it]Best trial: 12. Best value: 0.206033:  20%|██        | 20/100 [01:00<03:31,  2.65s/it]Best trial: 12. Best value: 0.206033:  21%|██        | 21/100 [01:00<03:25,  2.60s/it]Best trial: 12. Best value: 0.206033:  21%|██        | 21/100 [01:02<03:25,  2.60s/it]Best trial: 12. Best value: 0.206033:  22%|██▏       | 22/100 [01:02<03:22,  2.59s/it]Best trial: 12. Best value: 0.206033:  22%|██▏       | 22/100 [01:05<03:22,  2.59s/it]Best trial: 12. Best value: 0.206033:  23%|██▎       | 23/100 [01:05<03:18,  2.58s/it]Best trial: 12. Best value: 0.206033:  23%|██▎       | 23/100 [01:07<03:18,  2.58s/it]Best trial: 12. Best value: 0.206033:  24%|██▍       | 24/100 [01:07<03:19,  2.62s/it]Best trial: 12. Best value: 0.206033:  24%|██▍       | 24/100 [01:11<03:19,  2.62s/it]Best trial: 12. Best value: 0.206033:  25%|██▌       | 25/100 [01:11<03:34,  2.87s/it]Best trial: 12. Best value: 0.206033:  25%|██▌       | 25/100 [01:13<03:34,  2.87s/it]Best trial: 12. Best value: 0.206033:  26%|██▌       | 26/100 [01:13<03:19,  2.70s/it]Best trial: 12. Best value: 0.206033:  26%|██▌       | 26/100 [01:15<03:19,  2.70s/it]Best trial: 12. Best value: 0.206033:  27%|██▋       | 27/100 [01:15<03:08,  2.58s/it]Best trial: 12. Best value: 0.206033:  27%|██▋       | 27/100 [01:19<03:08,  2.58s/it]Best trial: 12. Best value: 0.206033:  28%|██▊       | 28/100 [01:19<03:22,  2.81s/it]Best trial: 12. Best value: 0.206033:  28%|██▊       | 28/100 [01:21<03:22,  2.81s/it]Best trial: 12. Best value: 0.206033:  29%|██▉       | 29/100 [01:21<03:09,  2.68s/it]Best trial: 12. Best value: 0.206033:  29%|██▉       | 29/100 [01:24<03:09,  2.68s/it]Best trial: 12. Best value: 0.206033:  30%|███       | 30/100 [01:24<03:02,  2.61s/it]Best trial: 12. Best value: 0.206033:  30%|███       | 30/100 [01:27<03:02,  2.61s/it]Best trial: 12. Best value: 0.206033:  31%|███       | 31/100 [01:27<03:13,  2.80s/it]Best trial: 12. Best value: 0.206033:  31%|███       | 31/100 [01:29<03:13,  2.80s/it]Best trial: 12. Best value: 0.206033:  32%|███▏      | 32/100 [01:29<03:02,  2.69s/it]Best trial: 12. Best value: 0.206033:  32%|███▏      | 32/100 [01:32<03:02,  2.69s/it]Best trial: 12. Best value: 0.206033:  33%|███▎      | 33/100 [01:32<02:55,  2.61s/it]Best trial: 12. Best value: 0.206033:  33%|███▎      | 33/100 [01:34<02:55,  2.61s/it]Best trial: 12. Best value: 0.206033:  34%|███▍      | 34/100 [01:34<02:42,  2.46s/it]Best trial: 12. Best value: 0.206033:  34%|███▍      | 34/100 [01:36<02:42,  2.46s/it]Best trial: 12. Best value: 0.206033:  35%|███▌      | 35/100 [01:36<02:44,  2.52s/it]Best trial: 12. Best value: 0.206033:  35%|███▌      | 35/100 [01:40<02:44,  2.52s/it]Best trial: 12. Best value: 0.206033:  36%|███▌      | 36/100 [01:40<02:54,  2.72s/it]Best trial: 12. Best value: 0.206033:  36%|███▌      | 36/100 [01:42<02:54,  2.72s/it]Best trial: 12. Best value: 0.206033:  37%|███▋      | 37/100 [01:42<02:43,  2.59s/it]Best trial: 12. Best value: 0.206033:  37%|███▋      | 37/100 [01:46<02:43,  2.59s/it]Best trial: 12. Best value: 0.206033:  38%|███▊      | 38/100 [01:46<03:05,  3.00s/it]Best trial: 12. Best value: 0.206033:  38%|███▊      | 38/100 [01:50<03:05,  3.00s/it]Best trial: 12. Best value: 0.206033:  39%|███▉      | 39/100 [01:50<03:24,  3.35s/it]Best trial: 12. Best value: 0.206033:  39%|███▉      | 39/100 [01:53<03:24,  3.35s/it]Best trial: 12. Best value: 0.206033:  40%|████      | 40/100 [01:53<03:15,  3.25s/it]Best trial: 12. Best value: 0.206033:  40%|████      | 40/100 [01:56<03:15,  3.25s/it]Best trial: 12. Best value: 0.206033:  41%|████      | 41/100 [01:56<02:58,  3.02s/it]Best trial: 12. Best value: 0.206033:  41%|████      | 41/100 [01:58<02:58,  3.02s/it]Best trial: 12. Best value: 0.206033:  42%|████▏     | 42/100 [01:58<02:39,  2.75s/it]Best trial: 42. Best value: 0.207737:  42%|████▏     | 42/100 [02:01<02:39,  2.75s/it]Best trial: 42. Best value: 0.207737:  43%|████▎     | 43/100 [02:01<02:37,  2.77s/it]Best trial: 43. Best value: 0.214542:  43%|████▎     | 43/100 [02:03<02:37,  2.77s/it]Best trial: 43. Best value: 0.214542:  44%|████▍     | 44/100 [02:03<02:35,  2.78s/it]Best trial: 43. Best value: 0.214542:  44%|████▍     | 44/100 [02:06<02:35,  2.78s/it]Best trial: 43. Best value: 0.214542:  45%|████▌     | 45/100 [02:06<02:37,  2.86s/it]Best trial: 45. Best value: 0.214575:  45%|████▌     | 45/100 [02:10<02:37,  2.86s/it]Best trial: 45. Best value: 0.214575:  46%|████▌     | 46/100 [02:10<02:39,  2.95s/it]Best trial: 45. Best value: 0.214575:  46%|████▌     | 46/100 [02:12<02:39,  2.95s/it]Best trial: 45. Best value: 0.214575:  47%|████▋     | 47/100 [02:12<02:22,  2.68s/it]Best trial: 47. Best value: 0.241859:  47%|████▋     | 47/100 [02:14<02:22,  2.68s/it]Best trial: 47. Best value: 0.241859:  48%|████▊     | 48/100 [02:14<02:20,  2.71s/it]Best trial: 47. Best value: 0.241859:  48%|████▊     | 48/100 [02:17<02:20,  2.71s/it]Best trial: 47. Best value: 0.241859:  49%|████▉     | 49/100 [02:17<02:13,  2.61s/it]Best trial: 47. Best value: 0.241859:  49%|████▉     | 49/100 [02:19<02:13,  2.61s/it]Best trial: 47. Best value: 0.241859:  50%|█████     | 50/100 [02:19<02:02,  2.45s/it]Best trial: 47. Best value: 0.241859:  50%|█████     | 50/100 [02:21<02:02,  2.45s/it]Best trial: 47. Best value: 0.241859:  51%|█████     | 51/100 [02:21<02:01,  2.47s/it]Best trial: 47. Best value: 0.241859:  51%|█████     | 51/100 [02:23<02:01,  2.47s/it]Best trial: 47. Best value: 0.241859:  52%|█████▏    | 52/100 [02:23<01:52,  2.35s/it]Best trial: 52. Best value: 0.243042:  52%|█████▏    | 52/100 [02:26<01:52,  2.35s/it]Best trial: 52. Best value: 0.243042:  53%|█████▎    | 53/100 [02:26<02:00,  2.57s/it]Best trial: 52. Best value: 0.243042:  53%|█████▎    | 53/100 [02:30<02:00,  2.57s/it]Best trial: 52. Best value: 0.243042:  54%|█████▍    | 54/100 [02:30<02:05,  2.73s/it]Best trial: 52. Best value: 0.243042:  54%|█████▍    | 54/100 [02:33<02:05,  2.73s/it]Best trial: 52. Best value: 0.243042:  55%|█████▌    | 55/100 [02:33<02:06,  2.80s/it]Best trial: 52. Best value: 0.243042:  55%|█████▌    | 55/100 [02:35<02:06,  2.80s/it]Best trial: 52. Best value: 0.243042:  56%|█████▌    | 56/100 [02:35<02:02,  2.78s/it]Best trial: 52. Best value: 0.243042:  56%|█████▌    | 56/100 [02:38<02:02,  2.78s/it]Best trial: 52. Best value: 0.243042:  57%|█████▋    | 57/100 [02:38<01:59,  2.77s/it]Best trial: 52. Best value: 0.243042:  57%|█████▋    | 57/100 [02:41<01:59,  2.77s/it]Best trial: 52. Best value: 0.243042:  58%|█████▊    | 58/100 [02:41<01:58,  2.82s/it]Best trial: 52. Best value: 0.243042:  58%|█████▊    | 58/100 [02:43<01:58,  2.82s/it]Best trial: 52. Best value: 0.243042:  59%|█████▉    | 59/100 [02:43<01:49,  2.67s/it]Best trial: 52. Best value: 0.243042:  59%|█████▉    | 59/100 [02:46<01:49,  2.67s/it]Best trial: 52. Best value: 0.243042:  60%|██████    | 60/100 [02:46<01:43,  2.58s/it]Best trial: 52. Best value: 0.243042:  60%|██████    | 60/100 [02:48<01:43,  2.58s/it]Best trial: 52. Best value: 0.243042:  61%|██████    | 61/100 [02:48<01:42,  2.62s/it]Best trial: 52. Best value: 0.243042:  61%|██████    | 61/100 [02:51<01:42,  2.62s/it]Best trial: 52. Best value: 0.243042:  62%|██████▏   | 62/100 [02:51<01:44,  2.75s/it]Best trial: 52. Best value: 0.243042:  62%|██████▏   | 62/100 [02:54<01:44,  2.75s/it]Best trial: 52. Best value: 0.243042:  63%|██████▎   | 63/100 [02:54<01:39,  2.70s/it]Best trial: 52. Best value: 0.243042:  63%|██████▎   | 63/100 [02:58<01:39,  2.70s/it]Best trial: 52. Best value: 0.243042:  64%|██████▍   | 64/100 [02:58<01:48,  3.00s/it]Best trial: 52. Best value: 0.243042:  64%|██████▍   | 64/100 [03:00<01:48,  3.00s/it]Best trial: 52. Best value: 0.243042:  65%|██████▌   | 65/100 [03:00<01:37,  2.78s/it]Best trial: 52. Best value: 0.243042:  65%|██████▌   | 65/100 [03:03<01:37,  2.78s/it]Best trial: 52. Best value: 0.243042:  66%|██████▌   | 66/100 [03:03<01:37,  2.86s/it]Best trial: 52. Best value: 0.243042:  66%|██████▌   | 66/100 [03:06<01:37,  2.86s/it]Best trial: 52. Best value: 0.243042:  67%|██████▋   | 67/100 [03:06<01:35,  2.89s/it]Best trial: 52. Best value: 0.243042:  67%|██████▋   | 67/100 [03:08<01:35,  2.89s/it]Best trial: 52. Best value: 0.243042:  68%|██████▊   | 68/100 [03:08<01:27,  2.74s/it]Best trial: 52. Best value: 0.243042:  68%|██████▊   | 68/100 [03:11<01:27,  2.74s/it]Best trial: 52. Best value: 0.243042:  69%|██████▉   | 69/100 [03:11<01:26,  2.80s/it]Best trial: 52. Best value: 0.243042:  69%|██████▉   | 69/100 [03:14<01:26,  2.80s/it]Best trial: 52. Best value: 0.243042:  70%|███████   | 70/100 [03:14<01:21,  2.73s/it]Best trial: 52. Best value: 0.243042:  70%|███████   | 70/100 [03:16<01:21,  2.73s/it]Best trial: 52. Best value: 0.243042:  71%|███████   | 71/100 [03:16<01:18,  2.69s/it]Best trial: 52. Best value: 0.243042:  71%|███████   | 71/100 [03:18<01:18,  2.69s/it]Best trial: 52. Best value: 0.243042:  72%|███████▏  | 72/100 [03:18<01:09,  2.48s/it]Best trial: 52. Best value: 0.243042:  72%|███████▏  | 72/100 [03:21<01:09,  2.48s/it]Best trial: 52. Best value: 0.243042:  73%|███████▎  | 73/100 [03:21<01:10,  2.61s/it]Best trial: 52. Best value: 0.243042:  73%|███████▎  | 73/100 [03:23<01:10,  2.61s/it]Best trial: 52. Best value: 0.243042:  74%|███████▍  | 74/100 [03:23<01:01,  2.37s/it]Best trial: 52. Best value: 0.243042:  74%|███████▍  | 74/100 [03:25<01:01,  2.37s/it]Best trial: 52. Best value: 0.243042:  75%|███████▌  | 75/100 [03:25<00:55,  2.23s/it]Best trial: 52. Best value: 0.243042:  75%|███████▌  | 75/100 [03:28<00:55,  2.23s/it]Best trial: 52. Best value: 0.243042:  76%|███████▌  | 76/100 [03:28<00:57,  2.40s/it]Best trial: 52. Best value: 0.243042:  76%|███████▌  | 76/100 [03:30<00:57,  2.40s/it]Best trial: 52. Best value: 0.243042:  77%|███████▋  | 77/100 [03:30<00:54,  2.39s/it]Best trial: 52. Best value: 0.243042:  77%|███████▋  | 77/100 [03:32<00:54,  2.39s/it]Best trial: 52. Best value: 0.243042:  78%|███████▊  | 78/100 [03:32<00:50,  2.31s/it]Best trial: 52. Best value: 0.243042:  78%|███████▊  | 78/100 [03:35<00:50,  2.31s/it]Best trial: 52. Best value: 0.243042:  79%|███████▉  | 79/100 [03:35<00:51,  2.47s/it]Best trial: 52. Best value: 0.243042:  79%|███████▉  | 79/100 [03:37<00:51,  2.47s/it]Best trial: 52. Best value: 0.243042:  80%|████████  | 80/100 [03:37<00:48,  2.41s/it]Best trial: 52. Best value: 0.243042:  80%|████████  | 80/100 [03:41<00:48,  2.41s/it]Best trial: 52. Best value: 0.243042:  81%|████████  | 81/100 [03:41<00:50,  2.65s/it]Best trial: 52. Best value: 0.243042:  81%|████████  | 81/100 [03:43<00:50,  2.65s/it]Best trial: 52. Best value: 0.243042:  82%|████████▏ | 82/100 [03:43<00:43,  2.44s/it]Best trial: 52. Best value: 0.243042:  82%|████████▏ | 82/100 [03:45<00:43,  2.44s/it]Best trial: 52. Best value: 0.243042:  83%|████████▎ | 83/100 [03:45<00:42,  2.52s/it]Best trial: 52. Best value: 0.243042:  83%|████████▎ | 83/100 [03:48<00:42,  2.52s/it]Best trial: 52. Best value: 0.243042:  84%|████████▍ | 84/100 [03:48<00:39,  2.45s/it]Best trial: 52. Best value: 0.243042:  84%|████████▍ | 84/100 [03:50<00:39,  2.45s/it]Best trial: 52. Best value: 0.243042:  85%|████████▌ | 85/100 [03:50<00:35,  2.34s/it]Best trial: 52. Best value: 0.243042:  85%|████████▌ | 85/100 [03:52<00:35,  2.34s/it]Best trial: 52. Best value: 0.243042:  86%|████████▌ | 86/100 [03:52<00:34,  2.45s/it]Best trial: 52. Best value: 0.243042:  86%|████████▌ | 86/100 [03:54<00:34,  2.45s/it]Best trial: 52. Best value: 0.243042:  87%|████████▋ | 87/100 [03:54<00:29,  2.29s/it]Best trial: 52. Best value: 0.243042:  87%|████████▋ | 87/100 [03:57<00:29,  2.29s/it]Best trial: 52. Best value: 0.243042:  88%|████████▊ | 88/100 [03:57<00:29,  2.42s/it]Best trial: 52. Best value: 0.243042:  88%|████████▊ | 88/100 [04:00<00:29,  2.42s/it]Best trial: 52. Best value: 0.243042:  89%|████████▉ | 89/100 [04:00<00:28,  2.55s/it]Best trial: 52. Best value: 0.243042:  89%|████████▉ | 89/100 [04:04<00:28,  2.55s/it]Best trial: 52. Best value: 0.243042:  90%|█████████ | 90/100 [04:04<00:28,  2.90s/it]Best trial: 52. Best value: 0.243042:  90%|█████████ | 90/100 [04:06<00:28,  2.90s/it]Best trial: 52. Best value: 0.243042:  91%|█████████ | 91/100 [04:06<00:23,  2.66s/it]Best trial: 52. Best value: 0.243042:  91%|█████████ | 91/100 [04:09<00:23,  2.66s/it]Best trial: 52. Best value: 0.243042:  92%|█████████▏| 92/100 [04:09<00:23,  2.95s/it]Best trial: 52. Best value: 0.243042:  92%|█████████▏| 92/100 [04:13<00:23,  2.95s/it]Best trial: 52. Best value: 0.243042:  93%|█████████▎| 93/100 [04:13<00:21,  3.04s/it]Best trial: 52. Best value: 0.243042:  93%|█████████▎| 93/100 [04:14<00:21,  3.04s/it]Best trial: 52. Best value: 0.243042:  94%|█████████▍| 94/100 [04:14<00:15,  2.67s/it]Best trial: 52. Best value: 0.243042:  94%|█████████▍| 94/100 [04:17<00:15,  2.67s/it]Best trial: 52. Best value: 0.243042:  95%|█████████▌| 95/100 [04:17<00:13,  2.76s/it]Best trial: 52. Best value: 0.243042:  95%|█████████▌| 95/100 [04:20<00:13,  2.76s/it]Best trial: 52. Best value: 0.243042:  96%|█████████▌| 96/100 [04:20<00:10,  2.72s/it]Best trial: 52. Best value: 0.243042:  96%|█████████▌| 96/100 [04:23<00:10,  2.72s/it]Best trial: 52. Best value: 0.243042:  97%|█████████▋| 97/100 [04:23<00:08,  2.77s/it]Best trial: 52. Best value: 0.243042:  97%|█████████▋| 97/100 [04:25<00:08,  2.77s/it]Best trial: 52. Best value: 0.243042:  98%|█████████▊| 98/100 [04:25<00:05,  2.72s/it]Best trial: 52. Best value: 0.243042:  98%|█████████▊| 98/100 [04:28<00:05,  2.72s/it]Best trial: 52. Best value: 0.243042:  99%|█████████▉| 99/100 [04:28<00:02,  2.54s/it]Best trial: 52. Best value: 0.243042:  99%|█████████▉| 99/100 [04:31<00:02,  2.54s/it]Best trial: 52. Best value: 0.243042: 100%|██████████| 100/100 [04:31<00:00,  2.83s/it]Best trial: 52. Best value: 0.243042: 100%|██████████| 100/100 [04:31<00:00,  2.72s/it]
2025-11-30 16:21:24,581 - INFO - HPO Complete. Best AUPRC: 0.2430
2025-11-30 16:21:24,581 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.00023232277070832748, 'max_depth': 3, 'subsample': 0.6143962132276345, 'colsample_bytree': 0.6240010055845756, 'gamma': 1.5710542810732164, 'reg_lambda': 2.023155032745699e-07, 'reg_alpha': 0.06869869579115655}
2025-11-30 16:21:24,582 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:21:26,585 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 16:21:26,586 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:21:26,811 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:21:26,849 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:21:26,857 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:21:26,857 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:21:26,857 - INFO - Training model...
2025-11-30 16:21:28,941 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:21:34,556 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:21:34,556 - INFO - AUROC: 0.7111 (0.5183 - 0.8914)
2025-11-30 16:21:34,556 - INFO - AUPRC: 0.0437 (0.0068 - 0.2264)
2025-11-30 16:21:34,556 - INFO - Brier Score: 0.1964 (0.1953 - 0.1982)
2025-11-30 16:21:34,556 - INFO - Accuracy: 0.9855 (0.4040 - 0.9896)
2025-11-30 16:21:34,556 - INFO - Precision: 0.1667 (0.0070 - 0.8500)
2025-11-30 16:21:34,556 - INFO - Sensitivity (Recall): 0.1667 (0.0964 - 1.0000)
2025-11-30 16:21:34,556 - INFO - F1-Score: 0.1667 (0.0140 - 0.4286)
2025-11-30 16:21:34,556 - INFO - Best Threshold: 0.5000 (0.4300 - 0.5000)
2025-11-30 16:21:34,556 - INFO - Specificity: 0.9927 (0.3971 - 0.9991)
2025-11-30 16:21:34,570 - INFO - Calculating SHAP values...
2025-11-30 16:21:35,700 - INFO - SHAP plots saved.
2025-11-30 16:21:35,703 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:21:37,124 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 16:21:37,124 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:21:37,350 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:21:37,388 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:21:37,397 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:21:37,397 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.22011:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.22011:   1%|          | 1/100 [00:02<03:28,  2.11s/it]Best trial: 1. Best value: 0.221567:   1%|          | 1/100 [00:04<03:28,  2.11s/it]Best trial: 1. Best value: 0.221567:   2%|▏         | 2/100 [00:04<04:00,  2.45s/it]Best trial: 2. Best value: 0.228719:   2%|▏         | 2/100 [00:07<04:00,  2.45s/it]Best trial: 2. Best value: 0.228719:   3%|▎         | 3/100 [00:07<04:04,  2.52s/it]Best trial: 2. Best value: 0.228719:   3%|▎         | 3/100 [00:10<04:04,  2.52s/it]Best trial: 2. Best value: 0.228719:   4%|▍         | 4/100 [00:10<04:07,  2.58s/it]Best trial: 2. Best value: 0.228719:   4%|▍         | 4/100 [00:12<04:07,  2.58s/it]Best trial: 2. Best value: 0.228719:   5%|▌         | 5/100 [00:12<04:01,  2.54s/it]Best trial: 2. Best value: 0.228719:   5%|▌         | 5/100 [00:14<04:01,  2.54s/it]Best trial: 2. Best value: 0.228719:   6%|▌         | 6/100 [00:14<03:55,  2.51s/it]Best trial: 2. Best value: 0.228719:   6%|▌         | 6/100 [00:17<03:55,  2.51s/it]Best trial: 2. Best value: 0.228719:   7%|▋         | 7/100 [00:17<03:49,  2.47s/it]Best trial: 2. Best value: 0.228719:   7%|▋         | 7/100 [00:20<03:49,  2.47s/it]Best trial: 2. Best value: 0.228719:   8%|▊         | 8/100 [00:20<04:09,  2.71s/it]Best trial: 8. Best value: 0.241185:   8%|▊         | 8/100 [00:22<04:09,  2.71s/it]Best trial: 8. Best value: 0.241185:   9%|▉         | 9/100 [00:22<03:37,  2.39s/it]Best trial: 8. Best value: 0.241185:   9%|▉         | 9/100 [00:25<03:37,  2.39s/it]Best trial: 8. Best value: 0.241185:  10%|█         | 10/100 [00:25<03:44,  2.49s/it]Best trial: 8. Best value: 0.241185:  10%|█         | 10/100 [00:27<03:44,  2.49s/it]Best trial: 8. Best value: 0.241185:  11%|█         | 11/100 [00:27<03:38,  2.46s/it]Best trial: 8. Best value: 0.241185:  11%|█         | 11/100 [00:29<03:38,  2.46s/it]Best trial: 8. Best value: 0.241185:  12%|█▏        | 12/100 [00:29<03:27,  2.36s/it]Best trial: 8. Best value: 0.241185:  12%|█▏        | 12/100 [00:31<03:27,  2.36s/it]Best trial: 8. Best value: 0.241185:  13%|█▎        | 13/100 [00:31<03:23,  2.33s/it]Best trial: 8. Best value: 0.241185:  13%|█▎        | 13/100 [00:34<03:23,  2.33s/it]Best trial: 8. Best value: 0.241185:  14%|█▍        | 14/100 [00:34<03:25,  2.39s/it]Best trial: 8. Best value: 0.241185:  14%|█▍        | 14/100 [00:38<03:25,  2.39s/it]Best trial: 8. Best value: 0.241185:  15%|█▌        | 15/100 [00:38<03:58,  2.80s/it]Best trial: 8. Best value: 0.241185:  15%|█▌        | 15/100 [00:40<03:58,  2.80s/it]Best trial: 8. Best value: 0.241185:  16%|█▌        | 16/100 [00:40<03:44,  2.67s/it]Best trial: 8. Best value: 0.241185:  16%|█▌        | 16/100 [00:42<03:44,  2.67s/it]Best trial: 8. Best value: 0.241185:  17%|█▋        | 17/100 [00:42<03:35,  2.60s/it]Best trial: 17. Best value: 0.258333:  17%|█▋        | 17/100 [00:46<03:35,  2.60s/it]Best trial: 17. Best value: 0.258333:  18%|█▊        | 18/100 [00:46<03:56,  2.88s/it]Best trial: 17. Best value: 0.258333:  18%|█▊        | 18/100 [00:48<03:56,  2.88s/it]Best trial: 17. Best value: 0.258333:  19%|█▉        | 19/100 [00:48<03:31,  2.61s/it]Best trial: 17. Best value: 0.258333:  19%|█▉        | 19/100 [00:50<03:31,  2.61s/it]Best trial: 17. Best value: 0.258333:  20%|██        | 20/100 [00:50<03:21,  2.52s/it]Best trial: 17. Best value: 0.258333:  20%|██        | 20/100 [00:52<03:21,  2.52s/it]Best trial: 17. Best value: 0.258333:  21%|██        | 21/100 [00:52<03:02,  2.31s/it]Best trial: 17. Best value: 0.258333:  21%|██        | 21/100 [00:54<03:02,  2.31s/it]Best trial: 17. Best value: 0.258333:  22%|██▏       | 22/100 [00:54<02:51,  2.20s/it]Best trial: 17. Best value: 0.258333:  22%|██▏       | 22/100 [00:56<02:51,  2.20s/it]Best trial: 17. Best value: 0.258333:  23%|██▎       | 23/100 [00:56<02:55,  2.28s/it]Best trial: 23. Best value: 0.293331:  23%|██▎       | 23/100 [00:59<02:55,  2.28s/it]Best trial: 23. Best value: 0.293331:  24%|██▍       | 24/100 [00:59<02:53,  2.28s/it]Best trial: 23. Best value: 0.293331:  24%|██▍       | 24/100 [01:01<02:53,  2.28s/it]Best trial: 23. Best value: 0.293331:  25%|██▌       | 25/100 [01:01<02:47,  2.23s/it]Best trial: 23. Best value: 0.293331:  25%|██▌       | 25/100 [01:04<02:47,  2.23s/it]Best trial: 23. Best value: 0.293331:  26%|██▌       | 26/100 [01:04<02:55,  2.38s/it]Best trial: 23. Best value: 0.293331:  26%|██▌       | 26/100 [01:06<02:55,  2.38s/it]Best trial: 23. Best value: 0.293331:  27%|██▋       | 27/100 [01:06<02:49,  2.32s/it]Best trial: 23. Best value: 0.293331:  27%|██▋       | 27/100 [01:08<02:49,  2.32s/it]Best trial: 23. Best value: 0.293331:  28%|██▊       | 28/100 [01:08<02:39,  2.21s/it]Best trial: 23. Best value: 0.293331:  28%|██▊       | 28/100 [01:10<02:39,  2.21s/it]Best trial: 23. Best value: 0.293331:  29%|██▉       | 29/100 [01:10<02:38,  2.24s/it]Best trial: 23. Best value: 0.293331:  29%|██▉       | 29/100 [01:13<02:38,  2.24s/it]Best trial: 23. Best value: 0.293331:  30%|███       | 30/100 [01:13<02:49,  2.41s/it]Best trial: 23. Best value: 0.293331:  30%|███       | 30/100 [01:15<02:49,  2.41s/it]Best trial: 23. Best value: 0.293331:  31%|███       | 31/100 [01:15<02:41,  2.34s/it]Best trial: 23. Best value: 0.293331:  31%|███       | 31/100 [01:18<02:41,  2.34s/it]Best trial: 23. Best value: 0.293331:  32%|███▏      | 32/100 [01:18<02:45,  2.43s/it]Best trial: 23. Best value: 0.293331:  32%|███▏      | 32/100 [01:20<02:45,  2.43s/it]Best trial: 23. Best value: 0.293331:  33%|███▎      | 33/100 [01:20<02:33,  2.28s/it]Best trial: 23. Best value: 0.293331:  33%|███▎      | 33/100 [01:23<02:33,  2.28s/it]Best trial: 23. Best value: 0.293331:  34%|███▍      | 34/100 [01:23<02:54,  2.64s/it]Best trial: 23. Best value: 0.293331:  34%|███▍      | 34/100 [01:25<02:54,  2.64s/it]Best trial: 23. Best value: 0.293331:  35%|███▌      | 35/100 [01:25<02:47,  2.58s/it]Best trial: 23. Best value: 0.293331:  35%|███▌      | 35/100 [01:28<02:47,  2.58s/it]Best trial: 23. Best value: 0.293331:  36%|███▌      | 36/100 [01:28<02:39,  2.49s/it]Best trial: 23. Best value: 0.293331:  36%|███▌      | 36/100 [01:30<02:39,  2.49s/it]Best trial: 23. Best value: 0.293331:  37%|███▋      | 37/100 [01:30<02:33,  2.43s/it]Best trial: 23. Best value: 0.293331:  37%|███▋      | 37/100 [01:33<02:33,  2.43s/it]Best trial: 23. Best value: 0.293331:  38%|███▊      | 38/100 [01:33<02:31,  2.45s/it]Best trial: 23. Best value: 0.293331:  38%|███▊      | 38/100 [01:35<02:31,  2.45s/it]Best trial: 23. Best value: 0.293331:  39%|███▉      | 39/100 [01:35<02:32,  2.51s/it]Best trial: 23. Best value: 0.293331:  39%|███▉      | 39/100 [01:37<02:32,  2.51s/it]Best trial: 23. Best value: 0.293331:  40%|████      | 40/100 [01:37<02:24,  2.41s/it]Best trial: 23. Best value: 0.293331:  40%|████      | 40/100 [01:40<02:24,  2.41s/it]Best trial: 23. Best value: 0.293331:  41%|████      | 41/100 [01:40<02:19,  2.36s/it]Best trial: 23. Best value: 0.293331:  41%|████      | 41/100 [01:41<02:19,  2.36s/it]Best trial: 23. Best value: 0.293331:  42%|████▏     | 42/100 [01:41<02:04,  2.15s/it]Best trial: 23. Best value: 0.293331:  42%|████▏     | 42/100 [01:43<02:04,  2.15s/it]Best trial: 23. Best value: 0.293331:  43%|████▎     | 43/100 [01:43<02:01,  2.13s/it]Best trial: 23. Best value: 0.293331:  43%|████▎     | 43/100 [01:45<02:01,  2.13s/it]Best trial: 23. Best value: 0.293331:  44%|████▍     | 44/100 [01:45<01:57,  2.10s/it]Best trial: 23. Best value: 0.293331:  44%|████▍     | 44/100 [01:48<01:57,  2.10s/it]Best trial: 23. Best value: 0.293331:  45%|████▌     | 45/100 [01:48<01:59,  2.16s/it]Best trial: 23. Best value: 0.293331:  45%|████▌     | 45/100 [01:50<01:59,  2.16s/it]Best trial: 23. Best value: 0.293331:  46%|████▌     | 46/100 [01:50<01:52,  2.08s/it]Best trial: 23. Best value: 0.293331:  46%|████▌     | 46/100 [01:52<01:52,  2.08s/it]Best trial: 23. Best value: 0.293331:  47%|████▋     | 47/100 [01:52<01:56,  2.20s/it]Best trial: 23. Best value: 0.293331:  47%|████▋     | 47/100 [01:55<01:56,  2.20s/it]Best trial: 23. Best value: 0.293331:  48%|████▊     | 48/100 [01:55<01:58,  2.28s/it]Best trial: 23. Best value: 0.293331:  48%|████▊     | 48/100 [01:57<01:58,  2.28s/it]Best trial: 23. Best value: 0.293331:  49%|████▉     | 49/100 [01:57<01:52,  2.20s/it]Best trial: 23. Best value: 0.293331:  49%|████▉     | 49/100 [01:59<01:52,  2.20s/it]Best trial: 23. Best value: 0.293331:  50%|█████     | 50/100 [01:59<01:49,  2.19s/it]Best trial: 23. Best value: 0.293331:  50%|█████     | 50/100 [02:01<01:49,  2.19s/it]Best trial: 23. Best value: 0.293331:  51%|█████     | 51/100 [02:01<01:50,  2.25s/it]Best trial: 23. Best value: 0.293331:  51%|█████     | 51/100 [02:03<01:50,  2.25s/it]Best trial: 23. Best value: 0.293331:  52%|█████▏    | 52/100 [02:03<01:43,  2.17s/it]Best trial: 23. Best value: 0.293331:  52%|█████▏    | 52/100 [02:05<01:43,  2.17s/it]Best trial: 23. Best value: 0.293331:  53%|█████▎    | 53/100 [02:05<01:42,  2.19s/it]Best trial: 53. Best value: 0.329288:  53%|█████▎    | 53/100 [02:08<01:42,  2.19s/it]Best trial: 53. Best value: 0.329288:  54%|█████▍    | 54/100 [02:08<01:42,  2.24s/it]Best trial: 53. Best value: 0.329288:  54%|█████▍    | 54/100 [02:10<01:42,  2.24s/it]Best trial: 53. Best value: 0.329288:  55%|█████▌    | 55/100 [02:10<01:46,  2.37s/it]Best trial: 53. Best value: 0.329288:  55%|█████▌    | 55/100 [02:12<01:46,  2.37s/it]Best trial: 53. Best value: 0.329288:  56%|█████▌    | 56/100 [02:12<01:39,  2.25s/it]Best trial: 53. Best value: 0.329288:  56%|█████▌    | 56/100 [02:15<01:39,  2.25s/it]Best trial: 53. Best value: 0.329288:  57%|█████▋    | 57/100 [02:15<01:41,  2.37s/it]Best trial: 53. Best value: 0.329288:  57%|█████▋    | 57/100 [02:17<01:41,  2.37s/it]Best trial: 53. Best value: 0.329288:  58%|█████▊    | 58/100 [02:17<01:32,  2.19s/it]Best trial: 53. Best value: 0.329288:  58%|█████▊    | 58/100 [02:19<01:32,  2.19s/it]Best trial: 53. Best value: 0.329288:  59%|█████▉    | 59/100 [02:19<01:27,  2.12s/it]Best trial: 53. Best value: 0.329288:  59%|█████▉    | 59/100 [02:21<01:27,  2.12s/it]Best trial: 53. Best value: 0.329288:  60%|██████    | 60/100 [02:21<01:21,  2.03s/it]Best trial: 53. Best value: 0.329288:  60%|██████    | 60/100 [02:23<01:21,  2.03s/it]Best trial: 53. Best value: 0.329288:  61%|██████    | 61/100 [02:23<01:25,  2.19s/it]Best trial: 53. Best value: 0.329288:  61%|██████    | 61/100 [02:26<01:25,  2.19s/it]Best trial: 53. Best value: 0.329288:  62%|██████▏   | 62/100 [02:26<01:27,  2.30s/it]Best trial: 53. Best value: 0.329288:  62%|██████▏   | 62/100 [02:27<01:27,  2.30s/it]Best trial: 53. Best value: 0.329288:  63%|██████▎   | 63/100 [02:27<01:19,  2.15s/it]Best trial: 53. Best value: 0.329288:  63%|██████▎   | 63/100 [02:30<01:19,  2.15s/it]Best trial: 53. Best value: 0.329288:  64%|██████▍   | 64/100 [02:30<01:19,  2.20s/it]Best trial: 53. Best value: 0.329288:  64%|██████▍   | 64/100 [02:33<01:19,  2.20s/it]Best trial: 53. Best value: 0.329288:  65%|██████▌   | 65/100 [02:33<01:26,  2.47s/it]Best trial: 53. Best value: 0.329288:  65%|██████▌   | 65/100 [02:35<01:26,  2.47s/it]Best trial: 53. Best value: 0.329288:  66%|██████▌   | 66/100 [02:35<01:22,  2.42s/it]Best trial: 53. Best value: 0.329288:  66%|██████▌   | 66/100 [02:37<01:22,  2.42s/it]Best trial: 53. Best value: 0.329288:  67%|██████▋   | 67/100 [02:37<01:18,  2.37s/it]Best trial: 53. Best value: 0.329288:  67%|██████▋   | 67/100 [02:40<01:18,  2.37s/it]Best trial: 53. Best value: 0.329288:  68%|██████▊   | 68/100 [02:40<01:22,  2.58s/it]Best trial: 53. Best value: 0.329288:  68%|██████▊   | 68/100 [02:43<01:22,  2.58s/it]Best trial: 53. Best value: 0.329288:  69%|██████▉   | 69/100 [02:43<01:15,  2.44s/it]Best trial: 53. Best value: 0.329288:  69%|██████▉   | 69/100 [02:45<01:15,  2.44s/it]Best trial: 53. Best value: 0.329288:  70%|███████   | 70/100 [02:45<01:16,  2.53s/it]Best trial: 53. Best value: 0.329288:  70%|███████   | 70/100 [02:47<01:16,  2.53s/it]Best trial: 53. Best value: 0.329288:  71%|███████   | 71/100 [02:47<01:06,  2.30s/it]Best trial: 53. Best value: 0.329288:  71%|███████   | 71/100 [02:49<01:06,  2.30s/it]Best trial: 53. Best value: 0.329288:  72%|███████▏  | 72/100 [02:49<01:02,  2.24s/it]Best trial: 53. Best value: 0.329288:  72%|███████▏  | 72/100 [02:51<01:02,  2.24s/it]Best trial: 53. Best value: 0.329288:  73%|███████▎  | 73/100 [02:51<00:57,  2.12s/it]Best trial: 53. Best value: 0.329288:  73%|███████▎  | 73/100 [02:53<00:57,  2.12s/it]Best trial: 53. Best value: 0.329288:  74%|███████▍  | 74/100 [02:53<00:51,  1.99s/it]Best trial: 53. Best value: 0.329288:  74%|███████▍  | 74/100 [02:55<00:51,  1.99s/it]Best trial: 53. Best value: 0.329288:  75%|███████▌  | 75/100 [02:55<00:50,  2.04s/it]Best trial: 53. Best value: 0.329288:  75%|███████▌  | 75/100 [02:58<00:50,  2.04s/it]Best trial: 53. Best value: 0.329288:  76%|███████▌  | 76/100 [02:58<00:53,  2.24s/it]Best trial: 53. Best value: 0.329288:  76%|███████▌  | 76/100 [03:00<00:53,  2.24s/it]Best trial: 53. Best value: 0.329288:  77%|███████▋  | 77/100 [03:00<00:49,  2.15s/it]Best trial: 53. Best value: 0.329288:  77%|███████▋  | 77/100 [03:02<00:49,  2.15s/it]Best trial: 53. Best value: 0.329288:  78%|███████▊  | 78/100 [03:02<00:48,  2.22s/it]Best trial: 53. Best value: 0.329288:  78%|███████▊  | 78/100 [03:04<00:48,  2.22s/it]Best trial: 53. Best value: 0.329288:  79%|███████▉  | 79/100 [03:04<00:46,  2.20s/it]Best trial: 53. Best value: 0.329288:  79%|███████▉  | 79/100 [03:08<00:46,  2.20s/it]Best trial: 53. Best value: 0.329288:  80%|████████  | 80/100 [03:08<00:52,  2.62s/it]Best trial: 53. Best value: 0.329288:  80%|████████  | 80/100 [03:11<00:52,  2.62s/it]Best trial: 53. Best value: 0.329288:  81%|████████  | 81/100 [03:11<00:55,  2.91s/it]Best trial: 53. Best value: 0.329288:  81%|████████  | 81/100 [03:14<00:55,  2.91s/it]Best trial: 53. Best value: 0.329288:  82%|████████▏ | 82/100 [03:14<00:52,  2.89s/it]Best trial: 53. Best value: 0.329288:  82%|████████▏ | 82/100 [03:17<00:52,  2.89s/it]Best trial: 53. Best value: 0.329288:  83%|████████▎ | 83/100 [03:17<00:50,  2.98s/it]Best trial: 53. Best value: 0.329288:  83%|████████▎ | 83/100 [03:21<00:50,  2.98s/it]Best trial: 53. Best value: 0.329288:  84%|████████▍ | 84/100 [03:21<00:49,  3.11s/it]Best trial: 53. Best value: 0.329288:  84%|████████▍ | 84/100 [03:23<00:49,  3.11s/it]Best trial: 53. Best value: 0.329288:  85%|████████▌ | 85/100 [03:23<00:44,  2.96s/it]Best trial: 53. Best value: 0.329288:  85%|████████▌ | 85/100 [03:26<00:44,  2.96s/it]Best trial: 53. Best value: 0.329288:  86%|████████▌ | 86/100 [03:26<00:40,  2.86s/it]Best trial: 53. Best value: 0.329288:  86%|████████▌ | 86/100 [03:29<00:40,  2.86s/it]Best trial: 53. Best value: 0.329288:  87%|████████▋ | 87/100 [03:29<00:36,  2.80s/it]Best trial: 53. Best value: 0.329288:  87%|████████▋ | 87/100 [03:32<00:36,  2.80s/it]Best trial: 53. Best value: 0.329288:  88%|████████▊ | 88/100 [03:32<00:35,  2.95s/it]Best trial: 53. Best value: 0.329288:  88%|████████▊ | 88/100 [03:35<00:35,  2.95s/it]Best trial: 53. Best value: 0.329288:  89%|████████▉ | 89/100 [03:35<00:32,  2.93s/it]Best trial: 53. Best value: 0.329288:  89%|████████▉ | 89/100 [03:37<00:32,  2.93s/it]Best trial: 53. Best value: 0.329288:  90%|█████████ | 90/100 [03:37<00:27,  2.78s/it]Best trial: 53. Best value: 0.329288:  90%|█████████ | 90/100 [03:40<00:27,  2.78s/it]Best trial: 53. Best value: 0.329288:  91%|█████████ | 91/100 [03:40<00:25,  2.80s/it]Best trial: 53. Best value: 0.329288:  91%|█████████ | 91/100 [03:43<00:25,  2.80s/it]Best trial: 53. Best value: 0.329288:  92%|█████████▏| 92/100 [03:43<00:22,  2.80s/it]Best trial: 53. Best value: 0.329288:  92%|█████████▏| 92/100 [03:46<00:22,  2.80s/it]Best trial: 53. Best value: 0.329288:  93%|█████████▎| 93/100 [03:46<00:20,  2.97s/it]Best trial: 53. Best value: 0.329288:  93%|█████████▎| 93/100 [03:49<00:20,  2.97s/it]Best trial: 53. Best value: 0.329288:  94%|█████████▍| 94/100 [03:49<00:16,  2.81s/it]Best trial: 53. Best value: 0.329288:  94%|█████████▍| 94/100 [03:51<00:16,  2.81s/it]Best trial: 53. Best value: 0.329288:  95%|█████████▌| 95/100 [03:51<00:13,  2.74s/it]Best trial: 53. Best value: 0.329288:  95%|█████████▌| 95/100 [03:53<00:13,  2.74s/it]Best trial: 53. Best value: 0.329288:  96%|█████████▌| 96/100 [03:53<00:10,  2.56s/it]Best trial: 53. Best value: 0.329288:  96%|█████████▌| 96/100 [03:57<00:10,  2.56s/it]Best trial: 53. Best value: 0.329288:  97%|█████████▋| 97/100 [03:57<00:08,  2.94s/it]Best trial: 53. Best value: 0.329288:  97%|█████████▋| 97/100 [03:59<00:08,  2.94s/it]Best trial: 53. Best value: 0.329288:  98%|█████████▊| 98/100 [03:59<00:05,  2.72s/it]Best trial: 53. Best value: 0.329288:  98%|█████████▊| 98/100 [04:02<00:05,  2.72s/it]Best trial: 53. Best value: 0.329288:  99%|█████████▉| 99/100 [04:02<00:02,  2.57s/it]Best trial: 53. Best value: 0.329288:  99%|█████████▉| 99/100 [04:04<00:02,  2.57s/it]Best trial: 53. Best value: 0.329288: 100%|██████████| 100/100 [04:04<00:00,  2.57s/it]Best trial: 53. Best value: 0.329288: 100%|██████████| 100/100 [04:04<00:00,  2.45s/it]
2025-11-30 16:25:42,101 - INFO - HPO Complete. Best AUPRC: 0.3293
2025-11-30 16:25:42,101 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.05411918436992117, 'max_depth': 3, 'subsample': 0.7645165392273809, 'colsample_bytree': 0.6925774770230202, 'gamma': 3.1125481927545513, 'reg_lambda': 0.001916969318187338, 'reg_alpha': 0.00412399583345123}
2025-11-30 16:25:42,102 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:25:44,114 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 16:25:44,115 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:25:44,315 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:25:44,350 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:25:44,359 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:25:44,359 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:25:44,359 - INFO - Training model...
2025-11-30 16:25:45,598 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:25:51,158 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:25:51,159 - INFO - AUROC: 0.5675 (0.3208 - 0.7678)
2025-11-30 16:25:51,159 - INFO - AUPRC: 0.0171 (0.0046 - 0.0652)
2025-11-30 16:25:51,159 - INFO - Brier Score: 0.0092 (0.0045 - 0.0156)
2025-11-30 16:25:51,159 - INFO - Accuracy: 0.9595 (0.8549 - 0.9720)
2025-11-30 16:25:51,159 - INFO - Precision: 0.0417 (0.0000 - 0.1082)
2025-11-30 16:25:51,159 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.5400)
2025-11-30 16:25:51,159 - INFO - F1-Score: 0.0667 (0.0000 - 0.1706)
2025-11-30 16:25:51,159 - INFO - Best Threshold: 0.0400 (0.0100 - 0.0400)
2025-11-30 16:25:51,159 - INFO - Specificity: 0.9665 (0.8601 - 0.9799)
2025-11-30 16:25:51,168 - INFO - Calculating SHAP values...
2025-11-30 16:25:52,219 - INFO - SHAP plots saved.
2025-11-30 16:25:52,220 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:25:53,467 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 16:25:53,467 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:25:53,703 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:25:53,741 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:25:53,754 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:25:53,755 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.105791:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.105791:   1%|          | 1/100 [00:02<04:23,  2.66s/it]Best trial: 0. Best value: 0.105791:   1%|          | 1/100 [00:04<04:23,  2.66s/it]Best trial: 0. Best value: 0.105791:   2%|▏         | 2/100 [00:04<03:44,  2.29s/it]Best trial: 0. Best value: 0.105791:   2%|▏         | 2/100 [00:06<03:44,  2.29s/it]Best trial: 0. Best value: 0.105791:   3%|▎         | 3/100 [00:06<03:22,  2.08s/it]Best trial: 3. Best value: 0.127447:   3%|▎         | 3/100 [00:08<03:22,  2.08s/it]Best trial: 3. Best value: 0.127447:   4%|▍         | 4/100 [00:08<03:18,  2.07s/it]Best trial: 4. Best value: 0.130333:   4%|▍         | 4/100 [00:11<03:18,  2.07s/it]Best trial: 4. Best value: 0.130333:   5%|▌         | 5/100 [00:11<03:42,  2.34s/it]Best trial: 4. Best value: 0.130333:   5%|▌         | 5/100 [00:14<03:42,  2.34s/it]Best trial: 4. Best value: 0.130333:   6%|▌         | 6/100 [00:14<04:09,  2.66s/it]Best trial: 6. Best value: 0.154006:   6%|▌         | 6/100 [00:16<04:09,  2.66s/it]Best trial: 6. Best value: 0.154006:   7%|▋         | 7/100 [00:16<03:43,  2.41s/it]Best trial: 6. Best value: 0.154006:   7%|▋         | 7/100 [00:18<03:43,  2.41s/it]Best trial: 6. Best value: 0.154006:   8%|▊         | 8/100 [00:18<03:30,  2.29s/it]Best trial: 6. Best value: 0.154006:   8%|▊         | 8/100 [00:21<03:30,  2.29s/it]Best trial: 6. Best value: 0.154006:   9%|▉         | 9/100 [00:21<03:40,  2.42s/it]Best trial: 6. Best value: 0.154006:   9%|▉         | 9/100 [00:23<03:40,  2.42s/it]Best trial: 6. Best value: 0.154006:  10%|█         | 10/100 [00:23<03:27,  2.30s/it]Best trial: 6. Best value: 0.154006:  10%|█         | 10/100 [00:25<03:27,  2.30s/it]Best trial: 6. Best value: 0.154006:  11%|█         | 11/100 [00:25<03:21,  2.26s/it]Best trial: 11. Best value: 0.166306:  11%|█         | 11/100 [00:28<03:21,  2.26s/it]Best trial: 11. Best value: 0.166306:  12%|█▏        | 12/100 [00:28<03:25,  2.33s/it]Best trial: 11. Best value: 0.166306:  12%|█▏        | 12/100 [00:30<03:25,  2.33s/it]Best trial: 11. Best value: 0.166306:  13%|█▎        | 13/100 [00:30<03:15,  2.25s/it]Best trial: 11. Best value: 0.166306:  13%|█▎        | 13/100 [00:32<03:15,  2.25s/it]Best trial: 11. Best value: 0.166306:  14%|█▍        | 14/100 [00:32<03:19,  2.32s/it]Best trial: 11. Best value: 0.166306:  14%|█▍        | 14/100 [00:34<03:19,  2.32s/it]Best trial: 11. Best value: 0.166306:  15%|█▌        | 15/100 [00:34<03:05,  2.18s/it]Best trial: 11. Best value: 0.166306:  15%|█▌        | 15/100 [00:36<03:05,  2.18s/it]Best trial: 11. Best value: 0.166306:  16%|█▌        | 16/100 [00:36<03:03,  2.19s/it]Best trial: 11. Best value: 0.166306:  16%|█▌        | 16/100 [00:38<03:03,  2.19s/it]Best trial: 11. Best value: 0.166306:  17%|█▋        | 17/100 [00:38<02:54,  2.10s/it]Best trial: 11. Best value: 0.166306:  17%|█▋        | 17/100 [00:40<02:54,  2.10s/it]Best trial: 11. Best value: 0.166306:  18%|█▊        | 18/100 [00:40<02:56,  2.15s/it]Best trial: 11. Best value: 0.166306:  18%|█▊        | 18/100 [00:43<02:56,  2.15s/it]Best trial: 11. Best value: 0.166306:  19%|█▉        | 19/100 [00:43<03:05,  2.29s/it]Best trial: 11. Best value: 0.166306:  19%|█▉        | 19/100 [00:45<03:05,  2.29s/it]Best trial: 11. Best value: 0.166306:  20%|██        | 20/100 [00:45<03:02,  2.29s/it]Best trial: 11. Best value: 0.166306:  20%|██        | 20/100 [00:47<03:02,  2.29s/it]Best trial: 11. Best value: 0.166306:  21%|██        | 21/100 [00:47<02:55,  2.22s/it]Best trial: 11. Best value: 0.166306:  21%|██        | 21/100 [00:50<02:55,  2.22s/it]Best trial: 11. Best value: 0.166306:  22%|██▏       | 22/100 [00:50<03:01,  2.33s/it]Best trial: 11. Best value: 0.166306:  22%|██▏       | 22/100 [00:52<03:01,  2.33s/it]Best trial: 11. Best value: 0.166306:  23%|██▎       | 23/100 [00:52<03:01,  2.35s/it]Best trial: 11. Best value: 0.166306:  23%|██▎       | 23/100 [00:55<03:01,  2.35s/it]Best trial: 11. Best value: 0.166306:  24%|██▍       | 24/100 [00:55<02:59,  2.36s/it]Best trial: 11. Best value: 0.166306:  24%|██▍       | 24/100 [00:57<02:59,  2.36s/it]Best trial: 11. Best value: 0.166306:  25%|██▌       | 25/100 [00:57<03:03,  2.45s/it]Best trial: 11. Best value: 0.166306:  25%|██▌       | 25/100 [01:00<03:03,  2.45s/it]Best trial: 11. Best value: 0.166306:  26%|██▌       | 26/100 [01:00<03:01,  2.46s/it]Best trial: 11. Best value: 0.166306:  26%|██▌       | 26/100 [01:02<03:01,  2.46s/it]Best trial: 11. Best value: 0.166306:  27%|██▋       | 27/100 [01:02<02:58,  2.45s/it]Best trial: 11. Best value: 0.166306:  27%|██▋       | 27/100 [01:04<02:58,  2.45s/it]Best trial: 11. Best value: 0.166306:  28%|██▊       | 28/100 [01:04<02:52,  2.39s/it]Best trial: 11. Best value: 0.166306:  28%|██▊       | 28/100 [01:07<02:52,  2.39s/it]Best trial: 11. Best value: 0.166306:  29%|██▉       | 29/100 [01:07<02:51,  2.41s/it]Best trial: 11. Best value: 0.166306:  29%|██▉       | 29/100 [01:10<02:51,  2.41s/it]Best trial: 11. Best value: 0.166306:  30%|███       | 30/100 [01:10<02:56,  2.52s/it]Best trial: 11. Best value: 0.166306:  30%|███       | 30/100 [01:13<02:56,  2.52s/it]Best trial: 11. Best value: 0.166306:  31%|███       | 31/100 [01:13<03:08,  2.74s/it]Best trial: 11. Best value: 0.166306:  31%|███       | 31/100 [01:15<03:08,  2.74s/it]Best trial: 11. Best value: 0.166306:  32%|███▏      | 32/100 [01:15<03:01,  2.67s/it]Best trial: 11. Best value: 0.166306:  32%|███▏      | 32/100 [01:18<03:01,  2.67s/it]Best trial: 11. Best value: 0.166306:  33%|███▎      | 33/100 [01:18<02:51,  2.56s/it]Best trial: 11. Best value: 0.166306:  33%|███▎      | 33/100 [01:20<02:51,  2.56s/it]Best trial: 11. Best value: 0.166306:  34%|███▍      | 34/100 [01:20<02:44,  2.49s/it]Best trial: 34. Best value: 0.185076:  34%|███▍      | 34/100 [01:22<02:44,  2.49s/it]Best trial: 34. Best value: 0.185076:  35%|███▌      | 35/100 [01:22<02:24,  2.22s/it]Best trial: 34. Best value: 0.185076:  35%|███▌      | 35/100 [01:24<02:24,  2.22s/it]Best trial: 34. Best value: 0.185076:  36%|███▌      | 36/100 [01:24<02:22,  2.22s/it]Best trial: 34. Best value: 0.185076:  36%|███▌      | 36/100 [01:26<02:22,  2.22s/it]Best trial: 34. Best value: 0.185076:  37%|███▋      | 37/100 [01:26<02:21,  2.24s/it]Best trial: 34. Best value: 0.185076:  37%|███▋      | 37/100 [01:28<02:21,  2.24s/it]Best trial: 34. Best value: 0.185076:  38%|███▊      | 38/100 [01:28<02:05,  2.02s/it]Best trial: 34. Best value: 0.185076:  38%|███▊      | 38/100 [01:29<02:05,  2.02s/it]Best trial: 34. Best value: 0.185076:  39%|███▉      | 39/100 [01:29<01:59,  1.95s/it]Best trial: 34. Best value: 0.185076:  39%|███▉      | 39/100 [01:32<01:59,  1.95s/it]Best trial: 34. Best value: 0.185076:  40%|████      | 40/100 [01:32<02:05,  2.09s/it]Best trial: 34. Best value: 0.185076:  40%|████      | 40/100 [01:35<02:05,  2.09s/it]Best trial: 34. Best value: 0.185076:  41%|████      | 41/100 [01:35<02:15,  2.29s/it]Best trial: 34. Best value: 0.185076:  41%|████      | 41/100 [01:37<02:15,  2.29s/it]Best trial: 34. Best value: 0.185076:  42%|████▏     | 42/100 [01:37<02:16,  2.36s/it]Best trial: 34. Best value: 0.185076:  42%|████▏     | 42/100 [01:39<02:16,  2.36s/it]Best trial: 34. Best value: 0.185076:  43%|████▎     | 43/100 [01:39<02:11,  2.31s/it]Best trial: 34. Best value: 0.185076:  43%|████▎     | 43/100 [01:41<02:11,  2.31s/it]Best trial: 34. Best value: 0.185076:  44%|████▍     | 44/100 [01:41<02:05,  2.24s/it]Best trial: 44. Best value: 0.187917:  44%|████▍     | 44/100 [01:44<02:05,  2.24s/it]Best trial: 44. Best value: 0.187917:  45%|████▌     | 45/100 [01:44<02:11,  2.39s/it]Best trial: 44. Best value: 0.187917:  45%|████▌     | 45/100 [01:47<02:11,  2.39s/it]Best trial: 44. Best value: 0.187917:  46%|████▌     | 46/100 [01:47<02:12,  2.46s/it]Best trial: 44. Best value: 0.187917:  46%|████▌     | 46/100 [01:49<02:12,  2.46s/it]Best trial: 44. Best value: 0.187917:  47%|████▋     | 47/100 [01:49<02:06,  2.40s/it]Best trial: 44. Best value: 0.187917:  47%|████▋     | 47/100 [01:52<02:06,  2.40s/it]Best trial: 44. Best value: 0.187917:  48%|████▊     | 48/100 [01:52<02:06,  2.43s/it]Best trial: 44. Best value: 0.187917:  48%|████▊     | 48/100 [01:54<02:06,  2.43s/it]Best trial: 44. Best value: 0.187917:  49%|████▉     | 49/100 [01:54<02:04,  2.43s/it]Best trial: 44. Best value: 0.187917:  49%|████▉     | 49/100 [01:56<02:04,  2.43s/it]Best trial: 44. Best value: 0.187917:  50%|█████     | 50/100 [01:56<01:53,  2.26s/it]Best trial: 44. Best value: 0.187917:  50%|█████     | 50/100 [01:58<01:53,  2.26s/it]Best trial: 44. Best value: 0.187917:  51%|█████     | 51/100 [01:58<01:56,  2.37s/it]Best trial: 44. Best value: 0.187917:  51%|█████     | 51/100 [02:00<01:56,  2.37s/it]Best trial: 44. Best value: 0.187917:  52%|█████▏    | 52/100 [02:00<01:46,  2.21s/it]Best trial: 52. Best value: 0.192225:  52%|█████▏    | 52/100 [02:02<01:46,  2.21s/it]Best trial: 52. Best value: 0.192225:  53%|█████▎    | 53/100 [02:02<01:41,  2.17s/it]Best trial: 52. Best value: 0.192225:  53%|█████▎    | 53/100 [02:05<01:41,  2.17s/it]Best trial: 52. Best value: 0.192225:  54%|█████▍    | 54/100 [02:05<01:45,  2.30s/it]Best trial: 52. Best value: 0.192225:  54%|█████▍    | 54/100 [02:07<01:45,  2.30s/it]Best trial: 52. Best value: 0.192225:  55%|█████▌    | 55/100 [02:07<01:40,  2.24s/it]Best trial: 55. Best value: 0.193388:  55%|█████▌    | 55/100 [02:10<01:40,  2.24s/it]Best trial: 55. Best value: 0.193388:  56%|█████▌    | 56/100 [02:10<01:44,  2.39s/it]Best trial: 55. Best value: 0.193388:  56%|█████▌    | 56/100 [02:12<01:44,  2.39s/it]Best trial: 55. Best value: 0.193388:  57%|█████▋    | 57/100 [02:12<01:43,  2.40s/it]Best trial: 55. Best value: 0.193388:  57%|█████▋    | 57/100 [02:15<01:43,  2.40s/it]Best trial: 55. Best value: 0.193388:  58%|█████▊    | 58/100 [02:15<01:42,  2.43s/it]Best trial: 55. Best value: 0.193388:  58%|█████▊    | 58/100 [02:17<01:42,  2.43s/it]Best trial: 55. Best value: 0.193388:  59%|█████▉    | 59/100 [02:17<01:40,  2.45s/it]Best trial: 55. Best value: 0.193388:  59%|█████▉    | 59/100 [02:19<01:40,  2.45s/it]Best trial: 55. Best value: 0.193388:  60%|██████    | 60/100 [02:19<01:34,  2.37s/it]Best trial: 55. Best value: 0.193388:  60%|██████    | 60/100 [02:22<01:34,  2.37s/it]Best trial: 55. Best value: 0.193388:  61%|██████    | 61/100 [02:22<01:30,  2.32s/it]Best trial: 55. Best value: 0.193388:  61%|██████    | 61/100 [02:24<01:30,  2.32s/it]Best trial: 55. Best value: 0.193388:  62%|██████▏   | 62/100 [02:24<01:29,  2.34s/it]Best trial: 55. Best value: 0.193388:  62%|██████▏   | 62/100 [02:26<01:29,  2.34s/it]Best trial: 55. Best value: 0.193388:  63%|██████▎   | 63/100 [02:26<01:26,  2.33s/it]Best trial: 55. Best value: 0.193388:  63%|██████▎   | 63/100 [02:29<01:26,  2.33s/it]Best trial: 55. Best value: 0.193388:  64%|██████▍   | 64/100 [02:29<01:25,  2.37s/it]Best trial: 55. Best value: 0.193388:  64%|██████▍   | 64/100 [02:31<01:25,  2.37s/it]Best trial: 55. Best value: 0.193388:  65%|██████▌   | 65/100 [02:31<01:21,  2.32s/it]Best trial: 55. Best value: 0.193388:  65%|██████▌   | 65/100 [02:34<01:21,  2.32s/it]Best trial: 55. Best value: 0.193388:  66%|██████▌   | 66/100 [02:34<01:22,  2.42s/it]Best trial: 55. Best value: 0.193388:  66%|██████▌   | 66/100 [02:36<01:22,  2.42s/it]Best trial: 55. Best value: 0.193388:  67%|██████▋   | 67/100 [02:36<01:18,  2.37s/it]Best trial: 55. Best value: 0.193388:  67%|██████▋   | 67/100 [02:38<01:18,  2.37s/it]Best trial: 55. Best value: 0.193388:  68%|██████▊   | 68/100 [02:38<01:13,  2.30s/it]Best trial: 55. Best value: 0.193388:  68%|██████▊   | 68/100 [02:41<01:13,  2.30s/it]Best trial: 55. Best value: 0.193388:  69%|██████▉   | 69/100 [02:41<01:14,  2.42s/it]Best trial: 55. Best value: 0.193388:  69%|██████▉   | 69/100 [02:43<01:14,  2.42s/it]Best trial: 55. Best value: 0.193388:  70%|███████   | 70/100 [02:43<01:15,  2.50s/it]Best trial: 55. Best value: 0.193388:  70%|███████   | 70/100 [02:46<01:15,  2.50s/it]Best trial: 55. Best value: 0.193388:  71%|███████   | 71/100 [02:46<01:14,  2.58s/it]Best trial: 55. Best value: 0.193388:  71%|███████   | 71/100 [02:48<01:14,  2.58s/it]Best trial: 55. Best value: 0.193388:  72%|███████▏  | 72/100 [02:48<01:09,  2.50s/it]Best trial: 55. Best value: 0.193388:  72%|███████▏  | 72/100 [02:51<01:09,  2.50s/it]Best trial: 55. Best value: 0.193388:  73%|███████▎  | 73/100 [02:51<01:05,  2.43s/it]Best trial: 55. Best value: 0.193388:  73%|███████▎  | 73/100 [02:53<01:05,  2.43s/it]Best trial: 55. Best value: 0.193388:  74%|███████▍  | 74/100 [02:53<01:02,  2.39s/it]Best trial: 55. Best value: 0.193388:  74%|███████▍  | 74/100 [02:56<01:02,  2.39s/it]Best trial: 55. Best value: 0.193388:  75%|███████▌  | 75/100 [02:56<01:01,  2.44s/it]Best trial: 55. Best value: 0.193388:  75%|███████▌  | 75/100 [02:58<01:01,  2.44s/it]Best trial: 55. Best value: 0.193388:  76%|███████▌  | 76/100 [02:58<00:57,  2.41s/it]Best trial: 55. Best value: 0.193388:  76%|███████▌  | 76/100 [03:00<00:57,  2.41s/it]Best trial: 55. Best value: 0.193388:  77%|███████▋  | 77/100 [03:00<00:54,  2.35s/it]Best trial: 55. Best value: 0.193388:  77%|███████▋  | 77/100 [03:03<00:54,  2.35s/it]Best trial: 55. Best value: 0.193388:  78%|███████▊  | 78/100 [03:03<00:54,  2.48s/it]Best trial: 78. Best value: 0.200136:  78%|███████▊  | 78/100 [03:05<00:54,  2.48s/it]Best trial: 78. Best value: 0.200136:  79%|███████▉  | 79/100 [03:05<00:51,  2.43s/it]Best trial: 78. Best value: 0.200136:  79%|███████▉  | 79/100 [03:08<00:51,  2.43s/it]Best trial: 78. Best value: 0.200136:  80%|████████  | 80/100 [03:08<00:48,  2.41s/it]Best trial: 78. Best value: 0.200136:  80%|████████  | 80/100 [03:09<00:48,  2.41s/it]Best trial: 78. Best value: 0.200136:  81%|████████  | 81/100 [03:09<00:42,  2.21s/it]Best trial: 78. Best value: 0.200136:  81%|████████  | 81/100 [03:11<00:42,  2.21s/it]Best trial: 78. Best value: 0.200136:  82%|████████▏ | 82/100 [03:11<00:39,  2.17s/it]Best trial: 78. Best value: 0.200136:  82%|████████▏ | 82/100 [03:14<00:39,  2.17s/it]Best trial: 78. Best value: 0.200136:  83%|████████▎ | 83/100 [03:14<00:39,  2.33s/it]Best trial: 78. Best value: 0.200136:  83%|████████▎ | 83/100 [03:16<00:39,  2.33s/it]Best trial: 78. Best value: 0.200136:  84%|████████▍ | 84/100 [03:16<00:36,  2.30s/it]Best trial: 78. Best value: 0.200136:  84%|████████▍ | 84/100 [03:19<00:36,  2.30s/it]Best trial: 78. Best value: 0.200136:  85%|████████▌ | 85/100 [03:19<00:35,  2.36s/it]Best trial: 85. Best value: 0.226108:  85%|████████▌ | 85/100 [03:21<00:35,  2.36s/it]Best trial: 85. Best value: 0.226108:  86%|████████▌ | 86/100 [03:21<00:32,  2.35s/it]Best trial: 85. Best value: 0.226108:  86%|████████▌ | 86/100 [03:23<00:32,  2.35s/it]Best trial: 85. Best value: 0.226108:  87%|████████▋ | 87/100 [03:23<00:29,  2.27s/it]Best trial: 85. Best value: 0.226108:  87%|████████▋ | 87/100 [03:26<00:29,  2.27s/it]Best trial: 85. Best value: 0.226108:  88%|████████▊ | 88/100 [03:26<00:27,  2.28s/it]Best trial: 85. Best value: 0.226108:  88%|████████▊ | 88/100 [03:28<00:27,  2.28s/it]Best trial: 85. Best value: 0.226108:  89%|████████▉ | 89/100 [03:28<00:25,  2.30s/it]Best trial: 85. Best value: 0.226108:  89%|████████▉ | 89/100 [03:30<00:25,  2.30s/it]Best trial: 85. Best value: 0.226108:  90%|█████████ | 90/100 [03:30<00:22,  2.29s/it]Best trial: 85. Best value: 0.226108:  90%|█████████ | 90/100 [03:32<00:22,  2.29s/it]Best trial: 85. Best value: 0.226108:  91%|█████████ | 91/100 [03:32<00:20,  2.23s/it]Best trial: 85. Best value: 0.226108:  91%|█████████ | 91/100 [03:34<00:20,  2.23s/it]Best trial: 85. Best value: 0.226108:  92%|█████████▏| 92/100 [03:34<00:17,  2.19s/it]Best trial: 85. Best value: 0.226108:  92%|█████████▏| 92/100 [03:37<00:17,  2.19s/it]Best trial: 85. Best value: 0.226108:  93%|█████████▎| 93/100 [03:37<00:16,  2.33s/it]Best trial: 85. Best value: 0.226108:  93%|█████████▎| 93/100 [03:40<00:16,  2.33s/it]Best trial: 85. Best value: 0.226108:  94%|█████████▍| 94/100 [03:40<00:14,  2.39s/it]Best trial: 85. Best value: 0.226108:  94%|█████████▍| 94/100 [03:42<00:14,  2.39s/it]Best trial: 85. Best value: 0.226108:  95%|█████████▌| 95/100 [03:42<00:12,  2.42s/it]Best trial: 85. Best value: 0.226108:  95%|█████████▌| 95/100 [03:44<00:12,  2.42s/it]Best trial: 85. Best value: 0.226108:  96%|█████████▌| 96/100 [03:44<00:09,  2.34s/it]Best trial: 85. Best value: 0.226108:  96%|█████████▌| 96/100 [03:46<00:09,  2.34s/it]Best trial: 85. Best value: 0.226108:  97%|█████████▋| 97/100 [03:46<00:06,  2.27s/it]Best trial: 85. Best value: 0.226108:  97%|█████████▋| 97/100 [03:48<00:06,  2.27s/it]Best trial: 85. Best value: 0.226108:  98%|█████████▊| 98/100 [03:48<00:04,  2.23s/it]Best trial: 85. Best value: 0.226108:  98%|█████████▊| 98/100 [03:51<00:04,  2.23s/it]Best trial: 85. Best value: 0.226108:  99%|█████████▉| 99/100 [03:51<00:02,  2.27s/it]Best trial: 85. Best value: 0.226108:  99%|█████████▉| 99/100 [03:53<00:02,  2.27s/it]Best trial: 85. Best value: 0.226108: 100%|██████████| 100/100 [03:53<00:00,  2.22s/it]Best trial: 85. Best value: 0.226108: 100%|██████████| 100/100 [03:53<00:00,  2.33s/it]
2025-11-30 16:29:47,176 - INFO - HPO Complete. Best AUPRC: 0.2261
2025-11-30 16:29:47,176 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.00021810121544626492, 'max_depth': 7, 'subsample': 0.9135459301681991, 'colsample_bytree': 0.8852728807734909, 'gamma': 2.909168063930901, 'reg_lambda': 0.0006833927246710721, 'reg_alpha': 0.5965048705980136}
2025-11-30 16:29:47,177 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:29:48,989 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 16:29:48,989 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:29:49,180 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:29:49,214 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:29:49,221 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:29:49,221 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:29:49,222 - INFO - Training model...
2025-11-30 16:29:50,994 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:29:56,553 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:29:56,553 - INFO - AUROC: 0.6025 (0.3091 - 0.7984)
2025-11-30 16:29:56,553 - INFO - AUPRC: 0.0150 (0.0056 - 0.0276)
2025-11-30 16:29:56,553 - INFO - Brier Score: 0.2224 (0.2220 - 0.2229)
2025-11-30 16:29:56,553 - INFO - Accuracy: 0.6228 (0.0043 - 0.6520)
2025-11-30 16:29:56,553 - INFO - Precision: 0.0152 (0.0041 - 0.0269)
2025-11-30 16:29:56,553 - INFO - Sensitivity (Recall): 0.6667 (0.5000 - 1.0000)
2025-11-30 16:29:56,553 - INFO - F1-Score: 0.0297 (0.0081 - 0.0518)
2025-11-30 16:29:56,554 - INFO - Best Threshold: 0.4700 (0.0100 - 0.4700)
2025-11-30 16:29:56,554 - INFO - Specificity: 0.6224 (0.0000 - 0.6516)
2025-11-30 16:29:56,564 - INFO - Calculating SHAP values...
2025-11-30 16:29:57,619 - INFO - SHAP plots saved.
2025-11-30 16:29:57,619 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:29:58,800 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 16:29:58,800 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:29:58,996 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:29:59,031 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:29:59,040 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:29:59,040 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.177783:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.177783:   1%|          | 1/100 [00:02<03:31,  2.14s/it]Best trial: 0. Best value: 0.177783:   1%|          | 1/100 [00:04<03:31,  2.14s/it]Best trial: 0. Best value: 0.177783:   2%|▏         | 2/100 [00:04<03:36,  2.21s/it]Best trial: 0. Best value: 0.177783:   2%|▏         | 2/100 [00:06<03:36,  2.21s/it]Best trial: 0. Best value: 0.177783:   3%|▎         | 3/100 [00:06<03:19,  2.05s/it]Best trial: 0. Best value: 0.177783:   3%|▎         | 3/100 [00:08<03:19,  2.05s/it]Best trial: 0. Best value: 0.177783:   4%|▍         | 4/100 [00:08<03:34,  2.24s/it]Best trial: 4. Best value: 0.179266:   4%|▍         | 4/100 [00:11<03:34,  2.24s/it]Best trial: 4. Best value: 0.179266:   5%|▌         | 5/100 [00:11<03:44,  2.36s/it]Best trial: 4. Best value: 0.179266:   5%|▌         | 5/100 [00:13<03:44,  2.36s/it]Best trial: 4. Best value: 0.179266:   6%|▌         | 6/100 [00:13<03:37,  2.32s/it]Best trial: 4. Best value: 0.179266:   6%|▌         | 6/100 [00:16<03:37,  2.32s/it]Best trial: 4. Best value: 0.179266:   7%|▋         | 7/100 [00:16<03:43,  2.40s/it]Best trial: 7. Best value: 0.179926:   7%|▋         | 7/100 [00:18<03:43,  2.40s/it]Best trial: 7. Best value: 0.179926:   8%|▊         | 8/100 [00:18<03:27,  2.26s/it]Best trial: 7. Best value: 0.179926:   8%|▊         | 8/100 [00:19<03:27,  2.26s/it]Best trial: 7. Best value: 0.179926:   9%|▉         | 9/100 [00:19<03:11,  2.10s/it]Best trial: 7. Best value: 0.179926:   9%|▉         | 9/100 [00:23<03:11,  2.10s/it]Best trial: 7. Best value: 0.179926:  10%|█         | 10/100 [00:23<03:46,  2.52s/it]Best trial: 10. Best value: 0.198166:  10%|█         | 10/100 [00:25<03:46,  2.52s/it]Best trial: 10. Best value: 0.198166:  11%|█         | 11/100 [00:25<03:36,  2.43s/it]Best trial: 10. Best value: 0.198166:  11%|█         | 11/100 [00:27<03:36,  2.43s/it]Best trial: 10. Best value: 0.198166:  12%|█▏        | 12/100 [00:27<03:19,  2.26s/it]Best trial: 10. Best value: 0.198166:  12%|█▏        | 12/100 [00:29<03:19,  2.26s/it]Best trial: 10. Best value: 0.198166:  13%|█▎        | 13/100 [00:29<03:17,  2.27s/it]Best trial: 10. Best value: 0.198166:  13%|█▎        | 13/100 [00:31<03:17,  2.27s/it]Best trial: 10. Best value: 0.198166:  14%|█▍        | 14/100 [00:31<03:13,  2.25s/it]Best trial: 10. Best value: 0.198166:  14%|█▍        | 14/100 [00:34<03:13,  2.25s/it]Best trial: 10. Best value: 0.198166:  15%|█▌        | 15/100 [00:34<03:15,  2.30s/it]Best trial: 10. Best value: 0.198166:  15%|█▌        | 15/100 [00:36<03:15,  2.30s/it]Best trial: 10. Best value: 0.198166:  16%|█▌        | 16/100 [00:36<03:14,  2.32s/it]Best trial: 10. Best value: 0.198166:  16%|█▌        | 16/100 [00:38<03:14,  2.32s/it]Best trial: 10. Best value: 0.198166:  17%|█▋        | 17/100 [00:38<03:03,  2.21s/it]Best trial: 10. Best value: 0.198166:  17%|█▋        | 17/100 [00:41<03:03,  2.21s/it]Best trial: 10. Best value: 0.198166:  18%|█▊        | 18/100 [00:41<03:06,  2.28s/it]Best trial: 10. Best value: 0.198166:  18%|█▊        | 18/100 [00:43<03:06,  2.28s/it]Best trial: 10. Best value: 0.198166:  19%|█▉        | 19/100 [00:43<02:55,  2.17s/it]Best trial: 10. Best value: 0.198166:  19%|█▉        | 19/100 [00:44<02:55,  2.17s/it]Best trial: 10. Best value: 0.198166:  20%|██        | 20/100 [00:44<02:47,  2.09s/it]Best trial: 10. Best value: 0.198166:  20%|██        | 20/100 [00:47<02:47,  2.09s/it]Best trial: 10. Best value: 0.198166:  21%|██        | 21/100 [00:47<02:45,  2.09s/it]Best trial: 10. Best value: 0.198166:  21%|██        | 21/100 [00:48<02:45,  2.09s/it]Best trial: 10. Best value: 0.198166:  22%|██▏       | 22/100 [00:48<02:40,  2.05s/it]Best trial: 10. Best value: 0.198166:  22%|██▏       | 22/100 [00:51<02:40,  2.05s/it]Best trial: 10. Best value: 0.198166:  23%|██▎       | 23/100 [00:51<02:46,  2.16s/it]Best trial: 10. Best value: 0.198166:  23%|██▎       | 23/100 [00:53<02:46,  2.16s/it]Best trial: 10. Best value: 0.198166:  24%|██▍       | 24/100 [00:53<02:46,  2.19s/it]Best trial: 10. Best value: 0.198166:  24%|██▍       | 24/100 [00:55<02:46,  2.19s/it]Best trial: 10. Best value: 0.198166:  25%|██▌       | 25/100 [00:55<02:41,  2.16s/it]Best trial: 10. Best value: 0.198166:  25%|██▌       | 25/100 [00:57<02:41,  2.16s/it]Best trial: 10. Best value: 0.198166:  26%|██▌       | 26/100 [00:57<02:38,  2.14s/it]Best trial: 10. Best value: 0.198166:  26%|██▌       | 26/100 [01:00<02:38,  2.14s/it]Best trial: 10. Best value: 0.198166:  27%|██▋       | 27/100 [01:00<02:46,  2.28s/it]Best trial: 10. Best value: 0.198166:  27%|██▋       | 27/100 [01:03<02:46,  2.28s/it]Best trial: 10. Best value: 0.198166:  28%|██▊       | 28/100 [01:03<02:53,  2.41s/it]Best trial: 10. Best value: 0.198166:  28%|██▊       | 28/100 [01:05<02:53,  2.41s/it]Best trial: 10. Best value: 0.198166:  29%|██▉       | 29/100 [01:05<02:49,  2.39s/it]Best trial: 10. Best value: 0.198166:  29%|██▉       | 29/100 [01:07<02:49,  2.39s/it]Best trial: 10. Best value: 0.198166:  30%|███       | 30/100 [01:07<02:47,  2.39s/it]Best trial: 10. Best value: 0.198166:  30%|███       | 30/100 [01:10<02:47,  2.39s/it]Best trial: 10. Best value: 0.198166:  31%|███       | 31/100 [01:10<02:44,  2.39s/it]Best trial: 10. Best value: 0.198166:  31%|███       | 31/100 [01:12<02:44,  2.39s/it]Best trial: 10. Best value: 0.198166:  32%|███▏      | 32/100 [01:12<02:35,  2.29s/it]Best trial: 10. Best value: 0.198166:  32%|███▏      | 32/100 [01:14<02:35,  2.29s/it]Best trial: 10. Best value: 0.198166:  33%|███▎      | 33/100 [01:14<02:26,  2.19s/it]Best trial: 33. Best value: 0.242389:  33%|███▎      | 33/100 [01:16<02:26,  2.19s/it]Best trial: 33. Best value: 0.242389:  34%|███▍      | 34/100 [01:16<02:19,  2.11s/it]Best trial: 33. Best value: 0.242389:  34%|███▍      | 34/100 [01:18<02:19,  2.11s/it]Best trial: 33. Best value: 0.242389:  35%|███▌      | 35/100 [01:18<02:14,  2.07s/it]Best trial: 33. Best value: 0.242389:  35%|███▌      | 35/100 [01:20<02:14,  2.07s/it]Best trial: 33. Best value: 0.242389:  36%|███▌      | 36/100 [01:20<02:08,  2.00s/it]Best trial: 33. Best value: 0.242389:  36%|███▌      | 36/100 [01:22<02:08,  2.00s/it]Best trial: 33. Best value: 0.242389:  37%|███▋      | 37/100 [01:22<02:11,  2.08s/it]Best trial: 33. Best value: 0.242389:  37%|███▋      | 37/100 [01:24<02:11,  2.08s/it]Best trial: 33. Best value: 0.242389:  38%|███▊      | 38/100 [01:24<02:07,  2.06s/it]Best trial: 33. Best value: 0.242389:  38%|███▊      | 38/100 [01:26<02:07,  2.06s/it]Best trial: 33. Best value: 0.242389:  39%|███▉      | 39/100 [01:26<02:03,  2.03s/it]Best trial: 33. Best value: 0.242389:  39%|███▉      | 39/100 [01:28<02:03,  2.03s/it]Best trial: 33. Best value: 0.242389:  40%|████      | 40/100 [01:28<02:00,  2.00s/it]Best trial: 33. Best value: 0.242389:  40%|████      | 40/100 [01:30<02:00,  2.00s/it]Best trial: 33. Best value: 0.242389:  41%|████      | 41/100 [01:30<01:59,  2.02s/it]Best trial: 33. Best value: 0.242389:  41%|████      | 41/100 [01:32<01:59,  2.02s/it]Best trial: 33. Best value: 0.242389:  42%|████▏     | 42/100 [01:32<01:58,  2.04s/it]Best trial: 33. Best value: 0.242389:  42%|████▏     | 42/100 [01:34<01:58,  2.04s/it]Best trial: 33. Best value: 0.242389:  43%|████▎     | 43/100 [01:34<01:57,  2.06s/it]Best trial: 33. Best value: 0.242389:  43%|████▎     | 43/100 [01:36<01:57,  2.06s/it]Best trial: 33. Best value: 0.242389:  44%|████▍     | 44/100 [01:36<01:54,  2.05s/it]Best trial: 44. Best value: 0.252156:  44%|████▍     | 44/100 [01:38<01:54,  2.05s/it]Best trial: 44. Best value: 0.252156:  45%|████▌     | 45/100 [01:38<01:52,  2.05s/it]Best trial: 44. Best value: 0.252156:  45%|████▌     | 45/100 [01:40<01:52,  2.05s/it]Best trial: 44. Best value: 0.252156:  46%|████▌     | 46/100 [01:40<01:55,  2.14s/it]Best trial: 44. Best value: 0.252156:  46%|████▌     | 46/100 [01:43<01:55,  2.14s/it]Best trial: 44. Best value: 0.252156:  47%|████▋     | 47/100 [01:43<01:53,  2.14s/it]Best trial: 44. Best value: 0.252156:  47%|████▋     | 47/100 [01:45<01:53,  2.14s/it]Best trial: 44. Best value: 0.252156:  48%|████▊     | 48/100 [01:45<01:50,  2.13s/it]Best trial: 44. Best value: 0.252156:  48%|████▊     | 48/100 [01:47<01:50,  2.13s/it]Best trial: 44. Best value: 0.252156:  49%|████▉     | 49/100 [01:47<01:55,  2.26s/it]Best trial: 44. Best value: 0.252156:  49%|████▉     | 49/100 [01:49<01:55,  2.26s/it]Best trial: 44. Best value: 0.252156:  50%|█████     | 50/100 [01:49<01:48,  2.18s/it]Best trial: 44. Best value: 0.252156:  50%|█████     | 50/100 [01:51<01:48,  2.18s/it]Best trial: 44. Best value: 0.252156:  51%|█████     | 51/100 [01:51<01:39,  2.03s/it]Best trial: 44. Best value: 0.252156:  51%|█████     | 51/100 [01:53<01:39,  2.03s/it]Best trial: 44. Best value: 0.252156:  52%|█████▏    | 52/100 [01:53<01:41,  2.11s/it]Best trial: 44. Best value: 0.252156:  52%|█████▏    | 52/100 [01:55<01:41,  2.11s/it]Best trial: 44. Best value: 0.252156:  53%|█████▎    | 53/100 [01:55<01:36,  2.05s/it]Best trial: 44. Best value: 0.252156:  53%|█████▎    | 53/100 [01:57<01:36,  2.05s/it]Best trial: 44. Best value: 0.252156:  54%|█████▍    | 54/100 [01:57<01:35,  2.07s/it]Best trial: 44. Best value: 0.252156:  54%|█████▍    | 54/100 [01:59<01:35,  2.07s/it]Best trial: 44. Best value: 0.252156:  55%|█████▌    | 55/100 [01:59<01:34,  2.09s/it]Best trial: 44. Best value: 0.252156:  55%|█████▌    | 55/100 [02:02<01:34,  2.09s/it]Best trial: 44. Best value: 0.252156:  56%|█████▌    | 56/100 [02:02<01:36,  2.19s/it]Best trial: 44. Best value: 0.252156:  56%|█████▌    | 56/100 [02:04<01:36,  2.19s/it]Best trial: 44. Best value: 0.252156:  57%|█████▋    | 57/100 [02:04<01:32,  2.15s/it]Best trial: 44. Best value: 0.252156:  57%|█████▋    | 57/100 [02:06<01:32,  2.15s/it]Best trial: 44. Best value: 0.252156:  58%|█████▊    | 58/100 [02:06<01:26,  2.06s/it]Best trial: 44. Best value: 0.252156:  58%|█████▊    | 58/100 [02:08<01:26,  2.06s/it]Best trial: 44. Best value: 0.252156:  59%|█████▉    | 59/100 [02:08<01:22,  2.02s/it]Best trial: 44. Best value: 0.252156:  59%|█████▉    | 59/100 [02:09<01:22,  2.02s/it]Best trial: 44. Best value: 0.252156:  60%|██████    | 60/100 [02:09<01:17,  1.94s/it]Best trial: 44. Best value: 0.252156:  60%|██████    | 60/100 [02:11<01:17,  1.94s/it]Best trial: 44. Best value: 0.252156:  61%|██████    | 61/100 [02:11<01:16,  1.96s/it]Best trial: 44. Best value: 0.252156:  61%|██████    | 61/100 [02:13<01:16,  1.96s/it]Best trial: 44. Best value: 0.252156:  62%|██████▏   | 62/100 [02:13<01:13,  1.94s/it]Best trial: 44. Best value: 0.252156:  62%|██████▏   | 62/100 [02:15<01:13,  1.94s/it]Best trial: 44. Best value: 0.252156:  63%|██████▎   | 63/100 [02:15<01:10,  1.91s/it]Best trial: 44. Best value: 0.252156:  63%|██████▎   | 63/100 [02:17<01:10,  1.91s/it]Best trial: 44. Best value: 0.252156:  64%|██████▍   | 64/100 [02:17<01:10,  1.95s/it]Best trial: 44. Best value: 0.252156:  64%|██████▍   | 64/100 [02:19<01:10,  1.95s/it]Best trial: 44. Best value: 0.252156:  65%|██████▌   | 65/100 [02:19<01:09,  2.00s/it]Best trial: 44. Best value: 0.252156:  65%|██████▌   | 65/100 [02:21<01:09,  2.00s/it]Best trial: 44. Best value: 0.252156:  66%|██████▌   | 66/100 [02:21<01:08,  2.02s/it]Best trial: 44. Best value: 0.252156:  66%|██████▌   | 66/100 [02:24<01:08,  2.02s/it]Best trial: 44. Best value: 0.252156:  67%|██████▋   | 67/100 [02:24<01:09,  2.10s/it]Best trial: 67. Best value: 0.259649:  67%|██████▋   | 67/100 [02:26<01:09,  2.10s/it]Best trial: 67. Best value: 0.259649:  68%|██████▊   | 68/100 [02:26<01:08,  2.14s/it]Best trial: 67. Best value: 0.259649:  68%|██████▊   | 68/100 [02:28<01:08,  2.14s/it]Best trial: 67. Best value: 0.259649:  69%|██████▉   | 69/100 [02:28<01:07,  2.17s/it]Best trial: 67. Best value: 0.259649:  69%|██████▉   | 69/100 [02:30<01:07,  2.17s/it]Best trial: 67. Best value: 0.259649:  70%|███████   | 70/100 [02:30<01:04,  2.16s/it]Best trial: 67. Best value: 0.259649:  70%|███████   | 70/100 [02:33<01:04,  2.16s/it]Best trial: 67. Best value: 0.259649:  71%|███████   | 71/100 [02:33<01:04,  2.21s/it]Best trial: 67. Best value: 0.259649:  71%|███████   | 71/100 [02:35<01:04,  2.21s/it]Best trial: 67. Best value: 0.259649:  72%|███████▏  | 72/100 [02:35<01:00,  2.16s/it]Best trial: 67. Best value: 0.259649:  72%|███████▏  | 72/100 [02:37<01:00,  2.16s/it]Best trial: 67. Best value: 0.259649:  73%|███████▎  | 73/100 [02:37<00:56,  2.09s/it]Best trial: 67. Best value: 0.259649:  73%|███████▎  | 73/100 [02:39<00:56,  2.09s/it]Best trial: 67. Best value: 0.259649:  74%|███████▍  | 74/100 [02:39<00:54,  2.08s/it]Best trial: 67. Best value: 0.259649:  74%|███████▍  | 74/100 [02:41<00:54,  2.08s/it]Best trial: 67. Best value: 0.259649:  75%|███████▌  | 75/100 [02:41<00:54,  2.19s/it]Best trial: 67. Best value: 0.259649:  75%|███████▌  | 75/100 [02:43<00:54,  2.19s/it]Best trial: 67. Best value: 0.259649:  76%|███████▌  | 76/100 [02:43<00:51,  2.16s/it]Best trial: 67. Best value: 0.259649:  76%|███████▌  | 76/100 [02:45<00:51,  2.16s/it]Best trial: 67. Best value: 0.259649:  77%|███████▋  | 77/100 [02:45<00:50,  2.21s/it]Best trial: 67. Best value: 0.259649:  77%|███████▋  | 77/100 [02:48<00:50,  2.21s/it]Best trial: 67. Best value: 0.259649:  78%|███████▊  | 78/100 [02:48<00:48,  2.21s/it]Best trial: 67. Best value: 0.259649:  78%|███████▊  | 78/100 [02:50<00:48,  2.21s/it]Best trial: 67. Best value: 0.259649:  79%|███████▉  | 79/100 [02:50<00:45,  2.16s/it]Best trial: 67. Best value: 0.259649:  79%|███████▉  | 79/100 [02:52<00:45,  2.16s/it]Best trial: 67. Best value: 0.259649:  80%|████████  | 80/100 [02:52<00:44,  2.24s/it]Best trial: 67. Best value: 0.259649:  80%|████████  | 80/100 [02:54<00:44,  2.24s/it]Best trial: 67. Best value: 0.259649:  81%|████████  | 81/100 [02:54<00:41,  2.21s/it]Best trial: 67. Best value: 0.259649:  81%|████████  | 81/100 [02:57<00:41,  2.21s/it]Best trial: 67. Best value: 0.259649:  82%|████████▏ | 82/100 [02:57<00:40,  2.24s/it]Best trial: 67. Best value: 0.259649:  82%|████████▏ | 82/100 [02:59<00:40,  2.24s/it]Best trial: 67. Best value: 0.259649:  83%|████████▎ | 83/100 [02:59<00:37,  2.20s/it]Best trial: 67. Best value: 0.259649:  83%|████████▎ | 83/100 [03:01<00:37,  2.20s/it]Best trial: 67. Best value: 0.259649:  84%|████████▍ | 84/100 [03:01<00:35,  2.19s/it]Best trial: 67. Best value: 0.259649:  84%|████████▍ | 84/100 [03:03<00:35,  2.19s/it]Best trial: 67. Best value: 0.259649:  85%|████████▌ | 85/100 [03:03<00:32,  2.16s/it]Best trial: 67. Best value: 0.259649:  85%|████████▌ | 85/100 [03:05<00:32,  2.16s/it]Best trial: 67. Best value: 0.259649:  86%|████████▌ | 86/100 [03:05<00:29,  2.11s/it]Best trial: 67. Best value: 0.259649:  86%|████████▌ | 86/100 [03:08<00:29,  2.11s/it]Best trial: 67. Best value: 0.259649:  87%|████████▋ | 87/100 [03:08<00:29,  2.27s/it]Best trial: 67. Best value: 0.259649:  87%|████████▋ | 87/100 [03:10<00:29,  2.27s/it]Best trial: 67. Best value: 0.259649:  88%|████████▊ | 88/100 [03:10<00:26,  2.25s/it]Best trial: 67. Best value: 0.259649:  88%|████████▊ | 88/100 [03:12<00:26,  2.25s/it]Best trial: 67. Best value: 0.259649:  89%|████████▉ | 89/100 [03:12<00:24,  2.26s/it]Best trial: 67. Best value: 0.259649:  89%|████████▉ | 89/100 [03:14<00:24,  2.26s/it]Best trial: 67. Best value: 0.259649:  90%|█████████ | 90/100 [03:14<00:22,  2.25s/it]Best trial: 67. Best value: 0.259649:  90%|█████████ | 90/100 [03:17<00:22,  2.25s/it]Best trial: 67. Best value: 0.259649:  91%|█████████ | 91/100 [03:17<00:20,  2.32s/it]Best trial: 67. Best value: 0.259649:  91%|█████████ | 91/100 [03:19<00:20,  2.32s/it]Best trial: 67. Best value: 0.259649:  92%|█████████▏| 92/100 [03:19<00:17,  2.23s/it]Best trial: 67. Best value: 0.259649:  92%|█████████▏| 92/100 [03:21<00:17,  2.23s/it]Best trial: 67. Best value: 0.259649:  93%|█████████▎| 93/100 [03:21<00:15,  2.17s/it]Best trial: 67. Best value: 0.259649:  93%|█████████▎| 93/100 [03:23<00:15,  2.17s/it]Best trial: 67. Best value: 0.259649:  94%|█████████▍| 94/100 [03:23<00:12,  2.08s/it]Best trial: 67. Best value: 0.259649:  94%|█████████▍| 94/100 [03:25<00:12,  2.08s/it]Best trial: 67. Best value: 0.259649:  95%|█████████▌| 95/100 [03:25<00:10,  2.07s/it]Best trial: 67. Best value: 0.259649:  95%|█████████▌| 95/100 [03:27<00:10,  2.07s/it]Best trial: 67. Best value: 0.259649:  96%|█████████▌| 96/100 [03:27<00:08,  2.05s/it]Best trial: 67. Best value: 0.259649:  96%|█████████▌| 96/100 [03:29<00:08,  2.05s/it]Best trial: 67. Best value: 0.259649:  97%|█████████▋| 97/100 [03:29<00:06,  2.02s/it]Best trial: 67. Best value: 0.259649:  97%|█████████▋| 97/100 [03:31<00:06,  2.02s/it]Best trial: 67. Best value: 0.259649:  98%|█████████▊| 98/100 [03:31<00:04,  2.09s/it]Best trial: 67. Best value: 0.259649:  98%|█████████▊| 98/100 [03:33<00:04,  2.09s/it]Best trial: 67. Best value: 0.259649:  99%|█████████▉| 99/100 [03:33<00:02,  2.15s/it]Best trial: 67. Best value: 0.259649:  99%|█████████▉| 99/100 [03:35<00:02,  2.15s/it]Best trial: 67. Best value: 0.259649: 100%|██████████| 100/100 [03:35<00:00,  2.17s/it]Best trial: 67. Best value: 0.259649: 100%|██████████| 100/100 [03:35<00:00,  2.16s/it]
2025-11-30 16:33:34,997 - INFO - HPO Complete. Best AUPRC: 0.2596
2025-11-30 16:33:34,997 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0005527179242700059, 'max_depth': 4, 'subsample': 0.6113929489680433, 'colsample_bytree': 0.6586934206531562, 'gamma': 3.3595594623984697, 'reg_lambda': 0.1386978105005112, 'reg_alpha': 8.805517125145379e-07}
2025-11-30 16:33:34,997 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:33:36,834 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 16:33:36,834 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:33:37,026 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:33:37,061 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:33:37,069 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 16:33:37,069 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:33:37,069 - INFO - Training model...
2025-11-30 16:33:38,642 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:33:44,154 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:33:44,154 - INFO - AUROC: 0.6732 (0.3950 - 0.8420)
2025-11-30 16:33:44,154 - INFO - AUPRC: 0.0465 (0.0066 - 0.2602)
2025-11-30 16:33:44,154 - INFO - Brier Score: 0.1620 (0.1607 - 0.1635)
2025-11-30 16:33:44,154 - INFO - Accuracy: 0.9827 (0.2809 - 0.9855)
2025-11-30 16:33:44,154 - INFO - Precision: 0.1250 (0.0065 - 0.4400)
2025-11-30 16:33:44,154 - INFO - Sensitivity (Recall): 0.1667 (0.1194 - 1.0000)
2025-11-30 16:33:44,154 - INFO - F1-Score: 0.1429 (0.0128 - 0.3529)
2025-11-30 16:33:44,155 - INFO - Best Threshold: 0.4500 (0.3900 - 0.4500)
2025-11-30 16:33:44,155 - INFO - Specificity: 0.9898 (0.2734 - 0.9956)
2025-11-30 16:33:44,166 - INFO - Calculating SHAP values...
2025-11-30 16:33:45,209 - INFO - SHAP plots saved.
2025-11-30 16:33:45,210 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:33:46,363 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 16:33:46,363 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:33:46,562 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:33:46,633 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:33:46,648 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:33:46,648 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.135782:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.135782:   1%|          | 1/100 [00:05<08:20,  5.06s/it]Best trial: 1. Best value: 0.152946:   1%|          | 1/100 [00:09<08:20,  5.06s/it]Best trial: 1. Best value: 0.152946:   2%|▏         | 2/100 [00:09<07:32,  4.62s/it]Best trial: 1. Best value: 0.152946:   2%|▏         | 2/100 [00:14<07:32,  4.62s/it]Best trial: 1. Best value: 0.152946:   3%|▎         | 3/100 [00:14<08:07,  5.03s/it]Best trial: 3. Best value: 0.187645:   3%|▎         | 3/100 [00:18<08:07,  5.03s/it]Best trial: 3. Best value: 0.187645:   4%|▍         | 4/100 [00:18<07:26,  4.65s/it]Best trial: 4. Best value: 0.217964:   4%|▍         | 4/100 [00:24<07:26,  4.65s/it]Best trial: 4. Best value: 0.217964:   5%|▌         | 5/100 [00:24<07:47,  4.92s/it]Best trial: 4. Best value: 0.217964:   5%|▌         | 5/100 [00:30<07:47,  4.92s/it]Best trial: 4. Best value: 0.217964:   6%|▌         | 6/100 [00:30<08:25,  5.38s/it]Best trial: 4. Best value: 0.217964:   6%|▌         | 6/100 [00:35<08:25,  5.38s/it]Best trial: 4. Best value: 0.217964:   7%|▋         | 7/100 [00:35<08:16,  5.34s/it]Best trial: 4. Best value: 0.217964:   7%|▋         | 7/100 [00:41<08:16,  5.34s/it]Best trial: 4. Best value: 0.217964:   8%|▊         | 8/100 [00:41<08:17,  5.40s/it]Best trial: 4. Best value: 0.217964:   8%|▊         | 8/100 [00:49<08:17,  5.40s/it]Best trial: 4. Best value: 0.217964:   9%|▉         | 9/100 [00:49<09:34,  6.31s/it]Best trial: 4. Best value: 0.217964:   9%|▉         | 9/100 [00:55<09:34,  6.31s/it]Best trial: 4. Best value: 0.217964:  10%|█         | 10/100 [00:55<09:10,  6.12s/it]Best trial: 4. Best value: 0.217964:  10%|█         | 10/100 [01:01<09:10,  6.12s/it]Best trial: 4. Best value: 0.217964:  11%|█         | 11/100 [01:01<09:14,  6.23s/it]Best trial: 11. Best value: 0.237195:  11%|█         | 11/100 [01:08<09:14,  6.23s/it]Best trial: 11. Best value: 0.237195:  12%|█▏        | 12/100 [01:08<09:15,  6.31s/it]Best trial: 12. Best value: 0.247546:  12%|█▏        | 12/100 [01:14<09:15,  6.31s/it]Best trial: 12. Best value: 0.247546:  13%|█▎        | 13/100 [01:14<09:08,  6.31s/it]Best trial: 12. Best value: 0.247546:  13%|█▎        | 13/100 [01:20<09:08,  6.31s/it]Best trial: 12. Best value: 0.247546:  14%|█▍        | 14/100 [01:20<08:39,  6.04s/it]Best trial: 12. Best value: 0.247546:  14%|█▍        | 14/100 [01:26<08:39,  6.04s/it]Best trial: 12. Best value: 0.247546:  15%|█▌        | 15/100 [01:26<08:31,  6.01s/it]Best trial: 12. Best value: 0.247546:  15%|█▌        | 15/100 [01:33<08:31,  6.01s/it]Best trial: 12. Best value: 0.247546:  16%|█▌        | 16/100 [01:33<08:50,  6.32s/it]Best trial: 12. Best value: 0.247546:  16%|█▌        | 16/100 [01:38<08:50,  6.32s/it]Best trial: 12. Best value: 0.247546:  17%|█▋        | 17/100 [01:38<08:29,  6.14s/it]Best trial: 12. Best value: 0.247546:  17%|█▋        | 17/100 [01:45<08:29,  6.14s/it]Best trial: 12. Best value: 0.247546:  18%|█▊        | 18/100 [01:45<08:31,  6.23s/it]Best trial: 12. Best value: 0.247546:  18%|█▊        | 18/100 [01:49<08:31,  6.23s/it]Best trial: 12. Best value: 0.247546:  19%|█▉        | 19/100 [01:49<07:30,  5.56s/it]Best trial: 12. Best value: 0.247546:  19%|█▉        | 19/100 [01:56<07:30,  5.56s/it]Best trial: 12. Best value: 0.247546:  20%|██        | 20/100 [01:56<08:03,  6.04s/it]Best trial: 12. Best value: 0.247546:  20%|██        | 20/100 [02:01<08:03,  6.04s/it]Best trial: 12. Best value: 0.247546:  21%|██        | 21/100 [02:01<07:44,  5.88s/it]Best trial: 12. Best value: 0.247546:  21%|██        | 21/100 [02:08<07:44,  5.88s/it]Best trial: 12. Best value: 0.247546:  22%|██▏       | 22/100 [02:08<07:54,  6.08s/it]Best trial: 12. Best value: 0.247546:  22%|██▏       | 22/100 [02:15<07:54,  6.08s/it]Best trial: 12. Best value: 0.247546:  23%|██▎       | 23/100 [02:15<08:14,  6.42s/it]Best trial: 12. Best value: 0.247546:  23%|██▎       | 23/100 [02:21<08:14,  6.42s/it]Best trial: 12. Best value: 0.247546:  24%|██▍       | 24/100 [02:21<07:46,  6.14s/it]Best trial: 12. Best value: 0.247546:  24%|██▍       | 24/100 [02:27<07:46,  6.14s/it]Best trial: 12. Best value: 0.247546:  25%|██▌       | 25/100 [02:27<07:51,  6.29s/it]Best trial: 12. Best value: 0.247546:  25%|██▌       | 25/100 [02:34<07:51,  6.29s/it]Best trial: 12. Best value: 0.247546:  26%|██▌       | 26/100 [02:34<07:55,  6.42s/it]Best trial: 12. Best value: 0.247546:  26%|██▌       | 26/100 [02:41<07:55,  6.42s/it]Best trial: 12. Best value: 0.247546:  27%|██▋       | 27/100 [02:41<08:01,  6.60s/it]Best trial: 12. Best value: 0.247546:  27%|██▋       | 27/100 [02:46<08:01,  6.60s/it]Best trial: 12. Best value: 0.247546:  28%|██▊       | 28/100 [02:46<07:15,  6.05s/it]Best trial: 12. Best value: 0.247546:  28%|██▊       | 28/100 [02:51<07:15,  6.05s/it]Best trial: 12. Best value: 0.247546:  29%|██▉       | 29/100 [02:51<06:49,  5.77s/it]Best trial: 12. Best value: 0.247546:  29%|██▉       | 29/100 [02:55<06:49,  5.77s/it]Best trial: 12. Best value: 0.247546:  30%|███       | 30/100 [02:55<06:11,  5.31s/it]Best trial: 12. Best value: 0.247546:  30%|███       | 30/100 [03:00<06:11,  5.31s/it]Best trial: 12. Best value: 0.247546:  31%|███       | 31/100 [03:00<06:02,  5.25s/it]Best trial: 12. Best value: 0.247546:  31%|███       | 31/100 [03:05<06:02,  5.25s/it]Best trial: 12. Best value: 0.247546:  32%|███▏      | 32/100 [03:05<05:43,  5.05s/it]Best trial: 12. Best value: 0.247546:  32%|███▏      | 32/100 [03:10<05:43,  5.05s/it]Best trial: 12. Best value: 0.247546:  33%|███▎      | 33/100 [03:10<05:31,  4.94s/it]Best trial: 33. Best value: 0.268042:  33%|███▎      | 33/100 [03:14<05:31,  4.94s/it]Best trial: 33. Best value: 0.268042:  34%|███▍      | 34/100 [03:14<05:17,  4.81s/it]Best trial: 33. Best value: 0.268042:  34%|███▍      | 34/100 [03:20<05:17,  4.81s/it]Best trial: 33. Best value: 0.268042:  35%|███▌      | 35/100 [03:20<05:35,  5.17s/it]Best trial: 33. Best value: 0.268042:  35%|███▌      | 35/100 [03:25<05:35,  5.17s/it]Best trial: 33. Best value: 0.268042:  36%|███▌      | 36/100 [03:25<05:28,  5.13s/it]Best trial: 33. Best value: 0.268042:  36%|███▌      | 36/100 [03:30<05:28,  5.13s/it]Best trial: 33. Best value: 0.268042:  37%|███▋      | 37/100 [03:30<05:13,  4.98s/it]Best trial: 33. Best value: 0.268042:  37%|███▋      | 37/100 [03:34<05:13,  4.98s/it]Best trial: 33. Best value: 0.268042:  38%|███▊      | 38/100 [03:34<05:01,  4.87s/it]Best trial: 33. Best value: 0.268042:  38%|███▊      | 38/100 [03:39<05:01,  4.87s/it]Best trial: 33. Best value: 0.268042:  39%|███▉      | 39/100 [03:39<04:59,  4.91s/it]Best trial: 33. Best value: 0.268042:  39%|███▉      | 39/100 [03:45<04:59,  4.91s/it]Best trial: 33. Best value: 0.268042:  40%|████      | 40/100 [03:45<05:03,  5.06s/it]Best trial: 33. Best value: 0.268042:  40%|████      | 40/100 [03:50<05:03,  5.06s/it]Best trial: 33. Best value: 0.268042:  41%|████      | 41/100 [03:50<05:07,  5.20s/it]Best trial: 33. Best value: 0.268042:  41%|████      | 41/100 [03:56<05:07,  5.20s/it]Best trial: 33. Best value: 0.268042:  42%|████▏     | 42/100 [03:56<05:11,  5.37s/it]Best trial: 33. Best value: 0.268042:  42%|████▏     | 42/100 [04:01<05:11,  5.37s/it]Best trial: 33. Best value: 0.268042:  43%|████▎     | 43/100 [04:01<04:58,  5.24s/it]Best trial: 33. Best value: 0.268042:  43%|████▎     | 43/100 [04:06<04:58,  5.24s/it]Best trial: 33. Best value: 0.268042:  44%|████▍     | 44/100 [04:06<04:47,  5.13s/it]Best trial: 33. Best value: 0.268042:  44%|████▍     | 44/100 [04:11<04:47,  5.13s/it]Best trial: 33. Best value: 0.268042:  45%|████▌     | 45/100 [04:11<04:41,  5.12s/it]Best trial: 33. Best value: 0.268042:  45%|████▌     | 45/100 [04:17<04:41,  5.12s/it]Best trial: 33. Best value: 0.268042:  46%|████▌     | 46/100 [04:17<04:51,  5.40s/it]Best trial: 33. Best value: 0.268042:  46%|████▌     | 46/100 [04:22<04:51,  5.40s/it]Best trial: 33. Best value: 0.268042:  47%|████▋     | 47/100 [04:22<04:44,  5.36s/it]Best trial: 33. Best value: 0.268042:  47%|████▋     | 47/100 [04:29<04:44,  5.36s/it]Best trial: 33. Best value: 0.268042:  48%|████▊     | 48/100 [04:29<05:07,  5.91s/it]Best trial: 33. Best value: 0.268042:  48%|████▊     | 48/100 [04:35<05:07,  5.91s/it]Best trial: 33. Best value: 0.268042:  49%|████▉     | 49/100 [04:35<04:54,  5.77s/it]Best trial: 33. Best value: 0.268042:  49%|████▉     | 49/100 [04:40<04:54,  5.77s/it]Best trial: 33. Best value: 0.268042:  50%|█████     | 50/100 [04:40<04:42,  5.65s/it]Best trial: 33. Best value: 0.268042:  50%|█████     | 50/100 [04:45<04:42,  5.65s/it]Best trial: 33. Best value: 0.268042:  51%|█████     | 51/100 [04:45<04:28,  5.48s/it]Best trial: 33. Best value: 0.268042:  51%|█████     | 51/100 [04:51<04:28,  5.48s/it]Best trial: 33. Best value: 0.268042:  52%|█████▏    | 52/100 [04:51<04:26,  5.55s/it]Best trial: 33. Best value: 0.268042:  52%|█████▏    | 52/100 [04:56<04:26,  5.55s/it]Best trial: 33. Best value: 0.268042:  53%|█████▎    | 53/100 [04:56<04:14,  5.41s/it]Best trial: 33. Best value: 0.268042:  53%|█████▎    | 53/100 [05:01<04:14,  5.41s/it]Best trial: 33. Best value: 0.268042:  54%|█████▍    | 54/100 [05:01<03:57,  5.17s/it]Best trial: 33. Best value: 0.268042:  54%|█████▍    | 54/100 [05:07<03:57,  5.17s/it]Best trial: 33. Best value: 0.268042:  55%|█████▌    | 55/100 [05:07<04:02,  5.40s/it]Best trial: 33. Best value: 0.268042:  55%|█████▌    | 55/100 [05:14<04:02,  5.40s/it]Best trial: 33. Best value: 0.268042:  56%|█████▌    | 56/100 [05:14<04:18,  5.87s/it]Best trial: 33. Best value: 0.268042:  56%|█████▌    | 56/100 [05:20<04:18,  5.87s/it]Best trial: 33. Best value: 0.268042:  57%|█████▋    | 57/100 [05:20<04:13,  5.88s/it]Best trial: 33. Best value: 0.268042:  57%|█████▋    | 57/100 [05:24<04:13,  5.88s/it]Best trial: 33. Best value: 0.268042:  58%|█████▊    | 58/100 [05:24<03:51,  5.51s/it]Best trial: 33. Best value: 0.268042:  58%|█████▊    | 58/100 [05:29<03:51,  5.51s/it]Best trial: 33. Best value: 0.268042:  59%|█████▉    | 59/100 [05:29<03:34,  5.24s/it]Best trial: 33. Best value: 0.268042:  59%|█████▉    | 59/100 [05:34<03:34,  5.24s/it]Best trial: 33. Best value: 0.268042:  60%|██████    | 60/100 [05:34<03:32,  5.31s/it]Best trial: 33. Best value: 0.268042:  60%|██████    | 60/100 [05:40<03:32,  5.31s/it]Best trial: 33. Best value: 0.268042:  61%|██████    | 61/100 [05:40<03:26,  5.30s/it]Best trial: 33. Best value: 0.268042:  61%|██████    | 61/100 [05:46<03:26,  5.30s/it]Best trial: 33. Best value: 0.268042:  62%|██████▏   | 62/100 [05:46<03:30,  5.54s/it]Best trial: 33. Best value: 0.268042:  62%|██████▏   | 62/100 [05:53<03:30,  5.54s/it]Best trial: 33. Best value: 0.268042:  63%|██████▎   | 63/100 [05:53<03:45,  6.09s/it]Best trial: 33. Best value: 0.268042:  63%|██████▎   | 63/100 [05:58<03:45,  6.09s/it]Best trial: 33. Best value: 0.268042:  64%|██████▍   | 64/100 [05:58<03:23,  5.66s/it]Best trial: 33. Best value: 0.268042:  64%|██████▍   | 64/100 [06:03<03:23,  5.66s/it]Best trial: 33. Best value: 0.268042:  65%|██████▌   | 65/100 [06:03<03:09,  5.40s/it]Best trial: 33. Best value: 0.268042:  65%|██████▌   | 65/100 [06:08<03:09,  5.40s/it]Best trial: 33. Best value: 0.268042:  66%|██████▌   | 66/100 [06:08<03:04,  5.41s/it]Best trial: 33. Best value: 0.268042:  66%|██████▌   | 66/100 [06:13<03:04,  5.41s/it]Best trial: 33. Best value: 0.268042:  67%|██████▋   | 67/100 [06:13<02:55,  5.31s/it]Best trial: 33. Best value: 0.268042:  67%|██████▋   | 67/100 [06:20<02:55,  5.31s/it]Best trial: 33. Best value: 0.268042:  68%|██████▊   | 68/100 [06:20<03:05,  5.79s/it]Best trial: 33. Best value: 0.268042:  68%|██████▊   | 68/100 [06:25<03:05,  5.79s/it]Best trial: 33. Best value: 0.268042:  69%|██████▉   | 69/100 [06:25<02:54,  5.63s/it]Best trial: 33. Best value: 0.268042:  69%|██████▉   | 69/100 [06:31<02:54,  5.63s/it]Best trial: 33. Best value: 0.268042:  70%|███████   | 70/100 [06:31<02:47,  5.58s/it]Best trial: 33. Best value: 0.268042:  70%|███████   | 70/100 [06:36<02:47,  5.58s/it]Best trial: 33. Best value: 0.268042:  71%|███████   | 71/100 [06:36<02:42,  5.60s/it]Best trial: 33. Best value: 0.268042:  71%|███████   | 71/100 [06:42<02:42,  5.60s/it]Best trial: 33. Best value: 0.268042:  72%|███████▏  | 72/100 [06:42<02:38,  5.66s/it]Best trial: 33. Best value: 0.268042:  72%|███████▏  | 72/100 [06:47<02:38,  5.66s/it]Best trial: 33. Best value: 0.268042:  73%|███████▎  | 73/100 [06:47<02:26,  5.43s/it]Best trial: 33. Best value: 0.268042:  73%|███████▎  | 73/100 [06:53<02:26,  5.43s/it]Best trial: 33. Best value: 0.268042:  74%|███████▍  | 74/100 [06:53<02:29,  5.74s/it]Best trial: 33. Best value: 0.268042:  74%|███████▍  | 74/100 [07:00<02:29,  5.74s/it]Best trial: 33. Best value: 0.268042:  75%|███████▌  | 75/100 [07:00<02:25,  5.84s/it]Best trial: 33. Best value: 0.268042:  75%|███████▌  | 75/100 [07:05<02:25,  5.84s/it]Best trial: 33. Best value: 0.268042:  76%|███████▌  | 76/100 [07:05<02:19,  5.81s/it]Best trial: 33. Best value: 0.268042:  76%|███████▌  | 76/100 [07:11<02:19,  5.81s/it]Best trial: 33. Best value: 0.268042:  77%|███████▋  | 77/100 [07:11<02:11,  5.71s/it]Best trial: 33. Best value: 0.268042:  77%|███████▋  | 77/100 [07:16<02:11,  5.71s/it]Best trial: 33. Best value: 0.268042:  78%|███████▊  | 78/100 [07:16<02:02,  5.58s/it]Best trial: 33. Best value: 0.268042:  78%|███████▊  | 78/100 [07:23<02:02,  5.58s/it]Best trial: 33. Best value: 0.268042:  79%|███████▉  | 79/100 [07:23<02:02,  5.85s/it]Best trial: 33. Best value: 0.268042:  79%|███████▉  | 79/100 [07:29<02:02,  5.85s/it]Best trial: 33. Best value: 0.268042:  80%|████████  | 80/100 [07:29<01:59,  5.99s/it]Best trial: 33. Best value: 0.268042:  80%|████████  | 80/100 [07:34<01:59,  5.99s/it]Best trial: 33. Best value: 0.268042:  81%|████████  | 81/100 [07:34<01:48,  5.71s/it]Best trial: 33. Best value: 0.268042:  81%|████████  | 81/100 [07:40<01:48,  5.71s/it]Best trial: 33. Best value: 0.268042:  82%|████████▏ | 82/100 [07:40<01:42,  5.70s/it]Best trial: 33. Best value: 0.268042:  82%|████████▏ | 82/100 [07:45<01:42,  5.70s/it]Best trial: 33. Best value: 0.268042:  83%|████████▎ | 83/100 [07:45<01:34,  5.56s/it]Best trial: 33. Best value: 0.268042:  83%|████████▎ | 83/100 [07:50<01:34,  5.56s/it]Best trial: 33. Best value: 0.268042:  84%|████████▍ | 84/100 [07:50<01:28,  5.52s/it]Best trial: 33. Best value: 0.268042:  84%|████████▍ | 84/100 [07:57<01:28,  5.52s/it]Best trial: 33. Best value: 0.268042:  85%|████████▌ | 85/100 [07:57<01:30,  6.05s/it]Best trial: 33. Best value: 0.268042:  85%|████████▌ | 85/100 [08:02<01:30,  6.05s/it]Best trial: 33. Best value: 0.268042:  86%|████████▌ | 86/100 [08:02<01:20,  5.72s/it]Best trial: 33. Best value: 0.268042:  86%|████████▌ | 86/100 [08:09<01:20,  5.72s/it]Best trial: 33. Best value: 0.268042:  87%|████████▋ | 87/100 [08:09<01:16,  5.89s/it]Best trial: 33. Best value: 0.268042:  87%|████████▋ | 87/100 [08:13<01:16,  5.89s/it]Best trial: 33. Best value: 0.268042:  88%|████████▊ | 88/100 [08:13<01:05,  5.49s/it]Best trial: 33. Best value: 0.268042:  88%|████████▊ | 88/100 [08:19<01:05,  5.49s/it]Best trial: 33. Best value: 0.268042:  89%|████████▉ | 89/100 [08:19<01:01,  5.57s/it]Best trial: 33. Best value: 0.268042:  89%|████████▉ | 89/100 [08:25<01:01,  5.57s/it]Best trial: 33. Best value: 0.268042:  90%|█████████ | 90/100 [08:25<00:56,  5.61s/it]Best trial: 33. Best value: 0.268042:  90%|█████████ | 90/100 [08:30<00:56,  5.61s/it]Best trial: 33. Best value: 0.268042:  91%|█████████ | 91/100 [08:30<00:48,  5.41s/it]Best trial: 33. Best value: 0.268042:  91%|█████████ | 91/100 [08:35<00:48,  5.41s/it]Best trial: 33. Best value: 0.268042:  92%|█████████▏| 92/100 [08:35<00:42,  5.32s/it]Best trial: 33. Best value: 0.268042:  92%|█████████▏| 92/100 [08:41<00:42,  5.32s/it]Best trial: 33. Best value: 0.268042:  93%|█████████▎| 93/100 [08:41<00:38,  5.49s/it]Best trial: 33. Best value: 0.268042:  93%|█████████▎| 93/100 [08:49<00:38,  5.49s/it]Best trial: 33. Best value: 0.268042:  94%|█████████▍| 94/100 [08:49<00:37,  6.19s/it]Best trial: 33. Best value: 0.268042:  94%|█████████▍| 94/100 [08:57<00:37,  6.19s/it]Best trial: 33. Best value: 0.268042:  95%|█████████▌| 95/100 [08:57<00:33,  6.79s/it]Best trial: 33. Best value: 0.268042:  95%|█████████▌| 95/100 [09:02<00:33,  6.79s/it]Best trial: 33. Best value: 0.268042:  96%|█████████▌| 96/100 [09:02<00:25,  6.40s/it]Best trial: 33. Best value: 0.268042:  96%|█████████▌| 96/100 [09:08<00:25,  6.40s/it]Best trial: 33. Best value: 0.268042:  97%|█████████▋| 97/100 [09:08<00:18,  6.21s/it]Best trial: 33. Best value: 0.268042:  97%|█████████▋| 97/100 [09:15<00:18,  6.21s/it]Best trial: 33. Best value: 0.268042:  98%|█████████▊| 98/100 [09:15<00:13,  6.51s/it]Best trial: 33. Best value: 0.268042:  98%|█████████▊| 98/100 [09:22<00:13,  6.51s/it]Best trial: 33. Best value: 0.268042:  99%|█████████▉| 99/100 [09:22<00:06,  6.57s/it]Best trial: 33. Best value: 0.268042:  99%|█████████▉| 99/100 [09:29<00:06,  6.57s/it]Best trial: 33. Best value: 0.268042: 100%|██████████| 100/100 [09:29<00:00,  6.63s/it]Best trial: 33. Best value: 0.268042: 100%|██████████| 100/100 [09:29<00:00,  5.69s/it]
2025-11-30 16:43:15,811 - INFO - HPO Complete. Best AUPRC: 0.2680
2025-11-30 16:43:15,811 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.00010444371495993245, 'max_depth': 7, 'subsample': 0.7861284768884456, 'colsample_bytree': 0.690438409184136, 'gamma': 3.536212908185417, 'reg_lambda': 9.924153286420988e-07, 'reg_alpha': 3.9260859043754425e-05}
2025-11-30 16:43:15,812 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:43:17,828 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 16:43:17,828 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:43:18,047 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:43:18,115 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:43:18,129 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:43:18,129 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:43:18,129 - INFO - Training model...
2025-11-30 16:43:29,559 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:43:36,239 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:43:36,239 - INFO - AUROC: 0.5309 (0.1637 - 0.8317)
2025-11-30 16:43:36,240 - INFO - AUPRC: 0.0146 (0.0043 - 0.0460)
2025-11-30 16:43:36,240 - INFO - Brier Score: 0.2071 (0.2066 - 0.2077)
2025-11-30 16:43:36,240 - INFO - Accuracy: 0.9046 (0.0043 - 0.9173)
2025-11-30 16:43:36,240 - INFO - Precision: 0.0161 (0.0043 - 0.0546)
2025-11-30 16:43:36,240 - INFO - Sensitivity (Recall): 0.1667 (0.1357 - 1.0000)
2025-11-30 16:43:36,240 - INFO - F1-Score: 0.0294 (0.0086 - 0.0950)
2025-11-30 16:43:36,240 - INFO - Best Threshold: 0.4600 (0.0100 - 0.4600)
2025-11-30 16:43:36,240 - INFO - Specificity: 0.9111 (0.0000 - 0.9237)
2025-11-30 16:43:36,272 - INFO - Calculating SHAP values...
2025-11-30 16:43:37,665 - INFO - SHAP plots saved.
2025-11-30 16:43:37,669 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:43:38,979 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 16:43:38,980 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:43:39,200 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:43:39,270 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:43:39,283 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:43:39,283 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.0800489:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.0800489:   1%|          | 1/100 [00:06<11:14,  6.81s/it]Best trial: 0. Best value: 0.0800489:   1%|          | 1/100 [00:12<11:14,  6.81s/it]Best trial: 0. Best value: 0.0800489:   2%|▏         | 2/100 [00:12<09:57,  6.09s/it]Best trial: 0. Best value: 0.0800489:   2%|▏         | 2/100 [00:17<09:57,  6.09s/it]Best trial: 0. Best value: 0.0800489:   3%|▎         | 3/100 [00:17<08:46,  5.42s/it]Best trial: 0. Best value: 0.0800489:   3%|▎         | 3/100 [00:20<08:46,  5.42s/it]Best trial: 0. Best value: 0.0800489:   4%|▍         | 4/100 [00:20<07:42,  4.82s/it]Best trial: 0. Best value: 0.0800489:   4%|▍         | 4/100 [00:26<07:42,  4.82s/it]Best trial: 0. Best value: 0.0800489:   5%|▌         | 5/100 [00:26<07:57,  5.03s/it]Best trial: 5. Best value: 0.146454:   5%|▌         | 5/100 [00:32<07:57,  5.03s/it] Best trial: 5. Best value: 0.146454:   6%|▌         | 6/100 [00:32<08:18,  5.31s/it]Best trial: 5. Best value: 0.146454:   6%|▌         | 6/100 [00:36<08:18,  5.31s/it]Best trial: 5. Best value: 0.146454:   7%|▋         | 7/100 [00:36<07:48,  5.04s/it]Best trial: 5. Best value: 0.146454:   7%|▋         | 7/100 [00:41<07:48,  5.04s/it]Best trial: 5. Best value: 0.146454:   8%|▊         | 8/100 [00:41<07:32,  4.92s/it]Best trial: 8. Best value: 0.175568:   8%|▊         | 8/100 [00:45<07:32,  4.92s/it]Best trial: 8. Best value: 0.175568:   9%|▉         | 9/100 [00:45<06:57,  4.59s/it]Best trial: 8. Best value: 0.175568:   9%|▉         | 9/100 [00:49<06:57,  4.59s/it]Best trial: 8. Best value: 0.175568:  10%|█         | 10/100 [00:49<06:48,  4.54s/it]Best trial: 8. Best value: 0.175568:  10%|█         | 10/100 [00:53<06:48,  4.54s/it]Best trial: 8. Best value: 0.175568:  11%|█         | 11/100 [00:53<06:27,  4.35s/it]Best trial: 8. Best value: 0.175568:  11%|█         | 11/100 [01:00<06:27,  4.35s/it]Best trial: 8. Best value: 0.175568:  12%|█▏        | 12/100 [01:00<07:31,  5.13s/it]Best trial: 8. Best value: 0.175568:  12%|█▏        | 12/100 [01:08<07:31,  5.13s/it]Best trial: 8. Best value: 0.175568:  13%|█▎        | 13/100 [01:08<08:40,  5.98s/it]Best trial: 8. Best value: 0.175568:  13%|█▎        | 13/100 [01:13<08:40,  5.98s/it]Best trial: 8. Best value: 0.175568:  14%|█▍        | 14/100 [01:13<08:08,  5.68s/it]Best trial: 8. Best value: 0.175568:  14%|█▍        | 14/100 [01:16<08:08,  5.68s/it]Best trial: 8. Best value: 0.175568:  15%|█▌        | 15/100 [01:16<07:01,  4.96s/it]Best trial: 8. Best value: 0.175568:  15%|█▌        | 15/100 [01:23<07:01,  4.96s/it]Best trial: 8. Best value: 0.175568:  16%|█▌        | 16/100 [01:23<07:44,  5.53s/it]Best trial: 8. Best value: 0.175568:  16%|█▌        | 16/100 [01:28<07:44,  5.53s/it]Best trial: 8. Best value: 0.175568:  17%|█▋        | 17/100 [01:28<07:22,  5.33s/it]Best trial: 8. Best value: 0.175568:  17%|█▋        | 17/100 [01:33<07:22,  5.33s/it]Best trial: 8. Best value: 0.175568:  18%|█▊        | 18/100 [01:33<07:23,  5.41s/it]Best trial: 8. Best value: 0.175568:  18%|█▊        | 18/100 [01:38<07:23,  5.41s/it]Best trial: 8. Best value: 0.175568:  19%|█▉        | 19/100 [01:38<07:00,  5.19s/it]Best trial: 8. Best value: 0.175568:  19%|█▉        | 19/100 [01:43<07:00,  5.19s/it]Best trial: 8. Best value: 0.175568:  20%|██        | 20/100 [01:43<06:44,  5.05s/it]Best trial: 8. Best value: 0.175568:  20%|██        | 20/100 [01:48<06:44,  5.05s/it]Best trial: 8. Best value: 0.175568:  21%|██        | 21/100 [01:48<06:49,  5.18s/it]Best trial: 8. Best value: 0.175568:  21%|██        | 21/100 [01:54<06:49,  5.18s/it]Best trial: 8. Best value: 0.175568:  22%|██▏       | 22/100 [01:54<06:59,  5.38s/it]Best trial: 8. Best value: 0.175568:  22%|██▏       | 22/100 [01:58<06:59,  5.38s/it]Best trial: 8. Best value: 0.175568:  23%|██▎       | 23/100 [01:58<06:25,  5.01s/it]Best trial: 8. Best value: 0.175568:  23%|██▎       | 23/100 [02:02<06:25,  5.01s/it]Best trial: 8. Best value: 0.175568:  24%|██▍       | 24/100 [02:02<05:43,  4.52s/it]Best trial: 8. Best value: 0.175568:  24%|██▍       | 24/100 [02:06<05:43,  4.52s/it]Best trial: 8. Best value: 0.175568:  25%|██▌       | 25/100 [02:06<05:41,  4.56s/it]Best trial: 8. Best value: 0.175568:  25%|██▌       | 25/100 [02:11<05:41,  4.56s/it]Best trial: 8. Best value: 0.175568:  26%|██▌       | 26/100 [02:11<05:31,  4.47s/it]Best trial: 8. Best value: 0.175568:  26%|██▌       | 26/100 [02:14<05:31,  4.47s/it]Best trial: 8. Best value: 0.175568:  27%|██▋       | 27/100 [02:14<05:04,  4.17s/it]Best trial: 8. Best value: 0.175568:  27%|██▋       | 27/100 [02:17<05:04,  4.17s/it]Best trial: 8. Best value: 0.175568:  28%|██▊       | 28/100 [02:17<04:40,  3.89s/it]Best trial: 8. Best value: 0.175568:  28%|██▊       | 28/100 [02:21<04:40,  3.89s/it]Best trial: 8. Best value: 0.175568:  29%|██▉       | 29/100 [02:21<04:26,  3.75s/it]Best trial: 8. Best value: 0.175568:  29%|██▉       | 29/100 [02:25<04:26,  3.75s/it]Best trial: 8. Best value: 0.175568:  30%|███       | 30/100 [02:25<04:22,  3.75s/it]Best trial: 8. Best value: 0.175568:  30%|███       | 30/100 [02:28<04:22,  3.75s/it]Best trial: 8. Best value: 0.175568:  31%|███       | 31/100 [02:28<04:22,  3.80s/it]Best trial: 8. Best value: 0.175568:  31%|███       | 31/100 [02:34<04:22,  3.80s/it]Best trial: 8. Best value: 0.175568:  32%|███▏      | 32/100 [02:34<05:01,  4.43s/it]Best trial: 8. Best value: 0.175568:  32%|███▏      | 32/100 [02:38<05:01,  4.43s/it]Best trial: 8. Best value: 0.175568:  33%|███▎      | 33/100 [02:38<04:49,  4.33s/it]Best trial: 33. Best value: 0.184985:  33%|███▎      | 33/100 [02:43<04:49,  4.33s/it]Best trial: 33. Best value: 0.184985:  34%|███▍      | 34/100 [02:43<04:46,  4.34s/it]Best trial: 33. Best value: 0.184985:  34%|███▍      | 34/100 [02:47<04:46,  4.34s/it]Best trial: 33. Best value: 0.184985:  35%|███▌      | 35/100 [02:47<04:39,  4.31s/it]Best trial: 33. Best value: 0.184985:  35%|███▌      | 35/100 [02:51<04:39,  4.31s/it]Best trial: 33. Best value: 0.184985:  36%|███▌      | 36/100 [02:51<04:20,  4.06s/it]Best trial: 33. Best value: 0.184985:  36%|███▌      | 36/100 [02:55<04:20,  4.06s/it]Best trial: 33. Best value: 0.184985:  37%|███▋      | 37/100 [02:55<04:14,  4.05s/it]Best trial: 33. Best value: 0.184985:  37%|███▋      | 37/100 [02:59<04:14,  4.05s/it]Best trial: 33. Best value: 0.184985:  38%|███▊      | 38/100 [02:59<04:14,  4.11s/it]Best trial: 33. Best value: 0.184985:  38%|███▊      | 38/100 [03:03<04:14,  4.11s/it]Best trial: 33. Best value: 0.184985:  39%|███▉      | 39/100 [03:03<04:05,  4.02s/it]Best trial: 33. Best value: 0.184985:  39%|███▉      | 39/100 [03:10<04:05,  4.02s/it]Best trial: 33. Best value: 0.184985:  40%|████      | 40/100 [03:10<04:55,  4.93s/it]Best trial: 33. Best value: 0.184985:  40%|████      | 40/100 [03:14<04:55,  4.93s/it]Best trial: 33. Best value: 0.184985:  41%|████      | 41/100 [03:14<04:44,  4.82s/it]Best trial: 33. Best value: 0.184985:  41%|████      | 41/100 [03:18<04:44,  4.82s/it]Best trial: 33. Best value: 0.184985:  42%|████▏     | 42/100 [03:18<04:14,  4.38s/it]Best trial: 33. Best value: 0.184985:  42%|████▏     | 42/100 [03:22<04:14,  4.38s/it]Best trial: 33. Best value: 0.184985:  43%|████▎     | 43/100 [03:22<04:02,  4.26s/it]Best trial: 33. Best value: 0.184985:  43%|████▎     | 43/100 [03:26<04:02,  4.26s/it]Best trial: 33. Best value: 0.184985:  44%|████▍     | 44/100 [03:26<03:56,  4.22s/it]Best trial: 33. Best value: 0.184985:  44%|████▍     | 44/100 [03:30<03:56,  4.22s/it]Best trial: 33. Best value: 0.184985:  45%|████▌     | 45/100 [03:30<03:59,  4.36s/it]Best trial: 33. Best value: 0.184985:  45%|████▌     | 45/100 [03:35<03:59,  4.36s/it]Best trial: 33. Best value: 0.184985:  46%|████▌     | 46/100 [03:35<03:52,  4.30s/it]Best trial: 33. Best value: 0.184985:  46%|████▌     | 46/100 [03:38<03:52,  4.30s/it]Best trial: 33. Best value: 0.184985:  47%|████▋     | 47/100 [03:38<03:31,  3.98s/it]Best trial: 33. Best value: 0.184985:  47%|████▋     | 47/100 [03:42<03:31,  3.98s/it]Best trial: 33. Best value: 0.184985:  48%|████▊     | 48/100 [03:42<03:26,  3.97s/it]Best trial: 33. Best value: 0.184985:  48%|████▊     | 48/100 [03:47<03:26,  3.97s/it]Best trial: 33. Best value: 0.184985:  49%|████▉     | 49/100 [03:47<03:36,  4.24s/it]Best trial: 33. Best value: 0.184985:  49%|████▉     | 49/100 [03:51<03:36,  4.24s/it]Best trial: 33. Best value: 0.184985:  50%|█████     | 50/100 [03:51<03:38,  4.36s/it]Best trial: 33. Best value: 0.184985:  50%|█████     | 50/100 [03:57<03:38,  4.36s/it]Best trial: 33. Best value: 0.184985:  51%|█████     | 51/100 [03:57<03:54,  4.78s/it]Best trial: 33. Best value: 0.184985:  51%|█████     | 51/100 [04:01<03:54,  4.78s/it]Best trial: 33. Best value: 0.184985:  52%|█████▏    | 52/100 [04:01<03:31,  4.40s/it]Best trial: 33. Best value: 0.184985:  52%|█████▏    | 52/100 [04:05<03:31,  4.40s/it]Best trial: 33. Best value: 0.184985:  53%|█████▎    | 53/100 [04:05<03:28,  4.45s/it]Best trial: 33. Best value: 0.184985:  53%|█████▎    | 53/100 [04:09<03:28,  4.45s/it]Best trial: 33. Best value: 0.184985:  54%|█████▍    | 54/100 [04:09<03:20,  4.36s/it]Best trial: 33. Best value: 0.184985:  54%|█████▍    | 54/100 [04:14<03:20,  4.36s/it]Best trial: 33. Best value: 0.184985:  55%|█████▌    | 55/100 [04:14<03:17,  4.38s/it]Best trial: 33. Best value: 0.184985:  55%|█████▌    | 55/100 [04:17<03:17,  4.38s/it]Best trial: 33. Best value: 0.184985:  56%|█████▌    | 56/100 [04:17<03:05,  4.21s/it]Best trial: 33. Best value: 0.184985:  56%|█████▌    | 56/100 [04:21<03:05,  4.21s/it]Best trial: 33. Best value: 0.184985:  57%|█████▋    | 57/100 [04:21<02:54,  4.06s/it]Best trial: 33. Best value: 0.184985:  57%|█████▋    | 57/100 [04:25<02:54,  4.06s/it]Best trial: 33. Best value: 0.184985:  58%|█████▊    | 58/100 [04:25<02:52,  4.10s/it]Best trial: 33. Best value: 0.184985:  58%|█████▊    | 58/100 [04:30<02:52,  4.10s/it]Best trial: 33. Best value: 0.184985:  59%|█████▉    | 59/100 [04:30<02:53,  4.24s/it]Best trial: 33. Best value: 0.184985:  59%|█████▉    | 59/100 [04:34<02:53,  4.24s/it]Best trial: 33. Best value: 0.184985:  60%|██████    | 60/100 [04:34<02:48,  4.20s/it]Best trial: 33. Best value: 0.184985:  60%|██████    | 60/100 [04:38<02:48,  4.20s/it]Best trial: 33. Best value: 0.184985:  61%|██████    | 61/100 [04:38<02:43,  4.18s/it]Best trial: 33. Best value: 0.184985:  61%|██████    | 61/100 [04:42<02:43,  4.18s/it]Best trial: 33. Best value: 0.184985:  62%|██████▏   | 62/100 [04:42<02:37,  4.15s/it]Best trial: 33. Best value: 0.184985:  62%|██████▏   | 62/100 [04:46<02:37,  4.15s/it]Best trial: 33. Best value: 0.184985:  63%|██████▎   | 63/100 [04:46<02:31,  4.09s/it]Best trial: 33. Best value: 0.184985:  63%|██████▎   | 63/100 [04:50<02:31,  4.09s/it]Best trial: 33. Best value: 0.184985:  64%|██████▍   | 64/100 [04:50<02:22,  3.95s/it]Best trial: 64. Best value: 0.185868:  64%|██████▍   | 64/100 [04:54<02:22,  3.95s/it]Best trial: 64. Best value: 0.185868:  65%|██████▌   | 65/100 [04:54<02:17,  3.92s/it]Best trial: 64. Best value: 0.185868:  65%|██████▌   | 65/100 [04:58<02:17,  3.92s/it]Best trial: 64. Best value: 0.185868:  66%|██████▌   | 66/100 [04:58<02:15,  4.00s/it]Best trial: 64. Best value: 0.185868:  66%|██████▌   | 66/100 [05:02<02:15,  4.00s/it]Best trial: 64. Best value: 0.185868:  67%|██████▋   | 67/100 [05:02<02:18,  4.19s/it]Best trial: 64. Best value: 0.185868:  67%|██████▋   | 67/100 [05:06<02:18,  4.19s/it]Best trial: 64. Best value: 0.185868:  68%|██████▊   | 68/100 [05:06<02:09,  4.05s/it]Best trial: 64. Best value: 0.185868:  68%|██████▊   | 68/100 [05:10<02:09,  4.05s/it]Best trial: 64. Best value: 0.185868:  69%|██████▉   | 69/100 [05:10<02:02,  3.96s/it]Best trial: 64. Best value: 0.185868:  69%|██████▉   | 69/100 [05:14<02:02,  3.96s/it]Best trial: 64. Best value: 0.185868:  70%|███████   | 70/100 [05:14<02:01,  4.04s/it]Best trial: 64. Best value: 0.185868:  70%|███████   | 70/100 [05:19<02:01,  4.04s/it]Best trial: 64. Best value: 0.185868:  71%|███████   | 71/100 [05:19<02:00,  4.17s/it]Best trial: 64. Best value: 0.185868:  71%|███████   | 71/100 [05:23<02:00,  4.17s/it]Best trial: 64. Best value: 0.185868:  72%|███████▏  | 72/100 [05:23<01:56,  4.16s/it]Best trial: 64. Best value: 0.185868:  72%|███████▏  | 72/100 [05:26<01:56,  4.16s/it]Best trial: 64. Best value: 0.185868:  73%|███████▎  | 73/100 [05:26<01:47,  3.98s/it]Best trial: 64. Best value: 0.185868:  73%|███████▎  | 73/100 [05:31<01:47,  3.98s/it]Best trial: 64. Best value: 0.185868:  74%|███████▍  | 74/100 [05:31<01:45,  4.06s/it]Best trial: 64. Best value: 0.185868:  74%|███████▍  | 74/100 [05:35<01:45,  4.06s/it]Best trial: 64. Best value: 0.185868:  75%|███████▌  | 75/100 [05:35<01:43,  4.13s/it]Best trial: 64. Best value: 0.185868:  75%|███████▌  | 75/100 [05:39<01:43,  4.13s/it]Best trial: 64. Best value: 0.185868:  76%|███████▌  | 76/100 [05:39<01:38,  4.12s/it]Best trial: 64. Best value: 0.185868:  76%|███████▌  | 76/100 [05:43<01:38,  4.12s/it]Best trial: 64. Best value: 0.185868:  77%|███████▋  | 77/100 [05:43<01:33,  4.08s/it]Best trial: 64. Best value: 0.185868:  77%|███████▋  | 77/100 [05:48<01:33,  4.08s/it]Best trial: 64. Best value: 0.185868:  78%|███████▊  | 78/100 [05:48<01:34,  4.29s/it]Best trial: 64. Best value: 0.185868:  78%|███████▊  | 78/100 [05:51<01:34,  4.29s/it]Best trial: 64. Best value: 0.185868:  79%|███████▉  | 79/100 [05:51<01:26,  4.11s/it]Best trial: 64. Best value: 0.185868:  79%|███████▉  | 79/100 [05:55<01:26,  4.11s/it]Best trial: 64. Best value: 0.185868:  80%|████████  | 80/100 [05:55<01:18,  3.90s/it]Best trial: 64. Best value: 0.185868:  80%|████████  | 80/100 [06:01<01:18,  3.90s/it]Best trial: 64. Best value: 0.185868:  81%|████████  | 81/100 [06:01<01:25,  4.49s/it]Best trial: 81. Best value: 0.191864:  81%|████████  | 81/100 [06:05<01:25,  4.49s/it]Best trial: 81. Best value: 0.191864:  82%|████████▏ | 82/100 [06:05<01:18,  4.34s/it]Best trial: 81. Best value: 0.191864:  82%|████████▏ | 82/100 [06:08<01:18,  4.34s/it]Best trial: 81. Best value: 0.191864:  83%|████████▎ | 83/100 [06:08<01:10,  4.14s/it]Best trial: 83. Best value: 0.270602:  83%|████████▎ | 83/100 [06:12<01:10,  4.14s/it]Best trial: 83. Best value: 0.270602:  84%|████████▍ | 84/100 [06:12<01:04,  4.05s/it]Best trial: 83. Best value: 0.270602:  84%|████████▍ | 84/100 [06:18<01:04,  4.05s/it]Best trial: 83. Best value: 0.270602:  85%|████████▌ | 85/100 [06:18<01:07,  4.50s/it]Best trial: 83. Best value: 0.270602:  85%|████████▌ | 85/100 [06:22<01:07,  4.50s/it]Best trial: 83. Best value: 0.270602:  86%|████████▌ | 86/100 [06:22<01:00,  4.36s/it]Best trial: 83. Best value: 0.270602:  86%|████████▌ | 86/100 [06:27<01:00,  4.36s/it]Best trial: 83. Best value: 0.270602:  87%|████████▋ | 87/100 [06:27<00:57,  4.46s/it]Best trial: 83. Best value: 0.270602:  87%|████████▋ | 87/100 [06:31<00:57,  4.46s/it]Best trial: 83. Best value: 0.270602:  88%|████████▊ | 88/100 [06:31<00:53,  4.49s/it]Best trial: 83. Best value: 0.270602:  88%|████████▊ | 88/100 [06:35<00:53,  4.49s/it]Best trial: 83. Best value: 0.270602:  89%|████████▉ | 89/100 [06:35<00:48,  4.44s/it]Best trial: 83. Best value: 0.270602:  89%|████████▉ | 89/100 [06:40<00:48,  4.44s/it]Best trial: 83. Best value: 0.270602:  90%|█████████ | 90/100 [06:40<00:44,  4.41s/it]Best trial: 83. Best value: 0.270602:  90%|█████████ | 90/100 [06:44<00:44,  4.41s/it]Best trial: 83. Best value: 0.270602:  91%|█████████ | 91/100 [06:44<00:39,  4.38s/it]Best trial: 83. Best value: 0.270602:  91%|█████████ | 91/100 [06:48<00:39,  4.38s/it]Best trial: 83. Best value: 0.270602:  92%|█████████▏| 92/100 [06:48<00:33,  4.24s/it]Best trial: 83. Best value: 0.270602:  92%|█████████▏| 92/100 [06:52<00:33,  4.24s/it]Best trial: 83. Best value: 0.270602:  93%|█████████▎| 93/100 [06:52<00:28,  4.06s/it]Best trial: 83. Best value: 0.270602:  93%|█████████▎| 93/100 [06:56<00:28,  4.06s/it]Best trial: 83. Best value: 0.270602:  94%|█████████▍| 94/100 [06:56<00:24,  4.11s/it]Best trial: 83. Best value: 0.270602:  94%|█████████▍| 94/100 [07:01<00:24,  4.11s/it]Best trial: 83. Best value: 0.270602:  95%|█████████▌| 95/100 [07:01<00:21,  4.34s/it]Best trial: 83. Best value: 0.270602:  95%|█████████▌| 95/100 [07:05<00:21,  4.34s/it]Best trial: 83. Best value: 0.270602:  96%|█████████▌| 96/100 [07:05<00:16,  4.21s/it]Best trial: 83. Best value: 0.270602:  96%|█████████▌| 96/100 [07:08<00:16,  4.21s/it]Best trial: 83. Best value: 0.270602:  97%|█████████▋| 97/100 [07:08<00:12,  4.11s/it]Best trial: 83. Best value: 0.270602:  97%|█████████▋| 97/100 [07:15<00:12,  4.11s/it]Best trial: 83. Best value: 0.270602:  98%|█████████▊| 98/100 [07:15<00:09,  4.69s/it]Best trial: 83. Best value: 0.270602:  98%|█████████▊| 98/100 [07:18<00:09,  4.69s/it]Best trial: 83. Best value: 0.270602:  99%|█████████▉| 99/100 [07:18<00:04,  4.38s/it]Best trial: 83. Best value: 0.270602:  99%|█████████▉| 99/100 [07:25<00:04,  4.38s/it]Best trial: 83. Best value: 0.270602: 100%|██████████| 100/100 [07:25<00:00,  5.20s/it]Best trial: 83. Best value: 0.270602: 100%|██████████| 100/100 [07:25<00:00,  4.46s/it]
2025-11-30 16:51:05,097 - INFO - HPO Complete. Best AUPRC: 0.2706
2025-11-30 16:51:05,098 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.09498299521278755, 'max_depth': 3, 'subsample': 0.6241567309015343, 'colsample_bytree': 0.8263177569472757, 'gamma': 0.6992443492580347, 'reg_lambda': 1.767872532019924e-07, 'reg_alpha': 1.4584481267369207e-07}
2025-11-30 16:51:05,098 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:51:07,218 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 16:51:07,218 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:51:07,451 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:51:07,522 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:51:07,540 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:51:07,540 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:51:07,540 - INFO - Training model...
2025-11-30 16:51:10,768 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:51:17,496 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:51:17,496 - INFO - AUROC: 0.6302 (0.2302 - 0.8365)
2025-11-30 16:51:17,496 - INFO - AUPRC: 0.0173 (0.0054 - 0.0368)
2025-11-30 16:51:17,496 - INFO - Brier Score: 0.0087 (0.0038 - 0.0150)
2025-11-30 16:51:17,496 - INFO - Accuracy: 0.9682 (0.9590 - 0.9775)
2025-11-30 16:51:17,496 - INFO - Precision: 0.0000 (0.0000 - 0.0000)
2025-11-30 16:51:17,496 - INFO - Sensitivity (Recall): 0.0000 (0.0000 - 0.0000)
2025-11-30 16:51:17,496 - INFO - F1-Score: 0.0000 (0.0000 - 0.0000)
2025-11-30 16:51:17,496 - INFO - Best Threshold: 0.0100 (0.0100 - 0.0100)
2025-11-30 16:51:17,496 - INFO - Specificity: 0.9767 (0.9680 - 0.9823)
2025-11-30 16:51:17,512 - INFO - Calculating SHAP values...
2025-11-30 16:51:18,758 - INFO - SHAP plots saved.
2025-11-30 16:51:18,760 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:51:20,217 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 16:51:20,217 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:51:20,435 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:51:20,502 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:51:20,514 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:51:20,514 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.174945:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.174945:   1%|          | 1/100 [00:03<05:56,  3.60s/it]Best trial: 1. Best value: 0.237254:   1%|          | 1/100 [00:08<05:56,  3.60s/it]Best trial: 1. Best value: 0.237254:   2%|▏         | 2/100 [00:08<07:21,  4.50s/it]Best trial: 1. Best value: 0.237254:   2%|▏         | 2/100 [00:13<07:21,  4.50s/it]Best trial: 1. Best value: 0.237254:   3%|▎         | 3/100 [00:13<07:50,  4.85s/it]Best trial: 1. Best value: 0.237254:   3%|▎         | 3/100 [00:19<07:50,  4.85s/it]Best trial: 1. Best value: 0.237254:   4%|▍         | 4/100 [00:19<08:26,  5.27s/it]Best trial: 1. Best value: 0.237254:   4%|▍         | 4/100 [00:24<08:26,  5.27s/it]Best trial: 1. Best value: 0.237254:   5%|▌         | 5/100 [00:24<07:45,  4.90s/it]Best trial: 1. Best value: 0.237254:   5%|▌         | 5/100 [00:31<07:45,  4.90s/it]Best trial: 1. Best value: 0.237254:   6%|▌         | 6/100 [00:31<08:51,  5.65s/it]Best trial: 1. Best value: 0.237254:   6%|▌         | 6/100 [00:35<08:51,  5.65s/it]Best trial: 1. Best value: 0.237254:   7%|▋         | 7/100 [00:35<07:51,  5.07s/it]Best trial: 1. Best value: 0.237254:   7%|▋         | 7/100 [00:41<07:51,  5.07s/it]Best trial: 1. Best value: 0.237254:   8%|▊         | 8/100 [00:41<08:11,  5.34s/it]Best trial: 1. Best value: 0.237254:   8%|▊         | 8/100 [00:47<08:11,  5.34s/it]Best trial: 1. Best value: 0.237254:   9%|▉         | 9/100 [00:47<08:23,  5.53s/it]Best trial: 1. Best value: 0.237254:   9%|▉         | 9/100 [00:52<08:23,  5.53s/it]Best trial: 1. Best value: 0.237254:  10%|█         | 10/100 [00:52<08:08,  5.43s/it]Best trial: 1. Best value: 0.237254:  10%|█         | 10/100 [00:57<08:08,  5.43s/it]Best trial: 1. Best value: 0.237254:  11%|█         | 11/100 [00:57<07:51,  5.29s/it]Best trial: 1. Best value: 0.237254:  11%|█         | 11/100 [01:01<07:51,  5.29s/it]Best trial: 1. Best value: 0.237254:  12%|█▏        | 12/100 [01:01<07:28,  5.10s/it]Best trial: 1. Best value: 0.237254:  12%|█▏        | 12/100 [01:06<07:28,  5.10s/it]Best trial: 1. Best value: 0.237254:  13%|█▎        | 13/100 [01:06<07:22,  5.09s/it]Best trial: 1. Best value: 0.237254:  13%|█▎        | 13/100 [01:12<07:22,  5.09s/it]Best trial: 1. Best value: 0.237254:  14%|█▍        | 14/100 [01:12<07:27,  5.20s/it]Best trial: 1. Best value: 0.237254:  14%|█▍        | 14/100 [01:16<07:27,  5.20s/it]Best trial: 1. Best value: 0.237254:  15%|█▌        | 15/100 [01:16<06:56,  4.90s/it]Best trial: 1. Best value: 0.237254:  15%|█▌        | 15/100 [01:21<06:56,  4.90s/it]Best trial: 1. Best value: 0.237254:  16%|█▌        | 16/100 [01:21<06:55,  4.94s/it]Best trial: 1. Best value: 0.237254:  16%|█▌        | 16/100 [01:25<06:55,  4.94s/it]Best trial: 1. Best value: 0.237254:  17%|█▋        | 17/100 [01:25<06:25,  4.65s/it]Best trial: 1. Best value: 0.237254:  17%|█▋        | 17/100 [01:31<06:25,  4.65s/it]Best trial: 1. Best value: 0.237254:  18%|█▊        | 18/100 [01:31<06:41,  4.90s/it]Best trial: 18. Best value: 0.239148:  18%|█▊        | 18/100 [01:36<06:41,  4.90s/it]Best trial: 18. Best value: 0.239148:  19%|█▉        | 19/100 [01:36<06:54,  5.11s/it]Best trial: 18. Best value: 0.239148:  19%|█▉        | 19/100 [01:42<06:54,  5.11s/it]Best trial: 18. Best value: 0.239148:  20%|██        | 20/100 [01:42<07:09,  5.37s/it]Best trial: 18. Best value: 0.239148:  20%|██        | 20/100 [01:46<07:09,  5.37s/it]Best trial: 18. Best value: 0.239148:  21%|██        | 21/100 [01:46<06:36,  5.01s/it]Best trial: 18. Best value: 0.239148:  21%|██        | 21/100 [01:52<06:36,  5.01s/it]Best trial: 18. Best value: 0.239148:  22%|██▏       | 22/100 [01:52<06:54,  5.32s/it]Best trial: 18. Best value: 0.239148:  22%|██▏       | 22/100 [01:57<06:54,  5.32s/it]Best trial: 18. Best value: 0.239148:  23%|██▎       | 23/100 [01:57<06:41,  5.22s/it]Best trial: 18. Best value: 0.239148:  23%|██▎       | 23/100 [02:02<06:41,  5.22s/it]Best trial: 18. Best value: 0.239148:  24%|██▍       | 24/100 [02:02<06:26,  5.09s/it]Best trial: 18. Best value: 0.239148:  24%|██▍       | 24/100 [02:07<06:26,  5.09s/it]Best trial: 18. Best value: 0.239148:  25%|██▌       | 25/100 [02:07<06:21,  5.08s/it]Best trial: 18. Best value: 0.239148:  25%|██▌       | 25/100 [02:12<06:21,  5.08s/it]Best trial: 18. Best value: 0.239148:  26%|██▌       | 26/100 [02:12<06:11,  5.03s/it]Best trial: 18. Best value: 0.239148:  26%|██▌       | 26/100 [02:16<06:11,  5.03s/it]Best trial: 18. Best value: 0.239148:  27%|██▋       | 27/100 [02:16<05:50,  4.79s/it]Best trial: 18. Best value: 0.239148:  27%|██▋       | 27/100 [02:21<05:50,  4.79s/it]Best trial: 18. Best value: 0.239148:  28%|██▊       | 28/100 [02:21<05:32,  4.61s/it]Best trial: 18. Best value: 0.239148:  28%|██▊       | 28/100 [02:28<05:32,  4.61s/it]Best trial: 18. Best value: 0.239148:  29%|██▉       | 29/100 [02:28<06:20,  5.36s/it]Best trial: 18. Best value: 0.239148:  29%|██▉       | 29/100 [02:33<06:20,  5.36s/it]Best trial: 18. Best value: 0.239148:  30%|███       | 30/100 [02:33<06:14,  5.35s/it]Best trial: 18. Best value: 0.239148:  30%|███       | 30/100 [02:39<06:14,  5.35s/it]Best trial: 18. Best value: 0.239148:  31%|███       | 31/100 [02:39<06:18,  5.49s/it]Best trial: 18. Best value: 0.239148:  31%|███       | 31/100 [02:42<06:18,  5.49s/it]Best trial: 18. Best value: 0.239148:  32%|███▏      | 32/100 [02:42<05:36,  4.96s/it]Best trial: 32. Best value: 0.275546:  32%|███▏      | 32/100 [02:46<05:36,  4.96s/it]Best trial: 32. Best value: 0.275546:  33%|███▎      | 33/100 [02:46<05:08,  4.61s/it]Best trial: 32. Best value: 0.275546:  33%|███▎      | 33/100 [02:50<05:08,  4.61s/it]Best trial: 32. Best value: 0.275546:  34%|███▍      | 34/100 [02:50<04:52,  4.42s/it]Best trial: 32. Best value: 0.275546:  34%|███▍      | 34/100 [02:55<04:52,  4.42s/it]Best trial: 32. Best value: 0.275546:  35%|███▌      | 35/100 [02:55<04:57,  4.58s/it]Best trial: 32. Best value: 0.275546:  35%|███▌      | 35/100 [03:00<04:57,  4.58s/it]Best trial: 32. Best value: 0.275546:  36%|███▌      | 36/100 [03:00<04:49,  4.52s/it]Best trial: 36. Best value: 0.286773:  36%|███▌      | 36/100 [03:03<04:49,  4.52s/it]Best trial: 36. Best value: 0.286773:  37%|███▋      | 37/100 [03:03<04:28,  4.27s/it]Best trial: 36. Best value: 0.286773:  37%|███▋      | 37/100 [03:07<04:28,  4.27s/it]Best trial: 36. Best value: 0.286773:  38%|███▊      | 38/100 [03:07<04:12,  4.07s/it]Best trial: 36. Best value: 0.286773:  38%|███▊      | 38/100 [03:10<04:12,  4.07s/it]Best trial: 36. Best value: 0.286773:  39%|███▉      | 39/100 [03:10<03:56,  3.88s/it]Best trial: 36. Best value: 0.286773:  39%|███▉      | 39/100 [03:14<03:56,  3.88s/it]Best trial: 36. Best value: 0.286773:  40%|████      | 40/100 [03:14<03:55,  3.93s/it]Best trial: 36. Best value: 0.286773:  40%|████      | 40/100 [03:20<03:55,  3.93s/it]Best trial: 36. Best value: 0.286773:  41%|████      | 41/100 [03:20<04:23,  4.47s/it]Best trial: 36. Best value: 0.286773:  41%|████      | 41/100 [03:24<04:23,  4.47s/it]Best trial: 36. Best value: 0.286773:  42%|████▏     | 42/100 [03:24<04:07,  4.27s/it]Best trial: 36. Best value: 0.286773:  42%|████▏     | 42/100 [03:28<04:07,  4.27s/it]Best trial: 36. Best value: 0.286773:  43%|████▎     | 43/100 [03:28<04:03,  4.28s/it]Best trial: 36. Best value: 0.286773:  43%|████▎     | 43/100 [03:33<04:03,  4.28s/it]Best trial: 36. Best value: 0.286773:  44%|████▍     | 44/100 [03:33<04:02,  4.32s/it]Best trial: 36. Best value: 0.286773:  44%|████▍     | 44/100 [03:37<04:02,  4.32s/it]Best trial: 36. Best value: 0.286773:  45%|████▌     | 45/100 [03:37<03:53,  4.24s/it]Best trial: 36. Best value: 0.286773:  45%|████▌     | 45/100 [03:41<03:53,  4.24s/it]Best trial: 36. Best value: 0.286773:  46%|████▌     | 46/100 [03:41<03:53,  4.33s/it]Best trial: 36. Best value: 0.286773:  46%|████▌     | 46/100 [03:45<03:53,  4.33s/it]Best trial: 36. Best value: 0.286773:  47%|████▋     | 47/100 [03:45<03:37,  4.10s/it]Best trial: 36. Best value: 0.286773:  47%|████▋     | 47/100 [03:51<03:37,  4.10s/it]Best trial: 36. Best value: 0.286773:  48%|████▊     | 48/100 [03:51<04:04,  4.71s/it]Best trial: 36. Best value: 0.286773:  48%|████▊     | 48/100 [03:54<04:04,  4.71s/it]Best trial: 36. Best value: 0.286773:  49%|████▉     | 49/100 [03:54<03:37,  4.26s/it]Best trial: 36. Best value: 0.286773:  49%|████▉     | 49/100 [04:01<03:37,  4.26s/it]Best trial: 36. Best value: 0.286773:  50%|█████     | 50/100 [04:01<04:18,  5.17s/it]Best trial: 36. Best value: 0.286773:  50%|█████     | 50/100 [04:06<04:18,  5.17s/it]Best trial: 36. Best value: 0.286773:  51%|█████     | 51/100 [04:06<03:58,  4.87s/it]Best trial: 36. Best value: 0.286773:  51%|█████     | 51/100 [04:09<03:58,  4.87s/it]Best trial: 36. Best value: 0.286773:  52%|█████▏    | 52/100 [04:09<03:35,  4.49s/it]Best trial: 36. Best value: 0.286773:  52%|█████▏    | 52/100 [04:14<03:35,  4.49s/it]Best trial: 36. Best value: 0.286773:  53%|█████▎    | 53/100 [04:14<03:42,  4.73s/it]Best trial: 36. Best value: 0.286773:  53%|█████▎    | 53/100 [04:19<03:42,  4.73s/it]Best trial: 36. Best value: 0.286773:  54%|█████▍    | 54/100 [04:19<03:27,  4.52s/it]Best trial: 36. Best value: 0.286773:  54%|█████▍    | 54/100 [04:24<03:27,  4.52s/it]Best trial: 36. Best value: 0.286773:  55%|█████▌    | 55/100 [04:24<03:34,  4.78s/it]Best trial: 36. Best value: 0.286773:  55%|█████▌    | 55/100 [04:27<03:34,  4.78s/it]Best trial: 36. Best value: 0.286773:  56%|█████▌    | 56/100 [04:27<03:13,  4.40s/it]Best trial: 36. Best value: 0.286773:  56%|█████▌    | 56/100 [04:34<03:13,  4.40s/it]Best trial: 36. Best value: 0.286773:  57%|█████▋    | 57/100 [04:34<03:37,  5.06s/it]Best trial: 36. Best value: 0.286773:  57%|█████▋    | 57/100 [04:38<03:37,  5.06s/it]Best trial: 36. Best value: 0.286773:  58%|█████▊    | 58/100 [04:38<03:13,  4.61s/it]Best trial: 36. Best value: 0.286773:  58%|█████▊    | 58/100 [04:42<03:13,  4.61s/it]Best trial: 36. Best value: 0.286773:  59%|█████▉    | 59/100 [04:42<03:10,  4.65s/it]Best trial: 36. Best value: 0.286773:  59%|█████▉    | 59/100 [04:48<03:10,  4.65s/it]Best trial: 36. Best value: 0.286773:  60%|██████    | 60/100 [04:48<03:12,  4.82s/it]Best trial: 36. Best value: 0.286773:  60%|██████    | 60/100 [04:53<03:12,  4.82s/it]Best trial: 36. Best value: 0.286773:  61%|██████    | 61/100 [04:53<03:13,  4.96s/it]Best trial: 36. Best value: 0.286773:  61%|██████    | 61/100 [04:57<03:13,  4.96s/it]Best trial: 36. Best value: 0.286773:  62%|██████▏   | 62/100 [04:57<03:00,  4.76s/it]Best trial: 36. Best value: 0.286773:  62%|██████▏   | 62/100 [05:02<03:00,  4.76s/it]Best trial: 36. Best value: 0.286773:  63%|██████▎   | 63/100 [05:02<02:58,  4.82s/it]Best trial: 36. Best value: 0.286773:  63%|██████▎   | 63/100 [05:06<02:58,  4.82s/it]Best trial: 36. Best value: 0.286773:  64%|██████▍   | 64/100 [05:06<02:46,  4.63s/it]Best trial: 36. Best value: 0.286773:  64%|██████▍   | 64/100 [05:10<02:46,  4.63s/it]Best trial: 36. Best value: 0.286773:  65%|██████▌   | 65/100 [05:10<02:34,  4.42s/it]Best trial: 36. Best value: 0.286773:  65%|██████▌   | 65/100 [05:15<02:34,  4.42s/it]Best trial: 36. Best value: 0.286773:  66%|██████▌   | 66/100 [05:15<02:30,  4.41s/it]Best trial: 36. Best value: 0.286773:  66%|██████▌   | 66/100 [05:19<02:30,  4.41s/it]Best trial: 36. Best value: 0.286773:  67%|██████▋   | 67/100 [05:19<02:22,  4.30s/it]Best trial: 36. Best value: 0.286773:  67%|██████▋   | 67/100 [05:23<02:22,  4.30s/it]Best trial: 36. Best value: 0.286773:  68%|██████▊   | 68/100 [05:23<02:16,  4.27s/it]Best trial: 36. Best value: 0.286773:  68%|██████▊   | 68/100 [05:28<02:16,  4.27s/it]Best trial: 36. Best value: 0.286773:  69%|██████▉   | 69/100 [05:28<02:20,  4.52s/it]Best trial: 36. Best value: 0.286773:  69%|██████▉   | 69/100 [05:33<02:20,  4.52s/it]Best trial: 36. Best value: 0.286773:  70%|███████   | 70/100 [05:33<02:16,  4.55s/it]Best trial: 36. Best value: 0.286773:  70%|███████   | 70/100 [05:37<02:16,  4.55s/it]Best trial: 36. Best value: 0.286773:  71%|███████   | 71/100 [05:37<02:13,  4.60s/it]Best trial: 36. Best value: 0.286773:  71%|███████   | 71/100 [05:42<02:13,  4.60s/it]Best trial: 36. Best value: 0.286773:  72%|███████▏  | 72/100 [05:42<02:12,  4.75s/it]Best trial: 36. Best value: 0.286773:  72%|███████▏  | 72/100 [05:47<02:12,  4.75s/it]Best trial: 36. Best value: 0.286773:  73%|███████▎  | 73/100 [05:47<02:05,  4.64s/it]Best trial: 36. Best value: 0.286773:  73%|███████▎  | 73/100 [05:51<02:05,  4.64s/it]Best trial: 36. Best value: 0.286773:  74%|███████▍  | 74/100 [05:51<01:59,  4.58s/it]Best trial: 36. Best value: 0.286773:  74%|███████▍  | 74/100 [05:55<01:59,  4.58s/it]Best trial: 36. Best value: 0.286773:  75%|███████▌  | 75/100 [05:55<01:50,  4.41s/it]Best trial: 36. Best value: 0.286773:  75%|███████▌  | 75/100 [05:59<01:50,  4.41s/it]Best trial: 36. Best value: 0.286773:  76%|███████▌  | 76/100 [05:59<01:42,  4.28s/it]Best trial: 36. Best value: 0.286773:  76%|███████▌  | 76/100 [06:07<01:42,  4.28s/it]Best trial: 36. Best value: 0.286773:  77%|███████▋  | 77/100 [06:07<02:02,  5.34s/it]Best trial: 36. Best value: 0.286773:  77%|███████▋  | 77/100 [06:11<02:02,  5.34s/it]Best trial: 36. Best value: 0.286773:  78%|███████▊  | 78/100 [06:11<01:47,  4.86s/it]Best trial: 36. Best value: 0.286773:  78%|███████▊  | 78/100 [06:15<01:47,  4.86s/it]Best trial: 36. Best value: 0.286773:  79%|███████▉  | 79/100 [06:15<01:37,  4.66s/it]Best trial: 36. Best value: 0.286773:  79%|███████▉  | 79/100 [06:19<01:37,  4.66s/it]Best trial: 36. Best value: 0.286773:  80%|████████  | 80/100 [06:19<01:31,  4.55s/it]Best trial: 36. Best value: 0.286773:  80%|████████  | 80/100 [06:23<01:31,  4.55s/it]Best trial: 36. Best value: 0.286773:  81%|████████  | 81/100 [06:23<01:24,  4.42s/it]Best trial: 36. Best value: 0.286773:  81%|████████  | 81/100 [06:28<01:24,  4.42s/it]Best trial: 36. Best value: 0.286773:  82%|████████▏ | 82/100 [06:28<01:18,  4.39s/it]Best trial: 36. Best value: 0.286773:  82%|████████▏ | 82/100 [06:33<01:18,  4.39s/it]Best trial: 36. Best value: 0.286773:  83%|████████▎ | 83/100 [06:33<01:17,  4.59s/it]Best trial: 36. Best value: 0.286773:  83%|████████▎ | 83/100 [06:37<01:17,  4.59s/it]Best trial: 36. Best value: 0.286773:  84%|████████▍ | 84/100 [06:37<01:12,  4.51s/it]Best trial: 36. Best value: 0.286773:  84%|████████▍ | 84/100 [06:41<01:12,  4.51s/it]Best trial: 36. Best value: 0.286773:  85%|████████▌ | 85/100 [06:41<01:07,  4.49s/it]Best trial: 36. Best value: 0.286773:  85%|████████▌ | 85/100 [06:46<01:07,  4.49s/it]Best trial: 36. Best value: 0.286773:  86%|████████▌ | 86/100 [06:46<01:03,  4.56s/it]Best trial: 36. Best value: 0.286773:  86%|████████▌ | 86/100 [06:52<01:03,  4.56s/it]Best trial: 36. Best value: 0.286773:  87%|████████▋ | 87/100 [06:52<01:04,  4.94s/it]Best trial: 36. Best value: 0.286773:  87%|████████▋ | 87/100 [06:58<01:04,  4.94s/it]Best trial: 36. Best value: 0.286773:  88%|████████▊ | 88/100 [06:58<01:04,  5.39s/it]Best trial: 36. Best value: 0.286773:  88%|████████▊ | 88/100 [07:05<01:04,  5.39s/it]Best trial: 36. Best value: 0.286773:  89%|████████▉ | 89/100 [07:05<01:01,  5.60s/it]Best trial: 36. Best value: 0.286773:  89%|████████▉ | 89/100 [07:10<01:01,  5.60s/it]Best trial: 36. Best value: 0.286773:  90%|█████████ | 90/100 [07:10<00:55,  5.50s/it]Best trial: 36. Best value: 0.286773:  90%|█████████ | 90/100 [07:15<00:55,  5.50s/it]Best trial: 36. Best value: 0.286773:  91%|█████████ | 91/100 [07:15<00:49,  5.46s/it]Best trial: 36. Best value: 0.286773:  91%|█████████ | 91/100 [07:20<00:49,  5.46s/it]Best trial: 36. Best value: 0.286773:  92%|█████████▏| 92/100 [07:20<00:42,  5.27s/it]Best trial: 36. Best value: 0.286773:  92%|█████████▏| 92/100 [07:25<00:42,  5.27s/it]Best trial: 36. Best value: 0.286773:  93%|█████████▎| 93/100 [07:25<00:35,  5.09s/it]Best trial: 36. Best value: 0.286773:  93%|█████████▎| 93/100 [07:31<00:35,  5.09s/it]Best trial: 36. Best value: 0.286773:  94%|█████████▍| 94/100 [07:31<00:33,  5.55s/it]Best trial: 94. Best value: 0.294974:  94%|█████████▍| 94/100 [07:37<00:33,  5.55s/it]Best trial: 94. Best value: 0.294974:  95%|█████████▌| 95/100 [07:37<00:27,  5.48s/it]Best trial: 95. Best value: 0.295149:  95%|█████████▌| 95/100 [07:41<00:27,  5.48s/it]Best trial: 95. Best value: 0.295149:  96%|█████████▌| 96/100 [07:41<00:21,  5.27s/it]Best trial: 95. Best value: 0.295149:  96%|█████████▌| 96/100 [07:46<00:21,  5.27s/it]Best trial: 95. Best value: 0.295149:  97%|█████████▋| 97/100 [07:46<00:14,  4.95s/it]Best trial: 95. Best value: 0.295149:  97%|█████████▋| 97/100 [07:51<00:14,  4.95s/it]Best trial: 95. Best value: 0.295149:  98%|█████████▊| 98/100 [07:51<00:10,  5.08s/it]Best trial: 95. Best value: 0.295149:  98%|█████████▊| 98/100 [07:56<00:10,  5.08s/it]Best trial: 95. Best value: 0.295149:  99%|█████████▉| 99/100 [07:56<00:05,  5.05s/it]Best trial: 95. Best value: 0.295149:  99%|█████████▉| 99/100 [08:00<00:05,  5.05s/it]Best trial: 95. Best value: 0.295149: 100%|██████████| 100/100 [08:00<00:00,  4.86s/it]Best trial: 95. Best value: 0.295149: 100%|██████████| 100/100 [08:00<00:00,  4.81s/it]
2025-11-30 16:59:21,389 - INFO - HPO Complete. Best AUPRC: 0.2951
2025-11-30 16:59:21,390 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.09554977183506348, 'max_depth': 3, 'subsample': 0.8266320659608414, 'colsample_bytree': 0.6636673344120202, 'gamma': 4.4252440865381315, 'reg_lambda': 2.1656301099327953e-08, 'reg_alpha': 0.004703789552173103}
2025-11-30 16:59:21,390 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 16:59:23,232 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 16:59:23,233 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:59:23,437 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:59:23,504 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:59:23,517 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:59:23,517 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 16:59:23,517 - INFO - Training model...
2025-11-30 16:59:26,451 - INFO - Evaluating model with bootstrapping...
2025-11-30 16:59:33,075 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 16:59:33,075 - INFO - AUROC: 0.6358 (0.4293 - 0.7641)
2025-11-30 16:59:33,075 - INFO - AUPRC: 0.0190 (0.0058 - 0.0767)
2025-11-30 16:59:33,075 - INFO - Brier Score: 0.0089 (0.0042 - 0.0154)
2025-11-30 16:59:33,075 - INFO - Accuracy: 0.9595 (0.8520 - 0.9682)
2025-11-30 16:59:33,075 - INFO - Precision: 0.0417 (0.0000 - 0.1350)
2025-11-30 16:59:33,075 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.5400)
2025-11-30 16:59:33,075 - INFO - F1-Score: 0.0667 (0.0000 - 0.2085)
2025-11-30 16:59:33,075 - INFO - Best Threshold: 0.0400 (0.0100 - 0.0400)
2025-11-30 16:59:33,075 - INFO - Specificity: 0.9665 (0.8569 - 0.9735)
2025-11-30 16:59:33,086 - INFO - Calculating SHAP values...
2025-11-30 16:59:34,223 - INFO - SHAP plots saved.
2025-11-30 16:59:34,225 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=mortality | Branch=windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 16:59:35,478 - INFO - Starting HPO for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 16:59:35,479 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 16:59:35,697 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 16:59:35,768 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 16:59:35,780 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 16:59:35,781 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.109712:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.109712:   1%|          | 1/100 [00:04<07:57,  4.83s/it]Best trial: 0. Best value: 0.109712:   1%|          | 1/100 [00:09<07:57,  4.83s/it]Best trial: 0. Best value: 0.109712:   2%|▏         | 2/100 [00:09<07:26,  4.56s/it]Best trial: 0. Best value: 0.109712:   2%|▏         | 2/100 [00:13<07:26,  4.56s/it]Best trial: 0. Best value: 0.109712:   3%|▎         | 3/100 [00:13<07:27,  4.61s/it]Best trial: 0. Best value: 0.109712:   3%|▎         | 3/100 [00:19<07:27,  4.61s/it]Best trial: 0. Best value: 0.109712:   4%|▍         | 4/100 [00:19<08:13,  5.14s/it]Best trial: 0. Best value: 0.109712:   4%|▍         | 4/100 [00:26<08:13,  5.14s/it]Best trial: 0. Best value: 0.109712:   5%|▌         | 5/100 [00:26<09:15,  5.85s/it]Best trial: 5. Best value: 0.152736:   5%|▌         | 5/100 [00:33<09:15,  5.85s/it]Best trial: 5. Best value: 0.152736:   6%|▌         | 6/100 [00:33<09:32,  6.09s/it]Best trial: 6. Best value: 0.17396:   6%|▌         | 6/100 [00:38<09:32,  6.09s/it] Best trial: 6. Best value: 0.17396:   7%|▋         | 7/100 [00:38<08:39,  5.58s/it]Best trial: 6. Best value: 0.17396:   7%|▋         | 7/100 [00:42<08:39,  5.58s/it]Best trial: 6. Best value: 0.17396:   8%|▊         | 8/100 [00:42<08:09,  5.32s/it]Best trial: 6. Best value: 0.17396:   8%|▊         | 8/100 [00:48<08:09,  5.32s/it]Best trial: 6. Best value: 0.17396:   9%|▉         | 9/100 [00:48<08:07,  5.36s/it]Best trial: 6. Best value: 0.17396:   9%|▉         | 9/100 [00:51<08:07,  5.36s/it]Best trial: 6. Best value: 0.17396:  10%|█         | 10/100 [00:51<07:12,  4.80s/it]Best trial: 6. Best value: 0.17396:  10%|█         | 10/100 [00:56<07:12,  4.80s/it]Best trial: 6. Best value: 0.17396:  11%|█         | 11/100 [00:56<07:00,  4.72s/it]Best trial: 6. Best value: 0.17396:  11%|█         | 11/100 [01:01<07:00,  4.72s/it]Best trial: 6. Best value: 0.17396:  12%|█▏        | 12/100 [01:01<07:02,  4.80s/it]Best trial: 6. Best value: 0.17396:  12%|█▏        | 12/100 [01:04<07:02,  4.80s/it]Best trial: 6. Best value: 0.17396:  13%|█▎        | 13/100 [01:04<06:25,  4.43s/it]Best trial: 6. Best value: 0.17396:  13%|█▎        | 13/100 [01:09<06:25,  4.43s/it]Best trial: 6. Best value: 0.17396:  14%|█▍        | 14/100 [01:09<06:21,  4.44s/it]Best trial: 14. Best value: 0.180813:  14%|█▍        | 14/100 [01:13<06:21,  4.44s/it]Best trial: 14. Best value: 0.180813:  15%|█▌        | 15/100 [01:13<05:58,  4.22s/it]Best trial: 14. Best value: 0.180813:  15%|█▌        | 15/100 [01:16<05:58,  4.22s/it]Best trial: 14. Best value: 0.180813:  16%|█▌        | 16/100 [01:16<05:44,  4.10s/it]Best trial: 14. Best value: 0.180813:  16%|█▌        | 16/100 [01:23<05:44,  4.10s/it]Best trial: 14. Best value: 0.180813:  17%|█▋        | 17/100 [01:23<06:43,  4.87s/it]Best trial: 14. Best value: 0.180813:  17%|█▋        | 17/100 [01:28<06:43,  4.87s/it]Best trial: 14. Best value: 0.180813:  18%|█▊        | 18/100 [01:28<06:42,  4.91s/it]Best trial: 14. Best value: 0.180813:  18%|█▊        | 18/100 [01:31<06:42,  4.91s/it]Best trial: 14. Best value: 0.180813:  19%|█▉        | 19/100 [01:31<05:54,  4.38s/it]Best trial: 14. Best value: 0.180813:  19%|█▉        | 19/100 [01:35<05:54,  4.38s/it]Best trial: 14. Best value: 0.180813:  20%|██        | 20/100 [01:35<05:35,  4.20s/it]Best trial: 14. Best value: 0.180813:  20%|██        | 20/100 [01:40<05:35,  4.20s/it]Best trial: 14. Best value: 0.180813:  21%|██        | 21/100 [01:40<05:54,  4.48s/it]Best trial: 14. Best value: 0.180813:  21%|██        | 21/100 [01:44<05:54,  4.48s/it]Best trial: 14. Best value: 0.180813:  22%|██▏       | 22/100 [01:44<05:33,  4.28s/it]Best trial: 14. Best value: 0.180813:  22%|██▏       | 22/100 [01:48<05:33,  4.28s/it]Best trial: 14. Best value: 0.180813:  23%|██▎       | 23/100 [01:48<05:23,  4.21s/it]Best trial: 23. Best value: 0.199211:  23%|██▎       | 23/100 [01:52<05:23,  4.21s/it]Best trial: 23. Best value: 0.199211:  24%|██▍       | 24/100 [01:52<05:08,  4.06s/it]Best trial: 23. Best value: 0.199211:  24%|██▍       | 24/100 [01:55<05:08,  4.06s/it]Best trial: 23. Best value: 0.199211:  25%|██▌       | 25/100 [01:55<04:57,  3.97s/it]Best trial: 23. Best value: 0.199211:  25%|██▌       | 25/100 [02:00<04:57,  3.97s/it]Best trial: 23. Best value: 0.199211:  26%|██▌       | 26/100 [02:00<04:58,  4.04s/it]Best trial: 23. Best value: 0.199211:  26%|██▌       | 26/100 [02:04<04:58,  4.04s/it]Best trial: 23. Best value: 0.199211:  27%|██▋       | 27/100 [02:04<05:11,  4.27s/it]Best trial: 23. Best value: 0.199211:  27%|██▋       | 27/100 [02:08<05:11,  4.27s/it]Best trial: 23. Best value: 0.199211:  28%|██▊       | 28/100 [02:08<04:52,  4.06s/it]Best trial: 23. Best value: 0.199211:  28%|██▊       | 28/100 [02:12<04:52,  4.06s/it]Best trial: 23. Best value: 0.199211:  29%|██▉       | 29/100 [02:12<04:47,  4.05s/it]Best trial: 23. Best value: 0.199211:  29%|██▉       | 29/100 [02:16<04:47,  4.05s/it]Best trial: 23. Best value: 0.199211:  30%|███       | 30/100 [02:16<04:51,  4.16s/it]Best trial: 30. Best value: 0.210956:  30%|███       | 30/100 [02:24<04:51,  4.16s/it]Best trial: 30. Best value: 0.210956:  31%|███       | 31/100 [02:24<06:05,  5.29s/it]Best trial: 30. Best value: 0.210956:  31%|███       | 31/100 [02:30<06:05,  5.29s/it]Best trial: 30. Best value: 0.210956:  32%|███▏      | 32/100 [02:30<06:11,  5.46s/it]Best trial: 30. Best value: 0.210956:  32%|███▏      | 32/100 [02:38<06:11,  5.46s/it]Best trial: 30. Best value: 0.210956:  33%|███▎      | 33/100 [02:38<06:48,  6.10s/it]Best trial: 30. Best value: 0.210956:  33%|███▎      | 33/100 [02:43<06:48,  6.10s/it]Best trial: 30. Best value: 0.210956:  34%|███▍      | 34/100 [02:43<06:15,  5.69s/it]Best trial: 30. Best value: 0.210956:  34%|███▍      | 34/100 [02:47<06:15,  5.69s/it]Best trial: 30. Best value: 0.210956:  35%|███▌      | 35/100 [02:47<05:51,  5.41s/it]Best trial: 30. Best value: 0.210956:  35%|███▌      | 35/100 [02:51<05:51,  5.41s/it]Best trial: 30. Best value: 0.210956:  36%|███▌      | 36/100 [02:51<05:15,  4.93s/it]Best trial: 30. Best value: 0.210956:  36%|███▌      | 36/100 [02:56<05:15,  4.93s/it]Best trial: 30. Best value: 0.210956:  37%|███▋      | 37/100 [02:56<05:01,  4.79s/it]Best trial: 30. Best value: 0.210956:  37%|███▋      | 37/100 [03:02<05:01,  4.79s/it]Best trial: 30. Best value: 0.210956:  38%|███▊      | 38/100 [03:02<05:26,  5.27s/it]Best trial: 30. Best value: 0.210956:  38%|███▊      | 38/100 [03:07<05:26,  5.27s/it]Best trial: 30. Best value: 0.210956:  39%|███▉      | 39/100 [03:07<05:22,  5.29s/it]Best trial: 30. Best value: 0.210956:  39%|███▉      | 39/100 [03:12<05:22,  5.29s/it]Best trial: 30. Best value: 0.210956:  40%|████      | 40/100 [03:12<05:00,  5.01s/it]Best trial: 30. Best value: 0.210956:  40%|████      | 40/100 [03:17<05:00,  5.01s/it]Best trial: 30. Best value: 0.210956:  41%|████      | 41/100 [03:17<04:56,  5.02s/it]Best trial: 30. Best value: 0.210956:  41%|████      | 41/100 [03:21<04:56,  5.02s/it]Best trial: 30. Best value: 0.210956:  42%|████▏     | 42/100 [03:21<04:38,  4.80s/it]Best trial: 30. Best value: 0.210956:  42%|████▏     | 42/100 [03:26<04:38,  4.80s/it]Best trial: 30. Best value: 0.210956:  43%|████▎     | 43/100 [03:26<04:36,  4.86s/it]Best trial: 30. Best value: 0.210956:  43%|████▎     | 43/100 [03:31<04:36,  4.86s/it]Best trial: 30. Best value: 0.210956:  44%|████▍     | 44/100 [03:31<04:39,  4.98s/it]Best trial: 30. Best value: 0.210956:  44%|████▍     | 44/100 [03:35<04:39,  4.98s/it]Best trial: 30. Best value: 0.210956:  45%|████▌     | 45/100 [03:35<04:17,  4.68s/it]Best trial: 30. Best value: 0.210956:  45%|████▌     | 45/100 [03:41<04:17,  4.68s/it]Best trial: 30. Best value: 0.210956:  46%|████▌     | 46/100 [03:41<04:28,  4.98s/it]Best trial: 30. Best value: 0.210956:  46%|████▌     | 46/100 [03:46<04:28,  4.98s/it]Best trial: 30. Best value: 0.210956:  47%|████▋     | 47/100 [03:46<04:21,  4.94s/it]Best trial: 30. Best value: 0.210956:  47%|████▋     | 47/100 [03:50<04:21,  4.94s/it]Best trial: 30. Best value: 0.210956:  48%|████▊     | 48/100 [03:50<04:10,  4.81s/it]Best trial: 30. Best value: 0.210956:  48%|████▊     | 48/100 [03:54<04:10,  4.81s/it]Best trial: 30. Best value: 0.210956:  49%|████▉     | 49/100 [03:54<03:51,  4.53s/it]Best trial: 30. Best value: 0.210956:  49%|████▉     | 49/100 [04:02<03:51,  4.53s/it]Best trial: 30. Best value: 0.210956:  50%|█████     | 50/100 [04:02<04:33,  5.46s/it]Best trial: 30. Best value: 0.210956:  50%|█████     | 50/100 [04:06<04:33,  5.46s/it]Best trial: 30. Best value: 0.210956:  51%|█████     | 51/100 [04:06<04:09,  5.09s/it]Best trial: 30. Best value: 0.210956:  51%|█████     | 51/100 [04:11<04:09,  5.09s/it]Best trial: 30. Best value: 0.210956:  52%|█████▏    | 52/100 [04:11<04:03,  5.07s/it]Best trial: 52. Best value: 0.226434:  52%|█████▏    | 52/100 [04:17<04:03,  5.07s/it]Best trial: 52. Best value: 0.226434:  53%|█████▎    | 53/100 [04:17<04:17,  5.48s/it]Best trial: 52. Best value: 0.226434:  53%|█████▎    | 53/100 [04:22<04:17,  5.48s/it]Best trial: 52. Best value: 0.226434:  54%|█████▍    | 54/100 [04:22<04:04,  5.31s/it]Best trial: 52. Best value: 0.226434:  54%|█████▍    | 54/100 [04:26<04:04,  5.31s/it]Best trial: 52. Best value: 0.226434:  55%|█████▌    | 55/100 [04:26<03:40,  4.89s/it]Best trial: 52. Best value: 0.226434:  55%|█████▌    | 55/100 [04:32<03:40,  4.89s/it]Best trial: 52. Best value: 0.226434:  56%|█████▌    | 56/100 [04:32<03:52,  5.27s/it]Best trial: 52. Best value: 0.226434:  56%|█████▌    | 56/100 [04:36<03:52,  5.27s/it]Best trial: 52. Best value: 0.226434:  57%|█████▋    | 57/100 [04:36<03:29,  4.87s/it]Best trial: 52. Best value: 0.226434:  57%|█████▋    | 57/100 [04:41<03:29,  4.87s/it]Best trial: 52. Best value: 0.226434:  58%|█████▊    | 58/100 [04:41<03:16,  4.67s/it]Best trial: 52. Best value: 0.226434:  58%|█████▊    | 58/100 [04:44<03:16,  4.67s/it]Best trial: 52. Best value: 0.226434:  59%|█████▉    | 59/100 [04:44<02:58,  4.35s/it]Best trial: 52. Best value: 0.226434:  59%|█████▉    | 59/100 [04:50<02:58,  4.35s/it]Best trial: 52. Best value: 0.226434:  60%|██████    | 60/100 [04:50<03:06,  4.66s/it]Best trial: 52. Best value: 0.226434:  60%|██████    | 60/100 [04:53<03:06,  4.66s/it]Best trial: 52. Best value: 0.226434:  61%|██████    | 61/100 [04:53<02:48,  4.33s/it]Best trial: 52. Best value: 0.226434:  61%|██████    | 61/100 [04:58<02:48,  4.33s/it]Best trial: 52. Best value: 0.226434:  62%|██████▏   | 62/100 [04:58<02:46,  4.37s/it]Best trial: 52. Best value: 0.226434:  62%|██████▏   | 62/100 [05:01<02:46,  4.37s/it]Best trial: 52. Best value: 0.226434:  63%|██████▎   | 63/100 [05:01<02:35,  4.20s/it]Best trial: 52. Best value: 0.226434:  63%|██████▎   | 63/100 [05:07<02:35,  4.20s/it]Best trial: 52. Best value: 0.226434:  64%|██████▍   | 64/100 [05:07<02:44,  4.56s/it]Best trial: 52. Best value: 0.226434:  64%|██████▍   | 64/100 [05:11<02:44,  4.56s/it]Best trial: 52. Best value: 0.226434:  65%|██████▌   | 65/100 [05:11<02:40,  4.58s/it]Best trial: 52. Best value: 0.226434:  65%|██████▌   | 65/100 [05:15<02:40,  4.58s/it]Best trial: 52. Best value: 0.226434:  66%|██████▌   | 66/100 [05:15<02:24,  4.25s/it]Best trial: 52. Best value: 0.226434:  66%|██████▌   | 66/100 [05:21<02:24,  4.25s/it]Best trial: 52. Best value: 0.226434:  67%|██████▋   | 67/100 [05:21<02:40,  4.88s/it]Best trial: 52. Best value: 0.226434:  67%|██████▋   | 67/100 [05:28<02:40,  4.88s/it]Best trial: 52. Best value: 0.226434:  68%|██████▊   | 68/100 [05:28<02:49,  5.31s/it]Best trial: 52. Best value: 0.226434:  68%|██████▊   | 68/100 [05:31<02:49,  5.31s/it]Best trial: 52. Best value: 0.226434:  69%|██████▉   | 69/100 [05:31<02:31,  4.89s/it]Best trial: 52. Best value: 0.226434:  69%|██████▉   | 69/100 [05:36<02:31,  4.89s/it]Best trial: 52. Best value: 0.226434:  70%|███████   | 70/100 [05:36<02:22,  4.76s/it]Best trial: 52. Best value: 0.226434:  70%|███████   | 70/100 [05:40<02:22,  4.76s/it]Best trial: 52. Best value: 0.226434:  71%|███████   | 71/100 [05:40<02:11,  4.54s/it]Best trial: 52. Best value: 0.226434:  71%|███████   | 71/100 [05:44<02:11,  4.54s/it]Best trial: 52. Best value: 0.226434:  72%|███████▏  | 72/100 [05:44<02:03,  4.40s/it]Best trial: 52. Best value: 0.226434:  72%|███████▏  | 72/100 [05:48<02:03,  4.40s/it]Best trial: 52. Best value: 0.226434:  73%|███████▎  | 73/100 [05:48<01:53,  4.19s/it]Best trial: 52. Best value: 0.226434:  73%|███████▎  | 73/100 [05:52<01:53,  4.19s/it]Best trial: 52. Best value: 0.226434:  74%|███████▍  | 74/100 [05:52<01:47,  4.12s/it]Best trial: 52. Best value: 0.226434:  74%|███████▍  | 74/100 [05:56<01:47,  4.12s/it]Best trial: 52. Best value: 0.226434:  75%|███████▌  | 75/100 [05:56<01:43,  4.14s/it]Best trial: 52. Best value: 0.226434:  75%|███████▌  | 75/100 [06:00<01:43,  4.14s/it]Best trial: 52. Best value: 0.226434:  76%|███████▌  | 76/100 [06:00<01:38,  4.09s/it]Best trial: 52. Best value: 0.226434:  76%|███████▌  | 76/100 [06:05<01:38,  4.09s/it]Best trial: 52. Best value: 0.226434:  77%|███████▋  | 77/100 [06:05<01:42,  4.46s/it]Best trial: 52. Best value: 0.226434:  77%|███████▋  | 77/100 [06:11<01:42,  4.46s/it]Best trial: 52. Best value: 0.226434:  78%|███████▊  | 78/100 [06:11<01:47,  4.87s/it]Best trial: 52. Best value: 0.226434:  78%|███████▊  | 78/100 [06:16<01:47,  4.87s/it]Best trial: 52. Best value: 0.226434:  79%|███████▉  | 79/100 [06:16<01:42,  4.87s/it]Best trial: 52. Best value: 0.226434:  79%|███████▉  | 79/100 [06:21<01:42,  4.87s/it]Best trial: 52. Best value: 0.226434:  80%|████████  | 80/100 [06:21<01:38,  4.93s/it]Best trial: 52. Best value: 0.226434:  80%|████████  | 80/100 [06:26<01:38,  4.93s/it]Best trial: 52. Best value: 0.226434:  81%|████████  | 81/100 [06:26<01:32,  4.86s/it]Best trial: 52. Best value: 0.226434:  81%|████████  | 81/100 [06:33<01:32,  4.86s/it]Best trial: 52. Best value: 0.226434:  82%|████████▏ | 82/100 [06:33<01:39,  5.53s/it]Best trial: 52. Best value: 0.226434:  82%|████████▏ | 82/100 [06:38<01:39,  5.53s/it]Best trial: 52. Best value: 0.226434:  83%|████████▎ | 83/100 [06:38<01:31,  5.39s/it]Best trial: 52. Best value: 0.226434:  83%|████████▎ | 83/100 [06:43<01:31,  5.39s/it]Best trial: 52. Best value: 0.226434:  84%|████████▍ | 84/100 [06:43<01:25,  5.33s/it]Best trial: 52. Best value: 0.226434:  84%|████████▍ | 84/100 [06:47<01:25,  5.33s/it]Best trial: 52. Best value: 0.226434:  85%|████████▌ | 85/100 [06:47<01:13,  4.91s/it]Best trial: 52. Best value: 0.226434:  85%|████████▌ | 85/100 [06:52<01:13,  4.91s/it]Best trial: 52. Best value: 0.226434:  86%|████████▌ | 86/100 [06:52<01:09,  4.96s/it]Best trial: 52. Best value: 0.226434:  86%|████████▌ | 86/100 [06:57<01:09,  4.96s/it]Best trial: 52. Best value: 0.226434:  87%|████████▋ | 87/100 [06:57<01:03,  4.89s/it]Best trial: 52. Best value: 0.226434:  87%|████████▋ | 87/100 [07:03<01:03,  4.89s/it]Best trial: 52. Best value: 0.226434:  88%|████████▊ | 88/100 [07:03<01:02,  5.17s/it]Best trial: 52. Best value: 0.226434:  88%|████████▊ | 88/100 [07:08<01:02,  5.17s/it]Best trial: 52. Best value: 0.226434:  89%|████████▉ | 89/100 [07:08<00:58,  5.36s/it]Best trial: 52. Best value: 0.226434:  89%|████████▉ | 89/100 [07:13<00:58,  5.36s/it]Best trial: 52. Best value: 0.226434:  90%|█████████ | 90/100 [07:13<00:52,  5.28s/it]Best trial: 52. Best value: 0.226434:  90%|█████████ | 90/100 [07:18<00:52,  5.28s/it]Best trial: 52. Best value: 0.226434:  91%|█████████ | 91/100 [07:18<00:46,  5.21s/it]Best trial: 52. Best value: 0.226434:  91%|█████████ | 91/100 [07:24<00:46,  5.21s/it]Best trial: 52. Best value: 0.226434:  92%|█████████▏| 92/100 [07:24<00:42,  5.32s/it]Best trial: 52. Best value: 0.226434:  92%|█████████▏| 92/100 [07:29<00:42,  5.32s/it]Best trial: 52. Best value: 0.226434:  93%|█████████▎| 93/100 [07:29<00:36,  5.23s/it]Best trial: 52. Best value: 0.226434:  93%|█████████▎| 93/100 [07:34<00:36,  5.23s/it]Best trial: 52. Best value: 0.226434:  94%|█████████▍| 94/100 [07:34<00:31,  5.23s/it]Best trial: 52. Best value: 0.226434:  94%|█████████▍| 94/100 [07:42<00:31,  5.23s/it]Best trial: 52. Best value: 0.226434:  95%|█████████▌| 95/100 [07:42<00:29,  5.82s/it]Best trial: 52. Best value: 0.226434:  95%|█████████▌| 95/100 [07:45<00:29,  5.82s/it]Best trial: 52. Best value: 0.226434:  96%|█████████▌| 96/100 [07:45<00:20,  5.08s/it]Best trial: 52. Best value: 0.226434:  96%|█████████▌| 96/100 [07:51<00:20,  5.08s/it]Best trial: 52. Best value: 0.226434:  97%|█████████▋| 97/100 [07:51<00:15,  5.28s/it]Best trial: 52. Best value: 0.226434:  97%|█████████▋| 97/100 [07:54<00:15,  5.28s/it]Best trial: 52. Best value: 0.226434:  98%|█████████▊| 98/100 [07:54<00:09,  4.83s/it]Best trial: 52. Best value: 0.226434:  98%|█████████▊| 98/100 [07:58<00:09,  4.83s/it]Best trial: 52. Best value: 0.226434:  99%|█████████▉| 99/100 [07:58<00:04,  4.58s/it]Best trial: 52. Best value: 0.226434:  99%|█████████▉| 99/100 [08:03<00:04,  4.58s/it]Best trial: 52. Best value: 0.226434: 100%|██████████| 100/100 [08:03<00:00,  4.48s/it]Best trial: 52. Best value: 0.226434: 100%|██████████| 100/100 [08:03<00:00,  4.83s/it]
2025-11-30 17:07:38,908 - INFO - HPO Complete. Best AUPRC: 0.2264
2025-11-30 17:07:38,909 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.019118702855456127, 'max_depth': 4, 'subsample': 0.8347169331980091, 'colsample_bytree': 0.8271384855506881, 'gamma': 2.7497778388888796, 'reg_lambda': 0.00020481081355433248, 'reg_alpha': 9.930360083981497e-08}
2025-11-30 17:07:38,909 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/mortality/windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:07:40,720 - INFO - Starting Training/Evaluation for Outcome: mortality, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 17:07:40,720 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 17:07:40,926 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 17:07:40,992 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:07:41,005 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 17:07:41,005 - INFO - Positive samples in train: 21, Negative: 2740, Scale Pos Weight: 130.4762
2025-11-30 17:07:41,005 - INFO - Training model...
2025-11-30 17:07:44,780 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:07:51,331 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:07:51,331 - INFO - AUROC: 0.6706 (0.3171 - 0.8742)
2025-11-30 17:07:51,332 - INFO - AUPRC: 0.0276 (0.0069 - 0.1043)
2025-11-30 17:07:51,332 - INFO - Brier Score: 0.0087 (0.0039 - 0.0151)
2025-11-30 17:07:51,332 - INFO - Accuracy: 0.9624 (0.8786 - 0.9717)
2025-11-30 17:07:51,332 - INFO - Precision: 0.0455 (0.0000 - 0.1264)
2025-11-30 17:07:51,332 - INFO - Sensitivity (Recall): 0.1667 (0.0000 - 0.7600)
2025-11-30 17:07:51,332 - INFO - F1-Score: 0.0714 (0.0000 - 0.1982)
2025-11-30 17:07:51,332 - INFO - Best Threshold: 0.0300 (0.0100 - 0.0300)
2025-11-30 17:07:51,332 - INFO - Specificity: 0.9694 (0.8860 - 0.9807)
2025-11-30 17:07:51,343 - INFO - Calculating SHAP values...
2025-11-30 17:07:52,450 - INFO - SHAP plots saved.
2025-11-30 17:07:52,451 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/mortality/windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:07:53,695 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_only
2025-11-30 17:07:53,695 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:07:53,792 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:07:53,811 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:07:53,815 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 17:07:53,816 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.54928:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.54928:   1%|          | 1/100 [00:04<06:49,  4.13s/it]Best trial: 0. Best value: 0.54928:   1%|          | 1/100 [00:08<06:49,  4.13s/it]Best trial: 0. Best value: 0.54928:   2%|▏         | 2/100 [00:08<07:06,  4.35s/it]Best trial: 0. Best value: 0.54928:   2%|▏         | 2/100 [00:10<07:06,  4.35s/it]Best trial: 0. Best value: 0.54928:   3%|▎         | 3/100 [00:10<05:00,  3.10s/it]Best trial: 0. Best value: 0.54928:   3%|▎         | 3/100 [00:11<05:00,  3.10s/it]Best trial: 0. Best value: 0.54928:   4%|▍         | 4/100 [00:11<03:41,  2.30s/it]Best trial: 0. Best value: 0.54928:   4%|▍         | 4/100 [00:13<03:41,  2.30s/it]Best trial: 0. Best value: 0.54928:   5%|▌         | 5/100 [00:13<03:33,  2.25s/it]Best trial: 5. Best value: 0.557122:   5%|▌         | 5/100 [00:14<03:33,  2.25s/it]Best trial: 5. Best value: 0.557122:   6%|▌         | 6/100 [00:14<03:02,  1.94s/it]Best trial: 5. Best value: 0.557122:   6%|▌         | 6/100 [00:16<03:02,  1.94s/it]Best trial: 5. Best value: 0.557122:   7%|▋         | 7/100 [00:16<03:03,  1.97s/it]Best trial: 5. Best value: 0.557122:   7%|▋         | 7/100 [00:18<03:03,  1.97s/it]Best trial: 5. Best value: 0.557122:   8%|▊         | 8/100 [00:18<02:43,  1.78s/it]Best trial: 5. Best value: 0.557122:   8%|▊         | 8/100 [00:21<02:43,  1.78s/it]Best trial: 5. Best value: 0.557122:   9%|▉         | 9/100 [00:21<03:11,  2.11s/it]Best trial: 5. Best value: 0.557122:   9%|▉         | 9/100 [00:24<03:11,  2.11s/it]Best trial: 5. Best value: 0.557122:  10%|█         | 10/100 [00:24<03:45,  2.51s/it]Best trial: 5. Best value: 0.557122:  10%|█         | 10/100 [00:26<03:45,  2.51s/it]Best trial: 5. Best value: 0.557122:  11%|█         | 11/100 [00:26<03:29,  2.35s/it]Best trial: 11. Best value: 0.55919:  11%|█         | 11/100 [00:28<03:29,  2.35s/it]Best trial: 11. Best value: 0.55919:  12%|█▏        | 12/100 [00:28<03:28,  2.37s/it]Best trial: 12. Best value: 0.562152:  12%|█▏        | 12/100 [00:31<03:28,  2.37s/it]Best trial: 12. Best value: 0.562152:  13%|█▎        | 13/100 [00:31<03:36,  2.49s/it]Best trial: 12. Best value: 0.562152:  13%|█▎        | 13/100 [00:33<03:36,  2.49s/it]Best trial: 12. Best value: 0.562152:  14%|█▍        | 14/100 [00:33<03:27,  2.41s/it]Best trial: 12. Best value: 0.562152:  14%|█▍        | 14/100 [00:36<03:27,  2.41s/it]Best trial: 12. Best value: 0.562152:  15%|█▌        | 15/100 [00:36<03:41,  2.61s/it]Best trial: 12. Best value: 0.562152:  15%|█▌        | 15/100 [00:39<03:41,  2.61s/it]Best trial: 12. Best value: 0.562152:  16%|█▌        | 16/100 [00:39<03:33,  2.55s/it]Best trial: 12. Best value: 0.562152:  16%|█▌        | 16/100 [00:41<03:33,  2.55s/it]Best trial: 12. Best value: 0.562152:  17%|█▋        | 17/100 [00:41<03:16,  2.36s/it]Best trial: 12. Best value: 0.562152:  17%|█▋        | 17/100 [00:42<03:16,  2.36s/it]Best trial: 12. Best value: 0.562152:  18%|█▊        | 18/100 [00:42<02:57,  2.16s/it]Best trial: 12. Best value: 0.562152:  18%|█▊        | 18/100 [00:44<02:57,  2.16s/it]Best trial: 12. Best value: 0.562152:  19%|█▉        | 19/100 [00:44<02:32,  1.88s/it]Best trial: 12. Best value: 0.562152:  19%|█▉        | 19/100 [00:46<02:32,  1.88s/it]Best trial: 12. Best value: 0.562152:  20%|██        | 20/100 [00:46<02:49,  2.12s/it]Best trial: 12. Best value: 0.562152:  20%|██        | 20/100 [00:48<02:49,  2.12s/it]Best trial: 12. Best value: 0.562152:  21%|██        | 21/100 [00:48<02:46,  2.11s/it]Best trial: 21. Best value: 0.566946:  21%|██        | 21/100 [00:51<02:46,  2.11s/it]Best trial: 21. Best value: 0.566946:  22%|██▏       | 22/100 [00:51<02:56,  2.26s/it]Best trial: 21. Best value: 0.566946:  22%|██▏       | 22/100 [00:53<02:56,  2.26s/it]Best trial: 21. Best value: 0.566946:  23%|██▎       | 23/100 [00:53<02:39,  2.08s/it]Best trial: 21. Best value: 0.566946:  23%|██▎       | 23/100 [00:56<02:39,  2.08s/it]Best trial: 21. Best value: 0.566946:  24%|██▍       | 24/100 [00:56<03:03,  2.41s/it]Best trial: 21. Best value: 0.566946:  24%|██▍       | 24/100 [00:58<03:03,  2.41s/it]Best trial: 21. Best value: 0.566946:  25%|██▌       | 25/100 [00:58<02:53,  2.31s/it]Best trial: 21. Best value: 0.566946:  25%|██▌       | 25/100 [01:00<02:53,  2.31s/it]Best trial: 21. Best value: 0.566946:  26%|██▌       | 26/100 [01:00<02:33,  2.08s/it]Best trial: 26. Best value: 0.572539:  26%|██▌       | 26/100 [01:01<02:33,  2.08s/it]Best trial: 26. Best value: 0.572539:  27%|██▋       | 27/100 [01:01<02:21,  1.94s/it]Best trial: 26. Best value: 0.572539:  27%|██▋       | 27/100 [01:03<02:21,  1.94s/it]Best trial: 26. Best value: 0.572539:  28%|██▊       | 28/100 [01:03<02:11,  1.82s/it]Best trial: 26. Best value: 0.572539:  28%|██▊       | 28/100 [01:04<02:11,  1.82s/it]Best trial: 26. Best value: 0.572539:  29%|██▉       | 29/100 [01:04<02:02,  1.73s/it]Best trial: 26. Best value: 0.572539:  29%|██▉       | 29/100 [01:06<02:02,  1.73s/it]Best trial: 26. Best value: 0.572539:  30%|███       | 30/100 [01:06<01:57,  1.68s/it]Best trial: 26. Best value: 0.572539:  30%|███       | 30/100 [01:07<01:57,  1.68s/it]Best trial: 26. Best value: 0.572539:  31%|███       | 31/100 [01:07<01:55,  1.67s/it]Best trial: 26. Best value: 0.572539:  31%|███       | 31/100 [01:09<01:55,  1.67s/it]Best trial: 26. Best value: 0.572539:  32%|███▏      | 32/100 [01:09<01:53,  1.67s/it]Best trial: 26. Best value: 0.572539:  32%|███▏      | 32/100 [01:11<01:53,  1.67s/it]Best trial: 26. Best value: 0.572539:  33%|███▎      | 33/100 [01:11<01:50,  1.64s/it]Best trial: 26. Best value: 0.572539:  33%|███▎      | 33/100 [01:12<01:50,  1.64s/it]Best trial: 26. Best value: 0.572539:  34%|███▍      | 34/100 [01:12<01:40,  1.53s/it]Best trial: 34. Best value: 0.573139:  34%|███▍      | 34/100 [01:14<01:40,  1.53s/it]Best trial: 34. Best value: 0.573139:  35%|███▌      | 35/100 [01:14<01:59,  1.84s/it]Best trial: 35. Best value: 0.573903:  35%|███▌      | 35/100 [01:17<01:59,  1.84s/it]Best trial: 35. Best value: 0.573903:  36%|███▌      | 36/100 [01:17<02:06,  1.98s/it]Best trial: 35. Best value: 0.573903:  36%|███▌      | 36/100 [01:19<02:06,  1.98s/it]Best trial: 35. Best value: 0.573903:  37%|███▋      | 37/100 [01:19<02:05,  2.00s/it]Best trial: 35. Best value: 0.573903:  37%|███▋      | 37/100 [01:21<02:05,  2.00s/it]Best trial: 35. Best value: 0.573903:  38%|███▊      | 38/100 [01:21<02:01,  1.96s/it]Best trial: 35. Best value: 0.573903:  38%|███▊      | 38/100 [01:22<02:01,  1.96s/it]Best trial: 35. Best value: 0.573903:  39%|███▉      | 39/100 [01:22<01:54,  1.88s/it]Best trial: 35. Best value: 0.573903:  39%|███▉      | 39/100 [01:25<01:54,  1.88s/it]Best trial: 35. Best value: 0.573903:  40%|████      | 40/100 [01:25<02:04,  2.08s/it]Best trial: 35. Best value: 0.573903:  40%|████      | 40/100 [01:27<02:04,  2.08s/it]Best trial: 35. Best value: 0.573903:  41%|████      | 41/100 [01:27<01:58,  2.01s/it]Best trial: 35. Best value: 0.573903:  41%|████      | 41/100 [01:28<01:58,  2.01s/it]Best trial: 35. Best value: 0.573903:  42%|████▏     | 42/100 [01:28<01:50,  1.91s/it]Best trial: 35. Best value: 0.573903:  42%|████▏     | 42/100 [01:30<01:50,  1.91s/it]Best trial: 35. Best value: 0.573903:  43%|████▎     | 43/100 [01:30<01:45,  1.84s/it]Best trial: 35. Best value: 0.573903:  43%|████▎     | 43/100 [01:33<01:45,  1.84s/it]Best trial: 35. Best value: 0.573903:  44%|████▍     | 44/100 [01:33<02:06,  2.27s/it]Best trial: 35. Best value: 0.573903:  44%|████▍     | 44/100 [01:35<02:06,  2.27s/it]Best trial: 35. Best value: 0.573903:  45%|████▌     | 45/100 [01:35<01:51,  2.03s/it]Best trial: 35. Best value: 0.573903:  45%|████▌     | 45/100 [01:38<01:51,  2.03s/it]Best trial: 35. Best value: 0.573903:  46%|████▌     | 46/100 [01:38<02:09,  2.41s/it]Best trial: 35. Best value: 0.573903:  46%|████▌     | 46/100 [01:39<02:09,  2.41s/it]Best trial: 35. Best value: 0.573903:  47%|████▋     | 47/100 [01:39<01:50,  2.08s/it]Best trial: 35. Best value: 0.573903:  47%|████▋     | 47/100 [01:42<01:50,  2.08s/it]Best trial: 35. Best value: 0.573903:  48%|████▊     | 48/100 [01:42<01:50,  2.13s/it]Best trial: 35. Best value: 0.573903:  48%|████▊     | 48/100 [01:43<01:50,  2.13s/it]Best trial: 35. Best value: 0.573903:  49%|████▉     | 49/100 [01:43<01:41,  1.99s/it]Best trial: 35. Best value: 0.573903:  49%|████▉     | 49/100 [01:46<01:41,  1.99s/it]Best trial: 35. Best value: 0.573903:  50%|█████     | 50/100 [01:46<01:43,  2.07s/it]Best trial: 35. Best value: 0.573903:  50%|█████     | 50/100 [01:50<01:43,  2.07s/it]Best trial: 35. Best value: 0.573903:  51%|█████     | 51/100 [01:50<02:10,  2.67s/it]Best trial: 51. Best value: 0.574281:  51%|█████     | 51/100 [01:52<02:10,  2.67s/it]Best trial: 51. Best value: 0.574281:  52%|█████▏    | 52/100 [01:52<02:08,  2.67s/it]Best trial: 52. Best value: 0.574708:  52%|█████▏    | 52/100 [01:54<02:08,  2.67s/it]Best trial: 52. Best value: 0.574708:  53%|█████▎    | 53/100 [01:54<01:56,  2.48s/it]Best trial: 52. Best value: 0.574708:  53%|█████▎    | 53/100 [01:56<01:56,  2.48s/it]Best trial: 52. Best value: 0.574708:  54%|█████▍    | 54/100 [01:56<01:39,  2.16s/it]Best trial: 52. Best value: 0.574708:  54%|█████▍    | 54/100 [01:58<01:39,  2.16s/it]Best trial: 52. Best value: 0.574708:  55%|█████▌    | 55/100 [01:58<01:30,  2.02s/it]Best trial: 52. Best value: 0.574708:  55%|█████▌    | 55/100 [01:59<01:30,  2.02s/it]Best trial: 52. Best value: 0.574708:  56%|█████▌    | 56/100 [01:59<01:18,  1.80s/it]Best trial: 52. Best value: 0.574708:  56%|█████▌    | 56/100 [02:01<01:18,  1.80s/it]Best trial: 52. Best value: 0.574708:  57%|█████▋    | 57/100 [02:01<01:17,  1.80s/it]Best trial: 52. Best value: 0.574708:  57%|█████▋    | 57/100 [02:03<01:17,  1.80s/it]Best trial: 52. Best value: 0.574708:  58%|█████▊    | 58/100 [02:03<01:22,  1.97s/it]Best trial: 52. Best value: 0.574708:  58%|█████▊    | 58/100 [02:04<01:22,  1.97s/it]Best trial: 52. Best value: 0.574708:  59%|█████▉    | 59/100 [02:04<01:10,  1.72s/it]Best trial: 52. Best value: 0.574708:  59%|█████▉    | 59/100 [02:05<01:10,  1.72s/it]Best trial: 52. Best value: 0.574708:  60%|██████    | 60/100 [02:05<01:03,  1.60s/it]Best trial: 52. Best value: 0.574708:  60%|██████    | 60/100 [02:07<01:03,  1.60s/it]Best trial: 52. Best value: 0.574708:  61%|██████    | 61/100 [02:07<01:05,  1.69s/it]Best trial: 52. Best value: 0.574708:  61%|██████    | 61/100 [02:09<01:05,  1.69s/it]Best trial: 52. Best value: 0.574708:  62%|██████▏   | 62/100 [02:09<01:09,  1.82s/it]Best trial: 52. Best value: 0.574708:  62%|██████▏   | 62/100 [02:11<01:09,  1.82s/it]Best trial: 52. Best value: 0.574708:  63%|██████▎   | 63/100 [02:11<01:04,  1.75s/it]Best trial: 52. Best value: 0.574708:  63%|██████▎   | 63/100 [02:13<01:04,  1.75s/it]Best trial: 52. Best value: 0.574708:  64%|██████▍   | 64/100 [02:13<01:10,  1.95s/it]Best trial: 52. Best value: 0.574708:  64%|██████▍   | 64/100 [02:15<01:10,  1.95s/it]Best trial: 52. Best value: 0.574708:  65%|██████▌   | 65/100 [02:15<01:05,  1.86s/it]Best trial: 52. Best value: 0.574708:  65%|██████▌   | 65/100 [02:18<01:05,  1.86s/it]Best trial: 52. Best value: 0.574708:  66%|██████▌   | 66/100 [02:18<01:12,  2.12s/it]Best trial: 52. Best value: 0.574708:  66%|██████▌   | 66/100 [02:19<01:12,  2.12s/it]Best trial: 52. Best value: 0.574708:  67%|██████▋   | 67/100 [02:19<01:04,  1.94s/it]Best trial: 52. Best value: 0.574708:  67%|██████▋   | 67/100 [02:22<01:04,  1.94s/it]Best trial: 52. Best value: 0.574708:  68%|██████▊   | 68/100 [02:22<01:05,  2.06s/it]Best trial: 52. Best value: 0.574708:  68%|██████▊   | 68/100 [02:24<01:05,  2.06s/it]Best trial: 52. Best value: 0.574708:  69%|██████▉   | 69/100 [02:24<01:08,  2.23s/it]Best trial: 52. Best value: 0.574708:  69%|██████▉   | 69/100 [02:26<01:08,  2.23s/it]Best trial: 52. Best value: 0.574708:  70%|███████   | 70/100 [02:26<01:04,  2.17s/it]Best trial: 52. Best value: 0.574708:  70%|███████   | 70/100 [02:28<01:04,  2.17s/it]Best trial: 52. Best value: 0.574708:  71%|███████   | 71/100 [02:28<00:56,  1.95s/it]Best trial: 52. Best value: 0.574708:  71%|███████   | 71/100 [02:30<00:56,  1.95s/it]Best trial: 52. Best value: 0.574708:  72%|███████▏  | 72/100 [02:30<00:53,  1.90s/it]Best trial: 52. Best value: 0.574708:  72%|███████▏  | 72/100 [02:32<00:53,  1.90s/it]Best trial: 52. Best value: 0.574708:  73%|███████▎  | 73/100 [02:32<00:51,  1.91s/it]Best trial: 52. Best value: 0.574708:  73%|███████▎  | 73/100 [02:33<00:51,  1.91s/it]Best trial: 52. Best value: 0.574708:  74%|███████▍  | 74/100 [02:33<00:45,  1.74s/it]Best trial: 52. Best value: 0.574708:  74%|███████▍  | 74/100 [02:34<00:45,  1.74s/it]Best trial: 52. Best value: 0.574708:  75%|███████▌  | 75/100 [02:34<00:40,  1.64s/it]Best trial: 52. Best value: 0.574708:  75%|███████▌  | 75/100 [02:36<00:40,  1.64s/it]Best trial: 52. Best value: 0.574708:  76%|███████▌  | 76/100 [02:36<00:39,  1.66s/it]Best trial: 52. Best value: 0.574708:  76%|███████▌  | 76/100 [02:39<00:39,  1.66s/it]Best trial: 52. Best value: 0.574708:  77%|███████▋  | 77/100 [02:39<00:50,  2.21s/it]Best trial: 52. Best value: 0.574708:  77%|███████▋  | 77/100 [02:41<00:50,  2.21s/it]Best trial: 52. Best value: 0.574708:  78%|███████▊  | 78/100 [02:41<00:45,  2.08s/it]Best trial: 52. Best value: 0.574708:  78%|███████▊  | 78/100 [02:43<00:45,  2.08s/it]Best trial: 52. Best value: 0.574708:  79%|███████▉  | 79/100 [02:43<00:43,  2.05s/it]Best trial: 52. Best value: 0.574708:  79%|███████▉  | 79/100 [02:45<00:43,  2.05s/it]Best trial: 52. Best value: 0.574708:  80%|████████  | 80/100 [02:45<00:38,  1.94s/it]Best trial: 52. Best value: 0.574708:  80%|████████  | 80/100 [02:47<00:38,  1.94s/it]Best trial: 52. Best value: 0.574708:  81%|████████  | 81/100 [02:47<00:36,  1.90s/it]Best trial: 81. Best value: 0.576766:  81%|████████  | 81/100 [02:49<00:36,  1.90s/it]Best trial: 81. Best value: 0.576766:  82%|████████▏ | 82/100 [02:49<00:35,  1.95s/it]Best trial: 81. Best value: 0.576766:  82%|████████▏ | 82/100 [02:51<00:35,  1.95s/it]Best trial: 81. Best value: 0.576766:  83%|████████▎ | 83/100 [02:51<00:33,  1.98s/it]Best trial: 81. Best value: 0.576766:  83%|████████▎ | 83/100 [02:53<00:33,  1.98s/it]Best trial: 81. Best value: 0.576766:  84%|████████▍ | 84/100 [02:53<00:30,  1.90s/it]Best trial: 81. Best value: 0.576766:  84%|████████▍ | 84/100 [02:55<00:30,  1.90s/it]Best trial: 81. Best value: 0.576766:  85%|████████▌ | 85/100 [02:55<00:30,  2.05s/it]Best trial: 81. Best value: 0.576766:  85%|████████▌ | 85/100 [02:57<00:30,  2.05s/it]Best trial: 81. Best value: 0.576766:  86%|████████▌ | 86/100 [02:57<00:28,  2.05s/it]Best trial: 81. Best value: 0.576766:  86%|████████▌ | 86/100 [02:59<00:28,  2.05s/it]Best trial: 81. Best value: 0.576766:  87%|████████▋ | 87/100 [02:59<00:26,  2.01s/it]Best trial: 81. Best value: 0.576766:  87%|████████▋ | 87/100 [03:01<00:26,  2.01s/it]Best trial: 81. Best value: 0.576766:  88%|████████▊ | 88/100 [03:01<00:24,  2.01s/it]Best trial: 81. Best value: 0.576766:  88%|████████▊ | 88/100 [03:02<00:24,  2.01s/it]Best trial: 81. Best value: 0.576766:  89%|████████▉ | 89/100 [03:02<00:20,  1.83s/it]Best trial: 81. Best value: 0.576766:  89%|████████▉ | 89/100 [03:04<00:20,  1.83s/it]Best trial: 81. Best value: 0.576766:  90%|█████████ | 90/100 [03:04<00:18,  1.83s/it]Best trial: 81. Best value: 0.576766:  90%|█████████ | 90/100 [03:06<00:18,  1.83s/it]Best trial: 81. Best value: 0.576766:  91%|█████████ | 91/100 [03:06<00:17,  1.92s/it]Best trial: 81. Best value: 0.576766:  91%|█████████ | 91/100 [03:08<00:17,  1.92s/it]Best trial: 81. Best value: 0.576766:  92%|█████████▏| 92/100 [03:08<00:15,  1.92s/it]Best trial: 81. Best value: 0.576766:  92%|█████████▏| 92/100 [03:10<00:15,  1.92s/it]Best trial: 81. Best value: 0.576766:  93%|█████████▎| 93/100 [03:10<00:13,  1.87s/it]Best trial: 93. Best value: 0.578303:  93%|█████████▎| 93/100 [03:12<00:13,  1.87s/it]Best trial: 93. Best value: 0.578303:  94%|█████████▍| 94/100 [03:12<00:11,  1.87s/it]Best trial: 93. Best value: 0.578303:  94%|█████████▍| 94/100 [03:14<00:11,  1.87s/it]Best trial: 93. Best value: 0.578303:  95%|█████████▌| 95/100 [03:14<00:09,  1.90s/it]Best trial: 93. Best value: 0.578303:  95%|█████████▌| 95/100 [03:15<00:09,  1.90s/it]Best trial: 93. Best value: 0.578303:  96%|█████████▌| 96/100 [03:15<00:07,  1.76s/it]Best trial: 93. Best value: 0.578303:  96%|█████████▌| 96/100 [03:17<00:07,  1.76s/it]Best trial: 93. Best value: 0.578303:  97%|█████████▋| 97/100 [03:17<00:04,  1.67s/it]Best trial: 93. Best value: 0.578303:  97%|█████████▋| 97/100 [03:18<00:04,  1.67s/it]Best trial: 93. Best value: 0.578303:  98%|█████████▊| 98/100 [03:18<00:03,  1.66s/it]Best trial: 93. Best value: 0.578303:  98%|█████████▊| 98/100 [03:20<00:03,  1.66s/it]Best trial: 93. Best value: 0.578303:  99%|█████████▉| 99/100 [03:20<00:01,  1.57s/it]Best trial: 93. Best value: 0.578303:  99%|█████████▉| 99/100 [03:21<00:01,  1.57s/it]Best trial: 93. Best value: 0.578303: 100%|██████████| 100/100 [03:21<00:00,  1.60s/it]Best trial: 93. Best value: 0.578303: 100%|██████████| 100/100 [03:21<00:00,  2.02s/it]
2025-11-30 17:11:15,659 - INFO - HPO Complete. Best AUPRC: 0.5783
2025-11-30 17:11:15,659 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.03337552155506684, 'max_depth': 3, 'subsample': 0.8373705777576679, 'colsample_bytree': 0.6569364939982341, 'gamma': 2.295546328237771, 'reg_lambda': 5.365035418458798e-05, 'reg_alpha': 0.000360421621580404}
2025-11-30 17:11:15,660 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:11:17,702 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_only
2025-11-30 17:11:17,702 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:11:17,789 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:11:17,806 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:11:17,811 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 17:11:17,811 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:11:17,811 - INFO - Training model...
2025-11-30 17:11:18,520 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:11:23,608 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:11:23,608 - INFO - AUROC: 0.7679 (0.7298 - 0.7977)
2025-11-30 17:11:23,608 - INFO - AUPRC: 0.5153 (0.4604 - 0.5883)
2025-11-30 17:11:23,608 - INFO - Brier Score: 0.1807 (0.1700 - 0.1920)
2025-11-30 17:11:23,608 - INFO - Accuracy: 0.7876 (0.6864 - 0.8133)
2025-11-30 17:11:23,608 - INFO - Precision: 0.5350 (0.3892 - 0.5924)
2025-11-30 17:11:23,608 - INFO - Sensitivity (Recall): 0.5316 (0.5335 - 0.7458)
2025-11-30 17:11:23,608 - INFO - F1-Score: 0.5333 (0.4884 - 0.5883)
2025-11-30 17:11:23,608 - INFO - Best Threshold: 0.6000 (0.4300 - 0.6200)
2025-11-30 17:11:23,608 - INFO - Specificity: 0.8633 (0.6924 - 0.8850)
2025-11-30 17:11:23,618 - INFO - Calculating SHAP values...
2025-11-30 17:11:24,622 - INFO - SHAP plots saved.
2025-11-30 17:11:24,622 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:11:25,812 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 17:11:25,812 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:11:25,896 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:11:25,904 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:11:25,906 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:11:25,906 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.394989:   0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.394989:   1%|          | 1/100 [00:00<01:09,  1.42it/s]Best trial: 1. Best value: 0.401614:   1%|          | 1/100 [00:01<01:09,  1.42it/s]Best trial: 1. Best value: 0.401614:   2%|▏         | 2/100 [00:01<01:20,  1.22it/s]Best trial: 1. Best value: 0.401614:   2%|▏         | 2/100 [00:03<01:20,  1.22it/s]Best trial: 1. Best value: 0.401614:   3%|▎         | 3/100 [00:03<01:50,  1.14s/it]Best trial: 1. Best value: 0.401614:   3%|▎         | 3/100 [00:05<01:50,  1.14s/it]Best trial: 1. Best value: 0.401614:   4%|▍         | 4/100 [00:05<02:32,  1.59s/it]Best trial: 1. Best value: 0.401614:   4%|▍         | 4/100 [00:06<02:32,  1.59s/it]Best trial: 1. Best value: 0.401614:   5%|▌         | 5/100 [00:06<02:18,  1.46s/it]Best trial: 1. Best value: 0.401614:   5%|▌         | 5/100 [00:07<02:18,  1.46s/it]Best trial: 1. Best value: 0.401614:   6%|▌         | 6/100 [00:07<01:54,  1.22s/it]Best trial: 1. Best value: 0.401614:   6%|▌         | 6/100 [00:09<01:54,  1.22s/it]Best trial: 1. Best value: 0.401614:   7%|▋         | 7/100 [00:09<02:16,  1.47s/it]Best trial: 1. Best value: 0.401614:   7%|▋         | 7/100 [00:12<02:16,  1.47s/it]Best trial: 1. Best value: 0.401614:   8%|▊         | 8/100 [00:12<02:50,  1.86s/it]Best trial: 8. Best value: 0.402833:   8%|▊         | 8/100 [00:12<02:50,  1.86s/it]Best trial: 8. Best value: 0.402833:   9%|▉         | 9/100 [00:12<02:20,  1.54s/it]Best trial: 8. Best value: 0.402833:   9%|▉         | 9/100 [00:14<02:20,  1.54s/it]Best trial: 8. Best value: 0.402833:  10%|█         | 10/100 [00:14<02:21,  1.57s/it]Best trial: 10. Best value: 0.407262:  10%|█         | 10/100 [00:15<02:21,  1.57s/it]Best trial: 10. Best value: 0.407262:  11%|█         | 11/100 [00:15<02:02,  1.37s/it]Best trial: 10. Best value: 0.407262:  11%|█         | 11/100 [00:16<02:02,  1.37s/it]Best trial: 10. Best value: 0.407262:  12%|█▏        | 12/100 [00:16<01:51,  1.27s/it]Best trial: 10. Best value: 0.407262:  12%|█▏        | 12/100 [00:17<01:51,  1.27s/it]Best trial: 10. Best value: 0.407262:  13%|█▎        | 13/100 [00:17<01:35,  1.10s/it]Best trial: 10. Best value: 0.407262:  13%|█▎        | 13/100 [00:17<01:35,  1.10s/it]Best trial: 10. Best value: 0.407262:  14%|█▍        | 14/100 [00:17<01:26,  1.01s/it]Best trial: 10. Best value: 0.407262:  14%|█▍        | 14/100 [00:18<01:26,  1.01s/it]Best trial: 10. Best value: 0.407262:  15%|█▌        | 15/100 [00:18<01:21,  1.04it/s]Best trial: 10. Best value: 0.407262:  15%|█▌        | 15/100 [00:19<01:21,  1.04it/s]Best trial: 10. Best value: 0.407262:  16%|█▌        | 16/100 [00:19<01:09,  1.20it/s]Best trial: 10. Best value: 0.407262:  16%|█▌        | 16/100 [00:20<01:09,  1.20it/s]Best trial: 10. Best value: 0.407262:  17%|█▋        | 17/100 [00:20<01:07,  1.23it/s]Best trial: 10. Best value: 0.407262:  17%|█▋        | 17/100 [00:21<01:07,  1.23it/s]Best trial: 10. Best value: 0.407262:  18%|█▊        | 18/100 [00:21<01:11,  1.15it/s]Best trial: 10. Best value: 0.407262:  18%|█▊        | 18/100 [00:22<01:11,  1.15it/s]Best trial: 10. Best value: 0.407262:  19%|█▉        | 19/100 [00:22<01:10,  1.15it/s]Best trial: 10. Best value: 0.407262:  19%|█▉        | 19/100 [00:22<01:10,  1.15it/s]Best trial: 10. Best value: 0.407262:  20%|██        | 20/100 [00:22<01:08,  1.17it/s]Best trial: 10. Best value: 0.407262:  20%|██        | 20/100 [00:23<01:08,  1.17it/s]Best trial: 10. Best value: 0.407262:  21%|██        | 21/100 [00:23<00:59,  1.32it/s]Best trial: 10. Best value: 0.407262:  21%|██        | 21/100 [00:24<00:59,  1.32it/s]Best trial: 10. Best value: 0.407262:  22%|██▏       | 22/100 [00:24<01:10,  1.11it/s]Best trial: 10. Best value: 0.407262:  22%|██▏       | 22/100 [00:25<01:10,  1.11it/s]Best trial: 10. Best value: 0.407262:  23%|██▎       | 23/100 [00:25<01:10,  1.09it/s]Best trial: 10. Best value: 0.407262:  23%|██▎       | 23/100 [00:26<01:10,  1.09it/s]Best trial: 10. Best value: 0.407262:  24%|██▍       | 24/100 [00:26<01:05,  1.15it/s]Best trial: 10. Best value: 0.407262:  24%|██▍       | 24/100 [00:27<01:05,  1.15it/s]Best trial: 10. Best value: 0.407262:  25%|██▌       | 25/100 [00:27<01:03,  1.18it/s]Best trial: 10. Best value: 0.407262:  25%|██▌       | 25/100 [00:27<01:03,  1.18it/s]Best trial: 10. Best value: 0.407262:  26%|██▌       | 26/100 [00:27<00:57,  1.29it/s]Best trial: 10. Best value: 0.407262:  26%|██▌       | 26/100 [00:28<00:57,  1.29it/s]Best trial: 10. Best value: 0.407262:  27%|██▋       | 27/100 [00:28<01:02,  1.17it/s]Best trial: 10. Best value: 0.407262:  27%|██▋       | 27/100 [00:29<01:02,  1.17it/s]Best trial: 10. Best value: 0.407262:  28%|██▊       | 28/100 [00:29<01:08,  1.05it/s]Best trial: 28. Best value: 0.410218:  28%|██▊       | 28/100 [00:30<01:08,  1.05it/s]Best trial: 28. Best value: 0.410218:  29%|██▉       | 29/100 [00:30<01:03,  1.13it/s]Best trial: 28. Best value: 0.410218:  29%|██▉       | 29/100 [00:31<01:03,  1.13it/s]Best trial: 28. Best value: 0.410218:  30%|███       | 30/100 [00:31<00:57,  1.22it/s]Best trial: 30. Best value: 0.410667:  30%|███       | 30/100 [00:31<00:57,  1.22it/s]Best trial: 30. Best value: 0.410667:  31%|███       | 31/100 [00:31<00:51,  1.33it/s]Best trial: 30. Best value: 0.410667:  31%|███       | 31/100 [00:32<00:51,  1.33it/s]Best trial: 30. Best value: 0.410667:  32%|███▏      | 32/100 [00:32<00:47,  1.43it/s]Best trial: 30. Best value: 0.410667:  32%|███▏      | 32/100 [00:33<00:47,  1.43it/s]Best trial: 30. Best value: 0.410667:  33%|███▎      | 33/100 [00:33<00:49,  1.35it/s]Best trial: 30. Best value: 0.410667:  33%|███▎      | 33/100 [00:33<00:49,  1.35it/s]Best trial: 30. Best value: 0.410667:  34%|███▍      | 34/100 [00:33<00:46,  1.42it/s]Best trial: 30. Best value: 0.410667:  34%|███▍      | 34/100 [00:34<00:46,  1.42it/s]Best trial: 30. Best value: 0.410667:  35%|███▌      | 35/100 [00:34<00:50,  1.29it/s]Best trial: 30. Best value: 0.410667:  35%|███▌      | 35/100 [00:35<00:50,  1.29it/s]Best trial: 30. Best value: 0.410667:  36%|███▌      | 36/100 [00:35<00:47,  1.34it/s]Best trial: 30. Best value: 0.410667:  36%|███▌      | 36/100 [00:36<00:47,  1.34it/s]Best trial: 30. Best value: 0.410667:  37%|███▋      | 37/100 [00:36<00:47,  1.33it/s]Best trial: 30. Best value: 0.410667:  37%|███▋      | 37/100 [00:37<00:47,  1.33it/s]Best trial: 30. Best value: 0.410667:  38%|███▊      | 38/100 [00:37<00:47,  1.32it/s]Best trial: 30. Best value: 0.410667:  38%|███▊      | 38/100 [00:37<00:47,  1.32it/s]Best trial: 30. Best value: 0.410667:  39%|███▉      | 39/100 [00:37<00:43,  1.39it/s]Best trial: 30. Best value: 0.410667:  39%|███▉      | 39/100 [00:38<00:43,  1.39it/s]Best trial: 30. Best value: 0.410667:  40%|████      | 40/100 [00:38<00:42,  1.40it/s]Best trial: 30. Best value: 0.410667:  40%|████      | 40/100 [00:40<00:42,  1.40it/s]Best trial: 30. Best value: 0.410667:  41%|████      | 41/100 [00:40<01:08,  1.16s/it]Best trial: 30. Best value: 0.410667:  41%|████      | 41/100 [00:41<01:08,  1.16s/it]Best trial: 30. Best value: 0.410667:  42%|████▏     | 42/100 [00:41<00:58,  1.01s/it]Best trial: 30. Best value: 0.410667:  42%|████▏     | 42/100 [00:41<00:58,  1.01s/it]Best trial: 30. Best value: 0.410667:  43%|████▎     | 43/100 [00:41<00:50,  1.14it/s]Best trial: 43. Best value: 0.411872:  43%|████▎     | 43/100 [00:42<00:50,  1.14it/s]Best trial: 43. Best value: 0.411872:  44%|████▍     | 44/100 [00:42<00:45,  1.23it/s]Best trial: 43. Best value: 0.411872:  44%|████▍     | 44/100 [00:43<00:45,  1.23it/s]Best trial: 43. Best value: 0.411872:  45%|████▌     | 45/100 [00:43<00:41,  1.33it/s]Best trial: 43. Best value: 0.411872:  45%|████▌     | 45/100 [00:45<00:41,  1.33it/s]Best trial: 43. Best value: 0.411872:  46%|████▌     | 46/100 [00:45<01:03,  1.18s/it]Best trial: 43. Best value: 0.411872:  46%|████▌     | 46/100 [00:46<01:03,  1.18s/it]Best trial: 43. Best value: 0.411872:  47%|████▋     | 47/100 [00:46<00:55,  1.05s/it]Best trial: 43. Best value: 0.411872:  47%|████▋     | 47/100 [00:46<00:55,  1.05s/it]Best trial: 43. Best value: 0.411872:  48%|████▊     | 48/100 [00:46<00:48,  1.08it/s]Best trial: 43. Best value: 0.411872:  48%|████▊     | 48/100 [00:47<00:48,  1.08it/s]Best trial: 43. Best value: 0.411872:  49%|████▉     | 49/100 [00:47<00:44,  1.14it/s]Best trial: 43. Best value: 0.411872:  49%|████▉     | 49/100 [00:48<00:44,  1.14it/s]Best trial: 43. Best value: 0.411872:  50%|█████     | 50/100 [00:48<00:39,  1.26it/s]Best trial: 43. Best value: 0.411872:  50%|█████     | 50/100 [00:48<00:39,  1.26it/s]Best trial: 43. Best value: 0.411872:  51%|█████     | 51/100 [00:48<00:37,  1.31it/s]Best trial: 43. Best value: 0.411872:  51%|█████     | 51/100 [00:49<00:37,  1.31it/s]Best trial: 43. Best value: 0.411872:  52%|█████▏    | 52/100 [00:49<00:34,  1.38it/s]Best trial: 43. Best value: 0.411872:  52%|█████▏    | 52/100 [00:50<00:34,  1.38it/s]Best trial: 43. Best value: 0.411872:  53%|█████▎    | 53/100 [00:50<00:33,  1.41it/s]Best trial: 43. Best value: 0.411872:  53%|█████▎    | 53/100 [00:50<00:33,  1.41it/s]Best trial: 43. Best value: 0.411872:  54%|█████▍    | 54/100 [00:50<00:31,  1.46it/s]Best trial: 43. Best value: 0.411872:  54%|█████▍    | 54/100 [00:51<00:31,  1.46it/s]Best trial: 43. Best value: 0.411872:  55%|█████▌    | 55/100 [00:51<00:30,  1.47it/s]Best trial: 43. Best value: 0.411872:  55%|█████▌    | 55/100 [00:52<00:30,  1.47it/s]Best trial: 43. Best value: 0.411872:  56%|█████▌    | 56/100 [00:52<00:32,  1.35it/s]Best trial: 43. Best value: 0.411872:  56%|█████▌    | 56/100 [00:52<00:32,  1.35it/s]Best trial: 43. Best value: 0.411872:  57%|█████▋    | 57/100 [00:52<00:30,  1.41it/s]Best trial: 43. Best value: 0.411872:  57%|█████▋    | 57/100 [00:54<00:30,  1.41it/s]Best trial: 43. Best value: 0.411872:  58%|█████▊    | 58/100 [00:54<00:39,  1.06it/s]Best trial: 43. Best value: 0.411872:  58%|█████▊    | 58/100 [00:55<00:39,  1.06it/s]Best trial: 43. Best value: 0.411872:  59%|█████▉    | 59/100 [00:55<00:35,  1.16it/s]Best trial: 43. Best value: 0.411872:  59%|█████▉    | 59/100 [00:55<00:35,  1.16it/s]Best trial: 43. Best value: 0.411872:  60%|██████    | 60/100 [00:55<00:34,  1.16it/s]Best trial: 43. Best value: 0.411872:  60%|██████    | 60/100 [00:56<00:34,  1.16it/s]Best trial: 43. Best value: 0.411872:  61%|██████    | 61/100 [00:56<00:31,  1.26it/s]Best trial: 43. Best value: 0.411872:  61%|██████    | 61/100 [00:57<00:31,  1.26it/s]Best trial: 43. Best value: 0.411872:  62%|██████▏   | 62/100 [00:57<00:28,  1.36it/s]Best trial: 43. Best value: 0.411872:  62%|██████▏   | 62/100 [00:57<00:28,  1.36it/s]Best trial: 43. Best value: 0.411872:  63%|██████▎   | 63/100 [00:57<00:26,  1.38it/s]Best trial: 43. Best value: 0.411872:  63%|██████▎   | 63/100 [00:58<00:26,  1.38it/s]Best trial: 43. Best value: 0.411872:  64%|██████▍   | 64/100 [00:58<00:27,  1.30it/s]Best trial: 43. Best value: 0.411872:  64%|██████▍   | 64/100 [00:59<00:27,  1.30it/s]Best trial: 43. Best value: 0.411872:  65%|██████▌   | 65/100 [00:59<00:26,  1.31it/s]Best trial: 43. Best value: 0.411872:  65%|██████▌   | 65/100 [01:00<00:26,  1.31it/s]Best trial: 43. Best value: 0.411872:  66%|██████▌   | 66/100 [01:00<00:23,  1.42it/s]Best trial: 43. Best value: 0.411872:  66%|██████▌   | 66/100 [01:00<00:23,  1.42it/s]Best trial: 43. Best value: 0.411872:  67%|██████▋   | 67/100 [01:00<00:23,  1.40it/s]Best trial: 43. Best value: 0.411872:  67%|██████▋   | 67/100 [01:02<00:23,  1.40it/s]Best trial: 43. Best value: 0.411872:  68%|██████▊   | 68/100 [01:02<00:30,  1.05it/s]Best trial: 43. Best value: 0.411872:  68%|██████▊   | 68/100 [01:02<00:30,  1.05it/s]Best trial: 43. Best value: 0.411872:  69%|██████▉   | 69/100 [01:02<00:27,  1.14it/s]Best trial: 43. Best value: 0.411872:  69%|██████▉   | 69/100 [01:04<00:27,  1.14it/s]Best trial: 43. Best value: 0.411872:  70%|███████   | 70/100 [01:04<00:27,  1.08it/s]Best trial: 43. Best value: 0.411872:  70%|███████   | 70/100 [01:04<00:27,  1.08it/s]Best trial: 43. Best value: 0.411872:  71%|███████   | 71/100 [01:04<00:26,  1.09it/s]Best trial: 43. Best value: 0.411872:  71%|███████   | 71/100 [01:05<00:26,  1.09it/s]Best trial: 43. Best value: 0.411872:  72%|███████▏  | 72/100 [01:05<00:22,  1.24it/s]Best trial: 43. Best value: 0.411872:  72%|███████▏  | 72/100 [01:05<00:22,  1.24it/s]Best trial: 43. Best value: 0.411872:  73%|███████▎  | 73/100 [01:05<00:19,  1.37it/s]Best trial: 43. Best value: 0.411872:  73%|███████▎  | 73/100 [01:06<00:19,  1.37it/s]Best trial: 43. Best value: 0.411872:  74%|███████▍  | 74/100 [01:06<00:18,  1.40it/s]Best trial: 43. Best value: 0.411872:  74%|███████▍  | 74/100 [01:07<00:18,  1.40it/s]Best trial: 43. Best value: 0.411872:  75%|███████▌  | 75/100 [01:07<00:16,  1.56it/s]Best trial: 43. Best value: 0.411872:  75%|███████▌  | 75/100 [01:07<00:16,  1.56it/s]Best trial: 43. Best value: 0.411872:  76%|███████▌  | 76/100 [01:07<00:15,  1.52it/s]Best trial: 76. Best value: 0.416361:  76%|███████▌  | 76/100 [01:08<00:15,  1.52it/s]Best trial: 76. Best value: 0.416361:  77%|███████▋  | 77/100 [01:08<00:16,  1.43it/s]Best trial: 76. Best value: 0.416361:  77%|███████▋  | 77/100 [01:09<00:16,  1.43it/s]Best trial: 76. Best value: 0.416361:  78%|███████▊  | 78/100 [01:09<00:17,  1.26it/s]Best trial: 76. Best value: 0.416361:  78%|███████▊  | 78/100 [01:10<00:17,  1.26it/s]Best trial: 76. Best value: 0.416361:  79%|███████▉  | 79/100 [01:10<00:15,  1.33it/s]Best trial: 76. Best value: 0.416361:  79%|███████▉  | 79/100 [01:10<00:15,  1.33it/s]Best trial: 76. Best value: 0.416361:  80%|████████  | 80/100 [01:10<00:13,  1.44it/s]Best trial: 76. Best value: 0.416361:  80%|████████  | 80/100 [01:11<00:13,  1.44it/s]Best trial: 76. Best value: 0.416361:  81%|████████  | 81/100 [01:11<00:11,  1.60it/s]Best trial: 76. Best value: 0.416361:  81%|████████  | 81/100 [01:11<00:11,  1.60it/s]Best trial: 76. Best value: 0.416361:  82%|████████▏ | 82/100 [01:11<00:11,  1.60it/s]Best trial: 76. Best value: 0.416361:  82%|████████▏ | 82/100 [01:12<00:11,  1.60it/s]Best trial: 76. Best value: 0.416361:  83%|████████▎ | 83/100 [01:12<00:10,  1.67it/s]Best trial: 76. Best value: 0.416361:  83%|████████▎ | 83/100 [01:13<00:10,  1.67it/s]Best trial: 76. Best value: 0.416361:  84%|████████▍ | 84/100 [01:13<00:09,  1.62it/s]Best trial: 76. Best value: 0.416361:  84%|████████▍ | 84/100 [01:13<00:09,  1.62it/s]Best trial: 76. Best value: 0.416361:  85%|████████▌ | 85/100 [01:13<00:09,  1.57it/s]Best trial: 76. Best value: 0.416361:  85%|████████▌ | 85/100 [01:14<00:09,  1.57it/s]Best trial: 76. Best value: 0.416361:  86%|████████▌ | 86/100 [01:14<00:08,  1.62it/s]Best trial: 76. Best value: 0.416361:  86%|████████▌ | 86/100 [01:15<00:08,  1.62it/s]Best trial: 76. Best value: 0.416361:  87%|████████▋ | 87/100 [01:15<00:08,  1.56it/s]Best trial: 76. Best value: 0.416361:  87%|████████▋ | 87/100 [01:15<00:08,  1.56it/s]Best trial: 76. Best value: 0.416361:  88%|████████▊ | 88/100 [01:15<00:07,  1.51it/s]Best trial: 76. Best value: 0.416361:  88%|████████▊ | 88/100 [01:16<00:07,  1.51it/s]Best trial: 76. Best value: 0.416361:  89%|████████▉ | 89/100 [01:16<00:07,  1.47it/s]Best trial: 76. Best value: 0.416361:  89%|████████▉ | 89/100 [01:17<00:07,  1.47it/s]Best trial: 76. Best value: 0.416361:  90%|█████████ | 90/100 [01:17<00:06,  1.61it/s]Best trial: 76. Best value: 0.416361:  90%|█████████ | 90/100 [01:17<00:06,  1.61it/s]Best trial: 76. Best value: 0.416361:  91%|█████████ | 91/100 [01:17<00:05,  1.56it/s]Best trial: 76. Best value: 0.416361:  91%|█████████ | 91/100 [01:18<00:05,  1.56it/s]Best trial: 76. Best value: 0.416361:  92%|█████████▏| 92/100 [01:18<00:05,  1.49it/s]Best trial: 76. Best value: 0.416361:  92%|█████████▏| 92/100 [01:19<00:05,  1.49it/s]Best trial: 76. Best value: 0.416361:  93%|█████████▎| 93/100 [01:19<00:04,  1.48it/s]Best trial: 76. Best value: 0.416361:  93%|█████████▎| 93/100 [01:19<00:04,  1.48it/s]Best trial: 76. Best value: 0.416361:  94%|█████████▍| 94/100 [01:19<00:03,  1.59it/s]Best trial: 76. Best value: 0.416361:  94%|█████████▍| 94/100 [01:20<00:03,  1.59it/s]Best trial: 76. Best value: 0.416361:  95%|█████████▌| 95/100 [01:20<00:03,  1.45it/s]Best trial: 76. Best value: 0.416361:  95%|█████████▌| 95/100 [01:21<00:03,  1.45it/s]Best trial: 76. Best value: 0.416361:  96%|█████████▌| 96/100 [01:21<00:03,  1.32it/s]Best trial: 76. Best value: 0.416361:  96%|█████████▌| 96/100 [01:22<00:03,  1.32it/s]Best trial: 76. Best value: 0.416361:  97%|█████████▋| 97/100 [01:22<00:02,  1.35it/s]Best trial: 76. Best value: 0.416361:  97%|█████████▋| 97/100 [01:22<00:02,  1.35it/s]Best trial: 76. Best value: 0.416361:  98%|█████████▊| 98/100 [01:22<00:01,  1.38it/s]Best trial: 76. Best value: 0.416361:  98%|█████████▊| 98/100 [01:23<00:01,  1.38it/s]Best trial: 76. Best value: 0.416361:  99%|█████████▉| 99/100 [01:23<00:00,  1.41it/s]Best trial: 76. Best value: 0.416361:  99%|█████████▉| 99/100 [01:24<00:00,  1.41it/s]Best trial: 76. Best value: 0.416361: 100%|██████████| 100/100 [01:24<00:00,  1.47it/s]Best trial: 76. Best value: 0.416361: 100%|██████████| 100/100 [01:24<00:00,  1.19it/s]
2025-11-30 17:12:49,985 - INFO - HPO Complete. Best AUPRC: 0.4164
2025-11-30 17:12:49,985 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.06824587714143679, 'max_depth': 3, 'subsample': 0.7848158098273299, 'colsample_bytree': 0.9780404188141684, 'gamma': 0.7682354263622357, 'reg_lambda': 0.0003315797953056859, 'reg_alpha': 1.0035408106867958e-08}
2025-11-30 17:12:49,985 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:12:51,931 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: pleth_only
2025-11-30 17:12:51,931 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:12:52,028 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:12:52,034 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:12:52,036 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:12:52,036 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:12:52,036 - INFO - Training model...
2025-11-30 17:12:52,665 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:12:57,360 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:12:57,360 - INFO - AUROC: 0.6725 (0.6015 - 0.7233)
2025-11-30 17:12:57,360 - INFO - AUPRC: 0.3839 (0.3041 - 0.4471)
2025-11-30 17:12:57,360 - INFO - Brier Score: 0.1902 (0.1721 - 0.2056)
2025-11-30 17:12:57,360 - INFO - Accuracy: 0.6676 (0.4841 - 0.7090)
2025-11-30 17:12:57,360 - INFO - Precision: 0.3626 (0.2616 - 0.4275)
2025-11-30 17:12:57,360 - INFO - Sensitivity (Recall): 0.6013 (0.5606 - 0.8079)
2025-11-30 17:12:57,360 - INFO - F1-Score: 0.4524 (0.3830 - 0.5128)
2025-11-30 17:12:57,360 - INFO - Best Threshold: 0.3800 (0.2380 - 0.3940)
2025-11-30 17:12:57,360 - INFO - Specificity: 0.6873 (0.4124 - 0.7351)
2025-11-30 17:12:57,372 - INFO - Calculating SHAP values...
2025-11-30 17:12:58,517 - INFO - SHAP plots saved.
2025-11-30 17:12:58,519 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:12:59,866 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 17:12:59,866 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:12:59,970 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:12:59,980 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:12:59,982 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:12:59,982 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.39034:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.39034:   1%|          | 1/100 [00:01<02:43,  1.65s/it]Best trial: 1. Best value: 0.39301:   1%|          | 1/100 [00:03<02:43,  1.65s/it]Best trial: 1. Best value: 0.39301:   2%|▏         | 2/100 [00:03<02:31,  1.55s/it]Best trial: 1. Best value: 0.39301:   2%|▏         | 2/100 [00:04<02:31,  1.55s/it]Best trial: 1. Best value: 0.39301:   3%|▎         | 3/100 [00:04<02:05,  1.30s/it]Best trial: 3. Best value: 0.397508:   3%|▎         | 3/100 [00:06<02:05,  1.30s/it]Best trial: 3. Best value: 0.397508:   4%|▍         | 4/100 [00:06<02:31,  1.57s/it]Best trial: 4. Best value: 0.410726:   4%|▍         | 4/100 [00:08<02:31,  1.57s/it]Best trial: 4. Best value: 0.410726:   5%|▌         | 5/100 [00:08<03:07,  1.98s/it]Best trial: 5. Best value: 0.4195:   5%|▌         | 5/100 [00:10<03:07,  1.98s/it]  Best trial: 5. Best value: 0.4195:   6%|▌         | 6/100 [00:10<03:06,  1.98s/it]Best trial: 5. Best value: 0.4195:   6%|▌         | 6/100 [00:12<03:06,  1.98s/it]Best trial: 5. Best value: 0.4195:   7%|▋         | 7/100 [00:12<02:51,  1.85s/it]Best trial: 5. Best value: 0.4195:   7%|▋         | 7/100 [00:13<02:51,  1.85s/it]Best trial: 5. Best value: 0.4195:   8%|▊         | 8/100 [00:13<02:31,  1.64s/it]Best trial: 5. Best value: 0.4195:   8%|▊         | 8/100 [00:15<02:31,  1.64s/it]Best trial: 5. Best value: 0.4195:   9%|▉         | 9/100 [00:15<02:34,  1.69s/it]Best trial: 9. Best value: 0.425504:   9%|▉         | 9/100 [00:16<02:34,  1.69s/it]Best trial: 9. Best value: 0.425504:  10%|█         | 10/100 [00:16<02:26,  1.63s/it]Best trial: 9. Best value: 0.425504:  10%|█         | 10/100 [00:17<02:26,  1.63s/it]Best trial: 9. Best value: 0.425504:  11%|█         | 11/100 [00:17<02:09,  1.46s/it]Best trial: 9. Best value: 0.425504:  11%|█         | 11/100 [00:20<02:09,  1.46s/it]Best trial: 9. Best value: 0.425504:  12%|█▏        | 12/100 [00:20<02:26,  1.66s/it]Best trial: 12. Best value: 0.426043:  12%|█▏        | 12/100 [00:22<02:26,  1.66s/it]Best trial: 12. Best value: 0.426043:  13%|█▎        | 13/100 [00:22<02:36,  1.80s/it]Best trial: 12. Best value: 0.426043:  13%|█▎        | 13/100 [00:24<02:36,  1.80s/it]Best trial: 12. Best value: 0.426043:  14%|█▍        | 14/100 [00:24<02:47,  1.95s/it]Best trial: 12. Best value: 0.426043:  14%|█▍        | 14/100 [00:26<02:47,  1.95s/it]Best trial: 12. Best value: 0.426043:  15%|█▌        | 15/100 [00:26<02:43,  1.92s/it]Best trial: 12. Best value: 0.426043:  15%|█▌        | 15/100 [00:27<02:43,  1.92s/it]Best trial: 12. Best value: 0.426043:  16%|█▌        | 16/100 [00:27<02:09,  1.54s/it]Best trial: 12. Best value: 0.426043:  16%|█▌        | 16/100 [00:28<02:09,  1.54s/it]Best trial: 12. Best value: 0.426043:  17%|█▋        | 17/100 [00:28<02:16,  1.64s/it]Best trial: 12. Best value: 0.426043:  17%|█▋        | 17/100 [00:30<02:16,  1.64s/it]Best trial: 12. Best value: 0.426043:  18%|█▊        | 18/100 [00:30<02:25,  1.78s/it]Best trial: 12. Best value: 0.426043:  18%|█▊        | 18/100 [00:32<02:25,  1.78s/it]Best trial: 12. Best value: 0.426043:  19%|█▉        | 19/100 [00:32<02:18,  1.71s/it]Best trial: 19. Best value: 0.42676:  19%|█▉        | 19/100 [00:34<02:18,  1.71s/it] Best trial: 19. Best value: 0.42676:  20%|██        | 20/100 [00:34<02:23,  1.80s/it]Best trial: 19. Best value: 0.42676:  20%|██        | 20/100 [00:36<02:23,  1.80s/it]Best trial: 19. Best value: 0.42676:  21%|██        | 21/100 [00:36<02:17,  1.74s/it]Best trial: 19. Best value: 0.42676:  21%|██        | 21/100 [00:37<02:17,  1.74s/it]Best trial: 19. Best value: 0.42676:  22%|██▏       | 22/100 [00:37<02:13,  1.71s/it]Best trial: 22. Best value: 0.431897:  22%|██▏       | 22/100 [00:39<02:13,  1.71s/it]Best trial: 22. Best value: 0.431897:  23%|██▎       | 23/100 [00:39<02:07,  1.65s/it]Best trial: 22. Best value: 0.431897:  23%|██▎       | 23/100 [00:40<02:07,  1.65s/it]Best trial: 22. Best value: 0.431897:  24%|██▍       | 24/100 [00:40<02:03,  1.63s/it]Best trial: 22. Best value: 0.431897:  24%|██▍       | 24/100 [00:42<02:03,  1.63s/it]Best trial: 22. Best value: 0.431897:  25%|██▌       | 25/100 [00:42<01:59,  1.59s/it]Best trial: 22. Best value: 0.431897:  25%|██▌       | 25/100 [00:43<01:59,  1.59s/it]Best trial: 22. Best value: 0.431897:  26%|██▌       | 26/100 [00:43<01:41,  1.36s/it]Best trial: 22. Best value: 0.431897:  26%|██▌       | 26/100 [00:44<01:41,  1.36s/it]Best trial: 22. Best value: 0.431897:  27%|██▋       | 27/100 [00:44<01:35,  1.31s/it]Best trial: 22. Best value: 0.431897:  27%|██▋       | 27/100 [00:45<01:35,  1.31s/it]Best trial: 22. Best value: 0.431897:  28%|██▊       | 28/100 [00:45<01:40,  1.40s/it]Best trial: 22. Best value: 0.431897:  28%|██▊       | 28/100 [00:48<01:40,  1.40s/it]Best trial: 22. Best value: 0.431897:  29%|██▉       | 29/100 [00:48<01:53,  1.59s/it]Best trial: 22. Best value: 0.431897:  29%|██▉       | 29/100 [00:48<01:53,  1.59s/it]Best trial: 22. Best value: 0.431897:  30%|███       | 30/100 [00:48<01:37,  1.40s/it]Best trial: 22. Best value: 0.431897:  30%|███       | 30/100 [00:50<01:37,  1.40s/it]Best trial: 22. Best value: 0.431897:  31%|███       | 31/100 [00:50<01:36,  1.40s/it]Best trial: 22. Best value: 0.431897:  31%|███       | 31/100 [00:51<01:36,  1.40s/it]Best trial: 22. Best value: 0.431897:  32%|███▏      | 32/100 [00:51<01:31,  1.35s/it]Best trial: 22. Best value: 0.431897:  32%|███▏      | 32/100 [00:53<01:31,  1.35s/it]Best trial: 22. Best value: 0.431897:  33%|███▎      | 33/100 [00:53<01:43,  1.54s/it]Best trial: 22. Best value: 0.431897:  33%|███▎      | 33/100 [00:55<01:43,  1.54s/it]Best trial: 22. Best value: 0.431897:  34%|███▍      | 34/100 [00:55<01:50,  1.68s/it]Best trial: 22. Best value: 0.431897:  34%|███▍      | 34/100 [00:56<01:50,  1.68s/it]Best trial: 22. Best value: 0.431897:  35%|███▌      | 35/100 [00:56<01:42,  1.58s/it]Best trial: 22. Best value: 0.431897:  35%|███▌      | 35/100 [00:58<01:42,  1.58s/it]Best trial: 22. Best value: 0.431897:  36%|███▌      | 36/100 [00:58<01:42,  1.60s/it]Best trial: 22. Best value: 0.431897:  36%|███▌      | 36/100 [01:00<01:42,  1.60s/it]Best trial: 22. Best value: 0.431897:  37%|███▋      | 37/100 [01:00<01:46,  1.70s/it]Best trial: 22. Best value: 0.431897:  37%|███▋      | 37/100 [01:02<01:46,  1.70s/it]Best trial: 22. Best value: 0.431897:  38%|███▊      | 38/100 [01:02<01:56,  1.87s/it]Best trial: 22. Best value: 0.431897:  38%|███▊      | 38/100 [01:05<01:56,  1.87s/it]Best trial: 22. Best value: 0.431897:  39%|███▉      | 39/100 [01:05<02:02,  2.01s/it]Best trial: 22. Best value: 0.431897:  39%|███▉      | 39/100 [01:05<02:02,  2.01s/it]Best trial: 22. Best value: 0.431897:  40%|████      | 40/100 [01:05<01:38,  1.64s/it]Best trial: 22. Best value: 0.431897:  40%|████      | 40/100 [01:07<01:38,  1.64s/it]Best trial: 22. Best value: 0.431897:  41%|████      | 41/100 [01:07<01:28,  1.50s/it]Best trial: 22. Best value: 0.431897:  41%|████      | 41/100 [01:08<01:28,  1.50s/it]Best trial: 22. Best value: 0.431897:  42%|████▏     | 42/100 [01:08<01:28,  1.53s/it]Best trial: 22. Best value: 0.431897:  42%|████▏     | 42/100 [01:10<01:28,  1.53s/it]Best trial: 22. Best value: 0.431897:  43%|████▎     | 43/100 [01:10<01:27,  1.53s/it]Best trial: 22. Best value: 0.431897:  43%|████▎     | 43/100 [01:11<01:27,  1.53s/it]Best trial: 22. Best value: 0.431897:  44%|████▍     | 44/100 [01:11<01:26,  1.55s/it]Best trial: 22. Best value: 0.431897:  44%|████▍     | 44/100 [01:13<01:26,  1.55s/it]Best trial: 22. Best value: 0.431897:  45%|████▌     | 45/100 [01:13<01:31,  1.66s/it]Best trial: 22. Best value: 0.431897:  45%|████▌     | 45/100 [01:15<01:31,  1.66s/it]Best trial: 22. Best value: 0.431897:  46%|████▌     | 46/100 [01:15<01:26,  1.60s/it]Best trial: 22. Best value: 0.431897:  46%|████▌     | 46/100 [01:16<01:26,  1.60s/it]Best trial: 22. Best value: 0.431897:  47%|████▋     | 47/100 [01:16<01:26,  1.64s/it]Best trial: 22. Best value: 0.431897:  47%|████▋     | 47/100 [01:18<01:26,  1.64s/it]Best trial: 22. Best value: 0.431897:  48%|████▊     | 48/100 [01:18<01:31,  1.75s/it]Best trial: 22. Best value: 0.431897:  48%|████▊     | 48/100 [01:20<01:31,  1.75s/it]Best trial: 22. Best value: 0.431897:  49%|████▉     | 49/100 [01:20<01:23,  1.64s/it]Best trial: 22. Best value: 0.431897:  49%|████▉     | 49/100 [01:21<01:23,  1.64s/it]Best trial: 22. Best value: 0.431897:  50%|█████     | 50/100 [01:21<01:13,  1.48s/it]Best trial: 22. Best value: 0.431897:  50%|█████     | 50/100 [01:23<01:13,  1.48s/it]Best trial: 22. Best value: 0.431897:  51%|█████     | 51/100 [01:23<01:20,  1.65s/it]Best trial: 22. Best value: 0.431897:  51%|█████     | 51/100 [01:24<01:20,  1.65s/it]Best trial: 22. Best value: 0.431897:  52%|█████▏    | 52/100 [01:24<01:14,  1.56s/it]Best trial: 22. Best value: 0.431897:  52%|█████▏    | 52/100 [01:25<01:14,  1.56s/it]Best trial: 22. Best value: 0.431897:  53%|█████▎    | 53/100 [01:25<01:08,  1.45s/it]Best trial: 22. Best value: 0.431897:  53%|█████▎    | 53/100 [01:27<01:08,  1.45s/it]Best trial: 22. Best value: 0.431897:  54%|█████▍    | 54/100 [01:27<01:03,  1.39s/it]Best trial: 22. Best value: 0.431897:  54%|█████▍    | 54/100 [01:28<01:03,  1.39s/it]Best trial: 22. Best value: 0.431897:  55%|█████▌    | 55/100 [01:28<01:05,  1.45s/it]Best trial: 22. Best value: 0.431897:  55%|█████▌    | 55/100 [01:30<01:05,  1.45s/it]Best trial: 22. Best value: 0.431897:  56%|█████▌    | 56/100 [01:30<01:04,  1.47s/it]Best trial: 22. Best value: 0.431897:  56%|█████▌    | 56/100 [01:31<01:04,  1.47s/it]Best trial: 22. Best value: 0.431897:  57%|█████▋    | 57/100 [01:31<01:03,  1.47s/it]Best trial: 22. Best value: 0.431897:  57%|█████▋    | 57/100 [01:33<01:03,  1.47s/it]Best trial: 22. Best value: 0.431897:  58%|█████▊    | 58/100 [01:33<01:01,  1.46s/it]Best trial: 22. Best value: 0.431897:  58%|█████▊    | 58/100 [01:35<01:01,  1.46s/it]Best trial: 22. Best value: 0.431897:  59%|█████▉    | 59/100 [01:35<01:06,  1.62s/it]Best trial: 22. Best value: 0.431897:  59%|█████▉    | 59/100 [01:37<01:06,  1.62s/it]Best trial: 22. Best value: 0.431897:  60%|██████    | 60/100 [01:37<01:10,  1.76s/it]Best trial: 22. Best value: 0.431897:  60%|██████    | 60/100 [01:38<01:10,  1.76s/it]Best trial: 22. Best value: 0.431897:  61%|██████    | 61/100 [01:38<01:04,  1.65s/it]Best trial: 22. Best value: 0.431897:  61%|██████    | 61/100 [01:40<01:04,  1.65s/it]Best trial: 22. Best value: 0.431897:  62%|██████▏   | 62/100 [01:40<01:06,  1.75s/it]Best trial: 62. Best value: 0.433282:  62%|██████▏   | 62/100 [01:42<01:06,  1.75s/it]Best trial: 62. Best value: 0.433282:  63%|██████▎   | 63/100 [01:42<01:01,  1.67s/it]Best trial: 62. Best value: 0.433282:  63%|██████▎   | 63/100 [01:43<01:01,  1.67s/it]Best trial: 62. Best value: 0.433282:  64%|██████▍   | 64/100 [01:43<00:58,  1.63s/it]Best trial: 62. Best value: 0.433282:  64%|██████▍   | 64/100 [01:45<00:58,  1.63s/it]Best trial: 62. Best value: 0.433282:  65%|██████▌   | 65/100 [01:45<00:53,  1.54s/it]Best trial: 62. Best value: 0.433282:  65%|██████▌   | 65/100 [01:46<00:53,  1.54s/it]Best trial: 62. Best value: 0.433282:  66%|██████▌   | 66/100 [01:46<00:51,  1.52s/it]Best trial: 62. Best value: 0.433282:  66%|██████▌   | 66/100 [01:48<00:51,  1.52s/it]Best trial: 62. Best value: 0.433282:  67%|██████▋   | 67/100 [01:48<00:58,  1.77s/it]Best trial: 62. Best value: 0.433282:  67%|██████▋   | 67/100 [01:51<00:58,  1.77s/it]Best trial: 62. Best value: 0.433282:  68%|██████▊   | 68/100 [01:51<01:02,  1.94s/it]Best trial: 62. Best value: 0.433282:  68%|██████▊   | 68/100 [01:52<01:02,  1.94s/it]Best trial: 62. Best value: 0.433282:  69%|██████▉   | 69/100 [01:52<00:58,  1.88s/it]Best trial: 62. Best value: 0.433282:  69%|██████▉   | 69/100 [01:54<00:58,  1.88s/it]Best trial: 62. Best value: 0.433282:  70%|███████   | 70/100 [01:54<00:51,  1.73s/it]Best trial: 62. Best value: 0.433282:  70%|███████   | 70/100 [01:55<00:51,  1.73s/it]Best trial: 62. Best value: 0.433282:  71%|███████   | 71/100 [01:55<00:48,  1.66s/it]Best trial: 62. Best value: 0.433282:  71%|███████   | 71/100 [01:57<00:48,  1.66s/it]Best trial: 62. Best value: 0.433282:  72%|███████▏  | 72/100 [01:57<00:49,  1.75s/it]Best trial: 62. Best value: 0.433282:  72%|███████▏  | 72/100 [01:59<00:49,  1.75s/it]Best trial: 62. Best value: 0.433282:  73%|███████▎  | 73/100 [01:59<00:46,  1.71s/it]Best trial: 62. Best value: 0.433282:  73%|███████▎  | 73/100 [02:00<00:46,  1.71s/it]Best trial: 62. Best value: 0.433282:  74%|███████▍  | 74/100 [02:00<00:43,  1.66s/it]Best trial: 62. Best value: 0.433282:  74%|███████▍  | 74/100 [02:02<00:43,  1.66s/it]Best trial: 62. Best value: 0.433282:  75%|███████▌  | 75/100 [02:02<00:42,  1.71s/it]Best trial: 62. Best value: 0.433282:  75%|███████▌  | 75/100 [02:04<00:42,  1.71s/it]Best trial: 62. Best value: 0.433282:  76%|███████▌  | 76/100 [02:04<00:39,  1.63s/it]Best trial: 62. Best value: 0.433282:  76%|███████▌  | 76/100 [02:06<00:39,  1.63s/it]Best trial: 62. Best value: 0.433282:  77%|███████▋  | 77/100 [02:06<00:40,  1.76s/it]Best trial: 62. Best value: 0.433282:  77%|███████▋  | 77/100 [02:08<00:40,  1.76s/it]Best trial: 62. Best value: 0.433282:  78%|███████▊  | 78/100 [02:08<00:38,  1.76s/it]Best trial: 62. Best value: 0.433282:  78%|███████▊  | 78/100 [02:09<00:38,  1.76s/it]Best trial: 62. Best value: 0.433282:  79%|███████▉  | 79/100 [02:09<00:36,  1.75s/it]Best trial: 62. Best value: 0.433282:  79%|███████▉  | 79/100 [02:11<00:36,  1.75s/it]Best trial: 62. Best value: 0.433282:  80%|████████  | 80/100 [02:11<00:33,  1.67s/it]Best trial: 62. Best value: 0.433282:  80%|████████  | 80/100 [02:13<00:33,  1.67s/it]Best trial: 62. Best value: 0.433282:  81%|████████  | 81/100 [02:13<00:35,  1.85s/it]Best trial: 62. Best value: 0.433282:  81%|████████  | 81/100 [02:15<00:35,  1.85s/it]Best trial: 62. Best value: 0.433282:  82%|████████▏ | 82/100 [02:15<00:32,  1.81s/it]Best trial: 62. Best value: 0.433282:  82%|████████▏ | 82/100 [02:16<00:32,  1.81s/it]Best trial: 62. Best value: 0.433282:  83%|████████▎ | 83/100 [02:16<00:30,  1.79s/it]Best trial: 62. Best value: 0.433282:  83%|████████▎ | 83/100 [02:18<00:30,  1.79s/it]Best trial: 62. Best value: 0.433282:  84%|████████▍ | 84/100 [02:18<00:28,  1.75s/it]Best trial: 62. Best value: 0.433282:  84%|████████▍ | 84/100 [02:19<00:28,  1.75s/it]Best trial: 62. Best value: 0.433282:  85%|████████▌ | 85/100 [02:19<00:23,  1.55s/it]Best trial: 62. Best value: 0.433282:  85%|████████▌ | 85/100 [02:21<00:23,  1.55s/it]Best trial: 62. Best value: 0.433282:  86%|████████▌ | 86/100 [02:21<00:23,  1.67s/it]Best trial: 62. Best value: 0.433282:  86%|████████▌ | 86/100 [02:23<00:23,  1.67s/it]Best trial: 62. Best value: 0.433282:  87%|████████▋ | 87/100 [02:23<00:20,  1.59s/it]Best trial: 62. Best value: 0.433282:  87%|████████▋ | 87/100 [02:24<00:20,  1.59s/it]Best trial: 62. Best value: 0.433282:  88%|████████▊ | 88/100 [02:24<00:17,  1.49s/it]Best trial: 62. Best value: 0.433282:  88%|████████▊ | 88/100 [02:26<00:17,  1.49s/it]Best trial: 62. Best value: 0.433282:  89%|████████▉ | 89/100 [02:26<00:17,  1.60s/it]Best trial: 62. Best value: 0.433282:  89%|████████▉ | 89/100 [02:28<00:17,  1.60s/it]Best trial: 62. Best value: 0.433282:  90%|█████████ | 90/100 [02:28<00:17,  1.78s/it]Best trial: 62. Best value: 0.433282:  90%|█████████ | 90/100 [02:30<00:17,  1.78s/it]Best trial: 62. Best value: 0.433282:  91%|█████████ | 91/100 [02:30<00:15,  1.76s/it]Best trial: 62. Best value: 0.433282:  91%|█████████ | 91/100 [02:31<00:15,  1.76s/it]Best trial: 62. Best value: 0.433282:  92%|█████████▏| 92/100 [02:31<00:14,  1.76s/it]Best trial: 62. Best value: 0.433282:  92%|█████████▏| 92/100 [02:33<00:14,  1.76s/it]Best trial: 62. Best value: 0.433282:  93%|█████████▎| 93/100 [02:33<00:12,  1.79s/it]Best trial: 62. Best value: 0.433282:  93%|█████████▎| 93/100 [02:35<00:12,  1.79s/it]Best trial: 62. Best value: 0.433282:  94%|█████████▍| 94/100 [02:35<00:09,  1.65s/it]Best trial: 62. Best value: 0.433282:  94%|█████████▍| 94/100 [02:36<00:09,  1.65s/it]Best trial: 62. Best value: 0.433282:  95%|█████████▌| 95/100 [02:36<00:08,  1.73s/it]Best trial: 62. Best value: 0.433282:  95%|█████████▌| 95/100 [02:38<00:08,  1.73s/it]Best trial: 62. Best value: 0.433282:  96%|█████████▌| 96/100 [02:38<00:06,  1.64s/it]Best trial: 62. Best value: 0.433282:  96%|█████████▌| 96/100 [02:40<00:06,  1.64s/it]Best trial: 62. Best value: 0.433282:  97%|█████████▋| 97/100 [02:40<00:05,  1.67s/it]Best trial: 62. Best value: 0.433282:  97%|█████████▋| 97/100 [02:42<00:05,  1.67s/it]Best trial: 62. Best value: 0.433282:  98%|█████████▊| 98/100 [02:42<00:03,  1.77s/it]Best trial: 62. Best value: 0.433282:  98%|█████████▊| 98/100 [02:43<00:03,  1.77s/it]Best trial: 62. Best value: 0.433282:  99%|█████████▉| 99/100 [02:43<00:01,  1.77s/it]Best trial: 62. Best value: 0.433282:  99%|█████████▉| 99/100 [02:46<00:01,  1.77s/it]Best trial: 62. Best value: 0.433282: 100%|██████████| 100/100 [02:46<00:00,  1.89s/it]Best trial: 62. Best value: 0.433282: 100%|██████████| 100/100 [02:46<00:00,  1.66s/it]
2025-11-30 17:15:46,056 - INFO - HPO Complete. Best AUPRC: 0.4333
2025-11-30 17:15:46,057 - INFO - Best Params: {'n_estimators': 100, 'learning_rate': 0.011870894486692103, 'max_depth': 6, 'subsample': 0.6327830770292866, 'colsample_bytree': 0.6850584752479056, 'gamma': 0.9879666867539307, 'reg_lambda': 0.0014516962482151409, 'reg_alpha': 2.2663284036824195e-05}
2025-11-30 17:15:46,057 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:15:48,088 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: ecg_only
2025-11-30 17:15:48,088 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:15:48,188 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:15:48,196 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:15:48,198 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:15:48,198 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:15:48,198 - INFO - Training model...
2025-11-30 17:15:48,571 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:15:53,201 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:15:53,201 - INFO - AUROC: 0.6435 (0.5948 - 0.7000)
2025-11-30 17:15:53,201 - INFO - AUPRC: 0.3615 (0.2992 - 0.4286)
2025-11-30 17:15:53,201 - INFO - Brier Score: 0.2156 (0.2094 - 0.2211)
2025-11-30 17:15:53,202 - INFO - Accuracy: 0.5231 (0.3569 - 0.7197)
2025-11-30 17:15:53,202 - INFO - Precision: 0.2861 (0.2453 - 0.3889)
2025-11-30 17:15:53,202 - INFO - Sensitivity (Recall): 0.7278 (0.4578 - 0.9601)
2025-11-30 17:15:53,202 - INFO - F1-Score: 0.4107 (0.3840 - 0.4701)
2025-11-30 17:15:53,202 - INFO - Best Threshold: 0.4200 (0.3500 - 0.4900)
2025-11-30 17:15:53,202 - INFO - Specificity: 0.4625 (0.1875 - 0.7812)
2025-11-30 17:15:53,209 - INFO - Calculating SHAP values...
2025-11-30 17:15:54,329 - INFO - SHAP plots saved.
2025-11-30 17:15:54,329 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:15:55,634 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: co2_only
2025-11-30 17:15:55,635 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:15:55,725 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:15:55,733 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:15:55,735 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:15:55,735 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.457793:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.457793:   1%|          | 1/100 [00:02<03:41,  2.24s/it]Best trial: 1. Best value: 0.46405:   1%|          | 1/100 [00:03<03:41,  2.24s/it] Best trial: 1. Best value: 0.46405:   2%|▏         | 2/100 [00:03<02:23,  1.46s/it]Best trial: 1. Best value: 0.46405:   2%|▏         | 2/100 [00:04<02:23,  1.46s/it]Best trial: 1. Best value: 0.46405:   3%|▎         | 3/100 [00:04<02:11,  1.36s/it]Best trial: 1. Best value: 0.46405:   3%|▎         | 3/100 [00:06<02:11,  1.36s/it]Best trial: 1. Best value: 0.46405:   4%|▍         | 4/100 [00:06<02:21,  1.48s/it]Best trial: 1. Best value: 0.46405:   4%|▍         | 4/100 [00:07<02:21,  1.48s/it]Best trial: 1. Best value: 0.46405:   5%|▌         | 5/100 [00:07<02:07,  1.34s/it]Best trial: 1. Best value: 0.46405:   5%|▌         | 5/100 [00:08<02:07,  1.34s/it]Best trial: 1. Best value: 0.46405:   6%|▌         | 6/100 [00:08<02:12,  1.40s/it]Best trial: 1. Best value: 0.46405:   6%|▌         | 6/100 [00:10<02:12,  1.40s/it]Best trial: 1. Best value: 0.46405:   7%|▋         | 7/100 [00:10<02:14,  1.45s/it]Best trial: 1. Best value: 0.46405:   7%|▋         | 7/100 [00:12<02:14,  1.45s/it]Best trial: 1. Best value: 0.46405:   8%|▊         | 8/100 [00:12<02:24,  1.57s/it]Best trial: 1. Best value: 0.46405:   8%|▊         | 8/100 [00:13<02:24,  1.57s/it]Best trial: 1. Best value: 0.46405:   9%|▉         | 9/100 [00:13<02:20,  1.54s/it]Best trial: 9. Best value: 0.465353:   9%|▉         | 9/100 [00:15<02:20,  1.54s/it]Best trial: 9. Best value: 0.465353:  10%|█         | 10/100 [00:15<02:28,  1.65s/it]Best trial: 9. Best value: 0.465353:  10%|█         | 10/100 [00:16<02:28,  1.65s/it]Best trial: 9. Best value: 0.465353:  11%|█         | 11/100 [00:16<02:21,  1.59s/it]Best trial: 9. Best value: 0.465353:  11%|█         | 11/100 [00:18<02:21,  1.59s/it]Best trial: 9. Best value: 0.465353:  12%|█▏        | 12/100 [00:18<02:16,  1.55s/it]Best trial: 9. Best value: 0.465353:  12%|█▏        | 12/100 [00:19<02:16,  1.55s/it]Best trial: 9. Best value: 0.465353:  13%|█▎        | 13/100 [00:19<02:05,  1.44s/it]Best trial: 9. Best value: 0.465353:  13%|█▎        | 13/100 [00:20<02:05,  1.44s/it]Best trial: 9. Best value: 0.465353:  14%|█▍        | 14/100 [00:20<01:55,  1.35s/it]Best trial: 9. Best value: 0.465353:  14%|█▍        | 14/100 [00:21<01:55,  1.35s/it]Best trial: 9. Best value: 0.465353:  15%|█▌        | 15/100 [00:21<01:54,  1.35s/it]Best trial: 9. Best value: 0.465353:  15%|█▌        | 15/100 [00:23<01:54,  1.35s/it]Best trial: 9. Best value: 0.465353:  16%|█▌        | 16/100 [00:23<01:51,  1.32s/it]Best trial: 9. Best value: 0.465353:  16%|█▌        | 16/100 [00:25<01:51,  1.32s/it]Best trial: 9. Best value: 0.465353:  17%|█▋        | 17/100 [00:25<02:07,  1.54s/it]Best trial: 9. Best value: 0.465353:  17%|█▋        | 17/100 [00:27<02:07,  1.54s/it]Best trial: 9. Best value: 0.465353:  18%|█▊        | 18/100 [00:27<02:25,  1.78s/it]Best trial: 9. Best value: 0.465353:  18%|█▊        | 18/100 [00:29<02:25,  1.78s/it]Best trial: 9. Best value: 0.465353:  19%|█▉        | 19/100 [00:29<02:33,  1.89s/it]Best trial: 9. Best value: 0.465353:  19%|█▉        | 19/100 [00:31<02:33,  1.89s/it]Best trial: 9. Best value: 0.465353:  20%|██        | 20/100 [00:31<02:24,  1.80s/it]Best trial: 9. Best value: 0.465353:  20%|██        | 20/100 [00:32<02:24,  1.80s/it]Best trial: 9. Best value: 0.465353:  21%|██        | 21/100 [00:32<02:09,  1.63s/it]Best trial: 9. Best value: 0.465353:  21%|██        | 21/100 [00:33<02:09,  1.63s/it]Best trial: 9. Best value: 0.465353:  22%|██▏       | 22/100 [00:33<01:58,  1.52s/it]Best trial: 9. Best value: 0.465353:  22%|██▏       | 22/100 [00:35<01:58,  1.52s/it]Best trial: 9. Best value: 0.465353:  23%|██▎       | 23/100 [00:35<01:51,  1.44s/it]Best trial: 9. Best value: 0.465353:  23%|██▎       | 23/100 [00:37<01:51,  1.44s/it]Best trial: 9. Best value: 0.465353:  24%|██▍       | 24/100 [00:37<02:12,  1.75s/it]Best trial: 9. Best value: 0.465353:  24%|██▍       | 24/100 [00:39<02:12,  1.75s/it]Best trial: 9. Best value: 0.465353:  25%|██▌       | 25/100 [00:39<02:14,  1.79s/it]Best trial: 9. Best value: 0.465353:  25%|██▌       | 25/100 [00:40<02:14,  1.79s/it]Best trial: 9. Best value: 0.465353:  26%|██▌       | 26/100 [00:40<01:57,  1.58s/it]Best trial: 9. Best value: 0.465353:  26%|██▌       | 26/100 [00:41<01:57,  1.58s/it]Best trial: 9. Best value: 0.465353:  27%|██▋       | 27/100 [00:41<01:43,  1.42s/it]Best trial: 9. Best value: 0.465353:  27%|██▋       | 27/100 [00:43<01:43,  1.42s/it]Best trial: 9. Best value: 0.465353:  28%|██▊       | 28/100 [00:43<01:42,  1.42s/it]Best trial: 9. Best value: 0.465353:  28%|██▊       | 28/100 [00:43<01:42,  1.42s/it]Best trial: 9. Best value: 0.465353:  29%|██▉       | 29/100 [00:43<01:27,  1.24s/it]Best trial: 9. Best value: 0.465353:  29%|██▉       | 29/100 [00:46<01:27,  1.24s/it]Best trial: 9. Best value: 0.465353:  30%|███       | 30/100 [00:46<01:47,  1.54s/it]Best trial: 30. Best value: 0.466716:  30%|███       | 30/100 [00:47<01:47,  1.54s/it]Best trial: 30. Best value: 0.466716:  31%|███       | 31/100 [00:47<01:40,  1.45s/it]Best trial: 30. Best value: 0.466716:  31%|███       | 31/100 [00:48<01:40,  1.45s/it]Best trial: 30. Best value: 0.466716:  32%|███▏      | 32/100 [00:48<01:32,  1.37s/it]Best trial: 30. Best value: 0.466716:  32%|███▏      | 32/100 [00:50<01:32,  1.37s/it]Best trial: 30. Best value: 0.466716:  33%|███▎      | 33/100 [00:50<01:47,  1.61s/it]Best trial: 30. Best value: 0.466716:  33%|███▎      | 33/100 [00:52<01:47,  1.61s/it]Best trial: 30. Best value: 0.466716:  34%|███▍      | 34/100 [00:52<01:52,  1.70s/it]Best trial: 30. Best value: 0.466716:  34%|███▍      | 34/100 [00:54<01:52,  1.70s/it]Best trial: 30. Best value: 0.466716:  35%|███▌      | 35/100 [00:54<02:01,  1.86s/it]Best trial: 30. Best value: 0.466716:  35%|███▌      | 35/100 [00:56<02:01,  1.86s/it]Best trial: 30. Best value: 0.466716:  36%|███▌      | 36/100 [00:56<01:49,  1.72s/it]Best trial: 30. Best value: 0.466716:  36%|███▌      | 36/100 [00:58<01:49,  1.72s/it]Best trial: 30. Best value: 0.466716:  37%|███▋      | 37/100 [00:58<01:49,  1.74s/it]Best trial: 37. Best value: 0.468336:  37%|███▋      | 37/100 [01:00<01:49,  1.74s/it]Best trial: 37. Best value: 0.468336:  38%|███▊      | 38/100 [01:00<02:02,  1.98s/it]Best trial: 37. Best value: 0.468336:  38%|███▊      | 38/100 [01:02<02:02,  1.98s/it]Best trial: 37. Best value: 0.468336:  39%|███▉      | 39/100 [01:02<01:54,  1.88s/it]Best trial: 37. Best value: 0.468336:  39%|███▉      | 39/100 [01:05<01:54,  1.88s/it]Best trial: 37. Best value: 0.468336:  40%|████      | 40/100 [01:05<02:15,  2.26s/it]Best trial: 37. Best value: 0.468336:  40%|████      | 40/100 [01:07<02:15,  2.26s/it]Best trial: 37. Best value: 0.468336:  41%|████      | 41/100 [01:07<02:13,  2.26s/it]Best trial: 41. Best value: 0.469705:  41%|████      | 41/100 [01:09<02:13,  2.26s/it]Best trial: 41. Best value: 0.469705:  42%|████▏     | 42/100 [01:09<01:59,  2.06s/it]Best trial: 41. Best value: 0.469705:  42%|████▏     | 42/100 [01:11<01:59,  2.06s/it]Best trial: 41. Best value: 0.469705:  43%|████▎     | 43/100 [01:11<02:00,  2.12s/it]Best trial: 41. Best value: 0.469705:  43%|████▎     | 43/100 [01:12<02:00,  2.12s/it]Best trial: 41. Best value: 0.469705:  44%|████▍     | 44/100 [01:12<01:46,  1.90s/it]Best trial: 41. Best value: 0.469705:  44%|████▍     | 44/100 [01:14<01:46,  1.90s/it]Best trial: 41. Best value: 0.469705:  45%|████▌     | 45/100 [01:14<01:32,  1.68s/it]Best trial: 41. Best value: 0.469705:  45%|████▌     | 45/100 [01:17<01:32,  1.68s/it]Best trial: 41. Best value: 0.469705:  46%|████▌     | 46/100 [01:17<01:54,  2.13s/it]Best trial: 41. Best value: 0.469705:  46%|████▌     | 46/100 [01:19<01:54,  2.13s/it]Best trial: 41. Best value: 0.469705:  47%|████▋     | 47/100 [01:19<01:53,  2.15s/it]Best trial: 41. Best value: 0.469705:  47%|████▋     | 47/100 [01:22<01:53,  2.15s/it]Best trial: 41. Best value: 0.469705:  48%|████▊     | 48/100 [01:22<02:01,  2.34s/it]Best trial: 41. Best value: 0.469705:  48%|████▊     | 48/100 [01:23<02:01,  2.34s/it]Best trial: 41. Best value: 0.469705:  49%|████▉     | 49/100 [01:23<01:50,  2.16s/it]Best trial: 41. Best value: 0.469705:  49%|████▉     | 49/100 [01:24<01:50,  2.16s/it]Best trial: 41. Best value: 0.469705:  50%|█████     | 50/100 [01:24<01:31,  1.82s/it]Best trial: 41. Best value: 0.469705:  50%|█████     | 50/100 [01:26<01:31,  1.82s/it]Best trial: 41. Best value: 0.469705:  51%|█████     | 51/100 [01:26<01:26,  1.76s/it]Best trial: 41. Best value: 0.469705:  51%|█████     | 51/100 [01:28<01:26,  1.76s/it]Best trial: 41. Best value: 0.469705:  52%|█████▏    | 52/100 [01:28<01:23,  1.75s/it]Best trial: 41. Best value: 0.469705:  52%|█████▏    | 52/100 [01:30<01:23,  1.75s/it]Best trial: 41. Best value: 0.469705:  53%|█████▎    | 53/100 [01:30<01:24,  1.81s/it]Best trial: 41. Best value: 0.469705:  53%|█████▎    | 53/100 [01:31<01:24,  1.81s/it]Best trial: 41. Best value: 0.469705:  54%|█████▍    | 54/100 [01:31<01:18,  1.71s/it]Best trial: 41. Best value: 0.469705:  54%|█████▍    | 54/100 [01:35<01:18,  1.71s/it]Best trial: 41. Best value: 0.469705:  55%|█████▌    | 55/100 [01:35<01:41,  2.27s/it]Best trial: 41. Best value: 0.469705:  55%|█████▌    | 55/100 [01:37<01:41,  2.27s/it]Best trial: 41. Best value: 0.469705:  56%|█████▌    | 56/100 [01:37<01:42,  2.32s/it]Best trial: 41. Best value: 0.469705:  56%|█████▌    | 56/100 [01:41<01:42,  2.32s/it]Best trial: 41. Best value: 0.469705:  57%|█████▋    | 57/100 [01:41<02:03,  2.87s/it]Best trial: 41. Best value: 0.469705:  57%|█████▋    | 57/100 [01:44<02:03,  2.87s/it]Best trial: 41. Best value: 0.469705:  58%|█████▊    | 58/100 [01:44<02:00,  2.87s/it]Best trial: 41. Best value: 0.469705:  58%|█████▊    | 58/100 [01:46<02:00,  2.87s/it]Best trial: 41. Best value: 0.469705:  59%|█████▉    | 59/100 [01:46<01:46,  2.61s/it]Best trial: 41. Best value: 0.469705:  59%|█████▉    | 59/100 [01:49<01:46,  2.61s/it]Best trial: 41. Best value: 0.469705:  60%|██████    | 60/100 [01:49<01:40,  2.51s/it]Best trial: 41. Best value: 0.469705:  60%|██████    | 60/100 [01:51<01:40,  2.51s/it]Best trial: 41. Best value: 0.469705:  61%|██████    | 61/100 [01:51<01:37,  2.50s/it]Best trial: 41. Best value: 0.469705:  61%|██████    | 61/100 [01:53<01:37,  2.50s/it]Best trial: 41. Best value: 0.469705:  62%|██████▏   | 62/100 [01:53<01:26,  2.28s/it]Best trial: 41. Best value: 0.469705:  62%|██████▏   | 62/100 [01:55<01:26,  2.28s/it]Best trial: 41. Best value: 0.469705:  63%|██████▎   | 63/100 [01:55<01:22,  2.24s/it]Best trial: 41. Best value: 0.469705:  63%|██████▎   | 63/100 [01:57<01:22,  2.24s/it]Best trial: 41. Best value: 0.469705:  64%|██████▍   | 64/100 [01:57<01:15,  2.11s/it]Best trial: 41. Best value: 0.469705:  64%|██████▍   | 64/100 [01:59<01:15,  2.11s/it]Best trial: 41. Best value: 0.469705:  65%|██████▌   | 65/100 [01:59<01:17,  2.21s/it]Best trial: 65. Best value: 0.469713:  65%|██████▌   | 65/100 [02:00<01:17,  2.21s/it]Best trial: 65. Best value: 0.469713:  66%|██████▌   | 66/100 [02:00<01:04,  1.90s/it]Best trial: 65. Best value: 0.469713:  66%|██████▌   | 66/100 [02:02<01:04,  1.90s/it]Best trial: 65. Best value: 0.469713:  67%|██████▋   | 67/100 [02:02<00:56,  1.73s/it]Best trial: 65. Best value: 0.469713:  67%|██████▋   | 67/100 [02:03<00:56,  1.73s/it]Best trial: 65. Best value: 0.469713:  68%|██████▊   | 68/100 [02:03<00:48,  1.53s/it]Best trial: 65. Best value: 0.469713:  68%|██████▊   | 68/100 [02:04<00:48,  1.53s/it]Best trial: 65. Best value: 0.469713:  69%|██████▉   | 69/100 [02:04<00:46,  1.49s/it]Best trial: 65. Best value: 0.469713:  69%|██████▉   | 69/100 [02:06<00:46,  1.49s/it]Best trial: 65. Best value: 0.469713:  70%|███████   | 70/100 [02:06<00:47,  1.60s/it]Best trial: 65. Best value: 0.469713:  70%|███████   | 70/100 [02:08<00:47,  1.60s/it]Best trial: 65. Best value: 0.469713:  71%|███████   | 71/100 [02:08<00:50,  1.73s/it]Best trial: 65. Best value: 0.469713:  71%|███████   | 71/100 [02:10<00:50,  1.73s/it]Best trial: 65. Best value: 0.469713:  72%|███████▏  | 72/100 [02:10<00:49,  1.75s/it]Best trial: 65. Best value: 0.469713:  72%|███████▏  | 72/100 [02:11<00:49,  1.75s/it]Best trial: 65. Best value: 0.469713:  73%|███████▎  | 73/100 [02:11<00:45,  1.69s/it]Best trial: 65. Best value: 0.469713:  73%|███████▎  | 73/100 [02:13<00:45,  1.69s/it]Best trial: 65. Best value: 0.469713:  74%|███████▍  | 74/100 [02:13<00:41,  1.59s/it]Best trial: 65. Best value: 0.469713:  74%|███████▍  | 74/100 [02:15<00:41,  1.59s/it]Best trial: 65. Best value: 0.469713:  75%|███████▌  | 75/100 [02:15<00:41,  1.68s/it]Best trial: 65. Best value: 0.469713:  75%|███████▌  | 75/100 [02:17<00:41,  1.68s/it]Best trial: 65. Best value: 0.469713:  76%|███████▌  | 76/100 [02:17<00:44,  1.84s/it]Best trial: 65. Best value: 0.469713:  76%|███████▌  | 76/100 [02:20<00:44,  1.84s/it]Best trial: 65. Best value: 0.469713:  77%|███████▋  | 77/100 [02:20<00:49,  2.13s/it]Best trial: 65. Best value: 0.469713:  77%|███████▋  | 77/100 [02:22<00:49,  2.13s/it]Best trial: 65. Best value: 0.469713:  78%|███████▊  | 78/100 [02:22<00:46,  2.10s/it]Best trial: 65. Best value: 0.469713:  78%|███████▊  | 78/100 [02:23<00:46,  2.10s/it]Best trial: 65. Best value: 0.469713:  79%|███████▉  | 79/100 [02:23<00:39,  1.89s/it]Best trial: 65. Best value: 0.469713:  79%|███████▉  | 79/100 [02:25<00:39,  1.89s/it]Best trial: 65. Best value: 0.469713:  80%|████████  | 80/100 [02:25<00:36,  1.82s/it]Best trial: 65. Best value: 0.469713:  80%|████████  | 80/100 [02:28<00:36,  1.82s/it]Best trial: 65. Best value: 0.469713:  81%|████████  | 81/100 [02:28<00:42,  2.22s/it]Best trial: 65. Best value: 0.469713:  81%|████████  | 81/100 [02:30<00:42,  2.22s/it]Best trial: 65. Best value: 0.469713:  82%|████████▏ | 82/100 [02:30<00:38,  2.15s/it]Best trial: 65. Best value: 0.469713:  82%|████████▏ | 82/100 [02:33<00:38,  2.15s/it]Best trial: 65. Best value: 0.469713:  83%|████████▎ | 83/100 [02:33<00:39,  2.33s/it]Best trial: 65. Best value: 0.469713:  83%|████████▎ | 83/100 [02:35<00:39,  2.33s/it]Best trial: 65. Best value: 0.469713:  84%|████████▍ | 84/100 [02:35<00:35,  2.21s/it]Best trial: 65. Best value: 0.469713:  84%|████████▍ | 84/100 [02:37<00:35,  2.21s/it]Best trial: 65. Best value: 0.469713:  85%|████████▌ | 85/100 [02:37<00:33,  2.25s/it]Best trial: 65. Best value: 0.469713:  85%|████████▌ | 85/100 [02:39<00:33,  2.25s/it]Best trial: 65. Best value: 0.469713:  86%|████████▌ | 86/100 [02:39<00:30,  2.19s/it]Best trial: 65. Best value: 0.469713:  86%|████████▌ | 86/100 [02:42<00:30,  2.19s/it]Best trial: 65. Best value: 0.469713:  87%|████████▋ | 87/100 [02:42<00:30,  2.35s/it]Best trial: 65. Best value: 0.469713:  87%|████████▋ | 87/100 [02:43<00:30,  2.35s/it]Best trial: 65. Best value: 0.469713:  88%|████████▊ | 88/100 [02:43<00:25,  2.16s/it]Best trial: 65. Best value: 0.469713:  88%|████████▊ | 88/100 [02:45<00:25,  2.16s/it]Best trial: 65. Best value: 0.469713:  89%|████████▉ | 89/100 [02:45<00:23,  2.14s/it]Best trial: 65. Best value: 0.469713:  89%|████████▉ | 89/100 [02:48<00:23,  2.14s/it]Best trial: 65. Best value: 0.469713:  90%|█████████ | 90/100 [02:48<00:21,  2.11s/it]Best trial: 65. Best value: 0.469713:  90%|█████████ | 90/100 [02:49<00:21,  2.11s/it]Best trial: 65. Best value: 0.469713:  91%|█████████ | 91/100 [02:49<00:16,  1.89s/it]Best trial: 65. Best value: 0.469713:  91%|█████████ | 91/100 [02:50<00:16,  1.89s/it]Best trial: 65. Best value: 0.469713:  92%|█████████▏| 92/100 [02:50<00:13,  1.64s/it]Best trial: 65. Best value: 0.469713:  92%|█████████▏| 92/100 [02:51<00:13,  1.64s/it]Best trial: 65. Best value: 0.469713:  93%|█████████▎| 93/100 [02:51<00:11,  1.58s/it]Best trial: 65. Best value: 0.469713:  93%|█████████▎| 93/100 [02:53<00:11,  1.58s/it]Best trial: 65. Best value: 0.469713:  94%|█████████▍| 94/100 [02:53<00:08,  1.49s/it]Best trial: 65. Best value: 0.469713:  94%|█████████▍| 94/100 [02:54<00:08,  1.49s/it]Best trial: 65. Best value: 0.469713:  95%|█████████▌| 95/100 [02:54<00:07,  1.55s/it]Best trial: 65. Best value: 0.469713:  95%|█████████▌| 95/100 [02:55<00:07,  1.55s/it]Best trial: 65. Best value: 0.469713:  96%|█████████▌| 96/100 [02:55<00:05,  1.42s/it]Best trial: 65. Best value: 0.469713:  96%|█████████▌| 96/100 [02:57<00:05,  1.42s/it]Best trial: 65. Best value: 0.469713:  97%|█████████▋| 97/100 [02:57<00:03,  1.31s/it]Best trial: 65. Best value: 0.469713:  97%|█████████▋| 97/100 [02:58<00:03,  1.31s/it]Best trial: 65. Best value: 0.469713:  98%|█████████▊| 98/100 [02:58<00:02,  1.26s/it]Best trial: 65. Best value: 0.469713:  98%|█████████▊| 98/100 [02:59<00:02,  1.26s/it]Best trial: 65. Best value: 0.469713:  99%|█████████▉| 99/100 [02:59<00:01,  1.31s/it]Best trial: 65. Best value: 0.469713:  99%|█████████▉| 99/100 [03:00<00:01,  1.31s/it]Best trial: 65. Best value: 0.469713: 100%|██████████| 100/100 [03:00<00:00,  1.21s/it]Best trial: 65. Best value: 0.469713: 100%|██████████| 100/100 [03:00<00:00,  1.81s/it]
2025-11-30 17:18:56,324 - INFO - HPO Complete. Best AUPRC: 0.4697
2025-11-30 17:18:56,324 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.02620921825797714, 'max_depth': 6, 'subsample': 0.8209385215320598, 'colsample_bytree': 0.9717536521731529, 'gamma': 0.745769390111769, 'reg_lambda': 3.021145808574328e-06, 'reg_alpha': 0.0004715637759473253}
2025-11-30 17:18:56,324 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:18:58,158 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: co2_only
2025-11-30 17:18:58,159 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:18:58,244 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:18:58,250 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:18:58,252 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:18:58,252 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:18:58,252 - INFO - Training model...
2025-11-30 17:18:59,224 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:19:04,010 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:19:04,011 - INFO - AUROC: 0.6580 (0.6109 - 0.7020)
2025-11-30 17:19:04,011 - INFO - AUPRC: 0.3464 (0.2936 - 0.4156)
2025-11-30 17:19:04,011 - INFO - Brier Score: 0.1861 (0.1756 - 0.2019)
2025-11-30 17:19:04,011 - INFO - Accuracy: 0.6647 (0.4740 - 0.6858)
2025-11-30 17:19:04,011 - INFO - Precision: 0.3566 (0.2824 - 0.3956)
2025-11-30 17:19:04,011 - INFO - Sensitivity (Recall): 0.5823 (0.5225 - 0.8781)
2025-11-30 17:19:04,011 - INFO - F1-Score: 0.4423 (0.3920 - 0.4914)
2025-11-30 17:19:04,011 - INFO - Best Threshold: 0.3300 (0.1280 - 0.3500)
2025-11-30 17:19:04,011 - INFO - Specificity: 0.6891 (0.3558 - 0.7196)
2025-11-30 17:19:04,034 - INFO - Calculating SHAP values...
2025-11-30 17:19:05,267 - INFO - SHAP plots saved.
2025-11-30 17:19:05,269 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:19:06,437 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: awp_only
2025-11-30 17:19:06,438 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:19:06,521 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:19:06,529 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:19:06,531 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:19:06,531 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.469549:   0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.469549:   1%|          | 1/100 [00:00<01:38,  1.01it/s]Best trial: 1. Best value: 0.476114:   1%|          | 1/100 [00:02<01:38,  1.01it/s]Best trial: 1. Best value: 0.476114:   2%|▏         | 2/100 [00:02<02:27,  1.50s/it]Best trial: 1. Best value: 0.476114:   2%|▏         | 2/100 [00:05<02:27,  1.50s/it]Best trial: 1. Best value: 0.476114:   3%|▎         | 3/100 [00:05<03:01,  1.87s/it]Best trial: 1. Best value: 0.476114:   3%|▎         | 3/100 [00:09<03:01,  1.87s/it]Best trial: 1. Best value: 0.476114:   4%|▍         | 4/100 [00:09<04:34,  2.86s/it]Best trial: 4. Best value: 0.484841:   4%|▍         | 4/100 [00:11<04:34,  2.86s/it]Best trial: 4. Best value: 0.484841:   5%|▌         | 5/100 [00:11<03:50,  2.43s/it]Best trial: 4. Best value: 0.484841:   5%|▌         | 5/100 [00:12<03:50,  2.43s/it]Best trial: 4. Best value: 0.484841:   6%|▌         | 6/100 [00:12<03:18,  2.11s/it]Best trial: 4. Best value: 0.484841:   6%|▌         | 6/100 [00:16<03:18,  2.11s/it]Best trial: 4. Best value: 0.484841:   7%|▋         | 7/100 [00:16<04:18,  2.78s/it]Best trial: 4. Best value: 0.484841:   7%|▋         | 7/100 [00:17<04:18,  2.78s/it]Best trial: 4. Best value: 0.484841:   8%|▊         | 8/100 [00:17<03:17,  2.15s/it]Best trial: 4. Best value: 0.484841:   8%|▊         | 8/100 [00:19<03:17,  2.15s/it]Best trial: 4. Best value: 0.484841:   9%|▉         | 9/100 [00:19<02:59,  1.97s/it]Best trial: 4. Best value: 0.484841:   9%|▉         | 9/100 [00:20<02:59,  1.97s/it]Best trial: 4. Best value: 0.484841:  10%|█         | 10/100 [00:20<02:33,  1.71s/it]Best trial: 4. Best value: 0.484841:  10%|█         | 10/100 [00:21<02:33,  1.71s/it]Best trial: 4. Best value: 0.484841:  11%|█         | 11/100 [00:21<02:27,  1.65s/it]Best trial: 4. Best value: 0.484841:  11%|█         | 11/100 [00:23<02:27,  1.65s/it]Best trial: 4. Best value: 0.484841:  12%|█▏        | 12/100 [00:23<02:19,  1.58s/it]Best trial: 4. Best value: 0.484841:  12%|█▏        | 12/100 [00:24<02:19,  1.58s/it]Best trial: 4. Best value: 0.484841:  13%|█▎        | 13/100 [00:24<02:19,  1.61s/it]Best trial: 4. Best value: 0.484841:  13%|█▎        | 13/100 [00:27<02:19,  1.61s/it]Best trial: 4. Best value: 0.484841:  14%|█▍        | 14/100 [00:27<02:36,  1.82s/it]Best trial: 4. Best value: 0.484841:  14%|█▍        | 14/100 [00:29<02:36,  1.82s/it]Best trial: 4. Best value: 0.484841:  15%|█▌        | 15/100 [00:29<02:37,  1.86s/it]Best trial: 15. Best value: 0.487194:  15%|█▌        | 15/100 [00:31<02:37,  1.86s/it]Best trial: 15. Best value: 0.487194:  16%|█▌        | 16/100 [00:31<02:47,  2.00s/it]Best trial: 15. Best value: 0.487194:  16%|█▌        | 16/100 [00:33<02:47,  2.00s/it]Best trial: 15. Best value: 0.487194:  17%|█▋        | 17/100 [00:33<02:41,  1.95s/it]Best trial: 15. Best value: 0.487194:  17%|█▋        | 17/100 [00:35<02:41,  1.95s/it]Best trial: 15. Best value: 0.487194:  18%|█▊        | 18/100 [00:35<02:39,  1.95s/it]Best trial: 15. Best value: 0.487194:  18%|█▊        | 18/100 [00:38<02:39,  1.95s/it]Best trial: 15. Best value: 0.487194:  19%|█▉        | 19/100 [00:38<03:12,  2.37s/it]Best trial: 15. Best value: 0.487194:  19%|█▉        | 19/100 [00:40<03:12,  2.37s/it]Best trial: 15. Best value: 0.487194:  20%|██        | 20/100 [00:40<03:02,  2.29s/it]Best trial: 15. Best value: 0.487194:  20%|██        | 20/100 [00:42<03:02,  2.29s/it]Best trial: 15. Best value: 0.487194:  21%|██        | 21/100 [00:42<02:50,  2.15s/it]Best trial: 15. Best value: 0.487194:  21%|██        | 21/100 [00:44<02:50,  2.15s/it]Best trial: 15. Best value: 0.487194:  22%|██▏       | 22/100 [00:44<02:31,  1.95s/it]Best trial: 15. Best value: 0.487194:  22%|██▏       | 22/100 [00:45<02:31,  1.95s/it]Best trial: 15. Best value: 0.487194:  23%|██▎       | 23/100 [00:45<02:10,  1.70s/it]Best trial: 15. Best value: 0.487194:  23%|██▎       | 23/100 [00:46<02:10,  1.70s/it]Best trial: 15. Best value: 0.487194:  24%|██▍       | 24/100 [00:46<02:01,  1.60s/it]Best trial: 15. Best value: 0.487194:  24%|██▍       | 24/100 [00:47<02:01,  1.60s/it]Best trial: 15. Best value: 0.487194:  25%|██▌       | 25/100 [00:47<01:53,  1.52s/it]Best trial: 15. Best value: 0.487194:  25%|██▌       | 25/100 [00:49<01:53,  1.52s/it]Best trial: 15. Best value: 0.487194:  26%|██▌       | 26/100 [00:49<01:54,  1.55s/it]Best trial: 15. Best value: 0.487194:  26%|██▌       | 26/100 [00:50<01:54,  1.55s/it]Best trial: 15. Best value: 0.487194:  27%|██▋       | 27/100 [00:50<01:50,  1.52s/it]Best trial: 15. Best value: 0.487194:  27%|██▋       | 27/100 [00:52<01:50,  1.52s/it]Best trial: 15. Best value: 0.487194:  28%|██▊       | 28/100 [00:52<01:51,  1.55s/it]Best trial: 28. Best value: 0.489283:  28%|██▊       | 28/100 [00:54<01:51,  1.55s/it]Best trial: 28. Best value: 0.489283:  29%|██▉       | 29/100 [00:54<02:02,  1.72s/it]Best trial: 28. Best value: 0.489283:  29%|██▉       | 29/100 [00:56<02:02,  1.72s/it]Best trial: 28. Best value: 0.489283:  30%|███       | 30/100 [00:56<02:08,  1.83s/it]Best trial: 28. Best value: 0.489283:  30%|███       | 30/100 [00:58<02:08,  1.83s/it]Best trial: 28. Best value: 0.489283:  31%|███       | 31/100 [00:58<02:07,  1.84s/it]Best trial: 31. Best value: 0.489394:  31%|███       | 31/100 [01:00<02:07,  1.84s/it]Best trial: 31. Best value: 0.489394:  32%|███▏      | 32/100 [01:00<01:57,  1.73s/it]Best trial: 31. Best value: 0.489394:  32%|███▏      | 32/100 [01:01<01:57,  1.73s/it]Best trial: 31. Best value: 0.489394:  33%|███▎      | 33/100 [01:01<01:55,  1.73s/it]Best trial: 31. Best value: 0.489394:  33%|███▎      | 33/100 [01:03<01:55,  1.73s/it]Best trial: 31. Best value: 0.489394:  34%|███▍      | 34/100 [01:03<01:48,  1.64s/it]Best trial: 31. Best value: 0.489394:  34%|███▍      | 34/100 [01:05<01:48,  1.64s/it]Best trial: 31. Best value: 0.489394:  35%|███▌      | 35/100 [01:05<01:49,  1.68s/it]Best trial: 31. Best value: 0.489394:  35%|███▌      | 35/100 [01:05<01:49,  1.68s/it]Best trial: 31. Best value: 0.489394:  36%|███▌      | 36/100 [01:05<01:32,  1.45s/it]Best trial: 31. Best value: 0.489394:  36%|███▌      | 36/100 [01:07<01:32,  1.45s/it]Best trial: 31. Best value: 0.489394:  37%|███▋      | 37/100 [01:07<01:26,  1.37s/it]Best trial: 31. Best value: 0.489394:  37%|███▋      | 37/100 [01:08<01:26,  1.37s/it]Best trial: 31. Best value: 0.489394:  38%|███▊      | 38/100 [01:08<01:18,  1.27s/it]Best trial: 31. Best value: 0.489394:  38%|███▊      | 38/100 [01:09<01:18,  1.27s/it]Best trial: 31. Best value: 0.489394:  39%|███▉      | 39/100 [01:09<01:08,  1.13s/it]Best trial: 31. Best value: 0.489394:  39%|███▉      | 39/100 [01:11<01:08,  1.13s/it]Best trial: 31. Best value: 0.489394:  40%|████      | 40/100 [01:11<01:23,  1.40s/it]Best trial: 31. Best value: 0.489394:  40%|████      | 40/100 [01:11<01:23,  1.40s/it]Best trial: 31. Best value: 0.489394:  41%|████      | 41/100 [01:11<01:12,  1.22s/it]Best trial: 31. Best value: 0.489394:  41%|████      | 41/100 [01:12<01:12,  1.22s/it]Best trial: 31. Best value: 0.489394:  42%|████▏     | 42/100 [01:12<01:05,  1.14s/it]Best trial: 31. Best value: 0.489394:  42%|████▏     | 42/100 [01:14<01:05,  1.14s/it]Best trial: 31. Best value: 0.489394:  43%|████▎     | 43/100 [01:14<01:07,  1.18s/it]Best trial: 31. Best value: 0.489394:  43%|████▎     | 43/100 [01:15<01:07,  1.18s/it]Best trial: 31. Best value: 0.489394:  44%|████▍     | 44/100 [01:15<01:17,  1.39s/it]Best trial: 31. Best value: 0.489394:  44%|████▍     | 44/100 [01:18<01:17,  1.39s/it]Best trial: 31. Best value: 0.489394:  45%|████▌     | 45/100 [01:18<01:31,  1.67s/it]Best trial: 31. Best value: 0.489394:  45%|████▌     | 45/100 [01:20<01:31,  1.67s/it]Best trial: 31. Best value: 0.489394:  46%|████▌     | 46/100 [01:20<01:33,  1.74s/it]Best trial: 31. Best value: 0.489394:  46%|████▌     | 46/100 [01:20<01:33,  1.74s/it]Best trial: 31. Best value: 0.489394:  47%|████▋     | 47/100 [01:20<01:17,  1.47s/it]Best trial: 31. Best value: 0.489394:  47%|████▋     | 47/100 [01:22<01:17,  1.47s/it]Best trial: 31. Best value: 0.489394:  48%|████▊     | 48/100 [01:22<01:24,  1.63s/it]Best trial: 31. Best value: 0.489394:  48%|████▊     | 48/100 [01:23<01:24,  1.63s/it]Best trial: 31. Best value: 0.489394:  49%|████▉     | 49/100 [01:23<01:12,  1.42s/it]Best trial: 31. Best value: 0.489394:  49%|████▉     | 49/100 [01:25<01:12,  1.42s/it]Best trial: 31. Best value: 0.489394:  50%|█████     | 50/100 [01:25<01:11,  1.44s/it]Best trial: 31. Best value: 0.489394:  50%|█████     | 50/100 [01:26<01:11,  1.44s/it]Best trial: 31. Best value: 0.489394:  51%|█████     | 51/100 [01:26<01:11,  1.47s/it]Best trial: 31. Best value: 0.489394:  51%|█████     | 51/100 [01:28<01:11,  1.47s/it]Best trial: 31. Best value: 0.489394:  52%|█████▏    | 52/100 [01:28<01:06,  1.38s/it]Best trial: 31. Best value: 0.489394:  52%|█████▏    | 52/100 [01:29<01:06,  1.38s/it]Best trial: 31. Best value: 0.489394:  53%|█████▎    | 53/100 [01:29<01:09,  1.49s/it]Best trial: 31. Best value: 0.489394:  53%|█████▎    | 53/100 [01:31<01:09,  1.49s/it]Best trial: 31. Best value: 0.489394:  54%|█████▍    | 54/100 [01:31<01:14,  1.61s/it]Best trial: 31. Best value: 0.489394:  54%|█████▍    | 54/100 [01:34<01:14,  1.61s/it]Best trial: 31. Best value: 0.489394:  55%|█████▌    | 55/100 [01:34<01:22,  1.82s/it]Best trial: 31. Best value: 0.489394:  55%|█████▌    | 55/100 [01:34<01:22,  1.82s/it]Best trial: 31. Best value: 0.489394:  56%|█████▌    | 56/100 [01:34<01:05,  1.49s/it]Best trial: 31. Best value: 0.489394:  56%|█████▌    | 56/100 [01:36<01:05,  1.49s/it]Best trial: 31. Best value: 0.489394:  57%|█████▋    | 57/100 [01:36<01:01,  1.42s/it]Best trial: 57. Best value: 0.490268:  57%|█████▋    | 57/100 [01:36<01:01,  1.42s/it]Best trial: 57. Best value: 0.490268:  58%|█████▊    | 58/100 [01:36<00:52,  1.25s/it]Best trial: 57. Best value: 0.490268:  58%|█████▊    | 58/100 [01:38<00:52,  1.25s/it]Best trial: 57. Best value: 0.490268:  59%|█████▉    | 59/100 [01:38<00:58,  1.44s/it]Best trial: 57. Best value: 0.490268:  59%|█████▉    | 59/100 [01:39<00:58,  1.44s/it]Best trial: 57. Best value: 0.490268:  60%|██████    | 60/100 [01:39<00:54,  1.37s/it]Best trial: 57. Best value: 0.490268:  60%|██████    | 60/100 [01:43<00:54,  1.37s/it]Best trial: 57. Best value: 0.490268:  61%|██████    | 61/100 [01:43<01:14,  1.90s/it]Best trial: 57. Best value: 0.490268:  61%|██████    | 61/100 [01:44<01:14,  1.90s/it]Best trial: 57. Best value: 0.490268:  62%|██████▏   | 62/100 [01:44<01:04,  1.71s/it]Best trial: 62. Best value: 0.492107:  62%|██████▏   | 62/100 [01:45<01:04,  1.71s/it]Best trial: 62. Best value: 0.492107:  63%|██████▎   | 63/100 [01:45<00:55,  1.51s/it]Best trial: 62. Best value: 0.492107:  63%|██████▎   | 63/100 [01:46<00:55,  1.51s/it]Best trial: 62. Best value: 0.492107:  64%|██████▍   | 64/100 [01:46<00:47,  1.32s/it]Best trial: 62. Best value: 0.492107:  64%|██████▍   | 64/100 [01:47<00:47,  1.32s/it]Best trial: 62. Best value: 0.492107:  65%|██████▌   | 65/100 [01:47<00:42,  1.23s/it]Best trial: 62. Best value: 0.492107:  65%|██████▌   | 65/100 [01:49<00:42,  1.23s/it]Best trial: 62. Best value: 0.492107:  66%|██████▌   | 66/100 [01:49<00:51,  1.51s/it]Best trial: 62. Best value: 0.492107:  66%|██████▌   | 66/100 [01:50<00:51,  1.51s/it]Best trial: 62. Best value: 0.492107:  67%|██████▋   | 67/100 [01:50<00:48,  1.48s/it]Best trial: 62. Best value: 0.492107:  67%|██████▋   | 67/100 [01:52<00:48,  1.48s/it]Best trial: 62. Best value: 0.492107:  68%|██████▊   | 68/100 [01:52<00:49,  1.56s/it]Best trial: 62. Best value: 0.492107:  68%|██████▊   | 68/100 [01:55<00:49,  1.56s/it]Best trial: 62. Best value: 0.492107:  69%|██████▉   | 69/100 [01:55<00:59,  1.93s/it]Best trial: 62. Best value: 0.492107:  69%|██████▉   | 69/100 [01:56<00:59,  1.93s/it]Best trial: 62. Best value: 0.492107:  70%|███████   | 70/100 [01:56<00:53,  1.77s/it]Best trial: 62. Best value: 0.492107:  70%|███████   | 70/100 [01:58<00:53,  1.77s/it]Best trial: 62. Best value: 0.492107:  71%|███████   | 71/100 [01:58<00:51,  1.76s/it]Best trial: 62. Best value: 0.492107:  71%|███████   | 71/100 [02:00<00:51,  1.76s/it]Best trial: 62. Best value: 0.492107:  72%|███████▏  | 72/100 [02:00<00:52,  1.86s/it]Best trial: 62. Best value: 0.492107:  72%|███████▏  | 72/100 [02:02<00:52,  1.86s/it]Best trial: 62. Best value: 0.492107:  73%|███████▎  | 73/100 [02:02<00:50,  1.87s/it]Best trial: 62. Best value: 0.492107:  73%|███████▎  | 73/100 [02:04<00:50,  1.87s/it]Best trial: 62. Best value: 0.492107:  74%|███████▍  | 74/100 [02:04<00:45,  1.75s/it]Best trial: 62. Best value: 0.492107:  74%|███████▍  | 74/100 [02:05<00:45,  1.75s/it]Best trial: 62. Best value: 0.492107:  75%|███████▌  | 75/100 [02:05<00:44,  1.77s/it]Best trial: 62. Best value: 0.492107:  75%|███████▌  | 75/100 [02:06<00:44,  1.77s/it]Best trial: 62. Best value: 0.492107:  76%|███████▌  | 76/100 [02:06<00:37,  1.58s/it]Best trial: 62. Best value: 0.492107:  76%|███████▌  | 76/100 [02:08<00:37,  1.58s/it]Best trial: 62. Best value: 0.492107:  77%|███████▋  | 77/100 [02:08<00:37,  1.62s/it]Best trial: 62. Best value: 0.492107:  77%|███████▋  | 77/100 [02:09<00:37,  1.62s/it]Best trial: 62. Best value: 0.492107:  78%|███████▊  | 78/100 [02:09<00:32,  1.46s/it]Best trial: 62. Best value: 0.492107:  78%|███████▊  | 78/100 [02:11<00:32,  1.46s/it]Best trial: 62. Best value: 0.492107:  79%|███████▉  | 79/100 [02:11<00:32,  1.55s/it]Best trial: 62. Best value: 0.492107:  79%|███████▉  | 79/100 [02:12<00:32,  1.55s/it]Best trial: 62. Best value: 0.492107:  80%|████████  | 80/100 [02:12<00:26,  1.35s/it]Best trial: 62. Best value: 0.492107:  80%|████████  | 80/100 [02:13<00:26,  1.35s/it]Best trial: 62. Best value: 0.492107:  81%|████████  | 81/100 [02:13<00:24,  1.31s/it]Best trial: 62. Best value: 0.492107:  81%|████████  | 81/100 [02:14<00:24,  1.31s/it]Best trial: 62. Best value: 0.492107:  82%|████████▏ | 82/100 [02:14<00:23,  1.30s/it]Best trial: 62. Best value: 0.492107:  82%|████████▏ | 82/100 [02:16<00:23,  1.30s/it]Best trial: 62. Best value: 0.492107:  83%|████████▎ | 83/100 [02:16<00:22,  1.33s/it]Best trial: 62. Best value: 0.492107:  83%|████████▎ | 83/100 [02:17<00:22,  1.33s/it]Best trial: 62. Best value: 0.492107:  84%|████████▍ | 84/100 [02:17<00:20,  1.30s/it]Best trial: 62. Best value: 0.492107:  84%|████████▍ | 84/100 [02:18<00:20,  1.30s/it]Best trial: 62. Best value: 0.492107:  85%|████████▌ | 85/100 [02:18<00:18,  1.24s/it]Best trial: 62. Best value: 0.492107:  85%|████████▌ | 85/100 [02:19<00:18,  1.24s/it]Best trial: 62. Best value: 0.492107:  86%|████████▌ | 86/100 [02:19<00:16,  1.20s/it]Best trial: 62. Best value: 0.492107:  86%|████████▌ | 86/100 [02:21<00:16,  1.20s/it]Best trial: 62. Best value: 0.492107:  87%|████████▋ | 87/100 [02:21<00:16,  1.28s/it]Best trial: 62. Best value: 0.492107:  87%|████████▋ | 87/100 [02:22<00:16,  1.28s/it]Best trial: 62. Best value: 0.492107:  88%|████████▊ | 88/100 [02:22<00:13,  1.16s/it]Best trial: 62. Best value: 0.492107:  88%|████████▊ | 88/100 [02:23<00:13,  1.16s/it]Best trial: 62. Best value: 0.492107:  89%|████████▉ | 89/100 [02:23<00:12,  1.14s/it]Best trial: 62. Best value: 0.492107:  89%|████████▉ | 89/100 [02:24<00:12,  1.14s/it]Best trial: 62. Best value: 0.492107:  90%|█████████ | 90/100 [02:24<00:12,  1.23s/it]Best trial: 62. Best value: 0.492107:  90%|█████████ | 90/100 [02:25<00:12,  1.23s/it]Best trial: 62. Best value: 0.492107:  91%|█████████ | 91/100 [02:25<00:11,  1.22s/it]Best trial: 62. Best value: 0.492107:  91%|█████████ | 91/100 [02:26<00:11,  1.22s/it]Best trial: 62. Best value: 0.492107:  92%|█████████▏| 92/100 [02:26<00:09,  1.15s/it]Best trial: 92. Best value: 0.493992:  92%|█████████▏| 92/100 [02:27<00:09,  1.15s/it]Best trial: 92. Best value: 0.493992:  93%|█████████▎| 93/100 [02:27<00:07,  1.11s/it]Best trial: 92. Best value: 0.493992:  93%|█████████▎| 93/100 [02:28<00:07,  1.11s/it]Best trial: 92. Best value: 0.493992:  94%|█████████▍| 94/100 [02:28<00:06,  1.05s/it]Best trial: 92. Best value: 0.493992:  94%|█████████▍| 94/100 [02:29<00:06,  1.05s/it]Best trial: 92. Best value: 0.493992:  95%|█████████▌| 95/100 [02:29<00:05,  1.00s/it]Best trial: 92. Best value: 0.493992:  95%|█████████▌| 95/100 [02:30<00:05,  1.00s/it]Best trial: 92. Best value: 0.493992:  96%|█████████▌| 96/100 [02:30<00:04,  1.06s/it]Best trial: 92. Best value: 0.493992:  96%|█████████▌| 96/100 [02:32<00:04,  1.06s/it]Best trial: 92. Best value: 0.493992:  97%|█████████▋| 97/100 [02:32<00:03,  1.09s/it]Best trial: 92. Best value: 0.493992:  97%|█████████▋| 97/100 [02:33<00:03,  1.09s/it]Best trial: 92. Best value: 0.493992:  98%|█████████▊| 98/100 [02:33<00:02,  1.11s/it]Best trial: 92. Best value: 0.493992:  98%|█████████▊| 98/100 [02:34<00:02,  1.11s/it]Best trial: 92. Best value: 0.493992:  99%|█████████▉| 99/100 [02:34<00:01,  1.09s/it]Best trial: 92. Best value: 0.493992:  99%|█████████▉| 99/100 [02:35<00:01,  1.09s/it]Best trial: 92. Best value: 0.493992: 100%|██████████| 100/100 [02:35<00:00,  1.07s/it]Best trial: 92. Best value: 0.493992: 100%|██████████| 100/100 [02:35<00:00,  1.55s/it]
2025-11-30 17:21:41,766 - INFO - HPO Complete. Best AUPRC: 0.4940
2025-11-30 17:21:41,767 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.08152607942533492, 'max_depth': 4, 'subsample': 0.6503869412353673, 'colsample_bytree': 0.7760750021133492, 'gamma': 4.062774491318273, 'reg_lambda': 2.7046317275231896e-05, 'reg_alpha': 7.552371171871642e-08}
2025-11-30 17:21:41,767 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:21:43,725 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: awp_only
2025-11-30 17:21:43,725 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:21:43,809 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:21:43,816 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:21:43,818 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-11-30 17:21:43,818 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:21:43,818 - INFO - Training model...
2025-11-30 17:21:44,366 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:21:49,034 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:21:49,034 - INFO - AUROC: 0.6504 (0.5942 - 0.6947)
2025-11-30 17:21:49,034 - INFO - AUPRC: 0.3671 (0.3163 - 0.4569)
2025-11-30 17:21:49,034 - INFO - Brier Score: 0.1989 (0.1853 - 0.2137)
2025-11-30 17:21:49,034 - INFO - Accuracy: 0.6358 (0.5061 - 0.7220)
2025-11-30 17:21:49,035 - INFO - Precision: 0.3333 (0.2766 - 0.4149)
2025-11-30 17:21:49,035 - INFO - Sensitivity (Recall): 0.5949 (0.4963 - 0.8359)
2025-11-30 17:21:49,035 - INFO - F1-Score: 0.4273 (0.3861 - 0.4814)
2025-11-30 17:21:49,035 - INFO - Best Threshold: 0.3800 (0.2000 - 0.4820)
2025-11-30 17:21:49,035 - INFO - Specificity: 0.6479 (0.4274 - 0.7773)
2025-11-30 17:21:49,046 - INFO - Calculating SHAP values...
2025-11-30 17:21:50,112 - INFO - SHAP plots saved.
2025-11-30 17:21:50,113 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:21:51,397 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 17:21:51,398 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:21:51,498 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:21:51,519 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:21:51,523 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 17:21:51,523 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.501219:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.501219:   1%|          | 1/100 [00:03<05:08,  3.12s/it]Best trial: 1. Best value: 0.514196:   1%|          | 1/100 [00:12<05:08,  3.12s/it]Best trial: 1. Best value: 0.514196:   2%|▏         | 2/100 [00:12<11:21,  6.95s/it]Best trial: 2. Best value: 0.522686:   2%|▏         | 2/100 [00:15<11:21,  6.95s/it]Best trial: 2. Best value: 0.522686:   3%|▎         | 3/100 [00:15<08:19,  5.15s/it]Best trial: 2. Best value: 0.522686:   3%|▎         | 3/100 [00:20<08:19,  5.15s/it]Best trial: 2. Best value: 0.522686:   4%|▍         | 4/100 [00:20<07:41,  4.81s/it]Best trial: 2. Best value: 0.522686:   4%|▍         | 4/100 [00:26<07:41,  4.81s/it]Best trial: 2. Best value: 0.522686:   5%|▌         | 5/100 [00:26<08:30,  5.37s/it]Best trial: 5. Best value: 0.527156:   5%|▌         | 5/100 [00:29<08:30,  5.37s/it]Best trial: 5. Best value: 0.527156:   6%|▌         | 6/100 [00:29<07:22,  4.71s/it]Best trial: 5. Best value: 0.527156:   6%|▌         | 6/100 [00:32<07:22,  4.71s/it]Best trial: 5. Best value: 0.527156:   7%|▋         | 7/100 [00:32<06:08,  3.96s/it]Best trial: 5. Best value: 0.527156:   7%|▋         | 7/100 [00:38<06:08,  3.96s/it]Best trial: 5. Best value: 0.527156:   8%|▊         | 8/100 [00:38<06:57,  4.53s/it]Best trial: 5. Best value: 0.527156:   8%|▊         | 8/100 [00:40<06:57,  4.53s/it]Best trial: 5. Best value: 0.527156:   9%|▉         | 9/100 [00:40<06:04,  4.00s/it]Best trial: 5. Best value: 0.527156:   9%|▉         | 9/100 [00:49<06:04,  4.00s/it]Best trial: 5. Best value: 0.527156:  10%|█         | 10/100 [00:49<08:21,  5.57s/it]Best trial: 5. Best value: 0.527156:  10%|█         | 10/100 [00:52<08:21,  5.57s/it]Best trial: 5. Best value: 0.527156:  11%|█         | 11/100 [00:52<06:46,  4.57s/it]Best trial: 5. Best value: 0.527156:  11%|█         | 11/100 [00:54<06:46,  4.57s/it]Best trial: 5. Best value: 0.527156:  12%|█▏        | 12/100 [00:54<05:45,  3.93s/it]Best trial: 5. Best value: 0.527156:  12%|█▏        | 12/100 [00:58<05:45,  3.93s/it]Best trial: 5. Best value: 0.527156:  13%|█▎        | 13/100 [00:58<05:26,  3.75s/it]Best trial: 5. Best value: 0.527156:  13%|█▎        | 13/100 [01:05<05:26,  3.75s/it]Best trial: 5. Best value: 0.527156:  14%|█▍        | 14/100 [01:05<06:55,  4.83s/it]Best trial: 5. Best value: 0.527156:  14%|█▍        | 14/100 [01:09<06:55,  4.83s/it]Best trial: 5. Best value: 0.527156:  15%|█▌        | 15/100 [01:09<06:21,  4.48s/it]Best trial: 5. Best value: 0.527156:  15%|█▌        | 15/100 [01:23<06:21,  4.48s/it]Best trial: 5. Best value: 0.527156:  16%|█▌        | 16/100 [01:23<10:25,  7.44s/it]Best trial: 5. Best value: 0.527156:  16%|█▌        | 16/100 [01:38<10:25,  7.44s/it]Best trial: 5. Best value: 0.527156:  17%|█▋        | 17/100 [01:38<13:20,  9.65s/it]Best trial: 5. Best value: 0.527156:  17%|█▋        | 17/100 [01:49<13:20,  9.65s/it]Best trial: 5. Best value: 0.527156:  18%|█▊        | 18/100 [01:49<13:57, 10.21s/it]Best trial: 5. Best value: 0.527156:  18%|█▊        | 18/100 [01:59<13:57, 10.21s/it]Best trial: 5. Best value: 0.527156:  19%|█▉        | 19/100 [01:59<13:30, 10.01s/it]Best trial: 5. Best value: 0.527156:  19%|█▉        | 19/100 [02:01<13:30, 10.01s/it]Best trial: 5. Best value: 0.527156:  20%|██        | 20/100 [02:01<10:06,  7.58s/it]Best trial: 5. Best value: 0.527156:  20%|██        | 20/100 [02:21<10:06,  7.58s/it]Best trial: 5. Best value: 0.527156:  21%|██        | 21/100 [02:21<15:02, 11.42s/it]Best trial: 5. Best value: 0.527156:  21%|██        | 21/100 [02:25<15:02, 11.42s/it]Best trial: 5. Best value: 0.527156:  22%|██▏       | 22/100 [02:25<11:59,  9.22s/it]Best trial: 5. Best value: 0.527156:  22%|██▏       | 22/100 [02:27<11:59,  9.22s/it]Best trial: 5. Best value: 0.527156:  23%|██▎       | 23/100 [02:27<09:08,  7.12s/it]Best trial: 5. Best value: 0.527156:  23%|██▎       | 23/100 [02:31<09:08,  7.12s/it]Best trial: 5. Best value: 0.527156:  24%|██▍       | 24/100 [02:31<07:34,  5.98s/it]Best trial: 5. Best value: 0.527156:  24%|██▍       | 24/100 [02:35<07:34,  5.98s/it]Best trial: 5. Best value: 0.527156:  25%|██▌       | 25/100 [02:35<06:47,  5.44s/it]Best trial: 5. Best value: 0.527156:  25%|██▌       | 25/100 [02:38<06:47,  5.44s/it]Best trial: 5. Best value: 0.527156:  26%|██▌       | 26/100 [02:38<06:02,  4.89s/it]Best trial: 5. Best value: 0.527156:  26%|██▌       | 26/100 [02:44<06:02,  4.89s/it]Best trial: 5. Best value: 0.527156:  27%|██▋       | 27/100 [02:44<06:21,  5.23s/it]Best trial: 5. Best value: 0.527156:  27%|██▋       | 27/100 [02:47<06:21,  5.23s/it]Best trial: 5. Best value: 0.527156:  28%|██▊       | 28/100 [02:47<05:27,  4.55s/it]Best trial: 28. Best value: 0.531018:  28%|██▊       | 28/100 [02:55<05:27,  4.55s/it]Best trial: 28. Best value: 0.531018:  29%|██▉       | 29/100 [02:55<06:17,  5.32s/it]Best trial: 28. Best value: 0.531018:  29%|██▉       | 29/100 [03:05<06:17,  5.32s/it]Best trial: 28. Best value: 0.531018:  30%|███       | 30/100 [03:05<07:59,  6.85s/it]Best trial: 28. Best value: 0.531018:  30%|███       | 30/100 [03:13<07:59,  6.85s/it]Best trial: 28. Best value: 0.531018:  31%|███       | 31/100 [03:13<08:20,  7.25s/it]Best trial: 31. Best value: 0.536155:  31%|███       | 31/100 [03:21<08:20,  7.25s/it]Best trial: 31. Best value: 0.536155:  32%|███▏      | 32/100 [03:21<08:25,  7.43s/it]Best trial: 31. Best value: 0.536155:  32%|███▏      | 32/100 [03:30<08:25,  7.43s/it]Best trial: 31. Best value: 0.536155:  33%|███▎      | 33/100 [03:30<08:44,  7.83s/it]Best trial: 31. Best value: 0.536155:  33%|███▎      | 33/100 [03:34<08:44,  7.83s/it]Best trial: 31. Best value: 0.536155:  34%|███▍      | 34/100 [03:34<07:24,  6.73s/it]Best trial: 34. Best value: 0.540121:  34%|███▍      | 34/100 [03:40<07:24,  6.73s/it]Best trial: 34. Best value: 0.540121:  35%|███▌      | 35/100 [03:40<07:04,  6.53s/it]Best trial: 34. Best value: 0.540121:  35%|███▌      | 35/100 [03:48<07:04,  6.53s/it]Best trial: 34. Best value: 0.540121:  36%|███▌      | 36/100 [03:48<07:21,  6.90s/it]Best trial: 34. Best value: 0.540121:  36%|███▌      | 36/100 [03:53<07:21,  6.90s/it]Best trial: 34. Best value: 0.540121:  37%|███▋      | 37/100 [03:53<06:39,  6.34s/it]Best trial: 34. Best value: 0.540121:  37%|███▋      | 37/100 [04:00<06:39,  6.34s/it]Best trial: 34. Best value: 0.540121:  38%|███▊      | 38/100 [04:00<06:53,  6.67s/it]Best trial: 34. Best value: 0.540121:  38%|███▊      | 38/100 [04:04<06:53,  6.67s/it]Best trial: 34. Best value: 0.540121:  39%|███▉      | 39/100 [04:04<05:58,  5.87s/it]Best trial: 34. Best value: 0.540121:  39%|███▉      | 39/100 [04:18<05:58,  5.87s/it]Best trial: 34. Best value: 0.540121:  40%|████      | 40/100 [04:18<08:11,  8.18s/it]Best trial: 34. Best value: 0.540121:  40%|████      | 40/100 [04:23<08:11,  8.18s/it]Best trial: 34. Best value: 0.540121:  41%|████      | 41/100 [04:23<07:04,  7.20s/it]Best trial: 34. Best value: 0.540121:  41%|████      | 41/100 [04:29<07:04,  7.20s/it]Best trial: 34. Best value: 0.540121:  42%|████▏     | 42/100 [04:29<06:49,  7.06s/it]Best trial: 34. Best value: 0.540121:  42%|████▏     | 42/100 [04:37<06:49,  7.06s/it]Best trial: 34. Best value: 0.540121:  43%|████▎     | 43/100 [04:37<06:43,  7.07s/it]Best trial: 34. Best value: 0.540121:  43%|████▎     | 43/100 [04:44<06:43,  7.07s/it]Best trial: 34. Best value: 0.540121:  44%|████▍     | 44/100 [04:44<06:36,  7.07s/it]Best trial: 34. Best value: 0.540121:  44%|████▍     | 44/100 [04:48<06:36,  7.07s/it]Best trial: 34. Best value: 0.540121:  45%|████▌     | 45/100 [04:48<05:38,  6.15s/it]Best trial: 34. Best value: 0.540121:  45%|████▌     | 45/100 [04:54<05:38,  6.15s/it]Best trial: 34. Best value: 0.540121:  46%|████▌     | 46/100 [04:54<05:41,  6.32s/it]Best trial: 34. Best value: 0.540121:  46%|████▌     | 46/100 [04:59<05:41,  6.32s/it]Best trial: 34. Best value: 0.540121:  47%|████▋     | 47/100 [04:59<05:08,  5.82s/it]Best trial: 34. Best value: 0.540121:  47%|████▋     | 47/100 [05:07<05:08,  5.82s/it]Best trial: 34. Best value: 0.540121:  48%|████▊     | 48/100 [05:07<05:43,  6.61s/it]Best trial: 34. Best value: 0.540121:  48%|████▊     | 48/100 [05:13<05:43,  6.61s/it]Best trial: 34. Best value: 0.540121:  49%|████▉     | 49/100 [05:13<05:22,  6.32s/it]Best trial: 34. Best value: 0.540121:  49%|████▉     | 49/100 [05:21<05:22,  6.32s/it]Best trial: 34. Best value: 0.540121:  50%|█████     | 50/100 [05:21<05:37,  6.76s/it]Best trial: 34. Best value: 0.540121:  50%|█████     | 50/100 [05:29<05:37,  6.76s/it]Best trial: 34. Best value: 0.540121:  51%|█████     | 51/100 [05:29<05:50,  7.16s/it]Best trial: 34. Best value: 0.540121:  51%|█████     | 51/100 [05:34<05:50,  7.16s/it]Best trial: 34. Best value: 0.540121:  52%|█████▏    | 52/100 [05:34<05:17,  6.62s/it]Best trial: 34. Best value: 0.540121:  52%|█████▏    | 52/100 [05:40<05:17,  6.62s/it]Best trial: 34. Best value: 0.540121:  53%|█████▎    | 53/100 [05:40<04:52,  6.22s/it]Best trial: 34. Best value: 0.540121:  53%|█████▎    | 53/100 [05:48<04:52,  6.22s/it]Best trial: 34. Best value: 0.540121:  54%|█████▍    | 54/100 [05:48<05:10,  6.75s/it]Best trial: 34. Best value: 0.540121:  54%|█████▍    | 54/100 [05:53<05:10,  6.75s/it]Best trial: 34. Best value: 0.540121:  55%|█████▌    | 55/100 [05:53<04:52,  6.49s/it]Best trial: 34. Best value: 0.540121:  55%|█████▌    | 55/100 [06:03<04:52,  6.49s/it]Best trial: 34. Best value: 0.540121:  56%|█████▌    | 56/100 [06:03<05:27,  7.45s/it]Best trial: 34. Best value: 0.540121:  56%|█████▌    | 56/100 [06:15<05:27,  7.45s/it]Best trial: 34. Best value: 0.540121:  57%|█████▋    | 57/100 [06:15<06:20,  8.84s/it]Best trial: 34. Best value: 0.540121:  57%|█████▋    | 57/100 [06:23<06:20,  8.84s/it]Best trial: 34. Best value: 0.540121:  58%|█████▊    | 58/100 [06:23<05:54,  8.45s/it]Best trial: 34. Best value: 0.540121:  58%|█████▊    | 58/100 [06:27<05:54,  8.45s/it]Best trial: 34. Best value: 0.540121:  59%|█████▉    | 59/100 [06:27<04:50,  7.09s/it]Best trial: 34. Best value: 0.540121:  59%|█████▉    | 59/100 [06:31<04:50,  7.09s/it]Best trial: 34. Best value: 0.540121:  60%|██████    | 60/100 [06:31<04:05,  6.14s/it]Best trial: 34. Best value: 0.540121:  60%|██████    | 60/100 [06:41<04:05,  6.14s/it]Best trial: 34. Best value: 0.540121:  61%|██████    | 61/100 [06:41<04:50,  7.44s/it]Best trial: 34. Best value: 0.540121:  61%|██████    | 61/100 [06:47<04:50,  7.44s/it]Best trial: 34. Best value: 0.540121:  62%|██████▏   | 62/100 [06:47<04:20,  6.85s/it]Best trial: 34. Best value: 0.540121:  62%|██████▏   | 62/100 [06:53<04:20,  6.85s/it]Best trial: 34. Best value: 0.540121:  63%|██████▎   | 63/100 [06:53<04:10,  6.76s/it]Best trial: 34. Best value: 0.540121:  63%|██████▎   | 63/100 [07:00<04:10,  6.76s/it]Best trial: 34. Best value: 0.540121:  64%|██████▍   | 64/100 [07:00<04:05,  6.81s/it]Best trial: 34. Best value: 0.540121:  64%|██████▍   | 64/100 [07:05<04:05,  6.81s/it]Best trial: 34. Best value: 0.540121:  65%|██████▌   | 65/100 [07:05<03:36,  6.18s/it]Best trial: 34. Best value: 0.540121:  65%|██████▌   | 65/100 [07:14<03:36,  6.18s/it]Best trial: 34. Best value: 0.540121:  66%|██████▌   | 66/100 [07:14<04:05,  7.21s/it]Best trial: 34. Best value: 0.540121:  66%|██████▌   | 66/100 [07:22<04:05,  7.21s/it]Best trial: 34. Best value: 0.540121:  67%|██████▋   | 67/100 [07:22<04:00,  7.28s/it]Best trial: 34. Best value: 0.540121:  67%|██████▋   | 67/100 [07:28<04:00,  7.28s/it]Best trial: 34. Best value: 0.540121:  68%|██████▊   | 68/100 [07:28<03:45,  7.05s/it]Best trial: 34. Best value: 0.540121:  68%|██████▊   | 68/100 [07:39<03:45,  7.05s/it]Best trial: 34. Best value: 0.540121:  69%|██████▉   | 69/100 [07:39<04:14,  8.22s/it]Best trial: 34. Best value: 0.540121:  69%|██████▉   | 69/100 [07:44<04:14,  8.22s/it]Best trial: 34. Best value: 0.540121:  70%|███████   | 70/100 [07:44<03:39,  7.32s/it]Best trial: 34. Best value: 0.540121:  70%|███████   | 70/100 [07:52<03:39,  7.32s/it]Best trial: 34. Best value: 0.540121:  71%|███████   | 71/100 [07:52<03:31,  7.29s/it]Best trial: 34. Best value: 0.540121:  71%|███████   | 71/100 [08:00<03:31,  7.29s/it]Best trial: 34. Best value: 0.540121:  72%|███████▏  | 72/100 [08:00<03:36,  7.73s/it]Best trial: 34. Best value: 0.540121:  72%|███████▏  | 72/100 [08:09<03:36,  7.73s/it]Best trial: 34. Best value: 0.540121:  73%|███████▎  | 73/100 [08:09<03:31,  7.84s/it]Best trial: 34. Best value: 0.540121:  73%|███████▎  | 73/100 [08:20<03:31,  7.84s/it]Best trial: 34. Best value: 0.540121:  74%|███████▍  | 74/100 [08:20<03:49,  8.83s/it]Best trial: 34. Best value: 0.540121:  74%|███████▍  | 74/100 [08:30<03:49,  8.83s/it]Best trial: 34. Best value: 0.540121:  75%|███████▌  | 75/100 [08:30<03:54,  9.39s/it]Best trial: 34. Best value: 0.540121:  75%|███████▌  | 75/100 [08:37<03:54,  9.39s/it]Best trial: 34. Best value: 0.540121:  76%|███████▌  | 76/100 [08:37<03:25,  8.55s/it]Best trial: 34. Best value: 0.540121:  76%|███████▌  | 76/100 [08:45<03:25,  8.55s/it]Best trial: 34. Best value: 0.540121:  77%|███████▋  | 77/100 [08:45<03:13,  8.42s/it]Best trial: 34. Best value: 0.540121:  77%|███████▋  | 77/100 [08:53<03:13,  8.42s/it]Best trial: 34. Best value: 0.540121:  78%|███████▊  | 78/100 [08:53<02:59,  8.14s/it]Best trial: 34. Best value: 0.540121:  78%|███████▊  | 78/100 [09:00<02:59,  8.14s/it]Best trial: 34. Best value: 0.540121:  79%|███████▉  | 79/100 [09:00<02:46,  7.93s/it]Best trial: 34. Best value: 0.540121:  79%|███████▉  | 79/100 [09:07<02:46,  7.93s/it]Best trial: 34. Best value: 0.540121:  80%|████████  | 80/100 [09:07<02:30,  7.51s/it]Best trial: 34. Best value: 0.540121:  80%|████████  | 80/100 [09:12<02:30,  7.51s/it]Best trial: 34. Best value: 0.540121:  81%|████████  | 81/100 [09:12<02:11,  6.94s/it]Best trial: 34. Best value: 0.540121:  81%|████████  | 81/100 [09:20<02:11,  6.94s/it]Best trial: 34. Best value: 0.540121:  82%|████████▏ | 82/100 [09:20<02:08,  7.15s/it]Best trial: 34. Best value: 0.540121:  82%|████████▏ | 82/100 [09:30<02:08,  7.15s/it]Best trial: 34. Best value: 0.540121:  83%|████████▎ | 83/100 [09:30<02:17,  8.10s/it]Best trial: 34. Best value: 0.540121:  83%|████████▎ | 83/100 [09:38<02:17,  8.10s/it]Best trial: 34. Best value: 0.540121:  84%|████████▍ | 84/100 [09:38<02:08,  8.03s/it]Best trial: 34. Best value: 0.540121:  84%|████████▍ | 84/100 [09:43<02:08,  8.03s/it]Best trial: 34. Best value: 0.540121:  85%|████████▌ | 85/100 [09:43<01:45,  7.01s/it]Best trial: 34. Best value: 0.540121:  85%|████████▌ | 85/100 [09:51<01:45,  7.01s/it]Best trial: 34. Best value: 0.540121:  86%|████████▌ | 86/100 [09:51<01:43,  7.42s/it]Best trial: 34. Best value: 0.540121:  86%|████████▌ | 86/100 [09:57<01:43,  7.42s/it]Best trial: 34. Best value: 0.540121:  87%|████████▋ | 87/100 [09:57<01:29,  6.92s/it]Best trial: 34. Best value: 0.540121:  87%|████████▋ | 87/100 [10:08<01:29,  6.92s/it]Best trial: 34. Best value: 0.540121:  88%|████████▊ | 88/100 [10:08<01:39,  8.30s/it]Best trial: 34. Best value: 0.540121:  88%|████████▊ | 88/100 [10:18<01:39,  8.30s/it]Best trial: 34. Best value: 0.540121:  89%|████████▉ | 89/100 [10:18<01:35,  8.70s/it]Best trial: 34. Best value: 0.540121:  89%|████████▉ | 89/100 [10:25<01:35,  8.70s/it]Best trial: 34. Best value: 0.540121:  90%|█████████ | 90/100 [10:25<01:23,  8.34s/it]Best trial: 34. Best value: 0.540121:  90%|█████████ | 90/100 [10:30<01:23,  8.34s/it]Best trial: 34. Best value: 0.540121:  91%|█████████ | 91/100 [10:30<01:04,  7.19s/it]Best trial: 34. Best value: 0.540121:  91%|█████████ | 91/100 [10:33<01:04,  7.19s/it]Best trial: 34. Best value: 0.540121:  92%|█████████▏| 92/100 [10:33<00:47,  5.98s/it]Best trial: 34. Best value: 0.540121:  92%|█████████▏| 92/100 [10:36<00:47,  5.98s/it]Best trial: 34. Best value: 0.540121:  93%|█████████▎| 93/100 [10:36<00:36,  5.21s/it]Best trial: 34. Best value: 0.540121:  93%|█████████▎| 93/100 [10:40<00:36,  5.21s/it]Best trial: 34. Best value: 0.540121:  94%|█████████▍| 94/100 [10:40<00:28,  4.78s/it]Best trial: 34. Best value: 0.540121:  94%|█████████▍| 94/100 [10:49<00:28,  4.78s/it]Best trial: 34. Best value: 0.540121:  95%|█████████▌| 95/100 [10:49<00:29,  5.83s/it]Best trial: 34. Best value: 0.540121:  95%|█████████▌| 95/100 [10:57<00:29,  5.83s/it]Best trial: 34. Best value: 0.540121:  96%|█████████▌| 96/100 [10:57<00:26,  6.60s/it]Best trial: 34. Best value: 0.540121:  96%|█████████▌| 96/100 [11:07<00:26,  6.60s/it]Best trial: 34. Best value: 0.540121:  97%|█████████▋| 97/100 [11:07<00:22,  7.57s/it]Best trial: 34. Best value: 0.540121:  97%|█████████▋| 97/100 [11:10<00:22,  7.57s/it]Best trial: 34. Best value: 0.540121:  98%|█████████▊| 98/100 [11:10<00:12,  6.13s/it]Best trial: 34. Best value: 0.540121:  98%|█████████▊| 98/100 [11:19<00:12,  6.13s/it]Best trial: 34. Best value: 0.540121:  99%|█████████▉| 99/100 [11:19<00:07,  7.01s/it]Best trial: 34. Best value: 0.540121:  99%|█████████▉| 99/100 [11:21<00:07,  7.01s/it]Best trial: 34. Best value: 0.540121: 100%|██████████| 100/100 [11:21<00:00,  5.74s/it]Best trial: 34. Best value: 0.540121: 100%|██████████| 100/100 [11:21<00:00,  6.82s/it]
2025-11-30 17:33:13,358 - INFO - HPO Complete. Best AUPRC: 0.5401
2025-11-30 17:33:13,359 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.018916135980917913, 'max_depth': 8, 'subsample': 0.6859770166102049, 'colsample_bytree': 0.6071492102667337, 'gamma': 2.6206152019166473, 'reg_lambda': 3.0057248560164645e-06, 'reg_alpha': 3.0662020288029786e-07}
2025-11-30 17:33:13,360 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:33:15,504 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: all_waveforms
2025-11-30 17:33:15,505 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:33:15,605 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:33:15,628 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:33:15,632 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 17:33:15,632 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:33:15,632 - INFO - Training model...
2025-11-30 17:33:18,577 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:33:23,674 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:33:23,674 - INFO - AUROC: 0.7640 (0.7160 - 0.8007)
2025-11-30 17:33:23,674 - INFO - AUPRC: 0.4544 (0.3797 - 0.5273)
2025-11-30 17:33:23,674 - INFO - Brier Score: 0.1554 (0.1435 - 0.1678)
2025-11-30 17:33:23,674 - INFO - Accuracy: 0.7327 (0.5945 - 0.7743)
2025-11-30 17:33:23,674 - INFO - Precision: 0.4421 (0.3344 - 0.5256)
2025-11-30 17:33:23,674 - INFO - Sensitivity (Recall): 0.6519 (0.5609 - 0.8341)
2025-11-30 17:33:23,674 - INFO - F1-Score: 0.5269 (0.4668 - 0.5835)
2025-11-30 17:33:23,674 - INFO - Best Threshold: 0.3200 (0.1820 - 0.3920)
2025-11-30 17:33:23,674 - INFO - Specificity: 0.7566 (0.5292 - 0.8366)
2025-11-30 17:33:23,707 - INFO - Calculating SHAP values...
2025-11-30 17:33:25,154 - INFO - SHAP plots saved.
2025-11-30 17:33:25,157 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:33:26,492 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 17:33:26,492 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:33:26,581 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:33:26,620 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:33:26,631 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 17:33:26,631 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.606802:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.606802:   1%|          | 1/100 [00:05<08:32,  5.18s/it]Best trial: 0. Best value: 0.606802:   1%|          | 1/100 [00:12<08:32,  5.18s/it]Best trial: 0. Best value: 0.606802:   2%|▏         | 2/100 [00:12<10:12,  6.25s/it]Best trial: 0. Best value: 0.606802:   2%|▏         | 2/100 [00:14<10:12,  6.25s/it]Best trial: 0. Best value: 0.606802:   3%|▎         | 3/100 [00:14<07:29,  4.63s/it]Best trial: 0. Best value: 0.606802:   3%|▎         | 3/100 [00:20<07:29,  4.63s/it]Best trial: 0. Best value: 0.606802:   4%|▍         | 4/100 [00:20<08:13,  5.14s/it]Best trial: 0. Best value: 0.606802:   4%|▍         | 4/100 [00:26<08:13,  5.14s/it]Best trial: 0. Best value: 0.606802:   5%|▌         | 5/100 [00:26<08:34,  5.41s/it]Best trial: 0. Best value: 0.606802:   5%|▌         | 5/100 [00:41<08:34,  5.41s/it]Best trial: 0. Best value: 0.606802:   6%|▌         | 6/100 [00:41<13:26,  8.58s/it]Best trial: 0. Best value: 0.606802:   6%|▌         | 6/100 [00:45<13:26,  8.58s/it]Best trial: 0. Best value: 0.606802:   7%|▋         | 7/100 [00:45<10:53,  7.03s/it]Best trial: 0. Best value: 0.606802:   7%|▋         | 7/100 [00:51<10:53,  7.03s/it]Best trial: 0. Best value: 0.606802:   8%|▊         | 8/100 [00:51<10:30,  6.85s/it]Best trial: 0. Best value: 0.606802:   8%|▊         | 8/100 [01:03<10:30,  6.85s/it]Best trial: 0. Best value: 0.606802:   9%|▉         | 9/100 [01:03<12:56,  8.53s/it]Best trial: 0. Best value: 0.606802:   9%|▉         | 9/100 [01:07<12:56,  8.53s/it]Best trial: 0. Best value: 0.606802:  10%|█         | 10/100 [01:07<10:37,  7.08s/it]Best trial: 0. Best value: 0.606802:  10%|█         | 10/100 [01:18<10:37,  7.08s/it]Best trial: 0. Best value: 0.606802:  11%|█         | 11/100 [01:18<12:15,  8.27s/it]Best trial: 0. Best value: 0.606802:  11%|█         | 11/100 [01:21<12:15,  8.27s/it]Best trial: 0. Best value: 0.606802:  12%|█▏        | 12/100 [01:21<09:35,  6.54s/it]Best trial: 12. Best value: 0.60771:  12%|█▏        | 12/100 [01:28<09:35,  6.54s/it]Best trial: 12. Best value: 0.60771:  13%|█▎        | 13/100 [01:28<09:50,  6.79s/it]Best trial: 12. Best value: 0.60771:  13%|█▎        | 13/100 [01:42<09:50,  6.79s/it]Best trial: 12. Best value: 0.60771:  14%|█▍        | 14/100 [01:42<12:34,  8.77s/it]Best trial: 12. Best value: 0.60771:  14%|█▍        | 14/100 [01:47<12:34,  8.77s/it]Best trial: 12. Best value: 0.60771:  15%|█▌        | 15/100 [01:47<10:53,  7.69s/it]Best trial: 12. Best value: 0.60771:  15%|█▌        | 15/100 [01:53<10:53,  7.69s/it]Best trial: 12. Best value: 0.60771:  16%|█▌        | 16/100 [01:53<10:08,  7.24s/it]Best trial: 12. Best value: 0.60771:  16%|█▌        | 16/100 [01:56<10:08,  7.24s/it]Best trial: 12. Best value: 0.60771:  17%|█▋        | 17/100 [01:56<08:22,  6.06s/it]Best trial: 12. Best value: 0.60771:  17%|█▋        | 17/100 [02:00<08:22,  6.06s/it]Best trial: 12. Best value: 0.60771:  18%|█▊        | 18/100 [02:00<07:21,  5.38s/it]Best trial: 12. Best value: 0.60771:  18%|█▊        | 18/100 [02:05<07:21,  5.38s/it]Best trial: 12. Best value: 0.60771:  19%|█▉        | 19/100 [02:05<07:02,  5.22s/it]Best trial: 12. Best value: 0.60771:  19%|█▉        | 19/100 [02:10<07:02,  5.22s/it]Best trial: 12. Best value: 0.60771:  20%|██        | 20/100 [02:10<06:50,  5.13s/it]Best trial: 12. Best value: 0.60771:  20%|██        | 20/100 [02:14<06:50,  5.13s/it]Best trial: 12. Best value: 0.60771:  21%|██        | 21/100 [02:14<06:31,  4.95s/it]Best trial: 12. Best value: 0.60771:  21%|██        | 21/100 [02:21<06:31,  4.95s/it]Best trial: 12. Best value: 0.60771:  22%|██▏       | 22/100 [02:21<07:03,  5.43s/it]Best trial: 12. Best value: 0.60771:  22%|██▏       | 22/100 [02:24<07:03,  5.43s/it]Best trial: 12. Best value: 0.60771:  23%|██▎       | 23/100 [02:24<06:06,  4.76s/it]Best trial: 12. Best value: 0.60771:  23%|██▎       | 23/100 [02:33<06:06,  4.76s/it]Best trial: 12. Best value: 0.60771:  24%|██▍       | 24/100 [02:33<07:46,  6.14s/it]Best trial: 12. Best value: 0.60771:  24%|██▍       | 24/100 [02:40<07:46,  6.14s/it]Best trial: 12. Best value: 0.60771:  25%|██▌       | 25/100 [02:40<07:58,  6.37s/it]Best trial: 12. Best value: 0.60771:  25%|██▌       | 25/100 [02:44<07:58,  6.37s/it]Best trial: 12. Best value: 0.60771:  26%|██▌       | 26/100 [02:44<07:02,  5.70s/it]Best trial: 12. Best value: 0.60771:  26%|██▌       | 26/100 [02:58<07:02,  5.70s/it]Best trial: 12. Best value: 0.60771:  27%|██▋       | 27/100 [02:58<09:46,  8.03s/it]Best trial: 12. Best value: 0.60771:  27%|██▋       | 27/100 [03:13<09:46,  8.03s/it]Best trial: 12. Best value: 0.60771:  28%|██▊       | 28/100 [03:13<12:04, 10.06s/it]Best trial: 12. Best value: 0.60771:  28%|██▊       | 28/100 [03:15<12:04, 10.06s/it]Best trial: 12. Best value: 0.60771:  29%|██▉       | 29/100 [03:15<09:18,  7.86s/it]Best trial: 29. Best value: 0.610455:  29%|██▉       | 29/100 [03:27<09:18,  7.86s/it]Best trial: 29. Best value: 0.610455:  30%|███       | 30/100 [03:27<10:25,  8.93s/it]Best trial: 29. Best value: 0.610455:  30%|███       | 30/100 [03:35<10:25,  8.93s/it]Best trial: 29. Best value: 0.610455:  31%|███       | 31/100 [03:35<10:07,  8.81s/it]Best trial: 29. Best value: 0.610455:  31%|███       | 31/100 [03:48<10:07,  8.81s/it]Best trial: 29. Best value: 0.610455:  32%|███▏      | 32/100 [03:48<11:19,  9.99s/it]Best trial: 29. Best value: 0.610455:  32%|███▏      | 32/100 [03:56<11:19,  9.99s/it]Best trial: 29. Best value: 0.610455:  33%|███▎      | 33/100 [03:56<10:28,  9.38s/it]Best trial: 29. Best value: 0.610455:  33%|███▎      | 33/100 [04:02<10:28,  9.38s/it]Best trial: 29. Best value: 0.610455:  34%|███▍      | 34/100 [04:02<09:06,  8.28s/it]Best trial: 29. Best value: 0.610455:  34%|███▍      | 34/100 [04:13<09:06,  8.28s/it]Best trial: 29. Best value: 0.610455:  35%|███▌      | 35/100 [04:13<10:00,  9.23s/it]Best trial: 29. Best value: 0.610455:  35%|███▌      | 35/100 [04:21<10:00,  9.23s/it]Best trial: 29. Best value: 0.610455:  36%|███▌      | 36/100 [04:21<09:19,  8.75s/it]Best trial: 29. Best value: 0.610455:  36%|███▌      | 36/100 [04:33<09:19,  8.75s/it]Best trial: 29. Best value: 0.610455:  37%|███▋      | 37/100 [04:33<10:10,  9.69s/it]Best trial: 29. Best value: 0.610455:  37%|███▋      | 37/100 [04:42<10:10,  9.69s/it]Best trial: 29. Best value: 0.610455:  38%|███▊      | 38/100 [04:42<09:44,  9.43s/it]Best trial: 29. Best value: 0.610455:  38%|███▊      | 38/100 [04:46<09:44,  9.43s/it]Best trial: 29. Best value: 0.610455:  39%|███▉      | 39/100 [04:46<08:10,  8.04s/it]Best trial: 29. Best value: 0.610455:  39%|███▉      | 39/100 [04:50<08:10,  8.04s/it]Best trial: 29. Best value: 0.610455:  40%|████      | 40/100 [04:50<06:36,  6.61s/it]Best trial: 29. Best value: 0.610455:  40%|████      | 40/100 [04:57<06:36,  6.61s/it]Best trial: 29. Best value: 0.610455:  41%|████      | 41/100 [04:57<06:49,  6.94s/it]Best trial: 29. Best value: 0.610455:  41%|████      | 41/100 [05:02<06:49,  6.94s/it]Best trial: 29. Best value: 0.610455:  42%|████▏     | 42/100 [05:02<06:04,  6.28s/it]Best trial: 29. Best value: 0.610455:  42%|████▏     | 42/100 [05:11<06:04,  6.28s/it]Best trial: 29. Best value: 0.610455:  43%|████▎     | 43/100 [05:11<06:48,  7.16s/it]Best trial: 29. Best value: 0.610455:  43%|████▎     | 43/100 [05:22<06:48,  7.16s/it]Best trial: 29. Best value: 0.610455:  44%|████▍     | 44/100 [05:22<07:34,  8.11s/it]Best trial: 29. Best value: 0.610455:  44%|████▍     | 44/100 [05:27<07:34,  8.11s/it]Best trial: 29. Best value: 0.610455:  45%|████▌     | 45/100 [05:27<06:40,  7.29s/it]Best trial: 29. Best value: 0.610455:  45%|████▌     | 45/100 [05:37<06:40,  7.29s/it]Best trial: 29. Best value: 0.610455:  46%|████▌     | 46/100 [05:37<07:23,  8.21s/it]Best trial: 29. Best value: 0.610455:  46%|████▌     | 46/100 [05:40<07:23,  8.21s/it]Best trial: 29. Best value: 0.610455:  47%|████▋     | 47/100 [05:40<05:45,  6.52s/it]Best trial: 29. Best value: 0.610455:  47%|████▋     | 47/100 [05:45<05:45,  6.52s/it]Best trial: 29. Best value: 0.610455:  48%|████▊     | 48/100 [05:45<05:20,  6.16s/it]Best trial: 29. Best value: 0.610455:  48%|████▊     | 48/100 [05:50<05:20,  6.16s/it]Best trial: 29. Best value: 0.610455:  49%|████▉     | 49/100 [05:50<04:58,  5.85s/it]Best trial: 29. Best value: 0.610455:  49%|████▉     | 49/100 [05:55<04:58,  5.85s/it]Best trial: 29. Best value: 0.610455:  50%|█████     | 50/100 [05:55<04:40,  5.60s/it]Best trial: 29. Best value: 0.610455:  50%|█████     | 50/100 [06:04<04:40,  5.60s/it]Best trial: 29. Best value: 0.610455:  51%|█████     | 51/100 [06:04<05:19,  6.53s/it]Best trial: 29. Best value: 0.610455:  51%|█████     | 51/100 [06:10<05:19,  6.53s/it]Best trial: 29. Best value: 0.610455:  52%|█████▏    | 52/100 [06:10<05:04,  6.35s/it]Best trial: 29. Best value: 0.610455:  52%|█████▏    | 52/100 [06:16<05:04,  6.35s/it]Best trial: 29. Best value: 0.610455:  53%|█████▎    | 53/100 [06:16<04:53,  6.25s/it]Best trial: 29. Best value: 0.610455:  53%|█████▎    | 53/100 [06:21<04:53,  6.25s/it]Best trial: 29. Best value: 0.610455:  54%|█████▍    | 54/100 [06:21<04:31,  5.91s/it]Best trial: 29. Best value: 0.610455:  54%|█████▍    | 54/100 [06:24<04:31,  5.91s/it]Best trial: 29. Best value: 0.610455:  55%|█████▌    | 55/100 [06:24<03:37,  4.84s/it]Best trial: 29. Best value: 0.610455:  55%|█████▌    | 55/100 [06:28<03:37,  4.84s/it]Best trial: 29. Best value: 0.610455:  56%|█████▌    | 56/100 [06:28<03:31,  4.81s/it]Best trial: 29. Best value: 0.610455:  56%|█████▌    | 56/100 [06:37<03:31,  4.81s/it]Best trial: 29. Best value: 0.610455:  57%|█████▋    | 57/100 [06:37<04:19,  6.03s/it]Best trial: 29. Best value: 0.610455:  57%|█████▋    | 57/100 [06:41<04:19,  6.03s/it]Best trial: 29. Best value: 0.610455:  58%|█████▊    | 58/100 [06:41<03:42,  5.30s/it]Best trial: 29. Best value: 0.610455:  58%|█████▊    | 58/100 [06:46<03:42,  5.30s/it]Best trial: 29. Best value: 0.610455:  59%|█████▉    | 59/100 [06:46<03:38,  5.33s/it]Best trial: 29. Best value: 0.610455:  59%|█████▉    | 59/100 [06:49<03:38,  5.33s/it]Best trial: 29. Best value: 0.610455:  60%|██████    | 60/100 [06:49<03:06,  4.67s/it]Best trial: 29. Best value: 0.610455:  60%|██████    | 60/100 [06:53<03:06,  4.67s/it]Best trial: 29. Best value: 0.610455:  61%|██████    | 61/100 [06:53<02:54,  4.47s/it]Best trial: 29. Best value: 0.610455:  61%|██████    | 61/100 [06:58<02:54,  4.47s/it]Best trial: 29. Best value: 0.610455:  62%|██████▏   | 62/100 [06:58<02:52,  4.53s/it]Best trial: 29. Best value: 0.610455:  62%|██████▏   | 62/100 [07:02<02:52,  4.53s/it]Best trial: 29. Best value: 0.610455:  63%|██████▎   | 63/100 [07:02<02:45,  4.46s/it]Best trial: 29. Best value: 0.610455:  63%|██████▎   | 63/100 [07:09<02:45,  4.46s/it]Best trial: 29. Best value: 0.610455:  64%|██████▍   | 64/100 [07:09<03:04,  5.13s/it]Best trial: 29. Best value: 0.610455:  64%|██████▍   | 64/100 [07:14<03:04,  5.13s/it]Best trial: 29. Best value: 0.610455:  65%|██████▌   | 65/100 [07:14<02:53,  4.94s/it]Best trial: 29. Best value: 0.610455:  65%|██████▌   | 65/100 [07:17<02:53,  4.94s/it]Best trial: 29. Best value: 0.610455:  66%|██████▌   | 66/100 [07:17<02:34,  4.54s/it]Best trial: 29. Best value: 0.610455:  66%|██████▌   | 66/100 [07:23<02:34,  4.54s/it]Best trial: 29. Best value: 0.610455:  67%|██████▋   | 67/100 [07:23<02:38,  4.80s/it]Best trial: 29. Best value: 0.610455:  67%|██████▋   | 67/100 [07:41<02:38,  4.80s/it]Best trial: 29. Best value: 0.610455:  68%|██████▊   | 68/100 [07:41<04:42,  8.82s/it]Best trial: 29. Best value: 0.610455:  68%|██████▊   | 68/100 [07:56<04:42,  8.82s/it]Best trial: 29. Best value: 0.610455:  69%|██████▉   | 69/100 [07:56<05:28, 10.61s/it]Best trial: 29. Best value: 0.610455:  69%|██████▉   | 69/100 [08:04<05:28, 10.61s/it]Best trial: 29. Best value: 0.610455:  70%|███████   | 70/100 [08:04<04:57,  9.90s/it]Best trial: 29. Best value: 0.610455:  70%|███████   | 70/100 [08:13<04:57,  9.90s/it]Best trial: 29. Best value: 0.610455:  71%|███████   | 71/100 [08:13<04:42,  9.73s/it]Best trial: 29. Best value: 0.610455:  71%|███████   | 71/100 [08:24<04:42,  9.73s/it]Best trial: 29. Best value: 0.610455:  72%|███████▏  | 72/100 [08:24<04:42, 10.09s/it]Best trial: 29. Best value: 0.610455:  72%|███████▏  | 72/100 [08:28<04:42, 10.09s/it]Best trial: 29. Best value: 0.610455:  73%|███████▎  | 73/100 [08:28<03:41,  8.20s/it]Best trial: 29. Best value: 0.610455:  73%|███████▎  | 73/100 [08:36<03:41,  8.20s/it]Best trial: 29. Best value: 0.610455:  74%|███████▍  | 74/100 [08:36<03:36,  8.33s/it]Best trial: 29. Best value: 0.610455:  74%|███████▍  | 74/100 [08:45<03:36,  8.33s/it]Best trial: 29. Best value: 0.610455:  75%|███████▌  | 75/100 [08:45<03:30,  8.44s/it]Best trial: 29. Best value: 0.610455:  75%|███████▌  | 75/100 [08:52<03:30,  8.44s/it]Best trial: 29. Best value: 0.610455:  76%|███████▌  | 76/100 [08:52<03:12,  8.00s/it]Best trial: 29. Best value: 0.610455:  76%|███████▌  | 76/100 [09:01<03:12,  8.00s/it]Best trial: 29. Best value: 0.610455:  77%|███████▋  | 77/100 [09:01<03:12,  8.37s/it]Best trial: 29. Best value: 0.610455:  77%|███████▋  | 77/100 [09:07<03:12,  8.37s/it]Best trial: 29. Best value: 0.610455:  78%|███████▊  | 78/100 [09:07<02:44,  7.47s/it]Best trial: 78. Best value: 0.612031:  78%|███████▊  | 78/100 [09:12<02:44,  7.47s/it]Best trial: 78. Best value: 0.612031:  79%|███████▉  | 79/100 [09:12<02:24,  6.88s/it]Best trial: 78. Best value: 0.612031:  79%|███████▉  | 79/100 [09:18<02:24,  6.88s/it]Best trial: 78. Best value: 0.612031:  80%|████████  | 80/100 [09:18<02:11,  6.56s/it]Best trial: 78. Best value: 0.612031:  80%|████████  | 80/100 [09:23<02:11,  6.56s/it]Best trial: 78. Best value: 0.612031:  81%|████████  | 81/100 [09:23<01:53,  5.98s/it]Best trial: 78. Best value: 0.612031:  81%|████████  | 81/100 [09:27<01:53,  5.98s/it]Best trial: 78. Best value: 0.612031:  82%|████████▏ | 82/100 [09:27<01:38,  5.49s/it]Best trial: 78. Best value: 0.612031:  82%|████████▏ | 82/100 [09:32<01:38,  5.49s/it]Best trial: 78. Best value: 0.612031:  83%|████████▎ | 83/100 [09:32<01:30,  5.34s/it]Best trial: 78. Best value: 0.612031:  83%|████████▎ | 83/100 [09:36<01:30,  5.34s/it]Best trial: 78. Best value: 0.612031:  84%|████████▍ | 84/100 [09:36<01:17,  4.82s/it]Best trial: 78. Best value: 0.612031:  84%|████████▍ | 84/100 [09:44<01:17,  4.82s/it]Best trial: 78. Best value: 0.612031:  85%|████████▌ | 85/100 [09:44<01:29,  5.94s/it]Best trial: 78. Best value: 0.612031:  85%|████████▌ | 85/100 [09:52<01:29,  5.94s/it]Best trial: 78. Best value: 0.612031:  86%|████████▌ | 86/100 [09:52<01:32,  6.62s/it]Best trial: 78. Best value: 0.612031:  86%|████████▌ | 86/100 [09:56<01:32,  6.62s/it]Best trial: 78. Best value: 0.612031:  87%|████████▋ | 87/100 [09:56<01:14,  5.74s/it]Best trial: 78. Best value: 0.612031:  87%|████████▋ | 87/100 [10:09<01:14,  5.74s/it]Best trial: 78. Best value: 0.612031:  88%|████████▊ | 88/100 [10:09<01:35,  7.92s/it]Best trial: 78. Best value: 0.612031:  88%|████████▊ | 88/100 [10:16<01:35,  7.92s/it]Best trial: 78. Best value: 0.612031:  89%|████████▉ | 89/100 [10:16<01:24,  7.72s/it]Best trial: 78. Best value: 0.612031:  89%|████████▉ | 89/100 [10:31<01:24,  7.72s/it]Best trial: 78. Best value: 0.612031:  90%|█████████ | 90/100 [10:31<01:38,  9.90s/it]Best trial: 78. Best value: 0.612031:  90%|█████████ | 90/100 [10:43<01:38,  9.90s/it]Best trial: 78. Best value: 0.612031:  91%|█████████ | 91/100 [10:43<01:34, 10.48s/it]Best trial: 78. Best value: 0.612031:  91%|█████████ | 91/100 [10:55<01:34, 10.48s/it]Best trial: 78. Best value: 0.612031:  92%|█████████▏| 92/100 [10:55<01:26, 10.84s/it]Best trial: 78. Best value: 0.612031:  92%|█████████▏| 92/100 [11:02<01:26, 10.84s/it]Best trial: 78. Best value: 0.612031:  93%|█████████▎| 93/100 [11:02<01:08,  9.82s/it]Best trial: 78. Best value: 0.612031:  93%|█████████▎| 93/100 [11:11<01:08,  9.82s/it]Best trial: 78. Best value: 0.612031:  94%|█████████▍| 94/100 [11:11<00:56,  9.40s/it]Best trial: 78. Best value: 0.612031:  94%|█████████▍| 94/100 [11:19<00:56,  9.40s/it]Best trial: 78. Best value: 0.612031:  95%|█████████▌| 95/100 [11:19<00:45,  9.04s/it]Best trial: 78. Best value: 0.612031:  95%|█████████▌| 95/100 [11:26<00:45,  9.04s/it]Best trial: 78. Best value: 0.612031:  96%|█████████▌| 96/100 [11:26<00:34,  8.58s/it]Best trial: 78. Best value: 0.612031:  96%|█████████▌| 96/100 [11:35<00:34,  8.58s/it]Best trial: 78. Best value: 0.612031:  97%|█████████▋| 97/100 [11:35<00:25,  8.60s/it]Best trial: 78. Best value: 0.612031:  97%|█████████▋| 97/100 [11:44<00:25,  8.60s/it]Best trial: 78. Best value: 0.612031:  98%|█████████▊| 98/100 [11:44<00:17,  8.65s/it]Best trial: 78. Best value: 0.612031:  98%|█████████▊| 98/100 [11:51<00:17,  8.65s/it]Best trial: 78. Best value: 0.612031:  99%|█████████▉| 99/100 [11:51<00:08,  8.17s/it]Best trial: 78. Best value: 0.612031:  99%|█████████▉| 99/100 [12:02<00:08,  8.17s/it]Best trial: 78. Best value: 0.612031: 100%|██████████| 100/100 [12:02<00:00,  9.11s/it]Best trial: 78. Best value: 0.612031: 100%|██████████| 100/100 [12:02<00:00,  7.23s/it]
2025-11-30 17:45:29,285 - INFO - HPO Complete. Best AUPRC: 0.6120
2025-11-30 17:45:29,285 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.04383751476619945, 'max_depth': 5, 'subsample': 0.8095842100861349, 'colsample_bytree': 0.857023004473635, 'gamma': 0.38550645768709396, 'reg_lambda': 0.16817380545793112, 'reg_alpha': 0.011479003245001743}
2025-11-30 17:45:29,286 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:45:31,110 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-11-30 17:45:31,111 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:45:31,200 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:45:31,237 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:45:31,249 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 17:45:31,249 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:45:31,249 - INFO - Training model...
2025-11-30 17:45:34,744 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:45:40,368 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:45:40,368 - INFO - AUROC: 0.8039 (0.7772 - 0.8206)
2025-11-30 17:45:40,368 - INFO - AUPRC: 0.5592 (0.5026 - 0.6124)
2025-11-30 17:45:40,368 - INFO - Brier Score: 0.1509 (0.1405 - 0.1668)
2025-11-30 17:45:40,368 - INFO - Accuracy: 0.7717 (0.7231 - 0.8078)
2025-11-30 17:45:40,368 - INFO - Precision: 0.5000 (0.4366 - 0.5733)
2025-11-30 17:45:40,368 - INFO - Sensitivity (Recall): 0.6392 (0.5493 - 0.7804)
2025-11-30 17:45:40,368 - INFO - F1-Score: 0.5611 (0.5309 - 0.6211)
2025-11-30 17:45:40,369 - INFO - Best Threshold: 0.2400 (0.1260 - 0.3420)
2025-11-30 17:45:40,369 - INFO - Specificity: 0.8109 (0.7125 - 0.8665)
2025-11-30 17:45:40,394 - INFO - Calculating SHAP values...
2025-11-30 17:45:41,643 - INFO - SHAP plots saved.
2025-11-30 17:45:41,645 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:45:42,839 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 17:45:42,839 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:45:42,926 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:45:42,938 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:45:42,940 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 17:45:42,940 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.497581:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.497581:   1%|          | 1/100 [00:03<05:08,  3.12s/it]Best trial: 1. Best value: 0.505531:   1%|          | 1/100 [00:04<05:08,  3.12s/it]Best trial: 1. Best value: 0.505531:   2%|▏         | 2/100 [00:04<03:42,  2.27s/it]Best trial: 1. Best value: 0.505531:   2%|▏         | 2/100 [00:06<03:42,  2.27s/it]Best trial: 1. Best value: 0.505531:   3%|▎         | 3/100 [00:06<02:57,  1.83s/it]Best trial: 3. Best value: 0.515428:   3%|▎         | 3/100 [00:09<02:57,  1.83s/it]Best trial: 3. Best value: 0.515428:   4%|▍         | 4/100 [00:09<03:42,  2.31s/it]Best trial: 3. Best value: 0.515428:   4%|▍         | 4/100 [00:10<03:42,  2.31s/it]Best trial: 3. Best value: 0.515428:   5%|▌         | 5/100 [00:10<03:02,  1.92s/it]Best trial: 5. Best value: 0.517596:   5%|▌         | 5/100 [00:15<03:02,  1.92s/it]Best trial: 5. Best value: 0.517596:   6%|▌         | 6/100 [00:15<04:54,  3.14s/it]Best trial: 5. Best value: 0.517596:   6%|▌         | 6/100 [00:16<04:54,  3.14s/it]Best trial: 5. Best value: 0.517596:   7%|▋         | 7/100 [00:16<03:44,  2.42s/it]Best trial: 5. Best value: 0.517596:   7%|▋         | 7/100 [00:21<03:44,  2.42s/it]Best trial: 5. Best value: 0.517596:   8%|▊         | 8/100 [00:21<04:42,  3.07s/it]Best trial: 5. Best value: 0.517596:   8%|▊         | 8/100 [00:22<04:42,  3.07s/it]Best trial: 5. Best value: 0.517596:   9%|▉         | 9/100 [00:22<03:58,  2.62s/it]Best trial: 5. Best value: 0.517596:   9%|▉         | 9/100 [00:24<03:58,  2.62s/it]Best trial: 5. Best value: 0.517596:  10%|█         | 10/100 [00:24<03:27,  2.30s/it]Best trial: 5. Best value: 0.517596:  10%|█         | 10/100 [00:28<03:27,  2.30s/it]Best trial: 5. Best value: 0.517596:  11%|█         | 11/100 [00:28<04:10,  2.81s/it]Best trial: 5. Best value: 0.517596:  11%|█         | 11/100 [00:31<04:10,  2.81s/it]Best trial: 5. Best value: 0.517596:  12%|█▏        | 12/100 [00:31<04:05,  2.79s/it]Best trial: 5. Best value: 0.517596:  12%|█▏        | 12/100 [00:34<04:05,  2.79s/it]Best trial: 5. Best value: 0.517596:  13%|█▎        | 13/100 [00:34<04:21,  3.00s/it]Best trial: 5. Best value: 0.517596:  13%|█▎        | 13/100 [00:39<04:21,  3.00s/it]Best trial: 5. Best value: 0.517596:  14%|█▍        | 14/100 [00:39<04:54,  3.42s/it]Best trial: 5. Best value: 0.517596:  14%|█▍        | 14/100 [00:41<04:54,  3.42s/it]Best trial: 5. Best value: 0.517596:  15%|█▌        | 15/100 [00:41<04:17,  3.03s/it]Best trial: 5. Best value: 0.517596:  15%|█▌        | 15/100 [00:43<04:17,  3.03s/it]Best trial: 5. Best value: 0.517596:  16%|█▌        | 16/100 [00:43<03:43,  2.66s/it]Best trial: 5. Best value: 0.517596:  16%|█▌        | 16/100 [00:48<03:43,  2.66s/it]Best trial: 5. Best value: 0.517596:  17%|█▋        | 17/100 [00:48<04:40,  3.38s/it]Best trial: 5. Best value: 0.517596:  17%|█▋        | 17/100 [00:52<04:40,  3.38s/it]Best trial: 5. Best value: 0.517596:  18%|█▊        | 18/100 [00:52<04:52,  3.57s/it]Best trial: 5. Best value: 0.517596:  18%|█▊        | 18/100 [00:57<04:52,  3.57s/it]Best trial: 5. Best value: 0.517596:  19%|█▉        | 19/100 [00:57<05:39,  4.19s/it]Best trial: 5. Best value: 0.517596:  19%|█▉        | 19/100 [00:59<05:39,  4.19s/it]Best trial: 5. Best value: 0.517596:  20%|██        | 20/100 [00:59<04:35,  3.44s/it]Best trial: 5. Best value: 0.517596:  20%|██        | 20/100 [01:01<04:35,  3.44s/it]Best trial: 5. Best value: 0.517596:  21%|██        | 21/100 [01:01<04:02,  3.06s/it]Best trial: 5. Best value: 0.517596:  21%|██        | 21/100 [01:05<04:02,  3.06s/it]Best trial: 5. Best value: 0.517596:  22%|██▏       | 22/100 [01:05<04:20,  3.34s/it]Best trial: 5. Best value: 0.517596:  22%|██▏       | 22/100 [01:09<04:20,  3.34s/it]Best trial: 5. Best value: 0.517596:  23%|██▎       | 23/100 [01:09<04:35,  3.58s/it]Best trial: 5. Best value: 0.517596:  23%|██▎       | 23/100 [01:12<04:35,  3.58s/it]Best trial: 5. Best value: 0.517596:  24%|██▍       | 24/100 [01:12<04:13,  3.34s/it]Best trial: 5. Best value: 0.517596:  24%|██▍       | 24/100 [01:19<04:13,  3.34s/it]Best trial: 5. Best value: 0.517596:  25%|██▌       | 25/100 [01:19<05:28,  4.38s/it]Best trial: 5. Best value: 0.517596:  25%|██▌       | 25/100 [01:21<05:28,  4.38s/it]Best trial: 5. Best value: 0.517596:  26%|██▌       | 26/100 [01:21<04:39,  3.78s/it]Best trial: 5. Best value: 0.517596:  26%|██▌       | 26/100 [01:24<04:39,  3.78s/it]Best trial: 5. Best value: 0.517596:  27%|██▋       | 27/100 [01:24<04:16,  3.51s/it]Best trial: 5. Best value: 0.517596:  27%|██▋       | 27/100 [01:27<04:16,  3.51s/it]Best trial: 5. Best value: 0.517596:  28%|██▊       | 28/100 [01:27<03:59,  3.32s/it]Best trial: 5. Best value: 0.517596:  28%|██▊       | 28/100 [01:29<03:59,  3.32s/it]Best trial: 5. Best value: 0.517596:  29%|██▉       | 29/100 [01:29<03:18,  2.79s/it]Best trial: 5. Best value: 0.517596:  29%|██▉       | 29/100 [01:30<03:18,  2.79s/it]Best trial: 5. Best value: 0.517596:  30%|███       | 30/100 [01:30<02:54,  2.50s/it]Best trial: 5. Best value: 0.517596:  30%|███       | 30/100 [01:35<02:54,  2.50s/it]Best trial: 5. Best value: 0.517596:  31%|███       | 31/100 [01:35<03:40,  3.20s/it]Best trial: 5. Best value: 0.517596:  31%|███       | 31/100 [01:40<03:40,  3.20s/it]Best trial: 5. Best value: 0.517596:  32%|███▏      | 32/100 [01:40<04:06,  3.62s/it]Best trial: 5. Best value: 0.517596:  32%|███▏      | 32/100 [01:44<04:06,  3.62s/it]Best trial: 5. Best value: 0.517596:  33%|███▎      | 33/100 [01:44<04:19,  3.87s/it]Best trial: 5. Best value: 0.517596:  33%|███▎      | 33/100 [01:47<04:19,  3.87s/it]Best trial: 5. Best value: 0.517596:  34%|███▍      | 34/100 [01:47<04:00,  3.64s/it]Best trial: 5. Best value: 0.517596:  34%|███▍      | 34/100 [01:49<04:00,  3.64s/it]Best trial: 5. Best value: 0.517596:  35%|███▌      | 35/100 [01:49<03:20,  3.09s/it]Best trial: 5. Best value: 0.517596:  35%|███▌      | 35/100 [01:57<03:20,  3.09s/it]Best trial: 5. Best value: 0.517596:  36%|███▌      | 36/100 [01:57<04:42,  4.41s/it]Best trial: 5. Best value: 0.517596:  36%|███▌      | 36/100 [01:58<04:42,  4.41s/it]Best trial: 5. Best value: 0.517596:  37%|███▋      | 37/100 [01:58<03:46,  3.60s/it]Best trial: 5. Best value: 0.517596:  37%|███▋      | 37/100 [02:02<03:46,  3.60s/it]Best trial: 5. Best value: 0.517596:  38%|███▊      | 38/100 [02:02<03:40,  3.56s/it]Best trial: 5. Best value: 0.517596:  38%|███▊      | 38/100 [02:04<03:40,  3.56s/it]Best trial: 5. Best value: 0.517596:  39%|███▉      | 39/100 [02:04<03:19,  3.27s/it]Best trial: 5. Best value: 0.517596:  39%|███▉      | 39/100 [02:06<03:19,  3.27s/it]Best trial: 5. Best value: 0.517596:  40%|████      | 40/100 [02:06<02:42,  2.71s/it]Best trial: 40. Best value: 0.521369:  40%|████      | 40/100 [02:12<02:42,  2.71s/it]Best trial: 40. Best value: 0.521369:  41%|████      | 41/100 [02:12<03:50,  3.90s/it]Best trial: 40. Best value: 0.521369:  41%|████      | 41/100 [02:18<03:50,  3.90s/it]Best trial: 40. Best value: 0.521369:  42%|████▏     | 42/100 [02:18<04:12,  4.36s/it]Best trial: 40. Best value: 0.521369:  42%|████▏     | 42/100 [02:23<04:12,  4.36s/it]Best trial: 40. Best value: 0.521369:  43%|████▎     | 43/100 [02:23<04:29,  4.73s/it]Best trial: 40. Best value: 0.521369:  43%|████▎     | 43/100 [02:28<04:29,  4.73s/it]Best trial: 40. Best value: 0.521369:  44%|████▍     | 44/100 [02:28<04:15,  4.56s/it]Best trial: 40. Best value: 0.521369:  44%|████▍     | 44/100 [02:33<04:15,  4.56s/it]Best trial: 40. Best value: 0.521369:  45%|████▌     | 45/100 [02:33<04:31,  4.94s/it]Best trial: 40. Best value: 0.521369:  45%|████▌     | 45/100 [02:42<04:31,  4.94s/it]Best trial: 40. Best value: 0.521369:  46%|████▌     | 46/100 [02:42<05:20,  5.94s/it]Best trial: 40. Best value: 0.521369:  46%|████▌     | 46/100 [02:48<05:20,  5.94s/it]Best trial: 40. Best value: 0.521369:  47%|████▋     | 47/100 [02:48<05:27,  6.17s/it]Best trial: 40. Best value: 0.521369:  47%|████▋     | 47/100 [02:52<05:27,  6.17s/it]Best trial: 40. Best value: 0.521369:  48%|████▊     | 48/100 [02:52<04:42,  5.43s/it]Best trial: 40. Best value: 0.521369:  48%|████▊     | 48/100 [02:59<04:42,  5.43s/it]Best trial: 40. Best value: 0.521369:  49%|████▉     | 49/100 [02:59<04:52,  5.73s/it]Best trial: 40. Best value: 0.521369:  49%|████▉     | 49/100 [03:07<04:52,  5.73s/it]Best trial: 40. Best value: 0.521369:  50%|█████     | 50/100 [03:07<05:19,  6.39s/it]Best trial: 40. Best value: 0.521369:  50%|█████     | 50/100 [03:12<05:19,  6.39s/it]Best trial: 40. Best value: 0.521369:  51%|█████     | 51/100 [03:12<04:53,  5.98s/it]Best trial: 51. Best value: 0.521415:  51%|█████     | 51/100 [03:18<04:53,  5.98s/it]Best trial: 51. Best value: 0.521415:  52%|█████▏    | 52/100 [03:18<04:53,  6.12s/it]Best trial: 51. Best value: 0.521415:  52%|█████▏    | 52/100 [03:26<04:53,  6.12s/it]Best trial: 51. Best value: 0.521415:  53%|█████▎    | 53/100 [03:26<05:08,  6.56s/it]Best trial: 53. Best value: 0.525536:  53%|█████▎    | 53/100 [03:32<05:08,  6.56s/it]Best trial: 53. Best value: 0.525536:  54%|█████▍    | 54/100 [03:32<05:06,  6.67s/it]Best trial: 53. Best value: 0.525536:  54%|█████▍    | 54/100 [03:40<05:06,  6.67s/it]Best trial: 53. Best value: 0.525536:  55%|█████▌    | 55/100 [03:40<05:09,  6.87s/it]Best trial: 53. Best value: 0.525536:  55%|█████▌    | 55/100 [03:48<05:09,  6.87s/it]Best trial: 53. Best value: 0.525536:  56%|█████▌    | 56/100 [03:48<05:19,  7.26s/it]Best trial: 53. Best value: 0.525536:  56%|█████▌    | 56/100 [03:53<05:19,  7.26s/it]Best trial: 53. Best value: 0.525536:  57%|█████▋    | 57/100 [03:53<04:47,  6.69s/it]Best trial: 53. Best value: 0.525536:  57%|█████▋    | 57/100 [04:00<04:47,  6.69s/it]Best trial: 53. Best value: 0.525536:  58%|█████▊    | 58/100 [04:00<04:39,  6.64s/it]Best trial: 53. Best value: 0.525536:  58%|█████▊    | 58/100 [04:04<04:39,  6.64s/it]Best trial: 53. Best value: 0.525536:  59%|█████▉    | 59/100 [04:04<04:02,  5.91s/it]Best trial: 53. Best value: 0.525536:  59%|█████▉    | 59/100 [04:11<04:02,  5.91s/it]Best trial: 53. Best value: 0.525536:  60%|██████    | 60/100 [04:11<04:08,  6.22s/it]Best trial: 53. Best value: 0.525536:  60%|██████    | 60/100 [04:15<04:08,  6.22s/it]Best trial: 53. Best value: 0.525536:  61%|██████    | 61/100 [04:15<03:40,  5.65s/it]Best trial: 53. Best value: 0.525536:  61%|██████    | 61/100 [04:21<03:40,  5.65s/it]Best trial: 53. Best value: 0.525536:  62%|██████▏   | 62/100 [04:21<03:38,  5.75s/it]Best trial: 53. Best value: 0.525536:  62%|██████▏   | 62/100 [04:28<03:38,  5.75s/it]Best trial: 53. Best value: 0.525536:  63%|██████▎   | 63/100 [04:28<03:37,  5.88s/it]Best trial: 53. Best value: 0.525536:  63%|██████▎   | 63/100 [04:32<03:37,  5.88s/it]Best trial: 53. Best value: 0.525536:  64%|██████▍   | 64/100 [04:32<03:21,  5.60s/it]Best trial: 53. Best value: 0.525536:  64%|██████▍   | 64/100 [04:39<03:21,  5.60s/it]Best trial: 53. Best value: 0.525536:  65%|██████▌   | 65/100 [04:39<03:27,  5.94s/it]Best trial: 53. Best value: 0.525536:  65%|██████▌   | 65/100 [04:45<03:27,  5.94s/it]Best trial: 53. Best value: 0.525536:  66%|██████▌   | 66/100 [04:45<03:20,  5.90s/it]Best trial: 53. Best value: 0.525536:  66%|██████▌   | 66/100 [04:51<03:20,  5.90s/it]Best trial: 53. Best value: 0.525536:  67%|██████▋   | 67/100 [04:51<03:18,  6.03s/it]Best trial: 53. Best value: 0.525536:  67%|██████▋   | 67/100 [04:53<03:18,  6.03s/it]Best trial: 53. Best value: 0.525536:  68%|██████▊   | 68/100 [04:53<02:28,  4.64s/it]Best trial: 53. Best value: 0.525536:  68%|██████▊   | 68/100 [05:02<02:28,  4.64s/it]Best trial: 53. Best value: 0.525536:  69%|██████▉   | 69/100 [05:02<03:04,  5.96s/it]Best trial: 53. Best value: 0.525536:  69%|██████▉   | 69/100 [05:07<03:04,  5.96s/it]Best trial: 53. Best value: 0.525536:  70%|███████   | 70/100 [05:07<02:54,  5.80s/it]Best trial: 53. Best value: 0.525536:  70%|███████   | 70/100 [05:12<02:54,  5.80s/it]Best trial: 53. Best value: 0.525536:  71%|███████   | 71/100 [05:12<02:37,  5.42s/it]Best trial: 53. Best value: 0.525536:  71%|███████   | 71/100 [05:15<02:37,  5.42s/it]Best trial: 53. Best value: 0.525536:  72%|███████▏  | 72/100 [05:15<02:16,  4.87s/it]Best trial: 53. Best value: 0.525536:  72%|███████▏  | 72/100 [05:19<02:16,  4.87s/it]Best trial: 53. Best value: 0.525536:  73%|███████▎  | 73/100 [05:19<02:03,  4.58s/it]Best trial: 53. Best value: 0.525536:  73%|███████▎  | 73/100 [05:25<02:03,  4.58s/it]Best trial: 53. Best value: 0.525536:  74%|███████▍  | 74/100 [05:25<02:08,  4.93s/it]Best trial: 53. Best value: 0.525536:  74%|███████▍  | 74/100 [05:29<02:08,  4.93s/it]Best trial: 53. Best value: 0.525536:  75%|███████▌  | 75/100 [05:29<01:54,  4.60s/it]Best trial: 53. Best value: 0.525536:  75%|███████▌  | 75/100 [05:33<01:54,  4.60s/it]Best trial: 53. Best value: 0.525536:  76%|███████▌  | 76/100 [05:33<01:44,  4.36s/it]Best trial: 53. Best value: 0.525536:  76%|███████▌  | 76/100 [05:36<01:44,  4.36s/it]Best trial: 53. Best value: 0.525536:  77%|███████▋  | 77/100 [05:36<01:32,  4.01s/it]Best trial: 53. Best value: 0.525536:  77%|███████▋  | 77/100 [05:42<01:32,  4.01s/it]Best trial: 53. Best value: 0.525536:  78%|███████▊  | 78/100 [05:42<01:41,  4.62s/it]Best trial: 53. Best value: 0.525536:  78%|███████▊  | 78/100 [05:46<01:41,  4.62s/it]Best trial: 53. Best value: 0.525536:  79%|███████▉  | 79/100 [05:46<01:36,  4.60s/it]Best trial: 53. Best value: 0.525536:  79%|███████▉  | 79/100 [05:52<01:36,  4.60s/it]Best trial: 53. Best value: 0.525536:  80%|████████  | 80/100 [05:52<01:36,  4.82s/it]Best trial: 53. Best value: 0.525536:  80%|████████  | 80/100 [06:00<01:36,  4.82s/it]Best trial: 53. Best value: 0.525536:  81%|████████  | 81/100 [06:00<01:49,  5.76s/it]Best trial: 53. Best value: 0.525536:  81%|████████  | 81/100 [06:04<01:49,  5.76s/it]Best trial: 53. Best value: 0.525536:  82%|████████▏ | 82/100 [06:04<01:37,  5.39s/it]Best trial: 53. Best value: 0.525536:  82%|████████▏ | 82/100 [06:12<01:37,  5.39s/it]Best trial: 53. Best value: 0.525536:  83%|████████▎ | 83/100 [06:12<01:45,  6.21s/it]Best trial: 53. Best value: 0.525536:  83%|████████▎ | 83/100 [06:18<01:45,  6.21s/it]Best trial: 53. Best value: 0.525536:  84%|████████▍ | 84/100 [06:18<01:35,  5.95s/it]Best trial: 53. Best value: 0.525536:  84%|████████▍ | 84/100 [06:24<01:35,  5.95s/it]Best trial: 53. Best value: 0.525536:  85%|████████▌ | 85/100 [06:24<01:29,  5.94s/it]Best trial: 53. Best value: 0.525536:  85%|████████▌ | 85/100 [06:28<01:29,  5.94s/it]Best trial: 53. Best value: 0.525536:  86%|████████▌ | 86/100 [06:28<01:16,  5.43s/it]Best trial: 53. Best value: 0.525536:  86%|████████▌ | 86/100 [06:33<01:16,  5.43s/it]Best trial: 53. Best value: 0.525536:  87%|████████▋ | 87/100 [06:33<01:09,  5.35s/it]Best trial: 53. Best value: 0.525536:  87%|████████▋ | 87/100 [06:38<01:09,  5.35s/it]Best trial: 53. Best value: 0.525536:  88%|████████▊ | 88/100 [06:38<01:04,  5.39s/it]Best trial: 53. Best value: 0.525536:  88%|████████▊ | 88/100 [06:44<01:04,  5.39s/it]Best trial: 53. Best value: 0.525536:  89%|████████▉ | 89/100 [06:44<00:59,  5.39s/it]Best trial: 53. Best value: 0.525536:  89%|████████▉ | 89/100 [06:45<00:59,  5.39s/it]Best trial: 53. Best value: 0.525536:  90%|█████████ | 90/100 [06:45<00:40,  4.07s/it]Best trial: 53. Best value: 0.525536:  90%|█████████ | 90/100 [06:47<00:40,  4.07s/it]Best trial: 53. Best value: 0.525536:  91%|█████████ | 91/100 [06:47<00:30,  3.37s/it]Best trial: 53. Best value: 0.525536:  91%|█████████ | 91/100 [06:51<00:30,  3.37s/it]Best trial: 53. Best value: 0.525536:  92%|█████████▏| 92/100 [06:51<00:28,  3.59s/it]Best trial: 53. Best value: 0.525536:  92%|█████████▏| 92/100 [06:55<00:28,  3.59s/it]Best trial: 53. Best value: 0.525536:  93%|█████████▎| 93/100 [06:55<00:26,  3.78s/it]Best trial: 53. Best value: 0.525536:  93%|█████████▎| 93/100 [07:01<00:26,  3.78s/it]Best trial: 53. Best value: 0.525536:  94%|█████████▍| 94/100 [07:01<00:26,  4.40s/it]Best trial: 53. Best value: 0.525536:  94%|█████████▍| 94/100 [07:05<00:26,  4.40s/it]Best trial: 53. Best value: 0.525536:  95%|█████████▌| 95/100 [07:05<00:21,  4.33s/it]Best trial: 53. Best value: 0.525536:  95%|█████████▌| 95/100 [07:10<00:21,  4.33s/it]Best trial: 53. Best value: 0.525536:  96%|█████████▌| 96/100 [07:10<00:18,  4.56s/it]Best trial: 53. Best value: 0.525536:  96%|█████████▌| 96/100 [07:15<00:18,  4.56s/it]Best trial: 53. Best value: 0.525536:  97%|█████████▋| 97/100 [07:15<00:14,  4.80s/it]Best trial: 53. Best value: 0.525536:  97%|█████████▋| 97/100 [07:20<00:14,  4.80s/it]Best trial: 53. Best value: 0.525536:  98%|█████████▊| 98/100 [07:20<00:09,  4.65s/it]Best trial: 53. Best value: 0.525536:  98%|█████████▊| 98/100 [07:26<00:09,  4.65s/it]Best trial: 53. Best value: 0.525536:  99%|█████████▉| 99/100 [07:26<00:05,  5.08s/it]Best trial: 53. Best value: 0.525536:  99%|█████████▉| 99/100 [07:33<00:05,  5.08s/it]Best trial: 53. Best value: 0.525536: 100%|██████████| 100/100 [07:33<00:00,  5.85s/it]Best trial: 53. Best value: 0.525536: 100%|██████████| 100/100 [07:33<00:00,  4.54s/it]
2025-11-30 17:53:16,862 - INFO - HPO Complete. Best AUPRC: 0.5255
2025-11-30 17:53:16,862 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.00015680325040776864, 'max_depth': 10, 'subsample': 0.7697344879489655, 'colsample_bytree': 0.6370326727461497, 'gamma': 0.8291393343899907, 'reg_lambda': 0.00020299601811494977, 'reg_alpha': 8.263012249141886e-07}
2025-11-30 17:53:16,863 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:53:18,977 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: ventilator_only
2025-11-30 17:53:18,977 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:53:19,073 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:53:19,084 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:53:19,087 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 17:53:19,087 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:53:19,087 - INFO - Training model...
2025-11-30 17:53:27,292 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:53:32,133 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:53:32,133 - INFO - AUROC: 0.7135 (0.6776 - 0.7705)
2025-11-30 17:53:32,133 - INFO - AUPRC: 0.4184 (0.3648 - 0.5019)
2025-11-30 17:53:32,133 - INFO - Brier Score: 0.2352 (0.2337 - 0.2360)
2025-11-30 17:53:32,133 - INFO - Accuracy: 0.6431 (0.6231 - 0.7526)
2025-11-30 17:53:32,133 - INFO - Precision: 0.3550 (0.3213 - 0.4991)
2025-11-30 17:53:32,133 - INFO - Sensitivity (Recall): 0.6899 (0.5457 - 0.7590)
2025-11-30 17:53:32,133 - INFO - F1-Score: 0.4688 (0.4302 - 0.5341)
2025-11-30 17:53:32,133 - INFO - Best Threshold: 0.4800 (0.4800 - 0.4900)
2025-11-30 17:53:32,133 - INFO - Specificity: 0.6292 (0.6076 - 0.8107)
2025-11-30 17:53:32,288 - INFO - Calculating SHAP values...
2025-11-30 17:53:36,174 - INFO - SHAP plots saved.
2025-11-30 17:53:36,177 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:53:37,438 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 17:53:37,438 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:53:37,528 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:53:37,540 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:53:37,542 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 17:53:37,543 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.409905:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.409905:   1%|          | 1/100 [00:02<03:50,  2.33s/it]Best trial: 1. Best value: 0.427449:   1%|          | 1/100 [00:04<03:50,  2.33s/it]Best trial: 1. Best value: 0.427449:   2%|▏         | 2/100 [00:04<03:41,  2.26s/it]Best trial: 2. Best value: 0.429912:   2%|▏         | 2/100 [00:05<03:41,  2.26s/it]Best trial: 2. Best value: 0.429912:   3%|▎         | 3/100 [00:05<03:02,  1.88s/it]Best trial: 3. Best value: 0.430147:   3%|▎         | 3/100 [00:10<03:02,  1.88s/it]Best trial: 3. Best value: 0.430147:   4%|▍         | 4/100 [00:10<04:24,  2.76s/it]Best trial: 4. Best value: 0.435876:   4%|▍         | 4/100 [00:15<04:24,  2.76s/it]Best trial: 4. Best value: 0.435876:   5%|▌         | 5/100 [00:15<06:02,  3.81s/it]Best trial: 4. Best value: 0.435876:   5%|▌         | 5/100 [00:20<06:02,  3.81s/it]Best trial: 4. Best value: 0.435876:   6%|▌         | 6/100 [00:20<06:13,  3.98s/it]Best trial: 4. Best value: 0.435876:   6%|▌         | 6/100 [00:23<06:13,  3.98s/it]Best trial: 4. Best value: 0.435876:   7%|▋         | 7/100 [00:23<05:43,  3.69s/it]Best trial: 4. Best value: 0.435876:   7%|▋         | 7/100 [00:24<05:43,  3.69s/it]Best trial: 4. Best value: 0.435876:   8%|▊         | 8/100 [00:24<04:39,  3.03s/it]Best trial: 4. Best value: 0.435876:   8%|▊         | 8/100 [00:29<04:39,  3.03s/it]Best trial: 4. Best value: 0.435876:   9%|▉         | 9/100 [00:29<05:15,  3.47s/it]Best trial: 4. Best value: 0.435876:   9%|▉         | 9/100 [00:31<05:15,  3.47s/it]Best trial: 4. Best value: 0.435876:  10%|█         | 10/100 [00:31<04:35,  3.06s/it]Best trial: 4. Best value: 0.435876:  10%|█         | 10/100 [00:35<04:35,  3.06s/it]Best trial: 4. Best value: 0.435876:  11%|█         | 11/100 [00:35<04:54,  3.31s/it]Best trial: 4. Best value: 0.435876:  11%|█         | 11/100 [00:40<04:54,  3.31s/it]Best trial: 4. Best value: 0.435876:  12%|█▏        | 12/100 [00:40<05:46,  3.94s/it]Best trial: 4. Best value: 0.435876:  12%|█▏        | 12/100 [00:44<05:46,  3.94s/it]Best trial: 4. Best value: 0.435876:  13%|█▎        | 13/100 [00:44<05:35,  3.85s/it]Best trial: 4. Best value: 0.435876:  13%|█▎        | 13/100 [00:47<05:35,  3.85s/it]Best trial: 4. Best value: 0.435876:  14%|█▍        | 14/100 [00:47<05:26,  3.80s/it]Best trial: 4. Best value: 0.435876:  14%|█▍        | 14/100 [00:49<05:26,  3.80s/it]Best trial: 4. Best value: 0.435876:  15%|█▌        | 15/100 [00:49<04:33,  3.21s/it]Best trial: 4. Best value: 0.435876:  15%|█▌        | 15/100 [00:55<04:33,  3.21s/it]Best trial: 4. Best value: 0.435876:  16%|█▌        | 16/100 [00:55<05:26,  3.88s/it]Best trial: 16. Best value: 0.443293:  16%|█▌        | 16/100 [00:56<05:26,  3.88s/it]Best trial: 16. Best value: 0.443293:  17%|█▋        | 17/100 [00:56<04:25,  3.20s/it]Best trial: 17. Best value: 0.444818:  17%|█▋        | 17/100 [00:58<04:25,  3.20s/it]Best trial: 17. Best value: 0.444818:  18%|█▊        | 18/100 [00:58<03:49,  2.80s/it]Best trial: 17. Best value: 0.444818:  18%|█▊        | 18/100 [01:00<03:49,  2.80s/it]Best trial: 17. Best value: 0.444818:  19%|█▉        | 19/100 [01:00<03:22,  2.50s/it]Best trial: 17. Best value: 0.444818:  19%|█▉        | 19/100 [01:02<03:22,  2.50s/it]Best trial: 17. Best value: 0.444818:  20%|██        | 20/100 [01:02<02:57,  2.22s/it]Best trial: 17. Best value: 0.444818:  20%|██        | 20/100 [01:04<02:57,  2.22s/it]Best trial: 17. Best value: 0.444818:  21%|██        | 21/100 [01:04<02:50,  2.15s/it]Best trial: 17. Best value: 0.444818:  21%|██        | 21/100 [01:05<02:50,  2.15s/it]Best trial: 17. Best value: 0.444818:  22%|██▏       | 22/100 [01:05<02:32,  1.95s/it]Best trial: 17. Best value: 0.444818:  22%|██▏       | 22/100 [01:08<02:32,  1.95s/it]Best trial: 17. Best value: 0.444818:  23%|██▎       | 23/100 [01:08<02:48,  2.19s/it]Best trial: 17. Best value: 0.444818:  23%|██▎       | 23/100 [01:11<02:48,  2.19s/it]Best trial: 17. Best value: 0.444818:  24%|██▍       | 24/100 [01:11<03:00,  2.38s/it]Best trial: 17. Best value: 0.444818:  24%|██▍       | 24/100 [01:14<03:00,  2.38s/it]Best trial: 17. Best value: 0.444818:  25%|██▌       | 25/100 [01:14<03:11,  2.55s/it]Best trial: 17. Best value: 0.444818:  25%|██▌       | 25/100 [01:15<03:11,  2.55s/it]Best trial: 17. Best value: 0.444818:  26%|██▌       | 26/100 [01:15<02:49,  2.29s/it]Best trial: 17. Best value: 0.444818:  26%|██▌       | 26/100 [01:17<02:49,  2.29s/it]Best trial: 17. Best value: 0.444818:  27%|██▋       | 27/100 [01:17<02:35,  2.14s/it]Best trial: 17. Best value: 0.444818:  27%|██▋       | 27/100 [01:18<02:35,  2.14s/it]Best trial: 17. Best value: 0.444818:  28%|██▊       | 28/100 [01:18<02:18,  1.92s/it]Best trial: 17. Best value: 0.444818:  28%|██▊       | 28/100 [01:20<02:18,  1.92s/it]Best trial: 17. Best value: 0.444818:  29%|██▉       | 29/100 [01:20<02:11,  1.86s/it]Best trial: 17. Best value: 0.444818:  29%|██▉       | 29/100 [01:22<02:11,  1.86s/it]Best trial: 17. Best value: 0.444818:  30%|███       | 30/100 [01:22<02:08,  1.84s/it]Best trial: 17. Best value: 0.444818:  30%|███       | 30/100 [01:24<02:08,  1.84s/it]Best trial: 17. Best value: 0.444818:  31%|███       | 31/100 [01:24<02:13,  1.93s/it]Best trial: 17. Best value: 0.444818:  31%|███       | 31/100 [01:26<02:13,  1.93s/it]Best trial: 17. Best value: 0.444818:  32%|███▏      | 32/100 [01:26<02:06,  1.87s/it]Best trial: 17. Best value: 0.444818:  32%|███▏      | 32/100 [01:28<02:06,  1.87s/it]Best trial: 17. Best value: 0.444818:  33%|███▎      | 33/100 [01:28<02:08,  1.91s/it]Best trial: 17. Best value: 0.444818:  33%|███▎      | 33/100 [01:29<02:08,  1.91s/it]Best trial: 17. Best value: 0.444818:  34%|███▍      | 34/100 [01:29<01:53,  1.72s/it]Best trial: 17. Best value: 0.444818:  34%|███▍      | 34/100 [01:31<01:53,  1.72s/it]Best trial: 17. Best value: 0.444818:  35%|███▌      | 35/100 [01:31<02:00,  1.85s/it]Best trial: 35. Best value: 0.45108:  35%|███▌      | 35/100 [01:33<02:00,  1.85s/it] Best trial: 35. Best value: 0.45108:  36%|███▌      | 36/100 [01:33<01:52,  1.76s/it]Best trial: 35. Best value: 0.45108:  36%|███▌      | 36/100 [01:34<01:52,  1.76s/it]Best trial: 35. Best value: 0.45108:  37%|███▋      | 37/100 [01:34<01:48,  1.73s/it]Best trial: 35. Best value: 0.45108:  37%|███▋      | 37/100 [01:36<01:48,  1.73s/it]Best trial: 35. Best value: 0.45108:  38%|███▊      | 38/100 [01:36<01:42,  1.65s/it]Best trial: 35. Best value: 0.45108:  38%|███▊      | 38/100 [01:37<01:42,  1.65s/it]Best trial: 35. Best value: 0.45108:  39%|███▉      | 39/100 [01:37<01:34,  1.56s/it]Best trial: 35. Best value: 0.45108:  39%|███▉      | 39/100 [01:39<01:34,  1.56s/it]Best trial: 35. Best value: 0.45108:  40%|████      | 40/100 [01:39<01:32,  1.55s/it]Best trial: 35. Best value: 0.45108:  40%|████      | 40/100 [01:41<01:32,  1.55s/it]Best trial: 35. Best value: 0.45108:  41%|████      | 41/100 [01:41<01:40,  1.70s/it]Best trial: 35. Best value: 0.45108:  41%|████      | 41/100 [01:43<01:40,  1.70s/it]Best trial: 35. Best value: 0.45108:  42%|████▏     | 42/100 [01:43<01:40,  1.73s/it]Best trial: 35. Best value: 0.45108:  42%|████▏     | 42/100 [01:45<01:40,  1.73s/it]Best trial: 35. Best value: 0.45108:  43%|████▎     | 43/100 [01:45<01:41,  1.78s/it]Best trial: 35. Best value: 0.45108:  43%|████▎     | 43/100 [01:46<01:41,  1.78s/it]Best trial: 35. Best value: 0.45108:  44%|████▍     | 44/100 [01:46<01:33,  1.66s/it]Best trial: 35. Best value: 0.45108:  44%|████▍     | 44/100 [01:48<01:33,  1.66s/it]Best trial: 35. Best value: 0.45108:  45%|████▌     | 45/100 [01:48<01:37,  1.78s/it]Best trial: 35. Best value: 0.45108:  45%|████▌     | 45/100 [01:49<01:37,  1.78s/it]Best trial: 35. Best value: 0.45108:  46%|████▌     | 46/100 [01:49<01:30,  1.67s/it]Best trial: 35. Best value: 0.45108:  46%|████▌     | 46/100 [01:51<01:30,  1.67s/it]Best trial: 35. Best value: 0.45108:  47%|████▋     | 47/100 [01:51<01:22,  1.55s/it]Best trial: 35. Best value: 0.45108:  47%|████▋     | 47/100 [01:52<01:22,  1.55s/it]Best trial: 35. Best value: 0.45108:  48%|████▊     | 48/100 [01:52<01:16,  1.47s/it]Best trial: 35. Best value: 0.45108:  48%|████▊     | 48/100 [01:53<01:16,  1.47s/it]Best trial: 35. Best value: 0.45108:  49%|████▉     | 49/100 [01:53<01:08,  1.34s/it]Best trial: 35. Best value: 0.45108:  49%|████▉     | 49/100 [01:55<01:08,  1.34s/it]Best trial: 35. Best value: 0.45108:  50%|█████     | 50/100 [01:55<01:15,  1.51s/it]Best trial: 35. Best value: 0.45108:  50%|█████     | 50/100 [01:56<01:15,  1.51s/it]Best trial: 35. Best value: 0.45108:  51%|█████     | 51/100 [01:56<01:13,  1.50s/it]Best trial: 51. Best value: 0.45324:  51%|█████     | 51/100 [01:58<01:13,  1.50s/it]Best trial: 51. Best value: 0.45324:  52%|█████▏    | 52/100 [01:58<01:13,  1.54s/it]Best trial: 51. Best value: 0.45324:  52%|█████▏    | 52/100 [02:00<01:13,  1.54s/it]Best trial: 51. Best value: 0.45324:  53%|█████▎    | 53/100 [02:00<01:14,  1.58s/it]Best trial: 51. Best value: 0.45324:  53%|█████▎    | 53/100 [02:01<01:14,  1.58s/it]Best trial: 51. Best value: 0.45324:  54%|█████▍    | 54/100 [02:01<01:10,  1.52s/it]Best trial: 51. Best value: 0.45324:  54%|█████▍    | 54/100 [02:02<01:10,  1.52s/it]Best trial: 51. Best value: 0.45324:  55%|█████▌    | 55/100 [02:02<01:05,  1.46s/it]Best trial: 55. Best value: 0.454229:  55%|█████▌    | 55/100 [02:04<01:05,  1.46s/it]Best trial: 55. Best value: 0.454229:  56%|█████▌    | 56/100 [02:04<01:07,  1.55s/it]Best trial: 55. Best value: 0.454229:  56%|█████▌    | 56/100 [02:06<01:07,  1.55s/it]Best trial: 55. Best value: 0.454229:  57%|█████▋    | 57/100 [02:06<01:08,  1.59s/it]Best trial: 55. Best value: 0.454229:  57%|█████▋    | 57/100 [02:07<01:08,  1.59s/it]Best trial: 55. Best value: 0.454229:  58%|█████▊    | 58/100 [02:07<01:02,  1.48s/it]Best trial: 55. Best value: 0.454229:  58%|█████▊    | 58/100 [02:08<01:02,  1.48s/it]Best trial: 55. Best value: 0.454229:  59%|█████▉    | 59/100 [02:08<00:59,  1.45s/it]Best trial: 55. Best value: 0.454229:  59%|█████▉    | 59/100 [02:10<00:59,  1.45s/it]Best trial: 55. Best value: 0.454229:  60%|██████    | 60/100 [02:10<00:56,  1.40s/it]Best trial: 55. Best value: 0.454229:  60%|██████    | 60/100 [02:11<00:56,  1.40s/it]Best trial: 55. Best value: 0.454229:  61%|██████    | 61/100 [02:11<00:53,  1.38s/it]Best trial: 55. Best value: 0.454229:  61%|██████    | 61/100 [02:12<00:53,  1.38s/it]Best trial: 55. Best value: 0.454229:  62%|██████▏   | 62/100 [02:12<00:49,  1.32s/it]Best trial: 55. Best value: 0.454229:  62%|██████▏   | 62/100 [02:14<00:49,  1.32s/it]Best trial: 55. Best value: 0.454229:  63%|██████▎   | 63/100 [02:14<00:52,  1.43s/it]Best trial: 55. Best value: 0.454229:  63%|██████▎   | 63/100 [02:17<00:52,  1.43s/it]Best trial: 55. Best value: 0.454229:  64%|██████▍   | 64/100 [02:17<01:06,  1.84s/it]Best trial: 55. Best value: 0.454229:  64%|██████▍   | 64/100 [02:18<01:06,  1.84s/it]Best trial: 55. Best value: 0.454229:  65%|██████▌   | 65/100 [02:18<01:01,  1.75s/it]Best trial: 55. Best value: 0.454229:  65%|██████▌   | 65/100 [02:20<01:01,  1.75s/it]Best trial: 55. Best value: 0.454229:  66%|██████▌   | 66/100 [02:20<01:00,  1.78s/it]Best trial: 55. Best value: 0.454229:  66%|██████▌   | 66/100 [02:21<01:00,  1.78s/it]Best trial: 55. Best value: 0.454229:  67%|██████▋   | 67/100 [02:21<00:52,  1.60s/it]Best trial: 55. Best value: 0.454229:  67%|██████▋   | 67/100 [02:23<00:52,  1.60s/it]Best trial: 55. Best value: 0.454229:  68%|██████▊   | 68/100 [02:23<00:50,  1.59s/it]Best trial: 55. Best value: 0.454229:  68%|██████▊   | 68/100 [02:25<00:50,  1.59s/it]Best trial: 55. Best value: 0.454229:  69%|██████▉   | 69/100 [02:25<00:50,  1.63s/it]Best trial: 55. Best value: 0.454229:  69%|██████▉   | 69/100 [02:26<00:50,  1.63s/it]Best trial: 55. Best value: 0.454229:  70%|███████   | 70/100 [02:26<00:44,  1.47s/it]Best trial: 55. Best value: 0.454229:  70%|███████   | 70/100 [02:27<00:44,  1.47s/it]Best trial: 55. Best value: 0.454229:  71%|███████   | 71/100 [02:27<00:42,  1.47s/it]Best trial: 55. Best value: 0.454229:  71%|███████   | 71/100 [02:29<00:42,  1.47s/it]Best trial: 55. Best value: 0.454229:  72%|███████▏  | 72/100 [02:29<00:43,  1.55s/it]Best trial: 55. Best value: 0.454229:  72%|███████▏  | 72/100 [02:30<00:43,  1.55s/it]Best trial: 55. Best value: 0.454229:  73%|███████▎  | 73/100 [02:30<00:41,  1.53s/it]Best trial: 55. Best value: 0.454229:  73%|███████▎  | 73/100 [02:32<00:41,  1.53s/it]Best trial: 55. Best value: 0.454229:  74%|███████▍  | 74/100 [02:32<00:38,  1.49s/it]Best trial: 55. Best value: 0.454229:  74%|███████▍  | 74/100 [02:34<00:38,  1.49s/it]Best trial: 55. Best value: 0.454229:  75%|███████▌  | 75/100 [02:34<00:41,  1.64s/it]Best trial: 55. Best value: 0.454229:  75%|███████▌  | 75/100 [02:35<00:41,  1.64s/it]Best trial: 55. Best value: 0.454229:  76%|███████▌  | 76/100 [02:35<00:39,  1.65s/it]Best trial: 55. Best value: 0.454229:  76%|███████▌  | 76/100 [02:37<00:39,  1.65s/it]Best trial: 55. Best value: 0.454229:  77%|███████▋  | 77/100 [02:37<00:35,  1.56s/it]Best trial: 55. Best value: 0.454229:  77%|███████▋  | 77/100 [02:38<00:35,  1.56s/it]Best trial: 55. Best value: 0.454229:  78%|███████▊  | 78/100 [02:38<00:32,  1.50s/it]Best trial: 55. Best value: 0.454229:  78%|███████▊  | 78/100 [02:40<00:32,  1.50s/it]Best trial: 55. Best value: 0.454229:  79%|███████▉  | 79/100 [02:40<00:33,  1.59s/it]Best trial: 55. Best value: 0.454229:  79%|███████▉  | 79/100 [02:42<00:33,  1.59s/it]Best trial: 55. Best value: 0.454229:  80%|████████  | 80/100 [02:42<00:36,  1.81s/it]Best trial: 55. Best value: 0.454229:  80%|████████  | 80/100 [02:44<00:36,  1.81s/it]Best trial: 55. Best value: 0.454229:  81%|████████  | 81/100 [02:44<00:34,  1.79s/it]Best trial: 55. Best value: 0.454229:  81%|████████  | 81/100 [02:46<00:34,  1.79s/it]Best trial: 55. Best value: 0.454229:  82%|████████▏ | 82/100 [02:46<00:34,  1.91s/it]Best trial: 55. Best value: 0.454229:  82%|████████▏ | 82/100 [02:48<00:34,  1.91s/it]Best trial: 55. Best value: 0.454229:  83%|████████▎ | 83/100 [02:48<00:32,  1.88s/it]Best trial: 55. Best value: 0.454229:  83%|████████▎ | 83/100 [02:50<00:32,  1.88s/it]Best trial: 55. Best value: 0.454229:  84%|████████▍ | 84/100 [02:50<00:32,  2.06s/it]Best trial: 55. Best value: 0.454229:  84%|████████▍ | 84/100 [02:54<00:32,  2.06s/it]Best trial: 55. Best value: 0.454229:  85%|████████▌ | 85/100 [02:54<00:36,  2.40s/it]Best trial: 55. Best value: 0.454229:  85%|████████▌ | 85/100 [02:56<00:36,  2.40s/it]Best trial: 55. Best value: 0.454229:  86%|████████▌ | 86/100 [02:56<00:31,  2.25s/it]Best trial: 55. Best value: 0.454229:  86%|████████▌ | 86/100 [02:57<00:31,  2.25s/it]Best trial: 55. Best value: 0.454229:  87%|████████▋ | 87/100 [02:57<00:27,  2.13s/it]Best trial: 55. Best value: 0.454229:  87%|████████▋ | 87/100 [02:59<00:27,  2.13s/it]Best trial: 55. Best value: 0.454229:  88%|████████▊ | 88/100 [02:59<00:24,  2.03s/it]Best trial: 55. Best value: 0.454229:  88%|████████▊ | 88/100 [03:01<00:24,  2.03s/it]Best trial: 55. Best value: 0.454229:  89%|████████▉ | 89/100 [03:01<00:22,  2.04s/it]Best trial: 55. Best value: 0.454229:  89%|████████▉ | 89/100 [03:03<00:22,  2.04s/it]Best trial: 55. Best value: 0.454229:  90%|█████████ | 90/100 [03:03<00:19,  1.93s/it]Best trial: 55. Best value: 0.454229:  90%|█████████ | 90/100 [03:04<00:19,  1.93s/it]Best trial: 55. Best value: 0.454229:  91%|█████████ | 91/100 [03:04<00:16,  1.78s/it]Best trial: 55. Best value: 0.454229:  91%|█████████ | 91/100 [03:07<00:16,  1.78s/it]Best trial: 55. Best value: 0.454229:  92%|█████████▏| 92/100 [03:07<00:15,  1.99s/it]Best trial: 55. Best value: 0.454229:  92%|█████████▏| 92/100 [03:09<00:15,  1.99s/it]Best trial: 55. Best value: 0.454229:  93%|█████████▎| 93/100 [03:09<00:14,  2.06s/it]Best trial: 55. Best value: 0.454229:  93%|█████████▎| 93/100 [03:12<00:14,  2.06s/it]Best trial: 55. Best value: 0.454229:  94%|█████████▍| 94/100 [03:12<00:13,  2.29s/it]Best trial: 55. Best value: 0.454229:  94%|█████████▍| 94/100 [03:14<00:13,  2.29s/it]Best trial: 55. Best value: 0.454229:  95%|█████████▌| 95/100 [03:14<00:11,  2.23s/it]Best trial: 95. Best value: 0.455133:  95%|█████████▌| 95/100 [03:15<00:11,  2.23s/it]Best trial: 95. Best value: 0.455133:  96%|█████████▌| 96/100 [03:15<00:08,  2.01s/it]Best trial: 95. Best value: 0.455133:  96%|█████████▌| 96/100 [03:17<00:08,  2.01s/it]Best trial: 95. Best value: 0.455133:  97%|█████████▋| 97/100 [03:17<00:05,  1.90s/it]Best trial: 95. Best value: 0.455133:  97%|█████████▋| 97/100 [03:19<00:05,  1.90s/it]Best trial: 95. Best value: 0.455133:  98%|█████████▊| 98/100 [03:19<00:03,  1.77s/it]Best trial: 95. Best value: 0.455133:  98%|█████████▊| 98/100 [03:20<00:03,  1.77s/it]Best trial: 95. Best value: 0.455133:  99%|█████████▉| 99/100 [03:20<00:01,  1.55s/it]Best trial: 95. Best value: 0.455133:  99%|█████████▉| 99/100 [03:21<00:01,  1.55s/it]Best trial: 95. Best value: 0.455133: 100%|██████████| 100/100 [03:21<00:00,  1.52s/it]Best trial: 95. Best value: 0.455133: 100%|██████████| 100/100 [03:21<00:00,  2.02s/it]
2025-11-30 17:56:59,123 - INFO - HPO Complete. Best AUPRC: 0.4551
2025-11-30 17:56:59,123 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.03775401689414905, 'max_depth': 4, 'subsample': 0.6429154966142934, 'colsample_bytree': 0.6380559021249922, 'gamma': 4.696497143397086, 'reg_lambda': 0.0017722224670002043, 'reg_alpha': 0.00047360074780459865}
2025-11-30 17:56:59,124 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 17:57:01,114 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: monitors_only
2025-11-30 17:57:01,114 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:57:01,209 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:57:01,222 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:57:01,225 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-11-30 17:57:01,225 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 17:57:01,225 - INFO - Training model...
2025-11-30 17:57:02,221 - INFO - Evaluating model with bootstrapping...
2025-11-30 17:57:07,108 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 17:57:07,108 - INFO - AUROC: 0.6779 (0.6248 - 0.6997)
2025-11-30 17:57:07,109 - INFO - AUPRC: 0.3974 (0.3303 - 0.4447)
2025-11-30 17:57:07,109 - INFO - Brier Score: 0.1889 (0.1775 - 0.2002)
2025-11-30 17:57:07,109 - INFO - Accuracy: 0.5448 (0.4399 - 0.7535)
2025-11-30 17:57:07,109 - INFO - Precision: 0.3042 (0.2632 - 0.4266)
2025-11-30 17:57:07,109 - INFO - Sensitivity (Recall): 0.7722 (0.4431 - 0.9246)
2025-11-30 17:57:07,109 - INFO - F1-Score: 0.4365 (0.3912 - 0.4863)
2025-11-30 17:57:07,109 - INFO - Best Threshold: 0.2700 (0.1800 - 0.5040)
2025-11-30 17:57:07,109 - INFO - Specificity: 0.4775 (0.3039 - 0.8347)
2025-11-30 17:57:07,122 - INFO - Calculating SHAP values...
2025-11-30 17:57:08,217 - INFO - SHAP plots saved.
2025-11-30 17:57:08,220 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 17:57:09,554 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 17:57:09,554 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 17:57:09,641 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 17:57:09,665 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 17:57:09,678 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 17:57:09,678 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.57216:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.57216:   1%|          | 1/100 [00:03<05:14,  3.18s/it]Best trial: 0. Best value: 0.57216:   1%|          | 1/100 [00:04<05:14,  3.18s/it]Best trial: 0. Best value: 0.57216:   2%|▏         | 2/100 [00:04<03:52,  2.37s/it]Best trial: 0. Best value: 0.57216:   2%|▏         | 2/100 [00:07<03:52,  2.37s/it]Best trial: 0. Best value: 0.57216:   3%|▎         | 3/100 [00:07<03:45,  2.33s/it]Best trial: 0. Best value: 0.57216:   3%|▎         | 3/100 [00:12<03:45,  2.33s/it]Best trial: 0. Best value: 0.57216:   4%|▍         | 4/100 [00:12<05:35,  3.50s/it]Best trial: 0. Best value: 0.57216:   4%|▍         | 4/100 [00:14<05:35,  3.50s/it]Best trial: 0. Best value: 0.57216:   5%|▌         | 5/100 [00:14<04:48,  3.03s/it]Best trial: 0. Best value: 0.57216:   5%|▌         | 5/100 [00:16<04:48,  3.03s/it]Best trial: 0. Best value: 0.57216:   6%|▌         | 6/100 [00:16<04:19,  2.76s/it]Best trial: 0. Best value: 0.57216:   6%|▌         | 6/100 [00:18<04:19,  2.76s/it]Best trial: 0. Best value: 0.57216:   7%|▋         | 7/100 [00:18<03:50,  2.47s/it]Best trial: 7. Best value: 0.581272:   7%|▋         | 7/100 [00:24<03:50,  2.47s/it]Best trial: 7. Best value: 0.581272:   8%|▊         | 8/100 [00:24<05:18,  3.46s/it]Best trial: 7. Best value: 0.581272:   8%|▊         | 8/100 [00:26<05:18,  3.46s/it]Best trial: 7. Best value: 0.581272:   9%|▉         | 9/100 [00:26<04:39,  3.08s/it]Best trial: 7. Best value: 0.581272:   9%|▉         | 9/100 [00:28<04:39,  3.08s/it]Best trial: 7. Best value: 0.581272:  10%|█         | 10/100 [00:28<03:57,  2.64s/it]Best trial: 10. Best value: 0.593164:  10%|█         | 10/100 [00:33<03:57,  2.64s/it]Best trial: 10. Best value: 0.593164:  11%|█         | 11/100 [00:33<05:07,  3.46s/it]Best trial: 10. Best value: 0.593164:  11%|█         | 11/100 [00:37<05:07,  3.46s/it]Best trial: 10. Best value: 0.593164:  12%|█▏        | 12/100 [00:37<05:06,  3.48s/it]Best trial: 10. Best value: 0.593164:  12%|█▏        | 12/100 [00:42<05:06,  3.48s/it]Best trial: 10. Best value: 0.593164:  13%|█▎        | 13/100 [00:42<05:39,  3.90s/it]Best trial: 10. Best value: 0.593164:  13%|█▎        | 13/100 [00:47<05:39,  3.90s/it]Best trial: 10. Best value: 0.593164:  14%|█▍        | 14/100 [00:47<06:14,  4.35s/it]Best trial: 10. Best value: 0.593164:  14%|█▍        | 14/100 [00:52<06:14,  4.35s/it]Best trial: 10. Best value: 0.593164:  15%|█▌        | 15/100 [00:52<06:31,  4.60s/it]Best trial: 10. Best value: 0.593164:  15%|█▌        | 15/100 [00:55<06:31,  4.60s/it]Best trial: 10. Best value: 0.593164:  16%|█▌        | 16/100 [00:55<05:41,  4.07s/it]Best trial: 10. Best value: 0.593164:  16%|█▌        | 16/100 [00:59<05:41,  4.07s/it]Best trial: 10. Best value: 0.593164:  17%|█▋        | 17/100 [00:59<05:30,  3.99s/it]Best trial: 10. Best value: 0.593164:  17%|█▋        | 17/100 [01:03<05:30,  3.99s/it]Best trial: 10. Best value: 0.593164:  18%|█▊        | 18/100 [01:03<05:26,  3.99s/it]Best trial: 10. Best value: 0.593164:  18%|█▊        | 18/100 [01:06<05:26,  3.99s/it]Best trial: 10. Best value: 0.593164:  19%|█▉        | 19/100 [01:06<04:59,  3.70s/it]Best trial: 10. Best value: 0.593164:  19%|█▉        | 19/100 [01:11<04:59,  3.70s/it]Best trial: 10. Best value: 0.593164:  20%|██        | 20/100 [01:11<05:39,  4.25s/it]Best trial: 10. Best value: 0.593164:  20%|██        | 20/100 [01:14<05:39,  4.25s/it]Best trial: 10. Best value: 0.593164:  21%|██        | 21/100 [01:14<05:00,  3.80s/it]Best trial: 10. Best value: 0.593164:  21%|██        | 21/100 [01:18<05:00,  3.80s/it]Best trial: 10. Best value: 0.593164:  22%|██▏       | 22/100 [01:18<05:07,  3.94s/it]Best trial: 10. Best value: 0.593164:  22%|██▏       | 22/100 [01:23<05:07,  3.94s/it]Best trial: 10. Best value: 0.593164:  23%|██▎       | 23/100 [01:23<05:23,  4.20s/it]Best trial: 10. Best value: 0.593164:  23%|██▎       | 23/100 [01:26<05:23,  4.20s/it]Best trial: 10. Best value: 0.593164:  24%|██▍       | 24/100 [01:26<04:59,  3.94s/it]Best trial: 10. Best value: 0.593164:  24%|██▍       | 24/100 [01:34<04:59,  3.94s/it]Best trial: 10. Best value: 0.593164:  25%|██▌       | 25/100 [01:34<06:08,  4.91s/it]Best trial: 10. Best value: 0.593164:  25%|██▌       | 25/100 [01:39<06:08,  4.91s/it]Best trial: 10. Best value: 0.593164:  26%|██▌       | 26/100 [01:39<06:16,  5.09s/it]Best trial: 10. Best value: 0.593164:  26%|██▌       | 26/100 [01:41<06:16,  5.09s/it]Best trial: 10. Best value: 0.593164:  27%|██▋       | 27/100 [01:41<05:10,  4.25s/it]Best trial: 10. Best value: 0.593164:  27%|██▋       | 27/100 [01:47<05:10,  4.25s/it]Best trial: 10. Best value: 0.593164:  28%|██▊       | 28/100 [01:47<05:41,  4.75s/it]Best trial: 10. Best value: 0.593164:  28%|██▊       | 28/100 [01:52<05:41,  4.75s/it]Best trial: 10. Best value: 0.593164:  29%|██▉       | 29/100 [01:52<05:26,  4.60s/it]Best trial: 10. Best value: 0.593164:  29%|██▉       | 29/100 [01:58<05:26,  4.60s/it]Best trial: 10. Best value: 0.593164:  30%|███       | 30/100 [01:58<06:02,  5.17s/it]Best trial: 10. Best value: 0.593164:  30%|███       | 30/100 [02:01<06:02,  5.17s/it]Best trial: 10. Best value: 0.593164:  31%|███       | 31/100 [02:01<05:05,  4.43s/it]Best trial: 10. Best value: 0.593164:  31%|███       | 31/100 [02:04<05:05,  4.43s/it]Best trial: 10. Best value: 0.593164:  32%|███▏      | 32/100 [02:04<04:27,  3.94s/it]Best trial: 10. Best value: 0.593164:  32%|███▏      | 32/100 [02:06<04:27,  3.94s/it]Best trial: 10. Best value: 0.593164:  33%|███▎      | 33/100 [02:06<04:02,  3.63s/it]Best trial: 10. Best value: 0.593164:  33%|███▎      | 33/100 [02:09<04:02,  3.63s/it]Best trial: 10. Best value: 0.593164:  34%|███▍      | 34/100 [02:09<03:43,  3.38s/it]Best trial: 10. Best value: 0.593164:  34%|███▍      | 34/100 [02:11<03:43,  3.38s/it]Best trial: 10. Best value: 0.593164:  35%|███▌      | 35/100 [02:11<03:14,  3.00s/it]Best trial: 10. Best value: 0.593164:  35%|███▌      | 35/100 [02:14<03:14,  3.00s/it]Best trial: 10. Best value: 0.593164:  36%|███▌      | 36/100 [02:14<03:04,  2.88s/it]Best trial: 10. Best value: 0.593164:  36%|███▌      | 36/100 [02:18<03:04,  2.88s/it]Best trial: 10. Best value: 0.593164:  37%|███▋      | 37/100 [02:18<03:13,  3.07s/it]Best trial: 10. Best value: 0.593164:  37%|███▋      | 37/100 [02:20<03:13,  3.07s/it]Best trial: 10. Best value: 0.593164:  38%|███▊      | 38/100 [02:20<02:59,  2.90s/it]Best trial: 10. Best value: 0.593164:  38%|███▊      | 38/100 [02:22<02:59,  2.90s/it]Best trial: 10. Best value: 0.593164:  39%|███▉      | 39/100 [02:22<02:33,  2.52s/it]Best trial: 10. Best value: 0.593164:  39%|███▉      | 39/100 [02:27<02:33,  2.52s/it]Best trial: 10. Best value: 0.593164:  40%|████      | 40/100 [02:27<03:28,  3.48s/it]Best trial: 10. Best value: 0.593164:  40%|████      | 40/100 [02:35<03:28,  3.48s/it]Best trial: 10. Best value: 0.593164:  41%|████      | 41/100 [02:35<04:33,  4.64s/it]Best trial: 10. Best value: 0.593164:  41%|████      | 41/100 [02:37<04:33,  4.64s/it]Best trial: 10. Best value: 0.593164:  42%|████▏     | 42/100 [02:37<03:55,  4.07s/it]Best trial: 10. Best value: 0.593164:  42%|████▏     | 42/100 [02:40<03:55,  4.07s/it]Best trial: 10. Best value: 0.593164:  43%|████▎     | 43/100 [02:40<03:26,  3.62s/it]Best trial: 10. Best value: 0.593164:  43%|████▎     | 43/100 [02:43<03:26,  3.62s/it]Best trial: 10. Best value: 0.593164:  44%|████▍     | 44/100 [02:43<03:14,  3.48s/it]Best trial: 10. Best value: 0.593164:  44%|████▍     | 44/100 [02:46<03:14,  3.48s/it]Best trial: 10. Best value: 0.593164:  45%|████▌     | 45/100 [02:46<02:59,  3.27s/it]Best trial: 10. Best value: 0.593164:  45%|████▌     | 45/100 [02:49<02:59,  3.27s/it]Best trial: 10. Best value: 0.593164:  46%|████▌     | 46/100 [02:49<02:45,  3.06s/it]Best trial: 10. Best value: 0.593164:  46%|████▌     | 46/100 [02:51<02:45,  3.06s/it]Best trial: 10. Best value: 0.593164:  47%|████▋     | 47/100 [02:51<02:30,  2.84s/it]Best trial: 10. Best value: 0.593164:  47%|████▋     | 47/100 [02:53<02:30,  2.84s/it]Best trial: 10. Best value: 0.593164:  48%|████▊     | 48/100 [02:53<02:09,  2.49s/it]Best trial: 10. Best value: 0.593164:  48%|████▊     | 48/100 [02:55<02:09,  2.49s/it]Best trial: 10. Best value: 0.593164:  49%|████▉     | 49/100 [02:55<01:59,  2.34s/it]Best trial: 10. Best value: 0.593164:  49%|████▉     | 49/100 [02:57<01:59,  2.34s/it]Best trial: 10. Best value: 0.593164:  50%|█████     | 50/100 [02:57<01:52,  2.24s/it]Best trial: 10. Best value: 0.593164:  50%|█████     | 50/100 [02:58<01:52,  2.24s/it]Best trial: 10. Best value: 0.593164:  51%|█████     | 51/100 [02:58<01:40,  2.04s/it]Best trial: 51. Best value: 0.596156:  51%|█████     | 51/100 [03:01<01:40,  2.04s/it]Best trial: 51. Best value: 0.596156:  52%|█████▏    | 52/100 [03:01<01:44,  2.18s/it]Best trial: 51. Best value: 0.596156:  52%|█████▏    | 52/100 [03:03<01:44,  2.18s/it]Best trial: 51. Best value: 0.596156:  53%|█████▎    | 53/100 [03:03<01:41,  2.17s/it]Best trial: 51. Best value: 0.596156:  53%|█████▎    | 53/100 [03:05<01:41,  2.17s/it]Best trial: 51. Best value: 0.596156:  54%|█████▍    | 54/100 [03:05<01:38,  2.13s/it]Best trial: 51. Best value: 0.596156:  54%|█████▍    | 54/100 [03:07<01:38,  2.13s/it]Best trial: 51. Best value: 0.596156:  55%|█████▌    | 55/100 [03:07<01:34,  2.09s/it]Best trial: 51. Best value: 0.596156:  55%|█████▌    | 55/100 [03:09<01:34,  2.09s/it]Best trial: 51. Best value: 0.596156:  56%|█████▌    | 56/100 [03:09<01:29,  2.04s/it]Best trial: 51. Best value: 0.596156:  56%|█████▌    | 56/100 [03:10<01:29,  2.04s/it]Best trial: 51. Best value: 0.596156:  57%|█████▋    | 57/100 [03:10<01:21,  1.89s/it]Best trial: 51. Best value: 0.596156:  57%|█████▋    | 57/100 [03:13<01:21,  1.89s/it]Best trial: 51. Best value: 0.596156:  58%|█████▊    | 58/100 [03:13<01:30,  2.14s/it]Best trial: 51. Best value: 0.596156:  58%|█████▊    | 58/100 [03:16<01:30,  2.14s/it]Best trial: 51. Best value: 0.596156:  59%|█████▉    | 59/100 [03:16<01:43,  2.53s/it]Best trial: 51. Best value: 0.596156:  59%|█████▉    | 59/100 [03:18<01:43,  2.53s/it]Best trial: 51. Best value: 0.596156:  60%|██████    | 60/100 [03:18<01:30,  2.27s/it]Best trial: 51. Best value: 0.596156:  60%|██████    | 60/100 [03:20<01:30,  2.27s/it]Best trial: 51. Best value: 0.596156:  61%|██████    | 61/100 [03:20<01:22,  2.11s/it]Best trial: 51. Best value: 0.596156:  61%|██████    | 61/100 [03:21<01:22,  2.11s/it]Best trial: 51. Best value: 0.596156:  62%|██████▏   | 62/100 [03:21<01:14,  1.96s/it]Best trial: 51. Best value: 0.596156:  62%|██████▏   | 62/100 [03:23<01:14,  1.96s/it]Best trial: 51. Best value: 0.596156:  63%|██████▎   | 63/100 [03:23<01:13,  1.98s/it]Best trial: 51. Best value: 0.596156:  63%|██████▎   | 63/100 [03:26<01:13,  1.98s/it]Best trial: 51. Best value: 0.596156:  64%|██████▍   | 64/100 [03:26<01:17,  2.15s/it]Best trial: 51. Best value: 0.596156:  64%|██████▍   | 64/100 [03:28<01:17,  2.15s/it]Best trial: 51. Best value: 0.596156:  65%|██████▌   | 65/100 [03:28<01:12,  2.07s/it]Best trial: 51. Best value: 0.596156:  65%|██████▌   | 65/100 [03:31<01:12,  2.07s/it]Best trial: 51. Best value: 0.596156:  66%|██████▌   | 66/100 [03:31<01:16,  2.24s/it]Best trial: 51. Best value: 0.596156:  66%|██████▌   | 66/100 [03:33<01:16,  2.24s/it]Best trial: 51. Best value: 0.596156:  67%|██████▋   | 67/100 [03:33<01:16,  2.31s/it]Best trial: 51. Best value: 0.596156:  67%|██████▋   | 67/100 [03:35<01:16,  2.31s/it]Best trial: 51. Best value: 0.596156:  68%|██████▊   | 68/100 [03:35<01:09,  2.19s/it]Best trial: 51. Best value: 0.596156:  68%|██████▊   | 68/100 [03:37<01:09,  2.19s/it]Best trial: 51. Best value: 0.596156:  69%|██████▉   | 69/100 [03:37<01:09,  2.23s/it]Best trial: 51. Best value: 0.596156:  69%|██████▉   | 69/100 [03:39<01:09,  2.23s/it]Best trial: 51. Best value: 0.596156:  70%|███████   | 70/100 [03:39<01:04,  2.14s/it]Best trial: 51. Best value: 0.596156:  70%|███████   | 70/100 [03:41<01:04,  2.14s/it]Best trial: 51. Best value: 0.596156:  71%|███████   | 71/100 [03:41<00:56,  1.95s/it]Best trial: 51. Best value: 0.596156:  71%|███████   | 71/100 [03:42<00:56,  1.95s/it]Best trial: 51. Best value: 0.596156:  72%|███████▏  | 72/100 [03:42<00:51,  1.86s/it]Best trial: 51. Best value: 0.596156:  72%|███████▏  | 72/100 [03:44<00:51,  1.86s/it]Best trial: 51. Best value: 0.596156:  73%|███████▎  | 73/100 [03:44<00:52,  1.94s/it]Best trial: 51. Best value: 0.596156:  73%|███████▎  | 73/100 [03:47<00:52,  1.94s/it]Best trial: 51. Best value: 0.596156:  74%|███████▍  | 74/100 [03:47<00:55,  2.12s/it]Best trial: 51. Best value: 0.596156:  74%|███████▍  | 74/100 [03:49<00:55,  2.12s/it]Best trial: 51. Best value: 0.596156:  75%|███████▌  | 75/100 [03:49<00:53,  2.12s/it]Best trial: 51. Best value: 0.596156:  75%|███████▌  | 75/100 [03:51<00:53,  2.12s/it]Best trial: 51. Best value: 0.596156:  76%|███████▌  | 76/100 [03:51<00:50,  2.11s/it]Best trial: 51. Best value: 0.596156:  76%|███████▌  | 76/100 [03:53<00:50,  2.11s/it]Best trial: 51. Best value: 0.596156:  77%|███████▋  | 77/100 [03:53<00:49,  2.15s/it]Best trial: 51. Best value: 0.596156:  77%|███████▋  | 77/100 [03:55<00:49,  2.15s/it]Best trial: 51. Best value: 0.596156:  78%|███████▊  | 78/100 [03:55<00:46,  2.12s/it]Best trial: 51. Best value: 0.596156:  78%|███████▊  | 78/100 [03:58<00:46,  2.12s/it]Best trial: 51. Best value: 0.596156:  79%|███████▉  | 79/100 [03:58<00:44,  2.10s/it]Best trial: 51. Best value: 0.596156:  79%|███████▉  | 79/100 [03:59<00:44,  2.10s/it]Best trial: 51. Best value: 0.596156:  80%|████████  | 80/100 [03:59<00:38,  1.95s/it]Best trial: 51. Best value: 0.596156:  80%|████████  | 80/100 [04:01<00:38,  1.95s/it]Best trial: 51. Best value: 0.596156:  81%|████████  | 81/100 [04:01<00:38,  2.00s/it]Best trial: 51. Best value: 0.596156:  81%|████████  | 81/100 [04:03<00:38,  2.00s/it]Best trial: 51. Best value: 0.596156:  82%|████████▏ | 82/100 [04:03<00:34,  1.90s/it]Best trial: 51. Best value: 0.596156:  82%|████████▏ | 82/100 [04:05<00:34,  1.90s/it]Best trial: 51. Best value: 0.596156:  83%|████████▎ | 83/100 [04:05<00:33,  2.00s/it]Best trial: 51. Best value: 0.596156:  83%|████████▎ | 83/100 [04:07<00:33,  2.00s/it]Best trial: 51. Best value: 0.596156:  84%|████████▍ | 84/100 [04:07<00:32,  2.02s/it]Best trial: 51. Best value: 0.596156:  84%|████████▍ | 84/100 [04:09<00:32,  2.02s/it]Best trial: 51. Best value: 0.596156:  85%|████████▌ | 85/100 [04:09<00:30,  2.02s/it]Best trial: 51. Best value: 0.596156:  85%|████████▌ | 85/100 [04:11<00:30,  2.02s/it]Best trial: 51. Best value: 0.596156:  86%|████████▌ | 86/100 [04:11<00:25,  1.83s/it]Best trial: 51. Best value: 0.596156:  86%|████████▌ | 86/100 [04:13<00:25,  1.83s/it]Best trial: 51. Best value: 0.596156:  87%|████████▋ | 87/100 [04:13<00:24,  1.87s/it]Best trial: 51. Best value: 0.596156:  87%|████████▋ | 87/100 [04:14<00:24,  1.87s/it]Best trial: 51. Best value: 0.596156:  88%|████████▊ | 88/100 [04:14<00:21,  1.81s/it]Best trial: 51. Best value: 0.596156:  88%|████████▊ | 88/100 [04:17<00:21,  1.81s/it]Best trial: 51. Best value: 0.596156:  89%|████████▉ | 89/100 [04:17<00:23,  2.10s/it]Best trial: 51. Best value: 0.596156:  89%|████████▉ | 89/100 [04:19<00:23,  2.10s/it]Best trial: 51. Best value: 0.596156:  90%|█████████ | 90/100 [04:19<00:21,  2.13s/it]Best trial: 51. Best value: 0.596156:  90%|█████████ | 90/100 [04:22<00:21,  2.13s/it]Best trial: 51. Best value: 0.596156:  91%|█████████ | 91/100 [04:22<00:20,  2.33s/it]Best trial: 51. Best value: 0.596156:  91%|█████████ | 91/100 [04:24<00:20,  2.33s/it]Best trial: 51. Best value: 0.596156:  92%|█████████▏| 92/100 [04:24<00:18,  2.32s/it]Best trial: 51. Best value: 0.596156:  92%|█████████▏| 92/100 [04:27<00:18,  2.32s/it]Best trial: 51. Best value: 0.596156:  93%|█████████▎| 93/100 [04:27<00:16,  2.40s/it]Best trial: 51. Best value: 0.596156:  93%|█████████▎| 93/100 [04:30<00:16,  2.40s/it]Best trial: 51. Best value: 0.596156:  94%|█████████▍| 94/100 [04:30<00:14,  2.46s/it]Best trial: 51. Best value: 0.596156:  94%|█████████▍| 94/100 [04:31<00:14,  2.46s/it]Best trial: 51. Best value: 0.596156:  95%|█████████▌| 95/100 [04:31<00:11,  2.26s/it]Best trial: 51. Best value: 0.596156:  95%|█████████▌| 95/100 [04:36<00:11,  2.26s/it]Best trial: 51. Best value: 0.596156:  96%|█████████▌| 96/100 [04:36<00:11,  2.87s/it]Best trial: 51. Best value: 0.596156:  96%|█████████▌| 96/100 [04:38<00:11,  2.87s/it]Best trial: 51. Best value: 0.596156:  97%|█████████▋| 97/100 [04:38<00:07,  2.59s/it]Best trial: 51. Best value: 0.596156:  97%|█████████▋| 97/100 [04:40<00:07,  2.59s/it]Best trial: 51. Best value: 0.596156:  98%|█████████▊| 98/100 [04:40<00:05,  2.52s/it]Best trial: 51. Best value: 0.596156:  98%|█████████▊| 98/100 [04:44<00:05,  2.52s/it]Best trial: 51. Best value: 0.596156:  99%|█████████▉| 99/100 [04:44<00:02,  3.00s/it]Best trial: 51. Best value: 0.596156:  99%|█████████▉| 99/100 [04:46<00:02,  3.00s/it]Best trial: 51. Best value: 0.596156: 100%|██████████| 100/100 [04:46<00:00,  2.62s/it]Best trial: 51. Best value: 0.596156: 100%|██████████| 100/100 [04:46<00:00,  2.86s/it]
2025-11-30 18:01:55,926 - INFO - HPO Complete. Best AUPRC: 0.5962
2025-11-30 18:01:55,926 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.025618541208985515, 'max_depth': 5, 'subsample': 0.7025995682694264, 'colsample_bytree': 0.6423200490633076, 'gamma': 3.475549666189006, 'reg_lambda': 0.0005943958847541205, 'reg_alpha': 3.5993892557933475e-06}
2025-11-30 18:01:55,927 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:01:57,951 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_pleth
2025-11-30 18:01:57,951 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:01:58,053 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:01:58,078 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:01:58,084 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:01:58,084 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:01:58,084 - INFO - Training model...
2025-11-30 18:01:59,726 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:02:05,065 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:02:05,065 - INFO - AUROC: 0.7905 (0.7578 - 0.8199)
2025-11-30 18:02:05,065 - INFO - AUPRC: 0.5262 (0.4577 - 0.6111)
2025-11-30 18:02:05,066 - INFO - Brier Score: 0.1544 (0.1428 - 0.1648)
2025-11-30 18:02:05,066 - INFO - Accuracy: 0.7717 (0.7020 - 0.8061)
2025-11-30 18:02:05,066 - INFO - Precision: 0.5000 (0.4318 - 0.5681)
2025-11-30 18:02:05,066 - INFO - Sensitivity (Recall): 0.6266 (0.5303 - 0.7633)
2025-11-30 18:02:05,066 - INFO - F1-Score: 0.5562 (0.5121 - 0.6096)
2025-11-30 18:02:05,066 - INFO - Best Threshold: 0.4500 (0.3060 - 0.5380)
2025-11-30 18:02:05,066 - INFO - Specificity: 0.8146 (0.6919 - 0.8762)
2025-11-30 18:02:05,090 - INFO - Calculating SHAP values...
2025-11-30 18:02:06,174 - INFO - SHAP plots saved.
2025-11-30 18:02:06,176 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:02:07,445 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 18:02:07,445 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:02:07,529 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:02:07,553 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:02:07,559 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:02:07,559 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.561805:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.561805:   1%|          | 1/100 [00:02<04:36,  2.79s/it]Best trial: 0. Best value: 0.561805:   1%|          | 1/100 [00:04<04:36,  2.79s/it]Best trial: 0. Best value: 0.561805:   2%|▏         | 2/100 [00:04<03:25,  2.10s/it]Best trial: 0. Best value: 0.561805:   2%|▏         | 2/100 [00:09<03:25,  2.10s/it]Best trial: 0. Best value: 0.561805:   3%|▎         | 3/100 [00:09<05:40,  3.51s/it]Best trial: 0. Best value: 0.561805:   3%|▎         | 3/100 [00:15<05:40,  3.51s/it]Best trial: 0. Best value: 0.561805:   4%|▍         | 4/100 [00:15<07:10,  4.48s/it]Best trial: 0. Best value: 0.561805:   4%|▍         | 4/100 [00:20<07:10,  4.48s/it]Best trial: 0. Best value: 0.561805:   5%|▌         | 5/100 [00:20<07:12,  4.55s/it]Best trial: 5. Best value: 0.582403:   5%|▌         | 5/100 [00:24<07:12,  4.55s/it]Best trial: 5. Best value: 0.582403:   6%|▌         | 6/100 [00:24<06:55,  4.43s/it]Best trial: 6. Best value: 0.587163:   6%|▌         | 6/100 [00:26<06:55,  4.43s/it]Best trial: 6. Best value: 0.587163:   7%|▋         | 7/100 [00:26<05:38,  3.64s/it]Best trial: 6. Best value: 0.587163:   7%|▋         | 7/100 [00:30<05:38,  3.64s/it]Best trial: 6. Best value: 0.587163:   8%|▊         | 8/100 [00:30<05:48,  3.79s/it]Best trial: 6. Best value: 0.587163:   8%|▊         | 8/100 [00:32<05:48,  3.79s/it]Best trial: 6. Best value: 0.587163:   9%|▉         | 9/100 [00:32<04:50,  3.19s/it]Best trial: 6. Best value: 0.587163:   9%|▉         | 9/100 [00:39<04:50,  3.19s/it]Best trial: 6. Best value: 0.587163:  10%|█         | 10/100 [00:39<06:46,  4.51s/it]Best trial: 6. Best value: 0.587163:  10%|█         | 10/100 [00:41<06:46,  4.51s/it]Best trial: 6. Best value: 0.587163:  11%|█         | 11/100 [00:41<05:22,  3.63s/it]Best trial: 6. Best value: 0.587163:  11%|█         | 11/100 [00:43<05:22,  3.63s/it]Best trial: 6. Best value: 0.587163:  12%|█▏        | 12/100 [00:43<04:24,  3.00s/it]Best trial: 6. Best value: 0.587163:  12%|█▏        | 12/100 [00:44<04:24,  3.00s/it]Best trial: 6. Best value: 0.587163:  13%|█▎        | 13/100 [00:44<03:39,  2.53s/it]Best trial: 13. Best value: 0.594395:  13%|█▎        | 13/100 [00:47<03:39,  2.53s/it]Best trial: 13. Best value: 0.594395:  14%|█▍        | 14/100 [00:47<03:38,  2.54s/it]Best trial: 13. Best value: 0.594395:  14%|█▍        | 14/100 [00:50<03:38,  2.54s/it]Best trial: 13. Best value: 0.594395:  15%|█▌        | 15/100 [00:50<03:46,  2.67s/it]Best trial: 13. Best value: 0.594395:  15%|█▌        | 15/100 [00:53<03:46,  2.67s/it]Best trial: 13. Best value: 0.594395:  16%|█▌        | 16/100 [00:53<04:13,  3.02s/it]Best trial: 13. Best value: 0.594395:  16%|█▌        | 16/100 [00:56<04:13,  3.02s/it]Best trial: 13. Best value: 0.594395:  17%|█▋        | 17/100 [00:56<04:04,  2.95s/it]Best trial: 13. Best value: 0.594395:  17%|█▋        | 17/100 [00:59<04:04,  2.95s/it]Best trial: 13. Best value: 0.594395:  18%|█▊        | 18/100 [00:59<04:00,  2.93s/it]Best trial: 13. Best value: 0.594395:  18%|█▊        | 18/100 [01:04<04:00,  2.93s/it]Best trial: 13. Best value: 0.594395:  19%|█▉        | 19/100 [01:04<04:33,  3.38s/it]Best trial: 13. Best value: 0.594395:  19%|█▉        | 19/100 [01:05<04:33,  3.38s/it]Best trial: 13. Best value: 0.594395:  20%|██        | 20/100 [01:05<03:50,  2.88s/it]Best trial: 20. Best value: 0.597094:  20%|██        | 20/100 [01:08<03:50,  2.88s/it]Best trial: 20. Best value: 0.597094:  21%|██        | 21/100 [01:08<03:45,  2.86s/it]Best trial: 21. Best value: 0.60054:  21%|██        | 21/100 [01:11<03:45,  2.86s/it] Best trial: 21. Best value: 0.60054:  22%|██▏       | 22/100 [01:11<03:44,  2.88s/it]Best trial: 21. Best value: 0.60054:  22%|██▏       | 22/100 [01:13<03:44,  2.88s/it]Best trial: 21. Best value: 0.60054:  23%|██▎       | 23/100 [01:13<03:31,  2.74s/it]Best trial: 21. Best value: 0.60054:  23%|██▎       | 23/100 [01:16<03:31,  2.74s/it]Best trial: 21. Best value: 0.60054:  24%|██▍       | 24/100 [01:16<03:17,  2.60s/it]Best trial: 21. Best value: 0.60054:  24%|██▍       | 24/100 [01:18<03:17,  2.60s/it]Best trial: 21. Best value: 0.60054:  25%|██▌       | 25/100 [01:18<03:06,  2.48s/it]Best trial: 21. Best value: 0.60054:  25%|██▌       | 25/100 [01:21<03:06,  2.48s/it]Best trial: 21. Best value: 0.60054:  26%|██▌       | 26/100 [01:21<03:07,  2.53s/it]Best trial: 21. Best value: 0.60054:  26%|██▌       | 26/100 [01:25<03:07,  2.53s/it]Best trial: 21. Best value: 0.60054:  27%|██▋       | 27/100 [01:25<03:52,  3.19s/it]Best trial: 21. Best value: 0.60054:  27%|██▋       | 27/100 [01:29<03:52,  3.19s/it]Best trial: 21. Best value: 0.60054:  28%|██▊       | 28/100 [01:29<03:52,  3.23s/it]Best trial: 21. Best value: 0.60054:  28%|██▊       | 28/100 [01:34<03:52,  3.23s/it]Best trial: 21. Best value: 0.60054:  29%|██▉       | 29/100 [01:34<04:43,  4.00s/it]Best trial: 21. Best value: 0.60054:  29%|██▉       | 29/100 [01:38<04:43,  4.00s/it]Best trial: 21. Best value: 0.60054:  30%|███       | 30/100 [01:38<04:27,  3.83s/it]Best trial: 21. Best value: 0.60054:  30%|███       | 30/100 [01:41<04:27,  3.83s/it]Best trial: 21. Best value: 0.60054:  31%|███       | 31/100 [01:41<04:08,  3.60s/it]Best trial: 21. Best value: 0.60054:  31%|███       | 31/100 [01:44<04:08,  3.60s/it]Best trial: 21. Best value: 0.60054:  32%|███▏      | 32/100 [01:44<03:51,  3.40s/it]Best trial: 21. Best value: 0.60054:  32%|███▏      | 32/100 [01:47<03:51,  3.40s/it]Best trial: 21. Best value: 0.60054:  33%|███▎      | 33/100 [01:47<03:36,  3.24s/it]Best trial: 21. Best value: 0.60054:  33%|███▎      | 33/100 [01:50<03:36,  3.24s/it]Best trial: 21. Best value: 0.60054:  34%|███▍      | 34/100 [01:50<03:42,  3.37s/it]Best trial: 21. Best value: 0.60054:  34%|███▍      | 34/100 [01:53<03:42,  3.37s/it]Best trial: 21. Best value: 0.60054:  35%|███▌      | 35/100 [01:53<03:18,  3.05s/it]Best trial: 21. Best value: 0.60054:  35%|███▌      | 35/100 [01:54<03:18,  3.05s/it]Best trial: 21. Best value: 0.60054:  36%|███▌      | 36/100 [01:54<02:48,  2.63s/it]Best trial: 21. Best value: 0.60054:  36%|███▌      | 36/100 [01:56<02:48,  2.63s/it]Best trial: 21. Best value: 0.60054:  37%|███▋      | 37/100 [01:56<02:33,  2.44s/it]Best trial: 21. Best value: 0.60054:  37%|███▋      | 37/100 [01:59<02:33,  2.44s/it]Best trial: 21. Best value: 0.60054:  38%|███▊      | 38/100 [01:59<02:45,  2.66s/it]Best trial: 21. Best value: 0.60054:  38%|███▊      | 38/100 [02:01<02:45,  2.66s/it]Best trial: 21. Best value: 0.60054:  39%|███▉      | 39/100 [02:01<02:22,  2.34s/it]Best trial: 21. Best value: 0.60054:  39%|███▉      | 39/100 [02:05<02:22,  2.34s/it]Best trial: 21. Best value: 0.60054:  40%|████      | 40/100 [02:05<02:50,  2.84s/it]Best trial: 21. Best value: 0.60054:  40%|████      | 40/100 [02:10<02:50,  2.84s/it]Best trial: 21. Best value: 0.60054:  41%|████      | 41/100 [02:10<03:30,  3.57s/it]Best trial: 21. Best value: 0.60054:  41%|████      | 41/100 [02:13<03:30,  3.57s/it]Best trial: 21. Best value: 0.60054:  42%|████▏     | 42/100 [02:13<03:03,  3.16s/it]Best trial: 21. Best value: 0.60054:  42%|████▏     | 42/100 [02:14<03:03,  3.16s/it]Best trial: 21. Best value: 0.60054:  43%|████▎     | 43/100 [02:14<02:37,  2.76s/it]Best trial: 21. Best value: 0.60054:  43%|████▎     | 43/100 [02:17<02:37,  2.76s/it]Best trial: 21. Best value: 0.60054:  44%|████▍     | 44/100 [02:17<02:32,  2.73s/it]Best trial: 21. Best value: 0.60054:  44%|████▍     | 44/100 [02:19<02:32,  2.73s/it]Best trial: 21. Best value: 0.60054:  45%|████▌     | 45/100 [02:19<02:15,  2.46s/it]Best trial: 21. Best value: 0.60054:  45%|████▌     | 45/100 [02:20<02:15,  2.46s/it]Best trial: 21. Best value: 0.60054:  46%|████▌     | 46/100 [02:20<01:55,  2.14s/it]Best trial: 21. Best value: 0.60054:  46%|████▌     | 46/100 [02:23<01:55,  2.14s/it]Best trial: 21. Best value: 0.60054:  47%|████▋     | 47/100 [02:23<02:02,  2.30s/it]Best trial: 21. Best value: 0.60054:  47%|████▋     | 47/100 [02:27<02:02,  2.30s/it]Best trial: 21. Best value: 0.60054:  48%|████▊     | 48/100 [02:27<02:23,  2.75s/it]Best trial: 21. Best value: 0.60054:  48%|████▊     | 48/100 [02:32<02:23,  2.75s/it]Best trial: 21. Best value: 0.60054:  49%|████▉     | 49/100 [02:32<02:51,  3.37s/it]Best trial: 21. Best value: 0.60054:  49%|████▉     | 49/100 [02:34<02:51,  3.37s/it]Best trial: 21. Best value: 0.60054:  50%|█████     | 50/100 [02:34<02:37,  3.16s/it]Best trial: 21. Best value: 0.60054:  50%|█████     | 50/100 [02:37<02:37,  3.16s/it]Best trial: 21. Best value: 0.60054:  51%|█████     | 51/100 [02:37<02:25,  2.97s/it]Best trial: 21. Best value: 0.60054:  51%|█████     | 51/100 [02:40<02:25,  2.97s/it]Best trial: 21. Best value: 0.60054:  52%|█████▏    | 52/100 [02:40<02:26,  3.05s/it]Best trial: 21. Best value: 0.60054:  52%|█████▏    | 52/100 [02:43<02:26,  3.05s/it]Best trial: 21. Best value: 0.60054:  53%|█████▎    | 53/100 [02:43<02:18,  2.96s/it]Best trial: 21. Best value: 0.60054:  53%|█████▎    | 53/100 [02:44<02:18,  2.96s/it]Best trial: 21. Best value: 0.60054:  54%|█████▍    | 54/100 [02:44<01:58,  2.57s/it]Best trial: 21. Best value: 0.60054:  54%|█████▍    | 54/100 [02:46<01:58,  2.57s/it]Best trial: 21. Best value: 0.60054:  55%|█████▌    | 55/100 [02:46<01:44,  2.32s/it]Best trial: 21. Best value: 0.60054:  55%|█████▌    | 55/100 [02:48<01:44,  2.32s/it]Best trial: 21. Best value: 0.60054:  56%|█████▌    | 56/100 [02:48<01:39,  2.26s/it]Best trial: 21. Best value: 0.60054:  56%|█████▌    | 56/100 [02:51<01:39,  2.26s/it]Best trial: 21. Best value: 0.60054:  57%|█████▋    | 57/100 [02:51<01:43,  2.42s/it]Best trial: 21. Best value: 0.60054:  57%|█████▋    | 57/100 [02:54<01:43,  2.42s/it]Best trial: 21. Best value: 0.60054:  58%|█████▊    | 58/100 [02:54<01:44,  2.49s/it]Best trial: 21. Best value: 0.60054:  58%|█████▊    | 58/100 [02:58<01:44,  2.49s/it]Best trial: 21. Best value: 0.60054:  59%|█████▉    | 59/100 [02:58<02:00,  2.94s/it]Best trial: 21. Best value: 0.60054:  59%|█████▉    | 59/100 [03:01<02:00,  2.94s/it]Best trial: 21. Best value: 0.60054:  60%|██████    | 60/100 [03:01<02:00,  3.02s/it]Best trial: 21. Best value: 0.60054:  60%|██████    | 60/100 [03:04<02:00,  3.02s/it]Best trial: 21. Best value: 0.60054:  61%|██████    | 61/100 [03:04<02:02,  3.15s/it]Best trial: 21. Best value: 0.60054:  61%|██████    | 61/100 [03:07<02:02,  3.15s/it]Best trial: 21. Best value: 0.60054:  62%|██████▏   | 62/100 [03:07<01:57,  3.08s/it]Best trial: 21. Best value: 0.60054:  62%|██████▏   | 62/100 [03:10<01:57,  3.08s/it]Best trial: 21. Best value: 0.60054:  63%|██████▎   | 63/100 [03:10<01:46,  2.88s/it]Best trial: 21. Best value: 0.60054:  63%|██████▎   | 63/100 [03:12<01:46,  2.88s/it]Best trial: 21. Best value: 0.60054:  64%|██████▍   | 64/100 [03:12<01:37,  2.71s/it]Best trial: 21. Best value: 0.60054:  64%|██████▍   | 64/100 [03:15<01:37,  2.71s/it]Best trial: 21. Best value: 0.60054:  65%|██████▌   | 65/100 [03:15<01:34,  2.69s/it]Best trial: 21. Best value: 0.60054:  65%|██████▌   | 65/100 [03:19<01:34,  2.69s/it]Best trial: 21. Best value: 0.60054:  66%|██████▌   | 66/100 [03:19<01:46,  3.15s/it]Best trial: 21. Best value: 0.60054:  66%|██████▌   | 66/100 [03:21<01:46,  3.15s/it]Best trial: 21. Best value: 0.60054:  67%|██████▋   | 67/100 [03:21<01:34,  2.87s/it]Best trial: 21. Best value: 0.60054:  67%|██████▋   | 67/100 [03:23<01:34,  2.87s/it]Best trial: 21. Best value: 0.60054:  68%|██████▊   | 68/100 [03:23<01:24,  2.65s/it]Best trial: 21. Best value: 0.60054:  68%|██████▊   | 68/100 [03:25<01:24,  2.65s/it]Best trial: 21. Best value: 0.60054:  69%|██████▉   | 69/100 [03:25<01:18,  2.53s/it]Best trial: 21. Best value: 0.60054:  69%|██████▉   | 69/100 [03:30<01:18,  2.53s/it]Best trial: 21. Best value: 0.60054:  70%|███████   | 70/100 [03:30<01:34,  3.16s/it]Best trial: 21. Best value: 0.60054:  70%|███████   | 70/100 [03:35<01:34,  3.16s/it]Best trial: 21. Best value: 0.60054:  71%|███████   | 71/100 [03:35<01:50,  3.82s/it]Best trial: 21. Best value: 0.60054:  71%|███████   | 71/100 [03:38<01:50,  3.82s/it]Best trial: 21. Best value: 0.60054:  72%|███████▏  | 72/100 [03:38<01:34,  3.37s/it]Best trial: 21. Best value: 0.60054:  72%|███████▏  | 72/100 [03:40<01:34,  3.37s/it]Best trial: 21. Best value: 0.60054:  73%|███████▎  | 73/100 [03:40<01:21,  3.03s/it]Best trial: 21. Best value: 0.60054:  73%|███████▎  | 73/100 [03:42<01:21,  3.03s/it]Best trial: 21. Best value: 0.60054:  74%|███████▍  | 74/100 [03:42<01:12,  2.81s/it]Best trial: 21. Best value: 0.60054:  74%|███████▍  | 74/100 [03:45<01:12,  2.81s/it]Best trial: 21. Best value: 0.60054:  75%|███████▌  | 75/100 [03:45<01:07,  2.71s/it]Best trial: 21. Best value: 0.60054:  75%|███████▌  | 75/100 [03:47<01:07,  2.71s/it]Best trial: 21. Best value: 0.60054:  76%|███████▌  | 76/100 [03:47<01:00,  2.52s/it]Best trial: 21. Best value: 0.60054:  76%|███████▌  | 76/100 [03:53<01:00,  2.52s/it]Best trial: 21. Best value: 0.60054:  77%|███████▋  | 77/100 [03:53<01:21,  3.52s/it]Best trial: 77. Best value: 0.605875:  77%|███████▋  | 77/100 [03:56<01:21,  3.52s/it]Best trial: 77. Best value: 0.605875:  78%|███████▊  | 78/100 [03:56<01:13,  3.32s/it]Best trial: 77. Best value: 0.605875:  78%|███████▊  | 78/100 [03:59<01:13,  3.32s/it]Best trial: 77. Best value: 0.605875:  79%|███████▉  | 79/100 [03:59<01:11,  3.39s/it]Best trial: 77. Best value: 0.605875:  79%|███████▉  | 79/100 [04:02<01:11,  3.39s/it]Best trial: 77. Best value: 0.605875:  80%|████████  | 80/100 [04:02<01:06,  3.33s/it]Best trial: 77. Best value: 0.605875:  80%|████████  | 80/100 [04:05<01:06,  3.33s/it]Best trial: 77. Best value: 0.605875:  81%|████████  | 81/100 [04:05<01:02,  3.28s/it]Best trial: 77. Best value: 0.605875:  81%|████████  | 81/100 [04:09<01:02,  3.28s/it]Best trial: 77. Best value: 0.605875:  82%|████████▏ | 82/100 [04:09<00:59,  3.33s/it]Best trial: 77. Best value: 0.605875:  82%|████████▏ | 82/100 [04:12<00:59,  3.33s/it]Best trial: 77. Best value: 0.605875:  83%|████████▎ | 83/100 [04:12<00:56,  3.31s/it]Best trial: 77. Best value: 0.605875:  83%|████████▎ | 83/100 [04:16<00:56,  3.31s/it]Best trial: 77. Best value: 0.605875:  84%|████████▍ | 84/100 [04:16<00:55,  3.46s/it]Best trial: 77. Best value: 0.605875:  84%|████████▍ | 84/100 [04:18<00:55,  3.46s/it]Best trial: 77. Best value: 0.605875:  85%|████████▌ | 85/100 [04:18<00:46,  3.11s/it]Best trial: 77. Best value: 0.605875:  85%|████████▌ | 85/100 [04:22<00:46,  3.11s/it]Best trial: 77. Best value: 0.605875:  86%|████████▌ | 86/100 [04:22<00:44,  3.16s/it]Best trial: 77. Best value: 0.605875:  86%|████████▌ | 86/100 [04:25<00:44,  3.16s/it]Best trial: 77. Best value: 0.605875:  87%|████████▋ | 87/100 [04:25<00:42,  3.28s/it]Best trial: 77. Best value: 0.605875:  87%|████████▋ | 87/100 [04:27<00:42,  3.28s/it]Best trial: 77. Best value: 0.605875:  88%|████████▊ | 88/100 [04:27<00:34,  2.90s/it]Best trial: 77. Best value: 0.605875:  88%|████████▊ | 88/100 [04:31<00:34,  2.90s/it]Best trial: 77. Best value: 0.605875:  89%|████████▉ | 89/100 [04:31<00:36,  3.30s/it]Best trial: 77. Best value: 0.605875:  89%|████████▉ | 89/100 [04:34<00:36,  3.30s/it]Best trial: 77. Best value: 0.605875:  90%|█████████ | 90/100 [04:34<00:31,  3.16s/it]Best trial: 77. Best value: 0.605875:  90%|█████████ | 90/100 [04:37<00:31,  3.16s/it]Best trial: 77. Best value: 0.605875:  91%|█████████ | 91/100 [04:37<00:28,  3.14s/it]Best trial: 77. Best value: 0.605875:  91%|█████████ | 91/100 [04:41<00:28,  3.14s/it]Best trial: 77. Best value: 0.605875:  92%|█████████▏| 92/100 [04:41<00:25,  3.22s/it]Best trial: 77. Best value: 0.605875:  92%|█████████▏| 92/100 [04:44<00:25,  3.22s/it]Best trial: 77. Best value: 0.605875:  93%|█████████▎| 93/100 [04:44<00:21,  3.14s/it]Best trial: 77. Best value: 0.605875:  93%|█████████▎| 93/100 [04:48<00:21,  3.14s/it]Best trial: 77. Best value: 0.605875:  94%|█████████▍| 94/100 [04:48<00:20,  3.45s/it]Best trial: 77. Best value: 0.605875:  94%|█████████▍| 94/100 [04:50<00:20,  3.45s/it]Best trial: 77. Best value: 0.605875:  95%|█████████▌| 95/100 [04:50<00:15,  3.18s/it]Best trial: 77. Best value: 0.605875:  95%|█████████▌| 95/100 [04:53<00:15,  3.18s/it]Best trial: 77. Best value: 0.605875:  96%|█████████▌| 96/100 [04:53<00:11,  2.93s/it]Best trial: 77. Best value: 0.605875:  96%|█████████▌| 96/100 [04:55<00:11,  2.93s/it]Best trial: 77. Best value: 0.605875:  97%|█████████▋| 97/100 [04:55<00:08,  2.89s/it]Best trial: 77. Best value: 0.605875:  97%|█████████▋| 97/100 [04:57<00:08,  2.89s/it]Best trial: 77. Best value: 0.605875:  98%|█████████▊| 98/100 [04:57<00:05,  2.59s/it]Best trial: 77. Best value: 0.605875:  98%|█████████▊| 98/100 [05:02<00:05,  2.59s/it]Best trial: 77. Best value: 0.605875:  99%|█████████▉| 99/100 [05:02<00:03,  3.29s/it]Best trial: 77. Best value: 0.605875:  99%|█████████▉| 99/100 [05:05<00:03,  3.29s/it]Best trial: 77. Best value: 0.605875: 100%|██████████| 100/100 [05:05<00:00,  3.25s/it]Best trial: 77. Best value: 0.605875: 100%|██████████| 100/100 [05:05<00:00,  3.06s/it]
2025-11-30 18:07:13,527 - INFO - HPO Complete. Best AUPRC: 0.6059
2025-11-30 18:07:13,528 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.032764823727344176, 'max_depth': 5, 'subsample': 0.6547307672819268, 'colsample_bytree': 0.7320338595142598, 'gamma': 3.047371481768663, 'reg_lambda': 1.369646278992547e-05, 'reg_alpha': 0.002691155191380956}
2025-11-30 18:07:13,529 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:07:15,599 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_ecg
2025-11-30 18:07:15,599 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:07:15,687 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:07:15,710 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:07:15,716 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:07:15,716 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:07:15,716 - INFO - Training model...
2025-11-30 18:07:17,320 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:07:22,675 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:07:22,676 - INFO - AUROC: 0.7778 (0.7495 - 0.8015)
2025-11-30 18:07:22,676 - INFO - AUPRC: 0.5455 (0.4897 - 0.6164)
2025-11-30 18:07:22,676 - INFO - Brier Score: 0.1537 (0.1431 - 0.1675)
2025-11-30 18:07:22,676 - INFO - Accuracy: 0.7543 (0.6882 - 0.8110)
2025-11-30 18:07:22,676 - INFO - Precision: 0.4730 (0.4097 - 0.5705)
2025-11-30 18:07:22,676 - INFO - Sensitivity (Recall): 0.6646 (0.5340 - 0.7626)
2025-11-30 18:07:22,676 - INFO - F1-Score: 0.5526 (0.5135 - 0.6121)
2025-11-30 18:07:22,676 - INFO - Best Threshold: 0.3600 (0.2560 - 0.5300)
2025-11-30 18:07:22,676 - INFO - Specificity: 0.7809 (0.6666 - 0.8817)
2025-11-30 18:07:22,694 - INFO - Calculating SHAP values...
2025-11-30 18:07:23,764 - INFO - SHAP plots saved.
2025-11-30 18:07:23,767 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:07:25,091 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 18:07:25,091 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:07:25,176 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:07:25,199 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:07:25,205 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:07:25,205 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.585533:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.585533:   1%|          | 1/100 [00:04<06:56,  4.20s/it]Best trial: 0. Best value: 0.585533:   1%|          | 1/100 [00:09<06:56,  4.20s/it]Best trial: 0. Best value: 0.585533:   2%|▏         | 2/100 [00:09<07:31,  4.61s/it]Best trial: 0. Best value: 0.585533:   2%|▏         | 2/100 [00:12<07:31,  4.61s/it]Best trial: 0. Best value: 0.585533:   3%|▎         | 3/100 [00:12<06:54,  4.27s/it]Best trial: 0. Best value: 0.585533:   3%|▎         | 3/100 [00:15<06:54,  4.27s/it]Best trial: 0. Best value: 0.585533:   4%|▍         | 4/100 [00:15<05:36,  3.51s/it]Best trial: 0. Best value: 0.585533:   4%|▍         | 4/100 [00:17<05:36,  3.51s/it]Best trial: 0. Best value: 0.585533:   5%|▌         | 5/100 [00:17<04:44,  3.00s/it]Best trial: 0. Best value: 0.585533:   5%|▌         | 5/100 [00:18<04:44,  3.00s/it]Best trial: 0. Best value: 0.585533:   6%|▌         | 6/100 [00:18<03:49,  2.45s/it]Best trial: 6. Best value: 0.587793:   6%|▌         | 6/100 [00:22<03:49,  2.45s/it]Best trial: 6. Best value: 0.587793:   7%|▋         | 7/100 [00:22<04:25,  2.85s/it]Best trial: 7. Best value: 0.594381:   7%|▋         | 7/100 [00:23<04:25,  2.85s/it]Best trial: 7. Best value: 0.594381:   8%|▊         | 8/100 [00:23<03:43,  2.43s/it]Best trial: 7. Best value: 0.594381:   8%|▊         | 8/100 [00:28<03:43,  2.43s/it]Best trial: 7. Best value: 0.594381:   9%|▉         | 9/100 [00:28<04:42,  3.11s/it]Best trial: 7. Best value: 0.594381:   9%|▉         | 9/100 [00:30<04:42,  3.11s/it]Best trial: 7. Best value: 0.594381:  10%|█         | 10/100 [00:30<03:57,  2.64s/it]Best trial: 10. Best value: 0.598495:  10%|█         | 10/100 [00:31<03:57,  2.64s/it]Best trial: 10. Best value: 0.598495:  11%|█         | 11/100 [00:31<03:32,  2.38s/it]Best trial: 11. Best value: 0.599725:  11%|█         | 11/100 [00:33<03:32,  2.38s/it]Best trial: 11. Best value: 0.599725:  12%|█▏        | 12/100 [00:33<03:07,  2.13s/it]Best trial: 12. Best value: 0.600776:  12%|█▏        | 12/100 [00:36<03:07,  2.13s/it]Best trial: 12. Best value: 0.600776:  13%|█▎        | 13/100 [00:36<03:24,  2.35s/it]Best trial: 12. Best value: 0.600776:  13%|█▎        | 13/100 [00:39<03:24,  2.35s/it]Best trial: 12. Best value: 0.600776:  14%|█▍        | 14/100 [00:39<03:52,  2.70s/it]Best trial: 12. Best value: 0.600776:  14%|█▍        | 14/100 [00:42<03:52,  2.70s/it]Best trial: 12. Best value: 0.600776:  15%|█▌        | 15/100 [00:42<03:49,  2.70s/it]Best trial: 12. Best value: 0.600776:  15%|█▌        | 15/100 [00:45<03:49,  2.70s/it]Best trial: 12. Best value: 0.600776:  16%|█▌        | 16/100 [00:45<03:45,  2.68s/it]Best trial: 12. Best value: 0.600776:  16%|█▌        | 16/100 [00:48<03:45,  2.68s/it]Best trial: 12. Best value: 0.600776:  17%|█▋        | 17/100 [00:48<04:04,  2.94s/it]Best trial: 12. Best value: 0.600776:  17%|█▋        | 17/100 [00:52<04:04,  2.94s/it]Best trial: 12. Best value: 0.600776:  18%|█▊        | 18/100 [00:52<04:17,  3.14s/it]Best trial: 12. Best value: 0.600776:  18%|█▊        | 18/100 [00:54<04:17,  3.14s/it]Best trial: 12. Best value: 0.600776:  19%|█▉        | 19/100 [00:54<03:42,  2.75s/it]Best trial: 12. Best value: 0.600776:  19%|█▉        | 19/100 [00:57<03:42,  2.75s/it]Best trial: 12. Best value: 0.600776:  20%|██        | 20/100 [00:57<03:53,  2.92s/it]Best trial: 12. Best value: 0.600776:  20%|██        | 20/100 [00:59<03:53,  2.92s/it]Best trial: 12. Best value: 0.600776:  21%|██        | 21/100 [00:59<03:38,  2.77s/it]Best trial: 12. Best value: 0.600776:  21%|██        | 21/100 [01:02<03:38,  2.77s/it]Best trial: 12. Best value: 0.600776:  22%|██▏       | 22/100 [01:02<03:33,  2.73s/it]Best trial: 12. Best value: 0.600776:  22%|██▏       | 22/100 [01:06<03:33,  2.73s/it]Best trial: 12. Best value: 0.600776:  23%|██▎       | 23/100 [01:06<03:59,  3.12s/it]Best trial: 12. Best value: 0.600776:  23%|██▎       | 23/100 [01:09<03:59,  3.12s/it]Best trial: 12. Best value: 0.600776:  24%|██▍       | 24/100 [01:09<03:50,  3.04s/it]Best trial: 12. Best value: 0.600776:  24%|██▍       | 24/100 [01:11<03:50,  3.04s/it]Best trial: 12. Best value: 0.600776:  25%|██▌       | 25/100 [01:11<03:32,  2.83s/it]Best trial: 12. Best value: 0.600776:  25%|██▌       | 25/100 [01:13<03:32,  2.83s/it]Best trial: 12. Best value: 0.600776:  26%|██▌       | 26/100 [01:13<03:06,  2.51s/it]Best trial: 12. Best value: 0.600776:  26%|██▌       | 26/100 [01:15<03:06,  2.51s/it]Best trial: 12. Best value: 0.600776:  27%|██▋       | 27/100 [01:15<02:47,  2.30s/it]Best trial: 12. Best value: 0.600776:  27%|██▋       | 27/100 [01:17<02:47,  2.30s/it]Best trial: 12. Best value: 0.600776:  28%|██▊       | 28/100 [01:17<02:35,  2.16s/it]Best trial: 12. Best value: 0.600776:  28%|██▊       | 28/100 [01:20<02:35,  2.16s/it]Best trial: 12. Best value: 0.600776:  29%|██▉       | 29/100 [01:20<03:03,  2.59s/it]Best trial: 12. Best value: 0.600776:  29%|██▉       | 29/100 [01:23<03:03,  2.59s/it]Best trial: 12. Best value: 0.600776:  30%|███       | 30/100 [01:23<03:05,  2.65s/it]Best trial: 12. Best value: 0.600776:  30%|███       | 30/100 [01:28<03:05,  2.65s/it]Best trial: 12. Best value: 0.600776:  31%|███       | 31/100 [01:28<03:47,  3.30s/it]Best trial: 12. Best value: 0.600776:  31%|███       | 31/100 [01:31<03:47,  3.30s/it]Best trial: 12. Best value: 0.600776:  32%|███▏      | 32/100 [01:31<03:33,  3.15s/it]Best trial: 32. Best value: 0.60356:  32%|███▏      | 32/100 [01:33<03:33,  3.15s/it] Best trial: 32. Best value: 0.60356:  33%|███▎      | 33/100 [01:33<03:15,  2.91s/it]Best trial: 32. Best value: 0.60356:  33%|███▎      | 33/100 [01:35<03:15,  2.91s/it]Best trial: 32. Best value: 0.60356:  34%|███▍      | 34/100 [01:35<02:53,  2.63s/it]Best trial: 32. Best value: 0.60356:  34%|███▍      | 34/100 [01:38<02:53,  2.63s/it]Best trial: 32. Best value: 0.60356:  35%|███▌      | 35/100 [01:38<02:48,  2.59s/it]Best trial: 32. Best value: 0.60356:  35%|███▌      | 35/100 [01:41<02:48,  2.59s/it]Best trial: 32. Best value: 0.60356:  36%|███▌      | 36/100 [01:41<03:00,  2.82s/it]Best trial: 32. Best value: 0.60356:  36%|███▌      | 36/100 [01:43<03:00,  2.82s/it]Best trial: 32. Best value: 0.60356:  37%|███▋      | 37/100 [01:43<02:43,  2.60s/it]Best trial: 32. Best value: 0.60356:  37%|███▋      | 37/100 [01:45<02:43,  2.60s/it]Best trial: 32. Best value: 0.60356:  38%|███▊      | 38/100 [01:45<02:25,  2.34s/it]Best trial: 32. Best value: 0.60356:  38%|███▊      | 38/100 [01:46<02:25,  2.34s/it]Best trial: 32. Best value: 0.60356:  39%|███▉      | 39/100 [01:46<02:08,  2.11s/it]Best trial: 32. Best value: 0.60356:  39%|███▉      | 39/100 [01:49<02:08,  2.11s/it]Best trial: 32. Best value: 0.60356:  40%|████      | 40/100 [01:49<02:16,  2.28s/it]Best trial: 32. Best value: 0.60356:  40%|████      | 40/100 [01:52<02:16,  2.28s/it]Best trial: 32. Best value: 0.60356:  41%|████      | 41/100 [01:52<02:18,  2.36s/it]Best trial: 32. Best value: 0.60356:  41%|████      | 41/100 [01:54<02:18,  2.36s/it]Best trial: 32. Best value: 0.60356:  42%|████▏     | 42/100 [01:54<02:24,  2.48s/it]Best trial: 32. Best value: 0.60356:  42%|████▏     | 42/100 [01:56<02:24,  2.48s/it]Best trial: 32. Best value: 0.60356:  43%|████▎     | 43/100 [01:56<02:12,  2.33s/it]Best trial: 32. Best value: 0.60356:  43%|████▎     | 43/100 [01:58<02:12,  2.33s/it]Best trial: 32. Best value: 0.60356:  44%|████▍     | 44/100 [01:58<02:03,  2.21s/it]Best trial: 32. Best value: 0.60356:  44%|████▍     | 44/100 [02:00<02:03,  2.21s/it]Best trial: 32. Best value: 0.60356:  45%|████▌     | 45/100 [02:00<01:56,  2.13s/it]Best trial: 32. Best value: 0.60356:  45%|████▌     | 45/100 [02:02<01:56,  2.13s/it]Best trial: 32. Best value: 0.60356:  46%|████▌     | 46/100 [02:02<01:50,  2.04s/it]Best trial: 32. Best value: 0.60356:  46%|████▌     | 46/100 [02:03<01:50,  2.04s/it]Best trial: 32. Best value: 0.60356:  47%|████▋     | 47/100 [02:03<01:39,  1.88s/it]Best trial: 32. Best value: 0.60356:  47%|████▋     | 47/100 [02:06<01:39,  1.88s/it]Best trial: 32. Best value: 0.60356:  48%|████▊     | 48/100 [02:06<01:40,  1.94s/it]Best trial: 32. Best value: 0.60356:  48%|████▊     | 48/100 [02:08<01:40,  1.94s/it]Best trial: 32. Best value: 0.60356:  49%|████▉     | 49/100 [02:08<01:44,  2.05s/it]Best trial: 32. Best value: 0.60356:  49%|████▉     | 49/100 [02:09<01:44,  2.05s/it]Best trial: 32. Best value: 0.60356:  50%|█████     | 50/100 [02:09<01:34,  1.89s/it]Best trial: 32. Best value: 0.60356:  50%|█████     | 50/100 [02:11<01:34,  1.89s/it]Best trial: 32. Best value: 0.60356:  51%|█████     | 51/100 [02:11<01:35,  1.95s/it]Best trial: 51. Best value: 0.604776:  51%|█████     | 51/100 [02:13<01:35,  1.95s/it]Best trial: 51. Best value: 0.604776:  52%|█████▏    | 52/100 [02:13<01:30,  1.88s/it]Best trial: 51. Best value: 0.604776:  52%|█████▏    | 52/100 [02:15<01:30,  1.88s/it]Best trial: 51. Best value: 0.604776:  53%|█████▎    | 53/100 [02:15<01:29,  1.89s/it]Best trial: 51. Best value: 0.604776:  53%|█████▎    | 53/100 [02:17<01:29,  1.89s/it]Best trial: 51. Best value: 0.604776:  54%|█████▍    | 54/100 [02:17<01:28,  1.92s/it]Best trial: 51. Best value: 0.604776:  54%|█████▍    | 54/100 [02:20<01:28,  1.92s/it]Best trial: 51. Best value: 0.604776:  55%|█████▌    | 55/100 [02:20<01:36,  2.13s/it]Best trial: 51. Best value: 0.604776:  55%|█████▌    | 55/100 [02:22<01:36,  2.13s/it]Best trial: 51. Best value: 0.604776:  56%|█████▌    | 56/100 [02:22<01:42,  2.32s/it]Best trial: 51. Best value: 0.604776:  56%|█████▌    | 56/100 [02:25<01:42,  2.32s/it]Best trial: 51. Best value: 0.604776:  57%|█████▋    | 57/100 [02:25<01:41,  2.36s/it]Best trial: 51. Best value: 0.604776:  57%|█████▋    | 57/100 [02:27<01:41,  2.36s/it]Best trial: 51. Best value: 0.604776:  58%|█████▊    | 58/100 [02:27<01:34,  2.25s/it]Best trial: 51. Best value: 0.604776:  58%|█████▊    | 58/100 [02:30<01:34,  2.25s/it]Best trial: 51. Best value: 0.604776:  59%|█████▉    | 59/100 [02:30<01:45,  2.58s/it]Best trial: 51. Best value: 0.604776:  59%|█████▉    | 59/100 [02:34<01:45,  2.58s/it]Best trial: 51. Best value: 0.604776:  60%|██████    | 60/100 [02:34<01:56,  2.92s/it]Best trial: 51. Best value: 0.604776:  60%|██████    | 60/100 [02:38<01:56,  2.92s/it]Best trial: 51. Best value: 0.604776:  61%|██████    | 61/100 [02:38<02:05,  3.22s/it]Best trial: 51. Best value: 0.604776:  61%|██████    | 61/100 [02:40<02:05,  3.22s/it]Best trial: 51. Best value: 0.604776:  62%|██████▏   | 62/100 [02:40<01:51,  2.94s/it]Best trial: 51. Best value: 0.604776:  62%|██████▏   | 62/100 [02:43<01:51,  2.94s/it]Best trial: 51. Best value: 0.604776:  63%|██████▎   | 63/100 [02:43<01:46,  2.87s/it]Best trial: 51. Best value: 0.604776:  63%|██████▎   | 63/100 [02:45<01:46,  2.87s/it]Best trial: 51. Best value: 0.604776:  64%|██████▍   | 64/100 [02:45<01:36,  2.67s/it]Best trial: 51. Best value: 0.604776:  64%|██████▍   | 64/100 [02:47<01:36,  2.67s/it]Best trial: 51. Best value: 0.604776:  65%|██████▌   | 65/100 [02:47<01:24,  2.42s/it]Best trial: 51. Best value: 0.604776:  65%|██████▌   | 65/100 [02:49<01:24,  2.42s/it]Best trial: 51. Best value: 0.604776:  66%|██████▌   | 66/100 [02:49<01:16,  2.24s/it]Best trial: 51. Best value: 0.604776:  66%|██████▌   | 66/100 [02:51<01:16,  2.24s/it]Best trial: 51. Best value: 0.604776:  67%|██████▋   | 67/100 [02:51<01:13,  2.22s/it]Best trial: 51. Best value: 0.604776:  67%|██████▋   | 67/100 [02:53<01:13,  2.22s/it]Best trial: 51. Best value: 0.604776:  68%|██████▊   | 68/100 [02:53<01:11,  2.24s/it]Best trial: 51. Best value: 0.604776:  68%|██████▊   | 68/100 [02:55<01:11,  2.24s/it]Best trial: 51. Best value: 0.604776:  69%|██████▉   | 69/100 [02:55<01:06,  2.15s/it]Best trial: 51. Best value: 0.604776:  69%|██████▉   | 69/100 [03:09<01:06,  2.15s/it]Best trial: 51. Best value: 0.604776:  70%|███████   | 70/100 [03:09<02:47,  5.59s/it]Best trial: 51. Best value: 0.604776:  70%|███████   | 70/100 [03:11<02:47,  5.59s/it]Best trial: 51. Best value: 0.604776:  71%|███████   | 71/100 [03:11<02:13,  4.61s/it]Best trial: 51. Best value: 0.604776:  71%|███████   | 71/100 [03:14<02:13,  4.61s/it]Best trial: 51. Best value: 0.604776:  72%|███████▏  | 72/100 [03:14<01:53,  4.06s/it]Best trial: 51. Best value: 0.604776:  72%|███████▏  | 72/100 [03:16<01:53,  4.06s/it]Best trial: 51. Best value: 0.604776:  73%|███████▎  | 73/100 [03:16<01:34,  3.49s/it]Best trial: 51. Best value: 0.604776:  73%|███████▎  | 73/100 [03:18<01:34,  3.49s/it]Best trial: 51. Best value: 0.604776:  74%|███████▍  | 74/100 [03:18<01:18,  3.01s/it]Best trial: 51. Best value: 0.604776:  74%|███████▍  | 74/100 [03:19<01:18,  3.01s/it]Best trial: 51. Best value: 0.604776:  75%|███████▌  | 75/100 [03:19<01:04,  2.57s/it]Best trial: 51. Best value: 0.604776:  75%|███████▌  | 75/100 [03:21<01:04,  2.57s/it]Best trial: 51. Best value: 0.604776:  76%|███████▌  | 76/100 [03:21<00:57,  2.38s/it]Best trial: 51. Best value: 0.604776:  76%|███████▌  | 76/100 [03:24<00:57,  2.38s/it]Best trial: 51. Best value: 0.604776:  77%|███████▋  | 77/100 [03:24<00:53,  2.31s/it]Best trial: 51. Best value: 0.604776:  77%|███████▋  | 77/100 [03:25<00:53,  2.31s/it]Best trial: 51. Best value: 0.604776:  78%|███████▊  | 78/100 [03:25<00:45,  2.05s/it]Best trial: 51. Best value: 0.604776:  78%|███████▊  | 78/100 [03:27<00:45,  2.05s/it]Best trial: 51. Best value: 0.604776:  79%|███████▉  | 79/100 [03:27<00:40,  1.93s/it]Best trial: 51. Best value: 0.604776:  79%|███████▉  | 79/100 [03:29<00:40,  1.93s/it]Best trial: 51. Best value: 0.604776:  80%|████████  | 80/100 [03:29<00:40,  2.03s/it]Best trial: 51. Best value: 0.604776:  80%|████████  | 80/100 [03:30<00:40,  2.03s/it]Best trial: 51. Best value: 0.604776:  81%|████████  | 81/100 [03:30<00:35,  1.88s/it]Best trial: 51. Best value: 0.604776:  81%|████████  | 81/100 [03:32<00:35,  1.88s/it]Best trial: 51. Best value: 0.604776:  82%|████████▏ | 82/100 [03:32<00:33,  1.89s/it]Best trial: 51. Best value: 0.604776:  82%|████████▏ | 82/100 [03:34<00:33,  1.89s/it]Best trial: 51. Best value: 0.604776:  83%|████████▎ | 83/100 [03:34<00:30,  1.81s/it]Best trial: 51. Best value: 0.604776:  83%|████████▎ | 83/100 [03:36<00:30,  1.81s/it]Best trial: 51. Best value: 0.604776:  84%|████████▍ | 84/100 [03:36<00:29,  1.82s/it]Best trial: 51. Best value: 0.604776:  84%|████████▍ | 84/100 [03:38<00:29,  1.82s/it]Best trial: 51. Best value: 0.604776:  85%|████████▌ | 85/100 [03:38<00:28,  1.88s/it]Best trial: 51. Best value: 0.604776:  85%|████████▌ | 85/100 [03:40<00:28,  1.88s/it]Best trial: 51. Best value: 0.604776:  86%|████████▌ | 86/100 [03:40<00:27,  1.94s/it]Best trial: 51. Best value: 0.604776:  86%|████████▌ | 86/100 [03:42<00:27,  1.94s/it]Best trial: 51. Best value: 0.604776:  87%|████████▋ | 87/100 [03:42<00:26,  2.06s/it]Best trial: 51. Best value: 0.604776:  87%|████████▋ | 87/100 [03:45<00:26,  2.06s/it]Best trial: 51. Best value: 0.604776:  88%|████████▊ | 88/100 [03:45<00:27,  2.31s/it]Best trial: 51. Best value: 0.604776:  88%|████████▊ | 88/100 [03:47<00:27,  2.31s/it]Best trial: 51. Best value: 0.604776:  89%|████████▉ | 89/100 [03:47<00:24,  2.23s/it]Best trial: 51. Best value: 0.604776:  89%|████████▉ | 89/100 [03:49<00:24,  2.23s/it]Best trial: 51. Best value: 0.604776:  90%|█████████ | 90/100 [03:49<00:20,  2.04s/it]Best trial: 51. Best value: 0.604776:  90%|█████████ | 90/100 [03:51<00:20,  2.04s/it]Best trial: 51. Best value: 0.604776:  91%|█████████ | 91/100 [03:51<00:19,  2.15s/it]Best trial: 51. Best value: 0.604776:  91%|█████████ | 91/100 [03:53<00:19,  2.15s/it]Best trial: 51. Best value: 0.604776:  92%|█████████▏| 92/100 [03:53<00:16,  2.04s/it]Best trial: 51. Best value: 0.604776:  92%|█████████▏| 92/100 [03:55<00:16,  2.04s/it]Best trial: 51. Best value: 0.604776:  93%|█████████▎| 93/100 [03:55<00:13,  1.97s/it]Best trial: 51. Best value: 0.604776:  93%|█████████▎| 93/100 [03:57<00:13,  1.97s/it]Best trial: 51. Best value: 0.604776:  94%|█████████▍| 94/100 [03:57<00:11,  1.97s/it]Best trial: 51. Best value: 0.604776:  94%|█████████▍| 94/100 [04:00<00:11,  1.97s/it]Best trial: 51. Best value: 0.604776:  95%|█████████▌| 95/100 [04:00<00:11,  2.36s/it]Best trial: 51. Best value: 0.604776:  95%|█████████▌| 95/100 [04:02<00:11,  2.36s/it]Best trial: 51. Best value: 0.604776:  96%|█████████▌| 96/100 [04:02<00:09,  2.32s/it]Best trial: 96. Best value: 0.607214:  96%|█████████▌| 96/100 [04:05<00:09,  2.32s/it]Best trial: 96. Best value: 0.607214:  97%|█████████▋| 97/100 [04:05<00:07,  2.36s/it]Best trial: 96. Best value: 0.607214:  97%|█████████▋| 97/100 [04:11<00:07,  2.36s/it]Best trial: 96. Best value: 0.607214:  98%|█████████▊| 98/100 [04:11<00:06,  3.44s/it]Best trial: 96. Best value: 0.607214:  98%|█████████▊| 98/100 [04:14<00:06,  3.44s/it]Best trial: 96. Best value: 0.607214:  99%|█████████▉| 99/100 [04:14<00:03,  3.39s/it]Best trial: 96. Best value: 0.607214:  99%|█████████▉| 99/100 [04:16<00:03,  3.39s/it]Best trial: 96. Best value: 0.607214: 100%|██████████| 100/100 [04:16<00:00,  3.04s/it]Best trial: 96. Best value: 0.607214: 100%|██████████| 100/100 [04:16<00:00,  2.57s/it]
2025-11-30 18:11:41,836 - INFO - HPO Complete. Best AUPRC: 0.6072
2025-11-30 18:11:41,836 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.05021176643071243, 'max_depth': 4, 'subsample': 0.9126044216074608, 'colsample_bytree': 0.6857159240942753, 'gamma': 0.29622229959174756, 'reg_lambda': 0.6573717146597633, 'reg_alpha': 0.08937442809414624}
2025-11-30 18:11:41,837 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:11:43,650 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_co2
2025-11-30 18:11:43,650 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:11:43,738 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:11:43,760 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:11:43,765 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:11:43,765 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:11:43,765 - INFO - Training model...
2025-11-30 18:11:45,106 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:11:50,431 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:11:50,431 - INFO - AUROC: 0.7989 (0.7587 - 0.8222)
2025-11-30 18:11:50,431 - INFO - AUPRC: 0.5236 (0.4696 - 0.5979)
2025-11-30 18:11:50,431 - INFO - Brier Score: 0.1509 (0.1426 - 0.1644)
2025-11-30 18:11:50,431 - INFO - Accuracy: 0.7283 (0.6720 - 0.8038)
2025-11-30 18:11:50,431 - INFO - Precision: 0.4436 (0.3989 - 0.5567)
2025-11-30 18:11:50,431 - INFO - Sensitivity (Recall): 0.7468 (0.5751 - 0.8563)
2025-11-30 18:11:50,431 - INFO - F1-Score: 0.5566 (0.5102 - 0.5983)
2025-11-30 18:11:50,432 - INFO - Best Threshold: 0.2700 (0.1700 - 0.4900)
2025-11-30 18:11:50,432 - INFO - Specificity: 0.7228 (0.6127 - 0.8707)
2025-11-30 18:11:50,448 - INFO - Calculating SHAP values...
2025-11-30 18:11:51,477 - INFO - SHAP plots saved.
2025-11-30 18:11:51,478 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:11:52,645 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 18:11:52,645 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:11:52,729 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:11:52,753 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:11:52,759 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:11:52,759 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.604829:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.604829:   1%|          | 1/100 [00:04<07:51,  4.76s/it]Best trial: 0. Best value: 0.604829:   1%|          | 1/100 [00:10<07:51,  4.76s/it]Best trial: 0. Best value: 0.604829:   2%|▏         | 2/100 [00:10<08:47,  5.38s/it]Best trial: 0. Best value: 0.604829:   2%|▏         | 2/100 [00:17<08:47,  5.38s/it]Best trial: 0. Best value: 0.604829:   3%|▎         | 3/100 [00:17<09:33,  5.91s/it]Best trial: 0. Best value: 0.604829:   3%|▎         | 3/100 [00:23<09:33,  5.91s/it]Best trial: 0. Best value: 0.604829:   4%|▍         | 4/100 [00:23<09:53,  6.18s/it]Best trial: 0. Best value: 0.604829:   4%|▍         | 4/100 [00:28<09:53,  6.18s/it]Best trial: 0. Best value: 0.604829:   5%|▌         | 5/100 [00:28<08:45,  5.53s/it]Best trial: 0. Best value: 0.604829:   5%|▌         | 5/100 [00:29<08:45,  5.53s/it]Best trial: 0. Best value: 0.604829:   6%|▌         | 6/100 [00:29<06:41,  4.27s/it]Best trial: 0. Best value: 0.604829:   6%|▌         | 6/100 [00:34<06:41,  4.27s/it]Best trial: 0. Best value: 0.604829:   7%|▋         | 7/100 [00:34<06:48,  4.40s/it]Best trial: 0. Best value: 0.604829:   7%|▋         | 7/100 [00:39<06:48,  4.40s/it]Best trial: 0. Best value: 0.604829:   8%|▊         | 8/100 [00:39<06:58,  4.55s/it]Best trial: 0. Best value: 0.604829:   8%|▊         | 8/100 [00:41<06:58,  4.55s/it]Best trial: 0. Best value: 0.604829:   9%|▉         | 9/100 [00:41<05:29,  3.62s/it]Best trial: 0. Best value: 0.604829:   9%|▉         | 9/100 [00:45<05:29,  3.62s/it]Best trial: 0. Best value: 0.604829:  10%|█         | 10/100 [00:45<05:40,  3.78s/it]Best trial: 0. Best value: 0.604829:  10%|█         | 10/100 [00:50<05:40,  3.78s/it]Best trial: 0. Best value: 0.604829:  11%|█         | 11/100 [00:50<06:09,  4.15s/it]Best trial: 0. Best value: 0.604829:  11%|█         | 11/100 [00:56<06:09,  4.15s/it]Best trial: 0. Best value: 0.604829:  12%|█▏        | 12/100 [00:56<06:59,  4.77s/it]Best trial: 0. Best value: 0.604829:  12%|█▏        | 12/100 [01:02<06:59,  4.77s/it]Best trial: 0. Best value: 0.604829:  13%|█▎        | 13/100 [01:02<07:18,  5.04s/it]Best trial: 0. Best value: 0.604829:  13%|█▎        | 13/100 [01:07<07:18,  5.04s/it]Best trial: 0. Best value: 0.604829:  14%|█▍        | 14/100 [01:07<07:29,  5.23s/it]Best trial: 0. Best value: 0.604829:  14%|█▍        | 14/100 [01:11<07:29,  5.23s/it]Best trial: 0. Best value: 0.604829:  15%|█▌        | 15/100 [01:11<06:45,  4.77s/it]Best trial: 0. Best value: 0.604829:  15%|█▌        | 15/100 [01:13<06:45,  4.77s/it]Best trial: 0. Best value: 0.604829:  16%|█▌        | 16/100 [01:13<05:35,  3.99s/it]Best trial: 0. Best value: 0.604829:  16%|█▌        | 16/100 [01:16<05:35,  3.99s/it]Best trial: 0. Best value: 0.604829:  17%|█▋        | 17/100 [01:16<05:07,  3.70s/it]Best trial: 0. Best value: 0.604829:  17%|█▋        | 17/100 [01:21<05:07,  3.70s/it]Best trial: 0. Best value: 0.604829:  18%|█▊        | 18/100 [01:21<05:24,  3.95s/it]Best trial: 0. Best value: 0.604829:  18%|█▊        | 18/100 [01:25<05:24,  3.95s/it]Best trial: 0. Best value: 0.604829:  19%|█▉        | 19/100 [01:25<05:20,  3.95s/it]Best trial: 0. Best value: 0.604829:  19%|█▉        | 19/100 [01:27<05:20,  3.95s/it]Best trial: 0. Best value: 0.604829:  20%|██        | 20/100 [01:27<04:28,  3.35s/it]Best trial: 0. Best value: 0.604829:  20%|██        | 20/100 [01:29<04:28,  3.35s/it]Best trial: 0. Best value: 0.604829:  21%|██        | 21/100 [01:29<04:11,  3.18s/it]Best trial: 0. Best value: 0.604829:  21%|██        | 21/100 [01:34<04:11,  3.18s/it]Best trial: 0. Best value: 0.604829:  22%|██▏       | 22/100 [01:34<04:52,  3.75s/it]Best trial: 0. Best value: 0.604829:  22%|██▏       | 22/100 [01:38<04:52,  3.75s/it]Best trial: 0. Best value: 0.604829:  23%|██▎       | 23/100 [01:38<04:55,  3.84s/it]Best trial: 0. Best value: 0.604829:  23%|██▎       | 23/100 [01:41<04:55,  3.84s/it]Best trial: 0. Best value: 0.604829:  24%|██▍       | 24/100 [01:41<04:33,  3.60s/it]Best trial: 0. Best value: 0.604829:  24%|██▍       | 24/100 [01:44<04:33,  3.60s/it]Best trial: 0. Best value: 0.604829:  25%|██▌       | 25/100 [01:44<04:10,  3.33s/it]Best trial: 0. Best value: 0.604829:  25%|██▌       | 25/100 [01:47<04:10,  3.33s/it]Best trial: 0. Best value: 0.604829:  26%|██▌       | 26/100 [01:47<03:47,  3.07s/it]Best trial: 0. Best value: 0.604829:  26%|██▌       | 26/100 [01:49<03:47,  3.07s/it]Best trial: 0. Best value: 0.604829:  27%|██▋       | 27/100 [01:49<03:27,  2.84s/it]Best trial: 0. Best value: 0.604829:  27%|██▋       | 27/100 [01:51<03:27,  2.84s/it]Best trial: 0. Best value: 0.604829:  28%|██▊       | 28/100 [01:51<03:01,  2.52s/it]Best trial: 0. Best value: 0.604829:  28%|██▊       | 28/100 [01:55<03:01,  2.52s/it]Best trial: 0. Best value: 0.604829:  29%|██▉       | 29/100 [01:55<03:31,  2.97s/it]Best trial: 0. Best value: 0.604829:  29%|██▉       | 29/100 [02:01<03:31,  2.97s/it]Best trial: 0. Best value: 0.604829:  30%|███       | 30/100 [02:01<04:44,  4.06s/it]Best trial: 0. Best value: 0.604829:  30%|███       | 30/100 [02:04<04:44,  4.06s/it]Best trial: 0. Best value: 0.604829:  31%|███       | 31/100 [02:04<04:06,  3.57s/it]Best trial: 0. Best value: 0.604829:  31%|███       | 31/100 [02:06<04:06,  3.57s/it]Best trial: 0. Best value: 0.604829:  32%|███▏      | 32/100 [02:06<03:41,  3.25s/it]Best trial: 0. Best value: 0.604829:  32%|███▏      | 32/100 [02:09<03:41,  3.25s/it]Best trial: 0. Best value: 0.604829:  33%|███▎      | 33/100 [02:09<03:31,  3.16s/it]Best trial: 33. Best value: 0.605306:  33%|███▎      | 33/100 [02:11<03:31,  3.16s/it]Best trial: 33. Best value: 0.605306:  34%|███▍      | 34/100 [02:11<03:07,  2.85s/it]Best trial: 33. Best value: 0.605306:  34%|███▍      | 34/100 [02:16<03:07,  2.85s/it]Best trial: 33. Best value: 0.605306:  35%|███▌      | 35/100 [02:16<03:42,  3.42s/it]Best trial: 33. Best value: 0.605306:  35%|███▌      | 35/100 [02:18<03:42,  3.42s/it]Best trial: 33. Best value: 0.605306:  36%|███▌      | 36/100 [02:18<03:14,  3.03s/it]Best trial: 33. Best value: 0.605306:  36%|███▌      | 36/100 [02:20<03:14,  3.03s/it]Best trial: 33. Best value: 0.605306:  37%|███▋      | 37/100 [02:20<02:56,  2.79s/it]Best trial: 33. Best value: 0.605306:  37%|███▋      | 37/100 [02:26<02:56,  2.79s/it]Best trial: 33. Best value: 0.605306:  38%|███▊      | 38/100 [02:26<03:42,  3.59s/it]Best trial: 33. Best value: 0.605306:  38%|███▊      | 38/100 [02:29<03:42,  3.59s/it]Best trial: 33. Best value: 0.605306:  39%|███▉      | 39/100 [02:29<03:22,  3.32s/it]Best trial: 33. Best value: 0.605306:  39%|███▉      | 39/100 [02:32<03:22,  3.32s/it]Best trial: 33. Best value: 0.605306:  40%|████      | 40/100 [02:32<03:21,  3.36s/it]Best trial: 33. Best value: 0.605306:  40%|████      | 40/100 [02:34<03:21,  3.36s/it]Best trial: 33. Best value: 0.605306:  41%|████      | 41/100 [02:34<03:00,  3.05s/it]Best trial: 33. Best value: 0.605306:  41%|████      | 41/100 [02:37<03:00,  3.05s/it]Best trial: 33. Best value: 0.605306:  42%|████▏     | 42/100 [02:37<02:47,  2.89s/it]Best trial: 33. Best value: 0.605306:  42%|████▏     | 42/100 [02:39<02:47,  2.89s/it]Best trial: 33. Best value: 0.605306:  43%|████▎     | 43/100 [02:39<02:34,  2.71s/it]Best trial: 33. Best value: 0.605306:  43%|████▎     | 43/100 [02:41<02:34,  2.71s/it]Best trial: 33. Best value: 0.605306:  44%|████▍     | 44/100 [02:41<02:22,  2.55s/it]Best trial: 33. Best value: 0.605306:  44%|████▍     | 44/100 [02:46<02:22,  2.55s/it]Best trial: 33. Best value: 0.605306:  45%|████▌     | 45/100 [02:46<02:47,  3.05s/it]Best trial: 33. Best value: 0.605306:  45%|████▌     | 45/100 [02:48<02:47,  3.05s/it]Best trial: 33. Best value: 0.605306:  46%|████▌     | 46/100 [02:48<02:27,  2.73s/it]Best trial: 33. Best value: 0.605306:  46%|████▌     | 46/100 [02:53<02:27,  2.73s/it]Best trial: 33. Best value: 0.605306:  47%|████▋     | 47/100 [02:53<02:59,  3.39s/it]Best trial: 33. Best value: 0.605306:  47%|████▋     | 47/100 [02:55<02:59,  3.39s/it]Best trial: 33. Best value: 0.605306:  48%|████▊     | 48/100 [02:55<02:49,  3.26s/it]Best trial: 33. Best value: 0.605306:  48%|████▊     | 48/100 [03:00<02:49,  3.26s/it]Best trial: 33. Best value: 0.605306:  49%|████▉     | 49/100 [03:00<02:59,  3.52s/it]Best trial: 33. Best value: 0.605306:  49%|████▉     | 49/100 [03:02<02:59,  3.52s/it]Best trial: 33. Best value: 0.605306:  50%|█████     | 50/100 [03:02<02:33,  3.07s/it]Best trial: 33. Best value: 0.605306:  50%|█████     | 50/100 [03:06<02:33,  3.07s/it]Best trial: 33. Best value: 0.605306:  51%|█████     | 51/100 [03:06<02:50,  3.48s/it]Best trial: 33. Best value: 0.605306:  51%|█████     | 51/100 [03:09<02:50,  3.48s/it]Best trial: 33. Best value: 0.605306:  52%|█████▏    | 52/100 [03:09<02:33,  3.19s/it]Best trial: 33. Best value: 0.605306:  52%|█████▏    | 52/100 [03:11<02:33,  3.19s/it]Best trial: 33. Best value: 0.605306:  53%|█████▎    | 53/100 [03:11<02:13,  2.84s/it]Best trial: 33. Best value: 0.605306:  53%|█████▎    | 53/100 [03:13<02:13,  2.84s/it]Best trial: 33. Best value: 0.605306:  54%|█████▍    | 54/100 [03:13<02:09,  2.82s/it]Best trial: 33. Best value: 0.605306:  54%|█████▍    | 54/100 [03:18<02:09,  2.82s/it]Best trial: 33. Best value: 0.605306:  55%|█████▌    | 55/100 [03:18<02:28,  3.29s/it]Best trial: 33. Best value: 0.605306:  55%|█████▌    | 55/100 [03:20<02:28,  3.29s/it]Best trial: 33. Best value: 0.605306:  56%|█████▌    | 56/100 [03:20<02:12,  3.00s/it]Best trial: 33. Best value: 0.605306:  56%|█████▌    | 56/100 [03:26<02:12,  3.00s/it]Best trial: 33. Best value: 0.605306:  57%|█████▋    | 57/100 [03:26<02:51,  3.98s/it]Best trial: 33. Best value: 0.605306:  57%|█████▋    | 57/100 [03:29<02:51,  3.98s/it]Best trial: 33. Best value: 0.605306:  58%|█████▊    | 58/100 [03:29<02:30,  3.59s/it]Best trial: 33. Best value: 0.605306:  58%|█████▊    | 58/100 [03:32<02:30,  3.59s/it]Best trial: 33. Best value: 0.605306:  59%|█████▉    | 59/100 [03:32<02:19,  3.41s/it]Best trial: 33. Best value: 0.605306:  59%|█████▉    | 59/100 [03:34<02:19,  3.41s/it]Best trial: 33. Best value: 0.605306:  60%|██████    | 60/100 [03:34<02:02,  3.07s/it]Best trial: 33. Best value: 0.605306:  60%|██████    | 60/100 [03:37<02:02,  3.07s/it]Best trial: 33. Best value: 0.605306:  61%|██████    | 61/100 [03:37<01:58,  3.05s/it]Best trial: 33. Best value: 0.605306:  61%|██████    | 61/100 [03:39<01:58,  3.05s/it]Best trial: 33. Best value: 0.605306:  62%|██████▏   | 62/100 [03:39<01:43,  2.72s/it]Best trial: 33. Best value: 0.605306:  62%|██████▏   | 62/100 [03:42<01:43,  2.72s/it]Best trial: 33. Best value: 0.605306:  63%|██████▎   | 63/100 [03:42<01:43,  2.80s/it]Best trial: 33. Best value: 0.605306:  63%|██████▎   | 63/100 [03:44<01:43,  2.80s/it]Best trial: 33. Best value: 0.605306:  64%|██████▍   | 64/100 [03:44<01:33,  2.59s/it]Best trial: 33. Best value: 0.605306:  64%|██████▍   | 64/100 [03:47<01:33,  2.59s/it]Best trial: 33. Best value: 0.605306:  65%|██████▌   | 65/100 [03:47<01:30,  2.58s/it]Best trial: 33. Best value: 0.605306:  65%|██████▌   | 65/100 [03:49<01:30,  2.58s/it]Best trial: 33. Best value: 0.605306:  66%|██████▌   | 66/100 [03:49<01:22,  2.42s/it]Best trial: 33. Best value: 0.605306:  66%|██████▌   | 66/100 [03:52<01:22,  2.42s/it]Best trial: 33. Best value: 0.605306:  67%|██████▋   | 67/100 [03:52<01:22,  2.49s/it]Best trial: 33. Best value: 0.605306:  67%|██████▋   | 67/100 [03:55<01:22,  2.49s/it]Best trial: 33. Best value: 0.605306:  68%|██████▊   | 68/100 [03:55<01:26,  2.70s/it]Best trial: 33. Best value: 0.605306:  68%|██████▊   | 68/100 [03:57<01:26,  2.70s/it]Best trial: 33. Best value: 0.605306:  69%|██████▉   | 69/100 [03:57<01:20,  2.60s/it]Best trial: 33. Best value: 0.605306:  69%|██████▉   | 69/100 [04:00<01:20,  2.60s/it]Best trial: 33. Best value: 0.605306:  70%|███████   | 70/100 [04:00<01:24,  2.81s/it]Best trial: 33. Best value: 0.605306:  70%|███████   | 70/100 [04:03<01:24,  2.81s/it]Best trial: 33. Best value: 0.605306:  71%|███████   | 71/100 [04:03<01:20,  2.77s/it]Best trial: 33. Best value: 0.605306:  71%|███████   | 71/100 [04:06<01:20,  2.77s/it]Best trial: 33. Best value: 0.605306:  72%|███████▏  | 72/100 [04:06<01:16,  2.75s/it]Best trial: 33. Best value: 0.605306:  72%|███████▏  | 72/100 [04:09<01:16,  2.75s/it]Best trial: 33. Best value: 0.605306:  73%|███████▎  | 73/100 [04:09<01:13,  2.73s/it]Best trial: 33. Best value: 0.605306:  73%|███████▎  | 73/100 [04:12<01:13,  2.73s/it]Best trial: 33. Best value: 0.605306:  74%|███████▍  | 74/100 [04:12<01:20,  3.08s/it]Best trial: 33. Best value: 0.605306:  74%|███████▍  | 74/100 [04:15<01:20,  3.08s/it]Best trial: 33. Best value: 0.605306:  75%|███████▌  | 75/100 [04:15<01:15,  3.03s/it]Best trial: 33. Best value: 0.605306:  75%|███████▌  | 75/100 [04:17<01:15,  3.03s/it]Best trial: 33. Best value: 0.605306:  76%|███████▌  | 76/100 [04:17<01:06,  2.75s/it]Best trial: 33. Best value: 0.605306:  76%|███████▌  | 76/100 [04:20<01:06,  2.75s/it]Best trial: 33. Best value: 0.605306:  77%|███████▋  | 77/100 [04:20<01:04,  2.81s/it]Best trial: 33. Best value: 0.605306:  77%|███████▋  | 77/100 [04:22<01:04,  2.81s/it]Best trial: 33. Best value: 0.605306:  78%|███████▊  | 78/100 [04:22<00:55,  2.54s/it]Best trial: 33. Best value: 0.605306:  78%|███████▊  | 78/100 [04:26<00:55,  2.54s/it]Best trial: 33. Best value: 0.605306:  79%|███████▉  | 79/100 [04:26<00:58,  2.81s/it]Best trial: 33. Best value: 0.605306:  79%|███████▉  | 79/100 [04:28<00:58,  2.81s/it]Best trial: 33. Best value: 0.605306:  80%|████████  | 80/100 [04:28<00:52,  2.62s/it]Best trial: 33. Best value: 0.605306:  80%|████████  | 80/100 [04:31<00:52,  2.62s/it]Best trial: 33. Best value: 0.605306:  81%|████████  | 81/100 [04:31<00:50,  2.64s/it]Best trial: 33. Best value: 0.605306:  81%|████████  | 81/100 [04:34<00:50,  2.64s/it]Best trial: 33. Best value: 0.605306:  82%|████████▏ | 82/100 [04:34<00:54,  3.01s/it]Best trial: 33. Best value: 0.605306:  82%|████████▏ | 82/100 [04:38<00:54,  3.01s/it]Best trial: 33. Best value: 0.605306:  83%|████████▎ | 83/100 [04:38<00:55,  3.26s/it]Best trial: 33. Best value: 0.605306:  83%|████████▎ | 83/100 [04:41<00:55,  3.26s/it]Best trial: 33. Best value: 0.605306:  84%|████████▍ | 84/100 [04:41<00:48,  3.06s/it]Best trial: 33. Best value: 0.605306:  84%|████████▍ | 84/100 [04:43<00:48,  3.06s/it]Best trial: 33. Best value: 0.605306:  85%|████████▌ | 85/100 [04:43<00:43,  2.90s/it]Best trial: 33. Best value: 0.605306:  85%|████████▌ | 85/100 [04:48<00:43,  2.90s/it]Best trial: 33. Best value: 0.605306:  86%|████████▌ | 86/100 [04:48<00:47,  3.41s/it]Best trial: 33. Best value: 0.605306:  86%|████████▌ | 86/100 [04:55<00:47,  3.41s/it]Best trial: 33. Best value: 0.605306:  87%|████████▋ | 87/100 [04:55<00:56,  4.35s/it]Best trial: 33. Best value: 0.605306:  87%|████████▋ | 87/100 [04:56<00:56,  4.35s/it]Best trial: 33. Best value: 0.605306:  88%|████████▊ | 88/100 [04:56<00:43,  3.59s/it]Best trial: 33. Best value: 0.605306:  88%|████████▊ | 88/100 [05:01<00:43,  3.59s/it]Best trial: 33. Best value: 0.605306:  89%|████████▉ | 89/100 [05:01<00:42,  3.86s/it]Best trial: 33. Best value: 0.605306:  89%|████████▉ | 89/100 [05:05<00:42,  3.86s/it]Best trial: 33. Best value: 0.605306:  90%|█████████ | 90/100 [05:05<00:39,  3.95s/it]Best trial: 33. Best value: 0.605306:  90%|█████████ | 90/100 [05:08<00:39,  3.95s/it]Best trial: 33. Best value: 0.605306:  91%|█████████ | 91/100 [05:08<00:32,  3.58s/it]Best trial: 33. Best value: 0.605306:  91%|█████████ | 91/100 [05:11<00:32,  3.58s/it]Best trial: 33. Best value: 0.605306:  92%|█████████▏| 92/100 [05:11<00:27,  3.41s/it]Best trial: 92. Best value: 0.605346:  92%|█████████▏| 92/100 [05:13<00:27,  3.41s/it]Best trial: 92. Best value: 0.605346:  93%|█████████▎| 93/100 [05:13<00:21,  3.01s/it]Best trial: 92. Best value: 0.605346:  93%|█████████▎| 93/100 [05:15<00:21,  3.01s/it]Best trial: 92. Best value: 0.605346:  94%|█████████▍| 94/100 [05:15<00:16,  2.74s/it]Best trial: 92. Best value: 0.605346:  94%|█████████▍| 94/100 [05:17<00:16,  2.74s/it]Best trial: 92. Best value: 0.605346:  95%|█████████▌| 95/100 [05:17<00:13,  2.62s/it]Best trial: 92. Best value: 0.605346:  95%|█████████▌| 95/100 [05:19<00:13,  2.62s/it]Best trial: 92. Best value: 0.605346:  96%|█████████▌| 96/100 [05:19<00:09,  2.42s/it]Best trial: 92. Best value: 0.605346:  96%|█████████▌| 96/100 [05:22<00:09,  2.42s/it]Best trial: 92. Best value: 0.605346:  97%|█████████▋| 97/100 [05:22<00:07,  2.43s/it]Best trial: 92. Best value: 0.605346:  97%|█████████▋| 97/100 [05:24<00:07,  2.43s/it]Best trial: 92. Best value: 0.605346:  98%|█████████▊| 98/100 [05:24<00:04,  2.43s/it]Best trial: 92. Best value: 0.605346:  98%|█████████▊| 98/100 [05:27<00:04,  2.43s/it]Best trial: 92. Best value: 0.605346:  99%|█████████▉| 99/100 [05:27<00:02,  2.54s/it]Best trial: 92. Best value: 0.605346:  99%|█████████▉| 99/100 [05:29<00:02,  2.54s/it]Best trial: 92. Best value: 0.605346: 100%|██████████| 100/100 [05:29<00:00,  2.52s/it]Best trial: 92. Best value: 0.605346: 100%|██████████| 100/100 [05:29<00:00,  3.30s/it]
2025-11-30 18:17:22,690 - INFO - HPO Complete. Best AUPRC: 0.6053
2025-11-30 18:17:22,690 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.05461345577027138, 'max_depth': 4, 'subsample': 0.8657557247850353, 'colsample_bytree': 0.6465962041886348, 'gamma': 3.997920181895953, 'reg_lambda': 0.10840378187328822, 'reg_alpha': 4.894195363462335e-07}
2025-11-30 18:17:22,691 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:17:24,509 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_awp
2025-11-30 18:17:24,509 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:17:24,592 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:17:24,615 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:17:24,620 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-11-30 18:17:24,620 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:17:24,620 - INFO - Training model...
2025-11-30 18:17:25,470 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:17:30,873 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:17:30,873 - INFO - AUROC: 0.7842 (0.7523 - 0.8196)
2025-11-30 18:17:30,873 - INFO - AUPRC: 0.5121 (0.4561 - 0.5990)
2025-11-30 18:17:30,873 - INFO - Brier Score: 0.1627 (0.1504 - 0.1733)
2025-11-30 18:17:30,873 - INFO - Accuracy: 0.7110 (0.6673 - 0.8043)
2025-11-30 18:17:30,873 - INFO - Precision: 0.4239 (0.3706 - 0.5753)
2025-11-30 18:17:30,873 - INFO - Sensitivity (Recall): 0.7405 (0.6170 - 0.8297)
2025-11-30 18:17:30,873 - INFO - F1-Score: 0.5392 (0.4951 - 0.6028)
2025-11-30 18:17:30,873 - INFO - Best Threshold: 0.3800 (0.3300 - 0.5500)
2025-11-30 18:17:30,873 - INFO - Specificity: 0.7022 (0.6265 - 0.8594)
2025-11-30 18:17:30,884 - INFO - Calculating SHAP values...
2025-11-30 18:17:31,865 - INFO - SHAP plots saved.
2025-11-30 18:17:31,866 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:17:33,128 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 18:17:33,128 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:17:33,218 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:17:33,256 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:17:33,270 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:17:33,270 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.567357:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.567357:   1%|          | 1/100 [00:04<08:13,  4.99s/it]Best trial: 1. Best value: 0.582289:   1%|          | 1/100 [00:14<08:13,  4.99s/it]Best trial: 1. Best value: 0.582289:   2%|▏         | 2/100 [00:14<12:01,  7.37s/it]Best trial: 1. Best value: 0.582289:   2%|▏         | 2/100 [00:27<12:01,  7.37s/it]Best trial: 1. Best value: 0.582289:   3%|▎         | 3/100 [00:27<16:10, 10.01s/it]Best trial: 3. Best value: 0.585452:   3%|▎         | 3/100 [00:36<16:10, 10.01s/it]Best trial: 3. Best value: 0.585452:   4%|▍         | 4/100 [00:36<15:46,  9.86s/it]Best trial: 3. Best value: 0.585452:   4%|▍         | 4/100 [00:40<15:46,  9.86s/it]Best trial: 3. Best value: 0.585452:   5%|▌         | 5/100 [00:40<12:13,  7.72s/it]Best trial: 3. Best value: 0.585452:   5%|▌         | 5/100 [00:48<12:13,  7.72s/it]Best trial: 3. Best value: 0.585452:   6%|▌         | 6/100 [00:48<12:02,  7.69s/it]Best trial: 3. Best value: 0.585452:   6%|▌         | 6/100 [00:52<12:02,  7.69s/it]Best trial: 3. Best value: 0.585452:   7%|▋         | 7/100 [00:52<09:55,  6.40s/it]Best trial: 3. Best value: 0.585452:   7%|▋         | 7/100 [00:54<09:55,  6.40s/it]Best trial: 3. Best value: 0.585452:   8%|▊         | 8/100 [00:54<07:46,  5.07s/it]Best trial: 3. Best value: 0.585452:   8%|▊         | 8/100 [00:59<07:46,  5.07s/it]Best trial: 3. Best value: 0.585452:   9%|▉         | 9/100 [00:59<07:32,  4.97s/it]Best trial: 9. Best value: 0.598793:   9%|▉         | 9/100 [01:04<07:32,  4.97s/it]Best trial: 9. Best value: 0.598793:  10%|█         | 10/100 [01:04<07:46,  5.19s/it]Best trial: 9. Best value: 0.598793:  10%|█         | 10/100 [01:07<07:46,  5.19s/it]Best trial: 9. Best value: 0.598793:  11%|█         | 11/100 [01:07<06:46,  4.56s/it]Best trial: 11. Best value: 0.604316:  11%|█         | 11/100 [01:10<06:46,  4.56s/it]Best trial: 11. Best value: 0.604316:  12%|█▏        | 12/100 [01:10<06:00,  4.09s/it]Best trial: 11. Best value: 0.604316:  12%|█▏        | 12/100 [01:15<06:00,  4.09s/it]Best trial: 11. Best value: 0.604316:  13%|█▎        | 13/100 [01:15<05:59,  4.13s/it]Best trial: 11. Best value: 0.604316:  13%|█▎        | 13/100 [01:24<05:59,  4.13s/it]Best trial: 11. Best value: 0.604316:  14%|█▍        | 14/100 [01:24<08:04,  5.63s/it]Best trial: 14. Best value: 0.60592:  14%|█▍        | 14/100 [01:30<08:04,  5.63s/it] Best trial: 14. Best value: 0.60592:  15%|█▌        | 15/100 [01:30<08:08,  5.74s/it]Best trial: 14. Best value: 0.60592:  15%|█▌        | 15/100 [01:35<08:08,  5.74s/it]Best trial: 14. Best value: 0.60592:  16%|█▌        | 16/100 [01:35<07:55,  5.66s/it]Best trial: 14. Best value: 0.60592:  16%|█▌        | 16/100 [01:40<07:55,  5.66s/it]Best trial: 14. Best value: 0.60592:  17%|█▋        | 17/100 [01:40<07:25,  5.37s/it]Best trial: 14. Best value: 0.60592:  17%|█▋        | 17/100 [01:46<07:25,  5.37s/it]Best trial: 14. Best value: 0.60592:  18%|█▊        | 18/100 [01:46<07:40,  5.61s/it]Best trial: 14. Best value: 0.60592:  18%|█▊        | 18/100 [01:52<07:40,  5.61s/it]Best trial: 14. Best value: 0.60592:  19%|█▉        | 19/100 [01:52<07:36,  5.64s/it]Best trial: 14. Best value: 0.60592:  19%|█▉        | 19/100 [01:57<07:36,  5.64s/it]Best trial: 14. Best value: 0.60592:  20%|██        | 20/100 [01:57<07:10,  5.38s/it]Best trial: 14. Best value: 0.60592:  20%|██        | 20/100 [02:01<07:10,  5.38s/it]Best trial: 14. Best value: 0.60592:  21%|██        | 21/100 [02:01<06:51,  5.20s/it]Best trial: 21. Best value: 0.606913:  21%|██        | 21/100 [02:09<06:51,  5.20s/it]Best trial: 21. Best value: 0.606913:  22%|██▏       | 22/100 [02:09<07:50,  6.03s/it]Best trial: 21. Best value: 0.606913:  22%|██▏       | 22/100 [02:17<07:50,  6.03s/it]Best trial: 21. Best value: 0.606913:  23%|██▎       | 23/100 [02:17<08:22,  6.53s/it]Best trial: 21. Best value: 0.606913:  23%|██▎       | 23/100 [02:25<08:22,  6.53s/it]Best trial: 21. Best value: 0.606913:  24%|██▍       | 24/100 [02:25<08:40,  6.85s/it]Best trial: 21. Best value: 0.606913:  24%|██▍       | 24/100 [02:30<08:40,  6.85s/it]Best trial: 21. Best value: 0.606913:  25%|██▌       | 25/100 [02:30<08:05,  6.48s/it]Best trial: 21. Best value: 0.606913:  25%|██▌       | 25/100 [02:38<08:05,  6.48s/it]Best trial: 21. Best value: 0.606913:  26%|██▌       | 26/100 [02:38<08:24,  6.81s/it]Best trial: 21. Best value: 0.606913:  26%|██▌       | 26/100 [02:49<08:24,  6.81s/it]Best trial: 21. Best value: 0.606913:  27%|██▋       | 27/100 [02:49<09:54,  8.14s/it]Best trial: 27. Best value: 0.612913:  27%|██▋       | 27/100 [03:00<09:54,  8.14s/it]Best trial: 27. Best value: 0.612913:  28%|██▊       | 28/100 [03:00<10:56,  9.11s/it]Best trial: 27. Best value: 0.612913:  28%|██▊       | 28/100 [03:12<10:56,  9.11s/it]Best trial: 27. Best value: 0.612913:  29%|██▉       | 29/100 [03:12<11:48,  9.98s/it]Best trial: 27. Best value: 0.612913:  29%|██▉       | 29/100 [03:25<11:48,  9.98s/it]Best trial: 27. Best value: 0.612913:  30%|███       | 30/100 [03:25<12:32, 10.75s/it]Best trial: 27. Best value: 0.612913:  30%|███       | 30/100 [03:31<12:32, 10.75s/it]Best trial: 27. Best value: 0.612913:  31%|███       | 31/100 [03:31<10:41,  9.30s/it]Best trial: 27. Best value: 0.612913:  31%|███       | 31/100 [03:41<10:41,  9.30s/it]Best trial: 27. Best value: 0.612913:  32%|███▏      | 32/100 [03:41<10:56,  9.65s/it]Best trial: 27. Best value: 0.612913:  32%|███▏      | 32/100 [03:45<10:56,  9.65s/it]Best trial: 27. Best value: 0.612913:  33%|███▎      | 33/100 [03:45<08:46,  7.86s/it]Best trial: 27. Best value: 0.612913:  33%|███▎      | 33/100 [03:57<08:46,  7.86s/it]Best trial: 27. Best value: 0.612913:  34%|███▍      | 34/100 [03:57<09:57,  9.05s/it]Best trial: 27. Best value: 0.612913:  34%|███▍      | 34/100 [04:04<09:57,  9.05s/it]Best trial: 27. Best value: 0.612913:  35%|███▌      | 35/100 [04:04<09:09,  8.46s/it]Best trial: 27. Best value: 0.612913:  35%|███▌      | 35/100 [04:08<09:09,  8.46s/it]Best trial: 27. Best value: 0.612913:  36%|███▌      | 36/100 [04:08<07:37,  7.15s/it]Best trial: 27. Best value: 0.612913:  36%|███▌      | 36/100 [04:15<07:37,  7.15s/it]Best trial: 27. Best value: 0.612913:  37%|███▋      | 37/100 [04:15<07:31,  7.16s/it]Best trial: 27. Best value: 0.612913:  37%|███▋      | 37/100 [04:18<07:31,  7.16s/it]Best trial: 27. Best value: 0.612913:  38%|███▊      | 38/100 [04:18<06:09,  5.96s/it]Best trial: 27. Best value: 0.612913:  38%|███▊      | 38/100 [04:26<06:09,  5.96s/it]Best trial: 27. Best value: 0.612913:  39%|███▉      | 39/100 [04:26<06:28,  6.36s/it]Best trial: 27. Best value: 0.612913:  39%|███▉      | 39/100 [04:32<06:28,  6.36s/it]Best trial: 27. Best value: 0.612913:  40%|████      | 40/100 [04:32<06:22,  6.37s/it]Best trial: 40. Best value: 0.612956:  40%|████      | 40/100 [04:36<06:22,  6.37s/it]Best trial: 40. Best value: 0.612956:  41%|████      | 41/100 [04:36<05:26,  5.54s/it]Best trial: 40. Best value: 0.612956:  41%|████      | 41/100 [04:39<05:26,  5.54s/it]Best trial: 40. Best value: 0.612956:  42%|████▏     | 42/100 [04:39<04:45,  4.92s/it]Best trial: 40. Best value: 0.612956:  42%|████▏     | 42/100 [04:44<04:45,  4.92s/it]Best trial: 40. Best value: 0.612956:  43%|████▎     | 43/100 [04:44<04:31,  4.76s/it]Best trial: 40. Best value: 0.612956:  43%|████▎     | 43/100 [04:46<04:31,  4.76s/it]Best trial: 40. Best value: 0.612956:  44%|████▍     | 44/100 [04:46<03:46,  4.05s/it]Best trial: 40. Best value: 0.612956:  44%|████▍     | 44/100 [04:49<03:46,  4.05s/it]Best trial: 40. Best value: 0.612956:  45%|████▌     | 45/100 [04:49<03:32,  3.87s/it]Best trial: 40. Best value: 0.612956:  45%|████▌     | 45/100 [04:52<03:32,  3.87s/it]Best trial: 40. Best value: 0.612956:  46%|████▌     | 46/100 [04:52<03:13,  3.58s/it]Best trial: 40. Best value: 0.612956:  46%|████▌     | 46/100 [04:55<03:13,  3.58s/it]Best trial: 40. Best value: 0.612956:  47%|████▋     | 47/100 [04:55<03:01,  3.42s/it]Best trial: 40. Best value: 0.612956:  47%|████▋     | 47/100 [05:01<03:01,  3.42s/it]Best trial: 40. Best value: 0.612956:  48%|████▊     | 48/100 [05:01<03:37,  4.19s/it]Best trial: 40. Best value: 0.612956:  48%|████▊     | 48/100 [05:10<03:37,  4.19s/it]Best trial: 40. Best value: 0.612956:  49%|████▉     | 49/100 [05:10<04:36,  5.43s/it]Best trial: 40. Best value: 0.612956:  49%|████▉     | 49/100 [05:15<04:36,  5.43s/it]Best trial: 40. Best value: 0.612956:  50%|█████     | 50/100 [05:15<04:31,  5.42s/it]Best trial: 40. Best value: 0.612956:  50%|█████     | 50/100 [05:20<04:31,  5.42s/it]Best trial: 40. Best value: 0.612956:  51%|█████     | 51/100 [05:20<04:25,  5.42s/it]Best trial: 51. Best value: 0.615978:  51%|█████     | 51/100 [05:24<04:25,  5.42s/it]Best trial: 51. Best value: 0.615978:  52%|█████▏    | 52/100 [05:24<04:00,  5.00s/it]Best trial: 51. Best value: 0.615978:  52%|█████▏    | 52/100 [05:28<04:00,  5.00s/it]Best trial: 51. Best value: 0.615978:  53%|█████▎    | 53/100 [05:28<03:32,  4.53s/it]Best trial: 51. Best value: 0.615978:  53%|█████▎    | 53/100 [05:32<03:32,  4.53s/it]Best trial: 51. Best value: 0.615978:  54%|█████▍    | 54/100 [05:32<03:20,  4.35s/it]Best trial: 51. Best value: 0.615978:  54%|█████▍    | 54/100 [05:35<03:20,  4.35s/it]Best trial: 51. Best value: 0.615978:  55%|█████▌    | 55/100 [05:35<02:58,  3.97s/it]Best trial: 51. Best value: 0.615978:  55%|█████▌    | 55/100 [05:40<02:58,  3.97s/it]Best trial: 51. Best value: 0.615978:  56%|█████▌    | 56/100 [05:40<03:06,  4.23s/it]Best trial: 51. Best value: 0.615978:  56%|█████▌    | 56/100 [05:44<03:06,  4.23s/it]Best trial: 51. Best value: 0.615978:  57%|█████▋    | 57/100 [05:44<03:06,  4.35s/it]Best trial: 51. Best value: 0.615978:  57%|█████▋    | 57/100 [05:49<03:06,  4.35s/it]Best trial: 51. Best value: 0.615978:  58%|█████▊    | 58/100 [05:49<03:02,  4.36s/it]Best trial: 51. Best value: 0.615978:  58%|█████▊    | 58/100 [05:55<03:02,  4.36s/it]Best trial: 51. Best value: 0.615978:  59%|█████▉    | 59/100 [05:55<03:17,  4.83s/it]Best trial: 51. Best value: 0.615978:  59%|█████▉    | 59/100 [05:59<03:17,  4.83s/it]Best trial: 51. Best value: 0.615978:  60%|██████    | 60/100 [05:59<03:04,  4.62s/it]Best trial: 51. Best value: 0.615978:  60%|██████    | 60/100 [06:03<03:04,  4.62s/it]Best trial: 51. Best value: 0.615978:  61%|██████    | 61/100 [06:03<02:56,  4.54s/it]Best trial: 51. Best value: 0.615978:  61%|██████    | 61/100 [06:07<02:56,  4.54s/it]Best trial: 51. Best value: 0.615978:  62%|██████▏   | 62/100 [06:07<02:49,  4.46s/it]Best trial: 51. Best value: 0.615978:  62%|██████▏   | 62/100 [06:11<02:49,  4.46s/it]Best trial: 51. Best value: 0.615978:  63%|██████▎   | 63/100 [06:11<02:29,  4.05s/it]Best trial: 51. Best value: 0.615978:  63%|██████▎   | 63/100 [06:13<02:29,  4.05s/it]Best trial: 51. Best value: 0.615978:  64%|██████▍   | 64/100 [06:13<02:05,  3.49s/it]Best trial: 64. Best value: 0.616159:  64%|██████▍   | 64/100 [06:16<02:05,  3.49s/it]Best trial: 64. Best value: 0.616159:  65%|██████▌   | 65/100 [06:16<01:59,  3.41s/it]Best trial: 64. Best value: 0.616159:  65%|██████▌   | 65/100 [06:19<01:59,  3.41s/it]Best trial: 64. Best value: 0.616159:  66%|██████▌   | 66/100 [06:19<01:47,  3.17s/it]Best trial: 64. Best value: 0.616159:  66%|██████▌   | 66/100 [06:21<01:47,  3.17s/it]Best trial: 64. Best value: 0.616159:  67%|██████▋   | 67/100 [06:21<01:35,  2.90s/it]Best trial: 64. Best value: 0.616159:  67%|██████▋   | 67/100 [06:25<01:35,  2.90s/it]Best trial: 64. Best value: 0.616159:  68%|██████▊   | 68/100 [06:25<01:41,  3.18s/it]Best trial: 64. Best value: 0.616159:  68%|██████▊   | 68/100 [06:28<01:41,  3.18s/it]Best trial: 64. Best value: 0.616159:  69%|██████▉   | 69/100 [06:28<01:41,  3.28s/it]Best trial: 64. Best value: 0.616159:  69%|██████▉   | 69/100 [06:31<01:41,  3.28s/it]Best trial: 64. Best value: 0.616159:  70%|███████   | 70/100 [06:31<01:32,  3.08s/it]Best trial: 64. Best value: 0.616159:  70%|███████   | 70/100 [06:34<01:32,  3.08s/it]Best trial: 64. Best value: 0.616159:  71%|███████   | 71/100 [06:34<01:32,  3.19s/it]Best trial: 64. Best value: 0.616159:  71%|███████   | 71/100 [06:37<01:32,  3.19s/it]Best trial: 64. Best value: 0.616159:  72%|███████▏  | 72/100 [06:37<01:29,  3.18s/it]Best trial: 64. Best value: 0.616159:  72%|███████▏  | 72/100 [06:41<01:29,  3.18s/it]Best trial: 64. Best value: 0.616159:  73%|███████▎  | 73/100 [06:41<01:31,  3.38s/it]Best trial: 64. Best value: 0.616159:  73%|███████▎  | 73/100 [06:44<01:31,  3.38s/it]Best trial: 64. Best value: 0.616159:  74%|███████▍  | 74/100 [06:44<01:25,  3.30s/it]Best trial: 64. Best value: 0.616159:  74%|███████▍  | 74/100 [06:47<01:25,  3.30s/it]Best trial: 64. Best value: 0.616159:  75%|███████▌  | 75/100 [06:47<01:18,  3.15s/it]Best trial: 64. Best value: 0.616159:  75%|███████▌  | 75/100 [06:51<01:18,  3.15s/it]Best trial: 64. Best value: 0.616159:  76%|███████▌  | 76/100 [06:51<01:18,  3.28s/it]Best trial: 64. Best value: 0.616159:  76%|███████▌  | 76/100 [06:55<01:18,  3.28s/it]Best trial: 64. Best value: 0.616159:  77%|███████▋  | 77/100 [06:55<01:20,  3.51s/it]Best trial: 64. Best value: 0.616159:  77%|███████▋  | 77/100 [06:58<01:20,  3.51s/it]Best trial: 64. Best value: 0.616159:  78%|███████▊  | 78/100 [06:58<01:17,  3.53s/it]Best trial: 64. Best value: 0.616159:  78%|███████▊  | 78/100 [07:01<01:17,  3.53s/it]Best trial: 64. Best value: 0.616159:  79%|███████▉  | 79/100 [07:01<01:09,  3.31s/it]Best trial: 64. Best value: 0.616159:  79%|███████▉  | 79/100 [07:04<01:09,  3.31s/it]Best trial: 64. Best value: 0.616159:  80%|████████  | 80/100 [07:04<01:05,  3.29s/it]Best trial: 64. Best value: 0.616159:  80%|████████  | 80/100 [07:08<01:05,  3.29s/it]Best trial: 64. Best value: 0.616159:  81%|████████  | 81/100 [07:08<01:05,  3.45s/it]Best trial: 64. Best value: 0.616159:  81%|████████  | 81/100 [07:12<01:05,  3.45s/it]Best trial: 64. Best value: 0.616159:  82%|████████▏ | 82/100 [07:12<01:06,  3.69s/it]Best trial: 64. Best value: 0.616159:  82%|████████▏ | 82/100 [07:15<01:06,  3.69s/it]Best trial: 64. Best value: 0.616159:  83%|████████▎ | 83/100 [07:15<00:57,  3.38s/it]Best trial: 64. Best value: 0.616159:  83%|████████▎ | 83/100 [07:19<00:57,  3.38s/it]Best trial: 64. Best value: 0.616159:  84%|████████▍ | 84/100 [07:19<00:54,  3.41s/it]Best trial: 64. Best value: 0.616159:  84%|████████▍ | 84/100 [07:22<00:54,  3.41s/it]Best trial: 64. Best value: 0.616159:  85%|████████▌ | 85/100 [07:22<00:49,  3.28s/it]Best trial: 64. Best value: 0.616159:  85%|████████▌ | 85/100 [07:24<00:49,  3.28s/it]Best trial: 64. Best value: 0.616159:  86%|████████▌ | 86/100 [07:24<00:41,  2.94s/it]Best trial: 64. Best value: 0.616159:  86%|████████▌ | 86/100 [07:26<00:41,  2.94s/it]Best trial: 64. Best value: 0.616159:  87%|████████▋ | 87/100 [07:26<00:36,  2.83s/it]Best trial: 64. Best value: 0.616159:  87%|████████▋ | 87/100 [07:30<00:36,  2.83s/it]Best trial: 64. Best value: 0.616159:  88%|████████▊ | 88/100 [07:30<00:35,  2.98s/it]Best trial: 64. Best value: 0.616159:  88%|████████▊ | 88/100 [07:33<00:35,  2.98s/it]Best trial: 64. Best value: 0.616159:  89%|████████▉ | 89/100 [07:33<00:33,  3.04s/it]Best trial: 64. Best value: 0.616159:  89%|████████▉ | 89/100 [07:35<00:33,  3.04s/it]Best trial: 64. Best value: 0.616159:  90%|█████████ | 90/100 [07:35<00:28,  2.88s/it]Best trial: 64. Best value: 0.616159:  90%|█████████ | 90/100 [07:39<00:28,  2.88s/it]Best trial: 64. Best value: 0.616159:  91%|█████████ | 91/100 [07:39<00:27,  3.07s/it]Best trial: 91. Best value: 0.617859:  91%|█████████ | 91/100 [07:42<00:27,  3.07s/it]Best trial: 91. Best value: 0.617859:  92%|█████████▏| 92/100 [07:42<00:25,  3.15s/it]Best trial: 91. Best value: 0.617859:  92%|█████████▏| 92/100 [07:45<00:25,  3.15s/it]Best trial: 91. Best value: 0.617859:  93%|█████████▎| 93/100 [07:45<00:21,  3.07s/it]Best trial: 91. Best value: 0.617859:  93%|█████████▎| 93/100 [07:49<00:21,  3.07s/it]Best trial: 91. Best value: 0.617859:  94%|█████████▍| 94/100 [07:49<00:20,  3.33s/it]Best trial: 91. Best value: 0.617859:  94%|█████████▍| 94/100 [07:51<00:20,  3.33s/it]Best trial: 91. Best value: 0.617859:  95%|█████████▌| 95/100 [07:51<00:15,  3.01s/it]Best trial: 91. Best value: 0.617859:  95%|█████████▌| 95/100 [07:55<00:15,  3.01s/it]Best trial: 91. Best value: 0.617859:  96%|█████████▌| 96/100 [07:55<00:12,  3.25s/it]Best trial: 91. Best value: 0.617859:  96%|█████████▌| 96/100 [07:58<00:12,  3.25s/it]Best trial: 91. Best value: 0.617859:  97%|█████████▋| 97/100 [07:58<00:09,  3.13s/it]Best trial: 91. Best value: 0.617859:  97%|█████████▋| 97/100 [08:01<00:09,  3.13s/it]Best trial: 91. Best value: 0.617859:  98%|█████████▊| 98/100 [08:01<00:06,  3.07s/it]Best trial: 91. Best value: 0.617859:  98%|█████████▊| 98/100 [08:05<00:06,  3.07s/it]Best trial: 91. Best value: 0.617859:  99%|█████████▉| 99/100 [08:05<00:03,  3.42s/it]Best trial: 91. Best value: 0.617859:  99%|█████████▉| 99/100 [08:10<00:03,  3.42s/it]Best trial: 91. Best value: 0.617859: 100%|██████████| 100/100 [08:10<00:00,  3.99s/it]Best trial: 91. Best value: 0.617859: 100%|██████████| 100/100 [08:10<00:00,  4.91s/it]
2025-11-30 18:25:44,101 - INFO - HPO Complete. Best AUPRC: 0.6179
2025-11-30 18:25:44,101 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.06877835126710011, 'max_depth': 5, 'subsample': 0.9730977170118975, 'colsample_bytree': 0.6331762890620725, 'gamma': 2.105064802183914, 'reg_lambda': 3.907153062704161e-05, 'reg_alpha': 0.007096150699109625}
2025-11-30 18:25:44,102 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:25:45,994 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 18:25:45,995 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:25:46,079 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:25:46,112 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:25:46,121 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:25:46,121 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:25:46,122 - INFO - Training model...
2025-11-30 18:25:47,458 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:25:52,964 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:25:52,964 - INFO - AUROC: 0.8090 (0.7791 - 0.8352)
2025-11-30 18:25:52,964 - INFO - AUPRC: 0.5632 (0.5076 - 0.6319)
2025-11-30 18:25:52,964 - INFO - Brier Score: 0.1428 (0.1325 - 0.1532)
2025-11-30 18:25:52,964 - INFO - Accuracy: 0.7514 (0.7373 - 0.8107)
2025-11-30 18:25:52,964 - INFO - Precision: 0.4718 (0.4459 - 0.5985)
2025-11-30 18:25:52,964 - INFO - Sensitivity (Recall): 0.7405 (0.5916 - 0.8048)
2025-11-30 18:25:52,964 - INFO - F1-Score: 0.5764 (0.5458 - 0.6350)
2025-11-30 18:25:52,964 - INFO - Best Threshold: 0.3200 (0.3200 - 0.4700)
2025-11-30 18:25:52,964 - INFO - Specificity: 0.7547 (0.7364 - 0.8779)
2025-11-30 18:25:52,980 - INFO - Calculating SHAP values...
2025-11-30 18:25:54,079 - INFO - SHAP plots saved.
2025-11-30 18:25:54,081 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:25:55,463 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 18:25:55,463 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:25:55,551 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:25:55,583 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:25:55,591 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:25:55,591 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.533622:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.533622:   1%|          | 1/100 [00:03<05:11,  3.14s/it]Best trial: 1. Best value: 0.554694:   1%|          | 1/100 [00:07<05:11,  3.14s/it]Best trial: 1. Best value: 0.554694:   2%|▏         | 2/100 [00:07<06:37,  4.05s/it]Best trial: 2. Best value: 0.596974:   2%|▏         | 2/100 [00:22<06:37,  4.05s/it]Best trial: 2. Best value: 0.596974:   3%|▎         | 3/100 [00:22<14:05,  8.72s/it]Best trial: 2. Best value: 0.596974:   3%|▎         | 3/100 [00:24<14:05,  8.72s/it]Best trial: 2. Best value: 0.596974:   4%|▍         | 4/100 [00:24<10:08,  6.34s/it]Best trial: 2. Best value: 0.596974:   4%|▍         | 4/100 [00:31<10:08,  6.34s/it]Best trial: 2. Best value: 0.596974:   5%|▌         | 5/100 [00:31<10:05,  6.38s/it]Best trial: 2. Best value: 0.596974:   5%|▌         | 5/100 [00:44<10:05,  6.38s/it]Best trial: 2. Best value: 0.596974:   6%|▌         | 6/100 [00:44<13:30,  8.62s/it]Best trial: 2. Best value: 0.596974:   6%|▌         | 6/100 [01:00<13:30,  8.62s/it]Best trial: 2. Best value: 0.596974:   7%|▋         | 7/100 [01:00<17:13, 11.11s/it]Best trial: 2. Best value: 0.596974:   7%|▋         | 7/100 [01:03<17:13, 11.11s/it]Best trial: 2. Best value: 0.596974:   8%|▊         | 8/100 [01:03<12:58,  8.46s/it]Best trial: 2. Best value: 0.596974:   8%|▊         | 8/100 [01:07<12:58,  8.46s/it]Best trial: 2. Best value: 0.596974:   9%|▉         | 9/100 [01:07<10:38,  7.01s/it]Best trial: 2. Best value: 0.596974:   9%|▉         | 9/100 [01:09<10:38,  7.01s/it]Best trial: 2. Best value: 0.596974:  10%|█         | 10/100 [01:09<08:25,  5.62s/it]Best trial: 2. Best value: 0.596974:  10%|█         | 10/100 [01:14<08:25,  5.62s/it]Best trial: 2. Best value: 0.596974:  11%|█         | 11/100 [01:14<07:52,  5.31s/it]Best trial: 2. Best value: 0.596974:  11%|█         | 11/100 [01:20<07:52,  5.31s/it]Best trial: 2. Best value: 0.596974:  12%|█▏        | 12/100 [01:20<08:00,  5.47s/it]Best trial: 12. Best value: 0.607148:  12%|█▏        | 12/100 [01:24<08:00,  5.47s/it]Best trial: 12. Best value: 0.607148:  13%|█▎        | 13/100 [01:24<07:27,  5.15s/it]Best trial: 12. Best value: 0.607148:  13%|█▎        | 13/100 [01:29<07:27,  5.15s/it]Best trial: 12. Best value: 0.607148:  14%|█▍        | 14/100 [01:29<07:26,  5.19s/it]Best trial: 12. Best value: 0.607148:  14%|█▍        | 14/100 [01:32<07:26,  5.19s/it]Best trial: 12. Best value: 0.607148:  15%|█▌        | 15/100 [01:32<06:26,  4.55s/it]Best trial: 12. Best value: 0.607148:  15%|█▌        | 15/100 [01:37<06:26,  4.55s/it]Best trial: 12. Best value: 0.607148:  16%|█▌        | 16/100 [01:37<06:33,  4.68s/it]Best trial: 12. Best value: 0.607148:  16%|█▌        | 16/100 [01:42<06:33,  4.68s/it]Best trial: 12. Best value: 0.607148:  17%|█▋        | 17/100 [01:42<06:33,  4.74s/it]Best trial: 17. Best value: 0.608625:  17%|█▋        | 17/100 [01:51<06:33,  4.74s/it]Best trial: 17. Best value: 0.608625:  18%|█▊        | 18/100 [01:51<08:12,  6.01s/it]Best trial: 17. Best value: 0.608625:  18%|█▊        | 18/100 [02:01<08:12,  6.01s/it]Best trial: 17. Best value: 0.608625:  19%|█▉        | 19/100 [02:01<09:39,  7.16s/it]Best trial: 17. Best value: 0.608625:  19%|█▉        | 19/100 [02:18<09:39,  7.16s/it]Best trial: 17. Best value: 0.608625:  20%|██        | 20/100 [02:18<13:32, 10.16s/it]Best trial: 17. Best value: 0.608625:  20%|██        | 20/100 [02:32<13:32, 10.16s/it]Best trial: 17. Best value: 0.608625:  21%|██        | 21/100 [02:32<14:45, 11.20s/it]Best trial: 17. Best value: 0.608625:  21%|██        | 21/100 [02:43<14:45, 11.20s/it]Best trial: 17. Best value: 0.608625:  22%|██▏       | 22/100 [02:43<14:30, 11.17s/it]Best trial: 17. Best value: 0.608625:  22%|██▏       | 22/100 [02:47<14:30, 11.17s/it]Best trial: 17. Best value: 0.608625:  23%|██▎       | 23/100 [02:47<11:46,  9.17s/it]Best trial: 17. Best value: 0.608625:  23%|██▎       | 23/100 [02:54<11:46,  9.17s/it]Best trial: 17. Best value: 0.608625:  24%|██▍       | 24/100 [02:54<10:38,  8.41s/it]Best trial: 17. Best value: 0.608625:  24%|██▍       | 24/100 [03:01<10:38,  8.41s/it]Best trial: 17. Best value: 0.608625:  25%|██▌       | 25/100 [03:01<10:07,  8.10s/it]Best trial: 17. Best value: 0.608625:  25%|██▌       | 25/100 [03:07<10:07,  8.10s/it]Best trial: 17. Best value: 0.608625:  26%|██▌       | 26/100 [03:07<09:06,  7.39s/it]Best trial: 17. Best value: 0.608625:  26%|██▌       | 26/100 [03:17<09:06,  7.39s/it]Best trial: 17. Best value: 0.608625:  27%|██▋       | 27/100 [03:17<09:47,  8.04s/it]Best trial: 17. Best value: 0.608625:  27%|██▋       | 27/100 [03:20<09:47,  8.04s/it]Best trial: 17. Best value: 0.608625:  28%|██▊       | 28/100 [03:20<08:07,  6.77s/it]Best trial: 17. Best value: 0.608625:  28%|██▊       | 28/100 [03:28<08:07,  6.77s/it]Best trial: 17. Best value: 0.608625:  29%|██▉       | 29/100 [03:28<08:19,  7.03s/it]Best trial: 17. Best value: 0.608625:  29%|██▉       | 29/100 [03:31<08:19,  7.03s/it]Best trial: 17. Best value: 0.608625:  30%|███       | 30/100 [03:31<06:36,  5.66s/it]Best trial: 17. Best value: 0.608625:  30%|███       | 30/100 [03:41<06:36,  5.66s/it]Best trial: 17. Best value: 0.608625:  31%|███       | 31/100 [03:41<08:17,  7.21s/it]Best trial: 17. Best value: 0.608625:  31%|███       | 31/100 [03:51<08:17,  7.21s/it]Best trial: 17. Best value: 0.608625:  32%|███▏      | 32/100 [03:51<09:04,  8.01s/it]Best trial: 17. Best value: 0.608625:  32%|███▏      | 32/100 [03:58<09:04,  8.01s/it]Best trial: 17. Best value: 0.608625:  33%|███▎      | 33/100 [03:58<08:38,  7.73s/it]Best trial: 17. Best value: 0.608625:  33%|███▎      | 33/100 [04:09<08:38,  7.73s/it]Best trial: 17. Best value: 0.608625:  34%|███▍      | 34/100 [04:09<09:38,  8.76s/it]Best trial: 17. Best value: 0.608625:  34%|███▍      | 34/100 [04:18<09:38,  8.76s/it]Best trial: 17. Best value: 0.608625:  35%|███▌      | 35/100 [04:18<09:29,  8.76s/it]Best trial: 17. Best value: 0.608625:  35%|███▌      | 35/100 [04:21<09:29,  8.76s/it]Best trial: 17. Best value: 0.608625:  36%|███▌      | 36/100 [04:21<07:32,  7.06s/it]Best trial: 17. Best value: 0.608625:  36%|███▌      | 36/100 [04:38<07:32,  7.06s/it]Best trial: 17. Best value: 0.608625:  37%|███▋      | 37/100 [04:38<10:30, 10.01s/it]Best trial: 17. Best value: 0.608625:  37%|███▋      | 37/100 [04:50<10:30, 10.01s/it]Best trial: 17. Best value: 0.608625:  38%|███▊      | 38/100 [04:50<10:55, 10.57s/it]Best trial: 17. Best value: 0.608625:  38%|███▊      | 38/100 [04:58<10:55, 10.57s/it]Best trial: 17. Best value: 0.608625:  39%|███▉      | 39/100 [04:58<09:55,  9.76s/it]Best trial: 17. Best value: 0.608625:  39%|███▉      | 39/100 [05:01<09:55,  9.76s/it]Best trial: 17. Best value: 0.608625:  40%|████      | 40/100 [05:01<07:38,  7.64s/it]Best trial: 17. Best value: 0.608625:  40%|████      | 40/100 [05:11<07:38,  7.64s/it]Best trial: 17. Best value: 0.608625:  41%|████      | 41/100 [05:11<08:18,  8.45s/it]Best trial: 17. Best value: 0.608625:  41%|████      | 41/100 [05:24<08:18,  8.45s/it]Best trial: 17. Best value: 0.608625:  42%|████▏     | 42/100 [05:24<09:31,  9.85s/it]Best trial: 17. Best value: 0.608625:  42%|████▏     | 42/100 [05:29<09:31,  9.85s/it]Best trial: 17. Best value: 0.608625:  43%|████▎     | 43/100 [05:29<07:50,  8.25s/it]Best trial: 17. Best value: 0.608625:  43%|████▎     | 43/100 [05:35<07:50,  8.25s/it]Best trial: 17. Best value: 0.608625:  44%|████▍     | 44/100 [05:35<07:18,  7.82s/it]Best trial: 17. Best value: 0.608625:  44%|████▍     | 44/100 [05:43<07:18,  7.82s/it]Best trial: 17. Best value: 0.608625:  45%|████▌     | 45/100 [05:43<07:08,  7.80s/it]Best trial: 17. Best value: 0.608625:  45%|████▌     | 45/100 [05:48<07:08,  7.80s/it]Best trial: 17. Best value: 0.608625:  46%|████▌     | 46/100 [05:48<06:15,  6.95s/it]Best trial: 46. Best value: 0.610233:  46%|████▌     | 46/100 [05:59<06:15,  6.95s/it]Best trial: 46. Best value: 0.610233:  47%|████▋     | 47/100 [05:59<07:09,  8.11s/it]Best trial: 46. Best value: 0.610233:  47%|████▋     | 47/100 [06:06<07:09,  8.11s/it]Best trial: 46. Best value: 0.610233:  48%|████▊     | 48/100 [06:06<06:42,  7.74s/it]Best trial: 46. Best value: 0.610233:  48%|████▊     | 48/100 [06:15<06:42,  7.74s/it]Best trial: 46. Best value: 0.610233:  49%|████▉     | 49/100 [06:15<06:49,  8.03s/it]Best trial: 46. Best value: 0.610233:  49%|████▉     | 49/100 [06:20<06:49,  8.03s/it]Best trial: 46. Best value: 0.610233:  50%|█████     | 50/100 [06:20<05:54,  7.09s/it]Best trial: 46. Best value: 0.610233:  50%|█████     | 50/100 [06:22<05:54,  7.09s/it]Best trial: 46. Best value: 0.610233:  51%|█████     | 51/100 [06:22<04:35,  5.63s/it]Best trial: 51. Best value: 0.611332:  51%|█████     | 51/100 [06:31<04:35,  5.63s/it]Best trial: 51. Best value: 0.611332:  52%|█████▏    | 52/100 [06:31<05:16,  6.59s/it]Best trial: 51. Best value: 0.611332:  52%|█████▏    | 52/100 [06:39<05:16,  6.59s/it]Best trial: 51. Best value: 0.611332:  53%|█████▎    | 53/100 [06:39<05:38,  7.19s/it]Best trial: 51. Best value: 0.611332:  53%|█████▎    | 53/100 [06:49<05:38,  7.19s/it]Best trial: 51. Best value: 0.611332:  54%|█████▍    | 54/100 [06:49<06:08,  8.01s/it]Best trial: 51. Best value: 0.611332:  54%|█████▍    | 54/100 [06:57<06:08,  8.01s/it]Best trial: 51. Best value: 0.611332:  55%|█████▌    | 55/100 [06:57<05:57,  7.94s/it]Best trial: 51. Best value: 0.611332:  55%|█████▌    | 55/100 [07:03<05:57,  7.94s/it]Best trial: 51. Best value: 0.611332:  56%|█████▌    | 56/100 [07:03<05:25,  7.39s/it]Best trial: 51. Best value: 0.611332:  56%|█████▌    | 56/100 [07:15<05:25,  7.39s/it]Best trial: 51. Best value: 0.611332:  57%|█████▋    | 57/100 [07:15<06:15,  8.73s/it]Best trial: 51. Best value: 0.611332:  57%|█████▋    | 57/100 [07:26<06:15,  8.73s/it]Best trial: 51. Best value: 0.611332:  58%|█████▊    | 58/100 [07:26<06:34,  9.39s/it]Best trial: 51. Best value: 0.611332:  58%|█████▊    | 58/100 [07:31<06:34,  9.39s/it]Best trial: 51. Best value: 0.611332:  59%|█████▉    | 59/100 [07:31<05:37,  8.23s/it]Best trial: 51. Best value: 0.611332:  59%|█████▉    | 59/100 [07:37<05:37,  8.23s/it]Best trial: 51. Best value: 0.611332:  60%|██████    | 60/100 [07:37<05:01,  7.53s/it]Best trial: 51. Best value: 0.611332:  60%|██████    | 60/100 [07:47<05:01,  7.53s/it]Best trial: 51. Best value: 0.611332:  61%|██████    | 61/100 [07:47<05:19,  8.20s/it]Best trial: 51. Best value: 0.611332:  61%|██████    | 61/100 [07:52<05:19,  8.20s/it]Best trial: 51. Best value: 0.611332:  62%|██████▏   | 62/100 [07:52<04:35,  7.24s/it]Best trial: 51. Best value: 0.611332:  62%|██████▏   | 62/100 [07:58<04:35,  7.24s/it]Best trial: 51. Best value: 0.611332:  63%|██████▎   | 63/100 [07:58<04:15,  6.92s/it]Best trial: 63. Best value: 0.614608:  63%|██████▎   | 63/100 [08:07<04:15,  6.92s/it]Best trial: 63. Best value: 0.614608:  64%|██████▍   | 64/100 [08:07<04:29,  7.49s/it]Best trial: 63. Best value: 0.614608:  64%|██████▍   | 64/100 [08:15<04:29,  7.49s/it]Best trial: 63. Best value: 0.614608:  65%|██████▌   | 65/100 [08:15<04:31,  7.76s/it]Best trial: 63. Best value: 0.614608:  65%|██████▌   | 65/100 [08:23<04:31,  7.76s/it]Best trial: 63. Best value: 0.614608:  66%|██████▌   | 66/100 [08:23<04:25,  7.80s/it]Best trial: 63. Best value: 0.614608:  66%|██████▌   | 66/100 [08:32<04:25,  7.80s/it]Best trial: 63. Best value: 0.614608:  67%|██████▋   | 67/100 [08:32<04:25,  8.03s/it]Best trial: 63. Best value: 0.614608:  67%|██████▋   | 67/100 [08:39<04:25,  8.03s/it]Best trial: 63. Best value: 0.614608:  68%|██████▊   | 68/100 [08:39<04:06,  7.69s/it]Best trial: 63. Best value: 0.614608:  68%|██████▊   | 68/100 [08:47<04:06,  7.69s/it]Best trial: 63. Best value: 0.614608:  69%|██████▉   | 69/100 [08:47<04:02,  7.81s/it]Best trial: 63. Best value: 0.614608:  69%|██████▉   | 69/100 [08:52<04:02,  7.81s/it]Best trial: 63. Best value: 0.614608:  70%|███████   | 70/100 [08:52<03:28,  6.95s/it]Best trial: 63. Best value: 0.614608:  70%|███████   | 70/100 [09:05<03:28,  6.95s/it]Best trial: 63. Best value: 0.614608:  71%|███████   | 71/100 [09:05<04:20,  8.99s/it]Best trial: 63. Best value: 0.614608:  71%|███████   | 71/100 [09:13<04:20,  8.99s/it]Best trial: 63. Best value: 0.614608:  72%|███████▏  | 72/100 [09:13<04:02,  8.67s/it]Best trial: 63. Best value: 0.614608:  72%|███████▏  | 72/100 [09:23<04:02,  8.67s/it]Best trial: 63. Best value: 0.614608:  73%|███████▎  | 73/100 [09:23<04:00,  8.92s/it]Best trial: 63. Best value: 0.614608:  73%|███████▎  | 73/100 [09:29<04:00,  8.92s/it]Best trial: 63. Best value: 0.614608:  74%|███████▍  | 74/100 [09:29<03:32,  8.16s/it]Best trial: 63. Best value: 0.614608:  74%|███████▍  | 74/100 [09:43<03:32,  8.16s/it]Best trial: 63. Best value: 0.614608:  75%|███████▌  | 75/100 [09:43<04:02,  9.72s/it]Best trial: 63. Best value: 0.614608:  75%|███████▌  | 75/100 [09:54<04:02,  9.72s/it]Best trial: 63. Best value: 0.614608:  76%|███████▌  | 76/100 [09:54<04:05, 10.21s/it]Best trial: 63. Best value: 0.614608:  76%|███████▌  | 76/100 [10:01<04:05, 10.21s/it]Best trial: 63. Best value: 0.614608:  77%|███████▋  | 77/100 [10:01<03:35,  9.38s/it]Best trial: 63. Best value: 0.614608:  77%|███████▋  | 77/100 [10:10<03:35,  9.38s/it]Best trial: 63. Best value: 0.614608:  78%|███████▊  | 78/100 [10:10<03:18,  9.01s/it]Best trial: 63. Best value: 0.614608:  78%|███████▊  | 78/100 [10:16<03:18,  9.01s/it]Best trial: 63. Best value: 0.614608:  79%|███████▉  | 79/100 [10:16<02:50,  8.13s/it]Best trial: 63. Best value: 0.614608:  79%|███████▉  | 79/100 [10:26<02:50,  8.13s/it]Best trial: 63. Best value: 0.614608:  80%|████████  | 80/100 [10:26<02:57,  8.88s/it]Best trial: 63. Best value: 0.614608:  80%|████████  | 80/100 [10:31<02:57,  8.88s/it]Best trial: 63. Best value: 0.614608:  81%|████████  | 81/100 [10:31<02:27,  7.77s/it]Best trial: 63. Best value: 0.614608:  81%|████████  | 81/100 [10:39<02:27,  7.77s/it]Best trial: 63. Best value: 0.614608:  82%|████████▏ | 82/100 [10:39<02:16,  7.57s/it]Best trial: 63. Best value: 0.614608:  82%|████████▏ | 82/100 [10:46<02:16,  7.57s/it]Best trial: 63. Best value: 0.614608:  83%|████████▎ | 83/100 [10:46<02:06,  7.43s/it]Best trial: 63. Best value: 0.614608:  83%|████████▎ | 83/100 [10:55<02:06,  7.43s/it]Best trial: 63. Best value: 0.614608:  84%|████████▍ | 84/100 [10:55<02:07,  7.95s/it]Best trial: 63. Best value: 0.614608:  84%|████████▍ | 84/100 [10:59<02:07,  7.95s/it]Best trial: 63. Best value: 0.614608:  85%|████████▌ | 85/100 [10:59<01:43,  6.92s/it]Best trial: 63. Best value: 0.614608:  85%|████████▌ | 85/100 [11:05<01:43,  6.92s/it]Best trial: 63. Best value: 0.614608:  86%|████████▌ | 86/100 [11:05<01:31,  6.55s/it]Best trial: 63. Best value: 0.614608:  86%|████████▌ | 86/100 [11:12<01:31,  6.55s/it]Best trial: 63. Best value: 0.614608:  87%|████████▋ | 87/100 [11:12<01:27,  6.74s/it]Best trial: 63. Best value: 0.614608:  87%|████████▋ | 87/100 [11:18<01:27,  6.74s/it]Best trial: 63. Best value: 0.614608:  88%|████████▊ | 88/100 [11:18<01:19,  6.59s/it]Best trial: 63. Best value: 0.614608:  88%|████████▊ | 88/100 [11:25<01:19,  6.59s/it]Best trial: 63. Best value: 0.614608:  89%|████████▉ | 89/100 [11:25<01:12,  6.58s/it]Best trial: 63. Best value: 0.614608:  89%|████████▉ | 89/100 [11:31<01:12,  6.58s/it]Best trial: 63. Best value: 0.614608:  90%|█████████ | 90/100 [11:31<01:02,  6.29s/it]Best trial: 63. Best value: 0.614608:  90%|█████████ | 90/100 [11:44<01:02,  6.29s/it]Best trial: 63. Best value: 0.614608:  91%|█████████ | 91/100 [11:44<01:15,  8.36s/it]Best trial: 63. Best value: 0.614608:  91%|█████████ | 91/100 [11:48<01:15,  8.36s/it]Best trial: 63. Best value: 0.614608:  92%|█████████▏| 92/100 [11:48<00:56,  7.08s/it]Best trial: 63. Best value: 0.614608:  92%|█████████▏| 92/100 [11:54<00:56,  7.08s/it]Best trial: 63. Best value: 0.614608:  93%|█████████▎| 93/100 [11:54<00:46,  6.67s/it]Best trial: 63. Best value: 0.614608:  93%|█████████▎| 93/100 [12:03<00:46,  6.67s/it]Best trial: 63. Best value: 0.614608:  94%|█████████▍| 94/100 [12:03<00:44,  7.38s/it]Best trial: 63. Best value: 0.614608:  94%|█████████▍| 94/100 [12:08<00:44,  7.38s/it]Best trial: 63. Best value: 0.614608:  95%|█████████▌| 95/100 [12:08<00:33,  6.68s/it]Best trial: 63. Best value: 0.614608:  95%|█████████▌| 95/100 [12:19<00:33,  6.68s/it]Best trial: 63. Best value: 0.614608:  96%|█████████▌| 96/100 [12:19<00:32,  8.14s/it]Best trial: 63. Best value: 0.614608:  96%|█████████▌| 96/100 [12:25<00:32,  8.14s/it]Best trial: 63. Best value: 0.614608:  97%|█████████▋| 97/100 [12:25<00:22,  7.42s/it]Best trial: 63. Best value: 0.614608:  97%|█████████▋| 97/100 [12:30<00:22,  7.42s/it]Best trial: 63. Best value: 0.614608:  98%|█████████▊| 98/100 [12:30<00:13,  6.71s/it]Best trial: 63. Best value: 0.614608:  98%|█████████▊| 98/100 [12:35<00:13,  6.71s/it]Best trial: 63. Best value: 0.614608:  99%|█████████▉| 99/100 [12:35<00:06,  6.09s/it]Best trial: 63. Best value: 0.614608:  99%|█████████▉| 99/100 [12:46<00:06,  6.09s/it]Best trial: 63. Best value: 0.614608: 100%|██████████| 100/100 [12:46<00:00,  7.64s/it]Best trial: 63. Best value: 0.614608: 100%|██████████| 100/100 [12:46<00:00,  7.66s/it]
2025-11-30 18:38:42,022 - INFO - HPO Complete. Best AUPRC: 0.6146
2025-11-30 18:38:42,022 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.01977872908557731, 'max_depth': 8, 'subsample': 0.7337172215238882, 'colsample_bytree': 0.6107588007684759, 'gamma': 3.0483676330097884, 'reg_lambda': 0.0009524131501297284, 'reg_alpha': 0.39091019393661436}
2025-11-30 18:38:42,023 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:38:43,829 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 18:38:43,830 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:38:43,919 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:38:43,952 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:38:43,961 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:38:43,961 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:38:43,962 - INFO - Training model...
2025-11-30 18:38:47,032 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:38:52,591 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:38:52,591 - INFO - AUROC: 0.8204 (0.7935 - 0.8476)
2025-11-30 18:38:52,591 - INFO - AUPRC: 0.5599 (0.4972 - 0.6521)
2025-11-30 18:38:52,591 - INFO - Brier Score: 0.1406 (0.1294 - 0.1489)
2025-11-30 18:38:52,591 - INFO - Accuracy: 0.7529 (0.7413 - 0.8165)
2025-11-30 18:38:52,591 - INFO - Precision: 0.4730 (0.4473 - 0.6082)
2025-11-30 18:38:52,591 - INFO - Sensitivity (Recall): 0.7215 (0.5922 - 0.8000)
2025-11-30 18:38:52,591 - INFO - F1-Score: 0.5714 (0.5376 - 0.6254)
2025-11-30 18:38:52,591 - INFO - Best Threshold: 0.3300 (0.2760 - 0.4600)
2025-11-30 18:38:52,591 - INFO - Specificity: 0.7622 (0.7330 - 0.8718)
2025-11-30 18:38:52,614 - INFO - Calculating SHAP values...
2025-11-30 18:38:53,929 - INFO - SHAP plots saved.
2025-11-30 18:38:53,931 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:38:55,208 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 18:38:55,208 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:38:55,307 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:38:55,338 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:38:55,346 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:38:55,346 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.541798:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.541798:   1%|          | 1/100 [00:02<03:18,  2.01s/it]Best trial: 1. Best value: 0.591208:   1%|          | 1/100 [00:13<03:18,  2.01s/it]Best trial: 1. Best value: 0.591208:   2%|▏         | 2/100 [00:13<12:51,  7.87s/it]Best trial: 2. Best value: 0.593762:   2%|▏         | 2/100 [00:17<12:51,  7.87s/it]Best trial: 2. Best value: 0.593762:   3%|▎         | 3/100 [00:17<09:27,  5.85s/it]Best trial: 2. Best value: 0.593762:   3%|▎         | 3/100 [00:21<09:27,  5.85s/it]Best trial: 2. Best value: 0.593762:   4%|▍         | 4/100 [00:21<08:02,  5.03s/it]Best trial: 2. Best value: 0.593762:   4%|▍         | 4/100 [00:23<08:02,  5.03s/it]Best trial: 2. Best value: 0.593762:   5%|▌         | 5/100 [00:23<06:21,  4.01s/it]Best trial: 2. Best value: 0.593762:   5%|▌         | 5/100 [00:31<06:21,  4.01s/it]Best trial: 2. Best value: 0.593762:   6%|▌         | 6/100 [00:31<08:28,  5.41s/it]Best trial: 2. Best value: 0.593762:   6%|▌         | 6/100 [00:41<08:28,  5.41s/it]Best trial: 2. Best value: 0.593762:   7%|▋         | 7/100 [00:41<10:35,  6.84s/it]Best trial: 7. Best value: 0.600487:   7%|▋         | 7/100 [00:44<10:35,  6.84s/it]Best trial: 7. Best value: 0.600487:   8%|▊         | 8/100 [00:44<08:35,  5.61s/it]Best trial: 7. Best value: 0.600487:   8%|▊         | 8/100 [00:46<08:35,  5.61s/it]Best trial: 7. Best value: 0.600487:   9%|▉         | 9/100 [00:46<07:04,  4.66s/it]Best trial: 7. Best value: 0.600487:   9%|▉         | 9/100 [00:51<07:04,  4.66s/it]Best trial: 7. Best value: 0.600487:  10%|█         | 10/100 [00:51<06:47,  4.52s/it]Best trial: 7. Best value: 0.600487:  10%|█         | 10/100 [00:55<06:47,  4.52s/it]Best trial: 7. Best value: 0.600487:  11%|█         | 11/100 [00:55<06:50,  4.61s/it]Best trial: 7. Best value: 0.600487:  11%|█         | 11/100 [00:58<06:50,  4.61s/it]Best trial: 7. Best value: 0.600487:  12%|█▏        | 12/100 [00:58<05:48,  3.96s/it]Best trial: 7. Best value: 0.600487:  12%|█▏        | 12/100 [01:01<05:48,  3.96s/it]Best trial: 7. Best value: 0.600487:  13%|█▎        | 13/100 [01:01<05:28,  3.78s/it]Best trial: 7. Best value: 0.600487:  13%|█▎        | 13/100 [01:06<05:28,  3.78s/it]Best trial: 7. Best value: 0.600487:  14%|█▍        | 14/100 [01:06<05:59,  4.18s/it]Best trial: 7. Best value: 0.600487:  14%|█▍        | 14/100 [01:11<05:59,  4.18s/it]Best trial: 7. Best value: 0.600487:  15%|█▌        | 15/100 [01:11<06:15,  4.42s/it]Best trial: 7. Best value: 0.600487:  15%|█▌        | 15/100 [01:16<06:15,  4.42s/it]Best trial: 7. Best value: 0.600487:  16%|█▌        | 16/100 [01:16<06:29,  4.64s/it]Best trial: 16. Best value: 0.601089:  16%|█▌        | 16/100 [01:25<06:29,  4.64s/it]Best trial: 16. Best value: 0.601089:  17%|█▋        | 17/100 [01:25<07:55,  5.73s/it]Best trial: 16. Best value: 0.601089:  17%|█▋        | 17/100 [01:32<07:55,  5.73s/it]Best trial: 16. Best value: 0.601089:  18%|█▊        | 18/100 [01:32<08:38,  6.32s/it]Best trial: 16. Best value: 0.601089:  18%|█▊        | 18/100 [01:35<08:38,  6.32s/it]Best trial: 16. Best value: 0.601089:  19%|█▉        | 19/100 [01:35<06:57,  5.15s/it]Best trial: 16. Best value: 0.601089:  19%|█▉        | 19/100 [01:42<06:57,  5.15s/it]Best trial: 16. Best value: 0.601089:  20%|██        | 20/100 [01:42<07:44,  5.80s/it]Best trial: 16. Best value: 0.601089:  20%|██        | 20/100 [01:45<07:44,  5.80s/it]Best trial: 16. Best value: 0.601089:  21%|██        | 21/100 [01:45<06:25,  4.87s/it]Best trial: 16. Best value: 0.601089:  21%|██        | 21/100 [01:48<06:25,  4.87s/it]Best trial: 16. Best value: 0.601089:  22%|██▏       | 22/100 [01:48<05:50,  4.49s/it]Best trial: 16. Best value: 0.601089:  22%|██▏       | 22/100 [01:53<05:50,  4.49s/it]Best trial: 16. Best value: 0.601089:  23%|██▎       | 23/100 [01:53<05:39,  4.41s/it]Best trial: 16. Best value: 0.601089:  23%|██▎       | 23/100 [01:58<05:39,  4.41s/it]Best trial: 16. Best value: 0.601089:  24%|██▍       | 24/100 [01:58<05:44,  4.54s/it]Best trial: 24. Best value: 0.601857:  24%|██▍       | 24/100 [02:01<05:44,  4.54s/it]Best trial: 24. Best value: 0.601857:  25%|██▌       | 25/100 [02:01<05:25,  4.34s/it]Best trial: 24. Best value: 0.601857:  25%|██▌       | 25/100 [02:04<05:25,  4.34s/it]Best trial: 24. Best value: 0.601857:  26%|██▌       | 26/100 [02:04<04:37,  3.75s/it]Best trial: 24. Best value: 0.601857:  26%|██▌       | 26/100 [02:11<04:37,  3.75s/it]Best trial: 24. Best value: 0.601857:  27%|██▋       | 27/100 [02:11<05:58,  4.91s/it]Best trial: 24. Best value: 0.601857:  27%|██▋       | 27/100 [02:15<05:58,  4.91s/it]Best trial: 24. Best value: 0.601857:  28%|██▊       | 28/100 [02:15<05:28,  4.56s/it]Best trial: 24. Best value: 0.601857:  28%|██▊       | 28/100 [02:19<05:28,  4.56s/it]Best trial: 24. Best value: 0.601857:  29%|██▉       | 29/100 [02:19<04:59,  4.21s/it]Best trial: 24. Best value: 0.601857:  29%|██▉       | 29/100 [02:23<04:59,  4.21s/it]Best trial: 24. Best value: 0.601857:  30%|███       | 30/100 [02:23<04:50,  4.16s/it]Best trial: 24. Best value: 0.601857:  30%|███       | 30/100 [02:26<04:50,  4.16s/it]Best trial: 24. Best value: 0.601857:  31%|███       | 31/100 [02:26<04:25,  3.85s/it]Best trial: 24. Best value: 0.601857:  31%|███       | 31/100 [02:29<04:25,  3.85s/it]Best trial: 24. Best value: 0.601857:  32%|███▏      | 32/100 [02:29<04:10,  3.68s/it]Best trial: 24. Best value: 0.601857:  32%|███▏      | 32/100 [02:33<04:10,  3.68s/it]Best trial: 24. Best value: 0.601857:  33%|███▎      | 33/100 [02:33<04:11,  3.75s/it]Best trial: 24. Best value: 0.601857:  33%|███▎      | 33/100 [02:36<04:11,  3.75s/it]Best trial: 24. Best value: 0.601857:  34%|███▍      | 34/100 [02:36<04:03,  3.68s/it]Best trial: 24. Best value: 0.601857:  34%|███▍      | 34/100 [02:41<04:03,  3.68s/it]Best trial: 24. Best value: 0.601857:  35%|███▌      | 35/100 [02:41<04:15,  3.93s/it]Best trial: 24. Best value: 0.601857:  35%|███▌      | 35/100 [02:45<04:15,  3.93s/it]Best trial: 24. Best value: 0.601857:  36%|███▌      | 36/100 [02:45<04:07,  3.87s/it]Best trial: 24. Best value: 0.601857:  36%|███▌      | 36/100 [02:47<04:07,  3.87s/it]Best trial: 24. Best value: 0.601857:  37%|███▋      | 37/100 [02:47<03:41,  3.52s/it]Best trial: 24. Best value: 0.601857:  37%|███▋      | 37/100 [02:52<03:41,  3.52s/it]Best trial: 24. Best value: 0.601857:  38%|███▊      | 38/100 [02:52<03:58,  3.85s/it]Best trial: 24. Best value: 0.601857:  38%|███▊      | 38/100 [03:00<03:58,  3.85s/it]Best trial: 24. Best value: 0.601857:  39%|███▉      | 39/100 [03:00<05:18,  5.23s/it]Best trial: 24. Best value: 0.601857:  39%|███▉      | 39/100 [03:05<05:18,  5.23s/it]Best trial: 24. Best value: 0.601857:  40%|████      | 40/100 [03:05<04:54,  4.91s/it]Best trial: 24. Best value: 0.601857:  40%|████      | 40/100 [03:10<04:54,  4.91s/it]Best trial: 24. Best value: 0.601857:  41%|████      | 41/100 [03:10<04:49,  4.91s/it]Best trial: 24. Best value: 0.601857:  41%|████      | 41/100 [03:15<04:49,  4.91s/it]Best trial: 24. Best value: 0.601857:  42%|████▏     | 42/100 [03:15<04:54,  5.07s/it]Best trial: 24. Best value: 0.601857:  42%|████▏     | 42/100 [03:18<04:54,  5.07s/it]Best trial: 24. Best value: 0.601857:  43%|████▎     | 43/100 [03:18<04:17,  4.51s/it]Best trial: 24. Best value: 0.601857:  43%|████▎     | 43/100 [03:24<04:17,  4.51s/it]Best trial: 24. Best value: 0.601857:  44%|████▍     | 44/100 [03:24<04:38,  4.97s/it]Best trial: 24. Best value: 0.601857:  44%|████▍     | 44/100 [03:28<04:38,  4.97s/it]Best trial: 24. Best value: 0.601857:  45%|████▌     | 45/100 [03:28<04:14,  4.62s/it]Best trial: 24. Best value: 0.601857:  45%|████▌     | 45/100 [03:34<04:14,  4.62s/it]Best trial: 24. Best value: 0.601857:  46%|████▌     | 46/100 [03:34<04:35,  5.11s/it]Best trial: 46. Best value: 0.603851:  46%|████▌     | 46/100 [03:38<04:35,  5.11s/it]Best trial: 46. Best value: 0.603851:  47%|████▋     | 47/100 [03:38<04:05,  4.63s/it]Best trial: 46. Best value: 0.603851:  47%|████▋     | 47/100 [03:41<04:05,  4.63s/it]Best trial: 46. Best value: 0.603851:  48%|████▊     | 48/100 [03:41<03:39,  4.23s/it]Best trial: 46. Best value: 0.603851:  48%|████▊     | 48/100 [03:43<03:39,  4.23s/it]Best trial: 46. Best value: 0.603851:  49%|████▉     | 49/100 [03:43<03:05,  3.64s/it]Best trial: 46. Best value: 0.603851:  49%|████▉     | 49/100 [03:46<03:05,  3.64s/it]Best trial: 46. Best value: 0.603851:  50%|█████     | 50/100 [03:46<02:52,  3.46s/it]Best trial: 46. Best value: 0.603851:  50%|█████     | 50/100 [03:50<02:52,  3.46s/it]Best trial: 46. Best value: 0.603851:  51%|█████     | 51/100 [03:50<02:52,  3.51s/it]Best trial: 46. Best value: 0.603851:  51%|█████     | 51/100 [03:53<02:52,  3.51s/it]Best trial: 46. Best value: 0.603851:  52%|█████▏    | 52/100 [03:53<02:46,  3.46s/it]Best trial: 46. Best value: 0.603851:  52%|█████▏    | 52/100 [03:58<02:46,  3.46s/it]Best trial: 46. Best value: 0.603851:  53%|█████▎    | 53/100 [03:58<03:00,  3.85s/it]Best trial: 46. Best value: 0.603851:  53%|█████▎    | 53/100 [04:01<03:00,  3.85s/it]Best trial: 46. Best value: 0.603851:  54%|█████▍    | 54/100 [04:01<02:43,  3.56s/it]Best trial: 46. Best value: 0.603851:  54%|█████▍    | 54/100 [04:03<02:43,  3.56s/it]Best trial: 46. Best value: 0.603851:  55%|█████▌    | 55/100 [04:03<02:26,  3.25s/it]Best trial: 46. Best value: 0.603851:  55%|█████▌    | 55/100 [04:05<02:26,  3.25s/it]Best trial: 46. Best value: 0.603851:  56%|█████▌    | 56/100 [04:05<02:01,  2.77s/it]Best trial: 46. Best value: 0.603851:  56%|█████▌    | 56/100 [04:09<02:01,  2.77s/it]Best trial: 46. Best value: 0.603851:  57%|█████▋    | 57/100 [04:09<02:08,  3.00s/it]Best trial: 46. Best value: 0.603851:  57%|█████▋    | 57/100 [04:12<02:08,  3.00s/it]Best trial: 46. Best value: 0.603851:  58%|█████▊    | 58/100 [04:12<02:05,  2.99s/it]Best trial: 46. Best value: 0.603851:  58%|█████▊    | 58/100 [04:14<02:05,  2.99s/it]Best trial: 46. Best value: 0.603851:  59%|█████▉    | 59/100 [04:14<01:53,  2.78s/it]Best trial: 46. Best value: 0.603851:  59%|█████▉    | 59/100 [04:18<01:53,  2.78s/it]Best trial: 46. Best value: 0.603851:  60%|██████    | 60/100 [04:18<02:00,  3.02s/it]Best trial: 46. Best value: 0.603851:  60%|██████    | 60/100 [04:20<02:00,  3.02s/it]Best trial: 46. Best value: 0.603851:  61%|██████    | 61/100 [04:20<01:53,  2.92s/it]Best trial: 46. Best value: 0.603851:  61%|██████    | 61/100 [04:24<01:53,  2.92s/it]Best trial: 46. Best value: 0.603851:  62%|██████▏   | 62/100 [04:24<02:03,  3.25s/it]Best trial: 46. Best value: 0.603851:  62%|██████▏   | 62/100 [04:27<02:03,  3.25s/it]Best trial: 46. Best value: 0.603851:  63%|██████▎   | 63/100 [04:27<01:57,  3.18s/it]Best trial: 46. Best value: 0.603851:  63%|██████▎   | 63/100 [04:31<01:57,  3.18s/it]Best trial: 46. Best value: 0.603851:  64%|██████▍   | 64/100 [04:31<01:59,  3.31s/it]Best trial: 46. Best value: 0.603851:  64%|██████▍   | 64/100 [04:34<01:59,  3.31s/it]Best trial: 46. Best value: 0.603851:  65%|██████▌   | 65/100 [04:34<01:51,  3.18s/it]Best trial: 46. Best value: 0.603851:  65%|██████▌   | 65/100 [04:36<01:51,  3.18s/it]Best trial: 46. Best value: 0.603851:  66%|██████▌   | 66/100 [04:36<01:43,  3.05s/it]Best trial: 46. Best value: 0.603851:  66%|██████▌   | 66/100 [04:41<01:43,  3.05s/it]Best trial: 46. Best value: 0.603851:  67%|██████▋   | 67/100 [04:41<01:51,  3.38s/it]Best trial: 46. Best value: 0.603851:  67%|██████▋   | 67/100 [04:47<01:51,  3.38s/it]Best trial: 46. Best value: 0.603851:  68%|██████▊   | 68/100 [04:47<02:17,  4.31s/it]Best trial: 46. Best value: 0.603851:  68%|██████▊   | 68/100 [04:49<02:17,  4.31s/it]Best trial: 46. Best value: 0.603851:  69%|██████▉   | 69/100 [04:49<01:54,  3.69s/it]Best trial: 46. Best value: 0.603851:  69%|██████▉   | 69/100 [04:54<01:54,  3.69s/it]Best trial: 46. Best value: 0.603851:  70%|███████   | 70/100 [04:54<02:03,  4.11s/it]Best trial: 46. Best value: 0.603851:  70%|███████   | 70/100 [04:59<02:03,  4.11s/it]Best trial: 46. Best value: 0.603851:  71%|███████   | 71/100 [04:59<02:06,  4.37s/it]Best trial: 46. Best value: 0.603851:  71%|███████   | 71/100 [05:04<02:06,  4.37s/it]Best trial: 46. Best value: 0.603851:  72%|███████▏  | 72/100 [05:04<02:03,  4.41s/it]Best trial: 46. Best value: 0.603851:  72%|███████▏  | 72/100 [05:07<02:03,  4.41s/it]Best trial: 46. Best value: 0.603851:  73%|███████▎  | 73/100 [05:07<01:51,  4.13s/it]Best trial: 46. Best value: 0.603851:  73%|███████▎  | 73/100 [05:11<01:51,  4.13s/it]Best trial: 46. Best value: 0.603851:  74%|███████▍  | 74/100 [05:11<01:40,  3.88s/it]Best trial: 46. Best value: 0.603851:  74%|███████▍  | 74/100 [05:14<01:40,  3.88s/it]Best trial: 46. Best value: 0.603851:  75%|███████▌  | 75/100 [05:14<01:35,  3.84s/it]Best trial: 46. Best value: 0.603851:  75%|███████▌  | 75/100 [05:18<01:35,  3.84s/it]Best trial: 46. Best value: 0.603851:  76%|███████▌  | 76/100 [05:18<01:26,  3.61s/it]Best trial: 46. Best value: 0.603851:  76%|███████▌  | 76/100 [05:21<01:26,  3.61s/it]Best trial: 46. Best value: 0.603851:  77%|███████▋  | 77/100 [05:21<01:18,  3.43s/it]Best trial: 46. Best value: 0.603851:  77%|███████▋  | 77/100 [05:26<01:18,  3.43s/it]Best trial: 46. Best value: 0.603851:  78%|███████▊  | 78/100 [05:26<01:27,  4.00s/it]Best trial: 46. Best value: 0.603851:  78%|███████▊  | 78/100 [05:29<01:27,  4.00s/it]Best trial: 46. Best value: 0.603851:  79%|███████▉  | 79/100 [05:29<01:19,  3.80s/it]Best trial: 46. Best value: 0.603851:  79%|███████▉  | 79/100 [05:33<01:19,  3.80s/it]Best trial: 46. Best value: 0.603851:  80%|████████  | 80/100 [05:33<01:17,  3.90s/it]Best trial: 46. Best value: 0.603851:  80%|████████  | 80/100 [05:37<01:17,  3.90s/it]Best trial: 46. Best value: 0.603851:  81%|████████  | 81/100 [05:37<01:10,  3.72s/it]Best trial: 81. Best value: 0.606193:  81%|████████  | 81/100 [05:40<01:10,  3.72s/it]Best trial: 81. Best value: 0.606193:  82%|████████▏ | 82/100 [05:40<01:06,  3.71s/it]Best trial: 81. Best value: 0.606193:  82%|████████▏ | 82/100 [05:45<01:06,  3.71s/it]Best trial: 81. Best value: 0.606193:  83%|████████▎ | 83/100 [05:45<01:10,  4.15s/it]Best trial: 81. Best value: 0.606193:  83%|████████▎ | 83/100 [05:51<01:10,  4.15s/it]Best trial: 81. Best value: 0.606193:  84%|████████▍ | 84/100 [05:51<01:11,  4.50s/it]Best trial: 81. Best value: 0.606193:  84%|████████▍ | 84/100 [05:55<01:11,  4.50s/it]Best trial: 81. Best value: 0.606193:  85%|████████▌ | 85/100 [05:55<01:05,  4.39s/it]Best trial: 81. Best value: 0.606193:  85%|████████▌ | 85/100 [06:00<01:05,  4.39s/it]Best trial: 81. Best value: 0.606193:  86%|████████▌ | 86/100 [06:00<01:05,  4.66s/it]Best trial: 81. Best value: 0.606193:  86%|████████▌ | 86/100 [06:05<01:05,  4.66s/it]Best trial: 81. Best value: 0.606193:  87%|████████▋ | 87/100 [06:05<01:01,  4.71s/it]Best trial: 81. Best value: 0.606193:  87%|████████▋ | 87/100 [06:10<01:01,  4.71s/it]Best trial: 81. Best value: 0.606193:  88%|████████▊ | 88/100 [06:10<00:56,  4.75s/it]Best trial: 81. Best value: 0.606193:  88%|████████▊ | 88/100 [06:13<00:56,  4.75s/it]Best trial: 81. Best value: 0.606193:  89%|████████▉ | 89/100 [06:13<00:46,  4.26s/it]Best trial: 81. Best value: 0.606193:  89%|████████▉ | 89/100 [06:19<00:46,  4.26s/it]Best trial: 81. Best value: 0.606193:  90%|█████████ | 90/100 [06:19<00:46,  4.66s/it]Best trial: 81. Best value: 0.606193:  90%|█████████ | 90/100 [06:23<00:46,  4.66s/it]Best trial: 81. Best value: 0.606193:  91%|█████████ | 91/100 [06:23<00:41,  4.57s/it]Best trial: 81. Best value: 0.606193:  91%|█████████ | 91/100 [06:26<00:41,  4.57s/it]Best trial: 81. Best value: 0.606193:  92%|█████████▏| 92/100 [06:26<00:34,  4.25s/it]Best trial: 81. Best value: 0.606193:  92%|█████████▏| 92/100 [06:30<00:34,  4.25s/it]Best trial: 81. Best value: 0.606193:  93%|█████████▎| 93/100 [06:30<00:27,  3.99s/it]Best trial: 81. Best value: 0.606193:  93%|█████████▎| 93/100 [06:35<00:27,  3.99s/it]Best trial: 81. Best value: 0.606193:  94%|█████████▍| 94/100 [06:35<00:25,  4.32s/it]Best trial: 81. Best value: 0.606193:  94%|█████████▍| 94/100 [06:39<00:25,  4.32s/it]Best trial: 81. Best value: 0.606193:  95%|█████████▌| 95/100 [06:39<00:21,  4.34s/it]Best trial: 81. Best value: 0.606193:  95%|█████████▌| 95/100 [06:43<00:21,  4.34s/it]Best trial: 81. Best value: 0.606193:  96%|█████████▌| 96/100 [06:43<00:16,  4.04s/it]Best trial: 81. Best value: 0.606193:  96%|█████████▌| 96/100 [06:47<00:16,  4.04s/it]Best trial: 81. Best value: 0.606193:  97%|█████████▋| 97/100 [06:47<00:12,  4.16s/it]Best trial: 81. Best value: 0.606193:  97%|█████████▋| 97/100 [06:50<00:12,  4.16s/it]Best trial: 81. Best value: 0.606193:  98%|█████████▊| 98/100 [06:50<00:07,  3.87s/it]Best trial: 81. Best value: 0.606193:  98%|█████████▊| 98/100 [06:54<00:07,  3.87s/it]Best trial: 81. Best value: 0.606193:  99%|█████████▉| 99/100 [06:54<00:03,  3.95s/it]Best trial: 81. Best value: 0.606193:  99%|█████████▉| 99/100 [06:57<00:03,  3.95s/it]Best trial: 81. Best value: 0.606193: 100%|██████████| 100/100 [06:57<00:00,  3.63s/it]Best trial: 81. Best value: 0.606193: 100%|██████████| 100/100 [06:57<00:00,  4.18s/it]
2025-11-30 18:45:53,180 - INFO - HPO Complete. Best AUPRC: 0.6062
2025-11-30 18:45:53,180 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.03212901349201423, 'max_depth': 5, 'subsample': 0.6631488685001365, 'colsample_bytree': 0.7569622302296665, 'gamma': 4.4709327399486245, 'reg_lambda': 0.0001384358993592704, 'reg_alpha': 0.011810151381897298}
2025-11-30 18:45:53,181 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:45:55,223 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 18:45:55,223 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:45:55,318 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:45:55,354 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:45:55,364 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:45:55,365 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:45:55,365 - INFO - Training model...
2025-11-30 18:45:57,372 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:46:02,993 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:46:02,993 - INFO - AUROC: 0.7959 (0.7591 - 0.8164)
2025-11-30 18:46:02,993 - INFO - AUPRC: 0.5504 (0.4788 - 0.6171)
2025-11-30 18:46:02,993 - INFO - Brier Score: 0.1490 (0.1420 - 0.1595)
2025-11-30 18:46:02,993 - INFO - Accuracy: 0.7240 (0.6905 - 0.8145)
2025-11-30 18:46:02,993 - INFO - Precision: 0.4387 (0.3959 - 0.5950)
2025-11-30 18:46:02,993 - INFO - Sensitivity (Recall): 0.7468 (0.5550 - 0.8626)
2025-11-30 18:46:02,993 - INFO - F1-Score: 0.5527 (0.5270 - 0.6206)
2025-11-30 18:46:02,993 - INFO - Best Threshold: 0.3000 (0.2500 - 0.5200)
2025-11-30 18:46:02,993 - INFO - Specificity: 0.7172 (0.6534 - 0.8863)
2025-11-30 18:46:03,010 - INFO - Calculating SHAP values...
2025-11-30 18:46:04,159 - INFO - SHAP plots saved.
2025-11-30 18:46:04,161 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=non_windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:46:05,419 - INFO - Starting HPO for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 18:46:05,420 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:46:05,515 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:46:05,548 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:46:05,555 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:46:05,555 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.60046:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.60046:   1%|          | 1/100 [00:02<04:17,  2.60s/it]Best trial: 0. Best value: 0.60046:   1%|          | 1/100 [00:09<04:17,  2.60s/it]Best trial: 0. Best value: 0.60046:   2%|▏         | 2/100 [00:09<07:55,  4.85s/it]Best trial: 0. Best value: 0.60046:   2%|▏         | 2/100 [00:11<07:55,  4.85s/it]Best trial: 0. Best value: 0.60046:   3%|▎         | 3/100 [00:11<06:04,  3.75s/it]Best trial: 3. Best value: 0.609342:   3%|▎         | 3/100 [00:23<06:04,  3.75s/it]Best trial: 3. Best value: 0.609342:   4%|▍         | 4/100 [00:23<11:21,  7.10s/it]Best trial: 3. Best value: 0.609342:   4%|▍         | 4/100 [00:28<11:21,  7.10s/it]Best trial: 3. Best value: 0.609342:   5%|▌         | 5/100 [00:28<09:40,  6.11s/it]Best trial: 3. Best value: 0.609342:   5%|▌         | 5/100 [00:30<09:40,  6.11s/it]Best trial: 3. Best value: 0.609342:   6%|▌         | 6/100 [00:30<07:47,  4.97s/it]Best trial: 3. Best value: 0.609342:   6%|▌         | 6/100 [00:37<07:47,  4.97s/it]Best trial: 3. Best value: 0.609342:   7%|▋         | 7/100 [00:37<08:35,  5.54s/it]Best trial: 3. Best value: 0.609342:   7%|▋         | 7/100 [00:43<08:35,  5.54s/it]Best trial: 3. Best value: 0.609342:   8%|▊         | 8/100 [00:43<08:33,  5.59s/it]Best trial: 3. Best value: 0.609342:   8%|▊         | 8/100 [00:46<08:33,  5.59s/it]Best trial: 3. Best value: 0.609342:   9%|▉         | 9/100 [00:46<07:24,  4.89s/it]Best trial: 3. Best value: 0.609342:   9%|▉         | 9/100 [00:48<07:24,  4.89s/it]Best trial: 3. Best value: 0.609342:  10%|█         | 10/100 [00:48<06:04,  4.05s/it]Best trial: 3. Best value: 0.609342:  10%|█         | 10/100 [01:02<06:04,  4.05s/it]Best trial: 3. Best value: 0.609342:  11%|█         | 11/100 [01:02<10:21,  6.99s/it]Best trial: 3. Best value: 0.609342:  11%|█         | 11/100 [01:08<10:21,  6.99s/it]Best trial: 3. Best value: 0.609342:  12%|█▏        | 12/100 [01:08<09:40,  6.60s/it]Best trial: 3. Best value: 0.609342:  12%|█▏        | 12/100 [01:11<09:40,  6.60s/it]Best trial: 3. Best value: 0.609342:  13%|█▎        | 13/100 [01:11<08:22,  5.77s/it]Best trial: 3. Best value: 0.609342:  13%|█▎        | 13/100 [01:23<08:22,  5.77s/it]Best trial: 3. Best value: 0.609342:  14%|█▍        | 14/100 [01:23<10:49,  7.55s/it]Best trial: 3. Best value: 0.609342:  14%|█▍        | 14/100 [01:26<10:49,  7.55s/it]Best trial: 3. Best value: 0.609342:  15%|█▌        | 15/100 [01:26<08:37,  6.09s/it]Best trial: 3. Best value: 0.609342:  15%|█▌        | 15/100 [01:36<08:37,  6.09s/it]Best trial: 3. Best value: 0.609342:  16%|█▌        | 16/100 [01:36<10:07,  7.23s/it]Best trial: 3. Best value: 0.609342:  16%|█▌        | 16/100 [01:40<10:07,  7.23s/it]Best trial: 3. Best value: 0.609342:  17%|█▋        | 17/100 [01:40<08:44,  6.32s/it]Best trial: 3. Best value: 0.609342:  17%|█▋        | 17/100 [01:42<08:44,  6.32s/it]Best trial: 3. Best value: 0.609342:  18%|█▊        | 18/100 [01:42<07:02,  5.16s/it]Best trial: 3. Best value: 0.609342:  18%|█▊        | 18/100 [01:52<07:02,  5.16s/it]Best trial: 3. Best value: 0.609342:  19%|█▉        | 19/100 [01:52<08:54,  6.60s/it]Best trial: 3. Best value: 0.609342:  19%|█▉        | 19/100 [01:55<08:54,  6.60s/it]Best trial: 3. Best value: 0.609342:  20%|██        | 20/100 [01:55<07:10,  5.38s/it]Best trial: 3. Best value: 0.609342:  20%|██        | 20/100 [02:02<07:10,  5.38s/it]Best trial: 3. Best value: 0.609342:  21%|██        | 21/100 [02:02<07:35,  5.76s/it]Best trial: 3. Best value: 0.609342:  21%|██        | 21/100 [02:05<07:35,  5.76s/it]Best trial: 3. Best value: 0.609342:  22%|██▏       | 22/100 [02:05<06:38,  5.11s/it]Best trial: 3. Best value: 0.609342:  22%|██▏       | 22/100 [02:08<06:38,  5.11s/it]Best trial: 3. Best value: 0.609342:  23%|██▎       | 23/100 [02:08<05:46,  4.50s/it]Best trial: 3. Best value: 0.609342:  23%|██▎       | 23/100 [02:12<05:46,  4.50s/it]Best trial: 3. Best value: 0.609342:  24%|██▍       | 24/100 [02:12<05:28,  4.32s/it]Best trial: 3. Best value: 0.609342:  24%|██▍       | 24/100 [02:19<05:28,  4.32s/it]Best trial: 3. Best value: 0.609342:  25%|██▌       | 25/100 [02:19<06:18,  5.05s/it]Best trial: 3. Best value: 0.609342:  25%|██▌       | 25/100 [02:22<06:18,  5.05s/it]Best trial: 3. Best value: 0.609342:  26%|██▌       | 26/100 [02:22<05:21,  4.34s/it]Best trial: 3. Best value: 0.609342:  26%|██▌       | 26/100 [02:25<05:21,  4.34s/it]Best trial: 3. Best value: 0.609342:  27%|██▋       | 27/100 [02:25<04:47,  3.94s/it]Best trial: 3. Best value: 0.609342:  27%|██▋       | 27/100 [02:33<04:47,  3.94s/it]Best trial: 3. Best value: 0.609342:  28%|██▊       | 28/100 [02:33<06:15,  5.22s/it]Best trial: 3. Best value: 0.609342:  28%|██▊       | 28/100 [02:39<06:15,  5.22s/it]Best trial: 3. Best value: 0.609342:  29%|██▉       | 29/100 [02:39<06:43,  5.69s/it]Best trial: 3. Best value: 0.609342:  29%|██▉       | 29/100 [02:44<06:43,  5.69s/it]Best trial: 3. Best value: 0.609342:  30%|███       | 30/100 [02:44<06:05,  5.22s/it]Best trial: 3. Best value: 0.609342:  30%|███       | 30/100 [02:46<06:05,  5.22s/it]Best trial: 3. Best value: 0.609342:  31%|███       | 31/100 [02:46<05:02,  4.39s/it]Best trial: 3. Best value: 0.609342:  31%|███       | 31/100 [02:50<05:02,  4.39s/it]Best trial: 3. Best value: 0.609342:  32%|███▏      | 32/100 [02:50<04:57,  4.37s/it]Best trial: 3. Best value: 0.609342:  32%|███▏      | 32/100 [02:55<04:57,  4.37s/it]Best trial: 3. Best value: 0.609342:  33%|███▎      | 33/100 [02:55<05:00,  4.48s/it]Best trial: 3. Best value: 0.609342:  33%|███▎      | 33/100 [03:01<05:00,  4.48s/it]Best trial: 3. Best value: 0.609342:  34%|███▍      | 34/100 [03:01<05:25,  4.93s/it]Best trial: 3. Best value: 0.609342:  34%|███▍      | 34/100 [03:04<05:25,  4.93s/it]Best trial: 3. Best value: 0.609342:  35%|███▌      | 35/100 [03:04<04:46,  4.41s/it]Best trial: 3. Best value: 0.609342:  35%|███▌      | 35/100 [03:12<04:46,  4.41s/it]Best trial: 3. Best value: 0.609342:  36%|███▌      | 36/100 [03:12<05:51,  5.50s/it]Best trial: 3. Best value: 0.609342:  36%|███▌      | 36/100 [03:17<05:51,  5.50s/it]Best trial: 3. Best value: 0.609342:  37%|███▋      | 37/100 [03:17<05:26,  5.19s/it]Best trial: 3. Best value: 0.609342:  37%|███▋      | 37/100 [03:21<05:26,  5.19s/it]Best trial: 3. Best value: 0.609342:  38%|███▊      | 38/100 [03:21<05:03,  4.89s/it]Best trial: 3. Best value: 0.609342:  38%|███▊      | 38/100 [03:27<05:03,  4.89s/it]Best trial: 3. Best value: 0.609342:  39%|███▉      | 39/100 [03:27<05:09,  5.07s/it]Best trial: 3. Best value: 0.609342:  39%|███▉      | 39/100 [03:29<05:09,  5.07s/it]Best trial: 3. Best value: 0.609342:  40%|████      | 40/100 [03:29<04:20,  4.34s/it]Best trial: 3. Best value: 0.609342:  40%|████      | 40/100 [03:32<04:20,  4.34s/it]Best trial: 3. Best value: 0.609342:  41%|████      | 41/100 [03:32<03:41,  3.75s/it]Best trial: 3. Best value: 0.609342:  41%|████      | 41/100 [03:36<03:41,  3.75s/it]Best trial: 3. Best value: 0.609342:  42%|████▏     | 42/100 [03:36<03:51,  3.99s/it]Best trial: 3. Best value: 0.609342:  42%|████▏     | 42/100 [03:43<03:51,  3.99s/it]Best trial: 3. Best value: 0.609342:  43%|████▎     | 43/100 [03:43<04:45,  5.00s/it]Best trial: 3. Best value: 0.609342:  43%|████▎     | 43/100 [03:48<04:45,  5.00s/it]Best trial: 3. Best value: 0.609342:  44%|████▍     | 44/100 [03:48<04:25,  4.74s/it]Best trial: 3. Best value: 0.609342:  44%|████▍     | 44/100 [03:51<04:25,  4.74s/it]Best trial: 3. Best value: 0.609342:  45%|████▌     | 45/100 [03:51<03:53,  4.25s/it]Best trial: 3. Best value: 0.609342:  45%|████▌     | 45/100 [03:58<03:53,  4.25s/it]Best trial: 3. Best value: 0.609342:  46%|████▌     | 46/100 [03:58<04:32,  5.04s/it]Best trial: 3. Best value: 0.609342:  46%|████▌     | 46/100 [04:03<04:32,  5.04s/it]Best trial: 3. Best value: 0.609342:  47%|████▋     | 47/100 [04:03<04:28,  5.06s/it]Best trial: 3. Best value: 0.609342:  47%|████▋     | 47/100 [04:22<04:28,  5.06s/it]Best trial: 3. Best value: 0.609342:  48%|████▊     | 48/100 [04:22<08:01,  9.27s/it]Best trial: 3. Best value: 0.609342:  48%|████▊     | 48/100 [04:27<08:01,  9.27s/it]Best trial: 3. Best value: 0.609342:  49%|████▉     | 49/100 [04:27<06:47,  7.99s/it]Best trial: 3. Best value: 0.609342:  49%|████▉     | 49/100 [04:29<06:47,  7.99s/it]Best trial: 3. Best value: 0.609342:  50%|█████     | 50/100 [04:29<05:19,  6.38s/it]Best trial: 3. Best value: 0.609342:  50%|█████     | 50/100 [04:33<05:19,  6.38s/it]Best trial: 3. Best value: 0.609342:  51%|█████     | 51/100 [04:33<04:35,  5.63s/it]Best trial: 3. Best value: 0.609342:  51%|█████     | 51/100 [04:40<04:35,  5.63s/it]Best trial: 3. Best value: 0.609342:  52%|█████▏    | 52/100 [04:40<04:51,  6.08s/it]Best trial: 52. Best value: 0.611382:  52%|█████▏    | 52/100 [04:47<04:51,  6.08s/it]Best trial: 52. Best value: 0.611382:  53%|█████▎    | 53/100 [04:47<04:58,  6.34s/it]Best trial: 52. Best value: 0.611382:  53%|█████▎    | 53/100 [04:52<04:58,  6.34s/it]Best trial: 52. Best value: 0.611382:  54%|█████▍    | 54/100 [04:52<04:31,  5.90s/it]Best trial: 52. Best value: 0.611382:  54%|█████▍    | 54/100 [04:57<04:31,  5.90s/it]Best trial: 52. Best value: 0.611382:  55%|█████▌    | 55/100 [04:57<04:10,  5.58s/it]Best trial: 52. Best value: 0.611382:  55%|█████▌    | 55/100 [05:02<04:10,  5.58s/it]Best trial: 52. Best value: 0.611382:  56%|█████▌    | 56/100 [05:02<03:53,  5.30s/it]Best trial: 52. Best value: 0.611382:  56%|█████▌    | 56/100 [05:06<03:53,  5.30s/it]Best trial: 52. Best value: 0.611382:  57%|█████▋    | 57/100 [05:06<03:30,  4.90s/it]Best trial: 52. Best value: 0.611382:  57%|█████▋    | 57/100 [05:12<03:30,  4.90s/it]Best trial: 52. Best value: 0.611382:  58%|█████▊    | 58/100 [05:12<03:48,  5.43s/it]Best trial: 52. Best value: 0.611382:  58%|█████▊    | 58/100 [05:16<03:48,  5.43s/it]Best trial: 52. Best value: 0.611382:  59%|█████▉    | 59/100 [05:16<03:21,  4.91s/it]Best trial: 52. Best value: 0.611382:  59%|█████▉    | 59/100 [05:21<03:21,  4.91s/it]Best trial: 52. Best value: 0.611382:  60%|██████    | 60/100 [05:21<03:15,  4.90s/it]Best trial: 52. Best value: 0.611382:  60%|██████    | 60/100 [05:29<03:15,  4.90s/it]Best trial: 52. Best value: 0.611382:  61%|██████    | 61/100 [05:29<03:47,  5.82s/it]Best trial: 52. Best value: 0.611382:  61%|██████    | 61/100 [05:34<03:47,  5.82s/it]Best trial: 52. Best value: 0.611382:  62%|██████▏   | 62/100 [05:34<03:33,  5.62s/it]Best trial: 52. Best value: 0.611382:  62%|██████▏   | 62/100 [05:38<03:33,  5.62s/it]Best trial: 52. Best value: 0.611382:  63%|██████▎   | 63/100 [05:38<03:14,  5.26s/it]Best trial: 52. Best value: 0.611382:  63%|██████▎   | 63/100 [05:42<03:14,  5.26s/it]Best trial: 52. Best value: 0.611382:  64%|██████▍   | 64/100 [05:42<02:48,  4.68s/it]Best trial: 52. Best value: 0.611382:  64%|██████▍   | 64/100 [05:46<02:48,  4.68s/it]Best trial: 52. Best value: 0.611382:  65%|██████▌   | 65/100 [05:46<02:43,  4.66s/it]Best trial: 52. Best value: 0.611382:  65%|██████▌   | 65/100 [05:54<02:43,  4.66s/it]Best trial: 52. Best value: 0.611382:  66%|██████▌   | 66/100 [05:54<03:13,  5.70s/it]Best trial: 52. Best value: 0.611382:  66%|██████▌   | 66/100 [06:01<03:13,  5.70s/it]Best trial: 52. Best value: 0.611382:  67%|██████▋   | 67/100 [06:01<03:15,  5.91s/it]Best trial: 52. Best value: 0.611382:  67%|██████▋   | 67/100 [06:07<03:15,  5.91s/it]Best trial: 52. Best value: 0.611382:  68%|██████▊   | 68/100 [06:07<03:14,  6.06s/it]Best trial: 52. Best value: 0.611382:  68%|██████▊   | 68/100 [06:12<03:14,  6.06s/it]Best trial: 52. Best value: 0.611382:  69%|██████▉   | 69/100 [06:12<02:58,  5.75s/it]Best trial: 52. Best value: 0.611382:  69%|██████▉   | 69/100 [06:17<02:58,  5.75s/it]Best trial: 52. Best value: 0.611382:  70%|███████   | 70/100 [06:17<02:46,  5.54s/it]Best trial: 52. Best value: 0.611382:  70%|███████   | 70/100 [06:20<02:46,  5.54s/it]Best trial: 52. Best value: 0.611382:  71%|███████   | 71/100 [06:20<02:19,  4.79s/it]Best trial: 52. Best value: 0.611382:  71%|███████   | 71/100 [06:26<02:19,  4.79s/it]Best trial: 52. Best value: 0.611382:  72%|███████▏  | 72/100 [06:26<02:17,  4.91s/it]Best trial: 52. Best value: 0.611382:  72%|███████▏  | 72/100 [06:30<02:17,  4.91s/it]Best trial: 52. Best value: 0.611382:  73%|███████▎  | 73/100 [06:30<02:07,  4.71s/it]Best trial: 52. Best value: 0.611382:  73%|███████▎  | 73/100 [06:36<02:07,  4.71s/it]Best trial: 52. Best value: 0.611382:  74%|███████▍  | 74/100 [06:36<02:10,  5.03s/it]Best trial: 52. Best value: 0.611382:  74%|███████▍  | 74/100 [06:41<02:10,  5.03s/it]Best trial: 52. Best value: 0.611382:  75%|███████▌  | 75/100 [06:41<02:05,  5.02s/it]Best trial: 52. Best value: 0.611382:  75%|███████▌  | 75/100 [06:48<02:05,  5.02s/it]Best trial: 52. Best value: 0.611382:  76%|███████▌  | 76/100 [06:48<02:14,  5.58s/it]Best trial: 52. Best value: 0.611382:  76%|███████▌  | 76/100 [06:51<02:14,  5.58s/it]Best trial: 52. Best value: 0.611382:  77%|███████▋  | 77/100 [06:51<01:52,  4.91s/it]Best trial: 52. Best value: 0.611382:  77%|███████▋  | 77/100 [06:57<01:52,  4.91s/it]Best trial: 52. Best value: 0.611382:  78%|███████▊  | 78/100 [06:57<01:55,  5.26s/it]Best trial: 52. Best value: 0.611382:  78%|███████▊  | 78/100 [07:02<01:55,  5.26s/it]Best trial: 52. Best value: 0.611382:  79%|███████▉  | 79/100 [07:02<01:51,  5.31s/it]Best trial: 52. Best value: 0.611382:  79%|███████▉  | 79/100 [07:06<01:51,  5.31s/it]Best trial: 52. Best value: 0.611382:  80%|████████  | 80/100 [07:06<01:37,  4.87s/it]Best trial: 52. Best value: 0.611382:  80%|████████  | 80/100 [07:13<01:37,  4.87s/it]Best trial: 52. Best value: 0.611382:  81%|████████  | 81/100 [07:13<01:40,  5.30s/it]Best trial: 52. Best value: 0.611382:  81%|████████  | 81/100 [07:18<01:40,  5.30s/it]Best trial: 52. Best value: 0.611382:  82%|████████▏ | 82/100 [07:18<01:37,  5.44s/it]Best trial: 52. Best value: 0.611382:  82%|████████▏ | 82/100 [07:26<01:37,  5.44s/it]Best trial: 52. Best value: 0.611382:  83%|████████▎ | 83/100 [07:26<01:44,  6.17s/it]Best trial: 52. Best value: 0.611382:  83%|████████▎ | 83/100 [07:33<01:44,  6.17s/it]Best trial: 52. Best value: 0.611382:  84%|████████▍ | 84/100 [07:33<01:43,  6.45s/it]Best trial: 52. Best value: 0.611382:  84%|████████▍ | 84/100 [07:40<01:43,  6.45s/it]Best trial: 52. Best value: 0.611382:  85%|████████▌ | 85/100 [07:40<01:40,  6.68s/it]Best trial: 52. Best value: 0.611382:  85%|████████▌ | 85/100 [07:51<01:40,  6.68s/it]Best trial: 52. Best value: 0.611382:  86%|████████▌ | 86/100 [07:51<01:47,  7.70s/it]Best trial: 52. Best value: 0.611382:  86%|████████▌ | 86/100 [07:59<01:47,  7.70s/it]Best trial: 52. Best value: 0.611382:  87%|████████▋ | 87/100 [07:59<01:42,  7.92s/it]Best trial: 52. Best value: 0.611382:  87%|████████▋ | 87/100 [08:09<01:42,  7.92s/it]Best trial: 52. Best value: 0.611382:  88%|████████▊ | 88/100 [08:09<01:41,  8.49s/it]Best trial: 52. Best value: 0.611382:  88%|████████▊ | 88/100 [08:17<01:41,  8.49s/it]Best trial: 52. Best value: 0.611382:  89%|████████▉ | 89/100 [08:17<01:33,  8.52s/it]Best trial: 52. Best value: 0.611382:  89%|████████▉ | 89/100 [08:26<01:33,  8.52s/it]Best trial: 52. Best value: 0.611382:  90%|█████████ | 90/100 [08:26<01:25,  8.52s/it]Best trial: 52. Best value: 0.611382:  90%|█████████ | 90/100 [08:40<01:25,  8.52s/it]Best trial: 52. Best value: 0.611382:  91%|█████████ | 91/100 [08:40<01:30, 10.07s/it]Best trial: 52. Best value: 0.611382:  91%|█████████ | 91/100 [08:51<01:30, 10.07s/it]Best trial: 52. Best value: 0.611382:  92%|█████████▏| 92/100 [08:51<01:22, 10.33s/it]Best trial: 52. Best value: 0.611382:  92%|█████████▏| 92/100 [08:59<01:22, 10.33s/it]Best trial: 52. Best value: 0.611382:  93%|█████████▎| 93/100 [08:59<01:07,  9.69s/it]Best trial: 52. Best value: 0.611382:  93%|█████████▎| 93/100 [09:08<01:07,  9.69s/it]Best trial: 52. Best value: 0.611382:  94%|█████████▍| 94/100 [09:08<00:57,  9.58s/it]Best trial: 52. Best value: 0.611382:  94%|█████████▍| 94/100 [09:16<00:57,  9.58s/it]Best trial: 52. Best value: 0.611382:  95%|█████████▌| 95/100 [09:16<00:45,  9.14s/it]Best trial: 52. Best value: 0.611382:  95%|█████████▌| 95/100 [09:27<00:45,  9.14s/it]Best trial: 52. Best value: 0.611382:  96%|█████████▌| 96/100 [09:27<00:38,  9.70s/it]Best trial: 96. Best value: 0.611661:  96%|█████████▌| 96/100 [09:36<00:38,  9.70s/it]Best trial: 96. Best value: 0.611661:  97%|█████████▋| 97/100 [09:36<00:27,  9.33s/it]Best trial: 97. Best value: 0.617623:  97%|█████████▋| 97/100 [09:45<00:27,  9.33s/it]Best trial: 97. Best value: 0.617623:  98%|█████████▊| 98/100 [09:45<00:18,  9.21s/it]Best trial: 97. Best value: 0.617623:  98%|█████████▊| 98/100 [09:52<00:18,  9.21s/it]Best trial: 97. Best value: 0.617623:  99%|█████████▉| 99/100 [09:52<00:08,  8.65s/it]Best trial: 97. Best value: 0.617623:  99%|█████████▉| 99/100 [10:06<00:08,  8.65s/it]Best trial: 97. Best value: 0.617623: 100%|██████████| 100/100 [10:06<00:00, 10.40s/it]Best trial: 97. Best value: 0.617623: 100%|██████████| 100/100 [10:06<00:00,  6.07s/it]
2025-11-30 18:56:12,458 - INFO - HPO Complete. Best AUPRC: 0.6176
2025-11-30 18:56:12,458 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.0190317687409508, 'max_depth': 10, 'subsample': 0.6804648548396779, 'colsample_bytree': 0.6265154417776174, 'gamma': 4.438656449385332, 'reg_lambda': 1.9585323417830057e-08, 'reg_alpha': 0.9883076841650598}
2025-11-30 18:56:12,459 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/non_windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:56:14,338 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-11-30 18:56:14,339 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-11-30 18:56:14,429 - INFO - Data loaded. Shape: (3453, 195)
2025-11-30 18:56:14,462 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:56:14,471 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-11-30 18:56:14,471 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:56:14,472 - INFO - Training model...
2025-11-30 18:56:17,414 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:56:22,892 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:56:22,892 - INFO - AUROC: 0.8174 (0.7824 - 0.8382)
2025-11-30 18:56:22,892 - INFO - AUPRC: 0.5429 (0.4670 - 0.6343)
2025-11-30 18:56:22,892 - INFO - Brier Score: 0.1444 (0.1346 - 0.1566)
2025-11-30 18:56:22,892 - INFO - Accuracy: 0.7457 (0.7043 - 0.8081)
2025-11-30 18:56:22,892 - INFO - Precision: 0.4643 (0.4213 - 0.5651)
2025-11-30 18:56:22,892 - INFO - Sensitivity (Recall): 0.7405 (0.5880 - 0.8590)
2025-11-30 18:56:22,892 - INFO - F1-Score: 0.5707 (0.5361 - 0.6133)
2025-11-30 18:56:22,892 - INFO - Best Threshold: 0.3300 (0.2660 - 0.4740)
2025-11-30 18:56:22,892 - INFO - Specificity: 0.7472 (0.6726 - 0.8650)
2025-11-30 18:56:22,915 - INFO - Calculating SHAP values...
2025-11-30 18:56:24,180 - INFO - SHAP plots saved.
2025-11-30 18:56:24,181 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/non_windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:56:25,416 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_only
2025-11-30 18:56:25,416 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 18:56:25,622 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 18:56:25,644 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:56:25,651 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 18:56:25,651 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.521134:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.521134:   1%|          | 1/100 [00:03<05:10,  3.14s/it]Best trial: 1. Best value: 0.54195:   1%|          | 1/100 [00:05<05:10,  3.14s/it] Best trial: 1. Best value: 0.54195:   2%|▏         | 2/100 [00:05<04:22,  2.68s/it]Best trial: 2. Best value: 0.561047:   2%|▏         | 2/100 [00:07<04:22,  2.68s/it]Best trial: 2. Best value: 0.561047:   3%|▎         | 3/100 [00:07<03:34,  2.21s/it]Best trial: 2. Best value: 0.561047:   3%|▎         | 3/100 [00:11<03:34,  2.21s/it]Best trial: 2. Best value: 0.561047:   4%|▍         | 4/100 [00:11<04:37,  2.89s/it]Best trial: 2. Best value: 0.561047:   4%|▍         | 4/100 [00:13<04:37,  2.89s/it]Best trial: 2. Best value: 0.561047:   5%|▌         | 5/100 [00:13<04:07,  2.60s/it]Best trial: 2. Best value: 0.561047:   5%|▌         | 5/100 [00:16<04:07,  2.60s/it]Best trial: 2. Best value: 0.561047:   6%|▌         | 6/100 [00:16<04:34,  2.92s/it]Best trial: 2. Best value: 0.561047:   6%|▌         | 6/100 [00:19<04:34,  2.92s/it]Best trial: 2. Best value: 0.561047:   7%|▋         | 7/100 [00:19<04:13,  2.72s/it]Best trial: 2. Best value: 0.561047:   7%|▋         | 7/100 [00:21<04:13,  2.72s/it]Best trial: 2. Best value: 0.561047:   8%|▊         | 8/100 [00:21<04:12,  2.74s/it]Best trial: 2. Best value: 0.561047:   8%|▊         | 8/100 [00:24<04:12,  2.74s/it]Best trial: 2. Best value: 0.561047:   9%|▉         | 9/100 [00:24<04:06,  2.71s/it]Best trial: 2. Best value: 0.561047:   9%|▉         | 9/100 [00:26<04:06,  2.71s/it]Best trial: 2. Best value: 0.561047:  10%|█         | 10/100 [00:26<03:45,  2.50s/it]Best trial: 10. Best value: 0.561352:  10%|█         | 10/100 [00:27<03:45,  2.50s/it]Best trial: 10. Best value: 0.561352:  11%|█         | 11/100 [00:27<03:07,  2.10s/it]Best trial: 10. Best value: 0.561352:  11%|█         | 11/100 [00:28<03:07,  2.10s/it]Best trial: 10. Best value: 0.561352:  12%|█▏        | 12/100 [00:28<02:40,  1.82s/it]Best trial: 10. Best value: 0.561352:  12%|█▏        | 12/100 [00:30<02:40,  1.82s/it]Best trial: 10. Best value: 0.561352:  13%|█▎        | 13/100 [00:30<02:23,  1.65s/it]Best trial: 13. Best value: 0.56866:  13%|█▎        | 13/100 [00:31<02:23,  1.65s/it] Best trial: 13. Best value: 0.56866:  14%|█▍        | 14/100 [00:31<02:24,  1.68s/it]Best trial: 13. Best value: 0.56866:  14%|█▍        | 14/100 [00:33<02:24,  1.68s/it]Best trial: 13. Best value: 0.56866:  15%|█▌        | 15/100 [00:33<02:31,  1.78s/it]Best trial: 13. Best value: 0.56866:  15%|█▌        | 15/100 [00:35<02:31,  1.78s/it]Best trial: 13. Best value: 0.56866:  16%|█▌        | 16/100 [00:35<02:31,  1.80s/it]Best trial: 13. Best value: 0.56866:  16%|█▌        | 16/100 [00:37<02:31,  1.80s/it]Best trial: 13. Best value: 0.56866:  17%|█▋        | 17/100 [00:37<02:17,  1.66s/it]Best trial: 13. Best value: 0.56866:  17%|█▋        | 17/100 [00:39<02:17,  1.66s/it]Best trial: 13. Best value: 0.56866:  18%|█▊        | 18/100 [00:39<02:40,  1.96s/it]Best trial: 13. Best value: 0.56866:  18%|█▊        | 18/100 [00:41<02:40,  1.96s/it]Best trial: 13. Best value: 0.56866:  19%|█▉        | 19/100 [00:41<02:24,  1.78s/it]Best trial: 13. Best value: 0.56866:  19%|█▉        | 19/100 [00:42<02:24,  1.78s/it]Best trial: 13. Best value: 0.56866:  20%|██        | 20/100 [00:42<02:17,  1.72s/it]Best trial: 13. Best value: 0.56866:  20%|██        | 20/100 [00:44<02:17,  1.72s/it]Best trial: 13. Best value: 0.56866:  21%|██        | 21/100 [00:44<02:27,  1.87s/it]Best trial: 13. Best value: 0.56866:  21%|██        | 21/100 [00:46<02:27,  1.87s/it]Best trial: 13. Best value: 0.56866:  22%|██▏       | 22/100 [00:46<02:21,  1.81s/it]Best trial: 13. Best value: 0.56866:  22%|██▏       | 22/100 [00:48<02:21,  1.81s/it]Best trial: 13. Best value: 0.56866:  23%|██▎       | 23/100 [00:48<02:23,  1.86s/it]Best trial: 13. Best value: 0.56866:  23%|██▎       | 23/100 [00:50<02:23,  1.86s/it]Best trial: 13. Best value: 0.56866:  24%|██▍       | 24/100 [00:50<02:33,  2.02s/it]Best trial: 13. Best value: 0.56866:  24%|██▍       | 24/100 [00:52<02:33,  2.02s/it]Best trial: 13. Best value: 0.56866:  25%|██▌       | 25/100 [00:52<02:25,  1.93s/it]Best trial: 13. Best value: 0.56866:  25%|██▌       | 25/100 [00:54<02:25,  1.93s/it]Best trial: 13. Best value: 0.56866:  26%|██▌       | 26/100 [00:54<02:24,  1.95s/it]Best trial: 13. Best value: 0.56866:  26%|██▌       | 26/100 [00:57<02:24,  1.95s/it]Best trial: 13. Best value: 0.56866:  27%|██▋       | 27/100 [00:57<02:42,  2.23s/it]Best trial: 13. Best value: 0.56866:  27%|██▋       | 27/100 [00:59<02:42,  2.23s/it]Best trial: 13. Best value: 0.56866:  28%|██▊       | 28/100 [00:59<02:37,  2.19s/it]Best trial: 13. Best value: 0.56866:  28%|██▊       | 28/100 [01:01<02:37,  2.19s/it]Best trial: 13. Best value: 0.56866:  29%|██▉       | 29/100 [01:01<02:25,  2.05s/it]Best trial: 13. Best value: 0.56866:  29%|██▉       | 29/100 [01:05<02:25,  2.05s/it]Best trial: 13. Best value: 0.56866:  30%|███       | 30/100 [01:05<02:57,  2.53s/it]Best trial: 13. Best value: 0.56866:  30%|███       | 30/100 [01:06<02:57,  2.53s/it]Best trial: 13. Best value: 0.56866:  31%|███       | 31/100 [01:06<02:37,  2.29s/it]Best trial: 13. Best value: 0.56866:  31%|███       | 31/100 [01:08<02:37,  2.29s/it]Best trial: 13. Best value: 0.56866:  32%|███▏      | 32/100 [01:08<02:28,  2.18s/it]Best trial: 13. Best value: 0.56866:  32%|███▏      | 32/100 [01:10<02:28,  2.18s/it]Best trial: 13. Best value: 0.56866:  33%|███▎      | 33/100 [01:10<02:18,  2.07s/it]Best trial: 13. Best value: 0.56866:  33%|███▎      | 33/100 [01:12<02:18,  2.07s/it]Best trial: 13. Best value: 0.56866:  34%|███▍      | 34/100 [01:12<02:09,  1.96s/it]Best trial: 13. Best value: 0.56866:  34%|███▍      | 34/100 [01:13<02:09,  1.96s/it]Best trial: 13. Best value: 0.56866:  35%|███▌      | 35/100 [01:13<01:59,  1.84s/it]Best trial: 13. Best value: 0.56866:  35%|███▌      | 35/100 [01:15<01:59,  1.84s/it]Best trial: 13. Best value: 0.56866:  36%|███▌      | 36/100 [01:15<02:01,  1.90s/it]Best trial: 13. Best value: 0.56866:  36%|███▌      | 36/100 [01:17<02:01,  1.90s/it]Best trial: 13. Best value: 0.56866:  37%|███▋      | 37/100 [01:17<01:56,  1.85s/it]Best trial: 37. Best value: 0.570313:  37%|███▋      | 37/100 [01:19<01:56,  1.85s/it]Best trial: 37. Best value: 0.570313:  38%|███▊      | 38/100 [01:19<01:55,  1.86s/it]Best trial: 37. Best value: 0.570313:  38%|███▊      | 38/100 [01:21<01:55,  1.86s/it]Best trial: 37. Best value: 0.570313:  39%|███▉      | 39/100 [01:21<02:00,  1.98s/it]Best trial: 37. Best value: 0.570313:  39%|███▉      | 39/100 [01:23<02:00,  1.98s/it]Best trial: 37. Best value: 0.570313:  40%|████      | 40/100 [01:23<01:57,  1.96s/it]Best trial: 37. Best value: 0.570313:  40%|████      | 40/100 [01:25<01:57,  1.96s/it]Best trial: 37. Best value: 0.570313:  41%|████      | 41/100 [01:25<02:00,  2.03s/it]Best trial: 37. Best value: 0.570313:  41%|████      | 41/100 [01:27<02:00,  2.03s/it]Best trial: 37. Best value: 0.570313:  42%|████▏     | 42/100 [01:27<01:57,  2.03s/it]Best trial: 37. Best value: 0.570313:  42%|████▏     | 42/100 [01:29<01:57,  2.03s/it]Best trial: 37. Best value: 0.570313:  43%|████▎     | 43/100 [01:29<01:51,  1.95s/it]Best trial: 37. Best value: 0.570313:  43%|████▎     | 43/100 [01:31<01:51,  1.95s/it]Best trial: 37. Best value: 0.570313:  44%|████▍     | 44/100 [01:31<01:49,  1.96s/it]Best trial: 44. Best value: 0.572358:  44%|████▍     | 44/100 [01:33<01:49,  1.96s/it]Best trial: 44. Best value: 0.572358:  45%|████▌     | 45/100 [01:33<01:45,  1.93s/it]Best trial: 44. Best value: 0.572358:  45%|████▌     | 45/100 [01:35<01:45,  1.93s/it]Best trial: 44. Best value: 0.572358:  46%|████▌     | 46/100 [01:35<01:43,  1.91s/it]Best trial: 44. Best value: 0.572358:  46%|████▌     | 46/100 [01:37<01:43,  1.91s/it]Best trial: 44. Best value: 0.572358:  47%|████▋     | 47/100 [01:37<01:40,  1.89s/it]Best trial: 44. Best value: 0.572358:  47%|████▋     | 47/100 [01:38<01:40,  1.89s/it]Best trial: 44. Best value: 0.572358:  48%|████▊     | 48/100 [01:38<01:29,  1.72s/it]Best trial: 44. Best value: 0.572358:  48%|████▊     | 48/100 [01:39<01:29,  1.72s/it]Best trial: 44. Best value: 0.572358:  49%|████▉     | 49/100 [01:39<01:19,  1.55s/it]Best trial: 44. Best value: 0.572358:  49%|████▉     | 49/100 [01:41<01:19,  1.55s/it]Best trial: 44. Best value: 0.572358:  50%|█████     | 50/100 [01:41<01:25,  1.70s/it]Best trial: 44. Best value: 0.572358:  50%|█████     | 50/100 [01:42<01:25,  1.70s/it]Best trial: 44. Best value: 0.572358:  51%|█████     | 51/100 [01:42<01:15,  1.54s/it]Best trial: 44. Best value: 0.572358:  51%|█████     | 51/100 [01:44<01:15,  1.54s/it]Best trial: 44. Best value: 0.572358:  52%|█████▏    | 52/100 [01:44<01:20,  1.67s/it]Best trial: 44. Best value: 0.572358:  52%|█████▏    | 52/100 [01:46<01:20,  1.67s/it]Best trial: 44. Best value: 0.572358:  53%|█████▎    | 53/100 [01:46<01:15,  1.61s/it]Best trial: 44. Best value: 0.572358:  53%|█████▎    | 53/100 [01:47<01:15,  1.61s/it]Best trial: 44. Best value: 0.572358:  54%|█████▍    | 54/100 [01:47<01:09,  1.50s/it]Best trial: 44. Best value: 0.572358:  54%|█████▍    | 54/100 [01:48<01:09,  1.50s/it]Best trial: 44. Best value: 0.572358:  55%|█████▌    | 55/100 [01:48<01:02,  1.39s/it]Best trial: 44. Best value: 0.572358:  55%|█████▌    | 55/100 [01:49<01:02,  1.39s/it]Best trial: 44. Best value: 0.572358:  56%|█████▌    | 56/100 [01:49<00:58,  1.34s/it]Best trial: 44. Best value: 0.572358:  56%|█████▌    | 56/100 [01:51<00:58,  1.34s/it]Best trial: 44. Best value: 0.572358:  57%|█████▋    | 57/100 [01:51<01:04,  1.49s/it]Best trial: 44. Best value: 0.572358:  57%|█████▋    | 57/100 [01:54<01:04,  1.49s/it]Best trial: 44. Best value: 0.572358:  58%|█████▊    | 58/100 [01:54<01:16,  1.83s/it]Best trial: 44. Best value: 0.572358:  58%|█████▊    | 58/100 [01:55<01:16,  1.83s/it]Best trial: 44. Best value: 0.572358:  59%|█████▉    | 59/100 [01:55<01:13,  1.78s/it]Best trial: 44. Best value: 0.572358:  59%|█████▉    | 59/100 [01:57<01:13,  1.78s/it]Best trial: 44. Best value: 0.572358:  60%|██████    | 60/100 [01:57<01:10,  1.75s/it]Best trial: 44. Best value: 0.572358:  60%|██████    | 60/100 [02:01<01:10,  1.75s/it]Best trial: 44. Best value: 0.572358:  61%|██████    | 61/100 [02:01<01:34,  2.44s/it]Best trial: 61. Best value: 0.572427:  61%|██████    | 61/100 [02:03<01:34,  2.44s/it]Best trial: 61. Best value: 0.572427:  62%|██████▏   | 62/100 [02:03<01:24,  2.23s/it]Best trial: 61. Best value: 0.572427:  62%|██████▏   | 62/100 [02:04<01:24,  2.23s/it]Best trial: 61. Best value: 0.572427:  63%|██████▎   | 63/100 [02:04<01:09,  1.87s/it]Best trial: 61. Best value: 0.572427:  63%|██████▎   | 63/100 [02:05<01:09,  1.87s/it]Best trial: 61. Best value: 0.572427:  64%|██████▍   | 64/100 [02:05<01:02,  1.75s/it]Best trial: 61. Best value: 0.572427:  64%|██████▍   | 64/100 [02:07<01:02,  1.75s/it]Best trial: 61. Best value: 0.572427:  65%|██████▌   | 65/100 [02:07<00:59,  1.69s/it]Best trial: 61. Best value: 0.572427:  65%|██████▌   | 65/100 [02:09<00:59,  1.69s/it]Best trial: 61. Best value: 0.572427:  66%|██████▌   | 66/100 [02:09<00:56,  1.67s/it]Best trial: 61. Best value: 0.572427:  66%|██████▌   | 66/100 [02:10<00:56,  1.67s/it]Best trial: 61. Best value: 0.572427:  67%|██████▋   | 67/100 [02:10<00:50,  1.52s/it]Best trial: 61. Best value: 0.572427:  67%|██████▋   | 67/100 [02:12<00:50,  1.52s/it]Best trial: 61. Best value: 0.572427:  68%|██████▊   | 68/100 [02:12<00:51,  1.62s/it]Best trial: 61. Best value: 0.572427:  68%|██████▊   | 68/100 [02:13<00:51,  1.62s/it]Best trial: 61. Best value: 0.572427:  69%|██████▉   | 69/100 [02:13<00:49,  1.60s/it]Best trial: 61. Best value: 0.572427:  69%|██████▉   | 69/100 [02:15<00:49,  1.60s/it]Best trial: 61. Best value: 0.572427:  70%|███████   | 70/100 [02:15<00:46,  1.54s/it]Best trial: 61. Best value: 0.572427:  70%|███████   | 70/100 [02:16<00:46,  1.54s/it]Best trial: 61. Best value: 0.572427:  71%|███████   | 71/100 [02:16<00:42,  1.46s/it]Best trial: 61. Best value: 0.572427:  71%|███████   | 71/100 [02:17<00:42,  1.46s/it]Best trial: 61. Best value: 0.572427:  72%|███████▏  | 72/100 [02:17<00:42,  1.50s/it]Best trial: 61. Best value: 0.572427:  72%|███████▏  | 72/100 [02:19<00:42,  1.50s/it]Best trial: 61. Best value: 0.572427:  73%|███████▎  | 73/100 [02:19<00:41,  1.55s/it]Best trial: 61. Best value: 0.572427:  73%|███████▎  | 73/100 [02:21<00:41,  1.55s/it]Best trial: 61. Best value: 0.572427:  74%|███████▍  | 74/100 [02:21<00:44,  1.71s/it]Best trial: 61. Best value: 0.572427:  74%|███████▍  | 74/100 [02:23<00:44,  1.71s/it]Best trial: 61. Best value: 0.572427:  75%|███████▌  | 75/100 [02:23<00:44,  1.77s/it]Best trial: 61. Best value: 0.572427:  75%|███████▌  | 75/100 [02:24<00:44,  1.77s/it]Best trial: 61. Best value: 0.572427:  76%|███████▌  | 76/100 [02:24<00:39,  1.64s/it]Best trial: 61. Best value: 0.572427:  76%|███████▌  | 76/100 [02:27<00:39,  1.64s/it]Best trial: 61. Best value: 0.572427:  77%|███████▋  | 77/100 [02:27<00:43,  1.89s/it]Best trial: 77. Best value: 0.572961:  77%|███████▋  | 77/100 [02:28<00:43,  1.89s/it]Best trial: 77. Best value: 0.572961:  78%|███████▊  | 78/100 [02:28<00:39,  1.79s/it]Best trial: 77. Best value: 0.572961:  78%|███████▊  | 78/100 [02:30<00:39,  1.79s/it]Best trial: 77. Best value: 0.572961:  79%|███████▉  | 79/100 [02:30<00:36,  1.72s/it]Best trial: 77. Best value: 0.572961:  79%|███████▉  | 79/100 [02:32<00:36,  1.72s/it]Best trial: 77. Best value: 0.572961:  80%|████████  | 80/100 [02:32<00:34,  1.70s/it]Best trial: 80. Best value: 0.574698:  80%|████████  | 80/100 [02:33<00:34,  1.70s/it]Best trial: 80. Best value: 0.574698:  81%|████████  | 81/100 [02:33<00:31,  1.67s/it]Best trial: 80. Best value: 0.574698:  81%|████████  | 81/100 [02:35<00:31,  1.67s/it]Best trial: 80. Best value: 0.574698:  82%|████████▏ | 82/100 [02:35<00:29,  1.63s/it]Best trial: 80. Best value: 0.574698:  82%|████████▏ | 82/100 [02:37<00:29,  1.63s/it]Best trial: 80. Best value: 0.574698:  83%|████████▎ | 83/100 [02:37<00:28,  1.66s/it]Best trial: 80. Best value: 0.574698:  83%|████████▎ | 83/100 [02:38<00:28,  1.66s/it]Best trial: 80. Best value: 0.574698:  84%|████████▍ | 84/100 [02:38<00:25,  1.59s/it]Best trial: 80. Best value: 0.574698:  84%|████████▍ | 84/100 [02:40<00:25,  1.59s/it]Best trial: 80. Best value: 0.574698:  85%|████████▌ | 85/100 [02:40<00:25,  1.68s/it]Best trial: 80. Best value: 0.574698:  85%|████████▌ | 85/100 [02:42<00:25,  1.68s/it]Best trial: 80. Best value: 0.574698:  86%|████████▌ | 86/100 [02:42<00:24,  1.75s/it]Best trial: 80. Best value: 0.574698:  86%|████████▌ | 86/100 [02:44<00:24,  1.75s/it]Best trial: 80. Best value: 0.574698:  87%|████████▋ | 87/100 [02:44<00:25,  1.94s/it]Best trial: 80. Best value: 0.574698:  87%|████████▋ | 87/100 [02:46<00:25,  1.94s/it]Best trial: 80. Best value: 0.574698:  88%|████████▊ | 88/100 [02:46<00:22,  1.85s/it]Best trial: 80. Best value: 0.574698:  88%|████████▊ | 88/100 [02:47<00:22,  1.85s/it]Best trial: 80. Best value: 0.574698:  89%|████████▉ | 89/100 [02:47<00:17,  1.63s/it]Best trial: 80. Best value: 0.574698:  89%|████████▉ | 89/100 [02:49<00:17,  1.63s/it]Best trial: 80. Best value: 0.574698:  90%|█████████ | 90/100 [02:49<00:17,  1.73s/it]Best trial: 80. Best value: 0.574698:  90%|█████████ | 90/100 [02:51<00:17,  1.73s/it]Best trial: 80. Best value: 0.574698:  91%|█████████ | 91/100 [02:51<00:15,  1.76s/it]Best trial: 80. Best value: 0.574698:  91%|█████████ | 91/100 [02:52<00:15,  1.76s/it]Best trial: 80. Best value: 0.574698:  92%|█████████▏| 92/100 [02:52<00:13,  1.70s/it]Best trial: 92. Best value: 0.57594:  92%|█████████▏| 92/100 [02:54<00:13,  1.70s/it] Best trial: 92. Best value: 0.57594:  93%|█████████▎| 93/100 [02:54<00:11,  1.71s/it]Best trial: 93. Best value: 0.576889:  93%|█████████▎| 93/100 [02:56<00:11,  1.71s/it]Best trial: 93. Best value: 0.576889:  94%|█████████▍| 94/100 [02:56<00:10,  1.73s/it]Best trial: 93. Best value: 0.576889:  94%|█████████▍| 94/100 [02:58<00:10,  1.73s/it]Best trial: 93. Best value: 0.576889:  95%|█████████▌| 95/100 [02:58<00:08,  1.74s/it]Best trial: 93. Best value: 0.576889:  95%|█████████▌| 95/100 [03:00<00:08,  1.74s/it]Best trial: 93. Best value: 0.576889:  96%|█████████▌| 96/100 [03:00<00:07,  1.88s/it]Best trial: 93. Best value: 0.576889:  96%|█████████▌| 96/100 [03:02<00:07,  1.88s/it]Best trial: 93. Best value: 0.576889:  97%|█████████▋| 97/100 [03:02<00:05,  1.87s/it]Best trial: 93. Best value: 0.576889:  97%|█████████▋| 97/100 [03:03<00:05,  1.87s/it]Best trial: 93. Best value: 0.576889:  98%|█████████▊| 98/100 [03:03<00:03,  1.75s/it]Best trial: 93. Best value: 0.576889:  98%|█████████▊| 98/100 [03:08<00:03,  1.75s/it]Best trial: 93. Best value: 0.576889:  99%|█████████▉| 99/100 [03:08<00:02,  2.56s/it]Best trial: 93. Best value: 0.576889:  99%|█████████▉| 99/100 [03:10<00:02,  2.56s/it]Best trial: 93. Best value: 0.576889: 100%|██████████| 100/100 [03:10<00:00,  2.49s/it]Best trial: 93. Best value: 0.576889: 100%|██████████| 100/100 [03:10<00:00,  1.90s/it]
2025-11-30 18:59:36,032 - INFO - HPO Complete. Best AUPRC: 0.5769
2025-11-30 18:59:36,033 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.038105586255315106, 'max_depth': 4, 'subsample': 0.7156707558038147, 'colsample_bytree': 0.8062666587901886, 'gamma': 3.732743946876311, 'reg_lambda': 1.2331429079696859e-05, 'reg_alpha': 0.42759867370199656}
2025-11-30 18:59:36,033 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 18:59:37,923 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_only
2025-11-30 18:59:37,923 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 18:59:38,113 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 18:59:38,131 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:59:38,136 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-11-30 18:59:38,136 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 18:59:38,136 - INFO - Training model...
2025-11-30 18:59:38,962 - INFO - Evaluating model with bootstrapping...
2025-11-30 18:59:44,239 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 18:59:44,239 - INFO - AUROC: 0.7647 (0.7227 - 0.7962)
2025-11-30 18:59:44,239 - INFO - AUPRC: 0.5072 (0.4399 - 0.5788)
2025-11-30 18:59:44,239 - INFO - Brier Score: 0.1705 (0.1590 - 0.1850)
2025-11-30 18:59:44,239 - INFO - Accuracy: 0.7760 (0.6604 - 0.8098)
2025-11-30 18:59:44,239 - INFO - Precision: 0.5084 (0.3717 - 0.5781)
2025-11-30 18:59:44,239 - INFO - Sensitivity (Recall): 0.5759 (0.5271 - 0.7513)
2025-11-30 18:59:44,239 - INFO - F1-Score: 0.5401 (0.4871 - 0.5943)
2025-11-30 18:59:44,239 - INFO - Best Threshold: 0.5300 (0.3420 - 0.5900)
2025-11-30 18:59:44,240 - INFO - Specificity: 0.8352 (0.6457 - 0.8737)
2025-11-30 18:59:44,250 - INFO - Calculating SHAP values...
2025-11-30 18:59:45,200 - INFO - SHAP plots saved.
2025-11-30 18:59:45,202 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 18:59:46,423 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: pleth_only
2025-11-30 18:59:46,423 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 18:59:46,656 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 18:59:46,681 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 18:59:46,687 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 18:59:46,687 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.428572:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.428572:   1%|          | 1/100 [00:05<08:23,  5.09s/it]Best trial: 1. Best value: 0.434091:   1%|          | 1/100 [00:10<08:23,  5.09s/it]Best trial: 1. Best value: 0.434091:   2%|▏         | 2/100 [00:10<08:15,  5.05s/it]Best trial: 2. Best value: 0.438069:   2%|▏         | 2/100 [00:14<08:15,  5.05s/it]Best trial: 2. Best value: 0.438069:   3%|▎         | 3/100 [00:14<07:53,  4.89s/it]Best trial: 3. Best value: 0.442757:   3%|▎         | 3/100 [00:21<07:53,  4.89s/it]Best trial: 3. Best value: 0.442757:   4%|▍         | 4/100 [00:21<08:42,  5.45s/it]Best trial: 3. Best value: 0.442757:   4%|▍         | 4/100 [00:25<08:42,  5.45s/it]Best trial: 3. Best value: 0.442757:   5%|▌         | 5/100 [00:25<08:13,  5.19s/it]Best trial: 3. Best value: 0.442757:   5%|▌         | 5/100 [00:28<08:13,  5.19s/it]Best trial: 3. Best value: 0.442757:   6%|▌         | 6/100 [00:28<06:57,  4.44s/it]Best trial: 3. Best value: 0.442757:   6%|▌         | 6/100 [00:39<06:57,  4.44s/it]Best trial: 3. Best value: 0.442757:   7%|▋         | 7/100 [00:39<10:02,  6.48s/it]Best trial: 7. Best value: 0.450063:   7%|▋         | 7/100 [00:42<10:02,  6.48s/it]Best trial: 7. Best value: 0.450063:   8%|▊         | 8/100 [00:42<08:26,  5.51s/it]Best trial: 7. Best value: 0.450063:   8%|▊         | 8/100 [00:44<08:26,  5.51s/it]Best trial: 7. Best value: 0.450063:   9%|▉         | 9/100 [00:44<06:24,  4.23s/it]Best trial: 7. Best value: 0.450063:   9%|▉         | 9/100 [00:49<06:24,  4.23s/it]Best trial: 7. Best value: 0.450063:  10%|█         | 10/100 [00:49<06:57,  4.64s/it]Best trial: 7. Best value: 0.450063:  10%|█         | 10/100 [00:52<06:57,  4.64s/it]Best trial: 7. Best value: 0.450063:  11%|█         | 11/100 [00:52<05:52,  3.96s/it]Best trial: 7. Best value: 0.450063:  11%|█         | 11/100 [00:56<05:52,  3.96s/it]Best trial: 7. Best value: 0.450063:  12%|█▏        | 12/100 [00:56<05:46,  3.94s/it]Best trial: 12. Best value: 0.456662:  12%|█▏        | 12/100 [00:59<05:46,  3.94s/it]Best trial: 12. Best value: 0.456662:  13%|█▎        | 13/100 [00:59<05:29,  3.79s/it]Best trial: 12. Best value: 0.456662:  13%|█▎        | 13/100 [01:02<05:29,  3.79s/it]Best trial: 12. Best value: 0.456662:  14%|█▍        | 14/100 [01:02<05:00,  3.49s/it]Best trial: 12. Best value: 0.456662:  14%|█▍        | 14/100 [01:06<05:00,  3.49s/it]Best trial: 12. Best value: 0.456662:  15%|█▌        | 15/100 [01:06<05:01,  3.55s/it]Best trial: 12. Best value: 0.456662:  15%|█▌        | 15/100 [01:09<05:01,  3.55s/it]Best trial: 12. Best value: 0.456662:  16%|█▌        | 16/100 [01:09<04:44,  3.39s/it]Best trial: 12. Best value: 0.456662:  16%|█▌        | 16/100 [01:11<04:44,  3.39s/it]Best trial: 12. Best value: 0.456662:  17%|█▋        | 17/100 [01:11<04:20,  3.14s/it]Best trial: 12. Best value: 0.456662:  17%|█▋        | 17/100 [01:21<04:20,  3.14s/it]Best trial: 12. Best value: 0.456662:  18%|█▊        | 18/100 [01:21<07:12,  5.28s/it]Best trial: 12. Best value: 0.456662:  18%|█▊        | 18/100 [01:25<07:12,  5.28s/it]Best trial: 12. Best value: 0.456662:  19%|█▉        | 19/100 [01:25<06:28,  4.80s/it]Best trial: 12. Best value: 0.456662:  19%|█▉        | 19/100 [01:29<06:28,  4.80s/it]Best trial: 12. Best value: 0.456662:  20%|██        | 20/100 [01:29<06:00,  4.50s/it]Best trial: 12. Best value: 0.456662:  20%|██        | 20/100 [01:31<06:00,  4.50s/it]Best trial: 12. Best value: 0.456662:  21%|██        | 21/100 [01:31<04:59,  3.79s/it]Best trial: 12. Best value: 0.456662:  21%|██        | 21/100 [01:34<04:59,  3.79s/it]Best trial: 12. Best value: 0.456662:  22%|██▏       | 22/100 [01:34<04:29,  3.46s/it]Best trial: 12. Best value: 0.456662:  22%|██▏       | 22/100 [01:37<04:29,  3.46s/it]Best trial: 12. Best value: 0.456662:  23%|██▎       | 23/100 [01:37<04:23,  3.42s/it]Best trial: 12. Best value: 0.456662:  23%|██▎       | 23/100 [01:40<04:23,  3.42s/it]Best trial: 12. Best value: 0.456662:  24%|██▍       | 24/100 [01:40<04:05,  3.23s/it]Best trial: 12. Best value: 0.456662:  24%|██▍       | 24/100 [01:43<04:05,  3.23s/it]Best trial: 12. Best value: 0.456662:  25%|██▌       | 25/100 [01:43<03:55,  3.15s/it]Best trial: 12. Best value: 0.456662:  25%|██▌       | 25/100 [01:47<03:55,  3.15s/it]Best trial: 12. Best value: 0.456662:  26%|██▌       | 26/100 [01:47<04:06,  3.33s/it]Best trial: 12. Best value: 0.456662:  26%|██▌       | 26/100 [01:49<04:06,  3.33s/it]Best trial: 12. Best value: 0.456662:  27%|██▋       | 27/100 [01:49<03:44,  3.07s/it]Best trial: 12. Best value: 0.456662:  27%|██▋       | 27/100 [01:57<03:44,  3.07s/it]Best trial: 12. Best value: 0.456662:  28%|██▊       | 28/100 [01:57<05:18,  4.42s/it]Best trial: 12. Best value: 0.456662:  28%|██▊       | 28/100 [01:59<05:18,  4.42s/it]Best trial: 12. Best value: 0.456662:  29%|██▉       | 29/100 [01:59<04:39,  3.93s/it]Best trial: 12. Best value: 0.456662:  29%|██▉       | 29/100 [02:04<04:39,  3.93s/it]Best trial: 12. Best value: 0.456662:  30%|███       | 30/100 [02:04<04:42,  4.04s/it]Best trial: 12. Best value: 0.456662:  30%|███       | 30/100 [02:06<04:42,  4.04s/it]Best trial: 12. Best value: 0.456662:  31%|███       | 31/100 [02:06<04:08,  3.60s/it]Best trial: 31. Best value: 0.458278:  31%|███       | 31/100 [02:09<04:08,  3.60s/it]Best trial: 31. Best value: 0.458278:  32%|███▏      | 32/100 [02:09<03:52,  3.41s/it]Best trial: 31. Best value: 0.458278:  32%|███▏      | 32/100 [02:14<03:52,  3.41s/it]Best trial: 31. Best value: 0.458278:  33%|███▎      | 33/100 [02:14<04:08,  3.71s/it]Best trial: 33. Best value: 0.458482:  33%|███▎      | 33/100 [02:16<04:08,  3.71s/it]Best trial: 33. Best value: 0.458482:  34%|███▍      | 34/100 [02:16<03:32,  3.22s/it]Best trial: 34. Best value: 0.458668:  34%|███▍      | 34/100 [02:18<03:32,  3.22s/it]Best trial: 34. Best value: 0.458668:  35%|███▌      | 35/100 [02:18<03:12,  2.96s/it]Best trial: 34. Best value: 0.458668:  35%|███▌      | 35/100 [02:20<03:12,  2.96s/it]Best trial: 34. Best value: 0.458668:  36%|███▌      | 36/100 [02:20<02:53,  2.70s/it]Best trial: 34. Best value: 0.458668:  36%|███▌      | 36/100 [02:22<02:53,  2.70s/it]Best trial: 34. Best value: 0.458668:  37%|███▋      | 37/100 [02:22<02:39,  2.54s/it]Best trial: 34. Best value: 0.458668:  37%|███▋      | 37/100 [02:24<02:39,  2.54s/it]Best trial: 34. Best value: 0.458668:  38%|███▊      | 38/100 [02:24<02:22,  2.29s/it]Best trial: 34. Best value: 0.458668:  38%|███▊      | 38/100 [02:29<02:22,  2.29s/it]Best trial: 34. Best value: 0.458668:  39%|███▉      | 39/100 [02:29<03:05,  3.04s/it]Best trial: 34. Best value: 0.458668:  39%|███▉      | 39/100 [02:31<03:05,  3.04s/it]Best trial: 34. Best value: 0.458668:  40%|████      | 40/100 [02:31<02:52,  2.87s/it]Best trial: 34. Best value: 0.458668:  40%|████      | 40/100 [02:34<02:52,  2.87s/it]Best trial: 34. Best value: 0.458668:  41%|████      | 41/100 [02:34<02:38,  2.68s/it]Best trial: 34. Best value: 0.458668:  41%|████      | 41/100 [02:36<02:38,  2.68s/it]Best trial: 34. Best value: 0.458668:  42%|████▏     | 42/100 [02:36<02:30,  2.59s/it]Best trial: 34. Best value: 0.458668:  42%|████▏     | 42/100 [02:38<02:30,  2.59s/it]Best trial: 34. Best value: 0.458668:  43%|████▎     | 43/100 [02:38<02:21,  2.49s/it]Best trial: 34. Best value: 0.458668:  43%|████▎     | 43/100 [02:40<02:21,  2.49s/it]Best trial: 34. Best value: 0.458668:  44%|████▍     | 44/100 [02:40<02:04,  2.22s/it]Best trial: 34. Best value: 0.458668:  44%|████▍     | 44/100 [02:42<02:04,  2.22s/it]Best trial: 34. Best value: 0.458668:  45%|████▌     | 45/100 [02:42<01:55,  2.10s/it]Best trial: 34. Best value: 0.458668:  45%|████▌     | 45/100 [02:45<01:55,  2.10s/it]Best trial: 34. Best value: 0.458668:  46%|████▌     | 46/100 [02:45<02:06,  2.34s/it]Best trial: 34. Best value: 0.458668:  46%|████▌     | 46/100 [02:49<02:06,  2.34s/it]Best trial: 34. Best value: 0.458668:  47%|████▋     | 47/100 [02:49<02:39,  3.01s/it]Best trial: 34. Best value: 0.458668:  47%|████▋     | 47/100 [02:51<02:39,  3.01s/it]Best trial: 34. Best value: 0.458668:  48%|████▊     | 48/100 [02:51<02:26,  2.82s/it]Best trial: 34. Best value: 0.458668:  48%|████▊     | 48/100 [02:56<02:26,  2.82s/it]Best trial: 34. Best value: 0.458668:  49%|████▉     | 49/100 [02:56<02:56,  3.46s/it]Best trial: 34. Best value: 0.458668:  49%|████▉     | 49/100 [03:00<02:56,  3.46s/it]Best trial: 34. Best value: 0.458668:  50%|█████     | 50/100 [03:00<02:56,  3.53s/it]Best trial: 34. Best value: 0.458668:  50%|█████     | 50/100 [03:03<02:56,  3.53s/it]Best trial: 34. Best value: 0.458668:  51%|█████     | 51/100 [03:03<02:44,  3.36s/it]Best trial: 51. Best value: 0.459535:  51%|█████     | 51/100 [03:09<02:44,  3.36s/it]Best trial: 51. Best value: 0.459535:  52%|█████▏    | 52/100 [03:09<03:17,  4.11s/it]Best trial: 51. Best value: 0.459535:  52%|█████▏    | 52/100 [03:12<03:17,  4.11s/it]Best trial: 51. Best value: 0.459535:  53%|█████▎    | 53/100 [03:12<02:54,  3.72s/it]Best trial: 51. Best value: 0.459535:  53%|█████▎    | 53/100 [03:16<02:54,  3.72s/it]Best trial: 51. Best value: 0.459535:  54%|█████▍    | 54/100 [03:16<03:01,  3.94s/it]Best trial: 51. Best value: 0.459535:  54%|█████▍    | 54/100 [03:21<03:01,  3.94s/it]Best trial: 51. Best value: 0.459535:  55%|█████▌    | 55/100 [03:21<03:10,  4.22s/it]Best trial: 51. Best value: 0.459535:  55%|█████▌    | 55/100 [03:25<03:10,  4.22s/it]Best trial: 51. Best value: 0.459535:  56%|█████▌    | 56/100 [03:25<02:55,  4.00s/it]Best trial: 56. Best value: 0.463182:  56%|█████▌    | 56/100 [03:29<02:55,  4.00s/it]Best trial: 56. Best value: 0.463182:  57%|█████▋    | 57/100 [03:29<03:01,  4.22s/it]Best trial: 56. Best value: 0.463182:  57%|█████▋    | 57/100 [03:32<03:01,  4.22s/it]Best trial: 56. Best value: 0.463182:  58%|█████▊    | 58/100 [03:32<02:38,  3.77s/it]Best trial: 56. Best value: 0.463182:  58%|█████▊    | 58/100 [03:39<02:38,  3.77s/it]Best trial: 56. Best value: 0.463182:  59%|█████▉    | 59/100 [03:39<03:13,  4.73s/it]Best trial: 56. Best value: 0.463182:  59%|█████▉    | 59/100 [03:45<03:13,  4.73s/it]Best trial: 56. Best value: 0.463182:  60%|██████    | 60/100 [03:45<03:20,  5.01s/it]Best trial: 56. Best value: 0.463182:  60%|██████    | 60/100 [03:49<03:20,  5.01s/it]Best trial: 56. Best value: 0.463182:  61%|██████    | 61/100 [03:49<03:03,  4.70s/it]Best trial: 56. Best value: 0.463182:  61%|██████    | 61/100 [03:53<03:03,  4.70s/it]Best trial: 56. Best value: 0.463182:  62%|██████▏   | 62/100 [03:53<02:58,  4.70s/it]Best trial: 56. Best value: 0.463182:  62%|██████▏   | 62/100 [03:57<02:58,  4.70s/it]Best trial: 56. Best value: 0.463182:  63%|██████▎   | 63/100 [03:57<02:40,  4.33s/it]Best trial: 56. Best value: 0.463182:  63%|██████▎   | 63/100 [04:03<02:40,  4.33s/it]Best trial: 56. Best value: 0.463182:  64%|██████▍   | 64/100 [04:03<02:50,  4.75s/it]Best trial: 56. Best value: 0.463182:  64%|██████▍   | 64/100 [04:06<02:50,  4.75s/it]Best trial: 56. Best value: 0.463182:  65%|██████▌   | 65/100 [04:06<02:31,  4.32s/it]Best trial: 56. Best value: 0.463182:  65%|██████▌   | 65/100 [04:10<02:31,  4.32s/it]Best trial: 56. Best value: 0.463182:  66%|██████▌   | 66/100 [04:10<02:22,  4.21s/it]Best trial: 56. Best value: 0.463182:  66%|██████▌   | 66/100 [04:13<02:22,  4.21s/it]Best trial: 56. Best value: 0.463182:  67%|██████▋   | 67/100 [04:13<02:12,  4.01s/it]Best trial: 56. Best value: 0.463182:  67%|██████▋   | 67/100 [04:19<02:12,  4.01s/it]Best trial: 56. Best value: 0.463182:  68%|██████▊   | 68/100 [04:19<02:20,  4.38s/it]Best trial: 56. Best value: 0.463182:  68%|██████▊   | 68/100 [04:22<02:20,  4.38s/it]Best trial: 56. Best value: 0.463182:  69%|██████▉   | 69/100 [04:22<02:02,  3.94s/it]Best trial: 56. Best value: 0.463182:  69%|██████▉   | 69/100 [04:26<02:02,  3.94s/it]Best trial: 56. Best value: 0.463182:  70%|███████   | 70/100 [04:26<02:02,  4.08s/it]Best trial: 56. Best value: 0.463182:  70%|███████   | 70/100 [04:29<02:02,  4.08s/it]Best trial: 56. Best value: 0.463182:  71%|███████   | 71/100 [04:29<01:45,  3.65s/it]Best trial: 56. Best value: 0.463182:  71%|███████   | 71/100 [04:31<01:45,  3.65s/it]Best trial: 56. Best value: 0.463182:  72%|███████▏  | 72/100 [04:31<01:35,  3.41s/it]Best trial: 56. Best value: 0.463182:  72%|███████▏  | 72/100 [04:36<01:35,  3.41s/it]Best trial: 56. Best value: 0.463182:  73%|███████▎  | 73/100 [04:36<01:45,  3.91s/it]Best trial: 56. Best value: 0.463182:  73%|███████▎  | 73/100 [04:43<01:45,  3.91s/it]Best trial: 56. Best value: 0.463182:  74%|███████▍  | 74/100 [04:43<02:05,  4.83s/it]Best trial: 56. Best value: 0.463182:  74%|███████▍  | 74/100 [04:48<02:05,  4.83s/it]Best trial: 56. Best value: 0.463182:  75%|███████▌  | 75/100 [04:48<01:58,  4.73s/it]Best trial: 56. Best value: 0.463182:  75%|███████▌  | 75/100 [04:54<01:58,  4.73s/it]Best trial: 56. Best value: 0.463182:  76%|███████▌  | 76/100 [04:54<02:05,  5.21s/it]Best trial: 56. Best value: 0.463182:  76%|███████▌  | 76/100 [05:02<02:05,  5.21s/it]Best trial: 56. Best value: 0.463182:  77%|███████▋  | 77/100 [05:02<02:19,  6.08s/it]Best trial: 56. Best value: 0.463182:  77%|███████▋  | 77/100 [05:11<02:19,  6.08s/it]Best trial: 56. Best value: 0.463182:  78%|███████▊  | 78/100 [05:11<02:27,  6.72s/it]Best trial: 56. Best value: 0.463182:  78%|███████▊  | 78/100 [05:18<02:27,  6.72s/it]Best trial: 56. Best value: 0.463182:  79%|███████▉  | 79/100 [05:18<02:25,  6.92s/it]Best trial: 56. Best value: 0.463182:  79%|███████▉  | 79/100 [05:28<02:25,  6.92s/it]Best trial: 56. Best value: 0.463182:  80%|████████  | 80/100 [05:28<02:34,  7.73s/it]Best trial: 56. Best value: 0.463182:  80%|████████  | 80/100 [05:40<02:34,  7.73s/it]Best trial: 56. Best value: 0.463182:  81%|████████  | 81/100 [05:40<02:52,  9.09s/it]Best trial: 56. Best value: 0.463182:  81%|████████  | 81/100 [05:48<02:52,  9.09s/it]Best trial: 56. Best value: 0.463182:  82%|████████▏ | 82/100 [05:48<02:39,  8.87s/it]Best trial: 56. Best value: 0.463182:  82%|████████▏ | 82/100 [05:56<02:39,  8.87s/it]Best trial: 56. Best value: 0.463182:  83%|████████▎ | 83/100 [05:56<02:27,  8.65s/it]Best trial: 56. Best value: 0.463182:  83%|████████▎ | 83/100 [06:01<02:27,  8.65s/it]Best trial: 56. Best value: 0.463182:  84%|████████▍ | 84/100 [06:01<01:58,  7.38s/it]Best trial: 56. Best value: 0.463182:  84%|████████▍ | 84/100 [06:05<01:58,  7.38s/it]Best trial: 56. Best value: 0.463182:  85%|████████▌ | 85/100 [06:05<01:34,  6.31s/it]Best trial: 56. Best value: 0.463182:  85%|████████▌ | 85/100 [06:14<01:34,  6.31s/it]Best trial: 56. Best value: 0.463182:  86%|████████▌ | 86/100 [06:14<01:39,  7.12s/it]Best trial: 56. Best value: 0.463182:  86%|████████▌ | 86/100 [06:20<01:39,  7.12s/it]Best trial: 56. Best value: 0.463182:  87%|████████▋ | 87/100 [06:20<01:27,  6.75s/it]Best trial: 56. Best value: 0.463182:  87%|████████▋ | 87/100 [06:23<01:27,  6.75s/it]Best trial: 56. Best value: 0.463182:  88%|████████▊ | 88/100 [06:23<01:09,  5.80s/it]Best trial: 56. Best value: 0.463182:  88%|████████▊ | 88/100 [06:33<01:09,  5.80s/it]Best trial: 56. Best value: 0.463182:  89%|████████▉ | 89/100 [06:33<01:17,  7.09s/it]Best trial: 56. Best value: 0.463182:  89%|████████▉ | 89/100 [06:36<01:17,  7.09s/it]Best trial: 56. Best value: 0.463182:  90%|█████████ | 90/100 [06:36<00:59,  5.90s/it]Best trial: 56. Best value: 0.463182:  90%|█████████ | 90/100 [06:39<00:59,  5.90s/it]Best trial: 56. Best value: 0.463182:  91%|█████████ | 91/100 [06:39<00:45,  5.05s/it]Best trial: 56. Best value: 0.463182:  91%|█████████ | 91/100 [06:48<00:45,  5.05s/it]Best trial: 56. Best value: 0.463182:  92%|█████████▏| 92/100 [06:48<00:50,  6.27s/it]Best trial: 56. Best value: 0.463182:  92%|█████████▏| 92/100 [06:58<00:50,  6.27s/it]Best trial: 56. Best value: 0.463182:  93%|█████████▎| 93/100 [06:58<00:50,  7.16s/it]Best trial: 56. Best value: 0.463182:  93%|█████████▎| 93/100 [07:02<00:50,  7.16s/it]Best trial: 56. Best value: 0.463182:  94%|█████████▍| 94/100 [07:02<00:38,  6.43s/it]Best trial: 56. Best value: 0.463182:  94%|█████████▍| 94/100 [07:12<00:38,  6.43s/it]Best trial: 56. Best value: 0.463182:  95%|█████████▌| 95/100 [07:12<00:36,  7.31s/it]Best trial: 56. Best value: 0.463182:  95%|█████████▌| 95/100 [07:20<00:36,  7.31s/it]Best trial: 56. Best value: 0.463182:  96%|█████████▌| 96/100 [07:20<00:30,  7.55s/it]Best trial: 56. Best value: 0.463182:  96%|█████████▌| 96/100 [07:25<00:30,  7.55s/it]Best trial: 56. Best value: 0.463182:  97%|█████████▋| 97/100 [07:25<00:20,  6.80s/it]Best trial: 56. Best value: 0.463182:  97%|█████████▋| 97/100 [07:35<00:20,  6.80s/it]Best trial: 56. Best value: 0.463182:  98%|█████████▊| 98/100 [07:35<00:15,  7.68s/it]Best trial: 56. Best value: 0.463182:  98%|█████████▊| 98/100 [07:39<00:15,  7.68s/it]Best trial: 56. Best value: 0.463182:  99%|█████████▉| 99/100 [07:39<00:06,  6.75s/it]Best trial: 56. Best value: 0.463182:  99%|█████████▉| 99/100 [07:46<00:06,  6.75s/it]Best trial: 56. Best value: 0.463182: 100%|██████████| 100/100 [07:46<00:00,  6.89s/it]Best trial: 56. Best value: 0.463182: 100%|██████████| 100/100 [07:46<00:00,  4.67s/it]
2025-11-30 19:07:33,677 - INFO - HPO Complete. Best AUPRC: 0.4632
2025-11-30 19:07:33,677 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.019515184891440013, 'max_depth': 6, 'subsample': 0.6396995032691923, 'colsample_bytree': 0.6944551836137439, 'gamma': 3.1781457291898088, 'reg_lambda': 0.4829574590402208, 'reg_alpha': 2.9925591257294377e-07}
2025-11-30 19:07:33,678 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 19:07:35,773 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: pleth_only
2025-11-30 19:07:35,773 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:07:35,983 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:07:36,006 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:07:36,011 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:07:36,011 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 19:07:36,011 - INFO - Training model...
2025-11-30 19:07:38,719 - INFO - Evaluating model with bootstrapping...
2025-11-30 19:07:43,758 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 19:07:43,759 - INFO - AUROC: 0.7336 (0.6725 - 0.7625)
2025-11-30 19:07:43,759 - INFO - AUPRC: 0.4879 (0.3980 - 0.5474)
2025-11-30 19:07:43,759 - INFO - Brier Score: 0.1638 (0.1556 - 0.1762)
2025-11-30 19:07:43,759 - INFO - Accuracy: 0.6936 (0.6338 - 0.7546)
2025-11-30 19:07:43,759 - INFO - Precision: 0.3985 (0.3297 - 0.4681)
2025-11-30 19:07:43,759 - INFO - Sensitivity (Recall): 0.6709 (0.5735 - 0.7827)
2025-11-30 19:07:43,759 - INFO - F1-Score: 0.5000 (0.4323 - 0.5557)
2025-11-30 19:07:43,759 - INFO - Best Threshold: 0.3300 (0.2660 - 0.4040)
2025-11-30 19:07:43,759 - INFO - Specificity: 0.7004 (0.6079 - 0.7975)
2025-11-30 19:07:43,785 - INFO - Calculating SHAP values...
2025-11-30 19:07:45,080 - INFO - SHAP plots saved.
2025-11-30 19:07:45,083 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 19:07:46,546 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: ecg_only
2025-11-30 19:07:46,546 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:07:46,772 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:07:46,794 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:07:46,800 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:07:46,800 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.425538:   0%|          | 0/100 [00:09<?, ?it/s]Best trial: 0. Best value: 0.425538:   1%|          | 1/100 [00:09<15:42,  9.52s/it]Best trial: 1. Best value: 0.437414:   1%|          | 1/100 [00:23<15:42,  9.52s/it]Best trial: 1. Best value: 0.437414:   2%|▏         | 2/100 [00:23<19:23, 11.87s/it]Best trial: 2. Best value: 0.450074:   2%|▏         | 2/100 [00:38<19:23, 11.87s/it]Best trial: 2. Best value: 0.450074:   3%|▎         | 3/100 [00:38<21:54, 13.55s/it]Best trial: 3. Best value: 0.459305:   3%|▎         | 3/100 [00:41<21:54, 13.55s/it]Best trial: 3. Best value: 0.459305:   4%|▍         | 4/100 [00:41<15:00,  9.38s/it]Best trial: 3. Best value: 0.459305:   4%|▍         | 4/100 [00:45<15:00,  9.38s/it]Best trial: 3. Best value: 0.459305:   5%|▌         | 5/100 [00:45<11:51,  7.49s/it]Best trial: 3. Best value: 0.459305:   5%|▌         | 5/100 [00:53<11:51,  7.49s/it]Best trial: 3. Best value: 0.459305:   6%|▌         | 6/100 [00:53<11:52,  7.58s/it]Best trial: 3. Best value: 0.459305:   6%|▌         | 6/100 [01:06<11:52,  7.58s/it]Best trial: 3. Best value: 0.459305:   7%|▋         | 7/100 [01:06<14:40,  9.47s/it]Best trial: 3. Best value: 0.459305:   7%|▋         | 7/100 [01:18<14:40,  9.47s/it]Best trial: 3. Best value: 0.459305:   8%|▊         | 8/100 [01:18<15:28, 10.09s/it]Best trial: 8. Best value: 0.460109:   8%|▊         | 8/100 [01:28<15:28, 10.09s/it]Best trial: 8. Best value: 0.460109:   9%|▉         | 9/100 [01:28<15:30, 10.23s/it]Best trial: 9. Best value: 0.463032:   9%|▉         | 9/100 [01:31<15:30, 10.23s/it]Best trial: 9. Best value: 0.463032:  10%|█         | 10/100 [01:31<11:55,  7.95s/it]Best trial: 9. Best value: 0.463032:  10%|█         | 10/100 [01:33<11:55,  7.95s/it]Best trial: 9. Best value: 0.463032:  11%|█         | 11/100 [01:33<09:11,  6.20s/it]Best trial: 9. Best value: 0.463032:  11%|█         | 11/100 [01:35<09:11,  6.20s/it]Best trial: 9. Best value: 0.463032:  12%|█▏        | 12/100 [01:35<07:13,  4.92s/it]Best trial: 9. Best value: 0.463032:  12%|█▏        | 12/100 [01:37<07:13,  4.92s/it]Best trial: 9. Best value: 0.463032:  13%|█▎        | 13/100 [01:37<05:51,  4.04s/it]Best trial: 13. Best value: 0.463476:  13%|█▎        | 13/100 [01:41<05:51,  4.04s/it]Best trial: 13. Best value: 0.463476:  14%|█▍        | 14/100 [01:41<05:33,  3.88s/it]Best trial: 13. Best value: 0.463476:  14%|█▍        | 14/100 [01:45<05:33,  3.88s/it]Best trial: 13. Best value: 0.463476:  15%|█▌        | 15/100 [01:45<05:36,  3.95s/it]Best trial: 13. Best value: 0.463476:  15%|█▌        | 15/100 [01:49<05:36,  3.95s/it]Best trial: 13. Best value: 0.463476:  16%|█▌        | 16/100 [01:49<05:33,  3.97s/it]Best trial: 13. Best value: 0.463476:  16%|█▌        | 16/100 [01:55<05:33,  3.97s/it]Best trial: 13. Best value: 0.463476:  17%|█▋        | 17/100 [01:55<06:30,  4.71s/it]Best trial: 17. Best value: 0.464578:  17%|█▋        | 17/100 [01:59<06:30,  4.71s/it]Best trial: 17. Best value: 0.464578:  18%|█▊        | 18/100 [01:59<05:52,  4.30s/it]Best trial: 17. Best value: 0.464578:  18%|█▊        | 18/100 [02:04<05:52,  4.30s/it]Best trial: 17. Best value: 0.464578:  19%|█▉        | 19/100 [02:04<06:01,  4.47s/it]Best trial: 17. Best value: 0.464578:  19%|█▉        | 19/100 [02:07<06:01,  4.47s/it]Best trial: 17. Best value: 0.464578:  20%|██        | 20/100 [02:07<05:35,  4.20s/it]Best trial: 17. Best value: 0.464578:  20%|██        | 20/100 [02:14<05:35,  4.20s/it]Best trial: 17. Best value: 0.464578:  21%|██        | 21/100 [02:14<06:27,  4.91s/it]Best trial: 17. Best value: 0.464578:  21%|██        | 21/100 [02:17<06:27,  4.91s/it]Best trial: 17. Best value: 0.464578:  22%|██▏       | 22/100 [02:17<05:35,  4.31s/it]Best trial: 17. Best value: 0.464578:  22%|██▏       | 22/100 [02:19<05:35,  4.31s/it]Best trial: 17. Best value: 0.464578:  23%|██▎       | 23/100 [02:19<04:50,  3.77s/it]Best trial: 17. Best value: 0.464578:  23%|██▎       | 23/100 [02:23<04:50,  3.77s/it]Best trial: 17. Best value: 0.464578:  24%|██▍       | 24/100 [02:23<04:46,  3.78s/it]Best trial: 17. Best value: 0.464578:  24%|██▍       | 24/100 [02:25<04:46,  3.78s/it]Best trial: 17. Best value: 0.464578:  25%|██▌       | 25/100 [02:25<04:13,  3.38s/it]Best trial: 17. Best value: 0.464578:  25%|██▌       | 25/100 [02:31<04:13,  3.38s/it]Best trial: 17. Best value: 0.464578:  26%|██▌       | 26/100 [02:31<04:47,  3.89s/it]Best trial: 26. Best value: 0.466617:  26%|██▌       | 26/100 [02:33<04:47,  3.89s/it]Best trial: 26. Best value: 0.466617:  27%|██▋       | 27/100 [02:33<04:20,  3.57s/it]Best trial: 26. Best value: 0.466617:  27%|██▋       | 27/100 [02:39<04:20,  3.57s/it]Best trial: 26. Best value: 0.466617:  28%|██▊       | 28/100 [02:39<04:53,  4.08s/it]Best trial: 26. Best value: 0.466617:  28%|██▊       | 28/100 [02:43<04:53,  4.08s/it]Best trial: 26. Best value: 0.466617:  29%|██▉       | 29/100 [02:43<04:48,  4.06s/it]Best trial: 26. Best value: 0.466617:  29%|██▉       | 29/100 [02:46<04:48,  4.06s/it]Best trial: 26. Best value: 0.466617:  30%|███       | 30/100 [02:46<04:28,  3.84s/it]Best trial: 26. Best value: 0.466617:  30%|███       | 30/100 [02:49<04:28,  3.84s/it]Best trial: 26. Best value: 0.466617:  31%|███       | 31/100 [02:49<04:02,  3.52s/it]Best trial: 26. Best value: 0.466617:  31%|███       | 31/100 [02:51<04:02,  3.52s/it]Best trial: 26. Best value: 0.466617:  32%|███▏      | 32/100 [02:51<03:30,  3.10s/it]Best trial: 26. Best value: 0.466617:  32%|███▏      | 32/100 [02:53<03:30,  3.10s/it]Best trial: 26. Best value: 0.466617:  33%|███▎      | 33/100 [02:53<03:17,  2.94s/it]Best trial: 33. Best value: 0.466784:  33%|███▎      | 33/100 [02:55<03:17,  2.94s/it]Best trial: 33. Best value: 0.466784:  34%|███▍      | 34/100 [02:55<02:56,  2.67s/it]Best trial: 33. Best value: 0.466784:  34%|███▍      | 34/100 [02:57<02:56,  2.67s/it]Best trial: 33. Best value: 0.466784:  35%|███▌      | 35/100 [02:57<02:40,  2.47s/it]Best trial: 33. Best value: 0.466784:  35%|███▌      | 35/100 [03:01<02:40,  2.47s/it]Best trial: 33. Best value: 0.466784:  36%|███▌      | 36/100 [03:01<02:57,  2.77s/it]Best trial: 33. Best value: 0.466784:  36%|███▌      | 36/100 [03:04<02:57,  2.77s/it]Best trial: 33. Best value: 0.466784:  37%|███▋      | 37/100 [03:04<03:03,  2.91s/it]Best trial: 33. Best value: 0.466784:  37%|███▋      | 37/100 [03:08<03:03,  2.91s/it]Best trial: 33. Best value: 0.466784:  38%|███▊      | 38/100 [03:08<03:19,  3.21s/it]Best trial: 33. Best value: 0.466784:  38%|███▊      | 38/100 [03:16<03:19,  3.21s/it]Best trial: 33. Best value: 0.466784:  39%|███▉      | 39/100 [03:16<04:38,  4.57s/it]Best trial: 33. Best value: 0.466784:  39%|███▉      | 39/100 [03:21<04:38,  4.57s/it]Best trial: 33. Best value: 0.466784:  40%|████      | 40/100 [03:21<04:51,  4.86s/it]Best trial: 40. Best value: 0.467851:  40%|████      | 40/100 [03:26<04:51,  4.86s/it]Best trial: 40. Best value: 0.467851:  41%|████      | 41/100 [03:26<04:51,  4.94s/it]Best trial: 40. Best value: 0.467851:  41%|████      | 41/100 [03:30<04:51,  4.94s/it]Best trial: 40. Best value: 0.467851:  42%|████▏     | 42/100 [03:30<04:14,  4.38s/it]Best trial: 40. Best value: 0.467851:  42%|████▏     | 42/100 [03:32<04:14,  4.38s/it]Best trial: 40. Best value: 0.467851:  43%|████▎     | 43/100 [03:32<03:41,  3.88s/it]Best trial: 40. Best value: 0.467851:  43%|████▎     | 43/100 [03:40<03:41,  3.88s/it]Best trial: 40. Best value: 0.467851:  44%|████▍     | 44/100 [03:40<04:49,  5.17s/it]Best trial: 40. Best value: 0.467851:  44%|████▍     | 44/100 [03:43<04:49,  5.17s/it]Best trial: 40. Best value: 0.467851:  45%|████▌     | 45/100 [03:43<03:58,  4.34s/it]Best trial: 40. Best value: 0.467851:  45%|████▌     | 45/100 [03:46<03:58,  4.34s/it]Best trial: 40. Best value: 0.467851:  46%|████▌     | 46/100 [03:46<03:29,  3.87s/it]Best trial: 40. Best value: 0.467851:  46%|████▌     | 46/100 [03:48<03:29,  3.87s/it]Best trial: 40. Best value: 0.467851:  47%|████▋     | 47/100 [03:48<02:55,  3.32s/it]Best trial: 40. Best value: 0.467851:  47%|████▋     | 47/100 [03:52<02:55,  3.32s/it]Best trial: 40. Best value: 0.467851:  48%|████▊     | 48/100 [03:52<03:12,  3.71s/it]Best trial: 40. Best value: 0.467851:  48%|████▊     | 48/100 [03:58<03:12,  3.71s/it]Best trial: 40. Best value: 0.467851:  49%|████▉     | 49/100 [03:58<03:33,  4.19s/it]Best trial: 40. Best value: 0.467851:  49%|████▉     | 49/100 [04:01<03:33,  4.19s/it]Best trial: 40. Best value: 0.467851:  50%|█████     | 50/100 [04:01<03:11,  3.84s/it]Best trial: 40. Best value: 0.467851:  50%|█████     | 50/100 [04:04<03:11,  3.84s/it]Best trial: 40. Best value: 0.467851:  51%|█████     | 51/100 [04:04<02:58,  3.64s/it]Best trial: 40. Best value: 0.467851:  51%|█████     | 51/100 [04:07<02:58,  3.64s/it]Best trial: 40. Best value: 0.467851:  52%|█████▏    | 52/100 [04:07<02:51,  3.58s/it]Best trial: 40. Best value: 0.467851:  52%|█████▏    | 52/100 [04:10<02:51,  3.58s/it]Best trial: 40. Best value: 0.467851:  53%|█████▎    | 53/100 [04:10<02:31,  3.22s/it]Best trial: 40. Best value: 0.467851:  53%|█████▎    | 53/100 [04:13<02:31,  3.22s/it]Best trial: 40. Best value: 0.467851:  54%|█████▍    | 54/100 [04:13<02:30,  3.27s/it]Best trial: 40. Best value: 0.467851:  54%|█████▍    | 54/100 [04:18<02:30,  3.27s/it]Best trial: 40. Best value: 0.467851:  55%|█████▌    | 55/100 [04:18<02:50,  3.79s/it]Best trial: 40. Best value: 0.467851:  55%|█████▌    | 55/100 [04:20<02:50,  3.79s/it]Best trial: 40. Best value: 0.467851:  56%|█████▌    | 56/100 [04:20<02:26,  3.32s/it]Best trial: 40. Best value: 0.467851:  56%|█████▌    | 56/100 [04:24<02:26,  3.32s/it]Best trial: 40. Best value: 0.467851:  57%|█████▋    | 57/100 [04:24<02:32,  3.54s/it]Best trial: 40. Best value: 0.467851:  57%|█████▋    | 57/100 [04:27<02:32,  3.54s/it]Best trial: 40. Best value: 0.467851:  58%|█████▊    | 58/100 [04:27<02:17,  3.27s/it]Best trial: 40. Best value: 0.467851:  58%|█████▊    | 58/100 [04:29<02:17,  3.27s/it]Best trial: 40. Best value: 0.467851:  59%|█████▉    | 59/100 [04:29<02:03,  3.02s/it]Best trial: 40. Best value: 0.467851:  59%|█████▉    | 59/100 [04:33<02:03,  3.02s/it]Best trial: 40. Best value: 0.467851:  60%|██████    | 60/100 [04:33<02:03,  3.08s/it]Best trial: 40. Best value: 0.467851:  60%|██████    | 60/100 [04:36<02:03,  3.08s/it]Best trial: 40. Best value: 0.467851:  61%|██████    | 61/100 [04:36<02:07,  3.28s/it]Best trial: 40. Best value: 0.467851:  61%|██████    | 61/100 [04:40<02:07,  3.28s/it]Best trial: 40. Best value: 0.467851:  62%|██████▏   | 62/100 [04:40<02:08,  3.37s/it]Best trial: 40. Best value: 0.467851:  62%|██████▏   | 62/100 [04:44<02:08,  3.37s/it]Best trial: 40. Best value: 0.467851:  63%|██████▎   | 63/100 [04:44<02:17,  3.73s/it]Best trial: 63. Best value: 0.467878:  63%|██████▎   | 63/100 [04:48<02:17,  3.73s/it]Best trial: 63. Best value: 0.467878:  64%|██████▍   | 64/100 [04:48<02:10,  3.63s/it]Best trial: 63. Best value: 0.467878:  64%|██████▍   | 64/100 [04:52<02:10,  3.63s/it]Best trial: 63. Best value: 0.467878:  65%|██████▌   | 65/100 [04:52<02:11,  3.76s/it]Best trial: 63. Best value: 0.467878:  65%|██████▌   | 65/100 [04:55<02:11,  3.76s/it]Best trial: 63. Best value: 0.467878:  66%|██████▌   | 66/100 [04:55<02:03,  3.63s/it]Best trial: 63. Best value: 0.467878:  66%|██████▌   | 66/100 [05:01<02:03,  3.63s/it]Best trial: 63. Best value: 0.467878:  67%|██████▋   | 67/100 [05:01<02:24,  4.38s/it]Best trial: 63. Best value: 0.467878:  67%|██████▋   | 67/100 [05:05<02:24,  4.38s/it]Best trial: 63. Best value: 0.467878:  68%|██████▊   | 68/100 [05:05<02:11,  4.10s/it]Best trial: 63. Best value: 0.467878:  68%|██████▊   | 68/100 [05:11<02:11,  4.10s/it]Best trial: 63. Best value: 0.467878:  69%|██████▉   | 69/100 [05:11<02:23,  4.63s/it]Best trial: 63. Best value: 0.467878:  69%|██████▉   | 69/100 [05:13<02:23,  4.63s/it]Best trial: 63. Best value: 0.467878:  70%|███████   | 70/100 [05:13<02:00,  4.01s/it]Best trial: 63. Best value: 0.467878:  70%|███████   | 70/100 [05:20<02:00,  4.01s/it]Best trial: 63. Best value: 0.467878:  71%|███████   | 71/100 [05:20<02:17,  4.73s/it]Best trial: 63. Best value: 0.467878:  71%|███████   | 71/100 [05:23<02:17,  4.73s/it]Best trial: 63. Best value: 0.467878:  72%|███████▏  | 72/100 [05:23<02:04,  4.45s/it]Best trial: 63. Best value: 0.467878:  72%|███████▏  | 72/100 [05:28<02:04,  4.45s/it]Best trial: 63. Best value: 0.467878:  73%|███████▎  | 73/100 [05:28<02:04,  4.61s/it]Best trial: 63. Best value: 0.467878:  73%|███████▎  | 73/100 [05:31<02:04,  4.61s/it]Best trial: 63. Best value: 0.467878:  74%|███████▍  | 74/100 [05:31<01:41,  3.90s/it]Best trial: 63. Best value: 0.467878:  74%|███████▍  | 74/100 [05:35<01:41,  3.90s/it]Best trial: 63. Best value: 0.467878:  75%|███████▌  | 75/100 [05:35<01:39,  4.00s/it]Best trial: 63. Best value: 0.467878:  75%|███████▌  | 75/100 [05:37<01:39,  4.00s/it]Best trial: 63. Best value: 0.467878:  76%|███████▌  | 76/100 [05:37<01:24,  3.51s/it]Best trial: 63. Best value: 0.467878:  76%|███████▌  | 76/100 [05:41<01:24,  3.51s/it]Best trial: 63. Best value: 0.467878:  77%|███████▋  | 77/100 [05:41<01:23,  3.65s/it]Best trial: 63. Best value: 0.467878:  77%|███████▋  | 77/100 [05:43<01:23,  3.65s/it]Best trial: 63. Best value: 0.467878:  78%|███████▊  | 78/100 [05:43<01:09,  3.14s/it]Best trial: 63. Best value: 0.467878:  78%|███████▊  | 78/100 [05:47<01:09,  3.14s/it]Best trial: 63. Best value: 0.467878:  79%|███████▉  | 79/100 [05:47<01:07,  3.20s/it]Best trial: 63. Best value: 0.467878:  79%|███████▉  | 79/100 [05:50<01:07,  3.20s/it]Best trial: 63. Best value: 0.467878:  80%|████████  | 80/100 [05:50<01:04,  3.21s/it]Best trial: 63. Best value: 0.467878:  80%|████████  | 80/100 [05:56<01:04,  3.21s/it]Best trial: 63. Best value: 0.467878:  81%|████████  | 81/100 [05:56<01:16,  4.01s/it]Best trial: 63. Best value: 0.467878:  81%|████████  | 81/100 [06:04<01:16,  4.01s/it]Best trial: 63. Best value: 0.467878:  82%|████████▏ | 82/100 [06:04<01:37,  5.40s/it]Best trial: 63. Best value: 0.467878:  82%|████████▏ | 82/100 [06:11<01:37,  5.40s/it]Best trial: 63. Best value: 0.467878:  83%|████████▎ | 83/100 [06:11<01:37,  5.74s/it]Best trial: 63. Best value: 0.467878:  83%|████████▎ | 83/100 [06:23<01:37,  5.74s/it]Best trial: 63. Best value: 0.467878:  84%|████████▍ | 84/100 [06:23<02:00,  7.54s/it]Best trial: 63. Best value: 0.467878:  84%|████████▍ | 84/100 [06:30<02:00,  7.54s/it]Best trial: 63. Best value: 0.467878:  85%|████████▌ | 85/100 [06:30<01:53,  7.54s/it]Best trial: 63. Best value: 0.467878:  85%|████████▌ | 85/100 [06:35<01:53,  7.54s/it]Best trial: 63. Best value: 0.467878:  86%|████████▌ | 86/100 [06:35<01:32,  6.64s/it]Best trial: 63. Best value: 0.467878:  86%|████████▌ | 86/100 [06:39<01:32,  6.64s/it]Best trial: 63. Best value: 0.467878:  87%|████████▋ | 87/100 [06:39<01:15,  5.81s/it]Best trial: 63. Best value: 0.467878:  87%|████████▋ | 87/100 [06:45<01:15,  5.81s/it]Best trial: 63. Best value: 0.467878:  88%|████████▊ | 88/100 [06:45<01:13,  6.10s/it]Best trial: 63. Best value: 0.467878:  88%|████████▊ | 88/100 [06:48<01:13,  6.10s/it]Best trial: 63. Best value: 0.467878:  89%|████████▉ | 89/100 [06:48<00:55,  5.01s/it]Best trial: 63. Best value: 0.467878:  89%|████████▉ | 89/100 [06:51<00:55,  5.01s/it]Best trial: 63. Best value: 0.467878:  90%|█████████ | 90/100 [06:51<00:45,  4.54s/it]Best trial: 90. Best value: 0.473648:  90%|█████████ | 90/100 [06:54<00:45,  4.54s/it]Best trial: 90. Best value: 0.473648:  91%|█████████ | 91/100 [06:54<00:36,  4.02s/it]Best trial: 90. Best value: 0.473648:  91%|█████████ | 91/100 [06:57<00:36,  4.02s/it]Best trial: 90. Best value: 0.473648:  92%|█████████▏| 92/100 [06:57<00:28,  3.56s/it]Best trial: 90. Best value: 0.473648:  92%|█████████▏| 92/100 [07:00<00:28,  3.56s/it]Best trial: 90. Best value: 0.473648:  93%|█████████▎| 93/100 [07:00<00:24,  3.55s/it]Best trial: 90. Best value: 0.473648:  93%|█████████▎| 93/100 [07:03<00:24,  3.55s/it]Best trial: 90. Best value: 0.473648:  94%|█████████▍| 94/100 [07:03<00:19,  3.30s/it]Best trial: 90. Best value: 0.473648:  94%|█████████▍| 94/100 [07:06<00:19,  3.30s/it]Best trial: 90. Best value: 0.473648:  95%|█████████▌| 95/100 [07:06<00:16,  3.22s/it]Best trial: 90. Best value: 0.473648:  95%|█████████▌| 95/100 [07:08<00:16,  3.22s/it]Best trial: 90. Best value: 0.473648:  96%|█████████▌| 96/100 [07:08<00:12,  3.06s/it]Best trial: 90. Best value: 0.473648:  96%|█████████▌| 96/100 [07:11<00:12,  3.06s/it]Best trial: 90. Best value: 0.473648:  97%|█████████▋| 97/100 [07:11<00:09,  3.00s/it]Best trial: 90. Best value: 0.473648:  97%|█████████▋| 97/100 [07:15<00:09,  3.00s/it]Best trial: 90. Best value: 0.473648:  98%|█████████▊| 98/100 [07:15<00:06,  3.17s/it]Best trial: 90. Best value: 0.473648:  98%|█████████▊| 98/100 [07:18<00:06,  3.17s/it]Best trial: 90. Best value: 0.473648:  99%|█████████▉| 99/100 [07:18<00:03,  3.19s/it]Best trial: 90. Best value: 0.473648:  99%|█████████▉| 99/100 [07:21<00:03,  3.19s/it]Best trial: 90. Best value: 0.473648: 100%|██████████| 100/100 [07:21<00:00,  3.24s/it]Best trial: 90. Best value: 0.473648: 100%|██████████| 100/100 [07:21<00:00,  4.42s/it]
2025-11-30 19:15:08,781 - INFO - HPO Complete. Best AUPRC: 0.4736
2025-11-30 19:15:08,781 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.060271875866808586, 'max_depth': 6, 'subsample': 0.6642685204059601, 'colsample_bytree': 0.8317376302345847, 'gamma': 4.483746045747751, 'reg_lambda': 0.5260201893643714, 'reg_alpha': 0.00037348526917363966}
2025-11-30 19:15:08,782 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 19:15:10,759 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: ecg_only
2025-11-30 19:15:10,760 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:15:10,975 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:15:10,999 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:15:11,003 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:15:11,003 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 19:15:11,003 - INFO - Training model...
2025-11-30 19:15:12,661 - INFO - Evaluating model with bootstrapping...
2025-11-30 19:15:17,695 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 19:15:17,695 - INFO - AUROC: 0.6840 (0.6477 - 0.7153)
2025-11-30 19:15:17,695 - INFO - AUPRC: 0.3791 (0.3364 - 0.4520)
2025-11-30 19:15:17,695 - INFO - Brier Score: 0.1772 (0.1696 - 0.1884)
2025-11-30 19:15:17,695 - INFO - Accuracy: 0.5780 (0.5517 - 0.7012)
2025-11-30 19:15:17,695 - INFO - Precision: 0.3246 (0.2988 - 0.4101)
2025-11-30 19:15:17,695 - INFO - Sensitivity (Recall): 0.7848 (0.5729 - 0.8156)
2025-11-30 19:15:17,695 - INFO - F1-Score: 0.4593 (0.4283 - 0.5070)
2025-11-30 19:15:17,695 - INFO - Best Threshold: 0.2300 (0.2220 - 0.3700)
2025-11-30 19:15:17,695 - INFO - Specificity: 0.5169 (0.4764 - 0.7395)
2025-11-30 19:15:17,708 - INFO - Calculating SHAP values...
2025-11-30 19:15:18,930 - INFO - SHAP plots saved.
2025-11-30 19:15:18,932 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 19:15:20,232 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: co2_only
2025-11-30 19:15:20,232 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:15:20,467 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:15:20,487 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:15:20,492 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:15:20,492 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.467212:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.467212:   1%|          | 1/100 [00:05<08:24,  5.10s/it]Best trial: 1. Best value: 0.470157:   1%|          | 1/100 [00:12<08:24,  5.10s/it]Best trial: 1. Best value: 0.470157:   2%|▏         | 2/100 [00:12<10:19,  6.32s/it]Best trial: 1. Best value: 0.470157:   2%|▏         | 2/100 [00:15<10:19,  6.32s/it]Best trial: 1. Best value: 0.470157:   3%|▎         | 3/100 [00:15<07:55,  4.90s/it]Best trial: 3. Best value: 0.471486:   3%|▎         | 3/100 [00:18<07:55,  4.90s/it]Best trial: 3. Best value: 0.471486:   4%|▍         | 4/100 [00:18<06:54,  4.31s/it]Best trial: 4. Best value: 0.473552:   4%|▍         | 4/100 [00:26<06:54,  4.31s/it]Best trial: 4. Best value: 0.473552:   5%|▌         | 5/100 [00:26<08:45,  5.53s/it]Best trial: 5. Best value: 0.495599:   5%|▌         | 5/100 [00:31<08:45,  5.53s/it]Best trial: 5. Best value: 0.495599:   6%|▌         | 6/100 [00:31<08:23,  5.35s/it]Best trial: 5. Best value: 0.495599:   6%|▌         | 6/100 [00:35<08:23,  5.35s/it]Best trial: 5. Best value: 0.495599:   7%|▋         | 7/100 [00:35<07:31,  4.85s/it]Best trial: 5. Best value: 0.495599:   7%|▋         | 7/100 [00:38<07:31,  4.85s/it]Best trial: 5. Best value: 0.495599:   8%|▊         | 8/100 [00:38<06:41,  4.36s/it]Best trial: 5. Best value: 0.495599:   8%|▊         | 8/100 [00:50<06:41,  4.36s/it]Best trial: 5. Best value: 0.495599:   9%|▉         | 9/100 [00:50<10:11,  6.72s/it]Best trial: 5. Best value: 0.495599:   9%|▉         | 9/100 [00:58<10:11,  6.72s/it]Best trial: 5. Best value: 0.495599:  10%|█         | 10/100 [00:58<10:25,  6.96s/it]Best trial: 5. Best value: 0.495599:  10%|█         | 10/100 [01:02<10:25,  6.96s/it]Best trial: 5. Best value: 0.495599:  11%|█         | 11/100 [01:02<09:08,  6.16s/it]Best trial: 5. Best value: 0.495599:  11%|█         | 11/100 [01:05<09:08,  6.16s/it]Best trial: 5. Best value: 0.495599:  12%|█▏        | 12/100 [01:05<07:43,  5.27s/it]Best trial: 5. Best value: 0.495599:  12%|█▏        | 12/100 [01:15<07:43,  5.27s/it]Best trial: 5. Best value: 0.495599:  13%|█▎        | 13/100 [01:15<09:41,  6.69s/it]Best trial: 5. Best value: 0.495599:  13%|█▎        | 13/100 [01:22<09:41,  6.69s/it]Best trial: 5. Best value: 0.495599:  14%|█▍        | 14/100 [01:22<09:39,  6.74s/it]Best trial: 5. Best value: 0.495599:  14%|█▍        | 14/100 [01:28<09:39,  6.74s/it]Best trial: 5. Best value: 0.495599:  15%|█▌        | 15/100 [01:28<09:20,  6.59s/it]Best trial: 5. Best value: 0.495599:  15%|█▌        | 15/100 [01:38<09:20,  6.59s/it]Best trial: 5. Best value: 0.495599:  16%|█▌        | 16/100 [01:38<10:24,  7.43s/it]Best trial: 5. Best value: 0.495599:  16%|█▌        | 16/100 [01:42<10:24,  7.43s/it]Best trial: 5. Best value: 0.495599:  17%|█▋        | 17/100 [01:42<08:57,  6.47s/it]Best trial: 5. Best value: 0.495599:  17%|█▋        | 17/100 [01:45<08:57,  6.47s/it]Best trial: 5. Best value: 0.495599:  18%|█▊        | 18/100 [01:45<07:31,  5.51s/it]Best trial: 5. Best value: 0.495599:  18%|█▊        | 18/100 [01:51<07:31,  5.51s/it]Best trial: 5. Best value: 0.495599:  19%|█▉        | 19/100 [01:51<07:26,  5.51s/it]Best trial: 5. Best value: 0.495599:  19%|█▉        | 19/100 [01:55<07:26,  5.51s/it]Best trial: 5. Best value: 0.495599:  20%|██        | 20/100 [01:55<06:47,  5.09s/it]Best trial: 5. Best value: 0.495599:  20%|██        | 20/100 [01:58<06:47,  5.09s/it]Best trial: 5. Best value: 0.495599:  21%|██        | 21/100 [01:58<05:47,  4.40s/it]Best trial: 5. Best value: 0.495599:  21%|██        | 21/100 [02:01<05:47,  4.40s/it]Best trial: 5. Best value: 0.495599:  22%|██▏       | 22/100 [02:01<05:11,  3.99s/it]Best trial: 5. Best value: 0.495599:  22%|██▏       | 22/100 [02:03<05:11,  3.99s/it]Best trial: 5. Best value: 0.495599:  23%|██▎       | 23/100 [02:03<04:32,  3.53s/it]Best trial: 5. Best value: 0.495599:  23%|██▎       | 23/100 [02:06<04:32,  3.53s/it]Best trial: 5. Best value: 0.495599:  24%|██▍       | 24/100 [02:06<04:21,  3.44s/it]Best trial: 5. Best value: 0.495599:  24%|██▍       | 24/100 [02:09<04:21,  3.44s/it]Best trial: 5. Best value: 0.495599:  25%|██▌       | 25/100 [02:09<04:11,  3.35s/it]Best trial: 5. Best value: 0.495599:  25%|██▌       | 25/100 [02:14<04:11,  3.35s/it]Best trial: 5. Best value: 0.495599:  26%|██▌       | 26/100 [02:14<04:36,  3.73s/it]Best trial: 5. Best value: 0.495599:  26%|██▌       | 26/100 [02:19<04:36,  3.73s/it]Best trial: 5. Best value: 0.495599:  27%|██▋       | 27/100 [02:19<04:50,  3.97s/it]Best trial: 5. Best value: 0.495599:  27%|██▋       | 27/100 [02:23<04:50,  3.97s/it]Best trial: 5. Best value: 0.495599:  28%|██▊       | 28/100 [02:23<05:01,  4.19s/it]Best trial: 5. Best value: 0.495599:  28%|██▊       | 28/100 [02:27<05:01,  4.19s/it]Best trial: 5. Best value: 0.495599:  29%|██▉       | 29/100 [02:27<04:44,  4.00s/it]Best trial: 5. Best value: 0.495599:  29%|██▉       | 29/100 [02:30<04:44,  4.00s/it]Best trial: 5. Best value: 0.495599:  30%|███       | 30/100 [02:30<04:15,  3.65s/it]Best trial: 5. Best value: 0.495599:  30%|███       | 30/100 [02:33<04:15,  3.65s/it]Best trial: 5. Best value: 0.495599:  31%|███       | 31/100 [02:33<04:01,  3.49s/it]Best trial: 5. Best value: 0.495599:  31%|███       | 31/100 [02:39<04:01,  3.49s/it]Best trial: 5. Best value: 0.495599:  32%|███▏      | 32/100 [02:39<04:54,  4.33s/it]Best trial: 32. Best value: 0.495732:  32%|███▏      | 32/100 [02:45<04:54,  4.33s/it]Best trial: 32. Best value: 0.495732:  33%|███▎      | 33/100 [02:45<05:31,  4.94s/it]Best trial: 32. Best value: 0.495732:  33%|███▎      | 33/100 [02:50<05:31,  4.94s/it]Best trial: 32. Best value: 0.495732:  34%|███▍      | 34/100 [02:50<05:13,  4.75s/it]Best trial: 32. Best value: 0.495732:  34%|███▍      | 34/100 [02:54<05:13,  4.75s/it]Best trial: 32. Best value: 0.495732:  35%|███▌      | 35/100 [02:54<04:55,  4.55s/it]Best trial: 32. Best value: 0.495732:  35%|███▌      | 35/100 [02:58<04:55,  4.55s/it]Best trial: 32. Best value: 0.495732:  36%|███▌      | 36/100 [02:58<04:50,  4.53s/it]Best trial: 32. Best value: 0.495732:  36%|███▌      | 36/100 [03:08<04:50,  4.53s/it]Best trial: 32. Best value: 0.495732:  37%|███▋      | 37/100 [03:08<06:14,  5.94s/it]Best trial: 32. Best value: 0.495732:  37%|███▋      | 37/100 [03:12<06:14,  5.94s/it]Best trial: 32. Best value: 0.495732:  38%|███▊      | 38/100 [03:12<05:34,  5.40s/it]Best trial: 32. Best value: 0.495732:  38%|███▊      | 38/100 [03:19<05:34,  5.40s/it]Best trial: 32. Best value: 0.495732:  39%|███▉      | 39/100 [03:19<05:56,  5.84s/it]Best trial: 32. Best value: 0.495732:  39%|███▉      | 39/100 [03:27<05:56,  5.84s/it]Best trial: 32. Best value: 0.495732:  40%|████      | 40/100 [03:27<06:41,  6.69s/it]Best trial: 32. Best value: 0.495732:  40%|████      | 40/100 [03:30<06:41,  6.69s/it]Best trial: 32. Best value: 0.495732:  41%|████      | 41/100 [03:30<05:23,  5.49s/it]Best trial: 32. Best value: 0.495732:  41%|████      | 41/100 [03:35<05:23,  5.49s/it]Best trial: 32. Best value: 0.495732:  42%|████▏     | 42/100 [03:35<05:07,  5.30s/it]Best trial: 32. Best value: 0.495732:  42%|████▏     | 42/100 [03:40<05:07,  5.30s/it]Best trial: 32. Best value: 0.495732:  43%|████▎     | 43/100 [03:40<04:54,  5.17s/it]Best trial: 43. Best value: 0.501926:  43%|████▎     | 43/100 [03:47<04:54,  5.17s/it]Best trial: 43. Best value: 0.501926:  44%|████▍     | 44/100 [03:47<05:33,  5.95s/it]Best trial: 43. Best value: 0.501926:  44%|████▍     | 44/100 [03:56<05:33,  5.95s/it]Best trial: 43. Best value: 0.501926:  45%|████▌     | 45/100 [03:56<06:11,  6.76s/it]Best trial: 43. Best value: 0.501926:  45%|████▌     | 45/100 [04:05<06:11,  6.76s/it]Best trial: 43. Best value: 0.501926:  46%|████▌     | 46/100 [04:05<06:45,  7.51s/it]Best trial: 43. Best value: 0.501926:  46%|████▌     | 46/100 [04:11<06:45,  7.51s/it]Best trial: 43. Best value: 0.501926:  47%|████▋     | 47/100 [04:11<06:13,  7.04s/it]Best trial: 43. Best value: 0.501926:  47%|████▋     | 47/100 [04:19<06:13,  7.04s/it]Best trial: 43. Best value: 0.501926:  48%|████▊     | 48/100 [04:19<06:21,  7.34s/it]Best trial: 43. Best value: 0.501926:  48%|████▊     | 48/100 [04:29<06:21,  7.34s/it]Best trial: 43. Best value: 0.501926:  49%|████▉     | 49/100 [04:29<06:53,  8.11s/it]Best trial: 43. Best value: 0.501926:  49%|████▉     | 49/100 [04:34<06:53,  8.11s/it]Best trial: 43. Best value: 0.501926:  50%|█████     | 50/100 [04:34<06:02,  7.26s/it]Best trial: 43. Best value: 0.501926:  50%|█████     | 50/100 [04:43<06:02,  7.26s/it]Best trial: 43. Best value: 0.501926:  51%|█████     | 51/100 [04:43<06:14,  7.64s/it]Best trial: 43. Best value: 0.501926:  51%|█████     | 51/100 [04:48<06:14,  7.64s/it]Best trial: 43. Best value: 0.501926:  52%|█████▏    | 52/100 [04:48<05:35,  6.98s/it]Best trial: 43. Best value: 0.501926:  52%|█████▏    | 52/100 [04:54<05:35,  6.98s/it]Best trial: 43. Best value: 0.501926:  53%|█████▎    | 53/100 [04:54<05:13,  6.67s/it]Best trial: 43. Best value: 0.501926:  53%|█████▎    | 53/100 [05:01<05:13,  6.67s/it]Best trial: 43. Best value: 0.501926:  54%|█████▍    | 54/100 [05:01<05:07,  6.68s/it]Best trial: 43. Best value: 0.501926:  54%|█████▍    | 54/100 [05:09<05:07,  6.68s/it]Best trial: 43. Best value: 0.501926:  55%|█████▌    | 55/100 [05:09<05:18,  7.08s/it]Best trial: 43. Best value: 0.501926:  55%|█████▌    | 55/100 [05:13<05:18,  7.08s/it]Best trial: 43. Best value: 0.501926:  56%|█████▌    | 56/100 [05:13<04:35,  6.26s/it]Best trial: 43. Best value: 0.501926:  56%|█████▌    | 56/100 [05:19<04:35,  6.26s/it]Best trial: 43. Best value: 0.501926:  57%|█████▋    | 57/100 [05:19<04:17,  5.98s/it]Best trial: 43. Best value: 0.501926:  57%|█████▋    | 57/100 [05:27<04:17,  5.98s/it]Best trial: 43. Best value: 0.501926:  58%|█████▊    | 58/100 [05:27<04:44,  6.77s/it]Best trial: 43. Best value: 0.501926:  58%|█████▊    | 58/100 [05:37<04:44,  6.77s/it]Best trial: 43. Best value: 0.501926:  59%|█████▉    | 59/100 [05:37<05:13,  7.66s/it]Best trial: 43. Best value: 0.501926:  59%|█████▉    | 59/100 [05:42<05:13,  7.66s/it]Best trial: 43. Best value: 0.501926:  60%|██████    | 60/100 [05:42<04:34,  6.87s/it]Best trial: 43. Best value: 0.501926:  60%|██████    | 60/100 [05:47<04:34,  6.87s/it]Best trial: 43. Best value: 0.501926:  61%|██████    | 61/100 [05:47<04:03,  6.23s/it]Best trial: 43. Best value: 0.501926:  61%|██████    | 61/100 [05:51<04:03,  6.23s/it]Best trial: 43. Best value: 0.501926:  62%|██████▏   | 62/100 [05:51<03:37,  5.71s/it]Best trial: 43. Best value: 0.501926:  62%|██████▏   | 62/100 [05:56<03:37,  5.71s/it]Best trial: 43. Best value: 0.501926:  63%|██████▎   | 63/100 [05:56<03:20,  5.41s/it]Best trial: 43. Best value: 0.501926:  63%|██████▎   | 63/100 [05:59<03:20,  5.41s/it]Best trial: 43. Best value: 0.501926:  64%|██████▍   | 64/100 [05:59<02:47,  4.64s/it]Best trial: 43. Best value: 0.501926:  64%|██████▍   | 64/100 [06:05<02:47,  4.64s/it]Best trial: 43. Best value: 0.501926:  65%|██████▌   | 65/100 [06:05<02:51,  4.91s/it]Best trial: 43. Best value: 0.501926:  65%|██████▌   | 65/100 [06:08<02:51,  4.91s/it]Best trial: 43. Best value: 0.501926:  66%|██████▌   | 66/100 [06:08<02:35,  4.58s/it]Best trial: 43. Best value: 0.501926:  66%|██████▌   | 66/100 [06:12<02:35,  4.58s/it]Best trial: 43. Best value: 0.501926:  67%|██████▋   | 67/100 [06:12<02:18,  4.21s/it]Best trial: 43. Best value: 0.501926:  67%|██████▋   | 67/100 [06:16<02:18,  4.21s/it]Best trial: 43. Best value: 0.501926:  68%|██████▊   | 68/100 [06:16<02:19,  4.37s/it]Best trial: 43. Best value: 0.501926:  68%|██████▊   | 68/100 [06:21<02:19,  4.37s/it]Best trial: 43. Best value: 0.501926:  69%|██████▉   | 69/100 [06:21<02:17,  4.43s/it]Best trial: 43. Best value: 0.501926:  69%|██████▉   | 69/100 [06:26<02:17,  4.43s/it]Best trial: 43. Best value: 0.501926:  70%|███████   | 70/100 [06:26<02:18,  4.63s/it]Best trial: 43. Best value: 0.501926:  70%|███████   | 70/100 [06:31<02:18,  4.63s/it]Best trial: 43. Best value: 0.501926:  71%|███████   | 71/100 [06:31<02:16,  4.72s/it]Best trial: 43. Best value: 0.501926:  71%|███████   | 71/100 [06:36<02:16,  4.72s/it]Best trial: 43. Best value: 0.501926:  72%|███████▏  | 72/100 [06:36<02:12,  4.74s/it]Best trial: 43. Best value: 0.501926:  72%|███████▏  | 72/100 [06:39<02:12,  4.74s/it]Best trial: 43. Best value: 0.501926:  73%|███████▎  | 73/100 [06:39<01:59,  4.41s/it]Best trial: 43. Best value: 0.501926:  73%|███████▎  | 73/100 [06:43<01:59,  4.41s/it]Best trial: 43. Best value: 0.501926:  74%|███████▍  | 74/100 [06:43<01:51,  4.27s/it]Best trial: 43. Best value: 0.501926:  74%|███████▍  | 74/100 [06:48<01:51,  4.27s/it]Best trial: 43. Best value: 0.501926:  75%|███████▌  | 75/100 [06:48<01:47,  4.31s/it]Best trial: 43. Best value: 0.501926:  75%|███████▌  | 75/100 [06:52<01:47,  4.31s/it]Best trial: 43. Best value: 0.501926:  76%|███████▌  | 76/100 [06:52<01:45,  4.40s/it]Best trial: 43. Best value: 0.501926:  76%|███████▌  | 76/100 [06:55<01:45,  4.40s/it]Best trial: 43. Best value: 0.501926:  77%|███████▋  | 77/100 [06:55<01:27,  3.78s/it]Best trial: 43. Best value: 0.501926:  77%|███████▋  | 77/100 [06:59<01:27,  3.78s/it]Best trial: 43. Best value: 0.501926:  78%|███████▊  | 78/100 [06:59<01:26,  3.95s/it]Best trial: 43. Best value: 0.501926:  78%|███████▊  | 78/100 [07:04<01:26,  3.95s/it]Best trial: 43. Best value: 0.501926:  79%|███████▉  | 79/100 [07:04<01:26,  4.12s/it]Best trial: 43. Best value: 0.501926:  79%|███████▉  | 79/100 [07:11<01:26,  4.12s/it]Best trial: 43. Best value: 0.501926:  80%|████████  | 80/100 [07:11<01:40,  5.01s/it]Best trial: 43. Best value: 0.501926:  80%|████████  | 80/100 [07:14<01:40,  5.01s/it]Best trial: 43. Best value: 0.501926:  81%|████████  | 81/100 [07:14<01:27,  4.63s/it]Best trial: 43. Best value: 0.501926:  81%|████████  | 81/100 [07:19<01:27,  4.63s/it]Best trial: 43. Best value: 0.501926:  82%|████████▏ | 82/100 [07:19<01:22,  4.60s/it]Best trial: 43. Best value: 0.501926:  82%|████████▏ | 82/100 [07:24<01:22,  4.60s/it]Best trial: 43. Best value: 0.501926:  83%|████████▎ | 83/100 [07:24<01:19,  4.70s/it]Best trial: 43. Best value: 0.501926:  83%|████████▎ | 83/100 [07:26<01:19,  4.70s/it]Best trial: 43. Best value: 0.501926:  84%|████████▍ | 84/100 [07:26<01:03,  3.99s/it]Best trial: 43. Best value: 0.501926:  84%|████████▍ | 84/100 [07:30<01:03,  3.99s/it]Best trial: 43. Best value: 0.501926:  85%|████████▌ | 85/100 [07:30<00:58,  3.88s/it]Best trial: 43. Best value: 0.501926:  85%|████████▌ | 85/100 [07:33<00:58,  3.88s/it]Best trial: 43. Best value: 0.501926:  86%|████████▌ | 86/100 [07:33<00:52,  3.77s/it]Best trial: 43. Best value: 0.501926:  86%|████████▌ | 86/100 [07:38<00:52,  3.77s/it]Best trial: 43. Best value: 0.501926:  87%|████████▋ | 87/100 [07:38<00:51,  3.94s/it]Best trial: 43. Best value: 0.501926:  87%|████████▋ | 87/100 [07:41<00:51,  3.94s/it]Best trial: 43. Best value: 0.501926:  88%|████████▊ | 88/100 [07:41<00:46,  3.88s/it]Best trial: 43. Best value: 0.501926:  88%|████████▊ | 88/100 [07:54<00:46,  3.88s/it]Best trial: 43. Best value: 0.501926:  89%|████████▉ | 89/100 [07:54<01:12,  6.61s/it]Best trial: 43. Best value: 0.501926:  89%|████████▉ | 89/100 [07:58<01:12,  6.61s/it]Best trial: 43. Best value: 0.501926:  90%|█████████ | 90/100 [07:58<00:58,  5.82s/it]Best trial: 43. Best value: 0.501926:  90%|█████████ | 90/100 [08:04<00:58,  5.82s/it]Best trial: 43. Best value: 0.501926:  91%|█████████ | 91/100 [08:04<00:51,  5.72s/it]Best trial: 43. Best value: 0.501926:  91%|█████████ | 91/100 [08:10<00:51,  5.72s/it]Best trial: 43. Best value: 0.501926:  92%|█████████▏| 92/100 [08:10<00:46,  5.76s/it]Best trial: 43. Best value: 0.501926:  92%|█████████▏| 92/100 [08:15<00:46,  5.76s/it]Best trial: 43. Best value: 0.501926:  93%|█████████▎| 93/100 [08:15<00:39,  5.64s/it]Best trial: 43. Best value: 0.501926:  93%|█████████▎| 93/100 [08:23<00:39,  5.64s/it]Best trial: 43. Best value: 0.501926:  94%|█████████▍| 94/100 [08:23<00:37,  6.26s/it]Best trial: 43. Best value: 0.501926:  94%|█████████▍| 94/100 [08:28<00:37,  6.26s/it]Best trial: 43. Best value: 0.501926:  95%|█████████▌| 95/100 [08:28<00:29,  5.81s/it]Best trial: 43. Best value: 0.501926:  95%|█████████▌| 95/100 [08:33<00:29,  5.81s/it]Best trial: 43. Best value: 0.501926:  96%|█████████▌| 96/100 [08:33<00:22,  5.72s/it]Best trial: 43. Best value: 0.501926:  96%|█████████▌| 96/100 [08:38<00:22,  5.72s/it]Best trial: 43. Best value: 0.501926:  97%|█████████▋| 97/100 [08:38<00:16,  5.57s/it]Best trial: 43. Best value: 0.501926:  97%|█████████▋| 97/100 [08:42<00:16,  5.57s/it]Best trial: 43. Best value: 0.501926:  98%|█████████▊| 98/100 [08:42<00:10,  5.09s/it]Best trial: 43. Best value: 0.501926:  98%|█████████▊| 98/100 [08:50<00:10,  5.09s/it]Best trial: 43. Best value: 0.501926:  99%|█████████▉| 99/100 [08:50<00:05,  5.94s/it]Best trial: 43. Best value: 0.501926:  99%|█████████▉| 99/100 [08:57<00:05,  5.94s/it]Best trial: 43. Best value: 0.501926: 100%|██████████| 100/100 [08:57<00:00,  6.18s/it]Best trial: 43. Best value: 0.501926: 100%|██████████| 100/100 [08:57<00:00,  5.37s/it]
2025-11-30 19:24:17,936 - INFO - HPO Complete. Best AUPRC: 0.5019
2025-11-30 19:24:17,936 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.020024916747154363, 'max_depth': 8, 'subsample': 0.6694570053170835, 'colsample_bytree': 0.7919926436825089, 'gamma': 3.3040229268752785, 'reg_lambda': 0.3020336791535022, 'reg_alpha': 1.8891195178445772e-06}
2025-11-30 19:24:17,937 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 19:24:19,964 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: co2_only
2025-11-30 19:24:19,964 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:24:20,171 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:24:20,196 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:24:20,200 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:24:20,200 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 19:24:20,200 - INFO - Training model...
2025-11-30 19:24:22,088 - INFO - Evaluating model with bootstrapping...
2025-11-30 19:24:27,090 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 19:24:27,091 - INFO - AUROC: 0.7128 (0.6792 - 0.7630)
2025-11-30 19:24:27,091 - INFO - AUPRC: 0.4253 (0.3686 - 0.5165)
2025-11-30 19:24:27,091 - INFO - Brier Score: 0.1704 (0.1571 - 0.1820)
2025-11-30 19:24:27,091 - INFO - Accuracy: 0.6777 (0.6405 - 0.7841)
2025-11-30 19:24:27,091 - INFO - Precision: 0.3810 (0.3421 - 0.5170)
2025-11-30 19:24:27,091 - INFO - Sensitivity (Recall): 0.6582 (0.4764 - 0.7410)
2025-11-30 19:24:27,091 - INFO - F1-Score: 0.4826 (0.4390 - 0.5327)
2025-11-30 19:24:27,091 - INFO - Best Threshold: 0.3400 (0.3060 - 0.4720)
2025-11-30 19:24:27,092 - INFO - Specificity: 0.6835 (0.6194 - 0.8647)
2025-11-30 19:24:27,107 - INFO - Calculating SHAP values...
2025-11-30 19:24:28,319 - INFO - SHAP plots saved.
2025-11-30 19:24:28,320 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 19:24:29,526 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: awp_only
2025-11-30 19:24:29,526 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:24:29,723 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:24:29,744 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:24:29,749 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:24:29,749 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.501371:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.501371:   1%|          | 1/100 [00:06<10:48,  6.55s/it]Best trial: 1. Best value: 0.518022:   1%|          | 1/100 [00:08<10:48,  6.55s/it]Best trial: 1. Best value: 0.518022:   2%|▏         | 2/100 [00:08<06:09,  3.77s/it]Best trial: 1. Best value: 0.518022:   2%|▏         | 2/100 [00:11<06:09,  3.77s/it]Best trial: 1. Best value: 0.518022:   3%|▎         | 3/100 [00:11<05:32,  3.43s/it]Best trial: 1. Best value: 0.518022:   3%|▎         | 3/100 [00:17<05:32,  3.43s/it]Best trial: 1. Best value: 0.518022:   4%|▍         | 4/100 [00:17<07:11,  4.50s/it]Best trial: 1. Best value: 0.518022:   4%|▍         | 4/100 [00:25<07:11,  4.50s/it]Best trial: 1. Best value: 0.518022:   5%|▌         | 5/100 [00:25<09:15,  5.85s/it]Best trial: 1. Best value: 0.518022:   5%|▌         | 5/100 [00:29<09:15,  5.85s/it]Best trial: 1. Best value: 0.518022:   6%|▌         | 6/100 [00:29<08:16,  5.28s/it]Best trial: 1. Best value: 0.518022:   6%|▌         | 6/100 [00:31<08:16,  5.28s/it]Best trial: 1. Best value: 0.518022:   7%|▋         | 7/100 [00:31<06:29,  4.19s/it]Best trial: 7. Best value: 0.523992:   7%|▋         | 7/100 [00:34<06:29,  4.19s/it]Best trial: 7. Best value: 0.523992:   8%|▊         | 8/100 [00:34<05:27,  3.56s/it]Best trial: 7. Best value: 0.523992:   8%|▊         | 8/100 [00:36<05:27,  3.56s/it]Best trial: 7. Best value: 0.523992:   9%|▉         | 9/100 [00:36<04:55,  3.24s/it]Best trial: 7. Best value: 0.523992:   9%|▉         | 9/100 [00:38<04:55,  3.24s/it]Best trial: 7. Best value: 0.523992:  10%|█         | 10/100 [00:38<04:20,  2.89s/it]Best trial: 7. Best value: 0.523992:  10%|█         | 10/100 [00:42<04:20,  2.89s/it]Best trial: 7. Best value: 0.523992:  11%|█         | 11/100 [00:42<04:46,  3.22s/it]Best trial: 7. Best value: 0.523992:  11%|█         | 11/100 [00:45<04:46,  3.22s/it]Best trial: 7. Best value: 0.523992:  12%|█▏        | 12/100 [00:45<04:39,  3.18s/it]Best trial: 7. Best value: 0.523992:  12%|█▏        | 12/100 [00:48<04:39,  3.18s/it]Best trial: 7. Best value: 0.523992:  13%|█▎        | 13/100 [00:48<04:30,  3.11s/it]Best trial: 7. Best value: 0.523992:  13%|█▎        | 13/100 [00:52<04:30,  3.11s/it]Best trial: 7. Best value: 0.523992:  14%|█▍        | 14/100 [00:52<04:37,  3.22s/it]Best trial: 7. Best value: 0.523992:  14%|█▍        | 14/100 [00:56<04:37,  3.22s/it]Best trial: 7. Best value: 0.523992:  15%|█▌        | 15/100 [00:56<04:58,  3.51s/it]Best trial: 7. Best value: 0.523992:  15%|█▌        | 15/100 [01:09<04:58,  3.51s/it]Best trial: 7. Best value: 0.523992:  16%|█▌        | 16/100 [01:09<09:01,  6.45s/it]Best trial: 7. Best value: 0.523992:  16%|█▌        | 16/100 [01:13<09:01,  6.45s/it]Best trial: 7. Best value: 0.523992:  17%|█▋        | 17/100 [01:13<07:48,  5.64s/it]Best trial: 7. Best value: 0.523992:  17%|█▋        | 17/100 [01:22<07:48,  5.64s/it]Best trial: 7. Best value: 0.523992:  18%|█▊        | 18/100 [01:22<09:11,  6.73s/it]Best trial: 7. Best value: 0.523992:  18%|█▊        | 18/100 [01:25<09:11,  6.73s/it]Best trial: 7. Best value: 0.523992:  19%|█▉        | 19/100 [01:25<07:29,  5.55s/it]Best trial: 7. Best value: 0.523992:  19%|█▉        | 19/100 [01:27<07:29,  5.55s/it]Best trial: 7. Best value: 0.523992:  20%|██        | 20/100 [01:27<05:47,  4.34s/it]Best trial: 7. Best value: 0.523992:  20%|██        | 20/100 [01:29<05:47,  4.34s/it]Best trial: 7. Best value: 0.523992:  21%|██        | 21/100 [01:29<05:06,  3.88s/it]Best trial: 7. Best value: 0.523992:  21%|██        | 21/100 [01:33<05:06,  3.88s/it]Best trial: 7. Best value: 0.523992:  22%|██▏       | 22/100 [01:33<04:51,  3.74s/it]Best trial: 7. Best value: 0.523992:  22%|██▏       | 22/100 [01:36<04:51,  3.74s/it]Best trial: 7. Best value: 0.523992:  23%|██▎       | 23/100 [01:36<04:42,  3.67s/it]Best trial: 7. Best value: 0.523992:  23%|██▎       | 23/100 [01:39<04:42,  3.67s/it]Best trial: 7. Best value: 0.523992:  24%|██▍       | 24/100 [01:39<04:09,  3.28s/it]Best trial: 7. Best value: 0.523992:  24%|██▍       | 24/100 [01:43<04:09,  3.28s/it]Best trial: 7. Best value: 0.523992:  25%|██▌       | 25/100 [01:43<04:25,  3.55s/it]Best trial: 7. Best value: 0.523992:  25%|██▌       | 25/100 [01:50<04:25,  3.55s/it]Best trial: 7. Best value: 0.523992:  26%|██▌       | 26/100 [01:50<05:51,  4.75s/it]Best trial: 7. Best value: 0.523992:  26%|██▌       | 26/100 [01:53<05:51,  4.75s/it]Best trial: 7. Best value: 0.523992:  27%|██▋       | 27/100 [01:53<05:06,  4.20s/it]Best trial: 7. Best value: 0.523992:  27%|██▋       | 27/100 [02:02<05:06,  4.20s/it]Best trial: 7. Best value: 0.523992:  28%|██▊       | 28/100 [02:02<06:45,  5.64s/it]Best trial: 7. Best value: 0.523992:  28%|██▊       | 28/100 [02:06<06:45,  5.64s/it]Best trial: 7. Best value: 0.523992:  29%|██▉       | 29/100 [02:06<06:08,  5.19s/it]Best trial: 7. Best value: 0.523992:  29%|██▉       | 29/100 [02:11<06:08,  5.19s/it]Best trial: 7. Best value: 0.523992:  30%|███       | 30/100 [02:11<05:56,  5.10s/it]Best trial: 7. Best value: 0.523992:  30%|███       | 30/100 [02:20<05:56,  5.10s/it]Best trial: 7. Best value: 0.523992:  31%|███       | 31/100 [02:20<07:01,  6.11s/it]Best trial: 31. Best value: 0.529398:  31%|███       | 31/100 [02:25<07:01,  6.11s/it]Best trial: 31. Best value: 0.529398:  32%|███▏      | 32/100 [02:25<06:40,  5.88s/it]Best trial: 31. Best value: 0.529398:  32%|███▏      | 32/100 [02:31<06:40,  5.88s/it]Best trial: 31. Best value: 0.529398:  33%|███▎      | 33/100 [02:31<06:41,  5.99s/it]Best trial: 31. Best value: 0.529398:  33%|███▎      | 33/100 [02:35<06:41,  5.99s/it]Best trial: 31. Best value: 0.529398:  34%|███▍      | 34/100 [02:35<05:47,  5.26s/it]Best trial: 31. Best value: 0.529398:  34%|███▍      | 34/100 [02:41<05:47,  5.26s/it]Best trial: 31. Best value: 0.529398:  35%|███▌      | 35/100 [02:41<06:04,  5.61s/it]Best trial: 31. Best value: 0.529398:  35%|███▌      | 35/100 [02:44<06:04,  5.61s/it]Best trial: 31. Best value: 0.529398:  36%|███▌      | 36/100 [02:44<04:59,  4.69s/it]Best trial: 31. Best value: 0.529398:  36%|███▌      | 36/100 [02:50<04:59,  4.69s/it]Best trial: 31. Best value: 0.529398:  37%|███▋      | 37/100 [02:50<05:29,  5.23s/it]Best trial: 31. Best value: 0.529398:  37%|███▋      | 37/100 [02:55<05:29,  5.23s/it]Best trial: 31. Best value: 0.529398:  38%|███▊      | 38/100 [02:55<05:18,  5.13s/it]Best trial: 38. Best value: 0.530827:  38%|███▊      | 38/100 [03:05<05:18,  5.13s/it]Best trial: 38. Best value: 0.530827:  39%|███▉      | 39/100 [03:05<06:33,  6.46s/it]Best trial: 38. Best value: 0.530827:  39%|███▉      | 39/100 [03:18<06:33,  6.46s/it]Best trial: 38. Best value: 0.530827:  40%|████      | 40/100 [03:18<08:28,  8.47s/it]Best trial: 38. Best value: 0.530827:  40%|████      | 40/100 [03:26<08:28,  8.47s/it]Best trial: 38. Best value: 0.530827:  41%|████      | 41/100 [03:26<08:14,  8.38s/it]Best trial: 41. Best value: 0.534183:  41%|████      | 41/100 [03:45<08:14,  8.38s/it]Best trial: 41. Best value: 0.534183:  42%|████▏     | 42/100 [03:45<11:01, 11.40s/it]Best trial: 41. Best value: 0.534183:  42%|████▏     | 42/100 [03:55<11:01, 11.40s/it]Best trial: 41. Best value: 0.534183:  43%|████▎     | 43/100 [03:55<10:34, 11.13s/it]Best trial: 41. Best value: 0.534183:  43%|████▎     | 43/100 [04:06<10:34, 11.13s/it]Best trial: 41. Best value: 0.534183:  44%|████▍     | 44/100 [04:06<10:18, 11.04s/it]Best trial: 41. Best value: 0.534183:  44%|████▍     | 44/100 [04:20<10:18, 11.04s/it]Best trial: 41. Best value: 0.534183:  45%|████▌     | 45/100 [04:20<10:52, 11.87s/it]Best trial: 41. Best value: 0.534183:  45%|████▌     | 45/100 [04:26<10:52, 11.87s/it]Best trial: 41. Best value: 0.534183:  46%|████▌     | 46/100 [04:26<09:06, 10.12s/it]Best trial: 41. Best value: 0.534183:  46%|████▌     | 46/100 [04:36<09:06, 10.12s/it]Best trial: 41. Best value: 0.534183:  47%|████▋     | 47/100 [04:36<08:52, 10.06s/it]Best trial: 41. Best value: 0.534183:  47%|████▋     | 47/100 [04:46<08:52, 10.06s/it]Best trial: 41. Best value: 0.534183:  48%|████▊     | 48/100 [04:46<08:53, 10.27s/it]Best trial: 41. Best value: 0.534183:  48%|████▊     | 48/100 [04:58<08:53, 10.27s/it]Best trial: 41. Best value: 0.534183:  49%|████▉     | 49/100 [04:58<09:03, 10.65s/it]Best trial: 41. Best value: 0.534183:  49%|████▉     | 49/100 [05:05<09:03, 10.65s/it]Best trial: 41. Best value: 0.534183:  50%|█████     | 50/100 [05:05<08:05,  9.71s/it]Best trial: 41. Best value: 0.534183:  50%|█████     | 50/100 [05:15<08:05,  9.71s/it]Best trial: 41. Best value: 0.534183:  51%|█████     | 51/100 [05:15<07:57,  9.75s/it]Best trial: 41. Best value: 0.534183:  51%|█████     | 51/100 [05:22<07:57,  9.75s/it]Best trial: 41. Best value: 0.534183:  52%|█████▏    | 52/100 [05:22<07:07,  8.91s/it]Best trial: 41. Best value: 0.534183:  52%|█████▏    | 52/100 [05:32<07:07,  8.91s/it]Best trial: 41. Best value: 0.534183:  53%|█████▎    | 53/100 [05:32<07:11,  9.18s/it]Best trial: 41. Best value: 0.534183:  53%|█████▎    | 53/100 [05:42<07:11,  9.18s/it]Best trial: 41. Best value: 0.534183:  54%|█████▍    | 54/100 [05:42<07:18,  9.53s/it]Best trial: 41. Best value: 0.534183:  54%|█████▍    | 54/100 [05:50<07:18,  9.53s/it]Best trial: 41. Best value: 0.534183:  55%|█████▌    | 55/100 [05:50<06:40,  8.90s/it]Best trial: 41. Best value: 0.534183:  55%|█████▌    | 55/100 [05:56<06:40,  8.90s/it]Best trial: 41. Best value: 0.534183:  56%|█████▌    | 56/100 [05:56<06:00,  8.19s/it]Best trial: 41. Best value: 0.534183:  56%|█████▌    | 56/100 [06:04<06:00,  8.19s/it]Best trial: 41. Best value: 0.534183:  57%|█████▋    | 57/100 [06:04<05:42,  7.97s/it]Best trial: 41. Best value: 0.534183:  57%|█████▋    | 57/100 [06:11<05:42,  7.97s/it]Best trial: 41. Best value: 0.534183:  58%|█████▊    | 58/100 [06:11<05:23,  7.71s/it]Best trial: 58. Best value: 0.535439:  58%|█████▊    | 58/100 [06:19<05:23,  7.71s/it]Best trial: 58. Best value: 0.535439:  59%|█████▉    | 59/100 [06:19<05:20,  7.81s/it]Best trial: 58. Best value: 0.535439:  59%|█████▉    | 59/100 [06:25<05:20,  7.81s/it]Best trial: 58. Best value: 0.535439:  60%|██████    | 60/100 [06:25<04:49,  7.24s/it]Best trial: 58. Best value: 0.535439:  60%|██████    | 60/100 [06:36<04:49,  7.24s/it]Best trial: 58. Best value: 0.535439:  61%|██████    | 61/100 [06:36<05:28,  8.43s/it]Best trial: 58. Best value: 0.535439:  61%|██████    | 61/100 [06:44<05:28,  8.43s/it]Best trial: 58. Best value: 0.535439:  62%|██████▏   | 62/100 [06:44<05:15,  8.31s/it]Best trial: 58. Best value: 0.535439:  62%|██████▏   | 62/100 [06:51<05:15,  8.31s/it]Best trial: 58. Best value: 0.535439:  63%|██████▎   | 63/100 [06:51<04:49,  7.83s/it]Best trial: 58. Best value: 0.535439:  63%|██████▎   | 63/100 [06:59<04:49,  7.83s/it]Best trial: 58. Best value: 0.535439:  64%|██████▍   | 64/100 [06:59<04:40,  7.78s/it]Best trial: 58. Best value: 0.535439:  64%|██████▍   | 64/100 [07:05<04:40,  7.78s/it]Best trial: 58. Best value: 0.535439:  65%|██████▌   | 65/100 [07:05<04:23,  7.52s/it]Best trial: 58. Best value: 0.535439:  65%|██████▌   | 65/100 [07:20<04:23,  7.52s/it]Best trial: 58. Best value: 0.535439:  66%|██████▌   | 66/100 [07:20<05:25,  9.58s/it]Best trial: 58. Best value: 0.535439:  66%|██████▌   | 66/100 [07:27<05:25,  9.58s/it]Best trial: 58. Best value: 0.535439:  67%|██████▋   | 67/100 [07:27<04:50,  8.80s/it]Best trial: 58. Best value: 0.535439:  67%|██████▋   | 67/100 [07:35<04:50,  8.80s/it]Best trial: 58. Best value: 0.535439:  68%|██████▊   | 68/100 [07:35<04:34,  8.58s/it]Best trial: 58. Best value: 0.535439:  68%|██████▊   | 68/100 [07:46<04:34,  8.58s/it]Best trial: 58. Best value: 0.535439:  69%|██████▉   | 69/100 [07:46<04:53,  9.48s/it]Best trial: 58. Best value: 0.535439:  69%|██████▉   | 69/100 [07:56<04:53,  9.48s/it]Best trial: 58. Best value: 0.535439:  70%|███████   | 70/100 [07:56<04:46,  9.56s/it]Best trial: 58. Best value: 0.535439:  70%|███████   | 70/100 [08:06<04:46,  9.56s/it]Best trial: 58. Best value: 0.535439:  71%|███████   | 71/100 [08:06<04:40,  9.67s/it]Best trial: 58. Best value: 0.535439:  71%|███████   | 71/100 [08:16<04:40,  9.67s/it]Best trial: 58. Best value: 0.535439:  72%|███████▏  | 72/100 [08:16<04:35,  9.85s/it]Best trial: 58. Best value: 0.535439:  72%|███████▏  | 72/100 [08:24<04:35,  9.85s/it]Best trial: 58. Best value: 0.535439:  73%|███████▎  | 73/100 [08:24<04:09,  9.23s/it]Best trial: 58. Best value: 0.535439:  73%|███████▎  | 73/100 [08:30<04:09,  9.23s/it]Best trial: 58. Best value: 0.535439:  74%|███████▍  | 74/100 [08:30<03:30,  8.09s/it]Best trial: 58. Best value: 0.535439:  74%|███████▍  | 74/100 [08:38<03:30,  8.09s/it]Best trial: 58. Best value: 0.535439:  75%|███████▌  | 75/100 [08:38<03:21,  8.07s/it]Best trial: 58. Best value: 0.535439:  75%|███████▌  | 75/100 [08:50<03:21,  8.07s/it]Best trial: 58. Best value: 0.535439:  76%|███████▌  | 76/100 [08:50<03:42,  9.28s/it]Best trial: 58. Best value: 0.535439:  76%|███████▌  | 76/100 [08:55<03:42,  9.28s/it]Best trial: 58. Best value: 0.535439:  77%|███████▋  | 77/100 [08:55<03:02,  7.94s/it]Best trial: 58. Best value: 0.535439:  77%|███████▋  | 77/100 [09:04<03:02,  7.94s/it]Best trial: 58. Best value: 0.535439:  78%|███████▊  | 78/100 [09:04<03:03,  8.36s/it]Best trial: 58. Best value: 0.535439:  78%|███████▊  | 78/100 [09:11<03:03,  8.36s/it]Best trial: 58. Best value: 0.535439:  79%|███████▉  | 79/100 [09:11<02:44,  7.84s/it]Best trial: 58. Best value: 0.535439:  79%|███████▉  | 79/100 [09:20<02:44,  7.84s/it]Best trial: 58. Best value: 0.535439:  80%|████████  | 80/100 [09:20<02:46,  8.34s/it]Best trial: 58. Best value: 0.535439:  80%|████████  | 80/100 [09:26<02:46,  8.34s/it]Best trial: 58. Best value: 0.535439:  81%|████████  | 81/100 [09:26<02:23,  7.53s/it]Best trial: 58. Best value: 0.535439:  81%|████████  | 81/100 [09:36<02:23,  7.53s/it]Best trial: 58. Best value: 0.535439:  82%|████████▏ | 82/100 [09:36<02:28,  8.26s/it]Best trial: 58. Best value: 0.535439:  82%|████████▏ | 82/100 [09:41<02:28,  8.26s/it]Best trial: 58. Best value: 0.535439:  83%|████████▎ | 83/100 [09:41<02:07,  7.51s/it]Best trial: 58. Best value: 0.535439:  83%|████████▎ | 83/100 [09:53<02:07,  7.51s/it]Best trial: 58. Best value: 0.535439:  84%|████████▍ | 84/100 [09:53<02:21,  8.86s/it]Best trial: 58. Best value: 0.535439:  84%|████████▍ | 84/100 [10:04<02:21,  8.86s/it]Best trial: 58. Best value: 0.535439:  85%|████████▌ | 85/100 [10:04<02:19,  9.27s/it]Best trial: 58. Best value: 0.535439:  85%|████████▌ | 85/100 [10:10<02:19,  9.27s/it]Best trial: 58. Best value: 0.535439:  86%|████████▌ | 86/100 [10:10<01:56,  8.32s/it]Best trial: 58. Best value: 0.535439:  86%|████████▌ | 86/100 [10:19<01:56,  8.32s/it]Best trial: 58. Best value: 0.535439:  87%|████████▋ | 87/100 [10:19<01:51,  8.60s/it]Best trial: 58. Best value: 0.535439:  87%|████████▋ | 87/100 [10:23<01:51,  8.60s/it]Best trial: 58. Best value: 0.535439:  88%|████████▊ | 88/100 [10:23<01:28,  7.34s/it]Best trial: 58. Best value: 0.535439:  88%|████████▊ | 88/100 [10:33<01:28,  7.34s/it]Best trial: 58. Best value: 0.535439:  89%|████████▉ | 89/100 [10:33<01:29,  8.11s/it]Best trial: 58. Best value: 0.535439:  89%|████████▉ | 89/100 [10:40<01:29,  8.11s/it]Best trial: 58. Best value: 0.535439:  90%|█████████ | 90/100 [10:40<01:17,  7.71s/it]Best trial: 58. Best value: 0.535439:  90%|█████████ | 90/100 [10:46<01:17,  7.71s/it]Best trial: 58. Best value: 0.535439:  91%|█████████ | 91/100 [10:46<01:04,  7.18s/it]Best trial: 58. Best value: 0.535439:  91%|█████████ | 91/100 [10:56<01:04,  7.18s/it]Best trial: 58. Best value: 0.535439:  92%|█████████▏| 92/100 [10:56<01:05,  8.16s/it]Best trial: 58. Best value: 0.535439:  92%|█████████▏| 92/100 [11:05<01:05,  8.16s/it]Best trial: 58. Best value: 0.535439:  93%|█████████▎| 93/100 [11:05<00:58,  8.40s/it]Best trial: 58. Best value: 0.535439:  93%|█████████▎| 93/100 [11:16<00:58,  8.40s/it]Best trial: 58. Best value: 0.535439:  94%|█████████▍| 94/100 [11:16<00:53,  8.92s/it]Best trial: 58. Best value: 0.535439:  94%|█████████▍| 94/100 [11:22<00:53,  8.92s/it]Best trial: 58. Best value: 0.535439:  95%|█████████▌| 95/100 [11:22<00:41,  8.25s/it]Best trial: 58. Best value: 0.535439:  95%|█████████▌| 95/100 [11:33<00:41,  8.25s/it]Best trial: 58. Best value: 0.535439:  96%|█████████▌| 96/100 [11:33<00:36,  9.15s/it]Best trial: 58. Best value: 0.535439:  96%|█████████▌| 96/100 [11:43<00:36,  9.15s/it]Best trial: 58. Best value: 0.535439:  97%|█████████▋| 97/100 [11:43<00:27,  9.28s/it]Best trial: 58. Best value: 0.535439:  97%|█████████▋| 97/100 [11:50<00:27,  9.28s/it]Best trial: 58. Best value: 0.535439:  98%|█████████▊| 98/100 [11:50<00:17,  8.63s/it]Best trial: 58. Best value: 0.535439:  98%|█████████▊| 98/100 [11:58<00:17,  8.63s/it]Best trial: 58. Best value: 0.535439:  99%|█████████▉| 99/100 [11:58<00:08,  8.40s/it]Best trial: 58. Best value: 0.535439:  99%|█████████▉| 99/100 [12:03<00:08,  8.40s/it]Best trial: 58. Best value: 0.535439: 100%|██████████| 100/100 [12:03<00:00,  7.40s/it]Best trial: 58. Best value: 0.535439: 100%|██████████| 100/100 [12:03<00:00,  7.24s/it]
2025-11-30 19:36:33,347 - INFO - HPO Complete. Best AUPRC: 0.5354
2025-11-30 19:36:33,347 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.03164014744065241, 'max_depth': 8, 'subsample': 0.8153780150578769, 'colsample_bytree': 0.986552427538441, 'gamma': 0.01811027269777926, 'reg_lambda': 2.043516779874685e-06, 'reg_alpha': 0.03994778573535091}
2025-11-30 19:36:33,347 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 19:36:35,176 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: awp_only
2025-11-30 19:36:35,176 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:36:35,377 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:36:35,397 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:36:35,400 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-11-30 19:36:35,400 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 19:36:35,401 - INFO - Training model...
2025-11-30 19:36:37,747 - INFO - Evaluating model with bootstrapping...
2025-11-30 19:36:42,789 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 19:36:42,790 - INFO - AUROC: 0.7230 (0.6703 - 0.7688)
2025-11-30 19:36:42,790 - INFO - AUPRC: 0.4513 (0.3777 - 0.5266)
2025-11-30 19:36:42,790 - INFO - Brier Score: 0.1645 (0.1518 - 0.1792)
2025-11-30 19:36:42,790 - INFO - Accuracy: 0.7283 (0.6023 - 0.7723)
2025-11-30 19:36:42,790 - INFO - Precision: 0.4292 (0.3177 - 0.5205)
2025-11-30 19:36:42,790 - INFO - Sensitivity (Recall): 0.5759 (0.4796 - 0.7540)
2025-11-30 19:36:42,790 - INFO - F1-Score: 0.4919 (0.4338 - 0.5510)
2025-11-30 19:36:42,790 - INFO - Best Threshold: 0.3200 (0.1780 - 0.4000)
2025-11-30 19:36:42,790 - INFO - Specificity: 0.7734 (0.5707 - 0.8481)
2025-11-30 19:36:42,807 - INFO - Calculating SHAP values...
2025-11-30 19:36:44,183 - INFO - SHAP plots saved.
2025-11-30 19:36:44,183 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 19:36:45,487 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: all_waveforms
2025-11-30 19:36:45,487 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 19:36:45,694 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 19:36:45,772 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 19:36:45,789 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 19:36:45,789 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.50446:   0%|          | 0/100 [00:48<?, ?it/s]Best trial: 0. Best value: 0.50446:   1%|          | 1/100 [00:48<1:20:25, 48.75s/it]Best trial: 0. Best value: 0.50446:   1%|          | 1/100 [00:58<1:20:25, 48.75s/it]Best trial: 0. Best value: 0.50446:   2%|▏         | 2/100 [00:58<41:53, 25.65s/it]  Best trial: 2. Best value: 0.506233:   2%|▏         | 2/100 [01:41<41:53, 25.65s/it]Best trial: 2. Best value: 0.506233:   3%|▎         | 3/100 [01:41<54:08, 33.49s/it]Best trial: 3. Best value: 0.520891:   3%|▎         | 3/100 [02:16<54:08, 33.49s/it]Best trial: 3. Best value: 0.520891:   4%|▍         | 4/100 [02:16<54:56, 34.34s/it]Best trial: 4. Best value: 0.54258:   4%|▍         | 4/100 [02:30<54:56, 34.34s/it] Best trial: 4. Best value: 0.54258:   5%|▌         | 5/100 [02:30<42:25, 26.80s/it]Best trial: 4. Best value: 0.54258:   5%|▌         | 5/100 [02:41<42:25, 26.80s/it]Best trial: 4. Best value: 0.54258:   6%|▌         | 6/100 [02:41<33:39, 21.48s/it]Best trial: 4. Best value: 0.54258:   6%|▌         | 6/100 [03:09<33:39, 21.48s/it]Best trial: 4. Best value: 0.54258:   7%|▋         | 7/100 [03:09<36:34, 23.59s/it]Best trial: 7. Best value: 0.542865:   7%|▋         | 7/100 [04:07<36:34, 23.59s/it]Best trial: 7. Best value: 0.542865:   8%|▊         | 8/100 [04:07<53:08, 34.66s/it]Best trial: 7. Best value: 0.542865:   8%|▊         | 8/100 [04:32<53:08, 34.66s/it]Best trial: 7. Best value: 0.542865:   9%|▉         | 9/100 [04:32<48:08, 31.74s/it]Best trial: 9. Best value: 0.548882:   9%|▉         | 9/100 [04:38<48:08, 31.74s/it]Best trial: 9. Best value: 0.548882:  10%|█         | 10/100 [04:38<35:31, 23.69s/it]Best trial: 9. Best value: 0.548882:  10%|█         | 10/100 [04:52<35:31, 23.69s/it]Best trial: 9. Best value: 0.548882:  11%|█         | 11/100 [04:52<30:36, 20.64s/it]Best trial: 11. Best value: 0.559699:  11%|█         | 11/100 [05:04<30:36, 20.64s/it]Best trial: 11. Best value: 0.559699:  12%|█▏        | 12/100 [05:04<26:21, 17.97s/it]Best trial: 11. Best value: 0.559699:  12%|█▏        | 12/100 [05:13<26:21, 17.97s/it]Best trial: 11. Best value: 0.559699:  13%|█▎        | 13/100 [05:13<22:07, 15.26s/it]Best trial: 11. Best value: 0.559699:  13%|█▎        | 13/100 [05:20<22:07, 15.26s/it]Best trial: 11. Best value: 0.559699:  14%|█▍        | 14/100 [05:20<18:32, 12.94s/it]Best trial: 11. Best value: 0.559699:  14%|█▍        | 14/100 [05:30<18:32, 12.94s/it]Best trial: 11. Best value: 0.559699:  15%|█▌        | 15/100 [05:30<16:45, 11.83s/it]Best trial: 11. Best value: 0.559699:  15%|█▌        | 15/100 [05:53<16:45, 11.83s/it]Best trial: 11. Best value: 0.559699:  16%|█▌        | 16/100 [05:53<21:39, 15.47s/it]Best trial: 11. Best value: 0.559699:  16%|█▌        | 16/100 [06:02<21:39, 15.47s/it]Best trial: 11. Best value: 0.559699:  17%|█▋        | 17/100 [06:02<18:41, 13.51s/it]Best trial: 11. Best value: 0.559699:  17%|█▋        | 17/100 [06:15<18:41, 13.51s/it]Best trial: 11. Best value: 0.559699:  18%|█▊        | 18/100 [06:15<18:06, 13.25s/it]Best trial: 11. Best value: 0.559699:  18%|█▊        | 18/100 [06:31<18:06, 13.25s/it]Best trial: 11. Best value: 0.559699:  19%|█▉        | 19/100 [06:31<19:06, 14.15s/it]Best trial: 11. Best value: 0.559699:  19%|█▉        | 19/100 [06:58<19:06, 14.15s/it]Best trial: 11. Best value: 0.559699:  20%|██        | 20/100 [06:58<23:59, 18.00s/it]Best trial: 11. Best value: 0.559699:  20%|██        | 20/100 [07:07<23:59, 18.00s/it]Best trial: 11. Best value: 0.559699:  21%|██        | 21/100 [07:07<20:12, 15.34s/it]Best trial: 11. Best value: 0.559699:  21%|██        | 21/100 [07:16<20:12, 15.34s/it]Best trial: 11. Best value: 0.559699:  22%|██▏       | 22/100 [07:16<17:29, 13.45s/it]Best trial: 11. Best value: 0.559699:  22%|██▏       | 22/100 [07:33<17:29, 13.45s/it]Best trial: 11. Best value: 0.559699:  23%|██▎       | 23/100 [07:33<18:21, 14.31s/it]Best trial: 11. Best value: 0.559699:  23%|██▎       | 23/100 [07:48<18:21, 14.31s/it]Best trial: 11. Best value: 0.559699:  24%|██▍       | 24/100 [07:48<18:38, 14.72s/it]Best trial: 11. Best value: 0.559699:  24%|██▍       | 24/100 [08:14<18:38, 14.72s/it]Best trial: 11. Best value: 0.559699:  25%|██▌       | 25/100 [08:14<22:28, 17.97s/it]Best trial: 11. Best value: 0.559699:  25%|██▌       | 25/100 [08:25<22:28, 17.97s/it]Best trial: 11. Best value: 0.559699:  26%|██▌       | 26/100 [08:25<19:31, 15.84s/it]Best trial: 11. Best value: 0.559699:  26%|██▌       | 26/100 [08:34<19:31, 15.84s/it]Best trial: 11. Best value: 0.559699:  27%|██▋       | 27/100 [08:34<16:55, 13.91s/it]Best trial: 11. Best value: 0.559699:  27%|██▋       | 27/100 [08:45<16:55, 13.91s/it]Best trial: 11. Best value: 0.559699:  28%|██▊       | 28/100 [08:45<15:42, 13.09s/it]Best trial: 11. Best value: 0.559699:  28%|██▊       | 28/100 [09:05<15:42, 13.09s/it]Best trial: 11. Best value: 0.559699:  29%|██▉       | 29/100 [09:05<17:53, 15.12s/it]Best trial: 11. Best value: 0.559699:  29%|██▉       | 29/100 [09:34<17:53, 15.12s/it]Best trial: 11. Best value: 0.559699:  30%|███       | 30/100 [09:34<22:33, 19.34s/it]Best trial: 11. Best value: 0.559699:  30%|███       | 30/100 [09:41<22:33, 19.34s/it]Best trial: 11. Best value: 0.559699:  31%|███       | 31/100 [09:41<17:50, 15.51s/it]Best trial: 31. Best value: 0.559831:  31%|███       | 31/100 [09:52<17:50, 15.51s/it]Best trial: 31. Best value: 0.559831:  32%|███▏      | 32/100 [09:52<16:04, 14.19s/it]Best trial: 31. Best value: 0.559831:  32%|███▏      | 32/100 [10:06<16:04, 14.19s/it]Best trial: 31. Best value: 0.559831:  33%|███▎      | 33/100 [10:06<15:53, 14.24s/it]Best trial: 31. Best value: 0.559831:  33%|███▎      | 33/100 [10:17<15:53, 14.24s/it]Best trial: 31. Best value: 0.559831:  34%|███▍      | 34/100 [10:17<14:16, 12.98s/it]Best trial: 31. Best value: 0.559831:  34%|███▍      | 34/100 [10:27<14:16, 12.98s/it]Best trial: 31. Best value: 0.559831:  35%|███▌      | 35/100 [10:27<13:23, 12.37s/it]Best trial: 31. Best value: 0.559831:  35%|███▌      | 35/100 [10:36<13:23, 12.37s/it]Best trial: 31. Best value: 0.559831:  36%|███▌      | 36/100 [10:36<12:05, 11.33s/it]Best trial: 31. Best value: 0.559831:  36%|███▌      | 36/100 [10:41<12:05, 11.33s/it]Best trial: 31. Best value: 0.559831:  37%|███▋      | 37/100 [10:41<09:51,  9.39s/it]Best trial: 31. Best value: 0.559831:  37%|███▋      | 37/100 [10:53<09:51,  9.39s/it]Best trial: 31. Best value: 0.559831:  38%|███▊      | 38/100 [10:53<10:18,  9.97s/it]Best trial: 31. Best value: 0.559831:  38%|███▊      | 38/100 [11:31<10:18,  9.97s/it]Best trial: 31. Best value: 0.559831:  39%|███▉      | 39/100 [11:31<18:42, 18.39s/it]Best trial: 31. Best value: 0.559831:  39%|███▉      | 39/100 [11:42<18:42, 18.39s/it]Best trial: 31. Best value: 0.559831:  40%|████      | 40/100 [11:42<16:20, 16.34s/it]Best trial: 31. Best value: 0.559831:  40%|████      | 40/100 [11:54<16:20, 16.34s/it]Best trial: 31. Best value: 0.559831:  41%|████      | 41/100 [11:54<14:52, 15.13s/it]Best trial: 31. Best value: 0.559831:  41%|████      | 41/100 [12:02<14:52, 15.13s/it]Best trial: 31. Best value: 0.559831:  42%|████▏     | 42/100 [12:02<12:29, 12.93s/it]Best trial: 42. Best value: 0.560839:  42%|████▏     | 42/100 [12:15<12:29, 12.93s/it]Best trial: 42. Best value: 0.560839:  43%|████▎     | 43/100 [12:15<12:08, 12.79s/it]Best trial: 42. Best value: 0.560839:  43%|████▎     | 43/100 [12:25<12:08, 12.79s/it]Best trial: 42. Best value: 0.560839:  44%|████▍     | 44/100 [12:25<11:17, 12.10s/it]Best trial: 42. Best value: 0.560839:  44%|████▍     | 44/100 [12:35<11:17, 12.10s/it]Best trial: 42. Best value: 0.560839:  45%|████▌     | 45/100 [12:35<10:22, 11.31s/it]Best trial: 42. Best value: 0.560839:  45%|████▌     | 45/100 [12:41<10:22, 11.31s/it]Best trial: 42. Best value: 0.560839:  46%|████▌     | 46/100 [12:41<08:50,  9.82s/it]Best trial: 42. Best value: 0.560839:  46%|████▌     | 46/100 [12:50<08:50,  9.82s/it]Best trial: 42. Best value: 0.560839:  47%|████▋     | 47/100 [12:50<08:20,  9.44s/it]Best trial: 42. Best value: 0.560839:  47%|████▋     | 47/100 [12:58<08:20,  9.44s/it]Best trial: 42. Best value: 0.560839:  48%|████▊     | 48/100 [12:58<07:52,  9.09s/it]Best trial: 42. Best value: 0.560839:  48%|████▊     | 48/100 [13:05<07:52,  9.09s/it]Best trial: 42. Best value: 0.560839:  49%|████▉     | 49/100 [13:05<07:15,  8.54s/it]Best trial: 42. Best value: 0.560839:  49%|████▉     | 49/100 [13:25<07:15,  8.54s/it]Best trial: 42. Best value: 0.560839:  50%|█████     | 50/100 [13:25<09:53, 11.86s/it]Best trial: 42. Best value: 0.560839:  50%|█████     | 50/100 [13:38<09:53, 11.86s/it]Best trial: 42. Best value: 0.560839:  51%|█████     | 51/100 [13:38<10:05, 12.35s/it]Best trial: 42. Best value: 0.560839:  51%|█████     | 51/100 [13:49<10:05, 12.35s/it]Best trial: 42. Best value: 0.560839:  52%|█████▏    | 52/100 [13:49<09:35, 11.99s/it]Best trial: 42. Best value: 0.560839:  52%|█████▏    | 52/100 [14:02<09:35, 11.99s/it]Best trial: 42. Best value: 0.560839:  53%|█████▎    | 53/100 [14:02<09:33, 12.20s/it]Best trial: 42. Best value: 0.560839:  53%|█████▎    | 53/100 [14:15<09:33, 12.20s/it]Best trial: 42. Best value: 0.560839:  54%|█████▍    | 54/100 [14:15<09:25, 12.28s/it]Best trial: 42. Best value: 0.560839:  54%|█████▍    | 54/100 [14:21<09:25, 12.28s/it]Best trial: 42. Best value: 0.560839:  55%|█████▌    | 55/100 [14:21<07:59, 10.65s/it]Best trial: 42. Best value: 0.560839:  55%|█████▌    | 55/100 [14:37<07:59, 10.65s/it]Best trial: 42. Best value: 0.560839:  56%|█████▌    | 56/100 [14:37<08:58, 12.23s/it]Best trial: 42. Best value: 0.560839:  56%|█████▌    | 56/100 [14:57<08:58, 12.23s/it]Best trial: 42. Best value: 0.560839:  57%|█████▋    | 57/100 [14:57<10:24, 14.53s/it]Best trial: 42. Best value: 0.560839:  57%|█████▋    | 57/100 [15:06<10:24, 14.53s/it]Best trial: 42. Best value: 0.560839:  58%|█████▊    | 58/100 [15:06<09:03, 12.95s/it]Best trial: 42. Best value: 0.560839:  58%|█████▊    | 58/100 [15:39<09:03, 12.95s/it]Best trial: 42. Best value: 0.560839:  59%|█████▉    | 59/100 [15:39<12:54, 18.88s/it]Best trial: 42. Best value: 0.560839:  59%|█████▉    | 59/100 [16:27<12:54, 18.88s/it]Best trial: 42. Best value: 0.560839:  60%|██████    | 60/100 [16:27<18:25, 27.63s/it]Best trial: 42. Best value: 0.560839:  60%|██████    | 60/100 [17:00<18:25, 27.63s/it]Best trial: 42. Best value: 0.560839:  61%|██████    | 61/100 [17:00<19:02, 29.29s/it]Best trial: 42. Best value: 0.560839:  61%|██████    | 61/100 [17:22<19:02, 29.29s/it]Best trial: 42. Best value: 0.560839:  62%|██████▏   | 62/100 [17:22<17:09, 27.09s/it]Best trial: 42. Best value: 0.560839:  62%|██████▏   | 62/100 [17:34<17:09, 27.09s/it]Best trial: 42. Best value: 0.560839:  63%|██████▎   | 63/100 [17:34<13:54, 22.55s/it]Best trial: 42. Best value: 0.560839:  63%|██████▎   | 63/100 [18:13<13:54, 22.55s/it]Best trial: 42. Best value: 0.560839:  64%|██████▍   | 64/100 [18:13<16:27, 27.42s/it]Best trial: 42. Best value: 0.560839:  64%|██████▍   | 64/100 [18:29<16:27, 27.42s/it]Best trial: 42. Best value: 0.560839:  65%|██████▌   | 65/100 [18:29<13:54, 23.85s/it]Best trial: 42. Best value: 0.560839:  65%|██████▌   | 65/100 [18:49<13:54, 23.85s/it]Best trial: 42. Best value: 0.560839:  66%|██████▌   | 66/100 [18:49<12:52, 22.73s/it]Best trial: 42. Best value: 0.560839:  66%|██████▌   | 66/100 [19:06<12:52, 22.73s/it]Best trial: 42. Best value: 0.560839:  67%|██████▋   | 67/100 [19:06<11:37, 21.14s/it]Best trial: 42. Best value: 0.560839:  67%|██████▋   | 67/100 [19:31<11:37, 21.14s/it]Best trial: 42. Best value: 0.560839:  68%|██████▊   | 68/100 [19:31<11:54, 22.33s/it]Best trial: 42. Best value: 0.560839:  68%|██████▊   | 68/100 [19:41<11:54, 22.33s/it]Best trial: 42. Best value: 0.560839:  69%|██████▉   | 69/100 [19:41<09:31, 18.44s/it]Best trial: 42. Best value: 0.560839:  69%|██████▉   | 69/100 [20:11<09:31, 18.44s/it]Best trial: 42. Best value: 0.560839:  70%|███████   | 70/100 [20:11<11:00, 22.03s/it]Best trial: 42. Best value: 0.560839:  70%|███████   | 70/100 [20:21<11:00, 22.03s/it]Best trial: 42. Best value: 0.560839:  71%|███████   | 71/100 [20:21<08:57, 18.53s/it]Best trial: 42. Best value: 0.560839:  71%|███████   | 71/100 [20:40<08:57, 18.53s/it]Best trial: 42. Best value: 0.560839:  72%|███████▏  | 72/100 [20:40<08:38, 18.52s/it]Best trial: 42. Best value: 0.560839:  72%|███████▏  | 72/100 [20:58<08:38, 18.52s/it]Best trial: 42. Best value: 0.560839:  73%|███████▎  | 73/100 [20:58<08:18, 18.48s/it]Best trial: 42. Best value: 0.560839:  73%|███████▎  | 73/100 [21:44<08:18, 18.48s/it]Best trial: 42. Best value: 0.560839:  74%|███████▍  | 74/100 [21:44<11:33, 26.66s/it]Best trial: 42. Best value: 0.560839:  74%|███████▍  | 74/100 [21:59<11:33, 26.66s/it]Best trial: 42. Best value: 0.560839:  75%|███████▌  | 75/100 [21:59<09:37, 23.12s/it]Best trial: 42. Best value: 0.560839:  75%|███████▌  | 75/100 [22:06<09:37, 23.12s/it]Best trial: 42. Best value: 0.560839:  76%|███████▌  | 76/100 [22:06<07:16, 18.21s/it]Best trial: 42. Best value: 0.560839:  76%|███████▌  | 76/100 [22:16<07:16, 18.21s/it]Best trial: 42. Best value: 0.560839:  77%|███████▋  | 77/100 [22:16<06:05, 15.91s/it]Best trial: 42. Best value: 0.560839:  77%|███████▋  | 77/100 [23:09<06:05, 15.91s/it]Best trial: 42. Best value: 0.560839:  78%|███████▊  | 78/100 [23:09<09:54, 27.01s/it]Best trial: 42. Best value: 0.560839:  78%|███████▊  | 78/100 [23:16<09:54, 27.01s/it]Best trial: 42. Best value: 0.560839:  79%|███████▉  | 79/100 [23:16<07:21, 21.04s/it]Best trial: 42. Best value: 0.560839:  79%|███████▉  | 79/100 [23:25<07:21, 21.04s/it]Best trial: 42. Best value: 0.560839:  80%|████████  | 80/100 [23:25<05:49, 17.50s/it]Best trial: 42. Best value: 0.560839:  80%|████████  | 80/100 [23:37<05:49, 17.50s/it]Best trial: 42. Best value: 0.560839:  81%|████████  | 81/100 [23:37<04:57, 15.64s/it]Best trial: 42. Best value: 0.560839:  81%|████████  | 81/100 [23:47<04:57, 15.64s/it]Best trial: 42. Best value: 0.560839:  82%|████████▏ | 82/100 [23:47<04:10, 13.93s/it]Best trial: 42. Best value: 0.560839:  82%|████████▏ | 82/100 [23:56<04:10, 13.93s/it]Best trial: 42. Best value: 0.560839:  83%|████████▎ | 83/100 [23:56<03:31, 12.45s/it]Best trial: 42. Best value: 0.560839:  83%|████████▎ | 83/100 [24:06<03:31, 12.45s/it]Best trial: 42. Best value: 0.560839:  84%|████████▍ | 84/100 [24:06<03:10, 11.91s/it]Best trial: 42. Best value: 0.560839:  84%|████████▍ | 84/100 [24:15<03:10, 11.91s/it]Best trial: 42. Best value: 0.560839:  85%|████████▌ | 85/100 [24:15<02:43, 10.89s/it]Best trial: 42. Best value: 0.560839:  85%|████████▌ | 85/100 [24:24<02:43, 10.89s/it]Best trial: 42. Best value: 0.560839:  86%|████████▌ | 86/100 [24:24<02:26, 10.47s/it]Best trial: 42. Best value: 0.560839:  86%|████████▌ | 86/100 [24:35<02:26, 10.47s/it]Best trial: 42. Best value: 0.560839:  87%|████████▋ | 87/100 [24:35<02:15, 10.44s/it]Best trial: 42. Best value: 0.560839:  87%|████████▋ | 87/100 [24:52<02:15, 10.44s/it]Best trial: 42. Best value: 0.560839:  88%|████████▊ | 88/100 [24:52<02:31, 12.61s/it]Best trial: 42. Best value: 0.560839:  88%|████████▊ | 88/100 [25:08<02:31, 12.61s/it]Best trial: 42. Best value: 0.560839:  89%|████████▉ | 89/100 [25:08<02:27, 13.41s/it]Best trial: 42. Best value: 0.560839:  89%|████████▉ | 89/100 [25:14<02:27, 13.41s/it]Best trial: 42. Best value: 0.560839:  90%|█████████ | 90/100 [25:14<01:54, 11.43s/it]Best trial: 42. Best value: 0.560839:  90%|█████████ | 90/100 [25:26<01:54, 11.43s/it]Best trial: 42. Best value: 0.560839:  91%|█████████ | 91/100 [25:26<01:42, 11.38s/it]Best trial: 42. Best value: 0.560839:  91%|█████████ | 91/100 [25:35<01:42, 11.38s/it]Best trial: 42. Best value: 0.560839:  92%|█████████▏| 92/100 [25:35<01:26, 10.78s/it]Best trial: 42. Best value: 0.560839:  92%|█████████▏| 92/100 [25:45<01:26, 10.78s/it]Best trial: 42. Best value: 0.560839:  93%|█████████▎| 93/100 [25:45<01:13, 10.45s/it]Best trial: 42. Best value: 0.560839:  93%|█████████▎| 93/100 [25:53<01:13, 10.45s/it]Best trial: 42. Best value: 0.560839:  94%|█████████▍| 94/100 [25:53<00:59,  9.85s/it]Best trial: 42. Best value: 0.560839:  94%|█████████▍| 94/100 [26:00<00:59,  9.85s/it]Best trial: 42. Best value: 0.560839:  95%|█████████▌| 95/100 [26:00<00:45,  9.07s/it]Best trial: 42. Best value: 0.560839:  95%|█████████▌| 95/100 [26:08<00:45,  9.07s/it]Best trial: 42. Best value: 0.560839:  96%|█████████▌| 96/100 [26:08<00:34,  8.71s/it]Best trial: 42. Best value: 0.560839:  96%|█████████▌| 96/100 [26:18<00:34,  8.71s/it]Best trial: 42. Best value: 0.560839:  97%|█████████▋| 97/100 [26:18<00:27,  9.06s/it]Best trial: 42. Best value: 0.560839:  97%|█████████▋| 97/100 [26:26<00:27,  9.06s/it]Best trial: 42. Best value: 0.560839:  98%|█████████▊| 98/100 [26:26<00:17,  8.54s/it]Best trial: 42. Best value: 0.560839:  98%|█████████▊| 98/100 [26:34<00:17,  8.54s/it]Best trial: 42. Best value: 0.560839:  99%|█████████▉| 99/100 [26:34<00:08,  8.59s/it]Best trial: 42. Best value: 0.560839:  99%|█████████▉| 99/100 [26:40<00:08,  8.59s/it]Best trial: 42. Best value: 0.560839: 100%|██████████| 100/100 [26:40<00:00,  7.62s/it]Best trial: 42. Best value: 0.560839: 100%|██████████| 100/100 [26:40<00:00, 16.00s/it]
2025-11-30 20:03:25,871 - INFO - HPO Complete. Best AUPRC: 0.5608
2025-11-30 20:03:25,871 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.03002487800731053, 'max_depth': 4, 'subsample': 0.620276558631465, 'colsample_bytree': 0.7787810580902733, 'gamma': 4.2833958696645755, 'reg_lambda': 0.0006012478088131749, 'reg_alpha': 2.165105142011832e-08}
2025-11-30 20:03:25,871 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 20:03:27,773 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: all_waveforms
2025-11-30 20:03:27,773 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 20:03:27,968 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 20:03:28,034 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 20:03:28,046 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-11-30 20:03:28,047 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 20:03:28,047 - INFO - Training model...
2025-11-30 20:03:35,187 - INFO - Evaluating model with bootstrapping...
2025-11-30 20:03:41,491 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 20:03:41,491 - INFO - AUROC: 0.7612 (0.7079 - 0.7958)
2025-11-30 20:03:41,491 - INFO - AUPRC: 0.4950 (0.3962 - 0.5712)
2025-11-30 20:03:41,491 - INFO - Brier Score: 0.1553 (0.1431 - 0.1717)
2025-11-30 20:03:41,491 - INFO - Accuracy: 0.7775 (0.7335 - 0.8107)
2025-11-30 20:03:41,491 - INFO - Precision: 0.5108 (0.4203 - 0.5747)
2025-11-30 20:03:41,491 - INFO - Sensitivity (Recall): 0.6013 (0.5402 - 0.7060)
2025-11-30 20:03:41,491 - INFO - F1-Score: 0.5523 (0.4940 - 0.6079)
2025-11-30 20:03:41,491 - INFO - Best Threshold: 0.4200 (0.3440 - 0.4280)
2025-11-30 20:03:41,491 - INFO - Specificity: 0.8296 (0.7628 - 0.8638)
2025-11-30 20:03:41,510 - INFO - Calculating SHAP values...
2025-11-30 20:03:42,724 - INFO - SHAP plots saved.
2025-11-30 20:03:42,726 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 20:03:43,911 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 20:03:43,911 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 20:03:44,109 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 20:03:44,192 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 20:03:44,215 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 20:03:44,215 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.568319:   0%|          | 0/100 [00:12<?, ?it/s]Best trial: 0. Best value: 0.568319:   1%|          | 1/100 [00:12<20:57, 12.70s/it]Best trial: 1. Best value: 0.571353:   1%|          | 1/100 [00:37<20:57, 12.70s/it]Best trial: 1. Best value: 0.571353:   2%|▏         | 2/100 [00:37<32:08, 19.68s/it]Best trial: 1. Best value: 0.571353:   2%|▏         | 2/100 [00:47<32:08, 19.68s/it]Best trial: 1. Best value: 0.571353:   3%|▎         | 3/100 [00:47<25:07, 15.54s/it]Best trial: 3. Best value: 0.611681:   3%|▎         | 3/100 [00:57<25:07, 15.54s/it]Best trial: 3. Best value: 0.611681:   4%|▍         | 4/100 [00:57<21:08, 13.21s/it]Best trial: 3. Best value: 0.611681:   4%|▍         | 4/100 [02:25<21:08, 13.21s/it]Best trial: 3. Best value: 0.611681:   5%|▌         | 5/100 [02:25<1:03:30, 40.11s/it]Best trial: 3. Best value: 0.611681:   5%|▌         | 5/100 [02:32<1:03:30, 40.11s/it]Best trial: 3. Best value: 0.611681:   6%|▌         | 6/100 [02:32<45:26, 29.00s/it]  Best trial: 3. Best value: 0.611681:   6%|▌         | 6/100 [02:58<45:26, 29.00s/it]Best trial: 3. Best value: 0.611681:   7%|▋         | 7/100 [02:58<43:21, 27.98s/it]Best trial: 3. Best value: 0.611681:   7%|▋         | 7/100 [03:14<43:21, 27.98s/it]Best trial: 3. Best value: 0.611681:   8%|▊         | 8/100 [03:14<36:56, 24.09s/it]Best trial: 3. Best value: 0.611681:   8%|▊         | 8/100 [03:41<36:56, 24.09s/it]Best trial: 3. Best value: 0.611681:   9%|▉         | 9/100 [03:41<38:11, 25.18s/it]Best trial: 3. Best value: 0.611681:   9%|▉         | 9/100 [04:06<38:11, 25.18s/it]Best trial: 3. Best value: 0.611681:  10%|█         | 10/100 [04:06<37:23, 24.93s/it]Best trial: 3. Best value: 0.611681:  10%|█         | 10/100 [04:21<37:23, 24.93s/it]Best trial: 3. Best value: 0.611681:  11%|█         | 11/100 [04:21<32:39, 22.02s/it]Best trial: 11. Best value: 0.614053:  11%|█         | 11/100 [04:36<32:39, 22.02s/it]Best trial: 11. Best value: 0.614053:  12%|█▏        | 12/100 [04:36<29:08, 19.87s/it]Best trial: 11. Best value: 0.614053:  12%|█▏        | 12/100 [05:14<29:08, 19.87s/it]Best trial: 11. Best value: 0.614053:  13%|█▎        | 13/100 [05:14<36:29, 25.16s/it]Best trial: 13. Best value: 0.628859:  13%|█▎        | 13/100 [06:08<36:29, 25.16s/it]Best trial: 13. Best value: 0.628859:  14%|█▍        | 14/100 [06:08<48:38, 33.93s/it]Best trial: 13. Best value: 0.628859:  14%|█▍        | 14/100 [06:48<48:38, 33.93s/it]Best trial: 13. Best value: 0.628859:  15%|█▌        | 15/100 [06:48<50:47, 35.86s/it]Best trial: 13. Best value: 0.628859:  15%|█▌        | 15/100 [07:33<50:47, 35.86s/it]Best trial: 13. Best value: 0.628859:  16%|█▌        | 16/100 [07:33<54:11, 38.70s/it]Best trial: 13. Best value: 0.628859:  16%|█▌        | 16/100 [08:21<54:11, 38.70s/it]Best trial: 13. Best value: 0.628859:  17%|█▋        | 17/100 [08:21<57:14, 41.37s/it]Best trial: 13. Best value: 0.628859:  17%|█▋        | 17/100 [09:19<57:14, 41.37s/it]Best trial: 13. Best value: 0.628859:  18%|█▊        | 18/100 [09:19<1:03:28, 46.45s/it]Best trial: 13. Best value: 0.628859:  18%|█▊        | 18/100 [10:05<1:03:28, 46.45s/it]Best trial: 13. Best value: 0.628859:  19%|█▉        | 19/100 [10:05<1:02:18, 46.16s/it]Best trial: 19. Best value: 0.630838:  19%|█▉        | 19/100 [10:41<1:02:18, 46.16s/it]Best trial: 19. Best value: 0.630838:  20%|██        | 20/100 [10:41<57:30, 43.14s/it]  Best trial: 19. Best value: 0.630838:  20%|██        | 20/100 [11:22<57:30, 43.14s/it]Best trial: 19. Best value: 0.630838:  21%|██        | 21/100 [11:22<55:51, 42.43s/it]Best trial: 19. Best value: 0.630838:  21%|██        | 21/100 [12:02<55:51, 42.43s/it]Best trial: 19. Best value: 0.630838:  22%|██▏       | 22/100 [12:02<54:16, 41.75s/it]Best trial: 19. Best value: 0.630838:  22%|██▏       | 22/100 [12:42<54:16, 41.75s/it]Best trial: 19. Best value: 0.630838:  23%|██▎       | 23/100 [12:42<53:01, 41.32s/it]Best trial: 19. Best value: 0.630838:  23%|██▎       | 23/100 [13:22<53:01, 41.32s/it]Best trial: 19. Best value: 0.630838:  24%|██▍       | 24/100 [13:22<51:58, 41.04s/it]Best trial: 19. Best value: 0.630838:  24%|██▍       | 24/100 [14:04<51:58, 41.04s/it]Best trial: 19. Best value: 0.630838:  25%|██▌       | 25/100 [14:04<51:25, 41.13s/it]Best trial: 19. Best value: 0.630838:  25%|██▌       | 25/100 [14:37<51:25, 41.13s/it]Best trial: 19. Best value: 0.630838:  26%|██▌       | 26/100 [14:37<47:43, 38.69s/it]Best trial: 19. Best value: 0.630838:  26%|██▌       | 26/100 [15:24<47:43, 38.69s/it]Best trial: 19. Best value: 0.630838:  27%|██▋       | 27/100 [15:24<50:08, 41.21s/it]Best trial: 19. Best value: 0.630838:  27%|██▋       | 27/100 [17:12<50:08, 41.21s/it]Best trial: 19. Best value: 0.630838:  28%|██▊       | 28/100 [17:12<1:13:32, 61.28s/it]Best trial: 19. Best value: 0.630838:  28%|██▊       | 28/100 [17:31<1:13:32, 61.28s/it]Best trial: 19. Best value: 0.630838:  29%|██▉       | 29/100 [17:31<57:31, 48.61s/it]  Best trial: 19. Best value: 0.630838:  29%|██▉       | 29/100 [18:09<57:31, 48.61s/it]Best trial: 19. Best value: 0.630838:  30%|███       | 30/100 [18:09<52:56, 45.37s/it]Best trial: 19. Best value: 0.630838:  30%|███       | 30/100 [18:49<52:56, 45.37s/it]Best trial: 19. Best value: 0.630838:  31%|███       | 31/100 [18:49<50:16, 43.72s/it]Best trial: 19. Best value: 0.630838:  31%|███       | 31/100 [19:29<50:16, 43.72s/it]Best trial: 19. Best value: 0.630838:  32%|███▏      | 32/100 [19:29<48:20, 42.65s/it]Best trial: 19. Best value: 0.630838:  32%|███▏      | 32/100 [19:40<48:20, 42.65s/it]Best trial: 19. Best value: 0.630838:  33%|███▎      | 33/100 [19:40<36:54, 33.05s/it]Best trial: 19. Best value: 0.630838:  33%|███▎      | 33/100 [20:03<36:54, 33.05s/it]Best trial: 19. Best value: 0.630838:  34%|███▍      | 34/100 [20:03<33:11, 30.17s/it]Best trial: 19. Best value: 0.630838:  34%|███▍      | 34/100 [21:18<33:11, 30.17s/it]Best trial: 19. Best value: 0.630838:  35%|███▌      | 35/100 [21:18<47:22, 43.74s/it]Best trial: 19. Best value: 0.630838:  35%|███▌      | 35/100 [22:02<47:22, 43.74s/it]Best trial: 19. Best value: 0.630838:  36%|███▌      | 36/100 [22:02<46:27, 43.55s/it]Best trial: 19. Best value: 0.630838:  36%|███▌      | 36/100 [22:44<46:27, 43.55s/it]Best trial: 19. Best value: 0.630838:  37%|███▋      | 37/100 [22:44<45:21, 43.19s/it]Best trial: 19. Best value: 0.630838:  37%|███▋      | 37/100 [22:59<45:21, 43.19s/it]Best trial: 19. Best value: 0.630838:  38%|███▊      | 38/100 [22:59<35:47, 34.64s/it]Best trial: 19. Best value: 0.630838:  38%|███▊      | 38/100 [23:34<35:47, 34.64s/it]Best trial: 19. Best value: 0.630838:  39%|███▉      | 39/100 [23:34<35:37, 35.03s/it]Best trial: 19. Best value: 0.630838:  39%|███▉      | 39/100 [24:30<35:37, 35.03s/it]Best trial: 19. Best value: 0.630838:  40%|████      | 40/100 [24:30<41:14, 41.24s/it]Best trial: 19. Best value: 0.630838:  40%|████      | 40/100 [25:11<41:14, 41.24s/it]Best trial: 19. Best value: 0.630838:  41%|████      | 41/100 [25:11<40:32, 41.23s/it]Best trial: 19. Best value: 0.630838:  41%|████      | 41/100 [25:57<40:32, 41.23s/it]Best trial: 19. Best value: 0.630838:  42%|████▏     | 42/100 [25:57<41:10, 42.60s/it]Best trial: 19. Best value: 0.630838:  42%|████▏     | 42/100 [26:36<41:10, 42.60s/it]Best trial: 19. Best value: 0.630838:  43%|████▎     | 43/100 [26:36<39:29, 41.57s/it]Best trial: 19. Best value: 0.630838:  43%|████▎     | 43/100 [27:01<39:29, 41.57s/it]Best trial: 19. Best value: 0.630838:  44%|████▍     | 44/100 [27:01<33:57, 36.39s/it]Best trial: 19. Best value: 0.630838:  44%|████▍     | 44/100 [28:03<33:57, 36.39s/it]Best trial: 19. Best value: 0.630838:  45%|████▌     | 45/100 [28:03<40:22, 44.04s/it]Best trial: 19. Best value: 0.630838:  45%|████▌     | 45/100 [28:50<40:22, 44.04s/it]Best trial: 19. Best value: 0.630838:  46%|████▌     | 46/100 [28:50<40:39, 45.17s/it]Best trial: 19. Best value: 0.630838:  46%|████▌     | 46/100 [29:59<40:39, 45.17s/it]Best trial: 19. Best value: 0.630838:  47%|████▋     | 47/100 [29:59<46:13, 52.33s/it]Best trial: 19. Best value: 0.630838:  47%|████▋     | 47/100 [30:20<46:13, 52.33s/it]Best trial: 19. Best value: 0.630838:  48%|████▊     | 48/100 [30:20<37:02, 42.75s/it]Best trial: 19. Best value: 0.630838:  48%|████▊     | 48/100 [31:02<37:02, 42.75s/it]Best trial: 19. Best value: 0.630838:  49%|████▉     | 49/100 [31:02<36:09, 42.54s/it]Best trial: 19. Best value: 0.630838:  49%|████▉     | 49/100 [31:49<36:09, 42.54s/it]Best trial: 19. Best value: 0.630838:  50%|█████     | 50/100 [31:49<36:35, 43.92s/it]Best trial: 19. Best value: 0.630838:  50%|█████     | 50/100 [32:32<36:35, 43.92s/it]Best trial: 19. Best value: 0.630838:  51%|█████     | 51/100 [32:32<35:37, 43.62s/it]Best trial: 19. Best value: 0.630838:  51%|█████     | 51/100 [33:45<35:37, 43.62s/it]Best trial: 19. Best value: 0.630838:  52%|█████▏    | 52/100 [33:45<42:00, 52.51s/it]Best trial: 19. Best value: 0.630838:  52%|█████▏    | 52/100 [34:40<42:00, 52.51s/it]Best trial: 19. Best value: 0.630838:  53%|█████▎    | 53/100 [34:40<41:38, 53.16s/it]Best trial: 19. Best value: 0.630838:  53%|█████▎    | 53/100 [35:21<41:38, 53.16s/it]Best trial: 19. Best value: 0.630838:  54%|█████▍    | 54/100 [35:21<37:53, 49.42s/it]Best trial: 19. Best value: 0.630838:  54%|█████▍    | 54/100 [36:08<37:53, 49.42s/it]Best trial: 19. Best value: 0.630838:  55%|█████▌    | 55/100 [36:08<36:39, 48.87s/it]Best trial: 19. Best value: 0.630838:  55%|█████▌    | 55/100 [36:47<36:39, 48.87s/it]Best trial: 19. Best value: 0.630838:  56%|█████▌    | 56/100 [36:47<33:44, 46.02s/it]Best trial: 19. Best value: 0.630838:  56%|█████▌    | 56/100 [37:31<33:44, 46.02s/it]Best trial: 19. Best value: 0.630838:  57%|█████▋    | 57/100 [37:31<32:25, 45.26s/it]Best trial: 19. Best value: 0.630838:  57%|█████▋    | 57/100 [38:35<32:25, 45.26s/it]Best trial: 19. Best value: 0.630838:  58%|█████▊    | 58/100 [38:35<35:41, 50.98s/it]Best trial: 19. Best value: 0.630838:  58%|█████▊    | 58/100 [38:58<35:41, 50.98s/it]Best trial: 19. Best value: 0.630838:  59%|█████▉    | 59/100 [38:58<28:57, 42.37s/it]Best trial: 19. Best value: 0.630838:  59%|█████▉    | 59/100 [39:53<28:57, 42.37s/it]Best trial: 19. Best value: 0.630838:  60%|██████    | 60/100 [39:53<30:53, 46.33s/it]Best trial: 19. Best value: 0.630838:  60%|██████    | 60/100 [40:43<30:53, 46.33s/it]Best trial: 19. Best value: 0.630838:  61%|██████    | 61/100 [40:43<30:45, 47.33s/it]Best trial: 61. Best value: 0.634729:  61%|██████    | 61/100 [41:28<30:45, 47.33s/it]Best trial: 61. Best value: 0.634729:  62%|██████▏   | 62/100 [41:28<29:36, 46.75s/it]Best trial: 61. Best value: 0.634729:  62%|██████▏   | 62/100 [42:22<29:36, 46.75s/it]Best trial: 61. Best value: 0.634729:  63%|██████▎   | 63/100 [42:22<30:12, 48.99s/it]Best trial: 61. Best value: 0.634729:  63%|██████▎   | 63/100 [43:08<30:12, 48.99s/it]Best trial: 61. Best value: 0.634729:  64%|██████▍   | 64/100 [43:08<28:44, 47.89s/it]Best trial: 61. Best value: 0.634729:  64%|██████▍   | 64/100 [43:53<28:44, 47.89s/it]Best trial: 61. Best value: 0.634729:  65%|██████▌   | 65/100 [43:53<27:30, 47.16s/it]Best trial: 61. Best value: 0.634729:  65%|██████▌   | 65/100 [44:30<27:30, 47.16s/it]Best trial: 61. Best value: 0.634729:  66%|██████▌   | 66/100 [44:30<25:00, 44.13s/it]Best trial: 61. Best value: 0.634729:  66%|██████▌   | 66/100 [45:30<25:00, 44.13s/it]Best trial: 61. Best value: 0.634729:  67%|██████▋   | 67/100 [45:30<26:48, 48.75s/it]Best trial: 61. Best value: 0.634729:  67%|██████▋   | 67/100 [46:08<26:48, 48.75s/it]Best trial: 61. Best value: 0.634729:  68%|██████▊   | 68/100 [46:08<24:18, 45.59s/it]Best trial: 61. Best value: 0.634729:  68%|██████▊   | 68/100 [46:52<24:18, 45.59s/it]Best trial: 61. Best value: 0.634729:  69%|██████▉   | 69/100 [46:52<23:15, 45.01s/it]Best trial: 61. Best value: 0.634729:  69%|██████▉   | 69/100 [47:41<23:15, 45.01s/it]Best trial: 61. Best value: 0.634729:  70%|███████   | 70/100 [47:41<23:05, 46.18s/it]Best trial: 61. Best value: 0.634729:  70%|███████   | 70/100 [48:11<23:05, 46.18s/it]Best trial: 61. Best value: 0.634729:  71%|███████   | 71/100 [48:11<20:01, 41.43s/it]Best trial: 61. Best value: 0.634729:  71%|███████   | 71/100 [49:09<20:01, 41.43s/it]Best trial: 61. Best value: 0.634729:  72%|███████▏  | 72/100 [49:09<21:37, 46.34s/it]Best trial: 61. Best value: 0.634729:  72%|███████▏  | 72/100 [50:03<21:37, 46.34s/it]Best trial: 61. Best value: 0.634729:  73%|███████▎  | 73/100 [50:03<21:56, 48.75s/it]Best trial: 61. Best value: 0.634729:  73%|███████▎  | 73/100 [51:03<21:56, 48.75s/it]Best trial: 61. Best value: 0.634729:  74%|███████▍  | 74/100 [51:03<22:33, 52.08s/it]Best trial: 61. Best value: 0.634729:  74%|███████▍  | 74/100 [52:14<22:33, 52.08s/it]Best trial: 61. Best value: 0.634729:  75%|███████▌  | 75/100 [52:14<24:01, 57.67s/it]Best trial: 61. Best value: 0.634729:  75%|███████▌  | 75/100 [53:23<24:01, 57.67s/it]Best trial: 61. Best value: 0.634729:  76%|███████▌  | 76/100 [53:23<24:28, 61.17s/it]Best trial: 61. Best value: 0.634729:  76%|███████▌  | 76/100 [54:00<24:28, 61.17s/it]Best trial: 61. Best value: 0.634729:  77%|███████▋  | 77/100 [54:00<20:42, 54.03s/it]Best trial: 61. Best value: 0.634729:  77%|███████▋  | 77/100 [54:59<20:42, 54.03s/it]Best trial: 61. Best value: 0.634729:  78%|███████▊  | 78/100 [54:59<20:18, 55.38s/it]Best trial: 61. Best value: 0.634729:  78%|███████▊  | 78/100 [55:41<20:18, 55.38s/it]Best trial: 61. Best value: 0.634729:  79%|███████▉  | 79/100 [55:41<18:01, 51.49s/it]Best trial: 61. Best value: 0.634729:  79%|███████▉  | 79/100 [56:41<18:01, 51.49s/it]Best trial: 61. Best value: 0.634729:  80%|████████  | 80/100 [56:41<17:56, 53.80s/it]Best trial: 61. Best value: 0.634729:  80%|████████  | 80/100 [56:58<17:56, 53.80s/it]Best trial: 61. Best value: 0.634729:  81%|████████  | 81/100 [56:58<13:37, 43.03s/it]Best trial: 61. Best value: 0.634729:  81%|████████  | 81/100 [57:59<13:37, 43.03s/it]Best trial: 61. Best value: 0.634729:  82%|████████▏ | 82/100 [57:59<14:29, 48.28s/it]Best trial: 61. Best value: 0.634729:  82%|████████▏ | 82/100 [59:00<14:29, 48.28s/it]Best trial: 61. Best value: 0.634729:  83%|████████▎ | 83/100 [59:00<14:48, 52.26s/it]Best trial: 61. Best value: 0.634729:  83%|████████▎ | 83/100 [59:54<14:48, 52.26s/it]Best trial: 61. Best value: 0.634729:  84%|████████▍ | 84/100 [59:54<14:02, 52.64s/it]Best trial: 61. Best value: 0.634729:  84%|████████▍ | 84/100 [1:00:50<14:02, 52.64s/it]Best trial: 61. Best value: 0.634729:  85%|████████▌ | 85/100 [1:00:50<13:25, 53.73s/it]Best trial: 61. Best value: 0.634729:  85%|████████▌ | 85/100 [1:01:25<13:25, 53.73s/it]Best trial: 61. Best value: 0.634729:  86%|████████▌ | 86/100 [1:01:25<11:14, 48.16s/it]Best trial: 61. Best value: 0.634729:  86%|████████▌ | 86/100 [1:02:28<11:14, 48.16s/it]Best trial: 61. Best value: 0.634729:  87%|████████▋ | 87/100 [1:02:28<11:23, 52.58s/it]Best trial: 61. Best value: 0.634729:  87%|████████▋ | 87/100 [1:02:55<11:23, 52.58s/it]Best trial: 61. Best value: 0.634729:  88%|████████▊ | 88/100 [1:02:55<08:58, 44.91s/it]Best trial: 61. Best value: 0.634729:  88%|████████▊ | 88/100 [1:03:58<08:58, 44.91s/it]Best trial: 61. Best value: 0.634729:  89%|████████▉ | 89/100 [1:03:58<09:13, 50.27s/it]Best trial: 61. Best value: 0.634729:  89%|████████▉ | 89/100 [1:04:26<09:13, 50.27s/it]Best trial: 61. Best value: 0.634729:  90%|█████████ | 90/100 [1:04:26<07:16, 43.69s/it]Best trial: 61. Best value: 0.634729:  90%|█████████ | 90/100 [1:06:03<07:16, 43.69s/it]Best trial: 61. Best value: 0.634729:  91%|█████████ | 91/100 [1:06:03<08:57, 59.68s/it]Best trial: 61. Best value: 0.634729:  91%|█████████ | 91/100 [1:07:05<08:57, 59.68s/it]Best trial: 61. Best value: 0.634729:  92%|█████████▏| 92/100 [1:07:05<08:02, 60.25s/it]Best trial: 61. Best value: 0.634729:  92%|█████████▏| 92/100 [1:08:18<08:02, 60.25s/it]Best trial: 61. Best value: 0.634729:  93%|█████████▎| 93/100 [1:08:18<07:29, 64.20s/it]Best trial: 61. Best value: 0.634729:  93%|█████████▎| 93/100 [1:09:23<07:29, 64.20s/it]Best trial: 61. Best value: 0.634729:  94%|█████████▍| 94/100 [1:09:23<06:25, 64.28s/it]Best trial: 61. Best value: 0.634729:  94%|█████████▍| 94/100 [1:10:01<06:25, 64.28s/it]Best trial: 61. Best value: 0.634729:  95%|█████████▌| 95/100 [1:10:01<04:42, 56.49s/it]Best trial: 61. Best value: 0.634729:  95%|█████████▌| 95/100 [1:10:33<04:42, 56.49s/it]Best trial: 61. Best value: 0.634729:  96%|█████████▌| 96/100 [1:10:33<03:16, 49.05s/it]Best trial: 61. Best value: 0.634729:  96%|█████████▌| 96/100 [1:11:33<03:16, 49.05s/it]Best trial: 61. Best value: 0.634729:  97%|█████████▋| 97/100 [1:11:33<02:36, 52.22s/it]Best trial: 61. Best value: 0.634729:  97%|█████████▋| 97/100 [1:12:27<02:36, 52.22s/it]Best trial: 61. Best value: 0.634729:  98%|█████████▊| 98/100 [1:12:27<01:45, 52.76s/it]Best trial: 61. Best value: 0.634729:  98%|█████████▊| 98/100 [1:13:27<01:45, 52.76s/it]Best trial: 61. Best value: 0.634729:  99%|█████████▉| 99/100 [1:13:27<00:55, 55.14s/it]Best trial: 61. Best value: 0.634729:  99%|█████████▉| 99/100 [1:14:53<00:55, 55.14s/it]Best trial: 61. Best value: 0.634729: 100%|██████████| 100/100 [1:14:53<00:00, 64.37s/it]Best trial: 61. Best value: 0.634729: 100%|██████████| 100/100 [1:14:53<00:00, 44.94s/it]
2025-11-30 21:18:37,885 - INFO - HPO Complete. Best AUPRC: 0.6347
2025-11-30 21:18:37,886 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.05059152425740762, 'max_depth': 9, 'subsample': 0.7740603023909988, 'colsample_bytree': 0.776840356779713, 'gamma': 0.09818424809507169, 'reg_lambda': 4.590129056364178e-05, 'reg_alpha': 0.09132886068383636}
2025-11-30 21:18:37,886 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 21:18:39,805 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-11-30 21:18:39,805 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:18:39,996 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:18:40,077 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:18:40,099 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-11-30 21:18:40,099 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 21:18:40,099 - INFO - Training model...
2025-11-30 21:18:56,543 - INFO - Evaluating model with bootstrapping...
2025-11-30 21:19:03,622 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 21:19:03,622 - INFO - AUROC: 0.8038 (0.7768 - 0.8283)
2025-11-30 21:19:03,622 - INFO - AUPRC: 0.5472 (0.4810 - 0.6170)
2025-11-30 21:19:03,622 - INFO - Brier Score: 0.1514 (0.1376 - 0.1671)
2025-11-30 21:19:03,622 - INFO - Accuracy: 0.8064 (0.7188 - 0.8373)
2025-11-30 21:19:03,622 - INFO - Precision: 0.5811 (0.4292 - 0.6728)
2025-11-30 21:19:03,622 - INFO - Sensitivity (Recall): 0.5443 (0.5106 - 0.7829)
2025-11-30 21:19:03,622 - INFO - F1-Score: 0.5621 (0.5272 - 0.6291)
2025-11-30 21:19:03,622 - INFO - Best Threshold: 0.2800 (0.0560 - 0.3280)
2025-11-30 21:19:03,622 - INFO - Specificity: 0.8839 (0.7174 - 0.9146)
2025-11-30 21:19:03,651 - INFO - Calculating SHAP values...
2025-11-30 21:19:05,068 - INFO - SHAP plots saved.
2025-11-30 21:19:05,069 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 21:19:06,248 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: ventilator_only
2025-11-30 21:19:06,248 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:19:06,438 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:19:06,475 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:19:06,482 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 21:19:06,482 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.497646:   0%|          | 0/100 [00:19<?, ?it/s]Best trial: 0. Best value: 0.497646:   1%|          | 1/100 [00:19<31:33, 19.13s/it]Best trial: 1. Best value: 0.499454:   1%|          | 1/100 [00:23<31:33, 19.13s/it]Best trial: 1. Best value: 0.499454:   2%|▏         | 2/100 [00:23<16:42, 10.23s/it]Best trial: 1. Best value: 0.499454:   2%|▏         | 2/100 [00:25<16:42, 10.23s/it]Best trial: 1. Best value: 0.499454:   3%|▎         | 3/100 [00:25<10:53,  6.74s/it]Best trial: 1. Best value: 0.499454:   3%|▎         | 3/100 [00:29<10:53,  6.74s/it]Best trial: 1. Best value: 0.499454:   4%|▍         | 4/100 [00:29<08:38,  5.41s/it]Best trial: 4. Best value: 0.516409:   4%|▍         | 4/100 [00:56<08:38,  5.41s/it]Best trial: 4. Best value: 0.516409:   5%|▌         | 5/100 [00:56<20:54, 13.21s/it]Best trial: 4. Best value: 0.516409:   5%|▌         | 5/100 [01:00<20:54, 13.21s/it]Best trial: 4. Best value: 0.516409:   6%|▌         | 6/100 [01:00<15:56, 10.17s/it]Best trial: 4. Best value: 0.516409:   6%|▌         | 6/100 [01:15<15:56, 10.17s/it]Best trial: 4. Best value: 0.516409:   7%|▋         | 7/100 [01:15<18:24, 11.87s/it]Best trial: 4. Best value: 0.516409:   7%|▋         | 7/100 [01:40<18:24, 11.87s/it]Best trial: 4. Best value: 0.516409:   8%|▊         | 8/100 [01:40<24:28, 15.96s/it]Best trial: 4. Best value: 0.516409:   8%|▊         | 8/100 [01:59<24:28, 15.96s/it]Best trial: 4. Best value: 0.516409:   9%|▉         | 9/100 [01:59<25:27, 16.79s/it]Best trial: 9. Best value: 0.517256:   9%|▉         | 9/100 [02:24<25:27, 16.79s/it]Best trial: 9. Best value: 0.517256:  10%|█         | 10/100 [02:24<29:01, 19.35s/it]Best trial: 9. Best value: 0.517256:  10%|█         | 10/100 [02:30<29:01, 19.35s/it]Best trial: 9. Best value: 0.517256:  11%|█         | 11/100 [02:30<22:47, 15.37s/it]Best trial: 9. Best value: 0.517256:  11%|█         | 11/100 [02:50<22:47, 15.37s/it]Best trial: 9. Best value: 0.517256:  12%|█▏        | 12/100 [02:50<24:37, 16.79s/it]Best trial: 12. Best value: 0.522706:  12%|█▏        | 12/100 [03:02<24:37, 16.79s/it]Best trial: 12. Best value: 0.522706:  13%|█▎        | 13/100 [03:02<22:07, 15.26s/it]Best trial: 13. Best value: 0.536501:  13%|█▎        | 13/100 [03:12<22:07, 15.26s/it]Best trial: 13. Best value: 0.536501:  14%|█▍        | 14/100 [03:12<19:45, 13.78s/it]Best trial: 13. Best value: 0.536501:  14%|█▍        | 14/100 [03:20<19:45, 13.78s/it]Best trial: 13. Best value: 0.536501:  15%|█▌        | 15/100 [03:20<17:00, 12.00s/it]Best trial: 13. Best value: 0.536501:  15%|█▌        | 15/100 [03:26<17:00, 12.00s/it]Best trial: 13. Best value: 0.536501:  16%|█▌        | 16/100 [03:26<14:26, 10.32s/it]Best trial: 13. Best value: 0.536501:  16%|█▌        | 16/100 [03:32<14:26, 10.32s/it]Best trial: 13. Best value: 0.536501:  17%|█▋        | 17/100 [03:32<12:26,  9.00s/it]Best trial: 17. Best value: 0.536739:  17%|█▋        | 17/100 [03:40<12:26,  9.00s/it]Best trial: 17. Best value: 0.536739:  18%|█▊        | 18/100 [03:40<11:40,  8.54s/it]Best trial: 17. Best value: 0.536739:  18%|█▊        | 18/100 [03:52<11:40,  8.54s/it]Best trial: 17. Best value: 0.536739:  19%|█▉        | 19/100 [03:52<12:52,  9.53s/it]Best trial: 17. Best value: 0.536739:  19%|█▉        | 19/100 [03:57<12:52,  9.53s/it]Best trial: 17. Best value: 0.536739:  20%|██        | 20/100 [03:57<10:58,  8.23s/it]Best trial: 17. Best value: 0.536739:  20%|██        | 20/100 [04:03<10:58,  8.23s/it]Best trial: 17. Best value: 0.536739:  21%|██        | 21/100 [04:03<09:54,  7.53s/it]Best trial: 17. Best value: 0.536739:  21%|██        | 21/100 [04:08<09:54,  7.53s/it]Best trial: 17. Best value: 0.536739:  22%|██▏       | 22/100 [04:08<08:46,  6.75s/it]Best trial: 17. Best value: 0.536739:  22%|██▏       | 22/100 [04:13<08:46,  6.75s/it]Best trial: 17. Best value: 0.536739:  23%|██▎       | 23/100 [04:13<08:06,  6.32s/it]Best trial: 17. Best value: 0.536739:  23%|██▎       | 23/100 [04:19<08:06,  6.32s/it]Best trial: 17. Best value: 0.536739:  24%|██▍       | 24/100 [04:19<07:42,  6.08s/it]Best trial: 17. Best value: 0.536739:  24%|██▍       | 24/100 [04:29<07:42,  6.08s/it]Best trial: 17. Best value: 0.536739:  25%|██▌       | 25/100 [04:29<09:07,  7.30s/it]Best trial: 17. Best value: 0.536739:  25%|██▌       | 25/100 [04:33<09:07,  7.30s/it]Best trial: 17. Best value: 0.536739:  26%|██▌       | 26/100 [04:33<07:51,  6.37s/it]Best trial: 17. Best value: 0.536739:  26%|██▌       | 26/100 [04:46<07:51,  6.37s/it]Best trial: 17. Best value: 0.536739:  27%|██▋       | 27/100 [04:46<10:02,  8.26s/it]Best trial: 17. Best value: 0.536739:  27%|██▋       | 27/100 [05:00<10:02,  8.26s/it]Best trial: 17. Best value: 0.536739:  28%|██▊       | 28/100 [05:00<12:12, 10.17s/it]Best trial: 17. Best value: 0.536739:  28%|██▊       | 28/100 [05:12<12:12, 10.17s/it]Best trial: 17. Best value: 0.536739:  29%|██▉       | 29/100 [05:12<12:30, 10.57s/it]Best trial: 17. Best value: 0.536739:  29%|██▉       | 29/100 [05:29<12:30, 10.57s/it]Best trial: 17. Best value: 0.536739:  30%|███       | 30/100 [05:29<14:49, 12.70s/it]Best trial: 17. Best value: 0.536739:  30%|███       | 30/100 [05:38<14:49, 12.70s/it]Best trial: 17. Best value: 0.536739:  31%|███       | 31/100 [05:38<13:05, 11.39s/it]Best trial: 17. Best value: 0.536739:  31%|███       | 31/100 [05:49<13:05, 11.39s/it]Best trial: 17. Best value: 0.536739:  32%|███▏      | 32/100 [05:49<12:42, 11.22s/it]Best trial: 17. Best value: 0.536739:  32%|███▏      | 32/100 [05:59<12:42, 11.22s/it]Best trial: 17. Best value: 0.536739:  33%|███▎      | 33/100 [05:59<12:22, 11.08s/it]Best trial: 17. Best value: 0.536739:  33%|███▎      | 33/100 [06:07<12:22, 11.08s/it]Best trial: 17. Best value: 0.536739:  34%|███▍      | 34/100 [06:07<11:11, 10.17s/it]Best trial: 17. Best value: 0.536739:  34%|███▍      | 34/100 [06:17<11:11, 10.17s/it]Best trial: 17. Best value: 0.536739:  35%|███▌      | 35/100 [06:17<11:00, 10.15s/it]Best trial: 17. Best value: 0.536739:  35%|███▌      | 35/100 [06:36<11:00, 10.15s/it]Best trial: 17. Best value: 0.536739:  36%|███▌      | 36/100 [06:36<13:31, 12.69s/it]Best trial: 17. Best value: 0.536739:  36%|███▌      | 36/100 [07:02<13:31, 12.69s/it]Best trial: 17. Best value: 0.536739:  37%|███▋      | 37/100 [07:02<17:35, 16.75s/it]Best trial: 17. Best value: 0.536739:  37%|███▋      | 37/100 [07:06<17:35, 16.75s/it]Best trial: 17. Best value: 0.536739:  38%|███▊      | 38/100 [07:06<13:16, 12.85s/it]Best trial: 17. Best value: 0.536739:  38%|███▊      | 38/100 [07:29<13:16, 12.85s/it]Best trial: 17. Best value: 0.536739:  39%|███▉      | 39/100 [07:29<16:06, 15.84s/it]Best trial: 17. Best value: 0.536739:  39%|███▉      | 39/100 [07:37<16:06, 15.84s/it]Best trial: 17. Best value: 0.536739:  40%|████      | 40/100 [07:37<13:25, 13.43s/it]Best trial: 17. Best value: 0.536739:  40%|████      | 40/100 [07:59<13:25, 13.43s/it]Best trial: 17. Best value: 0.536739:  41%|████      | 41/100 [07:59<15:57, 16.23s/it]Best trial: 17. Best value: 0.536739:  41%|████      | 41/100 [08:11<15:57, 16.23s/it]Best trial: 17. Best value: 0.536739:  42%|████▏     | 42/100 [08:11<14:25, 14.92s/it]Best trial: 17. Best value: 0.536739:  42%|████▏     | 42/100 [08:23<14:25, 14.92s/it]Best trial: 17. Best value: 0.536739:  43%|████▎     | 43/100 [08:23<13:07, 13.82s/it]Best trial: 17. Best value: 0.536739:  43%|████▎     | 43/100 [08:33<13:07, 13.82s/it]Best trial: 17. Best value: 0.536739:  44%|████▍     | 44/100 [08:33<11:53, 12.74s/it]Best trial: 17. Best value: 0.536739:  44%|████▍     | 44/100 [08:45<11:53, 12.74s/it]Best trial: 17. Best value: 0.536739:  45%|████▌     | 45/100 [08:45<11:34, 12.63s/it]Best trial: 17. Best value: 0.536739:  45%|████▌     | 45/100 [08:52<11:34, 12.63s/it]Best trial: 17. Best value: 0.536739:  46%|████▌     | 46/100 [08:52<09:45, 10.84s/it]Best trial: 17. Best value: 0.536739:  46%|████▌     | 46/100 [09:13<09:45, 10.84s/it]Best trial: 17. Best value: 0.536739:  47%|████▋     | 47/100 [09:13<12:12, 13.82s/it]Best trial: 17. Best value: 0.536739:  47%|████▋     | 47/100 [09:22<12:12, 13.82s/it]Best trial: 17. Best value: 0.536739:  48%|████▊     | 48/100 [09:22<10:56, 12.63s/it]Best trial: 17. Best value: 0.536739:  48%|████▊     | 48/100 [09:29<10:56, 12.63s/it]Best trial: 17. Best value: 0.536739:  49%|████▉     | 49/100 [09:29<09:05, 10.71s/it]Best trial: 17. Best value: 0.536739:  49%|████▉     | 49/100 [09:40<09:05, 10.71s/it]Best trial: 17. Best value: 0.536739:  50%|█████     | 50/100 [09:40<08:58, 10.78s/it]Best trial: 17. Best value: 0.536739:  50%|█████     | 50/100 [09:45<08:58, 10.78s/it]Best trial: 17. Best value: 0.536739:  51%|█████     | 51/100 [09:45<07:26,  9.11s/it]Best trial: 17. Best value: 0.536739:  51%|█████     | 51/100 [09:57<07:26,  9.11s/it]Best trial: 17. Best value: 0.536739:  52%|█████▏    | 52/100 [09:57<07:57,  9.94s/it]Best trial: 17. Best value: 0.536739:  52%|█████▏    | 52/100 [10:05<07:57,  9.94s/it]Best trial: 17. Best value: 0.536739:  53%|█████▎    | 53/100 [10:05<07:22,  9.41s/it]Best trial: 17. Best value: 0.536739:  53%|█████▎    | 53/100 [10:20<07:22,  9.41s/it]Best trial: 17. Best value: 0.536739:  54%|█████▍    | 54/100 [10:20<08:27, 11.04s/it]Best trial: 17. Best value: 0.536739:  54%|█████▍    | 54/100 [10:25<08:27, 11.04s/it]Best trial: 17. Best value: 0.536739:  55%|█████▌    | 55/100 [10:25<07:02,  9.38s/it]Best trial: 17. Best value: 0.536739:  55%|█████▌    | 55/100 [10:35<07:02,  9.38s/it]Best trial: 17. Best value: 0.536739:  56%|█████▌    | 56/100 [10:35<06:54,  9.41s/it]Best trial: 17. Best value: 0.536739:  56%|█████▌    | 56/100 [10:42<06:54,  9.41s/it]Best trial: 17. Best value: 0.536739:  57%|█████▋    | 57/100 [10:42<06:12,  8.67s/it]Best trial: 17. Best value: 0.536739:  57%|█████▋    | 57/100 [10:52<06:12,  8.67s/it]Best trial: 17. Best value: 0.536739:  58%|█████▊    | 58/100 [10:52<06:21,  9.09s/it]Best trial: 17. Best value: 0.536739:  58%|█████▊    | 58/100 [10:58<06:21,  9.09s/it]Best trial: 17. Best value: 0.536739:  59%|█████▉    | 59/100 [10:58<05:37,  8.24s/it]Best trial: 17. Best value: 0.536739:  59%|█████▉    | 59/100 [11:11<05:37,  8.24s/it]Best trial: 17. Best value: 0.536739:  60%|██████    | 60/100 [11:11<06:26,  9.67s/it]Best trial: 17. Best value: 0.536739:  60%|██████    | 60/100 [11:19<06:26,  9.67s/it]Best trial: 17. Best value: 0.536739:  61%|██████    | 61/100 [11:19<05:55,  9.11s/it]Best trial: 17. Best value: 0.536739:  61%|██████    | 61/100 [11:29<05:55,  9.11s/it]Best trial: 17. Best value: 0.536739:  62%|██████▏   | 62/100 [11:29<05:53,  9.31s/it]Best trial: 17. Best value: 0.536739:  62%|██████▏   | 62/100 [11:38<05:53,  9.31s/it]Best trial: 17. Best value: 0.536739:  63%|██████▎   | 63/100 [11:38<05:42,  9.25s/it]Best trial: 17. Best value: 0.536739:  63%|██████▎   | 63/100 [11:49<05:42,  9.25s/it]Best trial: 17. Best value: 0.536739:  64%|██████▍   | 64/100 [11:49<05:56,  9.91s/it]Best trial: 17. Best value: 0.536739:  64%|██████▍   | 64/100 [11:58<05:56,  9.91s/it]Best trial: 17. Best value: 0.536739:  65%|██████▌   | 65/100 [11:58<05:38,  9.66s/it]Best trial: 17. Best value: 0.536739:  65%|██████▌   | 65/100 [12:11<05:38,  9.66s/it]Best trial: 17. Best value: 0.536739:  66%|██████▌   | 66/100 [12:11<05:59, 10.56s/it]Best trial: 17. Best value: 0.536739:  66%|██████▌   | 66/100 [12:17<05:59, 10.56s/it]Best trial: 17. Best value: 0.536739:  67%|██████▋   | 67/100 [12:17<05:01,  9.13s/it]Best trial: 17. Best value: 0.536739:  67%|██████▋   | 67/100 [12:22<05:01,  9.13s/it]Best trial: 17. Best value: 0.536739:  68%|██████▊   | 68/100 [12:22<04:15,  7.99s/it]Best trial: 17. Best value: 0.536739:  68%|██████▊   | 68/100 [12:28<04:15,  7.99s/it]Best trial: 17. Best value: 0.536739:  69%|██████▉   | 69/100 [12:28<03:46,  7.31s/it]Best trial: 17. Best value: 0.536739:  69%|██████▉   | 69/100 [12:32<03:46,  7.31s/it]Best trial: 17. Best value: 0.536739:  70%|███████   | 70/100 [12:32<03:10,  6.37s/it]Best trial: 17. Best value: 0.536739:  70%|███████   | 70/100 [12:38<03:10,  6.37s/it]Best trial: 17. Best value: 0.536739:  71%|███████   | 71/100 [12:38<02:59,  6.18s/it]Best trial: 17. Best value: 0.536739:  71%|███████   | 71/100 [12:41<02:59,  6.18s/it]Best trial: 17. Best value: 0.536739:  72%|███████▏  | 72/100 [12:41<02:30,  5.36s/it]Best trial: 17. Best value: 0.536739:  72%|███████▏  | 72/100 [12:44<02:30,  5.36s/it]Best trial: 17. Best value: 0.536739:  73%|███████▎  | 73/100 [12:44<02:05,  4.66s/it]Best trial: 73. Best value: 0.54099:  73%|███████▎  | 73/100 [12:48<02:05,  4.66s/it] Best trial: 73. Best value: 0.54099:  74%|███████▍  | 74/100 [12:48<01:55,  4.43s/it]Best trial: 73. Best value: 0.54099:  74%|███████▍  | 74/100 [12:54<01:55,  4.43s/it]Best trial: 73. Best value: 0.54099:  75%|███████▌  | 75/100 [12:54<02:04,  4.97s/it]Best trial: 73. Best value: 0.54099:  75%|███████▌  | 75/100 [13:00<02:04,  4.97s/it]Best trial: 73. Best value: 0.54099:  76%|███████▌  | 76/100 [13:00<02:04,  5.19s/it]Best trial: 73. Best value: 0.54099:  76%|███████▌  | 76/100 [13:04<02:04,  5.19s/it]Best trial: 73. Best value: 0.54099:  77%|███████▋  | 77/100 [13:04<01:50,  4.80s/it]Best trial: 73. Best value: 0.54099:  77%|███████▋  | 77/100 [13:08<01:50,  4.80s/it]Best trial: 73. Best value: 0.54099:  78%|███████▊  | 78/100 [13:08<01:41,  4.59s/it]Best trial: 73. Best value: 0.54099:  78%|███████▊  | 78/100 [13:12<01:41,  4.59s/it]Best trial: 73. Best value: 0.54099:  79%|███████▉  | 79/100 [13:12<01:32,  4.42s/it]Best trial: 73. Best value: 0.54099:  79%|███████▉  | 79/100 [13:16<01:32,  4.42s/it]Best trial: 73. Best value: 0.54099:  80%|████████  | 80/100 [13:16<01:28,  4.42s/it]Best trial: 73. Best value: 0.54099:  80%|████████  | 80/100 [13:20<01:28,  4.42s/it]Best trial: 73. Best value: 0.54099:  81%|████████  | 81/100 [13:20<01:22,  4.33s/it]Best trial: 73. Best value: 0.54099:  81%|████████  | 81/100 [13:24<01:22,  4.33s/it]Best trial: 73. Best value: 0.54099:  82%|████████▏ | 82/100 [13:24<01:12,  4.01s/it]Best trial: 73. Best value: 0.54099:  82%|████████▏ | 82/100 [13:28<01:12,  4.01s/it]Best trial: 73. Best value: 0.54099:  83%|████████▎ | 83/100 [13:28<01:08,  4.00s/it]Best trial: 73. Best value: 0.54099:  83%|████████▎ | 83/100 [13:32<01:08,  4.00s/it]Best trial: 73. Best value: 0.54099:  84%|████████▍ | 84/100 [13:32<01:06,  4.17s/it]Best trial: 73. Best value: 0.54099:  84%|████████▍ | 84/100 [13:38<01:06,  4.17s/it]Best trial: 73. Best value: 0.54099:  85%|████████▌ | 85/100 [13:38<01:11,  4.77s/it]Best trial: 73. Best value: 0.54099:  85%|████████▌ | 85/100 [13:46<01:11,  4.77s/it]Best trial: 73. Best value: 0.54099:  86%|████████▌ | 86/100 [13:46<01:19,  5.65s/it]Best trial: 73. Best value: 0.54099:  86%|████████▌ | 86/100 [13:50<01:19,  5.65s/it]Best trial: 73. Best value: 0.54099:  87%|████████▋ | 87/100 [13:50<01:06,  5.12s/it]Best trial: 73. Best value: 0.54099:  87%|████████▋ | 87/100 [13:55<01:06,  5.12s/it]Best trial: 73. Best value: 0.54099:  88%|████████▊ | 88/100 [13:55<01:01,  5.08s/it]Best trial: 73. Best value: 0.54099:  88%|████████▊ | 88/100 [14:02<01:01,  5.08s/it]Best trial: 73. Best value: 0.54099:  89%|████████▉ | 89/100 [14:02<01:01,  5.59s/it]Best trial: 73. Best value: 0.54099:  89%|████████▉ | 89/100 [14:08<01:01,  5.59s/it]Best trial: 73. Best value: 0.54099:  90%|█████████ | 90/100 [14:08<00:59,  5.91s/it]Best trial: 73. Best value: 0.54099:  90%|█████████ | 90/100 [14:13<00:59,  5.91s/it]Best trial: 73. Best value: 0.54099:  91%|█████████ | 91/100 [14:13<00:48,  5.43s/it]Best trial: 73. Best value: 0.54099:  91%|█████████ | 91/100 [14:18<00:48,  5.43s/it]Best trial: 73. Best value: 0.54099:  92%|█████████▏| 92/100 [14:18<00:43,  5.45s/it]Best trial: 73. Best value: 0.54099:  92%|█████████▏| 92/100 [14:24<00:43,  5.45s/it]Best trial: 73. Best value: 0.54099:  93%|█████████▎| 93/100 [14:24<00:39,  5.59s/it]Best trial: 73. Best value: 0.54099:  93%|█████████▎| 93/100 [14:28<00:39,  5.59s/it]Best trial: 73. Best value: 0.54099:  94%|█████████▍| 94/100 [14:28<00:31,  5.19s/it]Best trial: 73. Best value: 0.54099:  94%|█████████▍| 94/100 [14:34<00:31,  5.19s/it]Best trial: 73. Best value: 0.54099:  95%|█████████▌| 95/100 [14:34<00:26,  5.22s/it]Best trial: 73. Best value: 0.54099:  95%|█████████▌| 95/100 [14:39<00:26,  5.22s/it]Best trial: 73. Best value: 0.54099:  96%|█████████▌| 96/100 [14:39<00:20,  5.23s/it]Best trial: 73. Best value: 0.54099:  96%|█████████▌| 96/100 [14:44<00:20,  5.23s/it]Best trial: 73. Best value: 0.54099:  97%|█████████▋| 97/100 [14:44<00:15,  5.28s/it]Best trial: 97. Best value: 0.545299:  97%|█████████▋| 97/100 [14:49<00:15,  5.28s/it]Best trial: 97. Best value: 0.545299:  98%|█████████▊| 98/100 [14:49<00:10,  5.19s/it]Best trial: 97. Best value: 0.545299:  98%|█████████▊| 98/100 [14:55<00:10,  5.19s/it]Best trial: 97. Best value: 0.545299:  99%|█████████▉| 99/100 [14:55<00:05,  5.24s/it]Best trial: 97. Best value: 0.545299:  99%|█████████▉| 99/100 [14:59<00:05,  5.24s/it]Best trial: 97. Best value: 0.545299: 100%|██████████| 100/100 [14:59<00:00,  5.00s/it]Best trial: 97. Best value: 0.545299: 100%|██████████| 100/100 [14:59<00:00,  9.00s/it]
2025-11-30 21:34:06,106 - INFO - HPO Complete. Best AUPRC: 0.5453
2025-11-30 21:34:06,106 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.08698139711588723, 'max_depth': 5, 'subsample': 0.7848444185835143, 'colsample_bytree': 0.8435634509927954, 'gamma': 0.4547034037222778, 'reg_lambda': 8.396468319459476e-07, 'reg_alpha': 0.2266101031742567}
2025-11-30 21:34:06,107 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 21:34:08,151 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: ventilator_only
2025-11-30 21:34:08,152 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:34:08,377 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:34:08,418 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:34:08,426 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 21:34:08,426 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 21:34:08,426 - INFO - Training model...
2025-11-30 21:34:12,033 - INFO - Evaluating model with bootstrapping...
2025-11-30 21:34:17,598 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 21:34:17,599 - INFO - AUROC: 0.7288 (0.6909 - 0.7695)
2025-11-30 21:34:17,599 - INFO - AUPRC: 0.4412 (0.3808 - 0.5181)
2025-11-30 21:34:17,599 - INFO - Brier Score: 0.1687 (0.1552 - 0.1814)
2025-11-30 21:34:17,599 - INFO - Accuracy: 0.7471 (0.6841 - 0.7879)
2025-11-30 21:34:17,599 - INFO - Precision: 0.4564 (0.3894 - 0.5316)
2025-11-30 21:34:17,599 - INFO - Sensitivity (Recall): 0.5633 (0.4588 - 0.7142)
2025-11-30 21:34:17,599 - INFO - F1-Score: 0.5042 (0.4615 - 0.5565)
2025-11-30 21:34:17,599 - INFO - Best Threshold: 0.3000 (0.1800 - 0.4000)
2025-11-30 21:34:17,599 - INFO - Specificity: 0.8015 (0.6887 - 0.8710)
2025-11-30 21:34:17,622 - INFO - Calculating SHAP values...
2025-11-30 21:34:18,936 - INFO - SHAP plots saved.
2025-11-30 21:34:18,939 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 21:34:20,336 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: monitors_only
2025-11-30 21:34:20,336 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:34:20,575 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:34:20,617 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:34:20,626 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 21:34:20,626 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.444442:   0%|          | 0/100 [00:12<?, ?it/s]Best trial: 0. Best value: 0.444442:   1%|          | 1/100 [00:12<20:26, 12.39s/it]Best trial: 1. Best value: 0.461513:   1%|          | 1/100 [00:19<20:26, 12.39s/it]Best trial: 1. Best value: 0.461513:   2%|▏         | 2/100 [00:19<15:10,  9.29s/it]Best trial: 1. Best value: 0.461513:   2%|▏         | 2/100 [00:28<15:10,  9.29s/it]Best trial: 1. Best value: 0.461513:   3%|▎         | 3/100 [00:28<14:39,  9.07s/it]Best trial: 1. Best value: 0.461513:   3%|▎         | 3/100 [00:45<14:39,  9.07s/it]Best trial: 1. Best value: 0.461513:   4%|▍         | 4/100 [00:45<19:50, 12.40s/it]Best trial: 4. Best value: 0.468241:   4%|▍         | 4/100 [00:51<19:50, 12.40s/it]Best trial: 4. Best value: 0.468241:   5%|▌         | 5/100 [00:51<15:45,  9.95s/it]Best trial: 4. Best value: 0.468241:   5%|▌         | 5/100 [00:53<15:45,  9.95s/it]Best trial: 4. Best value: 0.468241:   6%|▌         | 6/100 [00:53<11:28,  7.32s/it]Best trial: 4. Best value: 0.468241:   6%|▌         | 6/100 [01:17<11:28,  7.32s/it]Best trial: 4. Best value: 0.468241:   7%|▋         | 7/100 [01:17<19:47, 12.77s/it]Best trial: 4. Best value: 0.468241:   7%|▋         | 7/100 [01:27<19:47, 12.77s/it]Best trial: 4. Best value: 0.468241:   8%|▊         | 8/100 [01:27<18:22, 11.99s/it]Best trial: 4. Best value: 0.468241:   8%|▊         | 8/100 [01:34<18:22, 11.99s/it]Best trial: 4. Best value: 0.468241:   9%|▉         | 9/100 [01:34<15:28, 10.21s/it]Best trial: 4. Best value: 0.468241:   9%|▉         | 9/100 [02:05<15:28, 10.21s/it]Best trial: 4. Best value: 0.468241:  10%|█         | 10/100 [02:05<25:13, 16.82s/it]Best trial: 4. Best value: 0.468241:  10%|█         | 10/100 [02:08<25:13, 16.82s/it]Best trial: 4. Best value: 0.468241:  11%|█         | 11/100 [02:08<18:28, 12.46s/it]Best trial: 4. Best value: 0.468241:  11%|█         | 11/100 [02:17<18:28, 12.46s/it]Best trial: 4. Best value: 0.468241:  12%|█▏        | 12/100 [02:17<16:48, 11.46s/it]Best trial: 4. Best value: 0.468241:  12%|█▏        | 12/100 [02:22<16:48, 11.46s/it]Best trial: 4. Best value: 0.468241:  13%|█▎        | 13/100 [02:22<13:41,  9.44s/it]Best trial: 4. Best value: 0.468241:  13%|█▎        | 13/100 [02:27<13:41,  9.44s/it]Best trial: 4. Best value: 0.468241:  14%|█▍        | 14/100 [02:27<11:28,  8.00s/it]Best trial: 4. Best value: 0.468241:  14%|█▍        | 14/100 [02:33<11:28,  8.00s/it]Best trial: 4. Best value: 0.468241:  15%|█▌        | 15/100 [02:33<10:28,  7.39s/it]Best trial: 4. Best value: 0.468241:  15%|█▌        | 15/100 [02:39<10:28,  7.39s/it]Best trial: 4. Best value: 0.468241:  16%|█▌        | 16/100 [02:39<09:53,  7.06s/it]Best trial: 4. Best value: 0.468241:  16%|█▌        | 16/100 [02:44<09:53,  7.06s/it]Best trial: 4. Best value: 0.468241:  17%|█▋        | 17/100 [02:44<08:51,  6.41s/it]Best trial: 4. Best value: 0.468241:  17%|█▋        | 17/100 [02:55<08:51,  6.41s/it]Best trial: 4. Best value: 0.468241:  18%|█▊        | 18/100 [02:55<10:51,  7.95s/it]Best trial: 4. Best value: 0.468241:  18%|█▊        | 18/100 [02:58<10:51,  7.95s/it]Best trial: 4. Best value: 0.468241:  19%|█▉        | 19/100 [02:58<08:24,  6.23s/it]Best trial: 4. Best value: 0.468241:  19%|█▉        | 19/100 [03:04<08:24,  6.23s/it]Best trial: 4. Best value: 0.468241:  20%|██        | 20/100 [03:04<08:23,  6.29s/it]Best trial: 4. Best value: 0.468241:  20%|██        | 20/100 [03:28<08:23,  6.29s/it]Best trial: 4. Best value: 0.468241:  21%|██        | 21/100 [03:28<15:12, 11.55s/it]Best trial: 4. Best value: 0.468241:  21%|██        | 21/100 [03:33<15:12, 11.55s/it]Best trial: 4. Best value: 0.468241:  22%|██▏       | 22/100 [03:33<12:33,  9.65s/it]Best trial: 4. Best value: 0.468241:  22%|██▏       | 22/100 [03:39<12:33,  9.65s/it]Best trial: 4. Best value: 0.468241:  23%|██▎       | 23/100 [03:39<10:50,  8.44s/it]Best trial: 4. Best value: 0.468241:  23%|██▎       | 23/100 [03:44<10:50,  8.44s/it]Best trial: 4. Best value: 0.468241:  24%|██▍       | 24/100 [03:44<09:24,  7.42s/it]Best trial: 4. Best value: 0.468241:  24%|██▍       | 24/100 [03:53<09:24,  7.42s/it]Best trial: 4. Best value: 0.468241:  25%|██▌       | 25/100 [03:53<10:08,  8.12s/it]Best trial: 4. Best value: 0.468241:  25%|██▌       | 25/100 [04:00<10:08,  8.12s/it]Best trial: 4. Best value: 0.468241:  26%|██▌       | 26/100 [04:00<09:35,  7.78s/it]Best trial: 4. Best value: 0.468241:  26%|██▌       | 26/100 [04:04<09:35,  7.78s/it]Best trial: 4. Best value: 0.468241:  27%|██▋       | 27/100 [04:04<07:51,  6.46s/it]Best trial: 4. Best value: 0.468241:  27%|██▋       | 27/100 [04:09<07:51,  6.46s/it]Best trial: 4. Best value: 0.468241:  28%|██▊       | 28/100 [04:09<07:26,  6.20s/it]Best trial: 4. Best value: 0.468241:  28%|██▊       | 28/100 [04:18<07:26,  6.20s/it]Best trial: 4. Best value: 0.468241:  29%|██▉       | 29/100 [04:18<08:05,  6.83s/it]Best trial: 4. Best value: 0.468241:  29%|██▉       | 29/100 [04:25<08:05,  6.83s/it]Best trial: 4. Best value: 0.468241:  30%|███       | 30/100 [04:25<07:59,  6.86s/it]Best trial: 4. Best value: 0.468241:  30%|███       | 30/100 [04:27<07:59,  6.86s/it]Best trial: 4. Best value: 0.468241:  31%|███       | 31/100 [04:27<06:26,  5.60s/it]Best trial: 4. Best value: 0.468241:  31%|███       | 31/100 [04:34<06:26,  5.60s/it]Best trial: 4. Best value: 0.468241:  32%|███▏      | 32/100 [04:34<06:44,  5.95s/it]Best trial: 4. Best value: 0.468241:  32%|███▏      | 32/100 [04:39<06:44,  5.95s/it]Best trial: 4. Best value: 0.468241:  33%|███▎      | 33/100 [04:39<06:25,  5.75s/it]Best trial: 4. Best value: 0.468241:  33%|███▎      | 33/100 [04:44<06:25,  5.75s/it]Best trial: 4. Best value: 0.468241:  34%|███▍      | 34/100 [04:44<05:57,  5.42s/it]Best trial: 4. Best value: 0.468241:  34%|███▍      | 34/100 [04:48<05:57,  5.42s/it]Best trial: 4. Best value: 0.468241:  35%|███▌      | 35/100 [04:48<05:29,  5.06s/it]Best trial: 4. Best value: 0.468241:  35%|███▌      | 35/100 [04:54<05:29,  5.06s/it]Best trial: 4. Best value: 0.468241:  36%|███▌      | 36/100 [04:54<05:33,  5.21s/it]Best trial: 4. Best value: 0.468241:  36%|███▌      | 36/100 [05:04<05:33,  5.21s/it]Best trial: 4. Best value: 0.468241:  37%|███▋      | 37/100 [05:04<07:10,  6.83s/it]Best trial: 4. Best value: 0.468241:  37%|███▋      | 37/100 [05:12<07:10,  6.83s/it]Best trial: 4. Best value: 0.468241:  38%|███▊      | 38/100 [05:12<07:24,  7.17s/it]Best trial: 4. Best value: 0.468241:  38%|███▊      | 38/100 [05:23<07:24,  7.17s/it]Best trial: 4. Best value: 0.468241:  39%|███▉      | 39/100 [05:23<08:16,  8.15s/it]Best trial: 4. Best value: 0.468241:  39%|███▉      | 39/100 [05:39<08:16,  8.15s/it]Best trial: 4. Best value: 0.468241:  40%|████      | 40/100 [05:39<10:28, 10.48s/it]Best trial: 4. Best value: 0.468241:  40%|████      | 40/100 [05:57<10:28, 10.48s/it]Best trial: 4. Best value: 0.468241:  41%|████      | 41/100 [05:57<12:30, 12.73s/it]Best trial: 4. Best value: 0.468241:  41%|████      | 41/100 [06:13<12:30, 12.73s/it]Best trial: 4. Best value: 0.468241:  42%|████▏     | 42/100 [06:13<13:17, 13.74s/it]Best trial: 4. Best value: 0.468241:  42%|████▏     | 42/100 [06:23<13:17, 13.74s/it]Best trial: 4. Best value: 0.468241:  43%|████▎     | 43/100 [06:23<12:10, 12.82s/it]Best trial: 4. Best value: 0.468241:  43%|████▎     | 43/100 [06:28<12:10, 12.82s/it]Best trial: 4. Best value: 0.468241:  44%|████▍     | 44/100 [06:28<09:32, 10.23s/it]Best trial: 4. Best value: 0.468241:  44%|████▍     | 44/100 [06:43<09:32, 10.23s/it]Best trial: 4. Best value: 0.468241:  45%|████▌     | 45/100 [06:43<10:41, 11.67s/it]Best trial: 4. Best value: 0.468241:  45%|████▌     | 45/100 [06:47<10:41, 11.67s/it]Best trial: 4. Best value: 0.468241:  46%|████▌     | 46/100 [06:47<08:29,  9.44s/it]Best trial: 46. Best value: 0.469208:  46%|████▌     | 46/100 [06:51<08:29,  9.44s/it]Best trial: 46. Best value: 0.469208:  47%|████▋     | 47/100 [06:51<06:50,  7.74s/it]Best trial: 46. Best value: 0.469208:  47%|████▋     | 47/100 [06:54<06:50,  7.74s/it]Best trial: 46. Best value: 0.469208:  48%|████▊     | 48/100 [06:54<05:34,  6.43s/it]Best trial: 48. Best value: 0.470118:  48%|████▊     | 48/100 [06:58<05:34,  6.43s/it]Best trial: 48. Best value: 0.470118:  49%|████▉     | 49/100 [06:58<04:49,  5.68s/it]Best trial: 49. Best value: 0.471265:  49%|████▉     | 49/100 [07:03<04:49,  5.68s/it]Best trial: 49. Best value: 0.471265:  50%|█████     | 50/100 [07:03<04:42,  5.65s/it]Best trial: 49. Best value: 0.471265:  50%|█████     | 50/100 [07:09<04:42,  5.65s/it]Best trial: 49. Best value: 0.471265:  51%|█████     | 51/100 [07:09<04:28,  5.47s/it]Best trial: 49. Best value: 0.471265:  51%|█████     | 51/100 [07:13<04:28,  5.47s/it]Best trial: 49. Best value: 0.471265:  52%|█████▏    | 52/100 [07:13<04:05,  5.11s/it]Best trial: 49. Best value: 0.471265:  52%|█████▏    | 52/100 [07:16<04:05,  5.11s/it]Best trial: 49. Best value: 0.471265:  53%|█████▎    | 53/100 [07:16<03:29,  4.46s/it]Best trial: 49. Best value: 0.471265:  53%|█████▎    | 53/100 [07:19<03:29,  4.46s/it]Best trial: 49. Best value: 0.471265:  54%|█████▍    | 54/100 [07:19<03:09,  4.12s/it]Best trial: 49. Best value: 0.471265:  54%|█████▍    | 54/100 [07:22<03:09,  4.12s/it]Best trial: 49. Best value: 0.471265:  55%|█████▌    | 55/100 [07:22<02:55,  3.90s/it]Best trial: 49. Best value: 0.471265:  55%|█████▌    | 55/100 [07:26<02:55,  3.90s/it]Best trial: 49. Best value: 0.471265:  56%|█████▌    | 56/100 [07:26<02:48,  3.84s/it]Best trial: 49. Best value: 0.471265:  56%|█████▌    | 56/100 [07:31<02:48,  3.84s/it]Best trial: 49. Best value: 0.471265:  57%|█████▋    | 57/100 [07:31<02:54,  4.05s/it]Best trial: 49. Best value: 0.471265:  57%|█████▋    | 57/100 [07:34<02:54,  4.05s/it]Best trial: 49. Best value: 0.471265:  58%|█████▊    | 58/100 [07:34<02:43,  3.90s/it]Best trial: 49. Best value: 0.471265:  58%|█████▊    | 58/100 [07:39<02:43,  3.90s/it]Best trial: 49. Best value: 0.471265:  59%|█████▉    | 59/100 [07:39<02:49,  4.14s/it]Best trial: 49. Best value: 0.471265:  59%|█████▉    | 59/100 [07:42<02:49,  4.14s/it]Best trial: 49. Best value: 0.471265:  60%|██████    | 60/100 [07:42<02:37,  3.95s/it]Best trial: 60. Best value: 0.473135:  60%|██████    | 60/100 [07:47<02:37,  3.95s/it]Best trial: 60. Best value: 0.473135:  61%|██████    | 61/100 [07:47<02:46,  4.26s/it]Best trial: 60. Best value: 0.473135:  61%|██████    | 61/100 [07:52<02:46,  4.26s/it]Best trial: 60. Best value: 0.473135:  62%|██████▏   | 62/100 [07:52<02:42,  4.27s/it]Best trial: 60. Best value: 0.473135:  62%|██████▏   | 62/100 [07:56<02:42,  4.27s/it]Best trial: 60. Best value: 0.473135:  63%|██████▎   | 63/100 [07:56<02:33,  4.14s/it]Best trial: 60. Best value: 0.473135:  63%|██████▎   | 63/100 [07:59<02:33,  4.14s/it]Best trial: 60. Best value: 0.473135:  64%|██████▍   | 64/100 [07:59<02:23,  3.98s/it]Best trial: 60. Best value: 0.473135:  64%|██████▍   | 64/100 [08:03<02:23,  3.98s/it]Best trial: 60. Best value: 0.473135:  65%|██████▌   | 65/100 [08:03<02:15,  3.87s/it]Best trial: 60. Best value: 0.473135:  65%|██████▌   | 65/100 [08:06<02:15,  3.87s/it]Best trial: 60. Best value: 0.473135:  66%|██████▌   | 66/100 [08:06<02:06,  3.72s/it]Best trial: 60. Best value: 0.473135:  66%|██████▌   | 66/100 [08:10<02:06,  3.72s/it]Best trial: 60. Best value: 0.473135:  67%|██████▋   | 67/100 [08:10<02:04,  3.77s/it]Best trial: 60. Best value: 0.473135:  67%|██████▋   | 67/100 [08:14<02:04,  3.77s/it]Best trial: 60. Best value: 0.473135:  68%|██████▊   | 68/100 [08:14<02:05,  3.93s/it]Best trial: 60. Best value: 0.473135:  68%|██████▊   | 68/100 [08:18<02:05,  3.93s/it]Best trial: 60. Best value: 0.473135:  69%|██████▉   | 69/100 [08:18<02:01,  3.93s/it]Best trial: 60. Best value: 0.473135:  69%|██████▉   | 69/100 [08:22<02:01,  3.93s/it]Best trial: 60. Best value: 0.473135:  70%|███████   | 70/100 [08:22<01:53,  3.79s/it]Best trial: 60. Best value: 0.473135:  70%|███████   | 70/100 [08:26<01:53,  3.79s/it]Best trial: 60. Best value: 0.473135:  71%|███████   | 71/100 [08:26<01:50,  3.82s/it]Best trial: 71. Best value: 0.480776:  71%|███████   | 71/100 [08:29<01:50,  3.82s/it]Best trial: 71. Best value: 0.480776:  72%|███████▏  | 72/100 [08:29<01:43,  3.71s/it]Best trial: 71. Best value: 0.480776:  72%|███████▏  | 72/100 [08:33<01:43,  3.71s/it]Best trial: 71. Best value: 0.480776:  73%|███████▎  | 73/100 [08:33<01:39,  3.69s/it]Best trial: 71. Best value: 0.480776:  73%|███████▎  | 73/100 [08:38<01:39,  3.69s/it]Best trial: 71. Best value: 0.480776:  74%|███████▍  | 74/100 [08:38<01:46,  4.11s/it]Best trial: 71. Best value: 0.480776:  74%|███████▍  | 74/100 [08:43<01:46,  4.11s/it]Best trial: 71. Best value: 0.480776:  75%|███████▌  | 75/100 [08:43<01:47,  4.31s/it]Best trial: 71. Best value: 0.480776:  75%|███████▌  | 75/100 [08:45<01:47,  4.31s/it]Best trial: 71. Best value: 0.480776:  76%|███████▌  | 76/100 [08:45<01:30,  3.77s/it]Best trial: 71. Best value: 0.480776:  76%|███████▌  | 76/100 [08:49<01:30,  3.77s/it]Best trial: 71. Best value: 0.480776:  77%|███████▋  | 77/100 [08:49<01:26,  3.77s/it]Best trial: 71. Best value: 0.480776:  77%|███████▋  | 77/100 [08:52<01:26,  3.77s/it]Best trial: 71. Best value: 0.480776:  78%|███████▊  | 78/100 [08:52<01:18,  3.57s/it]Best trial: 71. Best value: 0.480776:  78%|███████▊  | 78/100 [08:58<01:18,  3.57s/it]Best trial: 71. Best value: 0.480776:  79%|███████▉  | 79/100 [08:58<01:32,  4.41s/it]Best trial: 71. Best value: 0.480776:  79%|███████▉  | 79/100 [09:03<01:32,  4.41s/it]Best trial: 71. Best value: 0.480776:  80%|████████  | 80/100 [09:03<01:29,  4.47s/it]Best trial: 71. Best value: 0.480776:  80%|████████  | 80/100 [09:09<01:29,  4.47s/it]Best trial: 71. Best value: 0.480776:  81%|████████  | 81/100 [09:09<01:32,  4.85s/it]Best trial: 71. Best value: 0.480776:  81%|████████  | 81/100 [09:14<01:32,  4.85s/it]Best trial: 71. Best value: 0.480776:  82%|████████▏ | 82/100 [09:14<01:30,  5.02s/it]Best trial: 82. Best value: 0.483632:  82%|████████▏ | 82/100 [09:19<01:30,  5.02s/it]Best trial: 82. Best value: 0.483632:  83%|████████▎ | 83/100 [09:19<01:24,  4.95s/it]Best trial: 82. Best value: 0.483632:  83%|████████▎ | 83/100 [09:23<01:24,  4.95s/it]Best trial: 82. Best value: 0.483632:  84%|████████▍ | 84/100 [09:23<01:16,  4.77s/it]Best trial: 82. Best value: 0.483632:  84%|████████▍ | 84/100 [09:29<01:16,  4.77s/it]Best trial: 82. Best value: 0.483632:  85%|████████▌ | 85/100 [09:29<01:14,  4.99s/it]Best trial: 82. Best value: 0.483632:  85%|████████▌ | 85/100 [09:32<01:14,  4.99s/it]Best trial: 82. Best value: 0.483632:  86%|████████▌ | 86/100 [09:32<01:03,  4.53s/it]Best trial: 82. Best value: 0.483632:  86%|████████▌ | 86/100 [09:38<01:03,  4.53s/it]Best trial: 82. Best value: 0.483632:  87%|████████▋ | 87/100 [09:38<01:04,  4.95s/it]Best trial: 82. Best value: 0.483632:  87%|████████▋ | 87/100 [09:42<01:04,  4.95s/it]Best trial: 82. Best value: 0.483632:  88%|████████▊ | 88/100 [09:42<00:54,  4.51s/it]Best trial: 82. Best value: 0.483632:  88%|████████▊ | 88/100 [09:50<00:54,  4.51s/it]Best trial: 82. Best value: 0.483632:  89%|████████▉ | 89/100 [09:50<01:02,  5.64s/it]Best trial: 82. Best value: 0.483632:  89%|████████▉ | 89/100 [09:52<01:02,  5.64s/it]Best trial: 82. Best value: 0.483632:  90%|█████████ | 90/100 [09:52<00:46,  4.60s/it]Best trial: 82. Best value: 0.483632:  90%|█████████ | 90/100 [10:01<00:46,  4.60s/it]Best trial: 82. Best value: 0.483632:  91%|█████████ | 91/100 [10:01<00:51,  5.77s/it]Best trial: 82. Best value: 0.483632:  91%|█████████ | 91/100 [10:06<00:51,  5.77s/it]Best trial: 82. Best value: 0.483632:  92%|█████████▏| 92/100 [10:06<00:45,  5.63s/it]Best trial: 82. Best value: 0.483632:  92%|█████████▏| 92/100 [10:10<00:45,  5.63s/it]Best trial: 82. Best value: 0.483632:  93%|█████████▎| 93/100 [10:10<00:36,  5.19s/it]Best trial: 82. Best value: 0.483632:  93%|█████████▎| 93/100 [10:13<00:36,  5.19s/it]Best trial: 82. Best value: 0.483632:  94%|█████████▍| 94/100 [10:13<00:27,  4.65s/it]Best trial: 82. Best value: 0.483632:  94%|█████████▍| 94/100 [10:17<00:27,  4.65s/it]Best trial: 82. Best value: 0.483632:  95%|█████████▌| 95/100 [10:17<00:21,  4.27s/it]Best trial: 82. Best value: 0.483632:  95%|█████████▌| 95/100 [10:20<00:21,  4.27s/it]Best trial: 82. Best value: 0.483632:  96%|█████████▌| 96/100 [10:20<00:16,  4.05s/it]Best trial: 82. Best value: 0.483632:  96%|█████████▌| 96/100 [10:23<00:16,  4.05s/it]Best trial: 82. Best value: 0.483632:  97%|█████████▋| 97/100 [10:23<00:11,  3.69s/it]Best trial: 82. Best value: 0.483632:  97%|█████████▋| 97/100 [10:27<00:11,  3.69s/it]Best trial: 82. Best value: 0.483632:  98%|█████████▊| 98/100 [10:27<00:07,  3.71s/it]Best trial: 82. Best value: 0.483632:  98%|█████████▊| 98/100 [10:31<00:07,  3.71s/it]Best trial: 82. Best value: 0.483632:  99%|█████████▉| 99/100 [10:31<00:03,  3.67s/it]Best trial: 82. Best value: 0.483632:  99%|█████████▉| 99/100 [10:34<00:03,  3.67s/it]Best trial: 82. Best value: 0.483632: 100%|██████████| 100/100 [10:34<00:00,  3.49s/it]Best trial: 82. Best value: 0.483632: 100%|██████████| 100/100 [10:34<00:00,  6.34s/it]
2025-11-30 21:44:54,711 - INFO - HPO Complete. Best AUPRC: 0.4836
2025-11-30 21:44:54,712 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.05028028263541342, 'max_depth': 3, 'subsample': 0.8415692103407633, 'colsample_bytree': 0.9705022135221684, 'gamma': 4.72547165789115, 'reg_lambda': 4.502656493048576e-06, 'reg_alpha': 1.113194311982009e-07}
2025-11-30 21:44:54,712 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 21:44:56,560 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: monitors_only
2025-11-30 21:44:56,561 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:44:56,754 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:44:56,793 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:44:56,800 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-11-30 21:44:56,800 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 21:44:56,800 - INFO - Training model...
2025-11-30 21:44:59,653 - INFO - Evaluating model with bootstrapping...
2025-11-30 21:45:05,348 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 21:45:05,348 - INFO - AUROC: 0.7073 (0.6425 - 0.7420)
2025-11-30 21:45:05,348 - INFO - AUPRC: 0.4651 (0.3653 - 0.5454)
2025-11-30 21:45:05,348 - INFO - Brier Score: 0.1710 (0.1617 - 0.1860)
2025-11-30 21:45:05,348 - INFO - Accuracy: 0.7327 (0.6439 - 0.7578)
2025-11-30 21:45:05,348 - INFO - Precision: 0.4322 (0.3451 - 0.4991)
2025-11-30 21:45:05,348 - INFO - Sensitivity (Recall): 0.5443 (0.4701 - 0.6582)
2025-11-30 21:45:05,348 - INFO - F1-Score: 0.4818 (0.4110 - 0.5320)
2025-11-30 21:45:05,348 - INFO - Best Threshold: 0.4200 (0.3120 - 0.4640)
2025-11-30 21:45:05,348 - INFO - Specificity: 0.7884 (0.6489 - 0.8346)
2025-11-30 21:45:05,367 - INFO - Calculating SHAP values...
2025-11-30 21:45:06,546 - INFO - SHAP plots saved.
2025-11-30 21:45:06,547 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 21:45:07,979 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 21:45:07,979 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 21:45:08,190 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 21:45:08,225 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 21:45:08,234 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 21:45:08,234 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.57563:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.57563:   1%|          | 1/100 [00:05<09:31,  5.77s/it]Best trial: 1. Best value: 0.578809:   1%|          | 1/100 [00:17<09:31,  5.77s/it]Best trial: 1. Best value: 0.578809:   2%|▏         | 2/100 [00:17<15:21,  9.40s/it]Best trial: 2. Best value: 0.593785:   2%|▏         | 2/100 [00:20<15:21,  9.40s/it]Best trial: 2. Best value: 0.593785:   3%|▎         | 3/100 [00:20<10:05,  6.24s/it]Best trial: 2. Best value: 0.593785:   3%|▎         | 3/100 [00:28<10:05,  6.24s/it]Best trial: 2. Best value: 0.593785:   4%|▍         | 4/100 [00:28<11:30,  7.20s/it]Best trial: 2. Best value: 0.593785:   4%|▍         | 4/100 [00:41<11:30,  7.20s/it]Best trial: 2. Best value: 0.593785:   5%|▌         | 5/100 [00:41<14:39,  9.26s/it]Best trial: 2. Best value: 0.593785:   5%|▌         | 5/100 [00:46<14:39,  9.26s/it]Best trial: 2. Best value: 0.593785:   6%|▌         | 6/100 [00:46<12:03,  7.70s/it]Best trial: 2. Best value: 0.593785:   6%|▌         | 6/100 [00:54<12:03,  7.70s/it]Best trial: 2. Best value: 0.593785:   7%|▋         | 7/100 [00:54<11:54,  7.68s/it]Best trial: 2. Best value: 0.593785:   7%|▋         | 7/100 [00:58<11:54,  7.68s/it]Best trial: 2. Best value: 0.593785:   8%|▊         | 8/100 [00:58<10:12,  6.65s/it]Best trial: 2. Best value: 0.593785:   8%|▊         | 8/100 [01:00<10:12,  6.65s/it]Best trial: 2. Best value: 0.593785:   9%|▉         | 9/100 [01:00<07:47,  5.14s/it]Best trial: 9. Best value: 0.600708:   9%|▉         | 9/100 [01:07<07:47,  5.14s/it]Best trial: 9. Best value: 0.600708:  10%|█         | 10/100 [01:07<08:42,  5.80s/it]Best trial: 9. Best value: 0.600708:  10%|█         | 10/100 [01:10<08:42,  5.80s/it]Best trial: 9. Best value: 0.600708:  11%|█         | 11/100 [01:10<07:18,  4.92s/it]Best trial: 9. Best value: 0.600708:  11%|█         | 11/100 [01:14<07:18,  4.92s/it]Best trial: 9. Best value: 0.600708:  12%|█▏        | 12/100 [01:14<06:34,  4.49s/it]Best trial: 9. Best value: 0.600708:  12%|█▏        | 12/100 [01:17<06:34,  4.49s/it]Best trial: 9. Best value: 0.600708:  13%|█▎        | 13/100 [01:17<06:08,  4.23s/it]Best trial: 9. Best value: 0.600708:  13%|█▎        | 13/100 [01:22<06:08,  4.23s/it]Best trial: 9. Best value: 0.600708:  14%|█▍        | 14/100 [01:22<06:06,  4.26s/it]Best trial: 9. Best value: 0.600708:  14%|█▍        | 14/100 [01:27<06:06,  4.26s/it]Best trial: 9. Best value: 0.600708:  15%|█▌        | 15/100 [01:27<06:36,  4.66s/it]Best trial: 9. Best value: 0.600708:  15%|█▌        | 15/100 [01:30<06:36,  4.66s/it]Best trial: 9. Best value: 0.600708:  16%|█▌        | 16/100 [01:30<05:54,  4.22s/it]Best trial: 9. Best value: 0.600708:  16%|█▌        | 16/100 [01:34<05:54,  4.22s/it]Best trial: 9. Best value: 0.600708:  17%|█▋        | 17/100 [01:34<05:31,  3.99s/it]Best trial: 17. Best value: 0.604739:  17%|█▋        | 17/100 [01:50<05:31,  3.99s/it]Best trial: 17. Best value: 0.604739:  18%|█▊        | 18/100 [01:50<10:36,  7.77s/it]Best trial: 17. Best value: 0.604739:  18%|█▊        | 18/100 [02:05<10:36,  7.77s/it]Best trial: 17. Best value: 0.604739:  19%|█▉        | 19/100 [02:05<13:08,  9.73s/it]Best trial: 17. Best value: 0.604739:  19%|█▉        | 19/100 [02:16<13:08,  9.73s/it]Best trial: 17. Best value: 0.604739:  20%|██        | 20/100 [02:16<13:42, 10.28s/it]Best trial: 17. Best value: 0.604739:  20%|██        | 20/100 [02:29<13:42, 10.28s/it]Best trial: 17. Best value: 0.604739:  21%|██        | 21/100 [02:29<14:21, 10.90s/it]Best trial: 17. Best value: 0.604739:  21%|██        | 21/100 [02:45<14:21, 10.90s/it]Best trial: 17. Best value: 0.604739:  22%|██▏       | 22/100 [02:45<16:14, 12.49s/it]Best trial: 17. Best value: 0.604739:  22%|██▏       | 22/100 [02:59<16:14, 12.49s/it]Best trial: 17. Best value: 0.604739:  23%|██▎       | 23/100 [02:59<16:30, 12.87s/it]Best trial: 17. Best value: 0.604739:  23%|██▎       | 23/100 [03:10<16:30, 12.87s/it]Best trial: 17. Best value: 0.604739:  24%|██▍       | 24/100 [03:10<15:48, 12.48s/it]Best trial: 17. Best value: 0.604739:  24%|██▍       | 24/100 [03:20<15:48, 12.48s/it]Best trial: 17. Best value: 0.604739:  25%|██▌       | 25/100 [03:20<14:32, 11.63s/it]Best trial: 17. Best value: 0.604739:  25%|██▌       | 25/100 [03:30<14:32, 11.63s/it]Best trial: 17. Best value: 0.604739:  26%|██▌       | 26/100 [03:30<14:00, 11.36s/it]Best trial: 17. Best value: 0.604739:  26%|██▌       | 26/100 [03:40<14:00, 11.36s/it]Best trial: 17. Best value: 0.604739:  27%|██▋       | 27/100 [03:40<13:01, 10.71s/it]Best trial: 17. Best value: 0.604739:  27%|██▋       | 27/100 [03:55<13:01, 10.71s/it]Best trial: 17. Best value: 0.604739:  28%|██▊       | 28/100 [03:55<14:38, 12.20s/it]Best trial: 17. Best value: 0.604739:  28%|██▊       | 28/100 [04:11<14:38, 12.20s/it]Best trial: 17. Best value: 0.604739:  29%|██▉       | 29/100 [04:11<15:42, 13.28s/it]Best trial: 17. Best value: 0.604739:  29%|██▉       | 29/100 [04:24<15:42, 13.28s/it]Best trial: 17. Best value: 0.604739:  30%|███       | 30/100 [04:24<15:13, 13.05s/it]Best trial: 17. Best value: 0.604739:  30%|███       | 30/100 [04:28<15:13, 13.05s/it]Best trial: 17. Best value: 0.604739:  31%|███       | 31/100 [04:28<11:58, 10.42s/it]Best trial: 17. Best value: 0.604739:  31%|███       | 31/100 [04:32<11:58, 10.42s/it]Best trial: 17. Best value: 0.604739:  32%|███▏      | 32/100 [04:32<09:38,  8.51s/it]Best trial: 17. Best value: 0.604739:  32%|███▏      | 32/100 [04:36<09:38,  8.51s/it]Best trial: 17. Best value: 0.604739:  33%|███▎      | 33/100 [04:36<07:54,  7.08s/it]Best trial: 17. Best value: 0.604739:  33%|███▎      | 33/100 [04:41<07:54,  7.08s/it]Best trial: 17. Best value: 0.604739:  34%|███▍      | 34/100 [04:41<07:02,  6.40s/it]Best trial: 17. Best value: 0.604739:  34%|███▍      | 34/100 [04:53<07:02,  6.40s/it]Best trial: 17. Best value: 0.604739:  35%|███▌      | 35/100 [04:53<08:53,  8.21s/it]Best trial: 17. Best value: 0.604739:  35%|███▌      | 35/100 [05:01<08:53,  8.21s/it]Best trial: 17. Best value: 0.604739:  36%|███▌      | 36/100 [05:01<08:35,  8.06s/it]Best trial: 17. Best value: 0.604739:  36%|███▌      | 36/100 [05:12<08:35,  8.06s/it]Best trial: 17. Best value: 0.604739:  37%|███▋      | 37/100 [05:12<09:27,  9.01s/it]Best trial: 17. Best value: 0.604739:  37%|███▋      | 37/100 [05:19<09:27,  9.01s/it]Best trial: 17. Best value: 0.604739:  38%|███▊      | 38/100 [05:19<08:34,  8.30s/it]Best trial: 17. Best value: 0.604739:  38%|███▊      | 38/100 [05:26<08:34,  8.30s/it]Best trial: 17. Best value: 0.604739:  39%|███▉      | 39/100 [05:26<08:12,  8.08s/it]Best trial: 17. Best value: 0.604739:  39%|███▉      | 39/100 [05:36<08:12,  8.08s/it]Best trial: 17. Best value: 0.604739:  40%|████      | 40/100 [05:36<08:39,  8.65s/it]Best trial: 17. Best value: 0.604739:  40%|████      | 40/100 [05:44<08:39,  8.65s/it]Best trial: 17. Best value: 0.604739:  41%|████      | 41/100 [05:44<08:15,  8.40s/it]Best trial: 17. Best value: 0.604739:  41%|████      | 41/100 [05:50<08:15,  8.40s/it]Best trial: 17. Best value: 0.604739:  42%|████▏     | 42/100 [05:50<07:31,  7.78s/it]Best trial: 17. Best value: 0.604739:  42%|████▏     | 42/100 [05:59<07:31,  7.78s/it]Best trial: 17. Best value: 0.604739:  43%|████▎     | 43/100 [05:59<07:32,  7.93s/it]Best trial: 17. Best value: 0.604739:  43%|████▎     | 43/100 [06:11<07:32,  7.93s/it]Best trial: 17. Best value: 0.604739:  44%|████▍     | 44/100 [06:11<08:37,  9.23s/it]Best trial: 17. Best value: 0.604739:  44%|████▍     | 44/100 [06:16<08:37,  9.23s/it]Best trial: 17. Best value: 0.604739:  45%|████▌     | 45/100 [06:16<07:23,  8.06s/it]Best trial: 17. Best value: 0.604739:  45%|████▌     | 45/100 [06:31<07:23,  8.06s/it]Best trial: 17. Best value: 0.604739:  46%|████▌     | 46/100 [06:31<09:05, 10.10s/it]Best trial: 17. Best value: 0.604739:  46%|████▌     | 46/100 [06:39<09:05, 10.10s/it]Best trial: 17. Best value: 0.604739:  47%|████▋     | 47/100 [06:39<08:23,  9.51s/it]Best trial: 17. Best value: 0.604739:  47%|████▋     | 47/100 [06:47<08:23,  9.51s/it]Best trial: 17. Best value: 0.604739:  48%|████▊     | 48/100 [06:47<07:47,  8.99s/it]Best trial: 17. Best value: 0.604739:  48%|████▊     | 48/100 [07:02<07:47,  8.99s/it]Best trial: 17. Best value: 0.604739:  49%|████▉     | 49/100 [07:02<09:05, 10.69s/it]Best trial: 17. Best value: 0.604739:  49%|████▉     | 49/100 [07:14<09:05, 10.69s/it]Best trial: 17. Best value: 0.604739:  50%|█████     | 50/100 [07:14<09:18, 11.18s/it]Best trial: 17. Best value: 0.604739:  50%|█████     | 50/100 [07:20<09:18, 11.18s/it]Best trial: 17. Best value: 0.604739:  51%|█████     | 51/100 [07:20<07:50,  9.60s/it]Best trial: 17. Best value: 0.604739:  51%|█████     | 51/100 [07:33<07:50,  9.60s/it]Best trial: 17. Best value: 0.604739:  52%|█████▏    | 52/100 [07:33<08:25, 10.54s/it]Best trial: 17. Best value: 0.604739:  52%|█████▏    | 52/100 [07:44<08:25, 10.54s/it]Best trial: 17. Best value: 0.604739:  53%|█████▎    | 53/100 [07:44<08:29, 10.84s/it]Best trial: 17. Best value: 0.604739:  53%|█████▎    | 53/100 [07:51<08:29, 10.84s/it]Best trial: 17. Best value: 0.604739:  54%|█████▍    | 54/100 [07:51<07:22,  9.63s/it]Best trial: 17. Best value: 0.604739:  54%|█████▍    | 54/100 [07:58<07:22,  9.63s/it]Best trial: 17. Best value: 0.604739:  55%|█████▌    | 55/100 [07:58<06:41,  8.91s/it]Best trial: 17. Best value: 0.604739:  55%|█████▌    | 55/100 [08:05<06:41,  8.91s/it]Best trial: 17. Best value: 0.604739:  56%|█████▌    | 56/100 [08:05<06:02,  8.23s/it]Best trial: 17. Best value: 0.604739:  56%|█████▌    | 56/100 [08:14<06:02,  8.23s/it]Best trial: 17. Best value: 0.604739:  57%|█████▋    | 57/100 [08:14<06:11,  8.64s/it]Best trial: 17. Best value: 0.604739:  57%|█████▋    | 57/100 [08:26<06:11,  8.64s/it]Best trial: 17. Best value: 0.604739:  58%|█████▊    | 58/100 [08:26<06:38,  9.49s/it]Best trial: 17. Best value: 0.604739:  58%|█████▊    | 58/100 [08:50<06:38,  9.49s/it]Best trial: 17. Best value: 0.604739:  59%|█████▉    | 59/100 [08:50<09:35, 14.04s/it]Best trial: 17. Best value: 0.604739:  59%|█████▉    | 59/100 [08:58<09:35, 14.04s/it]Best trial: 17. Best value: 0.604739:  60%|██████    | 60/100 [08:58<08:05, 12.13s/it]Best trial: 17. Best value: 0.604739:  60%|██████    | 60/100 [09:08<08:05, 12.13s/it]Best trial: 17. Best value: 0.604739:  61%|██████    | 61/100 [09:08<07:23, 11.38s/it]Best trial: 17. Best value: 0.604739:  61%|██████    | 61/100 [09:21<07:23, 11.38s/it]Best trial: 17. Best value: 0.604739:  62%|██████▏   | 62/100 [09:21<07:30, 11.86s/it]Best trial: 17. Best value: 0.604739:  62%|██████▏   | 62/100 [09:28<07:30, 11.86s/it]Best trial: 17. Best value: 0.604739:  63%|██████▎   | 63/100 [09:28<06:28, 10.50s/it]Best trial: 17. Best value: 0.604739:  63%|██████▎   | 63/100 [09:34<06:28, 10.50s/it]Best trial: 17. Best value: 0.604739:  64%|██████▍   | 64/100 [09:34<05:31,  9.21s/it]Best trial: 17. Best value: 0.604739:  64%|██████▍   | 64/100 [09:48<05:31,  9.21s/it]Best trial: 17. Best value: 0.604739:  65%|██████▌   | 65/100 [09:48<06:13, 10.67s/it]Best trial: 17. Best value: 0.604739:  65%|██████▌   | 65/100 [09:55<06:13, 10.67s/it]Best trial: 17. Best value: 0.604739:  66%|██████▌   | 66/100 [09:55<05:16,  9.31s/it]Best trial: 17. Best value: 0.604739:  66%|██████▌   | 66/100 [10:07<05:16,  9.31s/it]Best trial: 17. Best value: 0.604739:  67%|██████▋   | 67/100 [10:07<05:38, 10.26s/it]Best trial: 17. Best value: 0.604739:  67%|██████▋   | 67/100 [10:22<05:38, 10.26s/it]Best trial: 17. Best value: 0.604739:  68%|██████▊   | 68/100 [10:22<06:14, 11.70s/it]Best trial: 17. Best value: 0.604739:  68%|██████▊   | 68/100 [10:30<06:14, 11.70s/it]Best trial: 17. Best value: 0.604739:  69%|██████▉   | 69/100 [10:30<05:24, 10.47s/it]Best trial: 17. Best value: 0.604739:  69%|██████▉   | 69/100 [10:42<05:24, 10.47s/it]Best trial: 17. Best value: 0.604739:  70%|███████   | 70/100 [10:42<05:32, 11.07s/it]Best trial: 17. Best value: 0.604739:  70%|███████   | 70/100 [10:47<05:32, 11.07s/it]Best trial: 17. Best value: 0.604739:  71%|███████   | 71/100 [10:47<04:29,  9.31s/it]Best trial: 17. Best value: 0.604739:  71%|███████   | 71/100 [10:54<04:29,  9.31s/it]Best trial: 17. Best value: 0.604739:  72%|███████▏  | 72/100 [10:54<03:57,  8.48s/it]Best trial: 17. Best value: 0.604739:  72%|███████▏  | 72/100 [11:03<03:57,  8.48s/it]Best trial: 17. Best value: 0.604739:  73%|███████▎  | 73/100 [11:03<03:55,  8.71s/it]Best trial: 17. Best value: 0.604739:  73%|███████▎  | 73/100 [11:09<03:55,  8.71s/it]Best trial: 17. Best value: 0.604739:  74%|███████▍  | 74/100 [11:09<03:21,  7.77s/it]Best trial: 17. Best value: 0.604739:  74%|███████▍  | 74/100 [11:16<03:21,  7.77s/it]Best trial: 17. Best value: 0.604739:  75%|███████▌  | 75/100 [11:16<03:09,  7.59s/it]Best trial: 17. Best value: 0.604739:  75%|███████▌  | 75/100 [11:36<03:09,  7.59s/it]Best trial: 17. Best value: 0.604739:  76%|███████▌  | 76/100 [11:36<04:35, 11.48s/it]Best trial: 17. Best value: 0.604739:  76%|███████▌  | 76/100 [11:50<04:35, 11.48s/it]Best trial: 17. Best value: 0.604739:  77%|███████▋  | 77/100 [11:50<04:35, 11.98s/it]Best trial: 17. Best value: 0.604739:  77%|███████▋  | 77/100 [11:58<04:35, 11.98s/it]Best trial: 17. Best value: 0.604739:  78%|███████▊  | 78/100 [11:58<03:58, 10.85s/it]Best trial: 17. Best value: 0.604739:  78%|███████▊  | 78/100 [12:07<03:58, 10.85s/it]Best trial: 17. Best value: 0.604739:  79%|███████▉  | 79/100 [12:07<03:38, 10.39s/it]Best trial: 17. Best value: 0.604739:  79%|███████▉  | 79/100 [12:23<03:38, 10.39s/it]Best trial: 17. Best value: 0.604739:  80%|████████  | 80/100 [12:23<03:59, 11.96s/it]Best trial: 17. Best value: 0.604739:  80%|████████  | 80/100 [12:38<03:59, 11.96s/it]Best trial: 17. Best value: 0.604739:  81%|████████  | 81/100 [12:38<04:06, 12.97s/it]Best trial: 17. Best value: 0.604739:  81%|████████  | 81/100 [12:49<04:06, 12.97s/it]Best trial: 17. Best value: 0.604739:  82%|████████▏ | 82/100 [12:49<03:41, 12.32s/it]Best trial: 17. Best value: 0.604739:  82%|████████▏ | 82/100 [13:00<03:41, 12.32s/it]Best trial: 17. Best value: 0.604739:  83%|████████▎ | 83/100 [13:00<03:26, 12.13s/it]Best trial: 17. Best value: 0.604739:  83%|████████▎ | 83/100 [13:10<03:26, 12.13s/it]Best trial: 17. Best value: 0.604739:  84%|████████▍ | 84/100 [13:10<03:01, 11.35s/it]Best trial: 17. Best value: 0.604739:  84%|████████▍ | 84/100 [13:24<03:01, 11.35s/it]Best trial: 17. Best value: 0.604739:  85%|████████▌ | 85/100 [13:24<03:02, 12.15s/it]Best trial: 17. Best value: 0.604739:  85%|████████▌ | 85/100 [13:40<03:02, 12.15s/it]Best trial: 17. Best value: 0.604739:  86%|████████▌ | 86/100 [13:40<03:06, 13.34s/it]Best trial: 17. Best value: 0.604739:  86%|████████▌ | 86/100 [14:09<03:06, 13.34s/it]Best trial: 17. Best value: 0.604739:  87%|████████▋ | 87/100 [14:09<03:52, 17.85s/it]Best trial: 17. Best value: 0.604739:  87%|████████▋ | 87/100 [14:21<03:52, 17.85s/it]Best trial: 17. Best value: 0.604739:  88%|████████▊ | 88/100 [14:21<03:14, 16.20s/it]Best trial: 17. Best value: 0.604739:  88%|████████▊ | 88/100 [14:28<03:14, 16.20s/it]Best trial: 17. Best value: 0.604739:  89%|████████▉ | 89/100 [14:28<02:27, 13.45s/it]Best trial: 17. Best value: 0.604739:  89%|████████▉ | 89/100 [14:45<02:27, 13.45s/it]Best trial: 17. Best value: 0.604739:  90%|█████████ | 90/100 [14:45<02:26, 14.61s/it]Best trial: 17. Best value: 0.604739:  90%|█████████ | 90/100 [14:53<02:26, 14.61s/it]Best trial: 17. Best value: 0.604739:  91%|█████████ | 91/100 [14:53<01:52, 12.53s/it]Best trial: 17. Best value: 0.604739:  91%|█████████ | 91/100 [15:05<01:52, 12.53s/it]Best trial: 17. Best value: 0.604739:  92%|█████████▏| 92/100 [15:05<01:39, 12.41s/it]Best trial: 17. Best value: 0.604739:  92%|█████████▏| 92/100 [15:20<01:39, 12.41s/it]Best trial: 17. Best value: 0.604739:  93%|█████████▎| 93/100 [15:20<01:32, 13.21s/it]Best trial: 17. Best value: 0.604739:  93%|█████████▎| 93/100 [15:35<01:32, 13.21s/it]Best trial: 17. Best value: 0.604739:  94%|█████████▍| 94/100 [15:35<01:21, 13.63s/it]Best trial: 17. Best value: 0.604739:  94%|█████████▍| 94/100 [15:41<01:21, 13.63s/it]Best trial: 17. Best value: 0.604739:  95%|█████████▌| 95/100 [15:41<00:57, 11.51s/it]Best trial: 17. Best value: 0.604739:  95%|█████████▌| 95/100 [15:56<00:57, 11.51s/it]Best trial: 17. Best value: 0.604739:  96%|█████████▌| 96/100 [15:56<00:49, 12.45s/it]Best trial: 17. Best value: 0.604739:  96%|█████████▌| 96/100 [16:10<00:49, 12.45s/it]Best trial: 17. Best value: 0.604739:  97%|█████████▋| 97/100 [16:10<00:38, 12.92s/it]Best trial: 97. Best value: 0.608683:  97%|█████████▋| 97/100 [16:23<00:38, 12.92s/it]Best trial: 97. Best value: 0.608683:  98%|█████████▊| 98/100 [16:23<00:26, 13.03s/it]Best trial: 97. Best value: 0.608683:  98%|█████████▊| 98/100 [16:33<00:26, 13.03s/it]Best trial: 97. Best value: 0.608683:  99%|█████████▉| 99/100 [16:33<00:12, 12.11s/it]Best trial: 97. Best value: 0.608683:  99%|█████████▉| 99/100 [16:45<00:12, 12.11s/it]Best trial: 97. Best value: 0.608683: 100%|██████████| 100/100 [16:45<00:00, 11.91s/it]Best trial: 97. Best value: 0.608683: 100%|██████████| 100/100 [16:45<00:00, 10.05s/it]
2025-11-30 22:01:53,385 - INFO - HPO Complete. Best AUPRC: 0.6087
2025-11-30 22:01:53,385 - INFO - Best Params: {'n_estimators': 200, 'learning_rate': 0.05131688536142613, 'max_depth': 10, 'subsample': 0.8347695366649578, 'colsample_bytree': 0.6236502406806784, 'gamma': 0.48187649227998425, 'reg_lambda': 6.671370317397563e-05, 'reg_alpha': 2.0109657685361836e-08}
2025-11-30 22:01:53,385 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 22:01:55,267 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_pleth
2025-11-30 22:01:55,268 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:01:55,469 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:01:55,504 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:01:55,512 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:01:55,512 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 22:01:55,513 - INFO - Training model...
2025-11-30 22:01:58,505 - INFO - Evaluating model with bootstrapping...
2025-11-30 22:02:04,074 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 22:02:04,074 - INFO - AUROC: 0.8138 (0.7803 - 0.8476)
2025-11-30 22:02:04,074 - INFO - AUPRC: 0.5692 (0.5063 - 0.6514)
2025-11-30 22:02:04,074 - INFO - Brier Score: 0.1378 (0.1264 - 0.1523)
2025-11-30 22:02:04,074 - INFO - Accuracy: 0.7861 (0.7283 - 0.8182)
2025-11-30 22:02:04,074 - INFO - Precision: 0.5253 (0.4418 - 0.6008)
2025-11-30 22:02:04,074 - INFO - Sensitivity (Recall): 0.6582 (0.5564 - 0.7671)
2025-11-30 22:02:04,074 - INFO - F1-Score: 0.5843 (0.5312 - 0.6414)
2025-11-30 22:02:04,074 - INFO - Best Threshold: 0.2500 (0.1500 - 0.3120)
2025-11-30 22:02:04,074 - INFO - Specificity: 0.8240 (0.7247 - 0.8780)
2025-11-30 22:02:04,091 - INFO - Calculating SHAP values...
2025-11-30 22:02:05,423 - INFO - SHAP plots saved.
2025-11-30 22:02:05,424 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 22:02:06,649 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 22:02:06,649 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:02:06,842 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:02:06,875 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:02:06,884 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:02:06,884 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.574855:   0%|          | 0/100 [00:12<?, ?it/s]Best trial: 0. Best value: 0.574855:   1%|          | 1/100 [00:12<20:39, 12.52s/it]Best trial: 0. Best value: 0.574855:   1%|          | 1/100 [00:16<20:39, 12.52s/it]Best trial: 0. Best value: 0.574855:   2%|▏         | 2/100 [00:16<12:10,  7.46s/it]Best trial: 0. Best value: 0.574855:   2%|▏         | 2/100 [00:18<12:10,  7.46s/it]Best trial: 0. Best value: 0.574855:   3%|▎         | 3/100 [00:18<07:52,  4.87s/it]Best trial: 0. Best value: 0.574855:   3%|▎         | 3/100 [00:27<07:52,  4.87s/it]Best trial: 0. Best value: 0.574855:   4%|▍         | 4/100 [00:27<10:44,  6.71s/it]Best trial: 4. Best value: 0.602829:   4%|▍         | 4/100 [00:36<10:44,  6.71s/it]Best trial: 4. Best value: 0.602829:   5%|▌         | 5/100 [00:36<11:31,  7.28s/it]Best trial: 4. Best value: 0.602829:   5%|▌         | 5/100 [00:43<11:31,  7.28s/it]Best trial: 4. Best value: 0.602829:   6%|▌         | 6/100 [00:43<11:41,  7.46s/it]Best trial: 4. Best value: 0.602829:   6%|▌         | 6/100 [00:52<11:41,  7.46s/it]Best trial: 4. Best value: 0.602829:   7%|▋         | 7/100 [00:52<12:22,  7.98s/it]Best trial: 4. Best value: 0.602829:   7%|▋         | 7/100 [00:59<12:22,  7.98s/it]Best trial: 4. Best value: 0.602829:   8%|▊         | 8/100 [00:59<11:32,  7.53s/it]Best trial: 4. Best value: 0.602829:   8%|▊         | 8/100 [01:03<11:32,  7.53s/it]Best trial: 4. Best value: 0.602829:   9%|▉         | 9/100 [01:03<09:32,  6.30s/it]Best trial: 4. Best value: 0.602829:   9%|▉         | 9/100 [01:19<09:32,  6.30s/it]Best trial: 4. Best value: 0.602829:  10%|█         | 10/100 [01:19<14:16,  9.52s/it]Best trial: 10. Best value: 0.603503:  10%|█         | 10/100 [01:27<14:16,  9.52s/it]Best trial: 10. Best value: 0.603503:  11%|█         | 11/100 [01:27<13:22,  9.02s/it]Best trial: 10. Best value: 0.603503:  11%|█         | 11/100 [01:32<13:22,  9.02s/it]Best trial: 10. Best value: 0.603503:  12%|█▏        | 12/100 [01:32<11:21,  7.75s/it]Best trial: 10. Best value: 0.603503:  12%|█▏        | 12/100 [01:41<11:21,  7.75s/it]Best trial: 10. Best value: 0.603503:  13%|█▎        | 13/100 [01:41<11:34,  7.98s/it]Best trial: 13. Best value: 0.606278:  13%|█▎        | 13/100 [01:43<11:34,  7.98s/it]Best trial: 13. Best value: 0.606278:  14%|█▍        | 14/100 [01:43<09:13,  6.43s/it]Best trial: 13. Best value: 0.606278:  14%|█▍        | 14/100 [01:46<09:13,  6.43s/it]Best trial: 13. Best value: 0.606278:  15%|█▌        | 15/100 [01:46<07:39,  5.41s/it]Best trial: 13. Best value: 0.606278:  15%|█▌        | 15/100 [01:50<07:39,  5.41s/it]Best trial: 13. Best value: 0.606278:  16%|█▌        | 16/100 [01:50<06:54,  4.94s/it]Best trial: 13. Best value: 0.606278:  16%|█▌        | 16/100 [01:53<06:54,  4.94s/it]Best trial: 13. Best value: 0.606278:  17%|█▋        | 17/100 [01:53<05:58,  4.32s/it]Best trial: 13. Best value: 0.606278:  17%|█▋        | 17/100 [02:05<05:58,  4.32s/it]Best trial: 13. Best value: 0.606278:  18%|█▊        | 18/100 [02:05<09:01,  6.60s/it]Best trial: 13. Best value: 0.606278:  18%|█▊        | 18/100 [02:09<09:01,  6.60s/it]Best trial: 13. Best value: 0.606278:  19%|█▉        | 19/100 [02:09<07:41,  5.69s/it]Best trial: 13. Best value: 0.606278:  19%|█▉        | 19/100 [02:12<07:41,  5.69s/it]Best trial: 13. Best value: 0.606278:  20%|██        | 20/100 [02:12<06:38,  4.98s/it]Best trial: 13. Best value: 0.606278:  20%|██        | 20/100 [02:14<06:38,  4.98s/it]Best trial: 13. Best value: 0.606278:  21%|██        | 21/100 [02:14<05:22,  4.08s/it]Best trial: 13. Best value: 0.606278:  21%|██        | 21/100 [02:17<05:22,  4.08s/it]Best trial: 13. Best value: 0.606278:  22%|██▏       | 22/100 [02:17<05:05,  3.92s/it]Best trial: 13. Best value: 0.606278:  22%|██▏       | 22/100 [02:20<05:05,  3.92s/it]Best trial: 13. Best value: 0.606278:  23%|██▎       | 23/100 [02:20<04:35,  3.58s/it]Best trial: 13. Best value: 0.606278:  23%|██▎       | 23/100 [02:25<04:35,  3.58s/it]Best trial: 13. Best value: 0.606278:  24%|██▍       | 24/100 [02:25<04:46,  3.78s/it]Best trial: 13. Best value: 0.606278:  24%|██▍       | 24/100 [02:27<04:46,  3.78s/it]Best trial: 13. Best value: 0.606278:  25%|██▌       | 25/100 [02:27<04:03,  3.25s/it]Best trial: 13. Best value: 0.606278:  25%|██▌       | 25/100 [02:30<04:03,  3.25s/it]Best trial: 13. Best value: 0.606278:  26%|██▌       | 26/100 [02:30<04:11,  3.40s/it]Best trial: 13. Best value: 0.606278:  26%|██▌       | 26/100 [02:37<04:11,  3.40s/it]Best trial: 13. Best value: 0.606278:  27%|██▋       | 27/100 [02:37<05:20,  4.40s/it]Best trial: 13. Best value: 0.606278:  27%|██▋       | 27/100 [02:43<05:20,  4.40s/it]Best trial: 13. Best value: 0.606278:  28%|██▊       | 28/100 [02:43<05:40,  4.73s/it]Best trial: 13. Best value: 0.606278:  28%|██▊       | 28/100 [02:50<05:40,  4.73s/it]Best trial: 13. Best value: 0.606278:  29%|██▉       | 29/100 [02:50<06:34,  5.55s/it]Best trial: 13. Best value: 0.606278:  29%|██▉       | 29/100 [02:56<06:34,  5.55s/it]Best trial: 13. Best value: 0.606278:  30%|███       | 30/100 [02:56<06:41,  5.74s/it]Best trial: 13. Best value: 0.606278:  30%|███       | 30/100 [03:03<06:41,  5.74s/it]Best trial: 13. Best value: 0.606278:  31%|███       | 31/100 [03:03<06:57,  6.06s/it]Best trial: 13. Best value: 0.606278:  31%|███       | 31/100 [03:07<06:57,  6.06s/it]Best trial: 13. Best value: 0.606278:  32%|███▏      | 32/100 [03:07<06:06,  5.38s/it]Best trial: 13. Best value: 0.606278:  32%|███▏      | 32/100 [03:10<06:06,  5.38s/it]Best trial: 13. Best value: 0.606278:  33%|███▎      | 33/100 [03:10<05:26,  4.87s/it]Best trial: 13. Best value: 0.606278:  33%|███▎      | 33/100 [03:16<05:26,  4.87s/it]Best trial: 13. Best value: 0.606278:  34%|███▍      | 34/100 [03:16<05:28,  4.97s/it]Best trial: 34. Best value: 0.606678:  34%|███▍      | 34/100 [03:19<05:28,  4.97s/it]Best trial: 34. Best value: 0.606678:  35%|███▌      | 35/100 [03:19<04:50,  4.47s/it]Best trial: 34. Best value: 0.606678:  35%|███▌      | 35/100 [03:21<04:50,  4.47s/it]Best trial: 34. Best value: 0.606678:  36%|███▌      | 36/100 [03:21<04:00,  3.76s/it]Best trial: 36. Best value: 0.60881:  36%|███▌      | 36/100 [03:24<04:00,  3.76s/it] Best trial: 36. Best value: 0.60881:  37%|███▋      | 37/100 [03:24<03:44,  3.57s/it]Best trial: 36. Best value: 0.60881:  37%|███▋      | 37/100 [03:28<03:44,  3.57s/it]Best trial: 36. Best value: 0.60881:  38%|███▊      | 38/100 [03:28<03:47,  3.67s/it]Best trial: 36. Best value: 0.60881:  38%|███▊      | 38/100 [03:31<03:47,  3.67s/it]Best trial: 36. Best value: 0.60881:  39%|███▉      | 39/100 [03:31<03:33,  3.50s/it]Best trial: 36. Best value: 0.60881:  39%|███▉      | 39/100 [03:37<03:33,  3.50s/it]Best trial: 36. Best value: 0.60881:  40%|████      | 40/100 [03:37<04:18,  4.30s/it]Best trial: 36. Best value: 0.60881:  40%|████      | 40/100 [03:47<04:18,  4.30s/it]Best trial: 36. Best value: 0.60881:  41%|████      | 41/100 [03:47<05:56,  6.04s/it]Best trial: 36. Best value: 0.60881:  41%|████      | 41/100 [03:51<05:56,  6.04s/it]Best trial: 36. Best value: 0.60881:  42%|████▏     | 42/100 [03:51<05:12,  5.40s/it]Best trial: 42. Best value: 0.609463:  42%|████▏     | 42/100 [03:55<05:12,  5.40s/it]Best trial: 42. Best value: 0.609463:  43%|████▎     | 43/100 [03:55<04:30,  4.75s/it]Best trial: 42. Best value: 0.609463:  43%|████▎     | 43/100 [03:58<04:30,  4.75s/it]Best trial: 42. Best value: 0.609463:  44%|████▍     | 44/100 [03:58<03:57,  4.25s/it]Best trial: 42. Best value: 0.609463:  44%|████▍     | 44/100 [04:02<03:57,  4.25s/it]Best trial: 42. Best value: 0.609463:  45%|████▌     | 45/100 [04:02<03:52,  4.23s/it]Best trial: 42. Best value: 0.609463:  45%|████▌     | 45/100 [04:05<03:52,  4.23s/it]Best trial: 42. Best value: 0.609463:  46%|████▌     | 46/100 [04:05<03:26,  3.83s/it]Best trial: 42. Best value: 0.609463:  46%|████▌     | 46/100 [04:28<03:26,  3.83s/it]Best trial: 42. Best value: 0.609463:  47%|████▋     | 47/100 [04:28<08:28,  9.59s/it]Best trial: 42. Best value: 0.609463:  47%|████▋     | 47/100 [04:32<08:28,  9.59s/it]Best trial: 42. Best value: 0.609463:  48%|████▊     | 48/100 [04:32<06:48,  7.85s/it]Best trial: 42. Best value: 0.609463:  48%|████▊     | 48/100 [04:36<06:48,  7.85s/it]Best trial: 42. Best value: 0.609463:  49%|████▉     | 49/100 [04:36<05:50,  6.88s/it]Best trial: 42. Best value: 0.609463:  49%|████▉     | 49/100 [04:40<05:50,  6.88s/it]Best trial: 42. Best value: 0.609463:  50%|█████     | 50/100 [04:40<05:05,  6.11s/it]Best trial: 42. Best value: 0.609463:  50%|█████     | 50/100 [04:44<05:05,  6.11s/it]Best trial: 42. Best value: 0.609463:  51%|█████     | 51/100 [04:44<04:20,  5.33s/it]Best trial: 42. Best value: 0.609463:  51%|█████     | 51/100 [04:48<04:20,  5.33s/it]Best trial: 42. Best value: 0.609463:  52%|█████▏    | 52/100 [04:48<03:55,  4.91s/it]Best trial: 42. Best value: 0.609463:  52%|█████▏    | 52/100 [04:51<03:55,  4.91s/it]Best trial: 42. Best value: 0.609463:  53%|█████▎    | 53/100 [04:51<03:25,  4.38s/it]Best trial: 42. Best value: 0.609463:  53%|█████▎    | 53/100 [04:55<03:25,  4.38s/it]Best trial: 42. Best value: 0.609463:  54%|█████▍    | 54/100 [04:55<03:20,  4.35s/it]Best trial: 42. Best value: 0.609463:  54%|█████▍    | 54/100 [05:01<03:20,  4.35s/it]Best trial: 42. Best value: 0.609463:  55%|█████▌    | 55/100 [05:01<03:36,  4.82s/it]Best trial: 42. Best value: 0.609463:  55%|█████▌    | 55/100 [05:04<03:36,  4.82s/it]Best trial: 42. Best value: 0.609463:  56%|█████▌    | 56/100 [05:04<03:06,  4.24s/it]Best trial: 42. Best value: 0.609463:  56%|█████▌    | 56/100 [05:09<03:06,  4.24s/it]Best trial: 42. Best value: 0.609463:  57%|█████▋    | 57/100 [05:09<03:05,  4.31s/it]Best trial: 42. Best value: 0.609463:  57%|█████▋    | 57/100 [05:12<03:05,  4.31s/it]Best trial: 42. Best value: 0.609463:  58%|█████▊    | 58/100 [05:12<02:54,  4.15s/it]Best trial: 42. Best value: 0.609463:  58%|█████▊    | 58/100 [05:17<02:54,  4.15s/it]Best trial: 42. Best value: 0.609463:  59%|█████▉    | 59/100 [05:17<02:55,  4.28s/it]Best trial: 42. Best value: 0.609463:  59%|█████▉    | 59/100 [05:21<02:55,  4.28s/it]Best trial: 42. Best value: 0.609463:  60%|██████    | 60/100 [05:21<02:48,  4.21s/it]Best trial: 42. Best value: 0.609463:  60%|██████    | 60/100 [05:24<02:48,  4.21s/it]Best trial: 42. Best value: 0.609463:  61%|██████    | 61/100 [05:24<02:24,  3.71s/it]Best trial: 42. Best value: 0.609463:  61%|██████    | 61/100 [05:26<02:24,  3.71s/it]Best trial: 42. Best value: 0.609463:  62%|██████▏   | 62/100 [05:26<02:04,  3.28s/it]Best trial: 42. Best value: 0.609463:  62%|██████▏   | 62/100 [05:29<02:04,  3.28s/it]Best trial: 42. Best value: 0.609463:  63%|██████▎   | 63/100 [05:29<02:04,  3.35s/it]Best trial: 42. Best value: 0.609463:  63%|██████▎   | 63/100 [05:35<02:04,  3.35s/it]Best trial: 42. Best value: 0.609463:  64%|██████▍   | 64/100 [05:35<02:20,  3.90s/it]Best trial: 42. Best value: 0.609463:  64%|██████▍   | 64/100 [05:41<02:20,  3.90s/it]Best trial: 42. Best value: 0.609463:  65%|██████▌   | 65/100 [05:41<02:41,  4.62s/it]Best trial: 42. Best value: 0.609463:  65%|██████▌   | 65/100 [05:44<02:41,  4.62s/it]Best trial: 42. Best value: 0.609463:  66%|██████▌   | 66/100 [05:44<02:21,  4.17s/it]Best trial: 42. Best value: 0.609463:  66%|██████▌   | 66/100 [05:47<02:21,  4.17s/it]Best trial: 42. Best value: 0.609463:  67%|██████▋   | 67/100 [05:47<02:07,  3.87s/it]Best trial: 42. Best value: 0.609463:  67%|██████▋   | 67/100 [05:55<02:07,  3.87s/it]Best trial: 42. Best value: 0.609463:  68%|██████▊   | 68/100 [05:55<02:38,  4.96s/it]Best trial: 42. Best value: 0.609463:  68%|██████▊   | 68/100 [05:58<02:38,  4.96s/it]Best trial: 42. Best value: 0.609463:  69%|██████▉   | 69/100 [05:58<02:18,  4.47s/it]Best trial: 42. Best value: 0.609463:  69%|██████▉   | 69/100 [06:03<02:18,  4.47s/it]Best trial: 42. Best value: 0.609463:  70%|███████   | 70/100 [06:03<02:23,  4.78s/it]Best trial: 42. Best value: 0.609463:  70%|███████   | 70/100 [06:08<02:23,  4.78s/it]Best trial: 42. Best value: 0.609463:  71%|███████   | 71/100 [06:08<02:15,  4.66s/it]Best trial: 71. Best value: 0.610606:  71%|███████   | 71/100 [06:12<02:15,  4.66s/it]Best trial: 71. Best value: 0.610606:  72%|███████▏  | 72/100 [06:12<02:09,  4.62s/it]Best trial: 71. Best value: 0.610606:  72%|███████▏  | 72/100 [06:16<02:09,  4.62s/it]Best trial: 71. Best value: 0.610606:  73%|███████▎  | 73/100 [06:16<01:59,  4.42s/it]Best trial: 71. Best value: 0.610606:  73%|███████▎  | 73/100 [06:19<01:59,  4.42s/it]Best trial: 71. Best value: 0.610606:  74%|███████▍  | 74/100 [06:19<01:44,  4.01s/it]Best trial: 71. Best value: 0.610606:  74%|███████▍  | 74/100 [06:23<01:44,  4.01s/it]Best trial: 71. Best value: 0.610606:  75%|███████▌  | 75/100 [06:23<01:33,  3.75s/it]Best trial: 71. Best value: 0.610606:  75%|███████▌  | 75/100 [06:26<01:33,  3.75s/it]Best trial: 71. Best value: 0.610606:  76%|███████▌  | 76/100 [06:26<01:27,  3.64s/it]Best trial: 71. Best value: 0.610606:  76%|███████▌  | 76/100 [06:28<01:27,  3.64s/it]Best trial: 71. Best value: 0.610606:  77%|███████▋  | 77/100 [06:28<01:15,  3.26s/it]Best trial: 71. Best value: 0.610606:  77%|███████▋  | 77/100 [06:31<01:15,  3.26s/it]Best trial: 71. Best value: 0.610606:  78%|███████▊  | 78/100 [06:31<01:04,  2.95s/it]Best trial: 71. Best value: 0.610606:  78%|███████▊  | 78/100 [06:33<01:04,  2.95s/it]Best trial: 71. Best value: 0.610606:  79%|███████▉  | 79/100 [06:33<00:56,  2.70s/it]Best trial: 71. Best value: 0.610606:  79%|███████▉  | 79/100 [06:36<00:56,  2.70s/it]Best trial: 71. Best value: 0.610606:  80%|████████  | 80/100 [06:36<00:56,  2.81s/it]Best trial: 71. Best value: 0.610606:  80%|████████  | 80/100 [06:39<00:56,  2.81s/it]Best trial: 71. Best value: 0.610606:  81%|████████  | 81/100 [06:39<00:58,  3.08s/it]Best trial: 71. Best value: 0.610606:  81%|████████  | 81/100 [06:43<00:58,  3.08s/it]Best trial: 71. Best value: 0.610606:  82%|████████▏ | 82/100 [06:43<00:56,  3.13s/it]Best trial: 71. Best value: 0.610606:  82%|████████▏ | 82/100 [06:46<00:56,  3.13s/it]Best trial: 71. Best value: 0.610606:  83%|████████▎ | 83/100 [06:46<00:53,  3.17s/it]Best trial: 71. Best value: 0.610606:  83%|████████▎ | 83/100 [06:49<00:53,  3.17s/it]Best trial: 71. Best value: 0.610606:  84%|████████▍ | 84/100 [06:49<00:52,  3.26s/it]Best trial: 71. Best value: 0.610606:  84%|████████▍ | 84/100 [06:53<00:52,  3.26s/it]Best trial: 71. Best value: 0.610606:  85%|████████▌ | 85/100 [06:53<00:48,  3.24s/it]Best trial: 71. Best value: 0.610606:  85%|████████▌ | 85/100 [06:57<00:48,  3.24s/it]Best trial: 71. Best value: 0.610606:  86%|████████▌ | 86/100 [06:57<00:48,  3.45s/it]Best trial: 71. Best value: 0.610606:  86%|████████▌ | 86/100 [07:01<00:48,  3.45s/it]Best trial: 71. Best value: 0.610606:  87%|████████▋ | 87/100 [07:01<00:49,  3.79s/it]Best trial: 71. Best value: 0.610606:  87%|████████▋ | 87/100 [07:06<00:49,  3.79s/it]Best trial: 71. Best value: 0.610606:  88%|████████▊ | 88/100 [07:06<00:47,  3.98s/it]Best trial: 71. Best value: 0.610606:  88%|████████▊ | 88/100 [07:11<00:47,  3.98s/it]Best trial: 71. Best value: 0.610606:  89%|████████▉ | 89/100 [07:11<00:49,  4.51s/it]Best trial: 71. Best value: 0.610606:  89%|████████▉ | 89/100 [07:17<00:49,  4.51s/it]Best trial: 71. Best value: 0.610606:  90%|█████████ | 90/100 [07:17<00:47,  4.74s/it]Best trial: 71. Best value: 0.610606:  90%|█████████ | 90/100 [07:20<00:47,  4.74s/it]Best trial: 71. Best value: 0.610606:  91%|█████████ | 91/100 [07:20<00:39,  4.41s/it]Best trial: 71. Best value: 0.610606:  91%|█████████ | 91/100 [07:24<00:39,  4.41s/it]Best trial: 71. Best value: 0.610606:  92%|█████████▏| 92/100 [07:24<00:32,  4.11s/it]Best trial: 71. Best value: 0.610606:  92%|█████████▏| 92/100 [07:27<00:32,  4.11s/it]Best trial: 71. Best value: 0.610606:  93%|█████████▎| 93/100 [07:27<00:27,  3.87s/it]Best trial: 71. Best value: 0.610606:  93%|█████████▎| 93/100 [07:33<00:27,  3.87s/it]Best trial: 71. Best value: 0.610606:  94%|█████████▍| 94/100 [07:33<00:26,  4.40s/it]Best trial: 71. Best value: 0.610606:  94%|█████████▍| 94/100 [07:37<00:26,  4.40s/it]Best trial: 71. Best value: 0.610606:  95%|█████████▌| 95/100 [07:37<00:22,  4.50s/it]Best trial: 71. Best value: 0.610606:  95%|█████████▌| 95/100 [07:43<00:22,  4.50s/it]Best trial: 71. Best value: 0.610606:  96%|█████████▌| 96/100 [07:43<00:19,  4.76s/it]Best trial: 71. Best value: 0.610606:  96%|█████████▌| 96/100 [07:46<00:19,  4.76s/it]Best trial: 71. Best value: 0.610606:  97%|█████████▋| 97/100 [07:46<00:13,  4.44s/it]Best trial: 71. Best value: 0.610606:  97%|█████████▋| 97/100 [07:54<00:13,  4.44s/it]Best trial: 71. Best value: 0.610606:  98%|█████████▊| 98/100 [07:54<00:10,  5.34s/it]Best trial: 71. Best value: 0.610606:  98%|█████████▊| 98/100 [07:59<00:10,  5.34s/it]Best trial: 71. Best value: 0.610606:  99%|█████████▉| 99/100 [07:59<00:05,  5.35s/it]Best trial: 71. Best value: 0.610606:  99%|█████████▉| 99/100 [08:10<00:05,  5.35s/it]Best trial: 71. Best value: 0.610606: 100%|██████████| 100/100 [08:10<00:00,  7.04s/it]Best trial: 71. Best value: 0.610606: 100%|██████████| 100/100 [08:10<00:00,  4.91s/it]
2025-11-30 22:10:17,522 - INFO - HPO Complete. Best AUPRC: 0.6106
2025-11-30 22:10:17,522 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.0380995852922096, 'max_depth': 3, 'subsample': 0.6676397737537068, 'colsample_bytree': 0.7542030231247008, 'gamma': 0.47109933760826284, 'reg_lambda': 2.0601797332175956e-05, 'reg_alpha': 0.043173650617452826}
2025-11-30 22:10:17,523 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 22:10:19,497 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_ecg
2025-11-30 22:10:19,498 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:10:19,707 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:10:19,744 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:10:19,753 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:10:19,753 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 22:10:19,753 - INFO - Training model...
2025-11-30 22:10:21,311 - INFO - Evaluating model with bootstrapping...
2025-11-30 22:10:26,952 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 22:10:26,952 - INFO - AUROC: 0.7793 (0.7447 - 0.8042)
2025-11-30 22:10:26,952 - INFO - AUPRC: 0.5345 (0.4713 - 0.6094)
2025-11-30 22:10:26,952 - INFO - Brier Score: 0.1573 (0.1483 - 0.1709)
2025-11-30 22:10:26,952 - INFO - Accuracy: 0.7818 (0.6936 - 0.8035)
2025-11-30 22:10:26,952 - INFO - Precision: 0.5202 (0.4000 - 0.5911)
2025-11-30 22:10:26,952 - INFO - Sensitivity (Recall): 0.5696 (0.5127 - 0.7709)
2025-11-30 22:10:26,952 - INFO - F1-Score: 0.5438 (0.5066 - 0.6052)
2025-11-30 22:10:26,952 - INFO - Best Threshold: 0.4800 (0.3000 - 0.5060)
2025-11-30 22:10:26,952 - INFO - Specificity: 0.8446 (0.6809 - 0.8714)
2025-11-30 22:10:26,965 - INFO - Calculating SHAP values...
2025-11-30 22:10:28,093 - INFO - SHAP plots saved.
2025-11-30 22:10:28,095 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 22:10:29,467 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 22:10:29,467 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:10:29,687 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:10:29,729 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:10:29,738 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:10:29,738 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.563931:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.563931:   1%|          | 1/100 [00:04<07:11,  4.36s/it]Best trial: 1. Best value: 0.578093:   1%|          | 1/100 [00:09<07:11,  4.36s/it]Best trial: 1. Best value: 0.578093:   2%|▏         | 2/100 [00:09<08:05,  4.95s/it]Best trial: 2. Best value: 0.581808:   2%|▏         | 2/100 [00:28<08:05,  4.95s/it]Best trial: 2. Best value: 0.581808:   3%|▎         | 3/100 [00:28<18:08, 11.22s/it]Best trial: 3. Best value: 0.600372:   3%|▎         | 3/100 [00:40<18:08, 11.22s/it]Best trial: 3. Best value: 0.600372:   4%|▍         | 4/100 [00:40<18:40, 11.67s/it]Best trial: 3. Best value: 0.600372:   4%|▍         | 4/100 [00:42<18:40, 11.67s/it]Best trial: 3. Best value: 0.600372:   5%|▌         | 5/100 [00:42<13:00,  8.21s/it]Best trial: 5. Best value: 0.61315:   5%|▌         | 5/100 [00:46<13:00,  8.21s/it] Best trial: 5. Best value: 0.61315:   6%|▌         | 6/100 [00:46<10:26,  6.66s/it]Best trial: 5. Best value: 0.61315:   6%|▌         | 6/100 [00:53<10:26,  6.66s/it]Best trial: 5. Best value: 0.61315:   7%|▋         | 7/100 [00:53<10:24,  6.71s/it]Best trial: 5. Best value: 0.61315:   7%|▋         | 7/100 [00:57<10:24,  6.71s/it]Best trial: 5. Best value: 0.61315:   8%|▊         | 8/100 [00:57<09:08,  5.96s/it]Best trial: 5. Best value: 0.61315:   8%|▊         | 8/100 [01:02<09:08,  5.96s/it]Best trial: 5. Best value: 0.61315:   9%|▉         | 9/100 [01:02<08:25,  5.55s/it]Best trial: 5. Best value: 0.61315:   9%|▉         | 9/100 [01:16<08:25,  5.55s/it]Best trial: 5. Best value: 0.61315:  10%|█         | 10/100 [01:16<12:06,  8.07s/it]Best trial: 5. Best value: 0.61315:  10%|█         | 10/100 [01:18<12:06,  8.07s/it]Best trial: 5. Best value: 0.61315:  11%|█         | 11/100 [01:18<09:19,  6.28s/it]Best trial: 5. Best value: 0.61315:  11%|█         | 11/100 [01:22<09:19,  6.28s/it]Best trial: 5. Best value: 0.61315:  12%|█▏        | 12/100 [01:22<08:17,  5.66s/it]Best trial: 5. Best value: 0.61315:  12%|█▏        | 12/100 [01:25<08:17,  5.66s/it]Best trial: 5. Best value: 0.61315:  13%|█▎        | 13/100 [01:25<07:02,  4.85s/it]Best trial: 5. Best value: 0.61315:  13%|█▎        | 13/100 [01:31<07:02,  4.85s/it]Best trial: 5. Best value: 0.61315:  14%|█▍        | 14/100 [01:31<07:18,  5.10s/it]Best trial: 5. Best value: 0.61315:  14%|█▍        | 14/100 [01:34<07:18,  5.10s/it]Best trial: 5. Best value: 0.61315:  15%|█▌        | 15/100 [01:34<06:16,  4.43s/it]Best trial: 5. Best value: 0.61315:  15%|█▌        | 15/100 [01:38<06:16,  4.43s/it]Best trial: 5. Best value: 0.61315:  16%|█▌        | 16/100 [01:38<06:19,  4.51s/it]Best trial: 5. Best value: 0.61315:  16%|█▌        | 16/100 [01:41<06:19,  4.51s/it]Best trial: 5. Best value: 0.61315:  17%|█▋        | 17/100 [01:41<05:19,  3.85s/it]Best trial: 17. Best value: 0.614823:  17%|█▋        | 17/100 [01:47<05:19,  3.85s/it]Best trial: 17. Best value: 0.614823:  18%|█▊        | 18/100 [01:47<06:19,  4.63s/it]Best trial: 17. Best value: 0.614823:  18%|█▊        | 18/100 [01:53<06:19,  4.63s/it]Best trial: 17. Best value: 0.614823:  19%|█▉        | 19/100 [01:53<07:00,  5.19s/it]Best trial: 17. Best value: 0.614823:  19%|█▉        | 19/100 [02:01<07:00,  5.19s/it]Best trial: 17. Best value: 0.614823:  20%|██        | 20/100 [02:01<07:41,  5.77s/it]Best trial: 17. Best value: 0.614823:  20%|██        | 20/100 [02:11<07:41,  5.77s/it]Best trial: 17. Best value: 0.614823:  21%|██        | 21/100 [02:11<09:14,  7.02s/it]Best trial: 17. Best value: 0.614823:  21%|██        | 21/100 [02:17<09:14,  7.02s/it]Best trial: 17. Best value: 0.614823:  22%|██▏       | 22/100 [02:17<09:05,  6.99s/it]Best trial: 17. Best value: 0.614823:  22%|██▏       | 22/100 [02:23<09:05,  6.99s/it]Best trial: 17. Best value: 0.614823:  23%|██▎       | 23/100 [02:23<08:34,  6.68s/it]Best trial: 17. Best value: 0.614823:  23%|██▎       | 23/100 [02:32<08:34,  6.68s/it]Best trial: 17. Best value: 0.614823:  24%|██▍       | 24/100 [02:32<09:09,  7.23s/it]Best trial: 17. Best value: 0.614823:  24%|██▍       | 24/100 [02:36<09:09,  7.23s/it]Best trial: 17. Best value: 0.614823:  25%|██▌       | 25/100 [02:36<07:51,  6.28s/it]Best trial: 17. Best value: 0.614823:  25%|██▌       | 25/100 [02:44<07:51,  6.28s/it]Best trial: 17. Best value: 0.614823:  26%|██▌       | 26/100 [02:44<08:28,  6.88s/it]Best trial: 17. Best value: 0.614823:  26%|██▌       | 26/100 [02:50<08:28,  6.88s/it]Best trial: 17. Best value: 0.614823:  27%|██▋       | 27/100 [02:50<08:02,  6.61s/it]Best trial: 17. Best value: 0.614823:  27%|██▋       | 27/100 [02:53<08:02,  6.61s/it]Best trial: 17. Best value: 0.614823:  28%|██▊       | 28/100 [02:53<06:41,  5.58s/it]Best trial: 17. Best value: 0.614823:  28%|██▊       | 28/100 [02:59<06:41,  5.58s/it]Best trial: 17. Best value: 0.614823:  29%|██▉       | 29/100 [02:59<06:29,  5.49s/it]Best trial: 17. Best value: 0.614823:  29%|██▉       | 29/100 [03:02<06:29,  5.49s/it]Best trial: 17. Best value: 0.614823:  30%|███       | 30/100 [03:02<05:38,  4.83s/it]Best trial: 17. Best value: 0.614823:  30%|███       | 30/100 [03:08<05:38,  4.83s/it]Best trial: 17. Best value: 0.614823:  31%|███       | 31/100 [03:08<06:00,  5.22s/it]Best trial: 17. Best value: 0.614823:  31%|███       | 31/100 [03:12<06:00,  5.22s/it]Best trial: 17. Best value: 0.614823:  32%|███▏      | 32/100 [03:12<05:28,  4.83s/it]Best trial: 17. Best value: 0.614823:  32%|███▏      | 32/100 [03:18<05:28,  4.83s/it]Best trial: 17. Best value: 0.614823:  33%|███▎      | 33/100 [03:18<05:37,  5.04s/it]Best trial: 17. Best value: 0.614823:  33%|███▎      | 33/100 [03:21<05:37,  5.04s/it]Best trial: 17. Best value: 0.614823:  34%|███▍      | 34/100 [03:21<04:58,  4.52s/it]Best trial: 17. Best value: 0.614823:  34%|███▍      | 34/100 [03:25<04:58,  4.52s/it]Best trial: 17. Best value: 0.614823:  35%|███▌      | 35/100 [03:25<04:43,  4.37s/it]Best trial: 17. Best value: 0.614823:  35%|███▌      | 35/100 [03:28<04:43,  4.37s/it]Best trial: 17. Best value: 0.614823:  36%|███▌      | 36/100 [03:28<04:15,  4.00s/it]Best trial: 17. Best value: 0.614823:  36%|███▌      | 36/100 [03:31<04:15,  4.00s/it]Best trial: 17. Best value: 0.614823:  37%|███▋      | 37/100 [03:31<03:45,  3.57s/it]Best trial: 17. Best value: 0.614823:  37%|███▋      | 37/100 [03:34<03:45,  3.57s/it]Best trial: 17. Best value: 0.614823:  38%|███▊      | 38/100 [03:34<03:37,  3.51s/it]Best trial: 17. Best value: 0.614823:  38%|███▊      | 38/100 [03:39<03:37,  3.51s/it]Best trial: 17. Best value: 0.614823:  39%|███▉      | 39/100 [03:39<04:05,  4.02s/it]Best trial: 17. Best value: 0.614823:  39%|███▉      | 39/100 [03:42<04:05,  4.02s/it]Best trial: 17. Best value: 0.614823:  40%|████      | 40/100 [03:42<03:42,  3.71s/it]Best trial: 40. Best value: 0.615917:  40%|████      | 40/100 [03:47<03:42,  3.71s/it]Best trial: 40. Best value: 0.615917:  41%|████      | 41/100 [03:47<03:53,  3.95s/it]Best trial: 40. Best value: 0.615917:  41%|████      | 41/100 [03:50<03:53,  3.95s/it]Best trial: 40. Best value: 0.615917:  42%|████▏     | 42/100 [03:50<03:41,  3.82s/it]Best trial: 40. Best value: 0.615917:  42%|████▏     | 42/100 [03:53<03:41,  3.82s/it]Best trial: 40. Best value: 0.615917:  43%|████▎     | 43/100 [03:53<03:22,  3.55s/it]Best trial: 40. Best value: 0.615917:  43%|████▎     | 43/100 [03:58<03:22,  3.55s/it]Best trial: 40. Best value: 0.615917:  44%|████▍     | 44/100 [03:58<03:34,  3.84s/it]Best trial: 40. Best value: 0.615917:  44%|████▍     | 44/100 [04:02<03:34,  3.84s/it]Best trial: 40. Best value: 0.615917:  45%|████▌     | 45/100 [04:02<03:32,  3.87s/it]Best trial: 40. Best value: 0.615917:  45%|████▌     | 45/100 [04:12<03:32,  3.87s/it]Best trial: 40. Best value: 0.615917:  46%|████▌     | 46/100 [04:12<05:10,  5.74s/it]Best trial: 40. Best value: 0.615917:  46%|████▌     | 46/100 [04:16<05:10,  5.74s/it]Best trial: 40. Best value: 0.615917:  47%|████▋     | 47/100 [04:16<04:41,  5.31s/it]Best trial: 40. Best value: 0.615917:  47%|████▋     | 47/100 [04:19<04:41,  5.31s/it]Best trial: 40. Best value: 0.615917:  48%|████▊     | 48/100 [04:19<04:07,  4.77s/it]Best trial: 40. Best value: 0.615917:  48%|████▊     | 48/100 [04:24<04:07,  4.77s/it]Best trial: 40. Best value: 0.615917:  49%|████▉     | 49/100 [04:24<03:57,  4.65s/it]Best trial: 40. Best value: 0.615917:  49%|████▉     | 49/100 [04:26<03:57,  4.65s/it]Best trial: 40. Best value: 0.615917:  50%|█████     | 50/100 [04:26<03:19,  3.99s/it]Best trial: 40. Best value: 0.615917:  50%|█████     | 50/100 [04:45<03:19,  3.99s/it]Best trial: 40. Best value: 0.615917:  51%|█████     | 51/100 [04:45<06:55,  8.48s/it]Best trial: 40. Best value: 0.615917:  51%|█████     | 51/100 [04:48<06:55,  8.48s/it]Best trial: 40. Best value: 0.615917:  52%|█████▏    | 52/100 [04:48<05:26,  6.79s/it]Best trial: 40. Best value: 0.615917:  52%|█████▏    | 52/100 [04:52<05:26,  6.79s/it]Best trial: 40. Best value: 0.615917:  53%|█████▎    | 53/100 [04:52<04:38,  5.92s/it]Best trial: 40. Best value: 0.615917:  53%|█████▎    | 53/100 [04:55<04:38,  5.92s/it]Best trial: 40. Best value: 0.615917:  54%|█████▍    | 54/100 [04:55<03:45,  4.91s/it]Best trial: 40. Best value: 0.615917:  54%|█████▍    | 54/100 [04:57<03:45,  4.91s/it]Best trial: 40. Best value: 0.615917:  55%|█████▌    | 55/100 [04:57<03:11,  4.25s/it]Best trial: 40. Best value: 0.615917:  55%|█████▌    | 55/100 [05:01<03:11,  4.25s/it]Best trial: 40. Best value: 0.615917:  56%|█████▌    | 56/100 [05:01<02:58,  4.06s/it]Best trial: 40. Best value: 0.615917:  56%|█████▌    | 56/100 [05:08<02:58,  4.06s/it]Best trial: 40. Best value: 0.615917:  57%|█████▋    | 57/100 [05:08<03:35,  5.01s/it]Best trial: 40. Best value: 0.615917:  57%|█████▋    | 57/100 [05:12<03:35,  5.01s/it]Best trial: 40. Best value: 0.615917:  58%|█████▊    | 58/100 [05:12<03:18,  4.73s/it]Best trial: 40. Best value: 0.615917:  58%|█████▊    | 58/100 [05:21<03:18,  4.73s/it]Best trial: 40. Best value: 0.615917:  59%|█████▉    | 59/100 [05:21<04:07,  6.04s/it]Best trial: 40. Best value: 0.615917:  59%|█████▉    | 59/100 [05:24<04:07,  6.04s/it]Best trial: 40. Best value: 0.615917:  60%|██████    | 60/100 [05:24<03:18,  4.97s/it]Best trial: 40. Best value: 0.615917:  60%|██████    | 60/100 [05:26<03:18,  4.97s/it]Best trial: 40. Best value: 0.615917:  61%|██████    | 61/100 [05:26<02:43,  4.20s/it]Best trial: 40. Best value: 0.615917:  61%|██████    | 61/100 [05:29<02:43,  4.20s/it]Best trial: 40. Best value: 0.615917:  62%|██████▏   | 62/100 [05:29<02:26,  3.84s/it]Best trial: 40. Best value: 0.615917:  62%|██████▏   | 62/100 [05:32<02:26,  3.84s/it]Best trial: 40. Best value: 0.615917:  63%|██████▎   | 63/100 [05:32<02:15,  3.66s/it]Best trial: 40. Best value: 0.615917:  63%|██████▎   | 63/100 [05:36<02:15,  3.66s/it]Best trial: 40. Best value: 0.615917:  64%|██████▍   | 64/100 [05:36<02:08,  3.58s/it]Best trial: 40. Best value: 0.615917:  64%|██████▍   | 64/100 [05:41<02:08,  3.58s/it]Best trial: 40. Best value: 0.615917:  65%|██████▌   | 65/100 [05:41<02:18,  3.95s/it]Best trial: 40. Best value: 0.615917:  65%|██████▌   | 65/100 [05:45<02:18,  3.95s/it]Best trial: 40. Best value: 0.615917:  66%|██████▌   | 66/100 [05:45<02:13,  3.94s/it]Best trial: 40. Best value: 0.615917:  66%|██████▌   | 66/100 [05:48<02:13,  3.94s/it]Best trial: 40. Best value: 0.615917:  67%|██████▋   | 67/100 [05:48<02:02,  3.72s/it]Best trial: 40. Best value: 0.615917:  67%|██████▋   | 67/100 [05:52<02:02,  3.72s/it]Best trial: 40. Best value: 0.615917:  68%|██████▊   | 68/100 [05:52<02:07,  3.99s/it]Best trial: 40. Best value: 0.615917:  68%|██████▊   | 68/100 [05:58<02:07,  3.99s/it]Best trial: 40. Best value: 0.615917:  69%|██████▉   | 69/100 [05:58<02:19,  4.50s/it]Best trial: 40. Best value: 0.615917:  69%|██████▉   | 69/100 [06:03<02:19,  4.50s/it]Best trial: 40. Best value: 0.615917:  70%|███████   | 70/100 [06:03<02:16,  4.55s/it]Best trial: 40. Best value: 0.615917:  70%|███████   | 70/100 [06:08<02:16,  4.55s/it]Best trial: 40. Best value: 0.615917:  71%|███████   | 71/100 [06:08<02:18,  4.78s/it]Best trial: 40. Best value: 0.615917:  71%|███████   | 71/100 [06:12<02:18,  4.78s/it]Best trial: 40. Best value: 0.615917:  72%|███████▏  | 72/100 [06:12<02:05,  4.49s/it]Best trial: 40. Best value: 0.615917:  72%|███████▏  | 72/100 [06:16<02:05,  4.49s/it]Best trial: 40. Best value: 0.615917:  73%|███████▎  | 73/100 [06:16<02:01,  4.50s/it]Best trial: 40. Best value: 0.615917:  73%|███████▎  | 73/100 [06:23<02:01,  4.50s/it]Best trial: 40. Best value: 0.615917:  74%|███████▍  | 74/100 [06:23<02:17,  5.29s/it]Best trial: 40. Best value: 0.615917:  74%|███████▍  | 74/100 [06:28<02:17,  5.29s/it]Best trial: 40. Best value: 0.615917:  75%|███████▌  | 75/100 [06:28<02:08,  5.12s/it]Best trial: 40. Best value: 0.615917:  75%|███████▌  | 75/100 [06:34<02:08,  5.12s/it]Best trial: 40. Best value: 0.615917:  76%|███████▌  | 76/100 [06:34<02:08,  5.34s/it]Best trial: 40. Best value: 0.615917:  76%|███████▌  | 76/100 [06:39<02:08,  5.34s/it]Best trial: 40. Best value: 0.615917:  77%|███████▋  | 77/100 [06:39<02:01,  5.28s/it]Best trial: 40. Best value: 0.615917:  77%|███████▋  | 77/100 [06:45<02:01,  5.28s/it]Best trial: 40. Best value: 0.615917:  78%|███████▊  | 78/100 [06:45<01:59,  5.44s/it]Best trial: 40. Best value: 0.615917:  78%|███████▊  | 78/100 [06:49<01:59,  5.44s/it]Best trial: 40. Best value: 0.615917:  79%|███████▉  | 79/100 [06:49<01:45,  5.02s/it]Best trial: 40. Best value: 0.615917:  79%|███████▉  | 79/100 [06:58<01:45,  5.02s/it]Best trial: 40. Best value: 0.615917:  80%|████████  | 80/100 [06:58<02:04,  6.22s/it]Best trial: 40. Best value: 0.615917:  80%|████████  | 80/100 [07:02<02:04,  6.22s/it]Best trial: 40. Best value: 0.615917:  81%|████████  | 81/100 [07:02<01:46,  5.60s/it]Best trial: 40. Best value: 0.615917:  81%|████████  | 81/100 [07:06<01:46,  5.60s/it]Best trial: 40. Best value: 0.615917:  82%|████████▏ | 82/100 [07:06<01:31,  5.10s/it]Best trial: 40. Best value: 0.615917:  82%|████████▏ | 82/100 [07:11<01:31,  5.10s/it]Best trial: 40. Best value: 0.615917:  83%|████████▎ | 83/100 [07:11<01:23,  4.88s/it]Best trial: 40. Best value: 0.615917:  83%|████████▎ | 83/100 [07:14<01:23,  4.88s/it]Best trial: 40. Best value: 0.615917:  84%|████████▍ | 84/100 [07:14<01:12,  4.54s/it]Best trial: 40. Best value: 0.615917:  84%|████████▍ | 84/100 [07:21<01:12,  4.54s/it]Best trial: 40. Best value: 0.615917:  85%|████████▌ | 85/100 [07:21<01:18,  5.22s/it]Best trial: 40. Best value: 0.615917:  85%|████████▌ | 85/100 [07:24<01:18,  5.22s/it]Best trial: 40. Best value: 0.615917:  86%|████████▌ | 86/100 [07:24<01:03,  4.51s/it]Best trial: 40. Best value: 0.615917:  86%|████████▌ | 86/100 [07:32<01:03,  4.51s/it]Best trial: 40. Best value: 0.615917:  87%|████████▋ | 87/100 [07:32<01:10,  5.42s/it]Best trial: 40. Best value: 0.615917:  87%|████████▋ | 87/100 [07:35<01:10,  5.42s/it]Best trial: 40. Best value: 0.615917:  88%|████████▊ | 88/100 [07:35<00:59,  4.92s/it]Best trial: 40. Best value: 0.615917:  88%|████████▊ | 88/100 [07:41<00:59,  4.92s/it]Best trial: 40. Best value: 0.615917:  89%|████████▉ | 89/100 [07:41<00:56,  5.17s/it]Best trial: 40. Best value: 0.615917:  89%|████████▉ | 89/100 [07:45<00:56,  5.17s/it]Best trial: 40. Best value: 0.615917:  90%|█████████ | 90/100 [07:45<00:47,  4.74s/it]Best trial: 40. Best value: 0.615917:  90%|█████████ | 90/100 [07:49<00:47,  4.74s/it]Best trial: 40. Best value: 0.615917:  91%|█████████ | 91/100 [07:49<00:41,  4.56s/it]Best trial: 40. Best value: 0.615917:  91%|█████████ | 91/100 [07:56<00:41,  4.56s/it]Best trial: 40. Best value: 0.615917:  92%|█████████▏| 92/100 [07:56<00:42,  5.26s/it]Best trial: 40. Best value: 0.615917:  92%|█████████▏| 92/100 [08:04<00:42,  5.26s/it]Best trial: 40. Best value: 0.615917:  93%|█████████▎| 93/100 [08:04<00:42,  6.02s/it]Best trial: 40. Best value: 0.615917:  93%|█████████▎| 93/100 [08:08<00:42,  6.02s/it]Best trial: 40. Best value: 0.615917:  94%|█████████▍| 94/100 [08:08<00:33,  5.62s/it]Best trial: 40. Best value: 0.615917:  94%|█████████▍| 94/100 [08:13<00:33,  5.62s/it]Best trial: 40. Best value: 0.615917:  95%|█████████▌| 95/100 [08:13<00:26,  5.28s/it]Best trial: 40. Best value: 0.615917:  95%|█████████▌| 95/100 [08:17<00:26,  5.28s/it]Best trial: 40. Best value: 0.615917:  96%|█████████▌| 96/100 [08:17<00:20,  5.04s/it]Best trial: 40. Best value: 0.615917:  96%|█████████▌| 96/100 [08:22<00:20,  5.04s/it]Best trial: 40. Best value: 0.615917:  97%|█████████▋| 97/100 [08:22<00:15,  5.09s/it]Best trial: 40. Best value: 0.615917:  97%|█████████▋| 97/100 [08:27<00:15,  5.09s/it]Best trial: 40. Best value: 0.615917:  98%|█████████▊| 98/100 [08:27<00:09,  4.82s/it]Best trial: 40. Best value: 0.615917:  98%|█████████▊| 98/100 [08:32<00:09,  4.82s/it]Best trial: 40. Best value: 0.615917:  99%|█████████▉| 99/100 [08:32<00:05,  5.00s/it]Best trial: 40. Best value: 0.615917:  99%|█████████▉| 99/100 [08:35<00:05,  5.00s/it]Best trial: 40. Best value: 0.615917: 100%|██████████| 100/100 [08:35<00:00,  4.51s/it]Best trial: 40. Best value: 0.615917: 100%|██████████| 100/100 [08:35<00:00,  5.16s/it]
2025-11-30 22:19:05,667 - INFO - HPO Complete. Best AUPRC: 0.6159
2025-11-30 22:19:05,667 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.037054175673176884, 'max_depth': 3, 'subsample': 0.8520277147731694, 'colsample_bytree': 0.9835795288405048, 'gamma': 1.7620522759813855, 'reg_lambda': 6.649521087640768e-06, 'reg_alpha': 1.7637312282953852e-07}
2025-11-30 22:19:05,667 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 22:19:07,813 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_co2
2025-11-30 22:19:07,813 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:19:08,035 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:19:08,073 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:19:08,083 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:19:08,083 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 22:19:08,083 - INFO - Training model...
2025-11-30 22:19:09,442 - INFO - Evaluating model with bootstrapping...
2025-11-30 22:19:15,099 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 22:19:15,099 - INFO - AUROC: 0.7978 (0.7574 - 0.8276)
2025-11-30 22:19:15,099 - INFO - AUPRC: 0.5230 (0.4501 - 0.5963)
2025-11-30 22:19:15,100 - INFO - Brier Score: 0.1598 (0.1473 - 0.1704)
2025-11-30 22:19:15,100 - INFO - Accuracy: 0.7182 (0.6743 - 0.7829)
2025-11-30 22:19:15,100 - INFO - Precision: 0.4360 (0.3780 - 0.5297)
2025-11-30 22:19:15,100 - INFO - Sensitivity (Recall): 0.7975 (0.6597 - 0.8605)
2025-11-30 22:19:15,100 - INFO - F1-Score: 0.5638 (0.5084 - 0.6158)
2025-11-30 22:19:15,100 - INFO - Best Threshold: 0.3700 (0.3120 - 0.4640)
2025-11-30 22:19:15,100 - INFO - Specificity: 0.6948 (0.6398 - 0.8101)
2025-11-30 22:19:15,110 - INFO - Calculating SHAP values...
2025-11-30 22:19:16,162 - INFO - SHAP plots saved.
2025-11-30 22:19:16,163 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 22:19:17,324 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 22:19:17,324 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:19:17,517 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:19:17,550 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:19:17,558 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:19:17,558 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.597345:   0%|          | 0/100 [00:08<?, ?it/s]Best trial: 0. Best value: 0.597345:   1%|          | 1/100 [00:08<13:13,  8.01s/it]Best trial: 0. Best value: 0.597345:   1%|          | 1/100 [00:11<13:13,  8.01s/it]Best trial: 0. Best value: 0.597345:   2%|▏         | 2/100 [00:11<08:45,  5.36s/it]Best trial: 2. Best value: 0.613039:   2%|▏         | 2/100 [00:17<08:45,  5.36s/it]Best trial: 2. Best value: 0.613039:   3%|▎         | 3/100 [00:17<09:25,  5.83s/it]Best trial: 2. Best value: 0.613039:   3%|▎         | 3/100 [00:25<09:25,  5.83s/it]Best trial: 2. Best value: 0.613039:   4%|▍         | 4/100 [00:25<10:18,  6.44s/it]Best trial: 2. Best value: 0.613039:   4%|▍         | 4/100 [00:27<10:18,  6.44s/it]Best trial: 2. Best value: 0.613039:   5%|▌         | 5/100 [00:27<08:00,  5.06s/it]Best trial: 2. Best value: 0.613039:   5%|▌         | 5/100 [00:41<08:00,  5.06s/it]Best trial: 2. Best value: 0.613039:   6%|▌         | 6/100 [00:41<12:21,  7.88s/it]Best trial: 2. Best value: 0.613039:   6%|▌         | 6/100 [00:53<12:21,  7.88s/it]Best trial: 2. Best value: 0.613039:   7%|▋         | 7/100 [00:53<14:28,  9.34s/it]Best trial: 2. Best value: 0.613039:   7%|▋         | 7/100 [01:00<14:28,  9.34s/it]Best trial: 2. Best value: 0.613039:   8%|▊         | 8/100 [01:00<12:54,  8.42s/it]Best trial: 2. Best value: 0.613039:   8%|▊         | 8/100 [01:08<12:54,  8.42s/it]Best trial: 2. Best value: 0.613039:   9%|▉         | 9/100 [01:08<12:36,  8.31s/it]Best trial: 9. Best value: 0.617826:   9%|▉         | 9/100 [01:13<12:36,  8.31s/it]Best trial: 9. Best value: 0.617826:  10%|█         | 10/100 [01:13<10:53,  7.26s/it]Best trial: 9. Best value: 0.617826:  10%|█         | 10/100 [01:15<10:53,  7.26s/it]Best trial: 9. Best value: 0.617826:  11%|█         | 11/100 [01:15<08:38,  5.83s/it]Best trial: 9. Best value: 0.617826:  11%|█         | 11/100 [01:18<08:38,  5.83s/it]Best trial: 9. Best value: 0.617826:  12%|█▏        | 12/100 [01:18<07:03,  4.82s/it]Best trial: 9. Best value: 0.617826:  12%|█▏        | 12/100 [01:20<07:03,  4.82s/it]Best trial: 9. Best value: 0.617826:  13%|█▎        | 13/100 [01:20<05:56,  4.10s/it]Best trial: 9. Best value: 0.617826:  13%|█▎        | 13/100 [01:25<05:56,  4.10s/it]Best trial: 9. Best value: 0.617826:  14%|█▍        | 14/100 [01:25<06:13,  4.35s/it]Best trial: 9. Best value: 0.617826:  14%|█▍        | 14/100 [01:31<06:13,  4.35s/it]Best trial: 9. Best value: 0.617826:  15%|█▌        | 15/100 [01:31<06:40,  4.71s/it]Best trial: 9. Best value: 0.617826:  15%|█▌        | 15/100 [01:34<06:40,  4.71s/it]Best trial: 9. Best value: 0.617826:  16%|█▌        | 16/100 [01:34<05:55,  4.24s/it]Best trial: 9. Best value: 0.617826:  16%|█▌        | 16/100 [01:42<05:55,  4.24s/it]Best trial: 9. Best value: 0.617826:  17%|█▋        | 17/100 [01:42<07:21,  5.32s/it]Best trial: 9. Best value: 0.617826:  17%|█▋        | 17/100 [01:49<07:21,  5.32s/it]Best trial: 9. Best value: 0.617826:  18%|█▊        | 18/100 [01:49<08:19,  6.09s/it]Best trial: 18. Best value: 0.618548:  18%|█▊        | 18/100 [02:05<08:19,  6.09s/it]Best trial: 18. Best value: 0.618548:  19%|█▉        | 19/100 [02:05<12:14,  9.06s/it]Best trial: 19. Best value: 0.621175:  19%|█▉        | 19/100 [02:21<12:14,  9.06s/it]Best trial: 19. Best value: 0.621175:  20%|██        | 20/100 [02:21<14:32, 10.91s/it]Best trial: 19. Best value: 0.621175:  20%|██        | 20/100 [02:39<14:32, 10.91s/it]Best trial: 19. Best value: 0.621175:  21%|██        | 21/100 [02:39<17:08, 13.02s/it]Best trial: 19. Best value: 0.621175:  21%|██        | 21/100 [02:55<17:08, 13.02s/it]Best trial: 19. Best value: 0.621175:  22%|██▏       | 22/100 [02:55<18:05, 13.92s/it]Best trial: 19. Best value: 0.621175:  22%|██▏       | 22/100 [03:20<18:05, 13.92s/it]Best trial: 19. Best value: 0.621175:  23%|██▎       | 23/100 [03:20<22:28, 17.51s/it]Best trial: 19. Best value: 0.621175:  23%|██▎       | 23/100 [03:36<22:28, 17.51s/it]Best trial: 19. Best value: 0.621175:  24%|██▍       | 24/100 [03:36<21:16, 16.80s/it]Best trial: 19. Best value: 0.621175:  24%|██▍       | 24/100 [03:49<21:16, 16.80s/it]Best trial: 19. Best value: 0.621175:  25%|██▌       | 25/100 [03:49<19:42, 15.77s/it]Best trial: 19. Best value: 0.621175:  25%|██▌       | 25/100 [04:12<19:42, 15.77s/it]Best trial: 19. Best value: 0.621175:  26%|██▌       | 26/100 [04:12<22:03, 17.89s/it]Best trial: 19. Best value: 0.621175:  26%|██▌       | 26/100 [04:27<22:03, 17.89s/it]Best trial: 19. Best value: 0.621175:  27%|██▋       | 27/100 [04:27<20:47, 17.09s/it]Best trial: 19. Best value: 0.621175:  27%|██▋       | 27/100 [04:45<20:47, 17.09s/it]Best trial: 19. Best value: 0.621175:  28%|██▊       | 28/100 [04:45<20:51, 17.38s/it]Best trial: 19. Best value: 0.621175:  28%|██▊       | 28/100 [04:54<20:51, 17.38s/it]Best trial: 19. Best value: 0.621175:  29%|██▉       | 29/100 [04:54<17:44, 14.99s/it]Best trial: 19. Best value: 0.621175:  29%|██▉       | 29/100 [05:01<17:44, 14.99s/it]Best trial: 19. Best value: 0.621175:  30%|███       | 30/100 [05:01<14:36, 12.52s/it]Best trial: 19. Best value: 0.621175:  30%|███       | 30/100 [05:21<14:36, 12.52s/it]Best trial: 19. Best value: 0.621175:  31%|███       | 31/100 [05:21<16:48, 14.62s/it]Best trial: 19. Best value: 0.621175:  31%|███       | 31/100 [05:30<16:48, 14.62s/it]Best trial: 19. Best value: 0.621175:  32%|███▏      | 32/100 [05:30<14:36, 12.90s/it]Best trial: 19. Best value: 0.621175:  32%|███▏      | 32/100 [05:44<14:36, 12.90s/it]Best trial: 19. Best value: 0.621175:  33%|███▎      | 33/100 [05:44<15:01, 13.46s/it]Best trial: 19. Best value: 0.621175:  33%|███▎      | 33/100 [05:50<15:01, 13.46s/it]Best trial: 19. Best value: 0.621175:  34%|███▍      | 34/100 [05:50<12:21, 11.23s/it]Best trial: 19. Best value: 0.621175:  34%|███▍      | 34/100 [05:57<12:21, 11.23s/it]Best trial: 19. Best value: 0.621175:  35%|███▌      | 35/100 [05:57<10:44,  9.92s/it]Best trial: 19. Best value: 0.621175:  35%|███▌      | 35/100 [06:06<10:44,  9.92s/it]Best trial: 19. Best value: 0.621175:  36%|███▌      | 36/100 [06:06<10:03,  9.43s/it]Best trial: 19. Best value: 0.621175:  36%|███▌      | 36/100 [06:19<10:03,  9.43s/it]Best trial: 19. Best value: 0.621175:  37%|███▋      | 37/100 [06:19<11:10, 10.65s/it]Best trial: 19. Best value: 0.621175:  37%|███▋      | 37/100 [06:25<11:10, 10.65s/it]Best trial: 19. Best value: 0.621175:  38%|███▊      | 38/100 [06:25<09:35,  9.29s/it]Best trial: 19. Best value: 0.621175:  38%|███▊      | 38/100 [06:28<09:35,  9.29s/it]Best trial: 19. Best value: 0.621175:  39%|███▉      | 39/100 [06:28<07:37,  7.50s/it]Best trial: 19. Best value: 0.621175:  39%|███▉      | 39/100 [06:46<07:37,  7.50s/it]Best trial: 19. Best value: 0.621175:  40%|████      | 40/100 [06:46<10:27, 10.46s/it]Best trial: 19. Best value: 0.621175:  40%|████      | 40/100 [06:57<10:27, 10.46s/it]Best trial: 19. Best value: 0.621175:  41%|████      | 41/100 [06:57<10:33, 10.74s/it]Best trial: 19. Best value: 0.621175:  41%|████      | 41/100 [07:04<10:33, 10.74s/it]Best trial: 19. Best value: 0.621175:  42%|████▏     | 42/100 [07:04<09:16,  9.60s/it]Best trial: 19. Best value: 0.621175:  42%|████▏     | 42/100 [07:12<09:16,  9.60s/it]Best trial: 19. Best value: 0.621175:  43%|████▎     | 43/100 [07:12<08:31,  8.98s/it]Best trial: 19. Best value: 0.621175:  43%|████▎     | 43/100 [07:19<08:31,  8.98s/it]Best trial: 19. Best value: 0.621175:  44%|████▍     | 44/100 [07:19<08:01,  8.60s/it]Best trial: 19. Best value: 0.621175:  44%|████▍     | 44/100 [07:28<08:01,  8.60s/it]Best trial: 19. Best value: 0.621175:  45%|████▌     | 45/100 [07:28<07:48,  8.52s/it]Best trial: 19. Best value: 0.621175:  45%|████▌     | 45/100 [07:31<07:48,  8.52s/it]Best trial: 19. Best value: 0.621175:  46%|████▌     | 46/100 [07:31<06:17,  6.99s/it]Best trial: 19. Best value: 0.621175:  46%|████▌     | 46/100 [07:35<06:17,  6.99s/it]Best trial: 19. Best value: 0.621175:  47%|████▋     | 47/100 [07:35<05:21,  6.07s/it]Best trial: 19. Best value: 0.621175:  47%|████▋     | 47/100 [07:41<05:21,  6.07s/it]Best trial: 19. Best value: 0.621175:  48%|████▊     | 48/100 [07:41<05:19,  6.14s/it]Best trial: 19. Best value: 0.621175:  48%|████▊     | 48/100 [07:46<05:19,  6.14s/it]Best trial: 19. Best value: 0.621175:  49%|████▉     | 49/100 [07:46<04:51,  5.72s/it]Best trial: 19. Best value: 0.621175:  49%|████▉     | 49/100 [07:59<04:51,  5.72s/it]Best trial: 19. Best value: 0.621175:  50%|█████     | 50/100 [07:59<06:28,  7.76s/it]Best trial: 19. Best value: 0.621175:  50%|█████     | 50/100 [08:04<06:28,  7.76s/it]Best trial: 19. Best value: 0.621175:  51%|█████     | 51/100 [08:04<05:48,  7.12s/it]Best trial: 51. Best value: 0.624391:  51%|█████     | 51/100 [08:09<05:48,  7.12s/it]Best trial: 51. Best value: 0.624391:  52%|█████▏    | 52/100 [08:09<05:12,  6.51s/it]Best trial: 51. Best value: 0.624391:  52%|█████▏    | 52/100 [08:15<05:12,  6.51s/it]Best trial: 51. Best value: 0.624391:  53%|█████▎    | 53/100 [08:15<04:54,  6.28s/it]Best trial: 51. Best value: 0.624391:  53%|█████▎    | 53/100 [08:20<04:54,  6.28s/it]Best trial: 51. Best value: 0.624391:  54%|█████▍    | 54/100 [08:20<04:32,  5.93s/it]Best trial: 51. Best value: 0.624391:  54%|█████▍    | 54/100 [08:24<04:32,  5.93s/it]Best trial: 51. Best value: 0.624391:  55%|█████▌    | 55/100 [08:24<04:03,  5.41s/it]Best trial: 51. Best value: 0.624391:  55%|█████▌    | 55/100 [08:29<04:03,  5.41s/it]Best trial: 51. Best value: 0.624391:  56%|█████▌    | 56/100 [08:29<03:51,  5.26s/it]Best trial: 51. Best value: 0.624391:  56%|█████▌    | 56/100 [08:32<03:51,  5.26s/it]Best trial: 51. Best value: 0.624391:  57%|█████▋    | 57/100 [08:32<03:18,  4.62s/it]Best trial: 51. Best value: 0.624391:  57%|█████▋    | 57/100 [08:36<03:18,  4.62s/it]Best trial: 51. Best value: 0.624391:  58%|█████▊    | 58/100 [08:36<02:56,  4.19s/it]Best trial: 51. Best value: 0.624391:  58%|█████▊    | 58/100 [08:42<02:56,  4.19s/it]Best trial: 51. Best value: 0.624391:  59%|█████▉    | 59/100 [08:42<03:19,  4.87s/it]Best trial: 51. Best value: 0.624391:  59%|█████▉    | 59/100 [08:45<03:19,  4.87s/it]Best trial: 51. Best value: 0.624391:  60%|██████    | 60/100 [08:45<02:55,  4.39s/it]Best trial: 51. Best value: 0.624391:  60%|██████    | 60/100 [08:50<02:55,  4.39s/it]Best trial: 51. Best value: 0.624391:  61%|██████    | 61/100 [08:50<02:58,  4.58s/it]Best trial: 51. Best value: 0.624391:  61%|██████    | 61/100 [08:55<02:58,  4.58s/it]Best trial: 51. Best value: 0.624391:  62%|██████▏   | 62/100 [08:55<02:58,  4.70s/it]Best trial: 51. Best value: 0.624391:  62%|██████▏   | 62/100 [09:01<02:58,  4.70s/it]Best trial: 51. Best value: 0.624391:  63%|██████▎   | 63/100 [09:01<03:01,  4.90s/it]Best trial: 51. Best value: 0.624391:  63%|██████▎   | 63/100 [09:04<03:01,  4.90s/it]Best trial: 51. Best value: 0.624391:  64%|██████▍   | 64/100 [09:04<02:41,  4.49s/it]Best trial: 51. Best value: 0.624391:  64%|██████▍   | 64/100 [09:10<02:41,  4.49s/it]Best trial: 51. Best value: 0.624391:  65%|██████▌   | 65/100 [09:10<02:46,  4.74s/it]Best trial: 51. Best value: 0.624391:  65%|██████▌   | 65/100 [09:13<02:46,  4.74s/it]Best trial: 51. Best value: 0.624391:  66%|██████▌   | 66/100 [09:13<02:27,  4.33s/it]Best trial: 51. Best value: 0.624391:  66%|██████▌   | 66/100 [09:17<02:27,  4.33s/it]Best trial: 51. Best value: 0.624391:  67%|██████▋   | 67/100 [09:17<02:23,  4.34s/it]Best trial: 51. Best value: 0.624391:  67%|██████▋   | 67/100 [09:21<02:23,  4.34s/it]Best trial: 51. Best value: 0.624391:  68%|██████▊   | 68/100 [09:21<02:15,  4.24s/it]Best trial: 51. Best value: 0.624391:  68%|██████▊   | 68/100 [09:25<02:15,  4.24s/it]Best trial: 51. Best value: 0.624391:  69%|██████▉   | 69/100 [09:25<02:03,  3.98s/it]Best trial: 51. Best value: 0.624391:  69%|██████▉   | 69/100 [09:28<02:03,  3.98s/it]Best trial: 51. Best value: 0.624391:  70%|███████   | 70/100 [09:28<01:51,  3.71s/it]Best trial: 51. Best value: 0.624391:  70%|███████   | 70/100 [09:33<01:51,  3.71s/it]Best trial: 51. Best value: 0.624391:  71%|███████   | 71/100 [09:33<02:03,  4.25s/it]Best trial: 51. Best value: 0.624391:  71%|███████   | 71/100 [09:38<02:03,  4.25s/it]Best trial: 51. Best value: 0.624391:  72%|███████▏  | 72/100 [09:38<02:03,  4.40s/it]Best trial: 51. Best value: 0.624391:  72%|███████▏  | 72/100 [09:42<02:03,  4.40s/it]Best trial: 51. Best value: 0.624391:  73%|███████▎  | 73/100 [09:42<01:55,  4.28s/it]Best trial: 51. Best value: 0.624391:  73%|███████▎  | 73/100 [09:48<01:55,  4.28s/it]Best trial: 51. Best value: 0.624391:  74%|███████▍  | 74/100 [09:48<02:00,  4.65s/it]Best trial: 51. Best value: 0.624391:  74%|███████▍  | 74/100 [09:51<02:00,  4.65s/it]Best trial: 51. Best value: 0.624391:  75%|███████▌  | 75/100 [09:51<01:47,  4.31s/it]Best trial: 51. Best value: 0.624391:  75%|███████▌  | 75/100 [09:55<01:47,  4.31s/it]Best trial: 51. Best value: 0.624391:  76%|███████▌  | 76/100 [09:55<01:41,  4.25s/it]Best trial: 51. Best value: 0.624391:  76%|███████▌  | 76/100 [09:59<01:41,  4.25s/it]Best trial: 51. Best value: 0.624391:  77%|███████▋  | 77/100 [09:59<01:32,  4.03s/it]Best trial: 51. Best value: 0.624391:  77%|███████▋  | 77/100 [10:03<01:32,  4.03s/it]Best trial: 51. Best value: 0.624391:  78%|███████▊  | 78/100 [10:03<01:30,  4.12s/it]Best trial: 51. Best value: 0.624391:  78%|███████▊  | 78/100 [10:06<01:30,  4.12s/it]Best trial: 51. Best value: 0.624391:  79%|███████▉  | 79/100 [10:06<01:20,  3.86s/it]Best trial: 51. Best value: 0.624391:  79%|███████▉  | 79/100 [10:11<01:20,  3.86s/it]Best trial: 51. Best value: 0.624391:  80%|████████  | 80/100 [10:11<01:19,  3.97s/it]Best trial: 51. Best value: 0.624391:  80%|████████  | 80/100 [10:14<01:19,  3.97s/it]Best trial: 51. Best value: 0.624391:  81%|████████  | 81/100 [10:14<01:11,  3.78s/it]Best trial: 51. Best value: 0.624391:  81%|████████  | 81/100 [10:19<01:11,  3.78s/it]Best trial: 51. Best value: 0.624391:  82%|████████▏ | 82/100 [10:19<01:14,  4.16s/it]Best trial: 51. Best value: 0.624391:  82%|████████▏ | 82/100 [10:23<01:14,  4.16s/it]Best trial: 51. Best value: 0.624391:  83%|████████▎ | 83/100 [10:23<01:10,  4.15s/it]Best trial: 51. Best value: 0.624391:  83%|████████▎ | 83/100 [10:27<01:10,  4.15s/it]Best trial: 51. Best value: 0.624391:  84%|████████▍ | 84/100 [10:27<01:03,  4.00s/it]Best trial: 51. Best value: 0.624391:  84%|████████▍ | 84/100 [10:32<01:03,  4.00s/it]Best trial: 51. Best value: 0.624391:  85%|████████▌ | 85/100 [10:32<01:05,  4.33s/it]Best trial: 51. Best value: 0.624391:  85%|████████▌ | 85/100 [10:35<01:05,  4.33s/it]Best trial: 51. Best value: 0.624391:  86%|████████▌ | 86/100 [10:35<00:55,  3.94s/it]Best trial: 51. Best value: 0.624391:  86%|████████▌ | 86/100 [10:40<00:55,  3.94s/it]Best trial: 51. Best value: 0.624391:  87%|████████▋ | 87/100 [10:40<00:55,  4.28s/it]Best trial: 51. Best value: 0.624391:  87%|████████▋ | 87/100 [10:47<00:55,  4.28s/it]Best trial: 51. Best value: 0.624391:  88%|████████▊ | 88/100 [10:47<01:00,  5.00s/it]Best trial: 51. Best value: 0.624391:  88%|████████▊ | 88/100 [10:52<01:00,  5.00s/it]Best trial: 51. Best value: 0.624391:  89%|████████▉ | 89/100 [10:52<00:57,  5.23s/it]Best trial: 51. Best value: 0.624391:  89%|████████▉ | 89/100 [10:57<00:57,  5.23s/it]Best trial: 51. Best value: 0.624391:  90%|█████████ | 90/100 [10:57<00:51,  5.13s/it]Best trial: 51. Best value: 0.624391:  90%|█████████ | 90/100 [11:01<00:51,  5.13s/it]Best trial: 51. Best value: 0.624391:  91%|█████████ | 91/100 [11:01<00:42,  4.75s/it]Best trial: 51. Best value: 0.624391:  91%|█████████ | 91/100 [11:06<00:42,  4.75s/it]Best trial: 51. Best value: 0.624391:  92%|█████████▏| 92/100 [11:06<00:38,  4.84s/it]Best trial: 51. Best value: 0.624391:  92%|█████████▏| 92/100 [11:22<00:38,  4.84s/it]Best trial: 51. Best value: 0.624391:  93%|█████████▎| 93/100 [11:22<00:57,  8.18s/it]Best trial: 51. Best value: 0.624391:  93%|█████████▎| 93/100 [11:28<00:57,  8.18s/it]Best trial: 51. Best value: 0.624391:  94%|█████████▍| 94/100 [11:28<00:44,  7.38s/it]Best trial: 51. Best value: 0.624391:  94%|█████████▍| 94/100 [11:33<00:44,  7.38s/it]Best trial: 51. Best value: 0.624391:  95%|█████████▌| 95/100 [11:33<00:34,  6.82s/it]Best trial: 51. Best value: 0.624391:  95%|█████████▌| 95/100 [11:41<00:34,  6.82s/it]Best trial: 51. Best value: 0.624391:  96%|█████████▌| 96/100 [11:41<00:28,  7.09s/it]Best trial: 51. Best value: 0.624391:  96%|█████████▌| 96/100 [11:48<00:28,  7.09s/it]Best trial: 51. Best value: 0.624391:  97%|█████████▋| 97/100 [11:48<00:21,  7.23s/it]Best trial: 51. Best value: 0.624391:  97%|█████████▋| 97/100 [11:52<00:21,  7.23s/it]Best trial: 51. Best value: 0.624391:  98%|█████████▊| 98/100 [11:52<00:12,  6.20s/it]Best trial: 51. Best value: 0.624391:  98%|█████████▊| 98/100 [11:58<00:12,  6.20s/it]Best trial: 51. Best value: 0.624391:  99%|█████████▉| 99/100 [11:58<00:05,  5.98s/it]Best trial: 51. Best value: 0.624391:  99%|█████████▉| 99/100 [12:05<00:05,  5.98s/it]Best trial: 51. Best value: 0.624391: 100%|██████████| 100/100 [12:05<00:00,  6.50s/it]Best trial: 51. Best value: 0.624391: 100%|██████████| 100/100 [12:05<00:00,  7.26s/it]
2025-11-30 22:31:23,435 - INFO - HPO Complete. Best AUPRC: 0.6244
2025-11-30 22:31:23,436 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.04401488436995531, 'max_depth': 4, 'subsample': 0.7987066662499261, 'colsample_bytree': 0.8996501482745272, 'gamma': 4.626105812453191, 'reg_lambda': 0.0031601172139249525, 'reg_alpha': 2.440897724292615e-06}
2025-11-30 22:31:23,436 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 22:31:25,380 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_awp
2025-11-30 22:31:25,380 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:31:25,578 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:31:25,611 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:31:25,619 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-11-30 22:31:25,619 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 22:31:25,619 - INFO - Training model...
2025-11-30 22:31:27,189 - INFO - Evaluating model with bootstrapping...
2025-11-30 22:31:32,730 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 22:31:32,730 - INFO - AUROC: 0.7926 (0.7598 - 0.8283)
2025-11-30 22:31:32,730 - INFO - AUPRC: 0.5321 (0.4686 - 0.6156)
2025-11-30 22:31:32,730 - INFO - Brier Score: 0.1578 (0.1465 - 0.1678)
2025-11-30 22:31:32,730 - INFO - Accuracy: 0.6936 (0.6754 - 0.8127)
2025-11-30 22:31:32,730 - INFO - Precision: 0.4118 (0.3828 - 0.5892)
2025-11-30 22:31:32,730 - INFO - Sensitivity (Recall): 0.7975 (0.5125 - 0.8327)
2025-11-30 22:31:32,730 - INFO - F1-Score: 0.5431 (0.5120 - 0.5973)
2025-11-30 22:31:32,730 - INFO - Best Threshold: 0.3100 (0.3000 - 0.6200)
2025-11-30 22:31:32,731 - INFO - Specificity: 0.6629 (0.6422 - 0.8856)
2025-11-30 22:31:32,741 - INFO - Calculating SHAP values...
2025-11-30 22:31:33,817 - INFO - SHAP plots saved.
2025-11-30 22:31:33,818 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 22:31:34,976 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 22:31:34,976 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:31:35,169 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:31:35,234 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:31:35,246 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 22:31:35,246 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.623649:   0%|          | 0/100 [00:15<?, ?it/s]Best trial: 0. Best value: 0.623649:   1%|          | 1/100 [00:15<25:19, 15.35s/it]Best trial: 1. Best value: 0.626315:   1%|          | 1/100 [00:42<25:19, 15.35s/it]Best trial: 1. Best value: 0.626315:   2%|▏         | 2/100 [00:42<36:07, 22.12s/it]Best trial: 1. Best value: 0.626315:   2%|▏         | 2/100 [01:00<36:07, 22.12s/it]Best trial: 1. Best value: 0.626315:   3%|▎         | 3/100 [01:00<32:35, 20.16s/it]Best trial: 1. Best value: 0.626315:   3%|▎         | 3/100 [01:15<32:35, 20.16s/it]Best trial: 1. Best value: 0.626315:   4%|▍         | 4/100 [01:15<28:58, 18.11s/it]Best trial: 1. Best value: 0.626315:   4%|▍         | 4/100 [01:31<28:58, 18.11s/it]Best trial: 1. Best value: 0.626315:   5%|▌         | 5/100 [01:31<27:38, 17.46s/it]Best trial: 1. Best value: 0.626315:   5%|▌         | 5/100 [01:43<27:38, 17.46s/it]Best trial: 1. Best value: 0.626315:   6%|▌         | 6/100 [01:43<24:27, 15.61s/it]Best trial: 1. Best value: 0.626315:   6%|▌         | 6/100 [02:13<24:27, 15.61s/it]Best trial: 1. Best value: 0.626315:   7%|▋         | 7/100 [02:13<31:41, 20.44s/it]Best trial: 1. Best value: 0.626315:   7%|▋         | 7/100 [02:20<31:41, 20.44s/it]Best trial: 1. Best value: 0.626315:   8%|▊         | 8/100 [02:20<24:46, 16.15s/it]Best trial: 1. Best value: 0.626315:   8%|▊         | 8/100 [02:28<24:46, 16.15s/it]Best trial: 1. Best value: 0.626315:   9%|▉         | 9/100 [02:28<20:25, 13.47s/it]Best trial: 1. Best value: 0.626315:   9%|▉         | 9/100 [02:32<20:25, 13.47s/it]Best trial: 1. Best value: 0.626315:  10%|█         | 10/100 [02:32<16:07, 10.75s/it]Best trial: 1. Best value: 0.626315:  10%|█         | 10/100 [03:20<16:07, 10.75s/it]Best trial: 1. Best value: 0.626315:  11%|█         | 11/100 [03:20<32:37, 21.99s/it]Best trial: 1. Best value: 0.626315:  11%|█         | 11/100 [03:43<32:37, 21.99s/it]Best trial: 1. Best value: 0.626315:  12%|█▏        | 12/100 [03:43<32:54, 22.44s/it]Best trial: 1. Best value: 0.626315:  12%|█▏        | 12/100 [04:05<32:54, 22.44s/it]Best trial: 1. Best value: 0.626315:  13%|█▎        | 13/100 [04:05<32:05, 22.13s/it]Best trial: 1. Best value: 0.626315:  13%|█▎        | 13/100 [04:24<32:05, 22.13s/it]Best trial: 1. Best value: 0.626315:  14%|█▍        | 14/100 [04:24<30:24, 21.21s/it]Best trial: 1. Best value: 0.626315:  14%|█▍        | 14/100 [04:55<30:24, 21.21s/it]Best trial: 1. Best value: 0.626315:  15%|█▌        | 15/100 [04:55<34:10, 24.13s/it]Best trial: 1. Best value: 0.626315:  15%|█▌        | 15/100 [05:16<34:10, 24.13s/it]Best trial: 1. Best value: 0.626315:  16%|█▌        | 16/100 [05:16<32:36, 23.29s/it]Best trial: 1. Best value: 0.626315:  16%|█▌        | 16/100 [05:45<32:36, 23.29s/it]Best trial: 1. Best value: 0.626315:  17%|█▋        | 17/100 [05:45<34:23, 24.86s/it]Best trial: 1. Best value: 0.626315:  17%|█▋        | 17/100 [06:02<34:23, 24.86s/it]Best trial: 1. Best value: 0.626315:  18%|█▊        | 18/100 [06:02<30:49, 22.55s/it]Best trial: 1. Best value: 0.626315:  18%|█▊        | 18/100 [06:20<30:49, 22.55s/it]Best trial: 1. Best value: 0.626315:  19%|█▉        | 19/100 [06:20<28:30, 21.12s/it]Best trial: 1. Best value: 0.626315:  19%|█▉        | 19/100 [06:34<28:30, 21.12s/it]Best trial: 1. Best value: 0.626315:  20%|██        | 20/100 [06:34<25:38, 19.23s/it]Best trial: 1. Best value: 0.626315:  20%|██        | 20/100 [07:08<25:38, 19.23s/it]Best trial: 1. Best value: 0.626315:  21%|██        | 21/100 [07:08<30:58, 23.53s/it]Best trial: 1. Best value: 0.626315:  21%|██        | 21/100 [07:20<30:58, 23.53s/it]Best trial: 1. Best value: 0.626315:  22%|██▏       | 22/100 [07:20<26:02, 20.03s/it]Best trial: 1. Best value: 0.626315:  22%|██▏       | 22/100 [07:31<26:02, 20.03s/it]Best trial: 1. Best value: 0.626315:  23%|██▎       | 23/100 [07:31<22:28, 17.51s/it]Best trial: 1. Best value: 0.626315:  23%|██▎       | 23/100 [07:46<22:28, 17.51s/it]Best trial: 1. Best value: 0.626315:  24%|██▍       | 24/100 [07:46<20:54, 16.50s/it]Best trial: 1. Best value: 0.626315:  24%|██▍       | 24/100 [08:20<20:54, 16.50s/it]Best trial: 1. Best value: 0.626315:  25%|██▌       | 25/100 [08:20<27:26, 21.96s/it]Best trial: 1. Best value: 0.626315:  25%|██▌       | 25/100 [08:43<27:26, 21.96s/it]Best trial: 1. Best value: 0.626315:  26%|██▌       | 26/100 [08:43<27:26, 22.25s/it]Best trial: 1. Best value: 0.626315:  26%|██▌       | 26/100 [09:24<27:26, 22.25s/it]Best trial: 1. Best value: 0.626315:  27%|██▋       | 27/100 [09:24<33:55, 27.88s/it]Best trial: 1. Best value: 0.626315:  27%|██▋       | 27/100 [09:35<33:55, 27.88s/it]Best trial: 1. Best value: 0.626315:  28%|██▊       | 28/100 [09:35<27:17, 22.75s/it]Best trial: 1. Best value: 0.626315:  28%|██▊       | 28/100 [10:10<27:17, 22.75s/it]Best trial: 1. Best value: 0.626315:  29%|██▉       | 29/100 [10:10<31:11, 26.35s/it]Best trial: 1. Best value: 0.626315:  29%|██▉       | 29/100 [10:31<31:11, 26.35s/it]Best trial: 1. Best value: 0.626315:  30%|███       | 30/100 [10:31<28:51, 24.73s/it]Best trial: 1. Best value: 0.626315:  30%|███       | 30/100 [10:43<28:51, 24.73s/it]Best trial: 1. Best value: 0.626315:  31%|███       | 31/100 [10:43<24:03, 20.92s/it]Best trial: 1. Best value: 0.626315:  31%|███       | 31/100 [10:57<24:03, 20.92s/it]Best trial: 1. Best value: 0.626315:  32%|███▏      | 32/100 [10:57<21:32, 19.00s/it]Best trial: 1. Best value: 0.626315:  32%|███▏      | 32/100 [11:06<21:32, 19.00s/it]Best trial: 1. Best value: 0.626315:  33%|███▎      | 33/100 [11:06<17:43, 15.87s/it]Best trial: 1. Best value: 0.626315:  33%|███▎      | 33/100 [11:47<17:43, 15.87s/it]Best trial: 1. Best value: 0.626315:  34%|███▍      | 34/100 [11:47<25:45, 23.41s/it]Best trial: 1. Best value: 0.626315:  34%|███▍      | 34/100 [12:18<25:45, 23.41s/it]Best trial: 1. Best value: 0.626315:  35%|███▌      | 35/100 [12:18<27:56, 25.79s/it]Best trial: 1. Best value: 0.626315:  35%|███▌      | 35/100 [12:43<27:56, 25.79s/it]Best trial: 1. Best value: 0.626315:  36%|███▌      | 36/100 [12:43<27:12, 25.51s/it]Best trial: 1. Best value: 0.626315:  36%|███▌      | 36/100 [12:53<27:12, 25.51s/it]Best trial: 1. Best value: 0.626315:  37%|███▋      | 37/100 [12:53<21:56, 20.89s/it]Best trial: 1. Best value: 0.626315:  37%|███▋      | 37/100 [13:09<21:56, 20.89s/it]Best trial: 1. Best value: 0.626315:  38%|███▊      | 38/100 [13:09<19:52, 19.23s/it]Best trial: 1. Best value: 0.626315:  38%|███▊      | 38/100 [13:19<19:52, 19.23s/it]Best trial: 1. Best value: 0.626315:  39%|███▉      | 39/100 [13:19<16:52, 16.60s/it]Best trial: 1. Best value: 0.626315:  39%|███▉      | 39/100 [13:27<16:52, 16.60s/it]Best trial: 1. Best value: 0.626315:  40%|████      | 40/100 [13:27<13:57, 13.97s/it]Best trial: 1. Best value: 0.626315:  40%|████      | 40/100 [13:44<13:57, 13.97s/it]Best trial: 1. Best value: 0.626315:  41%|████      | 41/100 [13:44<14:43, 14.97s/it]Best trial: 1. Best value: 0.626315:  41%|████      | 41/100 [13:51<14:43, 14.97s/it]Best trial: 1. Best value: 0.626315:  42%|████▏     | 42/100 [13:51<12:01, 12.45s/it]Best trial: 42. Best value: 0.628586:  42%|████▏     | 42/100 [13:56<12:01, 12.45s/it]Best trial: 42. Best value: 0.628586:  43%|████▎     | 43/100 [13:56<09:53, 10.41s/it]Best trial: 42. Best value: 0.628586:  43%|████▎     | 43/100 [14:04<09:53, 10.41s/it]Best trial: 42. Best value: 0.628586:  44%|████▍     | 44/100 [14:04<08:56,  9.57s/it]Best trial: 42. Best value: 0.628586:  44%|████▍     | 44/100 [14:12<08:56,  9.57s/it]Best trial: 42. Best value: 0.628586:  45%|████▌     | 45/100 [14:12<08:15,  9.01s/it]Best trial: 42. Best value: 0.628586:  45%|████▌     | 45/100 [14:19<08:15,  9.01s/it]Best trial: 42. Best value: 0.628586:  46%|████▌     | 46/100 [14:19<07:41,  8.55s/it]Best trial: 42. Best value: 0.628586:  46%|████▌     | 46/100 [14:30<07:41,  8.55s/it]Best trial: 42. Best value: 0.628586:  47%|████▋     | 47/100 [14:30<08:10,  9.26s/it]Best trial: 42. Best value: 0.628586:  47%|████▋     | 47/100 [14:40<08:10,  9.26s/it]Best trial: 42. Best value: 0.628586:  48%|████▊     | 48/100 [14:40<08:09,  9.41s/it]Best trial: 42. Best value: 0.628586:  48%|████▊     | 48/100 [14:56<08:09,  9.41s/it]Best trial: 42. Best value: 0.628586:  49%|████▉     | 49/100 [14:56<09:43, 11.45s/it]Best trial: 42. Best value: 0.628586:  49%|████▉     | 49/100 [15:05<09:43, 11.45s/it]Best trial: 42. Best value: 0.628586:  50%|█████     | 50/100 [15:05<08:56, 10.73s/it]Best trial: 42. Best value: 0.628586:  50%|█████     | 50/100 [15:56<08:56, 10.73s/it]Best trial: 42. Best value: 0.628586:  51%|█████     | 51/100 [15:56<18:40, 22.87s/it]Best trial: 42. Best value: 0.628586:  51%|█████     | 51/100 [16:06<18:40, 22.87s/it]Best trial: 42. Best value: 0.628586:  52%|█████▏    | 52/100 [16:06<15:05, 18.87s/it]Best trial: 42. Best value: 0.628586:  52%|█████▏    | 52/100 [16:13<15:05, 18.87s/it]Best trial: 42. Best value: 0.628586:  53%|█████▎    | 53/100 [16:13<12:03, 15.38s/it]Best trial: 42. Best value: 0.628586:  53%|█████▎    | 53/100 [16:24<12:03, 15.38s/it]Best trial: 42. Best value: 0.628586:  54%|█████▍    | 54/100 [16:24<10:43, 13.98s/it]Best trial: 42. Best value: 0.628586:  54%|█████▍    | 54/100 [16:33<10:43, 13.98s/it]Best trial: 42. Best value: 0.628586:  55%|█████▌    | 55/100 [16:33<09:25, 12.56s/it]Best trial: 42. Best value: 0.628586:  55%|█████▌    | 55/100 [16:42<09:25, 12.56s/it]Best trial: 42. Best value: 0.628586:  56%|█████▌    | 56/100 [16:42<08:31, 11.63s/it]Best trial: 42. Best value: 0.628586:  56%|█████▌    | 56/100 [17:04<08:31, 11.63s/it]Best trial: 42. Best value: 0.628586:  57%|█████▋    | 57/100 [17:04<10:29, 14.65s/it]Best trial: 42. Best value: 0.628586:  57%|█████▋    | 57/100 [17:33<10:29, 14.65s/it]Best trial: 42. Best value: 0.628586:  58%|█████▊    | 58/100 [17:33<13:15, 18.93s/it]Best trial: 42. Best value: 0.628586:  58%|█████▊    | 58/100 [17:48<13:15, 18.93s/it]Best trial: 42. Best value: 0.628586:  59%|█████▉    | 59/100 [17:48<12:10, 17.82s/it]Best trial: 42. Best value: 0.628586:  59%|█████▉    | 59/100 [18:08<12:10, 17.82s/it]Best trial: 42. Best value: 0.628586:  60%|██████    | 60/100 [18:08<12:13, 18.35s/it]Best trial: 42. Best value: 0.628586:  60%|██████    | 60/100 [18:20<12:13, 18.35s/it]Best trial: 42. Best value: 0.628586:  61%|██████    | 61/100 [18:20<10:39, 16.39s/it]Best trial: 42. Best value: 0.628586:  61%|██████    | 61/100 [18:29<10:39, 16.39s/it]Best trial: 42. Best value: 0.628586:  62%|██████▏   | 62/100 [18:29<09:07, 14.41s/it]Best trial: 42. Best value: 0.628586:  62%|██████▏   | 62/100 [18:37<09:07, 14.41s/it]Best trial: 42. Best value: 0.628586:  63%|██████▎   | 63/100 [18:37<07:42, 12.49s/it]Best trial: 63. Best value: 0.631613:  63%|██████▎   | 63/100 [18:44<07:42, 12.49s/it]Best trial: 63. Best value: 0.631613:  64%|██████▍   | 64/100 [18:44<06:22, 10.61s/it]Best trial: 63. Best value: 0.631613:  64%|██████▍   | 64/100 [18:54<06:22, 10.61s/it]Best trial: 63. Best value: 0.631613:  65%|██████▌   | 65/100 [18:54<06:10, 10.59s/it]Best trial: 63. Best value: 0.631613:  65%|██████▌   | 65/100 [19:03<06:10, 10.59s/it]Best trial: 63. Best value: 0.631613:  66%|██████▌   | 66/100 [19:03<05:40, 10.02s/it]Best trial: 63. Best value: 0.631613:  66%|██████▌   | 66/100 [19:15<05:40, 10.02s/it]Best trial: 63. Best value: 0.631613:  67%|██████▋   | 67/100 [19:15<05:49, 10.60s/it]Best trial: 63. Best value: 0.631613:  67%|██████▋   | 67/100 [19:24<05:49, 10.60s/it]Best trial: 63. Best value: 0.631613:  68%|██████▊   | 68/100 [19:24<05:25, 10.16s/it]Best trial: 63. Best value: 0.631613:  68%|██████▊   | 68/100 [19:38<05:25, 10.16s/it]Best trial: 63. Best value: 0.631613:  69%|██████▉   | 69/100 [19:38<05:53, 11.42s/it]Best trial: 63. Best value: 0.631613:  69%|██████▉   | 69/100 [19:48<05:53, 11.42s/it]Best trial: 63. Best value: 0.631613:  70%|███████   | 70/100 [19:48<05:26, 10.87s/it]Best trial: 63. Best value: 0.631613:  70%|███████   | 70/100 [19:54<05:26, 10.87s/it]Best trial: 63. Best value: 0.631613:  71%|███████   | 71/100 [19:54<04:32,  9.40s/it]Best trial: 63. Best value: 0.631613:  71%|███████   | 71/100 [20:04<04:32,  9.40s/it]Best trial: 63. Best value: 0.631613:  72%|███████▏  | 72/100 [20:04<04:31,  9.69s/it]Best trial: 63. Best value: 0.631613:  72%|███████▏  | 72/100 [20:12<04:31,  9.69s/it]Best trial: 63. Best value: 0.631613:  73%|███████▎  | 73/100 [20:12<04:06,  9.14s/it]Best trial: 63. Best value: 0.631613:  73%|███████▎  | 73/100 [20:23<04:06,  9.14s/it]Best trial: 63. Best value: 0.631613:  74%|███████▍  | 74/100 [20:23<04:09,  9.58s/it]Best trial: 63. Best value: 0.631613:  74%|███████▍  | 74/100 [20:32<04:09,  9.58s/it]Best trial: 63. Best value: 0.631613:  75%|███████▌  | 75/100 [20:32<03:53,  9.33s/it]Best trial: 63. Best value: 0.631613:  75%|███████▌  | 75/100 [20:40<03:53,  9.33s/it]Best trial: 63. Best value: 0.631613:  76%|███████▌  | 76/100 [20:40<03:39,  9.16s/it]Best trial: 63. Best value: 0.631613:  76%|███████▌  | 76/100 [20:47<03:39,  9.16s/it]Best trial: 63. Best value: 0.631613:  77%|███████▋  | 77/100 [20:47<03:17,  8.57s/it]Best trial: 63. Best value: 0.631613:  77%|███████▋  | 77/100 [21:00<03:17,  8.57s/it]Best trial: 63. Best value: 0.631613:  78%|███████▊  | 78/100 [21:00<03:35,  9.77s/it]Best trial: 63. Best value: 0.631613:  78%|███████▊  | 78/100 [21:07<03:35,  9.77s/it]Best trial: 63. Best value: 0.631613:  79%|███████▉  | 79/100 [21:07<03:10,  9.07s/it]Best trial: 63. Best value: 0.631613:  79%|███████▉  | 79/100 [21:15<03:10,  9.07s/it]Best trial: 63. Best value: 0.631613:  80%|████████  | 80/100 [21:15<02:53,  8.67s/it]Best trial: 63. Best value: 0.631613:  80%|████████  | 80/100 [21:20<02:53,  8.67s/it]Best trial: 63. Best value: 0.631613:  81%|████████  | 81/100 [21:20<02:23,  7.55s/it]Best trial: 63. Best value: 0.631613:  81%|████████  | 81/100 [21:29<02:23,  7.55s/it]Best trial: 63. Best value: 0.631613:  82%|████████▏ | 82/100 [21:29<02:22,  7.93s/it]Best trial: 63. Best value: 0.631613:  82%|████████▏ | 82/100 [21:37<02:22,  7.93s/it]Best trial: 63. Best value: 0.631613:  83%|████████▎ | 83/100 [21:37<02:13,  7.83s/it]Best trial: 83. Best value: 0.632869:  83%|████████▎ | 83/100 [21:46<02:13,  7.83s/it]Best trial: 83. Best value: 0.632869:  84%|████████▍ | 84/100 [21:46<02:14,  8.40s/it]Best trial: 83. Best value: 0.632869:  84%|████████▍ | 84/100 [21:55<02:14,  8.40s/it]Best trial: 83. Best value: 0.632869:  85%|████████▌ | 85/100 [21:55<02:05,  8.35s/it]Best trial: 83. Best value: 0.632869:  85%|████████▌ | 85/100 [22:04<02:05,  8.35s/it]Best trial: 83. Best value: 0.632869:  86%|████████▌ | 86/100 [22:04<02:03,  8.79s/it]Best trial: 83. Best value: 0.632869:  86%|████████▌ | 86/100 [22:11<02:03,  8.79s/it]Best trial: 83. Best value: 0.632869:  87%|████████▋ | 87/100 [22:11<01:44,  8.07s/it]Best trial: 83. Best value: 0.632869:  87%|████████▋ | 87/100 [22:18<01:44,  8.07s/it]Best trial: 83. Best value: 0.632869:  88%|████████▊ | 88/100 [22:18<01:34,  7.88s/it]Best trial: 83. Best value: 0.632869:  88%|████████▊ | 88/100 [22:24<01:34,  7.88s/it]Best trial: 83. Best value: 0.632869:  89%|████████▉ | 89/100 [22:24<01:20,  7.35s/it]Best trial: 83. Best value: 0.632869:  89%|████████▉ | 89/100 [22:34<01:20,  7.35s/it]Best trial: 83. Best value: 0.632869:  90%|█████████ | 90/100 [22:34<01:20,  8.10s/it]Best trial: 83. Best value: 0.632869:  90%|█████████ | 90/100 [23:18<01:20,  8.10s/it]Best trial: 83. Best value: 0.632869:  91%|█████████ | 91/100 [23:18<02:48, 18.76s/it]Best trial: 83. Best value: 0.632869:  91%|█████████ | 91/100 [23:27<02:48, 18.76s/it]Best trial: 83. Best value: 0.632869:  92%|█████████▏| 92/100 [23:27<02:07, 15.91s/it]Best trial: 83. Best value: 0.632869:  92%|█████████▏| 92/100 [23:34<02:07, 15.91s/it]Best trial: 83. Best value: 0.632869:  93%|█████████▎| 93/100 [23:34<01:32, 13.22s/it]Best trial: 83. Best value: 0.632869:  93%|█████████▎| 93/100 [23:41<01:32, 13.22s/it]Best trial: 83. Best value: 0.632869:  94%|█████████▍| 94/100 [23:41<01:07, 11.29s/it]Best trial: 83. Best value: 0.632869:  94%|█████████▍| 94/100 [23:47<01:07, 11.29s/it]Best trial: 83. Best value: 0.632869:  95%|█████████▌| 95/100 [23:47<00:48,  9.75s/it]Best trial: 83. Best value: 0.632869:  95%|█████████▌| 95/100 [23:56<00:48,  9.75s/it]Best trial: 83. Best value: 0.632869:  96%|█████████▌| 96/100 [23:56<00:38,  9.51s/it]Best trial: 83. Best value: 0.632869:  96%|█████████▌| 96/100 [24:10<00:38,  9.51s/it]Best trial: 83. Best value: 0.632869:  97%|█████████▋| 97/100 [24:10<00:32, 10.76s/it]Best trial: 83. Best value: 0.632869:  97%|█████████▋| 97/100 [24:21<00:32, 10.76s/it]Best trial: 83. Best value: 0.632869:  98%|█████████▊| 98/100 [24:21<00:22, 11.04s/it]Best trial: 83. Best value: 0.632869:  98%|█████████▊| 98/100 [24:35<00:22, 11.04s/it]Best trial: 83. Best value: 0.632869:  99%|█████████▉| 99/100 [24:35<00:11, 11.82s/it]Best trial: 83. Best value: 0.632869:  99%|█████████▉| 99/100 [24:40<00:11, 11.82s/it]Best trial: 83. Best value: 0.632869: 100%|██████████| 100/100 [24:40<00:00,  9.72s/it]Best trial: 83. Best value: 0.632869: 100%|██████████| 100/100 [24:40<00:00, 14.80s/it]
2025-11-30 22:56:15,450 - INFO - HPO Complete. Best AUPRC: 0.6329
2025-11-30 22:56:15,450 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.04758895449116896, 'max_depth': 3, 'subsample': 0.8000113183948001, 'colsample_bytree': 0.9324624768125136, 'gamma': 0.8364099377110552, 'reg_lambda': 2.4071566143567796e-08, 'reg_alpha': 0.13714496866629736}
2025-11-30 22:56:15,451 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 22:56:17,636 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-11-30 22:56:17,637 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:56:17,857 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:56:17,923 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:56:17,939 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 22:56:17,939 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 22:56:17,939 - INFO - Training model...
2025-11-30 22:56:20,311 - INFO - Evaluating model with bootstrapping...
2025-11-30 22:56:26,848 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 22:56:26,848 - INFO - AUROC: 0.8023 (0.7707 - 0.8265)
2025-11-30 22:56:26,848 - INFO - AUPRC: 0.5424 (0.4853 - 0.6019)
2025-11-30 22:56:26,848 - INFO - Brier Score: 0.1506 (0.1419 - 0.1599)
2025-11-30 22:56:26,848 - INFO - Accuracy: 0.7514 (0.7295 - 0.8211)
2025-11-30 22:56:26,848 - INFO - Precision: 0.4718 (0.4292 - 0.6016)
2025-11-30 22:56:26,849 - INFO - Sensitivity (Recall): 0.7405 (0.5881 - 0.8262)
2025-11-30 22:56:26,849 - INFO - F1-Score: 0.5764 (0.5406 - 0.6254)
2025-11-30 22:56:26,849 - INFO - Best Threshold: 0.3700 (0.3420 - 0.5380)
2025-11-30 22:56:26,849 - INFO - Specificity: 0.7547 (0.7193 - 0.8833)
2025-11-30 22:56:26,858 - INFO - Calculating SHAP values...
2025-11-30 22:56:27,863 - INFO - SHAP plots saved.
2025-11-30 22:56:27,864 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 22:56:29,172 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 22:56:29,172 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 22:56:29,391 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 22:56:29,464 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 22:56:29,478 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 22:56:29,478 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.567903:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.567903:   1%|          | 1/100 [00:07<12:01,  7.29s/it]Best trial: 1. Best value: 0.60485:   1%|          | 1/100 [00:19<12:01,  7.29s/it] Best trial: 1. Best value: 0.60485:   2%|▏         | 2/100 [00:19<16:43, 10.24s/it]Best trial: 1. Best value: 0.60485:   2%|▏         | 2/100 [00:29<16:43, 10.24s/it]Best trial: 1. Best value: 0.60485:   3%|▎         | 3/100 [00:29<16:08,  9.98s/it]Best trial: 1. Best value: 0.60485:   3%|▎         | 3/100 [00:36<16:08,  9.98s/it]Best trial: 1. Best value: 0.60485:   4%|▍         | 4/100 [00:36<14:25,  9.02s/it]Best trial: 1. Best value: 0.60485:   4%|▍         | 4/100 [01:15<14:25,  9.02s/it]Best trial: 1. Best value: 0.60485:   5%|▌         | 5/100 [01:15<31:01, 19.59s/it]Best trial: 1. Best value: 0.60485:   5%|▌         | 5/100 [01:32<31:01, 19.59s/it]Best trial: 1. Best value: 0.60485:   6%|▌         | 6/100 [01:32<29:41, 18.95s/it]Best trial: 1. Best value: 0.60485:   6%|▌         | 6/100 [02:09<29:41, 18.95s/it]Best trial: 1. Best value: 0.60485:   7%|▋         | 7/100 [02:09<38:24, 24.78s/it]Best trial: 7. Best value: 0.618313:   7%|▋         | 7/100 [02:21<38:24, 24.78s/it]Best trial: 7. Best value: 0.618313:   8%|▊         | 8/100 [02:21<31:53, 20.80s/it]Best trial: 7. Best value: 0.618313:   8%|▊         | 8/100 [02:38<31:53, 20.80s/it]Best trial: 7. Best value: 0.618313:   9%|▉         | 9/100 [02:38<29:19, 19.33s/it]Best trial: 7. Best value: 0.618313:   9%|▉         | 9/100 [02:45<29:19, 19.33s/it]Best trial: 7. Best value: 0.618313:  10%|█         | 10/100 [02:45<23:19, 15.55s/it]Best trial: 7. Best value: 0.618313:  10%|█         | 10/100 [02:58<23:19, 15.55s/it]Best trial: 7. Best value: 0.618313:  11%|█         | 11/100 [02:58<22:04, 14.88s/it]Best trial: 7. Best value: 0.618313:  11%|█         | 11/100 [03:07<22:04, 14.88s/it]Best trial: 7. Best value: 0.618313:  12%|█▏        | 12/100 [03:07<19:04, 13.00s/it]Best trial: 7. Best value: 0.618313:  12%|█▏        | 12/100 [03:20<19:04, 13.00s/it]Best trial: 7. Best value: 0.618313:  13%|█▎        | 13/100 [03:20<18:58, 13.09s/it]Best trial: 7. Best value: 0.618313:  13%|█▎        | 13/100 [03:33<18:58, 13.09s/it]Best trial: 7. Best value: 0.618313:  14%|█▍        | 14/100 [03:33<18:31, 12.93s/it]Best trial: 7. Best value: 0.618313:  14%|█▍        | 14/100 [04:00<18:31, 12.93s/it]Best trial: 7. Best value: 0.618313:  15%|█▌        | 15/100 [04:00<24:25, 17.24s/it]Best trial: 7. Best value: 0.618313:  15%|█▌        | 15/100 [04:07<24:25, 17.24s/it]Best trial: 7. Best value: 0.618313:  16%|█▌        | 16/100 [04:07<19:54, 14.22s/it]Best trial: 7. Best value: 0.618313:  16%|█▌        | 16/100 [04:12<19:54, 14.22s/it]Best trial: 7. Best value: 0.618313:  17%|█▋        | 17/100 [04:12<15:55, 11.52s/it]Best trial: 7. Best value: 0.618313:  17%|█▋        | 17/100 [04:38<15:55, 11.52s/it]Best trial: 7. Best value: 0.618313:  18%|█▊        | 18/100 [04:38<21:41, 15.87s/it]Best trial: 7. Best value: 0.618313:  18%|█▊        | 18/100 [05:14<21:41, 15.87s/it]Best trial: 7. Best value: 0.618313:  19%|█▉        | 19/100 [05:14<29:19, 21.72s/it]Best trial: 7. Best value: 0.618313:  19%|█▉        | 19/100 [05:39<29:19, 21.72s/it]Best trial: 7. Best value: 0.618313:  20%|██        | 20/100 [05:39<30:33, 22.92s/it]Best trial: 7. Best value: 0.618313:  20%|██        | 20/100 [06:13<30:33, 22.92s/it]Best trial: 7. Best value: 0.618313:  21%|██        | 21/100 [06:13<34:33, 26.25s/it]Best trial: 7. Best value: 0.618313:  21%|██        | 21/100 [06:32<34:33, 26.25s/it]Best trial: 7. Best value: 0.618313:  22%|██▏       | 22/100 [06:32<31:20, 24.11s/it]Best trial: 7. Best value: 0.618313:  22%|██▏       | 22/100 [06:56<31:20, 24.11s/it]Best trial: 7. Best value: 0.618313:  23%|██▎       | 23/100 [06:56<30:34, 23.82s/it]Best trial: 7. Best value: 0.618313:  23%|██▎       | 23/100 [07:06<30:34, 23.82s/it]Best trial: 7. Best value: 0.618313:  24%|██▍       | 24/100 [07:06<25:16, 19.96s/it]Best trial: 7. Best value: 0.618313:  24%|██▍       | 24/100 [07:15<25:16, 19.96s/it]Best trial: 7. Best value: 0.618313:  25%|██▌       | 25/100 [07:15<20:36, 16.49s/it]Best trial: 7. Best value: 0.618313:  25%|██▌       | 25/100 [07:42<20:36, 16.49s/it]Best trial: 7. Best value: 0.618313:  26%|██▌       | 26/100 [07:42<24:22, 19.76s/it]Best trial: 7. Best value: 0.618313:  26%|██▌       | 26/100 [08:31<24:22, 19.76s/it]Best trial: 7. Best value: 0.618313:  27%|██▋       | 27/100 [08:31<34:31, 28.38s/it]Best trial: 7. Best value: 0.618313:  27%|██▋       | 27/100 [08:49<34:31, 28.38s/it]Best trial: 7. Best value: 0.618313:  28%|██▊       | 28/100 [08:49<30:15, 25.21s/it]Best trial: 28. Best value: 0.622103:  28%|██▊       | 28/100 [09:07<30:15, 25.21s/it]Best trial: 28. Best value: 0.622103:  29%|██▉       | 29/100 [09:07<27:20, 23.10s/it]Best trial: 28. Best value: 0.622103:  29%|██▉       | 29/100 [09:22<27:20, 23.10s/it]Best trial: 28. Best value: 0.622103:  30%|███       | 30/100 [09:22<24:02, 20.61s/it]Best trial: 28. Best value: 0.622103:  30%|███       | 30/100 [09:44<24:02, 20.61s/it]Best trial: 28. Best value: 0.622103:  31%|███       | 31/100 [09:44<24:28, 21.28s/it]Best trial: 28. Best value: 0.622103:  31%|███       | 31/100 [10:00<24:28, 21.28s/it]Best trial: 28. Best value: 0.622103:  32%|███▏      | 32/100 [10:00<22:09, 19.55s/it]Best trial: 28. Best value: 0.622103:  32%|███▏      | 32/100 [10:20<22:09, 19.55s/it]Best trial: 28. Best value: 0.622103:  33%|███▎      | 33/100 [10:20<21:59, 19.70s/it]Best trial: 28. Best value: 0.622103:  33%|███▎      | 33/100 [10:32<21:59, 19.70s/it]Best trial: 28. Best value: 0.622103:  34%|███▍      | 34/100 [10:32<19:01, 17.29s/it]Best trial: 28. Best value: 0.622103:  34%|███▍      | 34/100 [10:41<19:01, 17.29s/it]Best trial: 28. Best value: 0.622103:  35%|███▌      | 35/100 [10:41<16:03, 14.82s/it]Best trial: 28. Best value: 0.622103:  35%|███▌      | 35/100 [10:58<16:03, 14.82s/it]Best trial: 28. Best value: 0.622103:  36%|███▌      | 36/100 [10:58<16:42, 15.67s/it]Best trial: 28. Best value: 0.622103:  36%|███▌      | 36/100 [11:07<16:42, 15.67s/it]Best trial: 28. Best value: 0.622103:  37%|███▋      | 37/100 [11:07<14:16, 13.59s/it]Best trial: 28. Best value: 0.622103:  37%|███▋      | 37/100 [11:16<14:16, 13.59s/it]Best trial: 28. Best value: 0.622103:  38%|███▊      | 38/100 [11:16<12:28, 12.08s/it]Best trial: 28. Best value: 0.622103:  38%|███▊      | 38/100 [11:39<12:28, 12.08s/it]Best trial: 28. Best value: 0.622103:  39%|███▉      | 39/100 [11:39<15:40, 15.41s/it]Best trial: 28. Best value: 0.622103:  39%|███▉      | 39/100 [12:08<15:40, 15.41s/it]Best trial: 28. Best value: 0.622103:  40%|████      | 40/100 [12:08<19:34, 19.58s/it]Best trial: 28. Best value: 0.622103:  40%|████      | 40/100 [12:37<19:34, 19.58s/it]Best trial: 28. Best value: 0.622103:  41%|████      | 41/100 [12:37<22:00, 22.38s/it]Best trial: 28. Best value: 0.622103:  41%|████      | 41/100 [12:54<22:00, 22.38s/it]Best trial: 28. Best value: 0.622103:  42%|████▏     | 42/100 [12:54<19:56, 20.62s/it]Best trial: 28. Best value: 0.622103:  42%|████▏     | 42/100 [13:09<19:56, 20.62s/it]Best trial: 28. Best value: 0.622103:  43%|████▎     | 43/100 [13:09<18:10, 19.13s/it]Best trial: 28. Best value: 0.622103:  43%|████▎     | 43/100 [13:25<18:10, 19.13s/it]Best trial: 28. Best value: 0.622103:  44%|████▍     | 44/100 [13:25<16:54, 18.12s/it]Best trial: 28. Best value: 0.622103:  44%|████▍     | 44/100 [13:34<16:54, 18.12s/it]Best trial: 28. Best value: 0.622103:  45%|████▌     | 45/100 [13:34<14:10, 15.46s/it]Best trial: 28. Best value: 0.622103:  45%|████▌     | 45/100 [14:01<14:10, 15.46s/it]Best trial: 28. Best value: 0.622103:  46%|████▌     | 46/100 [14:01<17:01, 18.91s/it]Best trial: 28. Best value: 0.622103:  46%|████▌     | 46/100 [14:33<17:01, 18.91s/it]Best trial: 28. Best value: 0.622103:  47%|████▋     | 47/100 [14:33<20:05, 22.74s/it]Best trial: 28. Best value: 0.622103:  47%|████▋     | 47/100 [15:14<20:05, 22.74s/it]Best trial: 28. Best value: 0.622103:  48%|████▊     | 48/100 [15:14<24:35, 28.38s/it]Best trial: 28. Best value: 0.622103:  48%|████▊     | 48/100 [15:32<24:35, 28.38s/it]Best trial: 28. Best value: 0.622103:  49%|████▉     | 49/100 [15:32<21:29, 25.29s/it]Best trial: 28. Best value: 0.622103:  49%|████▉     | 49/100 [16:01<21:29, 25.29s/it]Best trial: 28. Best value: 0.622103:  50%|█████     | 50/100 [16:01<21:46, 26.13s/it]Best trial: 28. Best value: 0.622103:  50%|█████     | 50/100 [16:21<21:46, 26.13s/it]Best trial: 28. Best value: 0.622103:  51%|█████     | 51/100 [16:21<19:49, 24.28s/it]Best trial: 28. Best value: 0.622103:  51%|█████     | 51/100 [16:37<19:49, 24.28s/it]Best trial: 28. Best value: 0.622103:  52%|█████▏    | 52/100 [16:37<17:28, 21.83s/it]Best trial: 28. Best value: 0.622103:  52%|█████▏    | 52/100 [16:57<17:28, 21.83s/it]Best trial: 28. Best value: 0.622103:  53%|█████▎    | 53/100 [16:57<16:49, 21.49s/it]Best trial: 28. Best value: 0.622103:  53%|█████▎    | 53/100 [17:02<16:49, 21.49s/it]Best trial: 28. Best value: 0.622103:  54%|█████▍    | 54/100 [17:02<12:37, 16.46s/it]Best trial: 28. Best value: 0.622103:  54%|█████▍    | 54/100 [17:06<12:37, 16.46s/it]Best trial: 28. Best value: 0.622103:  55%|█████▌    | 55/100 [17:06<09:37, 12.84s/it]Best trial: 28. Best value: 0.622103:  55%|█████▌    | 55/100 [17:11<09:37, 12.84s/it]Best trial: 28. Best value: 0.622103:  56%|█████▌    | 56/100 [17:11<07:36, 10.36s/it]Best trial: 28. Best value: 0.622103:  56%|█████▌    | 56/100 [17:16<07:36, 10.36s/it]Best trial: 28. Best value: 0.622103:  57%|█████▋    | 57/100 [17:16<06:12,  8.67s/it]Best trial: 28. Best value: 0.622103:  57%|█████▋    | 57/100 [17:26<06:12,  8.67s/it]Best trial: 28. Best value: 0.622103:  58%|█████▊    | 58/100 [17:26<06:27,  9.23s/it]Best trial: 28. Best value: 0.622103:  58%|█████▊    | 58/100 [17:33<06:27,  9.23s/it]Best trial: 28. Best value: 0.622103:  59%|█████▉    | 59/100 [17:33<05:47,  8.49s/it]Best trial: 28. Best value: 0.622103:  59%|█████▉    | 59/100 [17:40<05:47,  8.49s/it]Best trial: 28. Best value: 0.622103:  60%|██████    | 60/100 [17:40<05:15,  7.90s/it]Best trial: 28. Best value: 0.622103:  60%|██████    | 60/100 [18:18<05:15,  7.90s/it]Best trial: 28. Best value: 0.622103:  61%|██████    | 61/100 [18:18<11:05, 17.05s/it]Best trial: 28. Best value: 0.622103:  61%|██████    | 61/100 [18:32<11:05, 17.05s/it]Best trial: 28. Best value: 0.622103:  62%|██████▏   | 62/100 [18:32<10:16, 16.22s/it]Best trial: 28. Best value: 0.622103:  62%|██████▏   | 62/100 [18:44<10:16, 16.22s/it]Best trial: 28. Best value: 0.622103:  63%|██████▎   | 63/100 [18:44<09:15, 15.00s/it]Best trial: 28. Best value: 0.622103:  63%|██████▎   | 63/100 [18:54<09:15, 15.00s/it]Best trial: 28. Best value: 0.622103:  64%|██████▍   | 64/100 [18:54<08:05, 13.50s/it]Best trial: 28. Best value: 0.622103:  64%|██████▍   | 64/100 [19:23<08:05, 13.50s/it]Best trial: 28. Best value: 0.622103:  65%|██████▌   | 65/100 [19:23<10:32, 18.06s/it]Best trial: 28. Best value: 0.622103:  65%|██████▌   | 65/100 [19:34<10:32, 18.06s/it]Best trial: 28. Best value: 0.622103:  66%|██████▌   | 66/100 [19:34<08:56, 15.79s/it]Best trial: 28. Best value: 0.622103:  66%|██████▌   | 66/100 [19:59<08:56, 15.79s/it]Best trial: 28. Best value: 0.622103:  67%|██████▋   | 67/100 [19:59<10:14, 18.62s/it]Best trial: 28. Best value: 0.622103:  67%|██████▋   | 67/100 [20:32<10:14, 18.62s/it]Best trial: 28. Best value: 0.622103:  68%|██████▊   | 68/100 [20:32<12:14, 22.95s/it]Best trial: 28. Best value: 0.622103:  68%|██████▊   | 68/100 [20:57<12:14, 22.95s/it]Best trial: 28. Best value: 0.622103:  69%|██████▉   | 69/100 [20:57<12:13, 23.65s/it]Best trial: 28. Best value: 0.622103:  69%|██████▉   | 69/100 [21:14<12:13, 23.65s/it]Best trial: 28. Best value: 0.622103:  70%|███████   | 70/100 [21:14<10:50, 21.68s/it]Best trial: 28. Best value: 0.622103:  70%|███████   | 70/100 [21:45<10:50, 21.68s/it]Best trial: 28. Best value: 0.622103:  71%|███████   | 71/100 [21:45<11:44, 24.30s/it]Best trial: 28. Best value: 0.622103:  71%|███████   | 71/100 [22:06<11:44, 24.30s/it]Best trial: 28. Best value: 0.622103:  72%|███████▏  | 72/100 [22:06<10:56, 23.45s/it]Best trial: 28. Best value: 0.622103:  72%|███████▏  | 72/100 [22:19<10:56, 23.45s/it]Best trial: 28. Best value: 0.622103:  73%|███████▎  | 73/100 [22:19<09:03, 20.14s/it]Best trial: 73. Best value: 0.625554:  73%|███████▎  | 73/100 [22:41<09:03, 20.14s/it]Best trial: 73. Best value: 0.625554:  74%|███████▍  | 74/100 [22:41<09:03, 20.92s/it]Best trial: 73. Best value: 0.625554:  74%|███████▍  | 74/100 [23:10<09:03, 20.92s/it]Best trial: 73. Best value: 0.625554:  75%|███████▌  | 75/100 [23:10<09:41, 23.26s/it]Best trial: 73. Best value: 0.625554:  75%|███████▌  | 75/100 [23:39<09:41, 23.26s/it]Best trial: 73. Best value: 0.625554:  76%|███████▌  | 76/100 [23:39<10:02, 25.09s/it]Best trial: 73. Best value: 0.625554:  76%|███████▌  | 76/100 [24:30<10:02, 25.09s/it]Best trial: 73. Best value: 0.625554:  77%|███████▋  | 77/100 [24:30<12:34, 32.82s/it]Best trial: 73. Best value: 0.625554:  77%|███████▋  | 77/100 [24:55<12:34, 32.82s/it]Best trial: 73. Best value: 0.625554:  78%|███████▊  | 78/100 [24:55<11:11, 30.50s/it]Best trial: 73. Best value: 0.625554:  78%|███████▊  | 78/100 [25:43<11:11, 30.50s/it]Best trial: 73. Best value: 0.625554:  79%|███████▉  | 79/100 [25:43<12:30, 35.74s/it]Best trial: 73. Best value: 0.625554:  79%|███████▉  | 79/100 [26:14<12:30, 35.74s/it]Best trial: 73. Best value: 0.625554:  80%|████████  | 80/100 [26:14<11:24, 34.21s/it]Best trial: 80. Best value: 0.626209:  80%|████████  | 80/100 [26:47<11:24, 34.21s/it]Best trial: 80. Best value: 0.626209:  81%|████████  | 81/100 [26:47<10:43, 33.87s/it]Best trial: 80. Best value: 0.626209:  81%|████████  | 81/100 [27:14<10:43, 33.87s/it]Best trial: 80. Best value: 0.626209:  82%|████████▏ | 82/100 [27:14<09:31, 31.74s/it]Best trial: 80. Best value: 0.626209:  82%|████████▏ | 82/100 [27:42<09:31, 31.74s/it]Best trial: 80. Best value: 0.626209:  83%|████████▎ | 83/100 [27:42<08:40, 30.60s/it]Best trial: 80. Best value: 0.626209:  83%|████████▎ | 83/100 [28:07<08:40, 30.60s/it]Best trial: 80. Best value: 0.626209:  84%|████████▍ | 84/100 [28:07<07:43, 28.95s/it]Best trial: 80. Best value: 0.626209:  84%|████████▍ | 84/100 [28:29<07:43, 28.95s/it]Best trial: 80. Best value: 0.626209:  85%|████████▌ | 85/100 [28:29<06:44, 26.93s/it]Best trial: 80. Best value: 0.626209:  85%|████████▌ | 85/100 [28:47<06:44, 26.93s/it]Best trial: 80. Best value: 0.626209:  86%|████████▌ | 86/100 [28:47<05:40, 24.29s/it]Best trial: 80. Best value: 0.626209:  86%|████████▌ | 86/100 [29:19<05:40, 24.29s/it]Best trial: 80. Best value: 0.626209:  87%|████████▋ | 87/100 [29:19<05:43, 26.46s/it]Best trial: 80. Best value: 0.626209:  87%|████████▋ | 87/100 [29:36<05:43, 26.46s/it]Best trial: 80. Best value: 0.626209:  88%|████████▊ | 88/100 [29:36<04:46, 23.85s/it]Best trial: 80. Best value: 0.626209:  88%|████████▊ | 88/100 [30:08<04:46, 23.85s/it]Best trial: 80. Best value: 0.626209:  89%|████████▉ | 89/100 [30:08<04:47, 26.14s/it]Best trial: 80. Best value: 0.626209:  89%|████████▉ | 89/100 [30:46<04:47, 26.14s/it]Best trial: 80. Best value: 0.626209:  90%|█████████ | 90/100 [30:46<04:56, 29.62s/it]Best trial: 80. Best value: 0.626209:  90%|█████████ | 90/100 [31:12<04:56, 29.62s/it]Best trial: 80. Best value: 0.626209:  91%|█████████ | 91/100 [31:12<04:16, 28.51s/it]Best trial: 80. Best value: 0.626209:  91%|█████████ | 91/100 [31:36<04:16, 28.51s/it]Best trial: 80. Best value: 0.626209:  92%|█████████▏| 92/100 [31:36<03:37, 27.25s/it]Best trial: 80. Best value: 0.626209:  92%|█████████▏| 92/100 [31:59<03:37, 27.25s/it]Best trial: 80. Best value: 0.626209:  93%|█████████▎| 93/100 [31:59<03:02, 26.05s/it]Best trial: 80. Best value: 0.626209:  93%|█████████▎| 93/100 [32:20<03:02, 26.05s/it]Best trial: 80. Best value: 0.626209:  94%|█████████▍| 94/100 [32:20<02:26, 24.37s/it]Best trial: 80. Best value: 0.626209:  94%|█████████▍| 94/100 [32:44<02:26, 24.37s/it]Best trial: 80. Best value: 0.626209:  95%|█████████▌| 95/100 [32:44<02:01, 24.36s/it]Best trial: 80. Best value: 0.626209:  95%|█████████▌| 95/100 [33:16<02:01, 24.36s/it]Best trial: 80. Best value: 0.626209:  96%|█████████▌| 96/100 [33:16<01:46, 26.62s/it]Best trial: 80. Best value: 0.626209:  96%|█████████▌| 96/100 [33:31<01:46, 26.62s/it]Best trial: 80. Best value: 0.626209:  97%|█████████▋| 97/100 [33:31<01:09, 23.21s/it]Best trial: 80. Best value: 0.626209:  97%|█████████▋| 97/100 [33:54<01:09, 23.21s/it]Best trial: 80. Best value: 0.626209:  98%|█████████▊| 98/100 [33:54<00:46, 23.05s/it]Best trial: 80. Best value: 0.626209:  98%|█████████▊| 98/100 [34:09<00:46, 23.05s/it]Best trial: 80. Best value: 0.626209:  99%|█████████▉| 99/100 [34:09<00:20, 20.58s/it]Best trial: 80. Best value: 0.626209:  99%|█████████▉| 99/100 [34:39<00:20, 20.58s/it]Best trial: 80. Best value: 0.626209: 100%|██████████| 100/100 [34:39<00:00, 23.52s/it]Best trial: 80. Best value: 0.626209: 100%|██████████| 100/100 [34:39<00:00, 20.79s/it]
2025-11-30 23:31:08,939 - INFO - HPO Complete. Best AUPRC: 0.6262
2025-11-30 23:31:08,940 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.01777514704314782, 'max_depth': 8, 'subsample': 0.6845281708671488, 'colsample_bytree': 0.9137212834466, 'gamma': 2.971544819487097, 'reg_lambda': 0.0037266443722738262, 'reg_alpha': 1.055458654086309e-08}
2025-11-30 23:31:08,940 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-11-30 23:31:11,102 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-11-30 23:31:11,102 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 23:31:11,326 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 23:31:11,395 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 23:31:11,409 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 23:31:11,409 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-11-30 23:31:11,409 - INFO - Training model...
2025-11-30 23:31:22,602 - INFO - Evaluating model with bootstrapping...
2025-11-30 23:31:29,180 - INFO - --- Final Metrics (with 95% CIs) ---
2025-11-30 23:31:29,180 - INFO - AUROC: 0.8019 (0.7700 - 0.8276)
2025-11-30 23:31:29,180 - INFO - AUPRC: 0.5389 (0.4757 - 0.6228)
2025-11-30 23:31:29,180 - INFO - Brier Score: 0.1422 (0.1319 - 0.1539)
2025-11-30 23:31:29,180 - INFO - Accuracy: 0.7847 (0.7471 - 0.8118)
2025-11-30 23:31:29,180 - INFO - Precision: 0.5222 (0.4522 - 0.5953)
2025-11-30 23:31:29,180 - INFO - Sensitivity (Recall): 0.6709 (0.6014 - 0.7405)
2025-11-30 23:31:29,180 - INFO - F1-Score: 0.5873 (0.5381 - 0.6339)
2025-11-30 23:31:29,180 - INFO - Best Threshold: 0.3600 (0.2960 - 0.4140)
2025-11-30 23:31:29,180 - INFO - Specificity: 0.8184 (0.7666 - 0.8605)
2025-11-30 23:31:29,205 - INFO - Calculating SHAP values...
2025-11-30 23:31:30,603 - INFO - SHAP plots saved.
2025-11-30 23:31:30,604 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-11-30 23:31:31,785 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-11-30 23:31:31,785 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-11-30 23:31:31,978 - INFO - Data loaded. Shape: (3453, 483)
2025-11-30 23:31:32,043 - INFO - Using existing 'split_group' column for train/test split.
2025-11-30 23:31:32,055 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-11-30 23:31:32,055 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.560784:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.560784:   1%|          | 1/100 [00:07<11:43,  7.10s/it]Best trial: 1. Best value: 0.593463:   1%|          | 1/100 [00:44<11:43,  7.10s/it]Best trial: 1. Best value: 0.593463:   2%|▏         | 2/100 [00:44<41:00, 25.11s/it]Best trial: 2. Best value: 0.609916:   2%|▏         | 2/100 [00:51<41:00, 25.11s/it]Best trial: 2. Best value: 0.609916:   3%|▎         | 3/100 [00:51<27:12, 16.83s/it]Best trial: 3. Best value: 0.61064:   3%|▎         | 3/100 [01:17<27:12, 16.83s/it] Best trial: 3. Best value: 0.61064:   4%|▍         | 4/100 [01:17<32:32, 20.34s/it]Best trial: 3. Best value: 0.61064:   4%|▍         | 4/100 [01:50<32:32, 20.34s/it]Best trial: 3. Best value: 0.61064:   5%|▌         | 5/100 [01:50<39:17, 24.81s/it]Best trial: 3. Best value: 0.61064:   5%|▌         | 5/100 [02:01<39:17, 24.81s/it]Best trial: 3. Best value: 0.61064:   6%|▌         | 6/100 [02:01<31:27, 20.08s/it]Best trial: 3. Best value: 0.61064:   6%|▌         | 6/100 [02:30<31:27, 20.08s/it]Best trial: 3. Best value: 0.61064:   7%|▋         | 7/100 [02:30<35:37, 22.99s/it]Best trial: 3. Best value: 0.61064:   7%|▋         | 7/100 [02:47<35:37, 22.99s/it]Best trial: 3. Best value: 0.61064:   8%|▊         | 8/100 [02:47<32:42, 21.33s/it]Best trial: 3. Best value: 0.61064:   8%|▊         | 8/100 [03:17<32:42, 21.33s/it]Best trial: 3. Best value: 0.61064:   9%|▉         | 9/100 [03:17<36:13, 23.88s/it]Best trial: 3. Best value: 0.61064:   9%|▉         | 9/100 [03:57<36:13, 23.88s/it]Best trial: 3. Best value: 0.61064:  10%|█         | 10/100 [03:57<43:21, 28.90s/it]Best trial: 3. Best value: 0.61064:  10%|█         | 10/100 [04:32<43:21, 28.90s/it]Best trial: 3. Best value: 0.61064:  11%|█         | 11/100 [04:32<45:46, 30.86s/it]Best trial: 3. Best value: 0.61064:  11%|█         | 11/100 [04:38<45:46, 30.86s/it]Best trial: 3. Best value: 0.61064:  12%|█▏        | 12/100 [04:38<34:05, 23.25s/it]Best trial: 12. Best value: 0.61687:  12%|█▏        | 12/100 [04:47<34:05, 23.25s/it]Best trial: 12. Best value: 0.61687:  13%|█▎        | 13/100 [04:47<27:35, 19.02s/it]Best trial: 12. Best value: 0.61687:  13%|█▎        | 13/100 [05:04<27:35, 19.02s/it]Best trial: 12. Best value: 0.61687:  14%|█▍        | 14/100 [05:04<26:08, 18.24s/it]Best trial: 12. Best value: 0.61687:  14%|█▍        | 14/100 [05:14<26:08, 18.24s/it]Best trial: 12. Best value: 0.61687:  15%|█▌        | 15/100 [05:14<22:30, 15.89s/it]Best trial: 12. Best value: 0.61687:  15%|█▌        | 15/100 [05:30<22:30, 15.89s/it]Best trial: 12. Best value: 0.61687:  16%|█▌        | 16/100 [05:30<22:01, 15.73s/it]Best trial: 12. Best value: 0.61687:  16%|█▌        | 16/100 [05:43<22:01, 15.73s/it]Best trial: 12. Best value: 0.61687:  17%|█▋        | 17/100 [05:43<20:38, 14.92s/it]Best trial: 12. Best value: 0.61687:  17%|█▋        | 17/100 [05:58<20:38, 14.92s/it]Best trial: 12. Best value: 0.61687:  18%|█▊        | 18/100 [05:58<20:24, 14.93s/it]Best trial: 12. Best value: 0.61687:  18%|█▊        | 18/100 [06:07<20:24, 14.93s/it]Best trial: 12. Best value: 0.61687:  19%|█▉        | 19/100 [06:07<17:49, 13.21s/it]Best trial: 12. Best value: 0.61687:  19%|█▉        | 19/100 [06:23<17:49, 13.21s/it]Best trial: 12. Best value: 0.61687:  20%|██        | 20/100 [06:23<18:36, 13.96s/it]Best trial: 12. Best value: 0.61687:  20%|██        | 20/100 [06:39<18:36, 13.96s/it]Best trial: 12. Best value: 0.61687:  21%|██        | 21/100 [06:39<19:15, 14.63s/it]Best trial: 12. Best value: 0.61687:  21%|██        | 21/100 [06:52<19:15, 14.63s/it]Best trial: 12. Best value: 0.61687:  22%|██▏       | 22/100 [06:52<18:23, 14.14s/it]Best trial: 12. Best value: 0.61687:  22%|██▏       | 22/100 [07:12<18:23, 14.14s/it]Best trial: 12. Best value: 0.61687:  23%|██▎       | 23/100 [07:12<20:31, 16.00s/it]Best trial: 23. Best value: 0.618807:  23%|██▎       | 23/100 [07:30<20:31, 16.00s/it]Best trial: 23. Best value: 0.618807:  24%|██▍       | 24/100 [07:30<21:02, 16.61s/it]Best trial: 23. Best value: 0.618807:  24%|██▍       | 24/100 [07:46<21:02, 16.61s/it]Best trial: 23. Best value: 0.618807:  25%|██▌       | 25/100 [07:46<20:38, 16.52s/it]Best trial: 23. Best value: 0.618807:  25%|██▌       | 25/100 [08:14<20:38, 16.52s/it]Best trial: 23. Best value: 0.618807:  26%|██▌       | 26/100 [08:14<24:19, 19.72s/it]Best trial: 23. Best value: 0.618807:  26%|██▌       | 26/100 [08:21<24:19, 19.72s/it]Best trial: 23. Best value: 0.618807:  27%|██▋       | 27/100 [08:21<19:38, 16.14s/it]Best trial: 23. Best value: 0.618807:  27%|██▋       | 27/100 [08:39<19:38, 16.14s/it]Best trial: 23. Best value: 0.618807:  28%|██▊       | 28/100 [08:39<20:03, 16.71s/it]Best trial: 23. Best value: 0.618807:  28%|██▊       | 28/100 [09:31<20:03, 16.71s/it]Best trial: 23. Best value: 0.618807:  29%|██▉       | 29/100 [09:31<32:09, 27.17s/it]Best trial: 23. Best value: 0.618807:  29%|██▉       | 29/100 [09:45<32:09, 27.17s/it]Best trial: 23. Best value: 0.618807:  30%|███       | 30/100 [09:45<27:09, 23.28s/it]Best trial: 23. Best value: 0.618807:  30%|███       | 30/100 [10:06<27:09, 23.28s/it]Best trial: 23. Best value: 0.618807:  31%|███       | 31/100 [10:06<25:53, 22.51s/it]Best trial: 23. Best value: 0.618807:  31%|███       | 31/100 [10:22<25:53, 22.51s/it]Best trial: 23. Best value: 0.618807:  32%|███▏      | 32/100 [10:22<23:18, 20.56s/it]Best trial: 23. Best value: 0.618807:  32%|███▏      | 32/100 [10:33<23:18, 20.56s/it]Best trial: 23. Best value: 0.618807:  33%|███▎      | 33/100 [10:33<19:40, 17.62s/it]Best trial: 23. Best value: 0.618807:  33%|███▎      | 33/100 [10:48<19:40, 17.62s/it]Best trial: 23. Best value: 0.618807:  34%|███▍      | 34/100 [10:48<18:43, 17.02s/it]Best trial: 34. Best value: 0.627686:  34%|███▍      | 34/100 [11:23<18:43, 17.02s/it]Best trial: 34. Best value: 0.627686:  35%|███▌      | 35/100 [11:23<24:19, 22.45s/it]Best trial: 34. Best value: 0.627686:  35%|███▌      | 35/100 [11:57<24:19, 22.45s/it]Best trial: 34. Best value: 0.627686:  36%|███▌      | 36/100 [11:57<27:35, 25.87s/it]Best trial: 34. Best value: 0.627686:  36%|███▌      | 36/100 [12:10<27:35, 25.87s/it]Best trial: 34. Best value: 0.627686:  37%|███▋      | 37/100 [12:10<23:05, 21.99s/it]Best trial: 34. Best value: 0.627686:  37%|███▋      | 37/100 [12:58<23:05, 21.99s/it]Best trial: 34. Best value: 0.627686:  38%|███▊      | 38/100 [12:58<30:43, 29.73s/it]Best trial: 34. Best value: 0.627686:  38%|███▊      | 38/100 [13:18<30:43, 29.73s/it]Best trial: 34. Best value: 0.627686:  39%|███▉      | 39/100 [13:18<27:14, 26.80s/it]Best trial: 34. Best value: 0.627686:  39%|███▉      | 39/100 [13:44<27:14, 26.80s/it]Best trial: 34. Best value: 0.627686:  40%|████      | 40/100 [13:44<26:39, 26.66s/it]Best trial: 34. Best value: 0.627686:  40%|████      | 40/100 [14:05<26:39, 26.66s/it]Best trial: 34. Best value: 0.627686:  41%|████      | 41/100 [14:05<24:24, 24.82s/it]Best trial: 34. Best value: 0.627686:  41%|████      | 41/100 [14:18<24:24, 24.82s/it]Best trial: 34. Best value: 0.627686:  42%|████▏     | 42/100 [14:18<20:39, 21.38s/it]Best trial: 34. Best value: 0.627686:  42%|████▏     | 42/100 [14:27<20:39, 21.38s/it]Best trial: 34. Best value: 0.627686:  43%|████▎     | 43/100 [14:27<16:39, 17.53s/it]Best trial: 34. Best value: 0.627686:  43%|████▎     | 43/100 [14:33<16:39, 17.53s/it]Best trial: 34. Best value: 0.627686:  44%|████▍     | 44/100 [14:33<13:15, 14.21s/it]Best trial: 34. Best value: 0.627686:  44%|████▍     | 44/100 [14:41<13:15, 14.21s/it]Best trial: 34. Best value: 0.627686:  45%|████▌     | 45/100 [14:41<11:08, 12.16s/it]Best trial: 34. Best value: 0.627686:  45%|████▌     | 45/100 [14:48<11:08, 12.16s/it]Best trial: 34. Best value: 0.627686:  46%|████▌     | 46/100 [14:48<09:37, 10.69s/it]Best trial: 34. Best value: 0.627686:  46%|████▌     | 46/100 [14:55<09:37, 10.69s/it]Best trial: 34. Best value: 0.627686:  47%|████▋     | 47/100 [14:55<08:37,  9.76s/it]Best trial: 34. Best value: 0.627686:  47%|████▋     | 47/100 [15:01<08:37,  9.76s/it]Best trial: 34. Best value: 0.627686:  48%|████▊     | 48/100 [15:01<07:21,  8.49s/it]Best trial: 34. Best value: 0.627686:  48%|████▊     | 48/100 [15:09<07:21,  8.49s/it]Best trial: 34. Best value: 0.627686:  49%|████▉     | 49/100 [15:09<07:00,  8.25s/it]Best trial: 34. Best value: 0.627686:  49%|████▉     | 49/100 [15:14<07:00,  8.25s/it]Best trial: 34. Best value: 0.627686:  50%|█████     | 50/100 [15:14<06:10,  7.40s/it]Best trial: 34. Best value: 0.627686:  50%|█████     | 50/100 [15:22<06:10,  7.40s/it]Best trial: 34. Best value: 0.627686:  51%|█████     | 51/100 [15:22<06:14,  7.65s/it]Best trial: 34. Best value: 0.627686:  51%|█████     | 51/100 [15:33<06:14,  7.65s/it]Best trial: 34. Best value: 0.627686:  52%|█████▏    | 52/100 [15:33<06:52,  8.60s/it]Best trial: 34. Best value: 0.627686:  52%|█████▏    | 52/100 [15:42<06:52,  8.60s/it]Best trial: 34. Best value: 0.627686:  53%|█████▎    | 53/100 [15:42<06:44,  8.62s/it]Best trial: 34. Best value: 0.627686:  53%|█████▎    | 53/100 [15:54<06:44,  8.62s/it]Best trial: 34. Best value: 0.627686:  54%|█████▍    | 54/100 [15:54<07:25,  9.69s/it]Best trial: 34. Best value: 0.627686:  54%|█████▍    | 54/100 [16:03<07:25,  9.69s/it]Best trial: 34. Best value: 0.627686:  55%|█████▌    | 55/100 [16:03<07:12,  9.61s/it]Best trial: 34. Best value: 0.627686:  55%|█████▌    | 55/100 [16:12<07:12,  9.61s/it]Best trial: 34. Best value: 0.627686:  56%|█████▌    | 56/100 [16:12<06:42,  9.15s/it]Best trial: 34. Best value: 0.627686:  56%|█████▌    | 56/100 [16:24<06:42,  9.15s/it]Best trial: 34. Best value: 0.627686:  57%|█████▋    | 57/100 [16:24<07:11, 10.05s/it]Best trial: 34. Best value: 0.627686:  57%|█████▋    | 57/100 [16:33<07:11, 10.05s/it]Best trial: 34. Best value: 0.627686:  58%|█████▊    | 58/100 [16:33<06:47,  9.71s/it]Best trial: 34. Best value: 0.627686:  58%|█████▊    | 58/100 [16:39<06:47,  9.71s/it]Best trial: 34. Best value: 0.627686:  59%|█████▉    | 59/100 [16:39<05:57,  8.72s/it]Best trial: 34. Best value: 0.627686:  59%|█████▉    | 59/100 [16:44<05:57,  8.72s/it]Best trial: 34. Best value: 0.627686:  60%|██████    | 60/100 [16:44<05:02,  7.56s/it]Best trial: 34. Best value: 0.627686:  60%|██████    | 60/100 [17:33<05:02,  7.56s/it]Best trial: 34. Best value: 0.627686:  61%|██████    | 61/100 [17:33<13:04, 20.12s/it]Best trial: 34. Best value: 0.627686:  61%|██████    | 61/100 [18:17<13:04, 20.12s/it]Best trial: 34. Best value: 0.627686:  62%|██████▏   | 62/100 [18:17<17:11, 27.16s/it]Best trial: 34. Best value: 0.627686:  62%|██████▏   | 62/100 [18:56<17:11, 27.16s/it]Best trial: 34. Best value: 0.627686:  63%|██████▎   | 63/100 [18:56<19:02, 30.88s/it]Best trial: 34. Best value: 0.627686:  63%|██████▎   | 63/100 [19:22<19:02, 30.88s/it]Best trial: 34. Best value: 0.627686:  64%|██████▍   | 64/100 [19:22<17:34, 29.29s/it]Best trial: 34. Best value: 0.627686:  64%|██████▍   | 64/100 [19:29<17:34, 29.29s/it]Best trial: 34. Best value: 0.627686:  65%|██████▌   | 65/100 [19:29<13:12, 22.65s/it]Best trial: 34. Best value: 0.627686:  65%|██████▌   | 65/100 [19:38<13:12, 22.65s/it]Best trial: 34. Best value: 0.627686:  66%|██████▌   | 66/100 [19:38<10:26, 18.43s/it]Best trial: 34. Best value: 0.627686:  66%|██████▌   | 66/100 [19:45<10:26, 18.43s/it]Best trial: 34. Best value: 0.627686:  67%|██████▋   | 67/100 [19:45<08:22, 15.23s/it]Best trial: 34. Best value: 0.627686:  67%|██████▋   | 67/100 [19:51<08:22, 15.23s/it]Best trial: 34. Best value: 0.627686:  68%|██████▊   | 68/100 [19:51<06:36, 12.39s/it]Best trial: 34. Best value: 0.627686:  68%|██████▊   | 68/100 [20:14<06:36, 12.39s/it]Best trial: 34. Best value: 0.627686:  69%|██████▉   | 69/100 [20:14<07:59, 15.48s/it]Best trial: 34. Best value: 0.627686:  69%|██████▉   | 69/100 [20:27<07:59, 15.48s/it]Best trial: 34. Best value: 0.627686:  70%|███████   | 70/100 [20:27<07:25, 14.86s/it]Best trial: 34. Best value: 0.627686:  70%|███████   | 70/100 [20:36<07:25, 14.86s/it]Best trial: 34. Best value: 0.627686:  71%|███████   | 71/100 [20:36<06:21, 13.14s/it]Best trial: 34. Best value: 0.627686:  71%|███████   | 71/100 [20:42<06:21, 13.14s/it]Best trial: 34. Best value: 0.627686:  72%|███████▏  | 72/100 [20:42<05:01, 10.76s/it]Best trial: 34. Best value: 0.627686:  72%|███████▏  | 72/100 [20:49<05:01, 10.76s/it]Best trial: 34. Best value: 0.627686:  73%|███████▎  | 73/100 [20:49<04:24,  9.78s/it]Best trial: 34. Best value: 0.627686:  73%|███████▎  | 73/100 [21:03<04:24,  9.78s/it]Best trial: 34. Best value: 0.627686:  74%|███████▍  | 74/100 [21:03<04:42, 10.87s/it]Best trial: 34. Best value: 0.627686:  74%|███████▍  | 74/100 [21:14<04:42, 10.87s/it]Best trial: 34. Best value: 0.627686:  75%|███████▌  | 75/100 [21:14<04:36, 11.05s/it]Best trial: 34. Best value: 0.627686:  75%|███████▌  | 75/100 [21:54<04:36, 11.05s/it]Best trial: 34. Best value: 0.627686:  76%|███████▌  | 76/100 [21:54<07:52, 19.69s/it]Best trial: 34. Best value: 0.627686:  76%|███████▌  | 76/100 [22:07<07:52, 19.69s/it]Best trial: 34. Best value: 0.627686:  77%|███████▋  | 77/100 [22:07<06:48, 17.75s/it]Best trial: 34. Best value: 0.627686:  77%|███████▋  | 77/100 [22:35<06:48, 17.75s/it]Best trial: 34. Best value: 0.627686:  78%|███████▊  | 78/100 [22:35<07:34, 20.68s/it]Best trial: 34. Best value: 0.627686:  78%|███████▊  | 78/100 [22:42<07:34, 20.68s/it]Best trial: 34. Best value: 0.627686:  79%|███████▉  | 79/100 [22:42<05:51, 16.74s/it]Best trial: 34. Best value: 0.627686:  79%|███████▉  | 79/100 [23:02<05:51, 16.74s/it]Best trial: 34. Best value: 0.627686:  80%|████████  | 80/100 [23:02<05:51, 17.55s/it]Best trial: 34. Best value: 0.627686:  80%|████████  | 80/100 [23:19<05:51, 17.55s/it]Best trial: 34. Best value: 0.627686:  81%|████████  | 81/100 [23:19<05:34, 17.63s/it]Best trial: 34. Best value: 0.627686:  81%|████████  | 81/100 [23:38<05:34, 17.63s/it]Best trial: 34. Best value: 0.627686:  82%|████████▏ | 82/100 [23:38<05:22, 17.89s/it]Best trial: 34. Best value: 0.627686:  82%|████████▏ | 82/100 [24:04<05:22, 17.89s/it]Best trial: 34. Best value: 0.627686:  83%|████████▎ | 83/100 [24:04<05:46, 20.39s/it]Best trial: 34. Best value: 0.627686:  83%|████████▎ | 83/100 [24:32<05:46, 20.39s/it]Best trial: 34. Best value: 0.627686:  84%|████████▍ | 84/100 [24:32<06:00, 22.53s/it]Best trial: 84. Best value: 0.628679:  84%|████████▍ | 84/100 [24:55<06:00, 22.53s/it]Best trial: 84. Best value: 0.628679:  85%|████████▌ | 85/100 [24:55<05:42, 22.82s/it]Best trial: 84. Best value: 0.628679:  85%|████████▌ | 85/100 [25:25<05:42, 22.82s/it]Best trial: 84. Best value: 0.628679:  86%|████████▌ | 86/100 [25:25<05:47, 24.85s/it]Best trial: 84. Best value: 0.628679:  86%|████████▌ | 86/100 [26:06<05:47, 24.85s/it]Best trial: 84. Best value: 0.628679:  87%|████████▋ | 87/100 [26:06<06:27, 29.78s/it]Best trial: 84. Best value: 0.628679:  87%|████████▋ | 87/100 [26:57<06:27, 29.78s/it]Best trial: 84. Best value: 0.628679:  88%|████████▊ | 88/100 [26:57<07:12, 36.03s/it]Best trial: 84. Best value: 0.628679:  88%|████████▊ | 88/100 [27:30<07:12, 36.03s/it]Best trial: 84. Best value: 0.628679:  89%|████████▉ | 89/100 [27:30<06:26, 35.14s/it]Best trial: 84. Best value: 0.628679:  89%|████████▉ | 89/100 [28:14<06:26, 35.14s/it]Best trial: 84. Best value: 0.628679:  90%|█████████ | 90/100 [28:14<06:17, 37.74s/it]Best trial: 84. Best value: 0.628679:  90%|█████████ | 90/100 [28:52<06:17, 37.74s/it]Best trial: 84. Best value: 0.628679:  91%|█████████ | 91/100 [28:52<05:40, 37.88s/it]Best trial: 91. Best value: 0.631271:  91%|█████████ | 91/100 [29:34<05:40, 37.88s/it]Best trial: 91. Best value: 0.631271:  92%|█████████▏| 92/100 [29:34<05:14, 39.31s/it]Best trial: 91. Best value: 0.631271:  92%|█████████▏| 92/100 [30:03<05:14, 39.31s/it]Best trial: 91. Best value: 0.631271:  93%|█████████▎| 93/100 [30:03<04:13, 36.22s/it]Best trial: 91. Best value: 0.631271:  93%|█████████▎| 93/100 [30:41<04:13, 36.22s/it]Best trial: 91. Best value: 0.631271:  94%|█████████▍| 94/100 [30:41<03:39, 36.56s/it]Best trial: 91. Best value: 0.631271:  94%|█████████▍| 94/100 [31:18<03:39, 36.56s/it]Best trial: 91. Best value: 0.631271:  95%|█████████▌| 95/100 [31:18<03:04, 36.81s/it]Best trial: 95. Best value: 0.632209:  95%|█████████▌| 95/100 [32:02<03:04, 36.81s/it]Best trial: 95. Best value: 0.632209:  96%|█████████▌| 96/100 [32:02<02:35, 38.86s/it]Best trial: 95. Best value: 0.632209:  96%|█████████▌| 96/100 [32:35<02:35, 38.86s/it]Best trial: 95. Best value: 0.632209:  97%|█████████▋| 97/100 [32:35<01:51, 37.14s/it]Best trial: 95. Best value: 0.632209:  97%|█████████▋| 97/100 [33:06<01:51, 37.14s/it]Best trial: 95. Best value: 0.632209:  98%|█████████▊| 98/100 [33:06<01:10, 35.38s/it]Best trial: 95. Best value: 0.632209:  98%|█████████▊| 98/100 [34:02<01:10, 35.38s/it]Best trial: 95. Best value: 0.632209:  99%|█████████▉| 99/100 [34:02<00:41, 41.39s/it]Best trial: 95. Best value: 0.632209:  99%|█████████▉| 99/100 [34:27<00:41, 41.39s/it]Best trial: 95. Best value: 0.632209: 100%|██████████| 100/100 [34:27<00:00, 36.61s/it]Best trial: 95. Best value: 0.632209: 100%|██████████| 100/100 [34:27<00:00, 20.68s/it]
2025-12-01 00:05:59,660 - INFO - HPO Complete. Best AUPRC: 0.6322
2025-12-01 00:05:59,660 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.029197291402209717, 'max_depth': 8, 'subsample': 0.8152683539113579, 'colsample_bytree': 0.7507377977495909, 'gamma': 0.6028762425493759, 'reg_lambda': 0.4338876810364246, 'reg_alpha': 0.0014652658108016876}
2025-12-01 00:05:59,661 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:06:01,828 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-12-01 00:06:01,830 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 00:06:02,061 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 00:06:02,134 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:06:02,151 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 00:06:02,151 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-12-01 00:06:02,152 - INFO - Training model...
2025-12-01 00:06:13,857 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:06:20,660 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:06:20,660 - INFO - AUROC: 0.8061 (0.7765 - 0.8279)
2025-12-01 00:06:20,660 - INFO - AUPRC: 0.5560 (0.4955 - 0.6438)
2025-12-01 00:06:20,660 - INFO - Brier Score: 0.1428 (0.1321 - 0.1560)
2025-12-01 00:06:20,660 - INFO - Accuracy: 0.7818 (0.7529 - 0.8182)
2025-12-01 00:06:20,660 - INFO - Precision: 0.5178 (0.4634 - 0.6453)
2025-12-01 00:06:20,660 - INFO - Sensitivity (Recall): 0.6456 (0.5669 - 0.7258)
2025-12-01 00:06:20,660 - INFO - F1-Score: 0.5746 (0.5333 - 0.6392)
2025-12-01 00:06:20,660 - INFO - Best Threshold: 0.2400 (0.1900 - 0.3400)
2025-12-01 00:06:20,660 - INFO - Specificity: 0.8221 (0.7811 - 0.8973)
2025-12-01 00:06:20,686 - INFO - Calculating SHAP values...
2025-12-01 00:06:22,102 - INFO - SHAP plots saved.
2025-12-01 00:06:22,103 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=extended_los | Branch=windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:06:23,313 - INFO - Starting HPO for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 00:06:23,313 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 00:06:23,507 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 00:06:23,573 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:06:23,585 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 00:06:23,585 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.581937:   0%|          | 0/100 [00:28<?, ?it/s]Best trial: 0. Best value: 0.581937:   1%|          | 1/100 [00:28<47:04, 28.53s/it]Best trial: 1. Best value: 0.620441:   1%|          | 1/100 [00:34<47:04, 28.53s/it]Best trial: 1. Best value: 0.620441:   2%|▏         | 2/100 [00:34<25:00, 15.31s/it]Best trial: 2. Best value: 0.623983:   2%|▏         | 2/100 [01:16<25:00, 15.31s/it]Best trial: 2. Best value: 0.623983:   3%|▎         | 3/100 [01:16<44:11, 27.34s/it]Best trial: 2. Best value: 0.623983:   3%|▎         | 3/100 [01:41<44:11, 27.34s/it]Best trial: 2. Best value: 0.623983:   4%|▍         | 4/100 [01:41<42:44, 26.71s/it]Best trial: 2. Best value: 0.623983:   4%|▍         | 4/100 [02:16<42:44, 26.71s/it]Best trial: 2. Best value: 0.623983:   5%|▌         | 5/100 [02:16<46:46, 29.54s/it]Best trial: 2. Best value: 0.623983:   5%|▌         | 5/100 [02:31<46:46, 29.54s/it]Best trial: 2. Best value: 0.623983:   6%|▌         | 6/100 [02:31<38:45, 24.74s/it]Best trial: 2. Best value: 0.623983:   6%|▌         | 6/100 [03:04<38:45, 24.74s/it]Best trial: 2. Best value: 0.623983:   7%|▋         | 7/100 [03:04<42:12, 27.23s/it]Best trial: 2. Best value: 0.623983:   7%|▋         | 7/100 [03:17<42:12, 27.23s/it]Best trial: 2. Best value: 0.623983:   8%|▊         | 8/100 [03:17<34:55, 22.78s/it]Best trial: 8. Best value: 0.628072:   8%|▊         | 8/100 [03:42<34:55, 22.78s/it]Best trial: 8. Best value: 0.628072:   9%|▉         | 9/100 [03:42<35:40, 23.52s/it]Best trial: 8. Best value: 0.628072:   9%|▉         | 9/100 [03:50<35:40, 23.52s/it]Best trial: 8. Best value: 0.628072:  10%|█         | 10/100 [03:50<27:54, 18.61s/it]Best trial: 8. Best value: 0.628072:  10%|█         | 10/100 [04:02<27:54, 18.61s/it]Best trial: 8. Best value: 0.628072:  11%|█         | 11/100 [04:02<24:49, 16.73s/it]Best trial: 8. Best value: 0.628072:  11%|█         | 11/100 [04:23<24:49, 16.73s/it]Best trial: 8. Best value: 0.628072:  12%|█▏        | 12/100 [04:23<26:21, 17.97s/it]Best trial: 8. Best value: 0.628072:  12%|█▏        | 12/100 [05:03<26:21, 17.97s/it]Best trial: 8. Best value: 0.628072:  13%|█▎        | 13/100 [05:03<35:48, 24.69s/it]Best trial: 8. Best value: 0.628072:  13%|█▎        | 13/100 [05:50<35:48, 24.69s/it]Best trial: 8. Best value: 0.628072:  14%|█▍        | 14/100 [05:50<44:43, 31.20s/it]Best trial: 8. Best value: 0.628072:  14%|█▍        | 14/100 [05:59<44:43, 31.20s/it]Best trial: 8. Best value: 0.628072:  15%|█▌        | 15/100 [05:59<34:54, 24.64s/it]Best trial: 8. Best value: 0.628072:  15%|█▌        | 15/100 [06:58<34:54, 24.64s/it]Best trial: 8. Best value: 0.628072:  16%|█▌        | 16/100 [06:58<49:09, 35.12s/it]Best trial: 8. Best value: 0.628072:  16%|█▌        | 16/100 [07:13<49:09, 35.12s/it]Best trial: 8. Best value: 0.628072:  17%|█▋        | 17/100 [07:13<40:08, 29.02s/it]Best trial: 8. Best value: 0.628072:  17%|█▋        | 17/100 [07:33<40:08, 29.02s/it]Best trial: 8. Best value: 0.628072:  18%|█▊        | 18/100 [07:33<35:42, 26.13s/it]Best trial: 8. Best value: 0.628072:  18%|█▊        | 18/100 [08:20<35:42, 26.13s/it]Best trial: 8. Best value: 0.628072:  19%|█▉        | 19/100 [08:20<43:44, 32.40s/it]Best trial: 8. Best value: 0.628072:  19%|█▉        | 19/100 [08:41<43:44, 32.40s/it]Best trial: 8. Best value: 0.628072:  20%|██        | 20/100 [08:41<38:53, 29.17s/it]Best trial: 8. Best value: 0.628072:  20%|██        | 20/100 [09:05<38:53, 29.17s/it]Best trial: 8. Best value: 0.628072:  21%|██        | 21/100 [09:05<36:18, 27.58s/it]Best trial: 8. Best value: 0.628072:  21%|██        | 21/100 [09:18<36:18, 27.58s/it]Best trial: 8. Best value: 0.628072:  22%|██▏       | 22/100 [09:18<29:56, 23.04s/it]Best trial: 8. Best value: 0.628072:  22%|██▏       | 22/100 [09:26<29:56, 23.04s/it]Best trial: 8. Best value: 0.628072:  23%|██▎       | 23/100 [09:26<24:01, 18.72s/it]Best trial: 8. Best value: 0.628072:  23%|██▎       | 23/100 [09:38<24:01, 18.72s/it]Best trial: 8. Best value: 0.628072:  24%|██▍       | 24/100 [09:38<20:59, 16.57s/it]Best trial: 8. Best value: 0.628072:  24%|██▍       | 24/100 [09:56<20:59, 16.57s/it]Best trial: 8. Best value: 0.628072:  25%|██▌       | 25/100 [09:56<21:24, 17.13s/it]Best trial: 8. Best value: 0.628072:  25%|██▌       | 25/100 [10:03<21:24, 17.13s/it]Best trial: 8. Best value: 0.628072:  26%|██▌       | 26/100 [10:03<17:07, 13.88s/it]Best trial: 8. Best value: 0.628072:  26%|██▌       | 26/100 [10:39<17:07, 13.88s/it]Best trial: 8. Best value: 0.628072:  27%|██▋       | 27/100 [10:39<25:12, 20.72s/it]Best trial: 8. Best value: 0.628072:  27%|██▋       | 27/100 [11:09<25:12, 20.72s/it]Best trial: 8. Best value: 0.628072:  28%|██▊       | 28/100 [11:09<28:07, 23.43s/it]Best trial: 8. Best value: 0.628072:  28%|██▊       | 28/100 [11:31<28:07, 23.43s/it]Best trial: 8. Best value: 0.628072:  29%|██▉       | 29/100 [11:31<27:08, 22.93s/it]Best trial: 8. Best value: 0.628072:  29%|██▉       | 29/100 [11:44<27:08, 22.93s/it]Best trial: 8. Best value: 0.628072:  30%|███       | 30/100 [11:44<23:30, 20.15s/it]Best trial: 8. Best value: 0.628072:  30%|███       | 30/100 [12:01<23:30, 20.15s/it]Best trial: 8. Best value: 0.628072:  31%|███       | 31/100 [12:01<21:58, 19.10s/it]Best trial: 8. Best value: 0.628072:  31%|███       | 31/100 [12:14<21:58, 19.10s/it]Best trial: 8. Best value: 0.628072:  32%|███▏      | 32/100 [12:14<19:36, 17.30s/it]Best trial: 8. Best value: 0.628072:  32%|███▏      | 32/100 [12:23<19:36, 17.30s/it]Best trial: 8. Best value: 0.628072:  33%|███▎      | 33/100 [12:23<16:32, 14.81s/it]Best trial: 8. Best value: 0.628072:  33%|███▎      | 33/100 [12:33<16:32, 14.81s/it]Best trial: 8. Best value: 0.628072:  34%|███▍      | 34/100 [12:33<14:42, 13.37s/it]Best trial: 8. Best value: 0.628072:  34%|███▍      | 34/100 [12:45<14:42, 13.37s/it]Best trial: 8. Best value: 0.628072:  35%|███▌      | 35/100 [12:45<13:52, 12.80s/it]Best trial: 8. Best value: 0.628072:  35%|███▌      | 35/100 [12:58<13:52, 12.80s/it]Best trial: 8. Best value: 0.628072:  36%|███▌      | 36/100 [12:58<13:50, 12.97s/it]Best trial: 8. Best value: 0.628072:  36%|███▌      | 36/100 [13:09<13:50, 12.97s/it]Best trial: 8. Best value: 0.628072:  37%|███▋      | 37/100 [13:09<12:58, 12.35s/it]Best trial: 8. Best value: 0.628072:  37%|███▋      | 37/100 [13:26<12:58, 12.35s/it]Best trial: 8. Best value: 0.628072:  38%|███▊      | 38/100 [13:26<14:07, 13.67s/it]Best trial: 8. Best value: 0.628072:  38%|███▊      | 38/100 [13:35<14:07, 13.67s/it]Best trial: 8. Best value: 0.628072:  39%|███▉      | 39/100 [13:35<12:30, 12.31s/it]Best trial: 8. Best value: 0.628072:  39%|███▉      | 39/100 [13:55<12:30, 12.31s/it]Best trial: 8. Best value: 0.628072:  40%|████      | 40/100 [13:55<14:44, 14.74s/it]Best trial: 8. Best value: 0.628072:  40%|████      | 40/100 [14:31<14:44, 14.74s/it]Best trial: 8. Best value: 0.628072:  41%|████      | 41/100 [14:31<20:33, 20.91s/it]Best trial: 8. Best value: 0.628072:  41%|████      | 41/100 [14:39<20:33, 20.91s/it]Best trial: 8. Best value: 0.628072:  42%|████▏     | 42/100 [14:39<16:32, 17.12s/it]Best trial: 8. Best value: 0.628072:  42%|████▏     | 42/100 [14:54<16:32, 17.12s/it]Best trial: 8. Best value: 0.628072:  43%|████▎     | 43/100 [14:54<15:47, 16.63s/it]Best trial: 8. Best value: 0.628072:  43%|████▎     | 43/100 [15:02<15:47, 16.63s/it]Best trial: 8. Best value: 0.628072:  44%|████▍     | 44/100 [15:02<12:55, 13.86s/it]Best trial: 8. Best value: 0.628072:  44%|████▍     | 44/100 [15:13<12:55, 13.86s/it]Best trial: 8. Best value: 0.628072:  45%|████▌     | 45/100 [15:13<11:53, 12.97s/it]Best trial: 8. Best value: 0.628072:  45%|████▌     | 45/100 [15:26<11:53, 12.97s/it]Best trial: 8. Best value: 0.628072:  46%|████▌     | 46/100 [15:26<11:45, 13.07s/it]Best trial: 46. Best value: 0.628404:  46%|████▌     | 46/100 [15:46<11:45, 13.07s/it]Best trial: 46. Best value: 0.628404:  47%|████▋     | 47/100 [15:46<13:21, 15.13s/it]Best trial: 46. Best value: 0.628404:  47%|████▋     | 47/100 [16:14<13:21, 15.13s/it]Best trial: 46. Best value: 0.628404:  48%|████▊     | 48/100 [16:14<16:30, 19.05s/it]Best trial: 48. Best value: 0.628502:  48%|████▊     | 48/100 [16:33<16:30, 19.05s/it]Best trial: 48. Best value: 0.628502:  49%|████▉     | 49/100 [16:33<16:08, 19.00s/it]Best trial: 48. Best value: 0.628502:  49%|████▉     | 49/100 [16:50<16:08, 19.00s/it]Best trial: 48. Best value: 0.628502:  50%|█████     | 50/100 [16:50<15:25, 18.51s/it]Best trial: 48. Best value: 0.628502:  50%|█████     | 50/100 [17:06<15:25, 18.51s/it]Best trial: 48. Best value: 0.628502:  51%|█████     | 51/100 [17:06<14:28, 17.72s/it]Best trial: 48. Best value: 0.628502:  51%|█████     | 51/100 [17:26<14:28, 17.72s/it]Best trial: 48. Best value: 0.628502:  52%|█████▏    | 52/100 [17:26<14:46, 18.46s/it]Best trial: 48. Best value: 0.628502:  52%|█████▏    | 52/100 [17:37<14:46, 18.46s/it]Best trial: 48. Best value: 0.628502:  53%|█████▎    | 53/100 [17:37<12:33, 16.02s/it]Best trial: 48. Best value: 0.628502:  53%|█████▎    | 53/100 [17:52<12:33, 16.02s/it]Best trial: 48. Best value: 0.628502:  54%|█████▍    | 54/100 [17:52<12:01, 15.68s/it]Best trial: 48. Best value: 0.628502:  54%|█████▍    | 54/100 [18:04<12:01, 15.68s/it]Best trial: 48. Best value: 0.628502:  55%|█████▌    | 55/100 [18:04<11:01, 14.70s/it]Best trial: 48. Best value: 0.628502:  55%|█████▌    | 55/100 [18:30<11:01, 14.70s/it]Best trial: 48. Best value: 0.628502:  56%|█████▌    | 56/100 [18:30<13:13, 18.03s/it]Best trial: 48. Best value: 0.628502:  56%|█████▌    | 56/100 [18:39<13:13, 18.03s/it]Best trial: 48. Best value: 0.628502:  57%|█████▋    | 57/100 [18:39<11:03, 15.44s/it]Best trial: 48. Best value: 0.628502:  57%|█████▋    | 57/100 [18:50<11:03, 15.44s/it]Best trial: 48. Best value: 0.628502:  58%|█████▊    | 58/100 [18:50<09:54, 14.14s/it]Best trial: 48. Best value: 0.628502:  58%|█████▊    | 58/100 [20:06<09:54, 14.14s/it]Best trial: 48. Best value: 0.628502:  59%|█████▉    | 59/100 [20:06<22:12, 32.50s/it]Best trial: 48. Best value: 0.628502:  59%|█████▉    | 59/100 [20:34<22:12, 32.50s/it]Best trial: 48. Best value: 0.628502:  60%|██████    | 60/100 [20:34<20:47, 31.19s/it]Best trial: 48. Best value: 0.628502:  60%|██████    | 60/100 [21:14<20:47, 31.19s/it]Best trial: 48. Best value: 0.628502:  61%|██████    | 61/100 [21:14<22:04, 33.97s/it]Best trial: 48. Best value: 0.628502:  61%|██████    | 61/100 [21:56<22:04, 33.97s/it]Best trial: 48. Best value: 0.628502:  62%|██████▏   | 62/100 [21:56<23:01, 36.36s/it]Best trial: 48. Best value: 0.628502:  62%|██████▏   | 62/100 [22:38<23:01, 36.36s/it]Best trial: 48. Best value: 0.628502:  63%|██████▎   | 63/100 [22:38<23:23, 37.94s/it]Best trial: 48. Best value: 0.628502:  63%|██████▎   | 63/100 [23:06<23:23, 37.94s/it]Best trial: 48. Best value: 0.628502:  64%|██████▍   | 64/100 [23:06<21:01, 35.04s/it]Best trial: 64. Best value: 0.630744:  64%|██████▍   | 64/100 [23:42<21:01, 35.04s/it]Best trial: 64. Best value: 0.630744:  65%|██████▌   | 65/100 [23:42<20:35, 35.31s/it]Best trial: 64. Best value: 0.630744:  65%|██████▌   | 65/100 [24:06<20:35, 35.31s/it]Best trial: 64. Best value: 0.630744:  66%|██████▌   | 66/100 [24:06<18:09, 32.04s/it]Best trial: 64. Best value: 0.630744:  66%|██████▌   | 66/100 [24:42<18:09, 32.04s/it]Best trial: 64. Best value: 0.630744:  67%|██████▋   | 67/100 [24:42<18:13, 33.15s/it]Best trial: 64. Best value: 0.630744:  67%|██████▋   | 67/100 [25:15<18:13, 33.15s/it]Best trial: 64. Best value: 0.630744:  68%|██████▊   | 68/100 [25:15<17:37, 33.06s/it]Best trial: 64. Best value: 0.630744:  68%|██████▊   | 68/100 [25:52<17:37, 33.06s/it]Best trial: 64. Best value: 0.630744:  69%|██████▉   | 69/100 [25:52<17:38, 34.15s/it]Best trial: 64. Best value: 0.630744:  69%|██████▉   | 69/100 [26:37<17:38, 34.15s/it]Best trial: 64. Best value: 0.630744:  70%|███████   | 70/100 [26:37<18:44, 37.49s/it]Best trial: 64. Best value: 0.630744:  70%|███████   | 70/100 [27:07<18:44, 37.49s/it]Best trial: 64. Best value: 0.630744:  71%|███████   | 71/100 [27:07<16:58, 35.13s/it]Best trial: 64. Best value: 0.630744:  71%|███████   | 71/100 [27:44<16:58, 35.13s/it]Best trial: 64. Best value: 0.630744:  72%|███████▏  | 72/100 [27:44<16:42, 35.79s/it]Best trial: 64. Best value: 0.630744:  72%|███████▏  | 72/100 [28:18<16:42, 35.79s/it]Best trial: 64. Best value: 0.630744:  73%|███████▎  | 73/100 [28:18<15:49, 35.18s/it]Best trial: 64. Best value: 0.630744:  73%|███████▎  | 73/100 [28:37<15:49, 35.18s/it]Best trial: 64. Best value: 0.630744:  74%|███████▍  | 74/100 [28:37<13:11, 30.45s/it]Best trial: 64. Best value: 0.630744:  74%|███████▍  | 74/100 [29:10<13:11, 30.45s/it]Best trial: 64. Best value: 0.630744:  75%|███████▌  | 75/100 [29:10<12:58, 31.13s/it]Best trial: 64. Best value: 0.630744:  75%|███████▌  | 75/100 [29:29<12:58, 31.13s/it]Best trial: 64. Best value: 0.630744:  76%|███████▌  | 76/100 [29:29<10:59, 27.46s/it]Best trial: 64. Best value: 0.630744:  76%|███████▌  | 76/100 [29:59<10:59, 27.46s/it]Best trial: 64. Best value: 0.630744:  77%|███████▋  | 77/100 [29:59<10:53, 28.40s/it]Best trial: 64. Best value: 0.630744:  77%|███████▋  | 77/100 [30:25<10:53, 28.40s/it]Best trial: 64. Best value: 0.630744:  78%|███████▊  | 78/100 [30:25<10:10, 27.73s/it]Best trial: 64. Best value: 0.630744:  78%|███████▊  | 78/100 [30:42<10:10, 27.73s/it]Best trial: 64. Best value: 0.630744:  79%|███████▉  | 79/100 [30:42<08:33, 24.43s/it]Best trial: 64. Best value: 0.630744:  79%|███████▉  | 79/100 [31:20<08:33, 24.43s/it]Best trial: 64. Best value: 0.630744:  80%|████████  | 80/100 [31:20<09:29, 28.47s/it]Best trial: 64. Best value: 0.630744:  80%|████████  | 80/100 [31:51<09:29, 28.47s/it]Best trial: 64. Best value: 0.630744:  81%|████████  | 81/100 [31:51<09:14, 29.19s/it]Best trial: 64. Best value: 0.630744:  81%|████████  | 81/100 [32:14<09:14, 29.19s/it]Best trial: 64. Best value: 0.630744:  82%|████████▏ | 82/100 [32:14<08:13, 27.41s/it]Best trial: 64. Best value: 0.630744:  82%|████████▏ | 82/100 [32:36<08:13, 27.41s/it]Best trial: 64. Best value: 0.630744:  83%|████████▎ | 83/100 [32:36<07:15, 25.64s/it]Best trial: 64. Best value: 0.630744:  83%|████████▎ | 83/100 [33:01<07:15, 25.64s/it]Best trial: 64. Best value: 0.630744:  84%|████████▍ | 84/100 [33:01<06:48, 25.55s/it]Best trial: 64. Best value: 0.630744:  84%|████████▍ | 84/100 [33:37<06:48, 25.55s/it]Best trial: 64. Best value: 0.630744:  85%|████████▌ | 85/100 [33:37<07:10, 28.67s/it]Best trial: 64. Best value: 0.630744:  85%|████████▌ | 85/100 [33:59<07:10, 28.67s/it]Best trial: 64. Best value: 0.630744:  86%|████████▌ | 86/100 [33:59<06:15, 26.81s/it]Best trial: 64. Best value: 0.630744:  86%|████████▌ | 86/100 [35:02<06:15, 26.81s/it]Best trial: 64. Best value: 0.630744:  87%|████████▋ | 87/100 [35:02<08:07, 37.51s/it]Best trial: 64. Best value: 0.630744:  87%|████████▋ | 87/100 [35:25<08:07, 37.51s/it]Best trial: 64. Best value: 0.630744:  88%|████████▊ | 88/100 [35:25<06:39, 33.29s/it]Best trial: 64. Best value: 0.630744:  88%|████████▊ | 88/100 [36:15<06:39, 33.29s/it]Best trial: 64. Best value: 0.630744:  89%|████████▉ | 89/100 [36:15<07:01, 38.34s/it]Best trial: 64. Best value: 0.630744:  89%|████████▉ | 89/100 [36:35<07:01, 38.34s/it]Best trial: 64. Best value: 0.630744:  90%|█████████ | 90/100 [36:35<05:25, 32.55s/it]Best trial: 64. Best value: 0.630744:  90%|█████████ | 90/100 [37:05<05:25, 32.55s/it]Best trial: 64. Best value: 0.630744:  91%|█████████ | 91/100 [37:05<04:46, 31.85s/it]Best trial: 64. Best value: 0.630744:  91%|█████████ | 91/100 [37:54<04:46, 31.85s/it]Best trial: 64. Best value: 0.630744:  92%|█████████▏| 92/100 [37:54<04:55, 36.99s/it]Best trial: 64. Best value: 0.630744:  92%|█████████▏| 92/100 [38:38<04:55, 36.99s/it]Best trial: 64. Best value: 0.630744:  93%|█████████▎| 93/100 [38:38<04:33, 39.04s/it]Best trial: 64. Best value: 0.630744:  93%|█████████▎| 93/100 [39:15<04:33, 39.04s/it]Best trial: 64. Best value: 0.630744:  94%|█████████▍| 94/100 [39:15<03:52, 38.67s/it]Best trial: 64. Best value: 0.630744:  94%|█████████▍| 94/100 [39:47<03:52, 38.67s/it]Best trial: 64. Best value: 0.630744:  95%|█████████▌| 95/100 [39:47<03:03, 36.63s/it]Best trial: 64. Best value: 0.630744:  95%|█████████▌| 95/100 [40:21<03:03, 36.63s/it]Best trial: 64. Best value: 0.630744:  96%|█████████▌| 96/100 [40:21<02:22, 35.67s/it]Best trial: 64. Best value: 0.630744:  96%|█████████▌| 96/100 [40:57<02:22, 35.67s/it]Best trial: 64. Best value: 0.630744:  97%|█████████▋| 97/100 [40:57<01:47, 35.75s/it]Best trial: 64. Best value: 0.630744:  97%|█████████▋| 97/100 [41:38<01:47, 35.75s/it]Best trial: 64. Best value: 0.630744:  98%|█████████▊| 98/100 [41:38<01:14, 37.34s/it]Best trial: 64. Best value: 0.630744:  98%|█████████▊| 98/100 [42:06<01:14, 37.34s/it]Best trial: 64. Best value: 0.630744:  99%|█████████▉| 99/100 [42:06<00:34, 34.69s/it]Best trial: 64. Best value: 0.630744:  99%|█████████▉| 99/100 [42:43<00:34, 34.69s/it]Best trial: 64. Best value: 0.630744: 100%|██████████| 100/100 [42:43<00:00, 35.37s/it]Best trial: 64. Best value: 0.630744: 100%|██████████| 100/100 [42:43<00:00, 25.64s/it]
2025-12-01 00:49:07,203 - INFO - HPO Complete. Best AUPRC: 0.6307
2025-12-01 00:49:07,203 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.03064510407177778, 'max_depth': 8, 'subsample': 0.8982694069969254, 'colsample_bytree': 0.6575333415370216, 'gamma': 0.9209855469033457, 'reg_lambda': 6.355040324180389e-07, 'reg_alpha': 0.007496933957174348}
2025-12-01 00:49:07,204 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/extended_los/windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:49:09,118 - INFO - Starting Training/Evaluation for Outcome: extended_los, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 00:49:09,118 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 00:49:09,317 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 00:49:09,382 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:49:09,395 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 00:49:09,395 - INFO - Positive samples in train: 705, Negative: 2056, Scale Pos Weight: 2.9163
2025-12-01 00:49:09,395 - INFO - Training model...
2025-12-01 00:49:18,709 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:49:25,279 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:49:25,279 - INFO - AUROC: 0.8109 (0.7700 - 0.8360)
2025-12-01 00:49:25,279 - INFO - AUPRC: 0.5704 (0.4955 - 0.6419)
2025-12-01 00:49:25,279 - INFO - Brier Score: 0.1384 (0.1270 - 0.1561)
2025-12-01 00:49:25,279 - INFO - Accuracy: 0.7948 (0.7113 - 0.8315)
2025-12-01 00:49:25,279 - INFO - Precision: 0.5455 (0.4277 - 0.6243)
2025-12-01 00:49:25,279 - INFO - Sensitivity (Recall): 0.6076 (0.5762 - 0.8101)
2025-12-01 00:49:25,279 - INFO - F1-Score: 0.5749 (0.5224 - 0.6368)
2025-12-01 00:49:25,280 - INFO - Best Threshold: 0.3100 (0.1560 - 0.3800)
2025-12-01 00:49:25,280 - INFO - Specificity: 0.8502 (0.6823 - 0.8922)
2025-12-01 00:49:25,302 - INFO - Calculating SHAP values...
2025-12-01 00:49:26,620 - INFO - SHAP plots saved.
2025-12-01 00:49:26,621 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/extended_los/windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:49:27,782 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_only
2025-12-01 00:49:27,782 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:49:27,867 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:49:27,886 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:49:27,890 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-12-01 00:49:27,890 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.666825:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.666825:   1%|          | 1/100 [00:02<03:48,  2.31s/it]Best trial: 1. Best value: 0.690701:   1%|          | 1/100 [00:05<03:48,  2.31s/it]Best trial: 1. Best value: 0.690701:   2%|▏         | 2/100 [00:05<04:35,  2.81s/it]Best trial: 1. Best value: 0.690701:   2%|▏         | 2/100 [00:06<04:35,  2.81s/it]Best trial: 1. Best value: 0.690701:   3%|▎         | 3/100 [00:06<03:34,  2.21s/it]Best trial: 1. Best value: 0.690701:   3%|▎         | 3/100 [00:08<03:34,  2.21s/it]Best trial: 1. Best value: 0.690701:   4%|▍         | 4/100 [00:08<03:16,  2.05s/it]Best trial: 1. Best value: 0.690701:   4%|▍         | 4/100 [00:11<03:16,  2.05s/it]Best trial: 1. Best value: 0.690701:   5%|▌         | 5/100 [00:11<03:45,  2.37s/it]Best trial: 1. Best value: 0.690701:   5%|▌         | 5/100 [00:13<03:45,  2.37s/it]Best trial: 1. Best value: 0.690701:   6%|▌         | 6/100 [00:13<03:39,  2.33s/it]Best trial: 1. Best value: 0.690701:   6%|▌         | 6/100 [00:16<03:39,  2.33s/it]Best trial: 1. Best value: 0.690701:   7%|▋         | 7/100 [00:16<03:50,  2.48s/it]Best trial: 1. Best value: 0.690701:   7%|▋         | 7/100 [00:19<03:50,  2.48s/it]Best trial: 1. Best value: 0.690701:   8%|▊         | 8/100 [00:19<03:48,  2.48s/it]Best trial: 1. Best value: 0.690701:   8%|▊         | 8/100 [00:20<03:48,  2.48s/it]Best trial: 1. Best value: 0.690701:   9%|▉         | 9/100 [00:20<03:05,  2.04s/it]Best trial: 1. Best value: 0.690701:   9%|▉         | 9/100 [00:23<03:05,  2.04s/it]Best trial: 1. Best value: 0.690701:  10%|█         | 10/100 [00:23<03:44,  2.49s/it]Best trial: 1. Best value: 0.690701:  10%|█         | 10/100 [00:26<03:44,  2.49s/it]Best trial: 1. Best value: 0.690701:  11%|█         | 11/100 [00:26<03:35,  2.42s/it]Best trial: 11. Best value: 0.694001:  11%|█         | 11/100 [00:27<03:35,  2.42s/it]Best trial: 11. Best value: 0.694001:  12%|█▏        | 12/100 [00:27<03:08,  2.15s/it]Best trial: 11. Best value: 0.694001:  12%|█▏        | 12/100 [00:29<03:08,  2.15s/it]Best trial: 11. Best value: 0.694001:  13%|█▎        | 13/100 [00:29<02:51,  1.97s/it]Best trial: 11. Best value: 0.694001:  13%|█▎        | 13/100 [00:30<02:51,  1.97s/it]Best trial: 11. Best value: 0.694001:  14%|█▍        | 14/100 [00:30<02:37,  1.83s/it]Best trial: 11. Best value: 0.694001:  14%|█▍        | 14/100 [00:31<02:37,  1.83s/it]Best trial: 11. Best value: 0.694001:  15%|█▌        | 15/100 [00:31<02:22,  1.67s/it]Best trial: 15. Best value: 0.695345:  15%|█▌        | 15/100 [00:33<02:22,  1.67s/it]Best trial: 15. Best value: 0.695345:  16%|█▌        | 16/100 [00:33<02:23,  1.71s/it]Best trial: 15. Best value: 0.695345:  16%|█▌        | 16/100 [00:35<02:23,  1.71s/it]Best trial: 15. Best value: 0.695345:  17%|█▋        | 17/100 [00:35<02:32,  1.83s/it]Best trial: 15. Best value: 0.695345:  17%|█▋        | 17/100 [00:38<02:32,  1.83s/it]Best trial: 15. Best value: 0.695345:  18%|█▊        | 18/100 [00:38<02:58,  2.17s/it]Best trial: 15. Best value: 0.695345:  18%|█▊        | 18/100 [00:40<02:58,  2.17s/it]Best trial: 15. Best value: 0.695345:  19%|█▉        | 19/100 [00:40<02:34,  1.91s/it]Best trial: 15. Best value: 0.695345:  19%|█▉        | 19/100 [00:44<02:34,  1.91s/it]Best trial: 15. Best value: 0.695345:  20%|██        | 20/100 [00:44<03:38,  2.73s/it]Best trial: 15. Best value: 0.695345:  20%|██        | 20/100 [00:46<03:38,  2.73s/it]Best trial: 15. Best value: 0.695345:  21%|██        | 21/100 [00:46<03:02,  2.30s/it]Best trial: 15. Best value: 0.695345:  21%|██        | 21/100 [00:48<03:02,  2.30s/it]Best trial: 15. Best value: 0.695345:  22%|██▏       | 22/100 [00:48<02:50,  2.19s/it]Best trial: 15. Best value: 0.695345:  22%|██▏       | 22/100 [00:49<02:50,  2.19s/it]Best trial: 15. Best value: 0.695345:  23%|██▎       | 23/100 [00:49<02:40,  2.08s/it]Best trial: 23. Best value: 0.695782:  23%|██▎       | 23/100 [00:51<02:40,  2.08s/it]Best trial: 23. Best value: 0.695782:  24%|██▍       | 24/100 [00:51<02:36,  2.06s/it]Best trial: 24. Best value: 0.698987:  24%|██▍       | 24/100 [00:54<02:36,  2.06s/it]Best trial: 24. Best value: 0.698987:  25%|██▌       | 25/100 [00:54<02:43,  2.18s/it]Best trial: 25. Best value: 0.700141:  25%|██▌       | 25/100 [00:56<02:43,  2.18s/it]Best trial: 25. Best value: 0.700141:  26%|██▌       | 26/100 [00:56<02:48,  2.27s/it]Best trial: 25. Best value: 0.700141:  26%|██▌       | 26/100 [00:58<02:48,  2.27s/it]Best trial: 25. Best value: 0.700141:  27%|██▋       | 27/100 [00:58<02:40,  2.20s/it]Best trial: 25. Best value: 0.700141:  27%|██▋       | 27/100 [01:01<02:40,  2.20s/it]Best trial: 25. Best value: 0.700141:  28%|██▊       | 28/100 [01:01<02:45,  2.30s/it]Best trial: 25. Best value: 0.700141:  28%|██▊       | 28/100 [01:03<02:45,  2.30s/it]Best trial: 25. Best value: 0.700141:  29%|██▉       | 29/100 [01:03<02:38,  2.23s/it]Best trial: 25. Best value: 0.700141:  29%|██▉       | 29/100 [01:04<02:38,  2.23s/it]Best trial: 25. Best value: 0.700141:  30%|███       | 30/100 [01:04<02:13,  1.90s/it]Best trial: 25. Best value: 0.700141:  30%|███       | 30/100 [01:06<02:13,  1.90s/it]Best trial: 25. Best value: 0.700141:  31%|███       | 31/100 [01:06<02:14,  1.95s/it]Best trial: 25. Best value: 0.700141:  31%|███       | 31/100 [01:10<02:14,  1.95s/it]Best trial: 25. Best value: 0.700141:  32%|███▏      | 32/100 [01:10<02:48,  2.48s/it]Best trial: 25. Best value: 0.700141:  32%|███▏      | 32/100 [01:12<02:48,  2.48s/it]Best trial: 25. Best value: 0.700141:  33%|███▎      | 33/100 [01:12<02:48,  2.52s/it]Best trial: 25. Best value: 0.700141:  33%|███▎      | 33/100 [01:15<02:48,  2.52s/it]Best trial: 25. Best value: 0.700141:  34%|███▍      | 34/100 [01:15<02:51,  2.60s/it]Best trial: 25. Best value: 0.700141:  34%|███▍      | 34/100 [01:18<02:51,  2.60s/it]Best trial: 25. Best value: 0.700141:  35%|███▌      | 35/100 [01:18<02:52,  2.65s/it]Best trial: 25. Best value: 0.700141:  35%|███▌      | 35/100 [01:20<02:52,  2.65s/it]Best trial: 25. Best value: 0.700141:  36%|███▌      | 36/100 [01:20<02:45,  2.59s/it]Best trial: 25. Best value: 0.700141:  36%|███▌      | 36/100 [01:22<02:45,  2.59s/it]Best trial: 25. Best value: 0.700141:  37%|███▋      | 37/100 [01:22<02:25,  2.31s/it]Best trial: 25. Best value: 0.700141:  37%|███▋      | 37/100 [01:24<02:25,  2.31s/it]Best trial: 25. Best value: 0.700141:  38%|███▊      | 38/100 [01:24<02:15,  2.19s/it]Best trial: 25. Best value: 0.700141:  38%|███▊      | 38/100 [01:25<02:15,  2.19s/it]Best trial: 25. Best value: 0.700141:  39%|███▉      | 39/100 [01:25<01:52,  1.85s/it]Best trial: 25. Best value: 0.700141:  39%|███▉      | 39/100 [01:27<01:52,  1.85s/it]Best trial: 25. Best value: 0.700141:  40%|████      | 40/100 [01:27<01:55,  1.92s/it]Best trial: 25. Best value: 0.700141:  40%|████      | 40/100 [01:30<01:55,  1.92s/it]Best trial: 25. Best value: 0.700141:  41%|████      | 41/100 [01:30<02:03,  2.10s/it]Best trial: 25. Best value: 0.700141:  41%|████      | 41/100 [01:33<02:03,  2.10s/it]Best trial: 25. Best value: 0.700141:  42%|████▏     | 42/100 [01:33<02:21,  2.43s/it]Best trial: 25. Best value: 0.700141:  42%|████▏     | 42/100 [01:36<02:21,  2.43s/it]Best trial: 25. Best value: 0.700141:  43%|████▎     | 43/100 [01:36<02:22,  2.50s/it]Best trial: 25. Best value: 0.700141:  43%|████▎     | 43/100 [01:38<02:22,  2.50s/it]Best trial: 25. Best value: 0.700141:  44%|████▍     | 44/100 [01:38<02:20,  2.51s/it]Best trial: 25. Best value: 0.700141:  44%|████▍     | 44/100 [01:41<02:20,  2.51s/it]Best trial: 25. Best value: 0.700141:  45%|████▌     | 45/100 [01:41<02:21,  2.57s/it]Best trial: 45. Best value: 0.702878:  45%|████▌     | 45/100 [01:43<02:21,  2.57s/it]Best trial: 45. Best value: 0.702878:  46%|████▌     | 46/100 [01:43<02:07,  2.36s/it]Best trial: 45. Best value: 0.702878:  46%|████▌     | 46/100 [01:45<02:07,  2.36s/it]Best trial: 45. Best value: 0.702878:  47%|████▋     | 47/100 [01:45<02:09,  2.45s/it]Best trial: 45. Best value: 0.702878:  47%|████▋     | 47/100 [01:47<02:09,  2.45s/it]Best trial: 45. Best value: 0.702878:  48%|████▊     | 48/100 [01:47<01:49,  2.11s/it]Best trial: 45. Best value: 0.702878:  48%|████▊     | 48/100 [01:48<01:49,  2.11s/it]Best trial: 45. Best value: 0.702878:  49%|████▉     | 49/100 [01:48<01:37,  1.92s/it]Best trial: 45. Best value: 0.702878:  49%|████▉     | 49/100 [01:50<01:37,  1.92s/it]Best trial: 45. Best value: 0.702878:  50%|█████     | 50/100 [01:50<01:31,  1.83s/it]Best trial: 45. Best value: 0.702878:  50%|█████     | 50/100 [01:51<01:31,  1.83s/it]Best trial: 45. Best value: 0.702878:  51%|█████     | 51/100 [01:51<01:25,  1.75s/it]Best trial: 45. Best value: 0.702878:  51%|█████     | 51/100 [01:53<01:25,  1.75s/it]Best trial: 45. Best value: 0.702878:  52%|█████▏    | 52/100 [01:53<01:20,  1.68s/it]Best trial: 45. Best value: 0.702878:  52%|█████▏    | 52/100 [01:54<01:20,  1.68s/it]Best trial: 45. Best value: 0.702878:  53%|█████▎    | 53/100 [01:54<01:15,  1.60s/it]Best trial: 45. Best value: 0.702878:  53%|█████▎    | 53/100 [01:56<01:15,  1.60s/it]Best trial: 45. Best value: 0.702878:  54%|█████▍    | 54/100 [01:56<01:12,  1.59s/it]Best trial: 45. Best value: 0.702878:  54%|█████▍    | 54/100 [01:57<01:12,  1.59s/it]Best trial: 45. Best value: 0.702878:  55%|█████▌    | 55/100 [01:57<01:10,  1.56s/it]Best trial: 45. Best value: 0.702878:  55%|█████▌    | 55/100 [01:59<01:10,  1.56s/it]Best trial: 45. Best value: 0.702878:  56%|█████▌    | 56/100 [01:59<01:07,  1.53s/it]Best trial: 45. Best value: 0.702878:  56%|█████▌    | 56/100 [02:01<01:07,  1.53s/it]Best trial: 45. Best value: 0.702878:  57%|█████▋    | 57/100 [02:01<01:12,  1.69s/it]Best trial: 45. Best value: 0.702878:  57%|█████▋    | 57/100 [02:02<01:12,  1.69s/it]Best trial: 45. Best value: 0.702878:  58%|█████▊    | 58/100 [02:02<01:10,  1.67s/it]Best trial: 45. Best value: 0.702878:  58%|█████▊    | 58/100 [02:04<01:10,  1.67s/it]Best trial: 45. Best value: 0.702878:  59%|█████▉    | 59/100 [02:04<01:03,  1.55s/it]Best trial: 45. Best value: 0.702878:  59%|█████▉    | 59/100 [02:06<01:03,  1.55s/it]Best trial: 45. Best value: 0.702878:  60%|██████    | 60/100 [02:06<01:05,  1.64s/it]Best trial: 45. Best value: 0.702878:  60%|██████    | 60/100 [02:08<01:05,  1.64s/it]Best trial: 45. Best value: 0.702878:  61%|██████    | 61/100 [02:08<01:08,  1.76s/it]Best trial: 45. Best value: 0.702878:  61%|██████    | 61/100 [02:09<01:08,  1.76s/it]Best trial: 45. Best value: 0.702878:  62%|██████▏   | 62/100 [02:09<01:02,  1.65s/it]Best trial: 45. Best value: 0.702878:  62%|██████▏   | 62/100 [02:10<01:02,  1.65s/it]Best trial: 45. Best value: 0.702878:  63%|██████▎   | 63/100 [02:10<00:57,  1.56s/it]Best trial: 45. Best value: 0.702878:  63%|██████▎   | 63/100 [02:12<00:57,  1.56s/it]Best trial: 45. Best value: 0.702878:  64%|██████▍   | 64/100 [02:12<01:01,  1.72s/it]Best trial: 45. Best value: 0.702878:  64%|██████▍   | 64/100 [02:15<01:01,  1.72s/it]Best trial: 45. Best value: 0.702878:  65%|██████▌   | 65/100 [02:15<01:05,  1.86s/it]Best trial: 45. Best value: 0.702878:  65%|██████▌   | 65/100 [02:17<01:05,  1.86s/it]Best trial: 45. Best value: 0.702878:  66%|██████▌   | 66/100 [02:17<01:07,  1.97s/it]Best trial: 45. Best value: 0.702878:  66%|██████▌   | 66/100 [02:19<01:07,  1.97s/it]Best trial: 45. Best value: 0.702878:  67%|██████▋   | 67/100 [02:19<01:07,  2.04s/it]Best trial: 45. Best value: 0.702878:  67%|██████▋   | 67/100 [02:20<01:07,  2.04s/it]Best trial: 45. Best value: 0.702878:  68%|██████▊   | 68/100 [02:20<00:59,  1.85s/it]Best trial: 45. Best value: 0.702878:  68%|██████▊   | 68/100 [02:23<00:59,  1.85s/it]Best trial: 45. Best value: 0.702878:  69%|██████▉   | 69/100 [02:23<00:59,  1.93s/it]Best trial: 45. Best value: 0.702878:  69%|██████▉   | 69/100 [02:26<00:59,  1.93s/it]Best trial: 45. Best value: 0.702878:  70%|███████   | 70/100 [02:26<01:13,  2.46s/it]Best trial: 45. Best value: 0.702878:  70%|███████   | 70/100 [02:28<01:13,  2.46s/it]Best trial: 45. Best value: 0.702878:  71%|███████   | 71/100 [02:28<01:01,  2.14s/it]Best trial: 71. Best value: 0.703141:  71%|███████   | 71/100 [02:29<01:01,  2.14s/it]Best trial: 71. Best value: 0.703141:  72%|███████▏  | 72/100 [02:29<00:54,  1.96s/it]Best trial: 71. Best value: 0.703141:  72%|███████▏  | 72/100 [02:31<00:54,  1.96s/it]Best trial: 71. Best value: 0.703141:  73%|███████▎  | 73/100 [02:31<00:52,  1.96s/it]Best trial: 71. Best value: 0.703141:  73%|███████▎  | 73/100 [02:33<00:52,  1.96s/it]Best trial: 71. Best value: 0.703141:  74%|███████▍  | 74/100 [02:33<00:50,  1.94s/it]Best trial: 71. Best value: 0.703141:  74%|███████▍  | 74/100 [02:35<00:50,  1.94s/it]Best trial: 71. Best value: 0.703141:  75%|███████▌  | 75/100 [02:35<00:46,  1.86s/it]Best trial: 71. Best value: 0.703141:  75%|███████▌  | 75/100 [02:36<00:46,  1.86s/it]Best trial: 71. Best value: 0.703141:  76%|███████▌  | 76/100 [02:36<00:42,  1.76s/it]Best trial: 71. Best value: 0.703141:  76%|███████▌  | 76/100 [02:39<00:42,  1.76s/it]Best trial: 71. Best value: 0.703141:  77%|███████▋  | 77/100 [02:39<00:45,  1.97s/it]Best trial: 71. Best value: 0.703141:  77%|███████▋  | 77/100 [02:41<00:45,  1.97s/it]Best trial: 71. Best value: 0.703141:  78%|███████▊  | 78/100 [02:41<00:42,  1.94s/it]Best trial: 71. Best value: 0.703141:  78%|███████▊  | 78/100 [02:42<00:42,  1.94s/it]Best trial: 71. Best value: 0.703141:  79%|███████▉  | 79/100 [02:42<00:40,  1.92s/it]Best trial: 71. Best value: 0.703141:  79%|███████▉  | 79/100 [02:44<00:40,  1.92s/it]Best trial: 71. Best value: 0.703141:  80%|████████  | 80/100 [02:44<00:38,  1.94s/it]Best trial: 71. Best value: 0.703141:  80%|████████  | 80/100 [02:46<00:38,  1.94s/it]Best trial: 71. Best value: 0.703141:  81%|████████  | 81/100 [02:46<00:35,  1.89s/it]Best trial: 71. Best value: 0.703141:  81%|████████  | 81/100 [02:48<00:35,  1.89s/it]Best trial: 71. Best value: 0.703141:  82%|████████▏ | 82/100 [02:48<00:35,  1.98s/it]Best trial: 71. Best value: 0.703141:  82%|████████▏ | 82/100 [02:51<00:35,  1.98s/it]Best trial: 71. Best value: 0.703141:  83%|████████▎ | 83/100 [02:51<00:34,  2.03s/it]Best trial: 71. Best value: 0.703141:  83%|████████▎ | 83/100 [02:53<00:34,  2.03s/it]Best trial: 71. Best value: 0.703141:  84%|████████▍ | 84/100 [02:53<00:34,  2.14s/it]Best trial: 71. Best value: 0.703141:  84%|████████▍ | 84/100 [02:54<00:34,  2.14s/it]Best trial: 71. Best value: 0.703141:  85%|████████▌ | 85/100 [02:54<00:29,  1.93s/it]Best trial: 71. Best value: 0.703141:  85%|████████▌ | 85/100 [02:56<00:29,  1.93s/it]Best trial: 71. Best value: 0.703141:  86%|████████▌ | 86/100 [02:56<00:27,  1.98s/it]Best trial: 71. Best value: 0.703141:  86%|████████▌ | 86/100 [02:59<00:27,  1.98s/it]Best trial: 71. Best value: 0.703141:  87%|████████▋ | 87/100 [02:59<00:27,  2.10s/it]Best trial: 71. Best value: 0.703141:  87%|████████▋ | 87/100 [03:00<00:27,  2.10s/it]Best trial: 71. Best value: 0.703141:  88%|████████▊ | 88/100 [03:00<00:21,  1.80s/it]Best trial: 71. Best value: 0.703141:  88%|████████▊ | 88/100 [03:02<00:21,  1.80s/it]Best trial: 71. Best value: 0.703141:  89%|████████▉ | 89/100 [03:02<00:21,  1.99s/it]Best trial: 71. Best value: 0.703141:  89%|████████▉ | 89/100 [03:04<00:21,  1.99s/it]Best trial: 71. Best value: 0.703141:  90%|█████████ | 90/100 [03:04<00:17,  1.78s/it]Best trial: 71. Best value: 0.703141:  90%|█████████ | 90/100 [03:06<00:17,  1.78s/it]Best trial: 71. Best value: 0.703141:  91%|█████████ | 91/100 [03:06<00:17,  1.99s/it]Best trial: 71. Best value: 0.703141:  91%|█████████ | 91/100 [03:09<00:17,  1.99s/it]Best trial: 71. Best value: 0.703141:  92%|█████████▏| 92/100 [03:09<00:16,  2.10s/it]Best trial: 92. Best value: 0.705022:  92%|█████████▏| 92/100 [03:10<00:16,  2.10s/it]Best trial: 92. Best value: 0.705022:  93%|█████████▎| 93/100 [03:10<00:14,  2.03s/it]Best trial: 92. Best value: 0.705022:  93%|█████████▎| 93/100 [03:12<00:14,  2.03s/it]Best trial: 92. Best value: 0.705022:  94%|█████████▍| 94/100 [03:12<00:11,  1.97s/it]Best trial: 92. Best value: 0.705022:  94%|█████████▍| 94/100 [03:14<00:11,  1.97s/it]Best trial: 92. Best value: 0.705022:  95%|█████████▌| 95/100 [03:14<00:10,  2.03s/it]Best trial: 92. Best value: 0.705022:  95%|█████████▌| 95/100 [03:17<00:10,  2.03s/it]Best trial: 92. Best value: 0.705022:  96%|█████████▌| 96/100 [03:17<00:08,  2.07s/it]Best trial: 92. Best value: 0.705022:  96%|█████████▌| 96/100 [03:18<00:08,  2.07s/it]Best trial: 92. Best value: 0.705022:  97%|█████████▋| 97/100 [03:18<00:05,  1.97s/it]Best trial: 92. Best value: 0.705022:  97%|█████████▋| 97/100 [03:21<00:05,  1.97s/it]Best trial: 92. Best value: 0.705022:  98%|█████████▊| 98/100 [03:21<00:04,  2.11s/it]Best trial: 92. Best value: 0.705022:  98%|█████████▊| 98/100 [03:23<00:04,  2.11s/it]Best trial: 92. Best value: 0.705022:  99%|█████████▉| 99/100 [03:23<00:02,  2.04s/it]Best trial: 92. Best value: 0.705022:  99%|█████████▉| 99/100 [03:25<00:02,  2.04s/it]Best trial: 92. Best value: 0.705022: 100%|██████████| 100/100 [03:25<00:00,  2.04s/it]Best trial: 92. Best value: 0.705022: 100%|██████████| 100/100 [03:25<00:00,  2.05s/it]
2025-12-01 00:52:53,050 - INFO - HPO Complete. Best AUPRC: 0.7050
2025-12-01 00:52:53,051 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.04489891787282468, 'max_depth': 3, 'subsample': 0.9800275745130109, 'colsample_bytree': 0.6222637613855772, 'gamma': 1.3136852881210275, 'reg_lambda': 6.970643081807331e-07, 'reg_alpha': 0.000101187972438776}
2025-12-01 00:52:53,051 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:52:55,034 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_only
2025-12-01 00:52:55,034 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:52:55,117 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:52:55,135 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:52:55,139 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-12-01 00:52:55,139 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 00:52:55,139 - INFO - Training model...
2025-12-01 00:52:55,580 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:53:00,679 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:53:00,679 - INFO - AUROC: 0.8784 (0.8522 - 0.8971)
2025-12-01 00:53:00,679 - INFO - AUPRC: 0.7094 (0.6547 - 0.7669)
2025-12-01 00:53:00,679 - INFO - Brier Score: 0.1265 (0.1163 - 0.1391)
2025-12-01 00:53:00,679 - INFO - Accuracy: 0.8613 (0.7621 - 0.8893)
2025-12-01 00:53:00,679 - INFO - Precision: 0.6975 (0.4710 - 0.8433)
2025-12-01 00:53:00,679 - INFO - Sensitivity (Recall): 0.5804 (0.5055 - 0.8593)
2025-12-01 00:53:00,679 - INFO - F1-Score: 0.6336 (0.5998 - 0.6977)
2025-12-01 00:53:00,679 - INFO - Best Threshold: 0.6400 (0.3700 - 0.7500)
2025-12-01 00:53:00,679 - INFO - Specificity: 0.9344 (0.7358 - 0.9749)
2025-12-01 00:53:00,685 - INFO - Calculating SHAP values...
2025-12-01 00:53:01,650 - INFO - SHAP plots saved.
2025-12-01 00:53:01,651 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:53:02,851 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: pleth_only
2025-12-01 00:53:02,851 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:53:02,938 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:53:02,946 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:53:02,949 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:53:02,949 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.371353:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.371353:   1%|          | 1/100 [00:02<04:56,  3.00s/it]Best trial: 1. Best value: 0.390996:   1%|          | 1/100 [00:04<04:56,  3.00s/it]Best trial: 1. Best value: 0.390996:   2%|▏         | 2/100 [00:04<03:20,  2.04s/it]Best trial: 2. Best value: 0.392198:   2%|▏         | 2/100 [00:05<03:20,  2.04s/it]Best trial: 2. Best value: 0.392198:   3%|▎         | 3/100 [00:05<02:31,  1.56s/it]Best trial: 2. Best value: 0.392198:   3%|▎         | 3/100 [00:06<02:31,  1.56s/it]Best trial: 2. Best value: 0.392198:   4%|▍         | 4/100 [00:06<02:31,  1.58s/it]Best trial: 2. Best value: 0.392198:   4%|▍         | 4/100 [00:07<02:31,  1.58s/it]Best trial: 2. Best value: 0.392198:   5%|▌         | 5/100 [00:07<02:04,  1.31s/it]Best trial: 2. Best value: 0.392198:   5%|▌         | 5/100 [00:08<02:04,  1.31s/it]Best trial: 2. Best value: 0.392198:   6%|▌         | 6/100 [00:08<01:41,  1.08s/it]Best trial: 2. Best value: 0.392198:   6%|▌         | 6/100 [00:10<01:41,  1.08s/it]Best trial: 2. Best value: 0.392198:   7%|▋         | 7/100 [00:10<02:11,  1.41s/it]Best trial: 2. Best value: 0.392198:   7%|▋         | 7/100 [00:11<02:11,  1.41s/it]Best trial: 2. Best value: 0.392198:   8%|▊         | 8/100 [00:11<01:58,  1.29s/it]Best trial: 2. Best value: 0.392198:   8%|▊         | 8/100 [00:12<01:58,  1.29s/it]Best trial: 2. Best value: 0.392198:   9%|▉         | 9/100 [00:12<01:47,  1.18s/it]Best trial: 2. Best value: 0.392198:   9%|▉         | 9/100 [00:16<01:47,  1.18s/it]Best trial: 2. Best value: 0.392198:  10%|█         | 10/100 [00:16<02:59,  1.99s/it]Best trial: 2. Best value: 0.392198:  10%|█         | 10/100 [00:17<02:59,  1.99s/it]Best trial: 2. Best value: 0.392198:  11%|█         | 11/100 [00:17<02:33,  1.73s/it]Best trial: 2. Best value: 0.392198:  11%|█         | 11/100 [00:18<02:33,  1.73s/it]Best trial: 2. Best value: 0.392198:  12%|█▏        | 12/100 [00:18<02:15,  1.54s/it]Best trial: 2. Best value: 0.392198:  12%|█▏        | 12/100 [00:19<02:15,  1.54s/it]Best trial: 2. Best value: 0.392198:  13%|█▎        | 13/100 [00:19<02:00,  1.38s/it]Best trial: 13. Best value: 0.394108:  13%|█▎        | 13/100 [00:20<02:00,  1.38s/it]Best trial: 13. Best value: 0.394108:  14%|█▍        | 14/100 [00:20<01:41,  1.18s/it]Best trial: 13. Best value: 0.394108:  14%|█▍        | 14/100 [00:21<01:41,  1.18s/it]Best trial: 13. Best value: 0.394108:  15%|█▌        | 15/100 [00:21<01:34,  1.11s/it]Best trial: 13. Best value: 0.394108:  15%|█▌        | 15/100 [00:22<01:34,  1.11s/it]Best trial: 13. Best value: 0.394108:  16%|█▌        | 16/100 [00:22<01:40,  1.19s/it]Best trial: 13. Best value: 0.394108:  16%|█▌        | 16/100 [00:23<01:40,  1.19s/it]Best trial: 13. Best value: 0.394108:  17%|█▋        | 17/100 [00:23<01:39,  1.20s/it]Best trial: 13. Best value: 0.394108:  17%|█▋        | 17/100 [00:25<01:39,  1.20s/it]Best trial: 13. Best value: 0.394108:  18%|█▊        | 18/100 [00:25<01:38,  1.21s/it]Best trial: 13. Best value: 0.394108:  18%|█▊        | 18/100 [00:25<01:38,  1.21s/it]Best trial: 13. Best value: 0.394108:  19%|█▉        | 19/100 [00:25<01:24,  1.04s/it]Best trial: 13. Best value: 0.394108:  19%|█▉        | 19/100 [00:26<01:24,  1.04s/it]Best trial: 13. Best value: 0.394108:  20%|██        | 20/100 [00:26<01:29,  1.11s/it]Best trial: 13. Best value: 0.394108:  20%|██        | 20/100 [00:27<01:29,  1.11s/it]Best trial: 13. Best value: 0.394108:  21%|██        | 21/100 [00:27<01:24,  1.07s/it]Best trial: 13. Best value: 0.394108:  21%|██        | 21/100 [00:28<01:24,  1.07s/it]Best trial: 13. Best value: 0.394108:  22%|██▏       | 22/100 [00:28<01:19,  1.02s/it]Best trial: 13. Best value: 0.394108:  22%|██▏       | 22/100 [00:30<01:19,  1.02s/it]Best trial: 13. Best value: 0.394108:  23%|██▎       | 23/100 [00:30<01:27,  1.14s/it]Best trial: 13. Best value: 0.394108:  23%|██▎       | 23/100 [00:31<01:27,  1.14s/it]Best trial: 13. Best value: 0.394108:  24%|██▍       | 24/100 [00:31<01:25,  1.12s/it]Best trial: 13. Best value: 0.394108:  24%|██▍       | 24/100 [00:32<01:25,  1.12s/it]Best trial: 13. Best value: 0.394108:  25%|██▌       | 25/100 [00:32<01:21,  1.09s/it]Best trial: 13. Best value: 0.394108:  25%|██▌       | 25/100 [00:33<01:21,  1.09s/it]Best trial: 13. Best value: 0.394108:  26%|██▌       | 26/100 [00:33<01:15,  1.02s/it]Best trial: 13. Best value: 0.394108:  26%|██▌       | 26/100 [00:34<01:15,  1.02s/it]Best trial: 13. Best value: 0.394108:  27%|██▋       | 27/100 [00:34<01:25,  1.17s/it]Best trial: 13. Best value: 0.394108:  27%|██▋       | 27/100 [00:35<01:25,  1.17s/it]Best trial: 13. Best value: 0.394108:  28%|██▊       | 28/100 [00:35<01:22,  1.15s/it]Best trial: 13. Best value: 0.394108:  28%|██▊       | 28/100 [00:36<01:22,  1.15s/it]Best trial: 13. Best value: 0.394108:  29%|██▉       | 29/100 [00:36<01:17,  1.09s/it]Best trial: 29. Best value: 0.397298:  29%|██▉       | 29/100 [00:37<01:17,  1.09s/it]Best trial: 29. Best value: 0.397298:  30%|███       | 30/100 [00:37<01:15,  1.08s/it]Best trial: 29. Best value: 0.397298:  30%|███       | 30/100 [00:38<01:15,  1.08s/it]Best trial: 29. Best value: 0.397298:  31%|███       | 31/100 [00:38<01:08,  1.01it/s]Best trial: 29. Best value: 0.397298:  31%|███       | 31/100 [00:39<01:08,  1.01it/s]Best trial: 29. Best value: 0.397298:  32%|███▏      | 32/100 [00:39<01:02,  1.08it/s]Best trial: 29. Best value: 0.397298:  32%|███▏      | 32/100 [00:40<01:02,  1.08it/s]Best trial: 29. Best value: 0.397298:  33%|███▎      | 33/100 [00:40<01:04,  1.03it/s]Best trial: 29. Best value: 0.397298:  33%|███▎      | 33/100 [00:41<01:04,  1.03it/s]Best trial: 29. Best value: 0.397298:  34%|███▍      | 34/100 [00:41<01:02,  1.05it/s]Best trial: 29. Best value: 0.397298:  34%|███▍      | 34/100 [00:42<01:02,  1.05it/s]Best trial: 29. Best value: 0.397298:  35%|███▌      | 35/100 [00:42<00:56,  1.16it/s]Best trial: 29. Best value: 0.397298:  35%|███▌      | 35/100 [00:42<00:56,  1.16it/s]Best trial: 29. Best value: 0.397298:  36%|███▌      | 36/100 [00:42<00:52,  1.22it/s]Best trial: 29. Best value: 0.397298:  36%|███▌      | 36/100 [00:43<00:52,  1.22it/s]Best trial: 29. Best value: 0.397298:  37%|███▋      | 37/100 [00:43<00:56,  1.11it/s]Best trial: 29. Best value: 0.397298:  37%|███▋      | 37/100 [00:44<00:56,  1.11it/s]Best trial: 29. Best value: 0.397298:  38%|███▊      | 38/100 [00:44<00:58,  1.07it/s]Best trial: 29. Best value: 0.397298:  38%|███▊      | 38/100 [00:45<00:58,  1.07it/s]Best trial: 29. Best value: 0.397298:  39%|███▉      | 39/100 [00:45<00:57,  1.06it/s]Best trial: 29. Best value: 0.397298:  39%|███▉      | 39/100 [00:47<00:57,  1.06it/s]Best trial: 29. Best value: 0.397298:  40%|████      | 40/100 [00:47<01:09,  1.16s/it]Best trial: 29. Best value: 0.397298:  40%|████      | 40/100 [00:48<01:09,  1.16s/it]Best trial: 29. Best value: 0.397298:  41%|████      | 41/100 [00:48<01:02,  1.06s/it]Best trial: 29. Best value: 0.397298:  41%|████      | 41/100 [00:49<01:02,  1.06s/it]Best trial: 29. Best value: 0.397298:  42%|████▏     | 42/100 [00:49<01:03,  1.09s/it]Best trial: 29. Best value: 0.397298:  42%|████▏     | 42/100 [00:50<01:03,  1.09s/it]Best trial: 29. Best value: 0.397298:  43%|████▎     | 43/100 [00:50<01:05,  1.16s/it]Best trial: 29. Best value: 0.397298:  43%|████▎     | 43/100 [00:51<01:05,  1.16s/it]Best trial: 29. Best value: 0.397298:  44%|████▍     | 44/100 [00:51<01:01,  1.09s/it]Best trial: 29. Best value: 0.397298:  44%|████▍     | 44/100 [00:52<01:01,  1.09s/it]Best trial: 29. Best value: 0.397298:  45%|████▌     | 45/100 [00:52<00:54,  1.00it/s]Best trial: 29. Best value: 0.397298:  45%|████▌     | 45/100 [00:53<00:54,  1.00it/s]Best trial: 29. Best value: 0.397298:  46%|████▌     | 46/100 [00:53<00:51,  1.04it/s]Best trial: 46. Best value: 0.401824:  46%|████▌     | 46/100 [00:54<00:51,  1.04it/s]Best trial: 46. Best value: 0.401824:  47%|████▋     | 47/100 [00:54<00:49,  1.08it/s]Best trial: 46. Best value: 0.401824:  47%|████▋     | 47/100 [00:55<00:49,  1.08it/s]Best trial: 46. Best value: 0.401824:  48%|████▊     | 48/100 [00:55<00:49,  1.05it/s]Best trial: 46. Best value: 0.401824:  48%|████▊     | 48/100 [00:55<00:49,  1.05it/s]Best trial: 46. Best value: 0.401824:  49%|████▉     | 49/100 [00:55<00:43,  1.16it/s]Best trial: 46. Best value: 0.401824:  49%|████▉     | 49/100 [00:57<00:43,  1.16it/s]Best trial: 46. Best value: 0.401824:  50%|█████     | 50/100 [00:57<01:01,  1.22s/it]Best trial: 46. Best value: 0.401824:  50%|█████     | 50/100 [00:58<01:01,  1.22s/it]Best trial: 46. Best value: 0.401824:  51%|█████     | 51/100 [00:58<00:54,  1.11s/it]Best trial: 46. Best value: 0.401824:  51%|█████     | 51/100 [00:59<00:54,  1.11s/it]Best trial: 46. Best value: 0.401824:  52%|█████▏    | 52/100 [00:59<00:50,  1.06s/it]Best trial: 46. Best value: 0.401824:  52%|█████▏    | 52/100 [01:00<00:50,  1.06s/it]Best trial: 46. Best value: 0.401824:  53%|█████▎    | 53/100 [01:00<00:44,  1.05it/s]Best trial: 46. Best value: 0.401824:  53%|█████▎    | 53/100 [01:01<00:44,  1.05it/s]Best trial: 46. Best value: 0.401824:  54%|█████▍    | 54/100 [01:01<00:43,  1.05it/s]Best trial: 46. Best value: 0.401824:  54%|█████▍    | 54/100 [01:03<00:43,  1.05it/s]Best trial: 46. Best value: 0.401824:  55%|█████▌    | 55/100 [01:03<00:57,  1.29s/it]Best trial: 46. Best value: 0.401824:  55%|█████▌    | 55/100 [01:04<00:57,  1.29s/it]Best trial: 46. Best value: 0.401824:  56%|█████▌    | 56/100 [01:04<00:49,  1.14s/it]Best trial: 46. Best value: 0.401824:  56%|█████▌    | 56/100 [01:05<00:49,  1.14s/it]Best trial: 46. Best value: 0.401824:  57%|█████▋    | 57/100 [01:05<00:43,  1.02s/it]Best trial: 46. Best value: 0.401824:  57%|█████▋    | 57/100 [01:05<00:43,  1.02s/it]Best trial: 46. Best value: 0.401824:  58%|█████▊    | 58/100 [01:05<00:39,  1.06it/s]Best trial: 46. Best value: 0.401824:  58%|█████▊    | 58/100 [01:06<00:39,  1.06it/s]Best trial: 46. Best value: 0.401824:  59%|█████▉    | 59/100 [01:06<00:38,  1.05it/s]Best trial: 46. Best value: 0.401824:  59%|█████▉    | 59/100 [01:07<00:38,  1.05it/s]Best trial: 46. Best value: 0.401824:  60%|██████    | 60/100 [01:07<00:35,  1.11it/s]Best trial: 46. Best value: 0.401824:  60%|██████    | 60/100 [01:08<00:35,  1.11it/s]Best trial: 46. Best value: 0.401824:  61%|██████    | 61/100 [01:08<00:36,  1.07it/s]Best trial: 46. Best value: 0.401824:  61%|██████    | 61/100 [01:09<00:36,  1.07it/s]Best trial: 46. Best value: 0.401824:  62%|██████▏   | 62/100 [01:09<00:34,  1.11it/s]Best trial: 46. Best value: 0.401824:  62%|██████▏   | 62/100 [01:10<00:34,  1.11it/s]Best trial: 46. Best value: 0.401824:  63%|██████▎   | 63/100 [01:10<00:31,  1.17it/s]Best trial: 46. Best value: 0.401824:  63%|██████▎   | 63/100 [01:11<00:31,  1.17it/s]Best trial: 46. Best value: 0.401824:  64%|██████▍   | 64/100 [01:11<00:33,  1.07it/s]Best trial: 46. Best value: 0.401824:  64%|██████▍   | 64/100 [01:12<00:33,  1.07it/s]Best trial: 46. Best value: 0.401824:  65%|██████▌   | 65/100 [01:12<00:31,  1.10it/s]Best trial: 65. Best value: 0.401882:  65%|██████▌   | 65/100 [01:12<00:31,  1.10it/s]Best trial: 65. Best value: 0.401882:  66%|██████▌   | 66/100 [01:12<00:29,  1.14it/s]Best trial: 65. Best value: 0.401882:  66%|██████▌   | 66/100 [01:13<00:29,  1.14it/s]Best trial: 65. Best value: 0.401882:  67%|██████▋   | 67/100 [01:13<00:26,  1.23it/s]Best trial: 65. Best value: 0.401882:  67%|██████▋   | 67/100 [01:14<00:26,  1.23it/s]Best trial: 65. Best value: 0.401882:  68%|██████▊   | 68/100 [01:14<00:25,  1.26it/s]Best trial: 65. Best value: 0.401882:  68%|██████▊   | 68/100 [01:14<00:25,  1.26it/s]Best trial: 65. Best value: 0.401882:  69%|██████▉   | 69/100 [01:14<00:23,  1.33it/s]Best trial: 69. Best value: 0.405752:  69%|██████▉   | 69/100 [01:15<00:23,  1.33it/s]Best trial: 69. Best value: 0.405752:  70%|███████   | 70/100 [01:15<00:23,  1.25it/s]Best trial: 69. Best value: 0.405752:  70%|███████   | 70/100 [01:16<00:23,  1.25it/s]Best trial: 69. Best value: 0.405752:  71%|███████   | 71/100 [01:16<00:25,  1.14it/s]Best trial: 69. Best value: 0.405752:  71%|███████   | 71/100 [01:17<00:25,  1.14it/s]Best trial: 69. Best value: 0.405752:  72%|███████▏  | 72/100 [01:17<00:23,  1.17it/s]Best trial: 69. Best value: 0.405752:  72%|███████▏  | 72/100 [01:18<00:23,  1.17it/s]Best trial: 69. Best value: 0.405752:  73%|███████▎  | 73/100 [01:18<00:23,  1.17it/s]Best trial: 69. Best value: 0.405752:  73%|███████▎  | 73/100 [01:19<00:23,  1.17it/s]Best trial: 69. Best value: 0.405752:  74%|███████▍  | 74/100 [01:19<00:20,  1.28it/s]Best trial: 69. Best value: 0.405752:  74%|███████▍  | 74/100 [01:20<00:20,  1.28it/s]Best trial: 69. Best value: 0.405752:  75%|███████▌  | 75/100 [01:20<00:20,  1.23it/s]Best trial: 69. Best value: 0.405752:  75%|███████▌  | 75/100 [01:20<00:20,  1.23it/s]Best trial: 69. Best value: 0.405752:  76%|███████▌  | 76/100 [01:20<00:18,  1.30it/s]Best trial: 69. Best value: 0.405752:  76%|███████▌  | 76/100 [01:21<00:18,  1.30it/s]Best trial: 69. Best value: 0.405752:  77%|███████▋  | 77/100 [01:21<00:17,  1.29it/s]Best trial: 69. Best value: 0.405752:  77%|███████▋  | 77/100 [01:22<00:17,  1.29it/s]Best trial: 69. Best value: 0.405752:  78%|███████▊  | 78/100 [01:22<00:16,  1.32it/s]Best trial: 69. Best value: 0.405752:  78%|███████▊  | 78/100 [01:23<00:16,  1.32it/s]Best trial: 69. Best value: 0.405752:  79%|███████▉  | 79/100 [01:23<00:16,  1.28it/s]Best trial: 79. Best value: 0.405975:  79%|███████▉  | 79/100 [01:24<00:16,  1.28it/s]Best trial: 79. Best value: 0.405975:  80%|████████  | 80/100 [01:24<00:17,  1.17it/s]Best trial: 79. Best value: 0.405975:  80%|████████  | 80/100 [01:24<00:17,  1.17it/s]Best trial: 79. Best value: 0.405975:  81%|████████  | 81/100 [01:24<00:15,  1.25it/s]Best trial: 79. Best value: 0.405975:  81%|████████  | 81/100 [01:25<00:15,  1.25it/s]Best trial: 79. Best value: 0.405975:  82%|████████▏ | 82/100 [01:25<00:13,  1.30it/s]Best trial: 79. Best value: 0.405975:  82%|████████▏ | 82/100 [01:26<00:13,  1.30it/s]Best trial: 79. Best value: 0.405975:  83%|████████▎ | 83/100 [01:26<00:12,  1.33it/s]Best trial: 79. Best value: 0.405975:  83%|████████▎ | 83/100 [01:26<00:12,  1.33it/s]Best trial: 79. Best value: 0.405975:  84%|████████▍ | 84/100 [01:26<00:11,  1.41it/s]Best trial: 79. Best value: 0.405975:  84%|████████▍ | 84/100 [01:27<00:11,  1.41it/s]Best trial: 79. Best value: 0.405975:  85%|████████▌ | 85/100 [01:27<00:11,  1.29it/s]Best trial: 79. Best value: 0.405975:  85%|████████▌ | 85/100 [01:28<00:11,  1.29it/s]Best trial: 79. Best value: 0.405975:  86%|████████▌ | 86/100 [01:28<00:10,  1.30it/s]Best trial: 79. Best value: 0.405975:  86%|████████▌ | 86/100 [01:29<00:10,  1.30it/s]Best trial: 79. Best value: 0.405975:  87%|████████▋ | 87/100 [01:29<00:09,  1.38it/s]Best trial: 79. Best value: 0.405975:  87%|████████▋ | 87/100 [01:31<00:09,  1.38it/s]Best trial: 79. Best value: 0.405975:  88%|████████▊ | 88/100 [01:31<00:13,  1.13s/it]Best trial: 79. Best value: 0.405975:  88%|████████▊ | 88/100 [01:32<00:13,  1.13s/it]Best trial: 79. Best value: 0.405975:  89%|████████▉ | 89/100 [01:32<00:11,  1.05s/it]Best trial: 79. Best value: 0.405975:  89%|████████▉ | 89/100 [01:32<00:11,  1.05s/it]Best trial: 79. Best value: 0.405975:  90%|█████████ | 90/100 [01:32<00:09,  1.05it/s]Best trial: 79. Best value: 0.405975:  90%|█████████ | 90/100 [01:33<00:09,  1.05it/s]Best trial: 79. Best value: 0.405975:  91%|█████████ | 91/100 [01:33<00:07,  1.22it/s]Best trial: 79. Best value: 0.405975:  91%|█████████ | 91/100 [01:34<00:07,  1.22it/s]Best trial: 79. Best value: 0.405975:  92%|█████████▏| 92/100 [01:34<00:06,  1.19it/s]Best trial: 79. Best value: 0.405975:  92%|█████████▏| 92/100 [01:34<00:06,  1.19it/s]Best trial: 79. Best value: 0.405975:  93%|█████████▎| 93/100 [01:34<00:05,  1.24it/s]Best trial: 79. Best value: 0.405975:  93%|█████████▎| 93/100 [01:35<00:05,  1.24it/s]Best trial: 79. Best value: 0.405975:  94%|█████████▍| 94/100 [01:35<00:04,  1.25it/s]Best trial: 79. Best value: 0.405975:  94%|█████████▍| 94/100 [01:36<00:04,  1.25it/s]Best trial: 79. Best value: 0.405975:  95%|█████████▌| 95/100 [01:36<00:04,  1.24it/s]Best trial: 79. Best value: 0.405975:  95%|█████████▌| 95/100 [01:37<00:04,  1.24it/s]Best trial: 79. Best value: 0.405975:  96%|█████████▌| 96/100 [01:37<00:03,  1.28it/s]Best trial: 79. Best value: 0.405975:  96%|█████████▌| 96/100 [01:38<00:03,  1.28it/s]Best trial: 79. Best value: 0.405975:  97%|█████████▋| 97/100 [01:38<00:02,  1.07it/s]Best trial: 79. Best value: 0.405975:  97%|█████████▋| 97/100 [01:39<00:02,  1.07it/s]Best trial: 79. Best value: 0.405975:  98%|█████████▊| 98/100 [01:39<00:01,  1.09it/s]Best trial: 79. Best value: 0.405975:  98%|█████████▊| 98/100 [01:39<00:01,  1.09it/s]Best trial: 79. Best value: 0.405975:  99%|█████████▉| 99/100 [01:39<00:00,  1.23it/s]Best trial: 79. Best value: 0.405975:  99%|█████████▉| 99/100 [01:41<00:00,  1.23it/s]Best trial: 79. Best value: 0.405975: 100%|██████████| 100/100 [01:41<00:00,  1.03it/s]Best trial: 79. Best value: 0.405975: 100%|██████████| 100/100 [01:41<00:00,  1.01s/it]
2025-12-01 00:54:44,271 - INFO - HPO Complete. Best AUPRC: 0.4060
2025-12-01 00:54:44,271 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.0979071461078933, 'max_depth': 3, 'subsample': 0.6120611970808689, 'colsample_bytree': 0.9860273560834028, 'gamma': 0.34709910460169013, 'reg_lambda': 0.0021285954451303857, 'reg_alpha': 1.9786710408305274e-06}
2025-12-01 00:54:44,272 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:54:46,260 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: pleth_only
2025-12-01 00:54:46,260 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:54:46,350 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:54:46,358 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:54:46,360 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:54:46,360 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 00:54:46,360 - INFO - Training model...
2025-12-01 00:54:46,820 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:54:51,532 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:54:51,532 - INFO - AUROC: 0.6766 (0.6216 - 0.7161)
2025-12-01 00:54:51,532 - INFO - AUPRC: 0.3768 (0.3003 - 0.4304)
2025-12-01 00:54:51,532 - INFO - Brier Score: 0.1947 (0.1817 - 0.2086)
2025-12-01 00:54:51,532 - INFO - Accuracy: 0.6806 (0.5908 - 0.7145)
2025-12-01 00:54:51,532 - INFO - Precision: 0.3375 (0.2743 - 0.3886)
2025-12-01 00:54:51,532 - INFO - Sensitivity (Recall): 0.5664 (0.4994 - 0.7310)
2025-12-01 00:54:51,532 - INFO - F1-Score: 0.4230 (0.3781 - 0.4793)
2025-12-01 00:54:51,532 - INFO - Best Threshold: 0.4500 (0.3520 - 0.4760)
2025-12-01 00:54:51,532 - INFO - Specificity: 0.7104 (0.5682 - 0.7608)
2025-12-01 00:54:51,541 - INFO - Calculating SHAP values...
2025-12-01 00:54:52,667 - INFO - SHAP plots saved.
2025-12-01 00:54:52,668 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:54:54,143 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: ecg_only
2025-12-01 00:54:54,144 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:54:54,232 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:54:54,241 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:54:54,243 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:54:54,243 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.400374:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.400374:   1%|          | 1/100 [00:01<01:57,  1.19s/it]Best trial: 0. Best value: 0.400374:   1%|          | 1/100 [00:04<01:57,  1.19s/it]Best trial: 0. Best value: 0.400374:   2%|▏         | 2/100 [00:04<04:02,  2.48s/it]Best trial: 0. Best value: 0.400374:   2%|▏         | 2/100 [00:05<04:02,  2.48s/it]Best trial: 0. Best value: 0.400374:   3%|▎         | 3/100 [00:05<02:35,  1.60s/it]Best trial: 0. Best value: 0.400374:   3%|▎         | 3/100 [00:06<02:35,  1.60s/it]Best trial: 0. Best value: 0.400374:   4%|▍         | 4/100 [00:06<02:17,  1.43s/it]Best trial: 0. Best value: 0.400374:   4%|▍         | 4/100 [00:07<02:17,  1.43s/it]Best trial: 0. Best value: 0.400374:   5%|▌         | 5/100 [00:07<01:53,  1.20s/it]Best trial: 5. Best value: 0.402249:   5%|▌         | 5/100 [00:08<01:53,  1.20s/it]Best trial: 5. Best value: 0.402249:   6%|▌         | 6/100 [00:08<01:57,  1.25s/it]Best trial: 5. Best value: 0.402249:   6%|▌         | 6/100 [00:11<01:57,  1.25s/it]Best trial: 5. Best value: 0.402249:   7%|▋         | 7/100 [00:11<02:40,  1.72s/it]Best trial: 5. Best value: 0.402249:   7%|▋         | 7/100 [00:12<02:40,  1.72s/it]Best trial: 5. Best value: 0.402249:   8%|▊         | 8/100 [00:12<02:20,  1.52s/it]Best trial: 5. Best value: 0.402249:   8%|▊         | 8/100 [00:15<02:20,  1.52s/it]Best trial: 5. Best value: 0.402249:   9%|▉         | 9/100 [00:15<02:58,  1.96s/it]Best trial: 5. Best value: 0.402249:   9%|▉         | 9/100 [00:16<02:58,  1.96s/it]Best trial: 5. Best value: 0.402249:  10%|█         | 10/100 [00:16<02:35,  1.72s/it]Best trial: 10. Best value: 0.406846:  10%|█         | 10/100 [00:17<02:35,  1.72s/it]Best trial: 10. Best value: 0.406846:  11%|█         | 11/100 [00:17<02:21,  1.59s/it]Best trial: 10. Best value: 0.406846:  11%|█         | 11/100 [00:18<02:21,  1.59s/it]Best trial: 10. Best value: 0.406846:  12%|█▏        | 12/100 [00:18<02:07,  1.44s/it]Best trial: 10. Best value: 0.406846:  12%|█▏        | 12/100 [00:19<02:07,  1.44s/it]Best trial: 10. Best value: 0.406846:  13%|█▎        | 13/100 [00:19<01:50,  1.27s/it]Best trial: 13. Best value: 0.409817:  13%|█▎        | 13/100 [00:20<01:50,  1.27s/it]Best trial: 13. Best value: 0.409817:  14%|█▍        | 14/100 [00:20<01:40,  1.17s/it]Best trial: 13. Best value: 0.409817:  14%|█▍        | 14/100 [00:21<01:40,  1.17s/it]Best trial: 13. Best value: 0.409817:  15%|█▌        | 15/100 [00:21<01:45,  1.25s/it]Best trial: 13. Best value: 0.409817:  15%|█▌        | 15/100 [00:23<01:45,  1.25s/it]Best trial: 13. Best value: 0.409817:  16%|█▌        | 16/100 [00:23<01:52,  1.34s/it]Best trial: 13. Best value: 0.409817:  16%|█▌        | 16/100 [00:24<01:52,  1.34s/it]Best trial: 13. Best value: 0.409817:  17%|█▋        | 17/100 [00:24<01:51,  1.35s/it]Best trial: 13. Best value: 0.409817:  17%|█▋        | 17/100 [00:25<01:51,  1.35s/it]Best trial: 13. Best value: 0.409817:  18%|█▊        | 18/100 [00:25<01:34,  1.15s/it]Best trial: 13. Best value: 0.409817:  18%|█▊        | 18/100 [00:26<01:34,  1.15s/it]Best trial: 13. Best value: 0.409817:  19%|█▉        | 19/100 [00:26<01:38,  1.22s/it]Best trial: 13. Best value: 0.409817:  19%|█▉        | 19/100 [00:28<01:38,  1.22s/it]Best trial: 13. Best value: 0.409817:  20%|██        | 20/100 [00:28<01:43,  1.29s/it]Best trial: 13. Best value: 0.409817:  20%|██        | 20/100 [00:29<01:43,  1.29s/it]Best trial: 13. Best value: 0.409817:  21%|██        | 21/100 [00:29<01:36,  1.23s/it]Best trial: 13. Best value: 0.409817:  21%|██        | 21/100 [00:30<01:36,  1.23s/it]Best trial: 13. Best value: 0.409817:  22%|██▏       | 22/100 [00:30<01:27,  1.13s/it]Best trial: 13. Best value: 0.409817:  22%|██▏       | 22/100 [00:31<01:27,  1.13s/it]Best trial: 13. Best value: 0.409817:  23%|██▎       | 23/100 [00:31<01:19,  1.03s/it]Best trial: 13. Best value: 0.409817:  23%|██▎       | 23/100 [00:32<01:19,  1.03s/it]Best trial: 13. Best value: 0.409817:  24%|██▍       | 24/100 [00:32<01:13,  1.03it/s]Best trial: 24. Best value: 0.412923:  24%|██▍       | 24/100 [00:32<01:13,  1.03it/s]Best trial: 24. Best value: 0.412923:  25%|██▌       | 25/100 [00:32<01:11,  1.05it/s]Best trial: 24. Best value: 0.412923:  25%|██▌       | 25/100 [00:33<01:11,  1.05it/s]Best trial: 24. Best value: 0.412923:  26%|██▌       | 26/100 [00:33<01:07,  1.09it/s]Best trial: 24. Best value: 0.412923:  26%|██▌       | 26/100 [00:34<01:07,  1.09it/s]Best trial: 24. Best value: 0.412923:  27%|██▋       | 27/100 [00:34<01:11,  1.02it/s]Best trial: 24. Best value: 0.412923:  27%|██▋       | 27/100 [00:35<01:11,  1.02it/s]Best trial: 24. Best value: 0.412923:  28%|██▊       | 28/100 [00:35<01:07,  1.06it/s]Best trial: 24. Best value: 0.412923:  28%|██▊       | 28/100 [00:36<01:07,  1.06it/s]Best trial: 24. Best value: 0.412923:  29%|██▉       | 29/100 [00:36<01:10,  1.01it/s]Best trial: 24. Best value: 0.412923:  29%|██▉       | 29/100 [00:39<01:10,  1.01it/s]Best trial: 24. Best value: 0.412923:  30%|███       | 30/100 [00:39<01:33,  1.33s/it]Best trial: 24. Best value: 0.412923:  30%|███       | 30/100 [00:41<01:33,  1.33s/it]Best trial: 24. Best value: 0.412923:  31%|███       | 31/100 [00:41<01:46,  1.54s/it]Best trial: 24. Best value: 0.412923:  31%|███       | 31/100 [00:42<01:46,  1.54s/it]Best trial: 24. Best value: 0.412923:  32%|███▏      | 32/100 [00:42<01:43,  1.53s/it]Best trial: 24. Best value: 0.412923:  32%|███▏      | 32/100 [00:43<01:43,  1.53s/it]Best trial: 24. Best value: 0.412923:  33%|███▎      | 33/100 [00:43<01:31,  1.36s/it]Best trial: 24. Best value: 0.412923:  33%|███▎      | 33/100 [00:44<01:31,  1.36s/it]Best trial: 24. Best value: 0.412923:  34%|███▍      | 34/100 [00:44<01:20,  1.22s/it]Best trial: 24. Best value: 0.412923:  34%|███▍      | 34/100 [00:45<01:20,  1.22s/it]Best trial: 24. Best value: 0.412923:  35%|███▌      | 35/100 [00:45<01:18,  1.20s/it]Best trial: 24. Best value: 0.412923:  35%|███▌      | 35/100 [00:46<01:18,  1.20s/it]Best trial: 24. Best value: 0.412923:  36%|███▌      | 36/100 [00:46<01:07,  1.05s/it]Best trial: 24. Best value: 0.412923:  36%|███▌      | 36/100 [00:47<01:07,  1.05s/it]Best trial: 24. Best value: 0.412923:  37%|███▋      | 37/100 [00:47<01:02,  1.01it/s]Best trial: 24. Best value: 0.412923:  37%|███▋      | 37/100 [00:48<01:02,  1.01it/s]Best trial: 24. Best value: 0.412923:  38%|███▊      | 38/100 [00:48<00:59,  1.03it/s]Best trial: 24. Best value: 0.412923:  38%|███▊      | 38/100 [00:48<00:59,  1.03it/s]Best trial: 24. Best value: 0.412923:  39%|███▉      | 39/100 [00:48<00:56,  1.09it/s]Best trial: 24. Best value: 0.412923:  39%|███▉      | 39/100 [00:49<00:56,  1.09it/s]Best trial: 24. Best value: 0.412923:  40%|████      | 40/100 [00:49<00:52,  1.15it/s]Best trial: 24. Best value: 0.412923:  40%|████      | 40/100 [00:50<00:52,  1.15it/s]Best trial: 24. Best value: 0.412923:  41%|████      | 41/100 [00:50<00:49,  1.19it/s]Best trial: 24. Best value: 0.412923:  41%|████      | 41/100 [00:51<00:49,  1.19it/s]Best trial: 24. Best value: 0.412923:  42%|████▏     | 42/100 [00:51<00:56,  1.03it/s]Best trial: 24. Best value: 0.412923:  42%|████▏     | 42/100 [00:52<00:56,  1.03it/s]Best trial: 24. Best value: 0.412923:  43%|████▎     | 43/100 [00:52<00:52,  1.09it/s]Best trial: 24. Best value: 0.412923:  43%|████▎     | 43/100 [00:53<00:52,  1.09it/s]Best trial: 24. Best value: 0.412923:  44%|████▍     | 44/100 [00:53<00:55,  1.01it/s]Best trial: 24. Best value: 0.412923:  44%|████▍     | 44/100 [00:54<00:55,  1.01it/s]Best trial: 24. Best value: 0.412923:  45%|████▌     | 45/100 [00:54<01:01,  1.12s/it]Best trial: 24. Best value: 0.412923:  45%|████▌     | 45/100 [00:56<01:01,  1.12s/it]Best trial: 24. Best value: 0.412923:  46%|████▌     | 46/100 [00:56<00:58,  1.09s/it]Best trial: 24. Best value: 0.412923:  46%|████▌     | 46/100 [00:57<00:58,  1.09s/it]Best trial: 24. Best value: 0.412923:  47%|████▋     | 47/100 [00:57<01:08,  1.29s/it]Best trial: 24. Best value: 0.412923:  47%|████▋     | 47/100 [00:59<01:08,  1.29s/it]Best trial: 24. Best value: 0.412923:  48%|████▊     | 48/100 [00:59<01:13,  1.42s/it]Best trial: 24. Best value: 0.412923:  48%|████▊     | 48/100 [01:00<01:13,  1.42s/it]Best trial: 24. Best value: 0.412923:  49%|████▉     | 49/100 [01:00<01:06,  1.30s/it]Best trial: 24. Best value: 0.412923:  49%|████▉     | 49/100 [01:01<01:06,  1.30s/it]Best trial: 24. Best value: 0.412923:  50%|█████     | 50/100 [01:01<00:56,  1.13s/it]Best trial: 24. Best value: 0.412923:  50%|█████     | 50/100 [01:02<00:56,  1.13s/it]Best trial: 24. Best value: 0.412923:  51%|█████     | 51/100 [01:02<00:53,  1.09s/it]Best trial: 24. Best value: 0.412923:  51%|█████     | 51/100 [01:03<00:53,  1.09s/it]Best trial: 24. Best value: 0.412923:  52%|█████▏    | 52/100 [01:03<00:58,  1.22s/it]Best trial: 24. Best value: 0.412923:  52%|█████▏    | 52/100 [01:05<00:58,  1.22s/it]Best trial: 24. Best value: 0.412923:  53%|█████▎    | 53/100 [01:05<00:59,  1.27s/it]Best trial: 24. Best value: 0.412923:  53%|█████▎    | 53/100 [01:06<00:59,  1.27s/it]Best trial: 24. Best value: 0.412923:  54%|█████▍    | 54/100 [01:06<01:00,  1.31s/it]Best trial: 24. Best value: 0.412923:  54%|█████▍    | 54/100 [01:07<01:00,  1.31s/it]Best trial: 24. Best value: 0.412923:  55%|█████▌    | 55/100 [01:07<00:59,  1.32s/it]Best trial: 24. Best value: 0.412923:  55%|█████▌    | 55/100 [01:09<00:59,  1.32s/it]Best trial: 24. Best value: 0.412923:  56%|█████▌    | 56/100 [01:09<01:00,  1.38s/it]Best trial: 24. Best value: 0.412923:  56%|█████▌    | 56/100 [01:11<01:00,  1.38s/it]Best trial: 24. Best value: 0.412923:  57%|█████▋    | 57/100 [01:11<01:08,  1.60s/it]Best trial: 24. Best value: 0.412923:  57%|█████▋    | 57/100 [01:12<01:08,  1.60s/it]Best trial: 24. Best value: 0.412923:  58%|█████▊    | 58/100 [01:12<00:58,  1.40s/it]Best trial: 24. Best value: 0.412923:  58%|█████▊    | 58/100 [01:13<00:58,  1.40s/it]Best trial: 24. Best value: 0.412923:  59%|█████▉    | 59/100 [01:13<00:52,  1.29s/it]Best trial: 59. Best value: 0.414985:  59%|█████▉    | 59/100 [01:14<00:52,  1.29s/it]Best trial: 59. Best value: 0.414985:  60%|██████    | 60/100 [01:14<00:47,  1.19s/it]Best trial: 59. Best value: 0.414985:  60%|██████    | 60/100 [01:15<00:47,  1.19s/it]Best trial: 59. Best value: 0.414985:  61%|██████    | 61/100 [01:15<00:46,  1.20s/it]Best trial: 59. Best value: 0.414985:  61%|██████    | 61/100 [01:16<00:46,  1.20s/it]Best trial: 59. Best value: 0.414985:  62%|██████▏   | 62/100 [01:16<00:44,  1.17s/it]Best trial: 59. Best value: 0.414985:  62%|██████▏   | 62/100 [01:17<00:44,  1.17s/it]Best trial: 59. Best value: 0.414985:  63%|██████▎   | 63/100 [01:17<00:41,  1.12s/it]Best trial: 59. Best value: 0.414985:  63%|██████▎   | 63/100 [01:18<00:41,  1.12s/it]Best trial: 59. Best value: 0.414985:  64%|██████▍   | 64/100 [01:18<00:37,  1.04s/it]Best trial: 59. Best value: 0.414985:  64%|██████▍   | 64/100 [01:19<00:37,  1.04s/it]Best trial: 59. Best value: 0.414985:  65%|██████▌   | 65/100 [01:19<00:37,  1.07s/it]Best trial: 59. Best value: 0.414985:  65%|██████▌   | 65/100 [01:20<00:37,  1.07s/it]Best trial: 59. Best value: 0.414985:  66%|██████▌   | 66/100 [01:20<00:33,  1.00it/s]Best trial: 59. Best value: 0.414985:  66%|██████▌   | 66/100 [01:21<00:33,  1.00it/s]Best trial: 59. Best value: 0.414985:  67%|██████▋   | 67/100 [01:21<00:31,  1.04it/s]Best trial: 59. Best value: 0.414985:  67%|██████▋   | 67/100 [01:22<00:31,  1.04it/s]Best trial: 59. Best value: 0.414985:  68%|██████▊   | 68/100 [01:22<00:28,  1.13it/s]Best trial: 59. Best value: 0.414985:  68%|██████▊   | 68/100 [01:23<00:28,  1.13it/s]Best trial: 59. Best value: 0.414985:  69%|██████▉   | 69/100 [01:23<00:26,  1.16it/s]Best trial: 59. Best value: 0.414985:  69%|██████▉   | 69/100 [01:24<00:26,  1.16it/s]Best trial: 59. Best value: 0.414985:  70%|███████   | 70/100 [01:24<00:26,  1.11it/s]Best trial: 59. Best value: 0.414985:  70%|███████   | 70/100 [01:25<00:26,  1.11it/s]Best trial: 59. Best value: 0.414985:  71%|███████   | 71/100 [01:25<00:28,  1.01it/s]Best trial: 59. Best value: 0.414985:  71%|███████   | 71/100 [01:26<00:28,  1.01it/s]Best trial: 59. Best value: 0.414985:  72%|███████▏  | 72/100 [01:26<00:28,  1.01s/it]Best trial: 59. Best value: 0.414985:  72%|███████▏  | 72/100 [01:27<00:28,  1.01s/it]Best trial: 59. Best value: 0.414985:  73%|███████▎  | 73/100 [01:27<00:28,  1.04s/it]Best trial: 59. Best value: 0.414985:  73%|███████▎  | 73/100 [01:28<00:28,  1.04s/it]Best trial: 59. Best value: 0.414985:  74%|███████▍  | 74/100 [01:28<00:29,  1.13s/it]Best trial: 59. Best value: 0.414985:  74%|███████▍  | 74/100 [01:29<00:29,  1.13s/it]Best trial: 59. Best value: 0.414985:  75%|███████▌  | 75/100 [01:29<00:26,  1.08s/it]Best trial: 75. Best value: 0.416379:  75%|███████▌  | 75/100 [01:30<00:26,  1.08s/it]Best trial: 75. Best value: 0.416379:  76%|███████▌  | 76/100 [01:30<00:24,  1.02s/it]Best trial: 75. Best value: 0.416379:  76%|███████▌  | 76/100 [01:31<00:24,  1.02s/it]Best trial: 75. Best value: 0.416379:  77%|███████▋  | 77/100 [01:31<00:22,  1.01it/s]Best trial: 77. Best value: 0.422509:  77%|███████▋  | 77/100 [01:32<00:22,  1.01it/s]Best trial: 77. Best value: 0.422509:  78%|███████▊  | 78/100 [01:32<00:21,  1.05it/s]Best trial: 77. Best value: 0.422509:  78%|███████▊  | 78/100 [01:33<00:21,  1.05it/s]Best trial: 77. Best value: 0.422509:  79%|███████▉  | 79/100 [01:33<00:20,  1.01it/s]Best trial: 77. Best value: 0.422509:  79%|███████▉  | 79/100 [01:34<00:20,  1.01it/s]Best trial: 77. Best value: 0.422509:  80%|████████  | 80/100 [01:34<00:20,  1.03s/it]Best trial: 77. Best value: 0.422509:  80%|████████  | 80/100 [01:35<00:20,  1.03s/it]Best trial: 77. Best value: 0.422509:  81%|████████  | 81/100 [01:35<00:18,  1.03it/s]Best trial: 77. Best value: 0.422509:  81%|████████  | 81/100 [01:36<00:18,  1.03it/s]Best trial: 77. Best value: 0.422509:  82%|████████▏ | 82/100 [01:36<00:17,  1.03it/s]Best trial: 77. Best value: 0.422509:  82%|████████▏ | 82/100 [01:37<00:17,  1.03it/s]Best trial: 77. Best value: 0.422509:  83%|████████▎ | 83/100 [01:37<00:16,  1.02it/s]Best trial: 77. Best value: 0.422509:  83%|████████▎ | 83/100 [01:38<00:16,  1.02it/s]Best trial: 77. Best value: 0.422509:  84%|████████▍ | 84/100 [01:38<00:14,  1.11it/s]Best trial: 77. Best value: 0.422509:  84%|████████▍ | 84/100 [01:38<00:14,  1.11it/s]Best trial: 77. Best value: 0.422509:  85%|████████▌ | 85/100 [01:38<00:12,  1.17it/s]Best trial: 77. Best value: 0.422509:  85%|████████▌ | 85/100 [01:39<00:12,  1.17it/s]Best trial: 77. Best value: 0.422509:  86%|████████▌ | 86/100 [01:39<00:12,  1.16it/s]Best trial: 77. Best value: 0.422509:  86%|████████▌ | 86/100 [01:40<00:12,  1.16it/s]Best trial: 77. Best value: 0.422509:  87%|████████▋ | 87/100 [01:40<00:11,  1.11it/s]Best trial: 77. Best value: 0.422509:  87%|████████▋ | 87/100 [01:41<00:11,  1.11it/s]Best trial: 77. Best value: 0.422509:  88%|████████▊ | 88/100 [01:41<00:10,  1.18it/s]Best trial: 77. Best value: 0.422509:  88%|████████▊ | 88/100 [01:42<00:10,  1.18it/s]Best trial: 77. Best value: 0.422509:  89%|████████▉ | 89/100 [01:42<00:09,  1.15it/s]Best trial: 77. Best value: 0.422509:  89%|████████▉ | 89/100 [01:43<00:09,  1.15it/s]Best trial: 77. Best value: 0.422509:  90%|█████████ | 90/100 [01:43<00:08,  1.21it/s]Best trial: 77. Best value: 0.422509:  90%|█████████ | 90/100 [01:43<00:08,  1.21it/s]Best trial: 77. Best value: 0.422509:  91%|█████████ | 91/100 [01:43<00:07,  1.19it/s]Best trial: 77. Best value: 0.422509:  91%|█████████ | 91/100 [01:44<00:07,  1.19it/s]Best trial: 77. Best value: 0.422509:  92%|█████████▏| 92/100 [01:44<00:06,  1.27it/s]Best trial: 77. Best value: 0.422509:  92%|█████████▏| 92/100 [01:45<00:06,  1.27it/s]Best trial: 77. Best value: 0.422509:  93%|█████████▎| 93/100 [01:45<00:06,  1.16it/s]Best trial: 77. Best value: 0.422509:  93%|█████████▎| 93/100 [01:46<00:06,  1.16it/s]Best trial: 77. Best value: 0.422509:  94%|█████████▍| 94/100 [01:46<00:04,  1.21it/s]Best trial: 77. Best value: 0.422509:  94%|█████████▍| 94/100 [01:47<00:04,  1.21it/s]Best trial: 77. Best value: 0.422509:  95%|█████████▌| 95/100 [01:47<00:03,  1.27it/s]Best trial: 77. Best value: 0.422509:  95%|█████████▌| 95/100 [01:48<00:03,  1.27it/s]Best trial: 77. Best value: 0.422509:  96%|█████████▌| 96/100 [01:48<00:03,  1.17it/s]Best trial: 77. Best value: 0.422509:  96%|█████████▌| 96/100 [01:48<00:03,  1.17it/s]Best trial: 77. Best value: 0.422509:  97%|█████████▋| 97/100 [01:48<00:02,  1.27it/s]Best trial: 77. Best value: 0.422509:  97%|█████████▋| 97/100 [01:49<00:02,  1.27it/s]Best trial: 77. Best value: 0.422509:  98%|█████████▊| 98/100 [01:49<00:01,  1.13it/s]Best trial: 77. Best value: 0.422509:  98%|█████████▊| 98/100 [01:50<00:01,  1.13it/s]Best trial: 77. Best value: 0.422509:  99%|█████████▉| 99/100 [01:50<00:00,  1.18it/s]Best trial: 77. Best value: 0.422509:  99%|█████████▉| 99/100 [01:51<00:00,  1.18it/s]Best trial: 77. Best value: 0.422509: 100%|██████████| 100/100 [01:51<00:00,  1.17it/s]Best trial: 77. Best value: 0.422509: 100%|██████████| 100/100 [01:51<00:00,  1.11s/it]
2025-12-01 00:56:45,696 - INFO - HPO Complete. Best AUPRC: 0.4225
2025-12-01 00:56:45,696 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.03795690139314138, 'max_depth': 4, 'subsample': 0.6384749896586811, 'colsample_bytree': 0.6121974684668062, 'gamma': 2.929811976135144, 'reg_lambda': 1.949246799212846e-08, 'reg_alpha': 0.0020541453022207036}
2025-12-01 00:56:45,698 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:56:47,701 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: ecg_only
2025-12-01 00:56:47,702 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:56:47,800 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:56:47,808 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:56:47,810 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:56:47,810 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 00:56:47,810 - INFO - Training model...
2025-12-01 00:56:48,504 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:56:53,230 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:56:53,230 - INFO - AUROC: 0.6379 (0.5629 - 0.6847)
2025-12-01 00:56:53,230 - INFO - AUPRC: 0.3512 (0.2480 - 0.4210)
2025-12-01 00:56:53,230 - INFO - Brier Score: 0.1835 (0.1702 - 0.1968)
2025-12-01 00:56:53,230 - INFO - Accuracy: 0.6387 (0.3139 - 0.7185)
2025-12-01 00:56:53,230 - INFO - Precision: 0.2996 (0.2092 - 0.3731)
2025-12-01 00:56:53,230 - INFO - Sensitivity (Recall): 0.5594 (0.4310 - 0.9317)
2025-12-01 00:56:53,230 - INFO - F1-Score: 0.3902 (0.3282 - 0.4540)
2025-12-01 00:56:53,230 - INFO - Best Threshold: 0.3600 (0.1200 - 0.4740)
2025-12-01 00:56:53,230 - INFO - Specificity: 0.6594 (0.1743 - 0.7936)
2025-12-01 00:56:53,244 - INFO - Calculating SHAP values...
2025-12-01 00:56:54,477 - INFO - SHAP plots saved.
2025-12-01 00:56:54,480 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:56:55,754 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: co2_only
2025-12-01 00:56:55,754 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:56:55,840 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:56:55,848 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:56:55,850 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:56:55,850 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.441588:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.441588:   1%|          | 1/100 [00:01<01:44,  1.05s/it]Best trial: 1. Best value: 0.466253:   1%|          | 1/100 [00:01<01:44,  1.05s/it]Best trial: 1. Best value: 0.466253:   2%|▏         | 2/100 [00:01<01:26,  1.14it/s]Best trial: 2. Best value: 0.513019:   2%|▏         | 2/100 [00:03<01:26,  1.14it/s]Best trial: 2. Best value: 0.513019:   3%|▎         | 3/100 [00:03<02:02,  1.26s/it]Best trial: 2. Best value: 0.513019:   3%|▎         | 3/100 [00:06<02:02,  1.26s/it]Best trial: 2. Best value: 0.513019:   4%|▍         | 4/100 [00:06<02:55,  1.82s/it]Best trial: 4. Best value: 0.521918:   4%|▍         | 4/100 [00:07<02:55,  1.82s/it]Best trial: 4. Best value: 0.521918:   5%|▌         | 5/100 [00:07<02:32,  1.60s/it]Best trial: 4. Best value: 0.521918:   5%|▌         | 5/100 [00:08<02:32,  1.60s/it]Best trial: 4. Best value: 0.521918:   6%|▌         | 6/100 [00:08<02:07,  1.35s/it]Best trial: 4. Best value: 0.521918:   6%|▌         | 6/100 [00:09<02:07,  1.35s/it]Best trial: 4. Best value: 0.521918:   7%|▋         | 7/100 [00:09<01:48,  1.17s/it]Best trial: 4. Best value: 0.521918:   7%|▋         | 7/100 [00:10<01:48,  1.17s/it]Best trial: 4. Best value: 0.521918:   8%|▊         | 8/100 [00:10<01:43,  1.12s/it]Best trial: 4. Best value: 0.521918:   8%|▊         | 8/100 [00:11<01:43,  1.12s/it]Best trial: 4. Best value: 0.521918:   9%|▉         | 9/100 [00:11<01:50,  1.21s/it]Best trial: 4. Best value: 0.521918:   9%|▉         | 9/100 [00:12<01:50,  1.21s/it]Best trial: 4. Best value: 0.521918:  10%|█         | 10/100 [00:12<01:45,  1.18s/it]Best trial: 4. Best value: 0.521918:  10%|█         | 10/100 [00:14<01:45,  1.18s/it]Best trial: 4. Best value: 0.521918:  11%|█         | 11/100 [00:14<01:56,  1.31s/it]Best trial: 4. Best value: 0.521918:  11%|█         | 11/100 [00:17<01:56,  1.31s/it]Best trial: 4. Best value: 0.521918:  12%|█▏        | 12/100 [00:17<02:39,  1.82s/it]Best trial: 4. Best value: 0.521918:  12%|█▏        | 12/100 [00:18<02:39,  1.82s/it]Best trial: 4. Best value: 0.521918:  13%|█▎        | 13/100 [00:18<02:32,  1.76s/it]Best trial: 4. Best value: 0.521918:  13%|█▎        | 13/100 [00:20<02:32,  1.76s/it]Best trial: 4. Best value: 0.521918:  14%|█▍        | 14/100 [00:20<02:18,  1.61s/it]Best trial: 4. Best value: 0.521918:  14%|█▍        | 14/100 [00:21<02:18,  1.61s/it]Best trial: 4. Best value: 0.521918:  15%|█▌        | 15/100 [00:21<02:04,  1.46s/it]Best trial: 4. Best value: 0.521918:  15%|█▌        | 15/100 [00:23<02:04,  1.46s/it]Best trial: 4. Best value: 0.521918:  16%|█▌        | 16/100 [00:23<02:24,  1.72s/it]Best trial: 4. Best value: 0.521918:  16%|█▌        | 16/100 [00:25<02:24,  1.72s/it]Best trial: 4. Best value: 0.521918:  17%|█▋        | 17/100 [00:25<02:26,  1.76s/it]Best trial: 4. Best value: 0.521918:  17%|█▋        | 17/100 [00:26<02:26,  1.76s/it]Best trial: 4. Best value: 0.521918:  18%|█▊        | 18/100 [00:26<02:05,  1.53s/it]Best trial: 4. Best value: 0.521918:  18%|█▊        | 18/100 [00:29<02:05,  1.53s/it]Best trial: 4. Best value: 0.521918:  19%|█▉        | 19/100 [00:29<02:42,  2.01s/it]Best trial: 4. Best value: 0.521918:  19%|█▉        | 19/100 [00:32<02:42,  2.01s/it]Best trial: 4. Best value: 0.521918:  20%|██        | 20/100 [00:32<02:53,  2.16s/it]Best trial: 4. Best value: 0.521918:  20%|██        | 20/100 [00:34<02:53,  2.16s/it]Best trial: 4. Best value: 0.521918:  21%|██        | 21/100 [00:34<03:06,  2.36s/it]Best trial: 21. Best value: 0.522757:  21%|██        | 21/100 [00:36<03:06,  2.36s/it]Best trial: 21. Best value: 0.522757:  22%|██▏       | 22/100 [00:36<02:48,  2.15s/it]Best trial: 21. Best value: 0.522757:  22%|██▏       | 22/100 [00:39<02:48,  2.15s/it]Best trial: 21. Best value: 0.522757:  23%|██▎       | 23/100 [00:39<02:56,  2.30s/it]Best trial: 21. Best value: 0.522757:  23%|██▎       | 23/100 [00:40<02:56,  2.30s/it]Best trial: 21. Best value: 0.522757:  24%|██▍       | 24/100 [00:40<02:31,  1.99s/it]Best trial: 21. Best value: 0.522757:  24%|██▍       | 24/100 [00:43<02:31,  1.99s/it]Best trial: 21. Best value: 0.522757:  25%|██▌       | 25/100 [00:43<02:50,  2.27s/it]Best trial: 21. Best value: 0.522757:  25%|██▌       | 25/100 [00:45<02:50,  2.27s/it]Best trial: 21. Best value: 0.522757:  26%|██▌       | 26/100 [00:45<02:34,  2.09s/it]Best trial: 26. Best value: 0.523427:  26%|██▌       | 26/100 [00:46<02:34,  2.09s/it]Best trial: 26. Best value: 0.523427:  27%|██▋       | 27/100 [00:46<02:18,  1.90s/it]Best trial: 26. Best value: 0.523427:  27%|██▋       | 27/100 [00:47<02:18,  1.90s/it]Best trial: 26. Best value: 0.523427:  28%|██▊       | 28/100 [00:47<02:02,  1.70s/it]Best trial: 26. Best value: 0.523427:  28%|██▊       | 28/100 [00:49<02:02,  1.70s/it]Best trial: 26. Best value: 0.523427:  29%|██▉       | 29/100 [00:49<02:04,  1.75s/it]Best trial: 26. Best value: 0.523427:  29%|██▉       | 29/100 [00:50<02:04,  1.75s/it]Best trial: 26. Best value: 0.523427:  30%|███       | 30/100 [00:50<01:52,  1.61s/it]Best trial: 26. Best value: 0.523427:  30%|███       | 30/100 [00:52<01:52,  1.61s/it]Best trial: 26. Best value: 0.523427:  31%|███       | 31/100 [00:52<01:55,  1.68s/it]Best trial: 31. Best value: 0.523592:  31%|███       | 31/100 [00:54<01:55,  1.68s/it]Best trial: 31. Best value: 0.523592:  32%|███▏      | 32/100 [00:54<01:48,  1.60s/it]Best trial: 31. Best value: 0.523592:  32%|███▏      | 32/100 [00:56<01:48,  1.60s/it]Best trial: 31. Best value: 0.523592:  33%|███▎      | 33/100 [00:56<01:53,  1.69s/it]Best trial: 31. Best value: 0.523592:  33%|███▎      | 33/100 [00:57<01:53,  1.69s/it]Best trial: 31. Best value: 0.523592:  34%|███▍      | 34/100 [00:57<01:40,  1.53s/it]Best trial: 34. Best value: 0.527169:  34%|███▍      | 34/100 [00:58<01:40,  1.53s/it]Best trial: 34. Best value: 0.527169:  35%|███▌      | 35/100 [00:58<01:32,  1.43s/it]Best trial: 34. Best value: 0.527169:  35%|███▌      | 35/100 [00:59<01:32,  1.43s/it]Best trial: 34. Best value: 0.527169:  36%|███▌      | 36/100 [00:59<01:25,  1.34s/it]Best trial: 34. Best value: 0.527169:  36%|███▌      | 36/100 [01:00<01:25,  1.34s/it]Best trial: 34. Best value: 0.527169:  37%|███▋      | 37/100 [01:00<01:15,  1.20s/it]Best trial: 34. Best value: 0.527169:  37%|███▋      | 37/100 [01:01<01:15,  1.20s/it]Best trial: 34. Best value: 0.527169:  38%|███▊      | 38/100 [01:01<01:14,  1.21s/it]Best trial: 34. Best value: 0.527169:  38%|███▊      | 38/100 [01:03<01:14,  1.21s/it]Best trial: 34. Best value: 0.527169:  39%|███▉      | 39/100 [01:03<01:25,  1.40s/it]Best trial: 34. Best value: 0.527169:  39%|███▉      | 39/100 [01:05<01:25,  1.40s/it]Best trial: 34. Best value: 0.527169:  40%|████      | 40/100 [01:05<01:29,  1.49s/it]Best trial: 34. Best value: 0.527169:  40%|████      | 40/100 [01:06<01:29,  1.49s/it]Best trial: 34. Best value: 0.527169:  41%|████      | 41/100 [01:06<01:28,  1.50s/it]Best trial: 34. Best value: 0.527169:  41%|████      | 41/100 [01:07<01:28,  1.50s/it]Best trial: 34. Best value: 0.527169:  42%|████▏     | 42/100 [01:07<01:21,  1.41s/it]Best trial: 34. Best value: 0.527169:  42%|████▏     | 42/100 [01:09<01:21,  1.41s/it]Best trial: 34. Best value: 0.527169:  43%|████▎     | 43/100 [01:09<01:15,  1.33s/it]Best trial: 34. Best value: 0.527169:  43%|████▎     | 43/100 [01:10<01:15,  1.33s/it]Best trial: 34. Best value: 0.527169:  44%|████▍     | 44/100 [01:10<01:15,  1.35s/it]Best trial: 34. Best value: 0.527169:  44%|████▍     | 44/100 [01:11<01:15,  1.35s/it]Best trial: 34. Best value: 0.527169:  45%|████▌     | 45/100 [01:11<01:14,  1.35s/it]Best trial: 34. Best value: 0.527169:  45%|████▌     | 45/100 [01:12<01:14,  1.35s/it]Best trial: 34. Best value: 0.527169:  46%|████▌     | 46/100 [01:12<01:07,  1.25s/it]Best trial: 34. Best value: 0.527169:  46%|████▌     | 46/100 [01:14<01:07,  1.25s/it]Best trial: 34. Best value: 0.527169:  47%|████▋     | 47/100 [01:14<01:06,  1.25s/it]Best trial: 34. Best value: 0.527169:  47%|████▋     | 47/100 [01:15<01:06,  1.25s/it]Best trial: 34. Best value: 0.527169:  48%|████▊     | 48/100 [01:15<01:03,  1.22s/it]Best trial: 34. Best value: 0.527169:  48%|████▊     | 48/100 [01:16<01:03,  1.22s/it]Best trial: 34. Best value: 0.527169:  49%|████▉     | 49/100 [01:16<01:00,  1.19s/it]Best trial: 34. Best value: 0.527169:  49%|████▉     | 49/100 [01:18<01:00,  1.19s/it]Best trial: 34. Best value: 0.527169:  50%|█████     | 50/100 [01:18<01:12,  1.44s/it]Best trial: 34. Best value: 0.527169:  50%|█████     | 50/100 [01:19<01:12,  1.44s/it]Best trial: 34. Best value: 0.527169:  51%|█████     | 51/100 [01:19<00:59,  1.22s/it]Best trial: 34. Best value: 0.527169:  51%|█████     | 51/100 [01:20<00:59,  1.22s/it]Best trial: 34. Best value: 0.527169:  52%|█████▏    | 52/100 [01:20<00:58,  1.22s/it]Best trial: 34. Best value: 0.527169:  52%|█████▏    | 52/100 [01:21<00:58,  1.22s/it]Best trial: 34. Best value: 0.527169:  53%|█████▎    | 53/100 [01:21<01:03,  1.36s/it]Best trial: 34. Best value: 0.527169:  53%|█████▎    | 53/100 [01:23<01:03,  1.36s/it]Best trial: 34. Best value: 0.527169:  54%|█████▍    | 54/100 [01:23<01:04,  1.40s/it]Best trial: 34. Best value: 0.527169:  54%|█████▍    | 54/100 [01:24<01:04,  1.40s/it]Best trial: 34. Best value: 0.527169:  55%|█████▌    | 55/100 [01:24<00:57,  1.28s/it]Best trial: 34. Best value: 0.527169:  55%|█████▌    | 55/100 [01:25<00:57,  1.28s/it]Best trial: 34. Best value: 0.527169:  56%|█████▌    | 56/100 [01:25<00:56,  1.28s/it]Best trial: 34. Best value: 0.527169:  56%|█████▌    | 56/100 [01:26<00:56,  1.28s/it]Best trial: 34. Best value: 0.527169:  57%|█████▋    | 57/100 [01:26<00:51,  1.20s/it]Best trial: 34. Best value: 0.527169:  57%|█████▋    | 57/100 [01:28<00:51,  1.20s/it]Best trial: 34. Best value: 0.527169:  58%|█████▊    | 58/100 [01:28<00:52,  1.26s/it]Best trial: 34. Best value: 0.527169:  58%|█████▊    | 58/100 [01:29<00:52,  1.26s/it]Best trial: 34. Best value: 0.527169:  59%|█████▉    | 59/100 [01:29<00:51,  1.25s/it]Best trial: 34. Best value: 0.527169:  59%|█████▉    | 59/100 [01:31<00:51,  1.25s/it]Best trial: 34. Best value: 0.527169:  60%|██████    | 60/100 [01:31<00:56,  1.40s/it]Best trial: 34. Best value: 0.527169:  60%|██████    | 60/100 [01:33<00:56,  1.40s/it]Best trial: 34. Best value: 0.527169:  61%|██████    | 61/100 [01:33<01:03,  1.62s/it]Best trial: 34. Best value: 0.527169:  61%|██████    | 61/100 [01:35<01:03,  1.62s/it]Best trial: 34. Best value: 0.527169:  62%|██████▏   | 62/100 [01:35<01:08,  1.80s/it]Best trial: 34. Best value: 0.527169:  62%|██████▏   | 62/100 [01:37<01:08,  1.80s/it]Best trial: 34. Best value: 0.527169:  63%|██████▎   | 63/100 [01:37<01:08,  1.86s/it]Best trial: 34. Best value: 0.527169:  63%|██████▎   | 63/100 [01:39<01:08,  1.86s/it]Best trial: 34. Best value: 0.527169:  64%|██████▍   | 64/100 [01:39<01:10,  1.96s/it]Best trial: 34. Best value: 0.527169:  64%|██████▍   | 64/100 [01:41<01:10,  1.96s/it]Best trial: 34. Best value: 0.527169:  65%|██████▌   | 65/100 [01:41<01:10,  2.03s/it]Best trial: 34. Best value: 0.527169:  65%|██████▌   | 65/100 [01:43<01:10,  2.03s/it]Best trial: 34. Best value: 0.527169:  66%|██████▌   | 66/100 [01:43<01:02,  1.85s/it]Best trial: 34. Best value: 0.527169:  66%|██████▌   | 66/100 [01:45<01:02,  1.85s/it]Best trial: 34. Best value: 0.527169:  67%|██████▋   | 67/100 [01:45<01:01,  1.87s/it]Best trial: 34. Best value: 0.527169:  67%|██████▋   | 67/100 [01:47<01:01,  1.87s/it]Best trial: 34. Best value: 0.527169:  68%|██████▊   | 68/100 [01:47<01:04,  2.02s/it]Best trial: 34. Best value: 0.527169:  68%|██████▊   | 68/100 [01:49<01:04,  2.02s/it]Best trial: 34. Best value: 0.527169:  69%|██████▉   | 69/100 [01:49<01:02,  2.03s/it]Best trial: 34. Best value: 0.527169:  69%|██████▉   | 69/100 [01:50<01:02,  2.03s/it]Best trial: 34. Best value: 0.527169:  70%|███████   | 70/100 [01:50<00:52,  1.77s/it]Best trial: 34. Best value: 0.527169:  70%|███████   | 70/100 [01:52<00:52,  1.77s/it]Best trial: 34. Best value: 0.527169:  71%|███████   | 71/100 [01:52<00:49,  1.70s/it]Best trial: 34. Best value: 0.527169:  71%|███████   | 71/100 [01:53<00:49,  1.70s/it]Best trial: 34. Best value: 0.527169:  72%|███████▏  | 72/100 [01:53<00:43,  1.56s/it]Best trial: 34. Best value: 0.527169:  72%|███████▏  | 72/100 [01:55<00:43,  1.56s/it]Best trial: 34. Best value: 0.527169:  73%|███████▎  | 73/100 [01:55<00:42,  1.58s/it]Best trial: 34. Best value: 0.527169:  73%|███████▎  | 73/100 [01:57<00:42,  1.58s/it]Best trial: 34. Best value: 0.527169:  74%|███████▍  | 74/100 [01:57<00:44,  1.69s/it]Best trial: 34. Best value: 0.527169:  74%|███████▍  | 74/100 [01:58<00:44,  1.69s/it]Best trial: 34. Best value: 0.527169:  75%|███████▌  | 75/100 [01:58<00:40,  1.62s/it]Best trial: 34. Best value: 0.527169:  75%|███████▌  | 75/100 [01:59<00:40,  1.62s/it]Best trial: 34. Best value: 0.527169:  76%|███████▌  | 76/100 [01:59<00:36,  1.54s/it]Best trial: 34. Best value: 0.527169:  76%|███████▌  | 76/100 [02:01<00:36,  1.54s/it]Best trial: 34. Best value: 0.527169:  77%|███████▋  | 77/100 [02:01<00:36,  1.60s/it]Best trial: 34. Best value: 0.527169:  77%|███████▋  | 77/100 [02:02<00:36,  1.60s/it]Best trial: 34. Best value: 0.527169:  78%|███████▊  | 78/100 [02:02<00:33,  1.51s/it]Best trial: 34. Best value: 0.527169:  78%|███████▊  | 78/100 [02:04<00:33,  1.51s/it]Best trial: 34. Best value: 0.527169:  79%|███████▉  | 79/100 [02:04<00:32,  1.55s/it]Best trial: 34. Best value: 0.527169:  79%|███████▉  | 79/100 [02:06<00:32,  1.55s/it]Best trial: 34. Best value: 0.527169:  80%|████████  | 80/100 [02:06<00:33,  1.66s/it]Best trial: 34. Best value: 0.527169:  80%|████████  | 80/100 [02:08<00:33,  1.66s/it]Best trial: 34. Best value: 0.527169:  81%|████████  | 81/100 [02:08<00:31,  1.66s/it]Best trial: 34. Best value: 0.527169:  81%|████████  | 81/100 [02:09<00:31,  1.66s/it]Best trial: 34. Best value: 0.527169:  82%|████████▏ | 82/100 [02:09<00:30,  1.70s/it]Best trial: 34. Best value: 0.527169:  82%|████████▏ | 82/100 [02:11<00:30,  1.70s/it]Best trial: 34. Best value: 0.527169:  83%|████████▎ | 83/100 [02:11<00:26,  1.58s/it]Best trial: 34. Best value: 0.527169:  83%|████████▎ | 83/100 [02:12<00:26,  1.58s/it]Best trial: 34. Best value: 0.527169:  84%|████████▍ | 84/100 [02:12<00:24,  1.54s/it]Best trial: 34. Best value: 0.527169:  84%|████████▍ | 84/100 [02:14<00:24,  1.54s/it]Best trial: 34. Best value: 0.527169:  85%|████████▌ | 85/100 [02:14<00:23,  1.54s/it]Best trial: 34. Best value: 0.527169:  85%|████████▌ | 85/100 [02:16<00:23,  1.54s/it]Best trial: 34. Best value: 0.527169:  86%|████████▌ | 86/100 [02:16<00:24,  1.76s/it]Best trial: 34. Best value: 0.527169:  86%|████████▌ | 86/100 [02:17<00:24,  1.76s/it]Best trial: 34. Best value: 0.527169:  87%|████████▋ | 87/100 [02:17<00:19,  1.53s/it]Best trial: 34. Best value: 0.527169:  87%|████████▋ | 87/100 [02:18<00:19,  1.53s/it]Best trial: 34. Best value: 0.527169:  88%|████████▊ | 88/100 [02:18<00:17,  1.46s/it]Best trial: 34. Best value: 0.527169:  88%|████████▊ | 88/100 [02:20<00:17,  1.46s/it]Best trial: 34. Best value: 0.527169:  89%|████████▉ | 89/100 [02:20<00:15,  1.38s/it]Best trial: 34. Best value: 0.527169:  89%|████████▉ | 89/100 [02:21<00:15,  1.38s/it]Best trial: 34. Best value: 0.527169:  90%|█████████ | 90/100 [02:21<00:14,  1.40s/it]Best trial: 34. Best value: 0.527169:  90%|█████████ | 90/100 [02:23<00:14,  1.40s/it]Best trial: 34. Best value: 0.527169:  91%|█████████ | 91/100 [02:23<00:14,  1.64s/it]Best trial: 34. Best value: 0.527169:  91%|█████████ | 91/100 [02:25<00:14,  1.64s/it]Best trial: 34. Best value: 0.527169:  92%|█████████▏| 92/100 [02:25<00:12,  1.56s/it]Best trial: 34. Best value: 0.527169:  92%|█████████▏| 92/100 [02:26<00:12,  1.56s/it]Best trial: 34. Best value: 0.527169:  93%|█████████▎| 93/100 [02:26<00:11,  1.59s/it]Best trial: 34. Best value: 0.527169:  93%|█████████▎| 93/100 [02:28<00:11,  1.59s/it]Best trial: 34. Best value: 0.527169:  94%|█████████▍| 94/100 [02:28<00:10,  1.67s/it]Best trial: 34. Best value: 0.527169:  94%|█████████▍| 94/100 [02:30<00:10,  1.67s/it]Best trial: 34. Best value: 0.527169:  95%|█████████▌| 95/100 [02:30<00:08,  1.62s/it]Best trial: 34. Best value: 0.527169:  95%|█████████▌| 95/100 [02:31<00:08,  1.62s/it]Best trial: 34. Best value: 0.527169:  96%|█████████▌| 96/100 [02:31<00:06,  1.56s/it]Best trial: 34. Best value: 0.527169:  96%|█████████▌| 96/100 [02:33<00:06,  1.56s/it]Best trial: 34. Best value: 0.527169:  97%|█████████▋| 97/100 [02:33<00:04,  1.60s/it]Best trial: 34. Best value: 0.527169:  97%|█████████▋| 97/100 [02:35<00:04,  1.60s/it]Best trial: 34. Best value: 0.527169:  98%|█████████▊| 98/100 [02:35<00:03,  1.71s/it]Best trial: 34. Best value: 0.527169:  98%|█████████▊| 98/100 [02:36<00:03,  1.71s/it]Best trial: 34. Best value: 0.527169:  99%|█████████▉| 99/100 [02:36<00:01,  1.54s/it]Best trial: 34. Best value: 0.527169:  99%|█████████▉| 99/100 [02:37<00:01,  1.54s/it]Best trial: 34. Best value: 0.527169: 100%|██████████| 100/100 [02:37<00:00,  1.42s/it]Best trial: 34. Best value: 0.527169: 100%|██████████| 100/100 [02:37<00:00,  1.57s/it]
2025-12-01 00:59:33,298 - INFO - HPO Complete. Best AUPRC: 0.5272
2025-12-01 00:59:33,298 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.0015832468286333396, 'max_depth': 6, 'subsample': 0.6605153434149452, 'colsample_bytree': 0.6608303094747946, 'gamma': 2.384325258337488, 'reg_lambda': 0.06490722324971271, 'reg_alpha': 0.066232998843153}
2025-12-01 00:59:33,299 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 00:59:35,130 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: co2_only
2025-12-01 00:59:35,130 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:59:35,213 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:59:35,219 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:59:35,221 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:59:35,221 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 00:59:35,221 - INFO - Training model...
2025-12-01 00:59:37,000 - INFO - Evaluating model with bootstrapping...
2025-12-01 00:59:41,755 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 00:59:41,755 - INFO - AUROC: 0.7470 (0.6984 - 0.7844)
2025-12-01 00:59:41,755 - INFO - AUPRC: 0.5098 (0.4649 - 0.5944)
2025-12-01 00:59:41,756 - INFO - Brier Score: 0.1787 (0.1723 - 0.1865)
2025-12-01 00:59:41,756 - INFO - Accuracy: 0.7977 (0.7121 - 0.8390)
2025-12-01 00:59:41,756 - INFO - Precision: 0.5103 (0.4103 - 0.6240)
2025-12-01 00:59:41,756 - INFO - Sensitivity (Recall): 0.5175 (0.4413 - 0.6615)
2025-12-01 00:59:41,756 - INFO - F1-Score: 0.5139 (0.4632 - 0.5700)
2025-12-01 00:59:41,756 - INFO - Best Threshold: 0.5200 (0.4400 - 0.5600)
2025-12-01 00:59:41,756 - INFO - Specificity: 0.8707 (0.7340 - 0.9313)
2025-12-01 00:59:41,808 - INFO - Calculating SHAP values...
2025-12-01 00:59:43,406 - INFO - SHAP plots saved.
2025-12-01 00:59:43,408 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 00:59:44,579 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: awp_only
2025-12-01 00:59:44,580 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 00:59:44,664 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 00:59:44,672 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 00:59:44,674 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 00:59:44,674 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.46454:   0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.46454:   1%|          | 1/100 [00:00<01:29,  1.11it/s]Best trial: 0. Best value: 0.46454:   1%|          | 1/100 [00:01<01:29,  1.11it/s]Best trial: 0. Best value: 0.46454:   2%|▏         | 2/100 [00:01<01:20,  1.21it/s]Best trial: 2. Best value: 0.486656:   2%|▏         | 2/100 [00:03<01:20,  1.21it/s]Best trial: 2. Best value: 0.486656:   3%|▎         | 3/100 [00:03<01:51,  1.15s/it]Best trial: 3. Best value: 0.490597:   3%|▎         | 3/100 [00:05<01:51,  1.15s/it]Best trial: 3. Best value: 0.490597:   4%|▍         | 4/100 [00:05<02:32,  1.59s/it]Best trial: 3. Best value: 0.490597:   4%|▍         | 4/100 [00:06<02:32,  1.59s/it]Best trial: 3. Best value: 0.490597:   5%|▌         | 5/100 [00:06<02:24,  1.52s/it]Best trial: 3. Best value: 0.490597:   5%|▌         | 5/100 [00:09<02:24,  1.52s/it]Best trial: 3. Best value: 0.490597:   6%|▌         | 6/100 [00:09<03:03,  1.95s/it]Best trial: 3. Best value: 0.490597:   6%|▌         | 6/100 [00:13<03:03,  1.95s/it]Best trial: 3. Best value: 0.490597:   7%|▋         | 7/100 [00:13<04:00,  2.59s/it]Best trial: 3. Best value: 0.490597:   7%|▋         | 7/100 [00:14<04:00,  2.59s/it]Best trial: 3. Best value: 0.490597:   8%|▊         | 8/100 [00:14<03:17,  2.15s/it]Best trial: 3. Best value: 0.490597:   8%|▊         | 8/100 [00:16<03:17,  2.15s/it]Best trial: 3. Best value: 0.490597:   9%|▉         | 9/100 [00:16<02:51,  1.89s/it]Best trial: 3. Best value: 0.490597:   9%|▉         | 9/100 [00:16<02:51,  1.89s/it]Best trial: 3. Best value: 0.490597:  10%|█         | 10/100 [00:16<02:21,  1.58s/it]Best trial: 10. Best value: 0.493848:  10%|█         | 10/100 [00:19<02:21,  1.58s/it]Best trial: 10. Best value: 0.493848:  11%|█         | 11/100 [00:19<02:41,  1.81s/it]Best trial: 11. Best value: 0.49728:  11%|█         | 11/100 [00:21<02:41,  1.81s/it] Best trial: 11. Best value: 0.49728:  12%|█▏        | 12/100 [00:21<02:58,  2.02s/it]Best trial: 11. Best value: 0.49728:  12%|█▏        | 12/100 [00:23<02:58,  2.02s/it]Best trial: 11. Best value: 0.49728:  13%|█▎        | 13/100 [00:23<02:49,  1.95s/it]Best trial: 11. Best value: 0.49728:  13%|█▎        | 13/100 [00:25<02:49,  1.95s/it]Best trial: 11. Best value: 0.49728:  14%|█▍        | 14/100 [00:25<02:48,  1.96s/it]Best trial: 11. Best value: 0.49728:  14%|█▍        | 14/100 [00:28<02:48,  1.96s/it]Best trial: 11. Best value: 0.49728:  15%|█▌        | 15/100 [00:28<03:20,  2.36s/it]Best trial: 11. Best value: 0.49728:  15%|█▌        | 15/100 [00:30<03:20,  2.36s/it]Best trial: 11. Best value: 0.49728:  16%|█▌        | 16/100 [00:30<02:56,  2.10s/it]Best trial: 11. Best value: 0.49728:  16%|█▌        | 16/100 [00:31<02:56,  2.10s/it]Best trial: 11. Best value: 0.49728:  17%|█▋        | 17/100 [00:31<02:26,  1.76s/it]Best trial: 11. Best value: 0.49728:  17%|█▋        | 17/100 [00:33<02:26,  1.76s/it]Best trial: 11. Best value: 0.49728:  18%|█▊        | 18/100 [00:33<02:28,  1.81s/it]Best trial: 11. Best value: 0.49728:  18%|█▊        | 18/100 [00:36<02:28,  1.81s/it]Best trial: 11. Best value: 0.49728:  19%|█▉        | 19/100 [00:36<03:04,  2.28s/it]Best trial: 11. Best value: 0.49728:  19%|█▉        | 19/100 [00:40<03:04,  2.28s/it]Best trial: 11. Best value: 0.49728:  20%|██        | 20/100 [00:40<03:42,  2.78s/it]Best trial: 11. Best value: 0.49728:  20%|██        | 20/100 [00:43<03:42,  2.78s/it]Best trial: 11. Best value: 0.49728:  21%|██        | 21/100 [00:43<03:35,  2.72s/it]Best trial: 11. Best value: 0.49728:  21%|██        | 21/100 [00:45<03:35,  2.72s/it]Best trial: 11. Best value: 0.49728:  22%|██▏       | 22/100 [00:45<03:30,  2.70s/it]Best trial: 11. Best value: 0.49728:  22%|██▏       | 22/100 [00:47<03:30,  2.70s/it]Best trial: 11. Best value: 0.49728:  23%|██▎       | 23/100 [00:47<03:15,  2.54s/it]Best trial: 11. Best value: 0.49728:  23%|██▎       | 23/100 [00:49<03:15,  2.54s/it]Best trial: 11. Best value: 0.49728:  24%|██▍       | 24/100 [00:49<02:58,  2.34s/it]Best trial: 11. Best value: 0.49728:  24%|██▍       | 24/100 [00:52<02:58,  2.34s/it]Best trial: 11. Best value: 0.49728:  25%|██▌       | 25/100 [00:52<02:54,  2.33s/it]Best trial: 11. Best value: 0.49728:  25%|██▌       | 25/100 [00:54<02:54,  2.33s/it]Best trial: 11. Best value: 0.49728:  26%|██▌       | 26/100 [00:54<02:45,  2.24s/it]Best trial: 11. Best value: 0.49728:  26%|██▌       | 26/100 [00:57<02:45,  2.24s/it]Best trial: 11. Best value: 0.49728:  27%|██▋       | 27/100 [00:57<03:02,  2.50s/it]Best trial: 11. Best value: 0.49728:  27%|██▋       | 27/100 [01:00<03:02,  2.50s/it]Best trial: 11. Best value: 0.49728:  28%|██▊       | 28/100 [01:00<03:06,  2.58s/it]Best trial: 11. Best value: 0.49728:  28%|██▊       | 28/100 [01:02<03:06,  2.58s/it]Best trial: 11. Best value: 0.49728:  29%|██▉       | 29/100 [01:02<02:54,  2.46s/it]Best trial: 11. Best value: 0.49728:  29%|██▉       | 29/100 [01:05<02:54,  2.46s/it]Best trial: 11. Best value: 0.49728:  30%|███       | 30/100 [01:05<03:00,  2.57s/it]Best trial: 11. Best value: 0.49728:  30%|███       | 30/100 [01:06<03:00,  2.57s/it]Best trial: 11. Best value: 0.49728:  31%|███       | 31/100 [01:06<02:26,  2.13s/it]Best trial: 11. Best value: 0.49728:  31%|███       | 31/100 [01:08<02:26,  2.13s/it]Best trial: 11. Best value: 0.49728:  32%|███▏      | 32/100 [01:08<02:27,  2.17s/it]Best trial: 11. Best value: 0.49728:  32%|███▏      | 32/100 [01:10<02:27,  2.17s/it]Best trial: 11. Best value: 0.49728:  33%|███▎      | 33/100 [01:10<02:30,  2.24s/it]Best trial: 11. Best value: 0.49728:  33%|███▎      | 33/100 [01:13<02:30,  2.24s/it]Best trial: 11. Best value: 0.49728:  34%|███▍      | 34/100 [01:13<02:36,  2.37s/it]Best trial: 11. Best value: 0.49728:  34%|███▍      | 34/100 [01:14<02:36,  2.37s/it]Best trial: 11. Best value: 0.49728:  35%|███▌      | 35/100 [01:14<02:13,  2.06s/it]Best trial: 11. Best value: 0.49728:  35%|███▌      | 35/100 [01:18<02:13,  2.06s/it]Best trial: 11. Best value: 0.49728:  36%|███▌      | 36/100 [01:18<02:34,  2.41s/it]Best trial: 11. Best value: 0.49728:  36%|███▌      | 36/100 [01:22<02:34,  2.41s/it]Best trial: 11. Best value: 0.49728:  37%|███▋      | 37/100 [01:22<03:10,  3.03s/it]Best trial: 11. Best value: 0.49728:  37%|███▋      | 37/100 [01:24<03:10,  3.03s/it]Best trial: 11. Best value: 0.49728:  38%|███▊      | 38/100 [01:24<02:51,  2.77s/it]Best trial: 38. Best value: 0.497781:  38%|███▊      | 38/100 [01:27<02:51,  2.77s/it]Best trial: 38. Best value: 0.497781:  39%|███▉      | 39/100 [01:27<02:50,  2.80s/it]Best trial: 38. Best value: 0.497781:  39%|███▉      | 39/100 [01:30<02:50,  2.80s/it]Best trial: 38. Best value: 0.497781:  40%|████      | 40/100 [01:30<02:41,  2.69s/it]Best trial: 38. Best value: 0.497781:  40%|████      | 40/100 [01:35<02:41,  2.69s/it]Best trial: 38. Best value: 0.497781:  41%|████      | 41/100 [01:35<03:21,  3.42s/it]Best trial: 38. Best value: 0.497781:  41%|████      | 41/100 [01:39<03:21,  3.42s/it]Best trial: 38. Best value: 0.497781:  42%|████▏     | 42/100 [01:39<03:27,  3.57s/it]Best trial: 42. Best value: 0.502514:  42%|████▏     | 42/100 [01:42<03:27,  3.57s/it]Best trial: 42. Best value: 0.502514:  43%|████▎     | 43/100 [01:42<03:25,  3.60s/it]Best trial: 42. Best value: 0.502514:  43%|████▎     | 43/100 [01:45<03:25,  3.60s/it]Best trial: 42. Best value: 0.502514:  44%|████▍     | 44/100 [01:45<03:11,  3.41s/it]Best trial: 42. Best value: 0.502514:  44%|████▍     | 44/100 [01:49<03:11,  3.41s/it]Best trial: 42. Best value: 0.502514:  45%|████▌     | 45/100 [01:49<03:14,  3.53s/it]Best trial: 42. Best value: 0.502514:  45%|████▌     | 45/100 [01:50<03:14,  3.53s/it]Best trial: 42. Best value: 0.502514:  46%|████▌     | 46/100 [01:50<02:28,  2.76s/it]Best trial: 42. Best value: 0.502514:  46%|████▌     | 46/100 [01:52<02:28,  2.76s/it]Best trial: 42. Best value: 0.502514:  47%|████▋     | 47/100 [01:52<02:20,  2.65s/it]Best trial: 42. Best value: 0.502514:  47%|████▋     | 47/100 [01:55<02:20,  2.65s/it]Best trial: 42. Best value: 0.502514:  48%|████▊     | 48/100 [01:55<02:22,  2.73s/it]Best trial: 42. Best value: 0.502514:  48%|████▊     | 48/100 [01:59<02:22,  2.73s/it]Best trial: 42. Best value: 0.502514:  49%|████▉     | 49/100 [01:59<02:26,  2.88s/it]Best trial: 42. Best value: 0.502514:  49%|████▉     | 49/100 [02:00<02:26,  2.88s/it]Best trial: 42. Best value: 0.502514:  50%|█████     | 50/100 [02:00<01:56,  2.33s/it]Best trial: 42. Best value: 0.502514:  50%|█████     | 50/100 [02:00<01:56,  2.33s/it]Best trial: 42. Best value: 0.502514:  51%|█████     | 51/100 [02:00<01:32,  1.89s/it]Best trial: 42. Best value: 0.502514:  51%|█████     | 51/100 [02:05<01:32,  1.89s/it]Best trial: 42. Best value: 0.502514:  52%|█████▏    | 52/100 [02:05<02:05,  2.61s/it]Best trial: 42. Best value: 0.502514:  52%|█████▏    | 52/100 [02:09<02:05,  2.61s/it]Best trial: 42. Best value: 0.502514:  53%|█████▎    | 53/100 [02:09<02:21,  3.00s/it]Best trial: 42. Best value: 0.502514:  53%|█████▎    | 53/100 [02:11<02:21,  3.00s/it]Best trial: 42. Best value: 0.502514:  54%|█████▍    | 54/100 [02:11<02:15,  2.96s/it]Best trial: 42. Best value: 0.502514:  54%|█████▍    | 54/100 [02:15<02:15,  2.96s/it]Best trial: 42. Best value: 0.502514:  55%|█████▌    | 55/100 [02:15<02:17,  3.06s/it]Best trial: 42. Best value: 0.502514:  55%|█████▌    | 55/100 [02:18<02:17,  3.06s/it]Best trial: 42. Best value: 0.502514:  56%|█████▌    | 56/100 [02:18<02:18,  3.16s/it]Best trial: 42. Best value: 0.502514:  56%|█████▌    | 56/100 [02:23<02:18,  3.16s/it]Best trial: 42. Best value: 0.502514:  57%|█████▋    | 57/100 [02:23<02:34,  3.59s/it]Best trial: 42. Best value: 0.502514:  57%|█████▋    | 57/100 [02:25<02:34,  3.59s/it]Best trial: 42. Best value: 0.502514:  58%|█████▊    | 58/100 [02:25<02:07,  3.04s/it]Best trial: 42. Best value: 0.502514:  58%|█████▊    | 58/100 [02:28<02:07,  3.04s/it]Best trial: 42. Best value: 0.502514:  59%|█████▉    | 59/100 [02:28<02:12,  3.22s/it]Best trial: 42. Best value: 0.502514:  59%|█████▉    | 59/100 [02:30<02:12,  3.22s/it]Best trial: 42. Best value: 0.502514:  60%|██████    | 60/100 [02:30<01:56,  2.91s/it]Best trial: 42. Best value: 0.502514:  60%|██████    | 60/100 [02:33<01:56,  2.91s/it]Best trial: 42. Best value: 0.502514:  61%|██████    | 61/100 [02:33<01:52,  2.89s/it]Best trial: 42. Best value: 0.502514:  61%|██████    | 61/100 [02:36<01:52,  2.89s/it]Best trial: 42. Best value: 0.502514:  62%|██████▏   | 62/100 [02:36<01:52,  2.97s/it]Best trial: 42. Best value: 0.502514:  62%|██████▏   | 62/100 [02:38<01:52,  2.97s/it]Best trial: 42. Best value: 0.502514:  63%|██████▎   | 63/100 [02:38<01:39,  2.68s/it]Best trial: 42. Best value: 0.502514:  63%|██████▎   | 63/100 [02:41<01:39,  2.68s/it]Best trial: 42. Best value: 0.502514:  64%|██████▍   | 64/100 [02:41<01:37,  2.72s/it]Best trial: 42. Best value: 0.502514:  64%|██████▍   | 64/100 [02:44<01:37,  2.72s/it]Best trial: 42. Best value: 0.502514:  65%|██████▌   | 65/100 [02:44<01:35,  2.74s/it]Best trial: 42. Best value: 0.502514:  65%|██████▌   | 65/100 [02:47<01:35,  2.74s/it]Best trial: 42. Best value: 0.502514:  66%|██████▌   | 66/100 [02:47<01:31,  2.68s/it]Best trial: 42. Best value: 0.502514:  66%|██████▌   | 66/100 [02:48<01:31,  2.68s/it]Best trial: 42. Best value: 0.502514:  67%|██████▋   | 67/100 [02:48<01:17,  2.36s/it]Best trial: 42. Best value: 0.502514:  67%|██████▋   | 67/100 [02:51<01:17,  2.36s/it]Best trial: 42. Best value: 0.502514:  68%|██████▊   | 68/100 [02:51<01:19,  2.47s/it]Best trial: 42. Best value: 0.502514:  68%|██████▊   | 68/100 [02:54<01:19,  2.47s/it]Best trial: 42. Best value: 0.502514:  69%|██████▉   | 69/100 [02:54<01:23,  2.70s/it]Best trial: 42. Best value: 0.502514:  69%|██████▉   | 69/100 [02:58<01:23,  2.70s/it]Best trial: 42. Best value: 0.502514:  70%|███████   | 70/100 [02:58<01:28,  2.94s/it]Best trial: 42. Best value: 0.502514:  70%|███████   | 70/100 [02:58<01:28,  2.94s/it]Best trial: 42. Best value: 0.502514:  71%|███████   | 71/100 [02:58<01:07,  2.33s/it]Best trial: 42. Best value: 0.502514:  71%|███████   | 71/100 [03:01<01:07,  2.33s/it]Best trial: 42. Best value: 0.502514:  72%|███████▏  | 72/100 [03:01<01:05,  2.36s/it]Best trial: 42. Best value: 0.502514:  72%|███████▏  | 72/100 [03:04<01:05,  2.36s/it]Best trial: 42. Best value: 0.502514:  73%|███████▎  | 73/100 [03:04<01:06,  2.45s/it]Best trial: 42. Best value: 0.502514:  73%|███████▎  | 73/100 [03:07<01:06,  2.45s/it]Best trial: 42. Best value: 0.502514:  74%|███████▍  | 74/100 [03:07<01:07,  2.61s/it]Best trial: 42. Best value: 0.502514:  74%|███████▍  | 74/100 [03:10<01:07,  2.61s/it]Best trial: 42. Best value: 0.502514:  75%|███████▌  | 75/100 [03:10<01:10,  2.81s/it]Best trial: 42. Best value: 0.502514:  75%|███████▌  | 75/100 [03:12<01:10,  2.81s/it]Best trial: 42. Best value: 0.502514:  76%|███████▌  | 76/100 [03:12<01:03,  2.63s/it]Best trial: 42. Best value: 0.502514:  76%|███████▌  | 76/100 [03:14<01:03,  2.63s/it]Best trial: 42. Best value: 0.502514:  77%|███████▋  | 77/100 [03:14<00:58,  2.53s/it]Best trial: 42. Best value: 0.502514:  77%|███████▋  | 77/100 [03:17<00:58,  2.53s/it]Best trial: 42. Best value: 0.502514:  78%|███████▊  | 78/100 [03:17<00:56,  2.58s/it]Best trial: 78. Best value: 0.503314:  78%|███████▊  | 78/100 [03:19<00:56,  2.58s/it]Best trial: 78. Best value: 0.503314:  79%|███████▉  | 79/100 [03:19<00:53,  2.53s/it]Best trial: 78. Best value: 0.503314:  79%|███████▉  | 79/100 [03:22<00:53,  2.53s/it]Best trial: 78. Best value: 0.503314:  80%|████████  | 80/100 [03:22<00:51,  2.57s/it]Best trial: 78. Best value: 0.503314:  80%|████████  | 80/100 [03:26<00:51,  2.57s/it]Best trial: 78. Best value: 0.503314:  81%|████████  | 81/100 [03:26<00:53,  2.82s/it]Best trial: 78. Best value: 0.503314:  81%|████████  | 81/100 [03:27<00:53,  2.82s/it]Best trial: 78. Best value: 0.503314:  82%|████████▏ | 82/100 [03:27<00:44,  2.49s/it]Best trial: 78. Best value: 0.503314:  82%|████████▏ | 82/100 [03:29<00:44,  2.49s/it]Best trial: 78. Best value: 0.503314:  83%|████████▎ | 83/100 [03:29<00:39,  2.35s/it]Best trial: 78. Best value: 0.503314:  83%|████████▎ | 83/100 [03:31<00:39,  2.35s/it]Best trial: 78. Best value: 0.503314:  84%|████████▍ | 84/100 [03:31<00:33,  2.07s/it]Best trial: 78. Best value: 0.503314:  84%|████████▍ | 84/100 [03:34<00:33,  2.07s/it]Best trial: 78. Best value: 0.503314:  85%|████████▌ | 85/100 [03:34<00:35,  2.38s/it]Best trial: 78. Best value: 0.503314:  85%|████████▌ | 85/100 [03:36<00:35,  2.38s/it]Best trial: 78. Best value: 0.503314:  86%|████████▌ | 86/100 [03:36<00:32,  2.34s/it]Best trial: 78. Best value: 0.503314:  86%|████████▌ | 86/100 [03:38<00:32,  2.34s/it]Best trial: 78. Best value: 0.503314:  87%|████████▋ | 87/100 [03:38<00:29,  2.29s/it]Best trial: 78. Best value: 0.503314:  87%|████████▋ | 87/100 [03:42<00:29,  2.29s/it]Best trial: 78. Best value: 0.503314:  88%|████████▊ | 88/100 [03:42<00:33,  2.76s/it]Best trial: 78. Best value: 0.503314:  88%|████████▊ | 88/100 [03:44<00:33,  2.76s/it]Best trial: 78. Best value: 0.503314:  89%|████████▉ | 89/100 [03:44<00:28,  2.63s/it]Best trial: 78. Best value: 0.503314:  89%|████████▉ | 89/100 [03:47<00:28,  2.63s/it]Best trial: 78. Best value: 0.503314:  90%|█████████ | 90/100 [03:47<00:26,  2.62s/it]Best trial: 78. Best value: 0.503314:  90%|█████████ | 90/100 [03:48<00:26,  2.62s/it]Best trial: 78. Best value: 0.503314:  91%|█████████ | 91/100 [03:48<00:19,  2.18s/it]Best trial: 78. Best value: 0.503314:  91%|█████████ | 91/100 [03:51<00:19,  2.18s/it]Best trial: 78. Best value: 0.503314:  92%|█████████▏| 92/100 [03:51<00:19,  2.38s/it]Best trial: 78. Best value: 0.503314:  92%|█████████▏| 92/100 [03:53<00:19,  2.38s/it]Best trial: 78. Best value: 0.503314:  93%|█████████▎| 93/100 [03:53<00:15,  2.23s/it]Best trial: 78. Best value: 0.503314:  93%|█████████▎| 93/100 [03:56<00:15,  2.23s/it]Best trial: 78. Best value: 0.503314:  94%|█████████▍| 94/100 [03:56<00:14,  2.39s/it]Best trial: 78. Best value: 0.503314:  94%|█████████▍| 94/100 [03:59<00:14,  2.39s/it]Best trial: 78. Best value: 0.503314:  95%|█████████▌| 95/100 [03:59<00:13,  2.67s/it]Best trial: 78. Best value: 0.503314:  95%|█████████▌| 95/100 [04:02<00:13,  2.67s/it]Best trial: 78. Best value: 0.503314:  96%|█████████▌| 96/100 [04:02<00:11,  2.76s/it]Best trial: 78. Best value: 0.503314:  96%|█████████▌| 96/100 [04:05<00:11,  2.76s/it]Best trial: 78. Best value: 0.503314:  97%|█████████▋| 97/100 [04:05<00:08,  2.77s/it]Best trial: 78. Best value: 0.503314:  97%|█████████▋| 97/100 [04:08<00:08,  2.77s/it]Best trial: 78. Best value: 0.503314:  98%|█████████▊| 98/100 [04:08<00:05,  2.87s/it]Best trial: 78. Best value: 0.503314:  98%|█████████▊| 98/100 [04:12<00:05,  2.87s/it]Best trial: 78. Best value: 0.503314:  99%|█████████▉| 99/100 [04:12<00:03,  3.19s/it]Best trial: 78. Best value: 0.503314:  99%|█████████▉| 99/100 [04:16<00:03,  3.19s/it]Best trial: 78. Best value: 0.503314: 100%|██████████| 100/100 [04:16<00:00,  3.51s/it]Best trial: 78. Best value: 0.503314: 100%|██████████| 100/100 [04:16<00:00,  2.57s/it]
2025-12-01 01:04:01,211 - INFO - HPO Complete. Best AUPRC: 0.5033
2025-12-01 01:04:01,211 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.009266100403511394, 'max_depth': 9, 'subsample': 0.8888380890067953, 'colsample_bytree': 0.6859120796775273, 'gamma': 2.9799585840460505, 'reg_lambda': 0.0005015028539195452, 'reg_alpha': 0.00044151878864608855}
2025-12-01 01:04:01,211 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:04:03,062 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: awp_only
2025-12-01 01:04:03,063 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:04:03,150 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:04:03,157 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:04:03,159 - INFO - Data prepared. Train shape: (2761, 24), Test shape: (692, 24)
2025-12-01 01:04:03,159 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:04:03,159 - INFO - Training model...
2025-12-01 01:04:04,668 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:04:09,404 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:04:09,404 - INFO - AUROC: 0.7356 (0.6963 - 0.7758)
2025-12-01 01:04:09,404 - INFO - AUPRC: 0.4633 (0.4134 - 0.5466)
2025-12-01 01:04:09,404 - INFO - Brier Score: 0.1540 (0.1431 - 0.1665)
2025-12-01 01:04:09,404 - INFO - Accuracy: 0.7775 (0.7379 - 0.8289)
2025-12-01 01:04:09,404 - INFO - Precision: 0.4658 (0.4047 - 0.5682)
2025-12-01 01:04:09,404 - INFO - Sensitivity (Recall): 0.5245 (0.4338 - 0.6662)
2025-12-01 01:04:09,404 - INFO - F1-Score: 0.4934 (0.4586 - 0.5818)
2025-12-01 01:04:09,404 - INFO - Best Threshold: 0.4400 (0.3620 - 0.5560)
2025-12-01 01:04:09,404 - INFO - Specificity: 0.8434 (0.7610 - 0.9079)
2025-12-01 01:04:09,444 - INFO - Calculating SHAP values...
2025-12-01 01:04:11,011 - INFO - SHAP plots saved.
2025-12-01 01:04:11,013 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:04:12,256 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: all_waveforms
2025-12-01 01:04:12,256 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:04:12,341 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:04:12,362 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:04:12,365 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 01:04:12,365 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.57832:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.57832:   1%|          | 1/100 [00:03<06:09,  3.73s/it]Best trial: 0. Best value: 0.57832:   1%|          | 1/100 [00:09<06:09,  3.73s/it]Best trial: 0. Best value: 0.57832:   2%|▏         | 2/100 [00:09<08:29,  5.20s/it]Best trial: 0. Best value: 0.57832:   2%|▏         | 2/100 [00:19<08:29,  5.20s/it]Best trial: 0. Best value: 0.57832:   3%|▎         | 3/100 [00:19<11:22,  7.03s/it]Best trial: 0. Best value: 0.57832:   3%|▎         | 3/100 [00:21<11:22,  7.03s/it]Best trial: 0. Best value: 0.57832:   4%|▍         | 4/100 [00:21<08:30,  5.32s/it]Best trial: 0. Best value: 0.57832:   4%|▍         | 4/100 [00:25<08:30,  5.32s/it]Best trial: 0. Best value: 0.57832:   5%|▌         | 5/100 [00:25<07:34,  4.78s/it]Best trial: 0. Best value: 0.57832:   5%|▌         | 5/100 [00:30<07:34,  4.78s/it]Best trial: 0. Best value: 0.57832:   6%|▌         | 6/100 [00:30<07:20,  4.69s/it]Best trial: 0. Best value: 0.57832:   6%|▌         | 6/100 [00:37<07:20,  4.69s/it]Best trial: 0. Best value: 0.57832:   7%|▋         | 7/100 [00:37<08:37,  5.56s/it]Best trial: 7. Best value: 0.579331:   7%|▋         | 7/100 [00:43<08:37,  5.56s/it]Best trial: 7. Best value: 0.579331:   8%|▊         | 8/100 [00:43<08:55,  5.82s/it]Best trial: 7. Best value: 0.579331:   8%|▊         | 8/100 [00:58<08:55,  5.82s/it]Best trial: 7. Best value: 0.579331:   9%|▉         | 9/100 [00:58<12:51,  8.48s/it]Best trial: 7. Best value: 0.579331:   9%|▉         | 9/100 [00:59<12:51,  8.48s/it]Best trial: 7. Best value: 0.579331:  10%|█         | 10/100 [00:59<09:28,  6.32s/it]Best trial: 7. Best value: 0.579331:  10%|█         | 10/100 [01:02<09:28,  6.32s/it]Best trial: 7. Best value: 0.579331:  11%|█         | 11/100 [01:02<07:35,  5.12s/it]Best trial: 7. Best value: 0.579331:  11%|█         | 11/100 [01:05<07:35,  5.12s/it]Best trial: 7. Best value: 0.579331:  12%|█▏        | 12/100 [01:05<06:43,  4.58s/it]Best trial: 7. Best value: 0.579331:  12%|█▏        | 12/100 [01:12<06:43,  4.58s/it]Best trial: 7. Best value: 0.579331:  13%|█▎        | 13/100 [01:12<07:42,  5.32s/it]Best trial: 7. Best value: 0.579331:  13%|█▎        | 13/100 [01:14<07:42,  5.32s/it]Best trial: 7. Best value: 0.579331:  14%|█▍        | 14/100 [01:14<06:13,  4.35s/it]Best trial: 7. Best value: 0.579331:  14%|█▍        | 14/100 [01:19<06:13,  4.35s/it]Best trial: 7. Best value: 0.579331:  15%|█▌        | 15/100 [01:19<06:32,  4.61s/it]Best trial: 7. Best value: 0.579331:  15%|█▌        | 15/100 [01:26<06:32,  4.61s/it]Best trial: 7. Best value: 0.579331:  16%|█▌        | 16/100 [01:26<07:25,  5.30s/it]Best trial: 16. Best value: 0.585752:  16%|█▌        | 16/100 [01:34<07:25,  5.30s/it]Best trial: 16. Best value: 0.585752:  17%|█▋        | 17/100 [01:34<08:14,  5.96s/it]Best trial: 16. Best value: 0.585752:  17%|█▋        | 17/100 [01:44<08:14,  5.96s/it]Best trial: 16. Best value: 0.585752:  18%|█▊        | 18/100 [01:44<09:53,  7.24s/it]Best trial: 16. Best value: 0.585752:  18%|█▊        | 18/100 [02:04<09:53,  7.24s/it]Best trial: 16. Best value: 0.585752:  19%|█▉        | 19/100 [02:04<15:00, 11.12s/it]Best trial: 16. Best value: 0.585752:  19%|█▉        | 19/100 [02:06<15:00, 11.12s/it]Best trial: 16. Best value: 0.585752:  20%|██        | 20/100 [02:06<10:58,  8.23s/it]Best trial: 16. Best value: 0.585752:  20%|██        | 20/100 [02:14<10:58,  8.23s/it]Best trial: 16. Best value: 0.585752:  21%|██        | 21/100 [02:14<10:52,  8.26s/it]Best trial: 16. Best value: 0.585752:  21%|██        | 21/100 [02:18<10:52,  8.26s/it]Best trial: 16. Best value: 0.585752:  22%|██▏       | 22/100 [02:18<08:57,  6.89s/it]Best trial: 16. Best value: 0.585752:  22%|██▏       | 22/100 [02:21<08:57,  6.89s/it]Best trial: 16. Best value: 0.585752:  23%|██▎       | 23/100 [02:21<07:26,  5.79s/it]Best trial: 16. Best value: 0.585752:  23%|██▎       | 23/100 [02:27<07:26,  5.79s/it]Best trial: 16. Best value: 0.585752:  24%|██▍       | 24/100 [02:27<07:30,  5.93s/it]Best trial: 16. Best value: 0.585752:  24%|██▍       | 24/100 [02:32<07:30,  5.93s/it]Best trial: 16. Best value: 0.585752:  25%|██▌       | 25/100 [02:32<07:06,  5.69s/it]Best trial: 16. Best value: 0.585752:  25%|██▌       | 25/100 [02:39<07:06,  5.69s/it]Best trial: 16. Best value: 0.585752:  26%|██▌       | 26/100 [02:39<07:27,  6.05s/it]Best trial: 16. Best value: 0.585752:  26%|██▌       | 26/100 [02:43<07:27,  6.05s/it]Best trial: 16. Best value: 0.585752:  27%|██▋       | 27/100 [02:43<06:41,  5.50s/it]Best trial: 16. Best value: 0.585752:  27%|██▋       | 27/100 [02:47<06:41,  5.50s/it]Best trial: 16. Best value: 0.585752:  28%|██▊       | 28/100 [02:47<05:50,  4.87s/it]Best trial: 16. Best value: 0.585752:  28%|██▊       | 28/100 [02:55<05:50,  4.87s/it]Best trial: 16. Best value: 0.585752:  29%|██▉       | 29/100 [02:55<07:05,  5.99s/it]Best trial: 16. Best value: 0.585752:  29%|██▉       | 29/100 [03:08<07:05,  5.99s/it]Best trial: 16. Best value: 0.585752:  30%|███       | 30/100 [03:08<09:14,  7.92s/it]Best trial: 16. Best value: 0.585752:  30%|███       | 30/100 [03:26<09:14,  7.92s/it]Best trial: 16. Best value: 0.585752:  31%|███       | 31/100 [03:26<12:40, 11.02s/it]Best trial: 16. Best value: 0.585752:  31%|███       | 31/100 [03:38<12:40, 11.02s/it]Best trial: 16. Best value: 0.585752:  32%|███▏      | 32/100 [03:38<12:55, 11.41s/it]Best trial: 16. Best value: 0.585752:  32%|███▏      | 32/100 [03:48<12:55, 11.41s/it]Best trial: 16. Best value: 0.585752:  33%|███▎      | 33/100 [03:48<12:12, 10.93s/it]Best trial: 33. Best value: 0.587602:  33%|███▎      | 33/100 [03:59<12:12, 10.93s/it]Best trial: 33. Best value: 0.587602:  34%|███▍      | 34/100 [03:59<12:09, 11.05s/it]Best trial: 33. Best value: 0.587602:  34%|███▍      | 34/100 [04:06<12:09, 11.05s/it]Best trial: 33. Best value: 0.587602:  35%|███▌      | 35/100 [04:06<10:27,  9.65s/it]Best trial: 33. Best value: 0.587602:  35%|███▌      | 35/100 [04:17<10:27,  9.65s/it]Best trial: 33. Best value: 0.587602:  36%|███▌      | 36/100 [04:17<10:37,  9.96s/it]Best trial: 33. Best value: 0.587602:  36%|███▌      | 36/100 [04:30<10:37,  9.96s/it]Best trial: 33. Best value: 0.587602:  37%|███▋      | 37/100 [04:30<11:26, 10.89s/it]Best trial: 33. Best value: 0.587602:  37%|███▋      | 37/100 [04:40<11:26, 10.89s/it]Best trial: 33. Best value: 0.587602:  38%|███▊      | 38/100 [04:40<11:11, 10.83s/it]Best trial: 33. Best value: 0.587602:  38%|███▊      | 38/100 [04:50<11:11, 10.83s/it]Best trial: 33. Best value: 0.587602:  39%|███▉      | 39/100 [04:50<10:45, 10.59s/it]Best trial: 33. Best value: 0.587602:  39%|███▉      | 39/100 [04:59<10:45, 10.59s/it]Best trial: 33. Best value: 0.587602:  40%|████      | 40/100 [04:59<09:55,  9.93s/it]Best trial: 33. Best value: 0.587602:  40%|████      | 40/100 [05:10<09:55,  9.93s/it]Best trial: 33. Best value: 0.587602:  41%|████      | 41/100 [05:10<10:09, 10.32s/it]Best trial: 33. Best value: 0.587602:  41%|████      | 41/100 [05:22<10:09, 10.32s/it]Best trial: 33. Best value: 0.587602:  42%|████▏     | 42/100 [05:22<10:23, 10.75s/it]Best trial: 33. Best value: 0.587602:  42%|████▏     | 42/100 [05:34<10:23, 10.75s/it]Best trial: 33. Best value: 0.587602:  43%|████▎     | 43/100 [05:34<10:44, 11.31s/it]Best trial: 33. Best value: 0.587602:  43%|████▎     | 43/100 [05:42<10:44, 11.31s/it]Best trial: 33. Best value: 0.587602:  44%|████▍     | 44/100 [05:42<09:25, 10.09s/it]Best trial: 33. Best value: 0.587602:  44%|████▍     | 44/100 [05:55<09:25, 10.09s/it]Best trial: 33. Best value: 0.587602:  45%|████▌     | 45/100 [05:55<10:04, 10.98s/it]Best trial: 33. Best value: 0.587602:  45%|████▌     | 45/100 [06:07<10:04, 10.98s/it]Best trial: 33. Best value: 0.587602:  46%|████▌     | 46/100 [06:07<10:22, 11.53s/it]Best trial: 33. Best value: 0.587602:  46%|████▌     | 46/100 [06:16<10:22, 11.53s/it]Best trial: 33. Best value: 0.587602:  47%|████▋     | 47/100 [06:16<09:29, 10.74s/it]Best trial: 33. Best value: 0.587602:  47%|████▋     | 47/100 [06:22<09:29, 10.74s/it]Best trial: 33. Best value: 0.587602:  48%|████▊     | 48/100 [06:22<08:00,  9.24s/it]Best trial: 33. Best value: 0.587602:  48%|████▊     | 48/100 [06:24<08:00,  9.24s/it]Best trial: 33. Best value: 0.587602:  49%|████▉     | 49/100 [06:24<05:54,  6.94s/it]Best trial: 33. Best value: 0.587602:  49%|████▉     | 49/100 [06:41<05:54,  6.94s/it]Best trial: 33. Best value: 0.587602:  50%|█████     | 50/100 [06:41<08:28, 10.17s/it]Best trial: 33. Best value: 0.587602:  50%|█████     | 50/100 [06:52<08:28, 10.17s/it]Best trial: 33. Best value: 0.587602:  51%|█████     | 51/100 [06:52<08:31, 10.45s/it]Best trial: 51. Best value: 0.589332:  51%|█████     | 51/100 [07:04<08:31, 10.45s/it]Best trial: 51. Best value: 0.589332:  52%|█████▏    | 52/100 [07:04<08:38, 10.79s/it]Best trial: 51. Best value: 0.589332:  52%|█████▏    | 52/100 [07:14<08:38, 10.79s/it]Best trial: 51. Best value: 0.589332:  53%|█████▎    | 53/100 [07:14<08:21, 10.67s/it]Best trial: 51. Best value: 0.589332:  53%|█████▎    | 53/100 [07:26<08:21, 10.67s/it]Best trial: 51. Best value: 0.589332:  54%|█████▍    | 54/100 [07:26<08:16, 10.79s/it]Best trial: 51. Best value: 0.589332:  54%|█████▍    | 54/100 [07:35<08:16, 10.79s/it]Best trial: 51. Best value: 0.589332:  55%|█████▌    | 55/100 [07:35<07:54, 10.54s/it]Best trial: 51. Best value: 0.589332:  55%|█████▌    | 55/100 [07:48<07:54, 10.54s/it]Best trial: 51. Best value: 0.589332:  56%|█████▌    | 56/100 [07:48<08:03, 11.00s/it]Best trial: 51. Best value: 0.589332:  56%|█████▌    | 56/100 [07:53<08:03, 11.00s/it]Best trial: 51. Best value: 0.589332:  57%|█████▋    | 57/100 [07:53<06:45,  9.44s/it]Best trial: 51. Best value: 0.589332:  57%|█████▋    | 57/100 [08:02<06:45,  9.44s/it]Best trial: 51. Best value: 0.589332:  58%|█████▊    | 58/100 [08:02<06:20,  9.07s/it]Best trial: 51. Best value: 0.589332:  58%|█████▊    | 58/100 [08:09<06:20,  9.07s/it]Best trial: 51. Best value: 0.589332:  59%|█████▉    | 59/100 [08:09<05:47,  8.48s/it]Best trial: 51. Best value: 0.589332:  59%|█████▉    | 59/100 [08:12<05:47,  8.48s/it]Best trial: 51. Best value: 0.589332:  60%|██████    | 60/100 [08:12<04:33,  6.83s/it]Best trial: 51. Best value: 0.589332:  60%|██████    | 60/100 [08:17<04:33,  6.83s/it]Best trial: 51. Best value: 0.589332:  61%|██████    | 61/100 [08:17<04:07,  6.35s/it]Best trial: 51. Best value: 0.589332:  61%|██████    | 61/100 [08:27<04:07,  6.35s/it]Best trial: 51. Best value: 0.589332:  62%|██████▏   | 62/100 [08:27<04:40,  7.38s/it]Best trial: 62. Best value: 0.596412:  62%|██████▏   | 62/100 [08:35<04:40,  7.38s/it]Best trial: 62. Best value: 0.596412:  63%|██████▎   | 63/100 [08:35<04:47,  7.76s/it]Best trial: 62. Best value: 0.596412:  63%|██████▎   | 63/100 [08:43<04:47,  7.76s/it]Best trial: 62. Best value: 0.596412:  64%|██████▍   | 64/100 [08:43<04:36,  7.67s/it]Best trial: 62. Best value: 0.596412:  64%|██████▍   | 64/100 [08:50<04:36,  7.67s/it]Best trial: 62. Best value: 0.596412:  65%|██████▌   | 65/100 [08:50<04:27,  7.64s/it]Best trial: 62. Best value: 0.596412:  65%|██████▌   | 65/100 [08:59<04:27,  7.64s/it]Best trial: 62. Best value: 0.596412:  66%|██████▌   | 66/100 [08:59<04:30,  7.95s/it]Best trial: 62. Best value: 0.596412:  66%|██████▌   | 66/100 [09:13<04:30,  7.95s/it]Best trial: 62. Best value: 0.596412:  67%|██████▋   | 67/100 [09:13<05:18,  9.65s/it]Best trial: 62. Best value: 0.596412:  67%|██████▋   | 67/100 [09:23<05:18,  9.65s/it]Best trial: 62. Best value: 0.596412:  68%|██████▊   | 68/100 [09:23<05:11,  9.73s/it]Best trial: 62. Best value: 0.596412:  68%|██████▊   | 68/100 [09:26<05:11,  9.73s/it]Best trial: 62. Best value: 0.596412:  69%|██████▉   | 69/100 [09:26<04:03,  7.86s/it]Best trial: 62. Best value: 0.596412:  69%|██████▉   | 69/100 [09:34<04:03,  7.86s/it]Best trial: 62. Best value: 0.596412:  70%|███████   | 70/100 [09:34<04:00,  8.01s/it]Best trial: 62. Best value: 0.596412:  70%|███████   | 70/100 [09:40<04:00,  8.01s/it]Best trial: 62. Best value: 0.596412:  71%|███████   | 71/100 [09:40<03:28,  7.20s/it]Best trial: 62. Best value: 0.596412:  71%|███████   | 71/100 [09:47<03:28,  7.20s/it]Best trial: 62. Best value: 0.596412:  72%|███████▏  | 72/100 [09:47<03:21,  7.20s/it]Best trial: 62. Best value: 0.596412:  72%|███████▏  | 72/100 [09:55<03:21,  7.20s/it]Best trial: 62. Best value: 0.596412:  73%|███████▎  | 73/100 [09:55<03:25,  7.62s/it]Best trial: 62. Best value: 0.596412:  73%|███████▎  | 73/100 [10:07<03:25,  7.62s/it]Best trial: 62. Best value: 0.596412:  74%|███████▍  | 74/100 [10:07<03:46,  8.70s/it]Best trial: 62. Best value: 0.596412:  74%|███████▍  | 74/100 [10:15<03:46,  8.70s/it]Best trial: 62. Best value: 0.596412:  75%|███████▌  | 75/100 [10:15<03:35,  8.62s/it]Best trial: 62. Best value: 0.596412:  75%|███████▌  | 75/100 [10:24<03:35,  8.62s/it]Best trial: 62. Best value: 0.596412:  76%|███████▌  | 76/100 [10:24<03:25,  8.58s/it]Best trial: 62. Best value: 0.596412:  76%|███████▌  | 76/100 [10:30<03:25,  8.58s/it]Best trial: 62. Best value: 0.596412:  77%|███████▋  | 77/100 [10:30<03:01,  7.91s/it]Best trial: 62. Best value: 0.596412:  77%|███████▋  | 77/100 [10:36<03:01,  7.91s/it]Best trial: 62. Best value: 0.596412:  78%|███████▊  | 78/100 [10:36<02:38,  7.22s/it]Best trial: 62. Best value: 0.596412:  78%|███████▊  | 78/100 [10:44<02:38,  7.22s/it]Best trial: 62. Best value: 0.596412:  79%|███████▉  | 79/100 [10:44<02:36,  7.43s/it]Best trial: 62. Best value: 0.596412:  79%|███████▉  | 79/100 [10:51<02:36,  7.43s/it]Best trial: 62. Best value: 0.596412:  80%|████████  | 80/100 [10:51<02:31,  7.58s/it]Best trial: 62. Best value: 0.596412:  80%|████████  | 80/100 [10:59<02:31,  7.58s/it]Best trial: 62. Best value: 0.596412:  81%|████████  | 81/100 [10:59<02:25,  7.66s/it]Best trial: 62. Best value: 0.596412:  81%|████████  | 81/100 [11:08<02:25,  7.66s/it]Best trial: 62. Best value: 0.596412:  82%|████████▏ | 82/100 [11:08<02:22,  7.93s/it]Best trial: 62. Best value: 0.596412:  82%|████████▏ | 82/100 [11:18<02:22,  7.93s/it]Best trial: 62. Best value: 0.596412:  83%|████████▎ | 83/100 [11:18<02:24,  8.52s/it]Best trial: 62. Best value: 0.596412:  83%|████████▎ | 83/100 [11:24<02:24,  8.52s/it]Best trial: 62. Best value: 0.596412:  84%|████████▍ | 84/100 [11:24<02:07,  7.97s/it]Best trial: 62. Best value: 0.596412:  84%|████████▍ | 84/100 [11:35<02:07,  7.97s/it]Best trial: 62. Best value: 0.596412:  85%|████████▌ | 85/100 [11:35<02:09,  8.64s/it]Best trial: 62. Best value: 0.596412:  85%|████████▌ | 85/100 [11:45<02:09,  8.64s/it]Best trial: 62. Best value: 0.596412:  86%|████████▌ | 86/100 [11:45<02:08,  9.15s/it]Best trial: 62. Best value: 0.596412:  86%|████████▌ | 86/100 [11:52<02:08,  9.15s/it]Best trial: 62. Best value: 0.596412:  87%|████████▋ | 87/100 [11:52<01:49,  8.39s/it]Best trial: 62. Best value: 0.596412:  87%|████████▋ | 87/100 [12:05<01:49,  8.39s/it]Best trial: 62. Best value: 0.596412:  88%|████████▊ | 88/100 [12:05<02:00, 10.04s/it]Best trial: 62. Best value: 0.596412:  88%|████████▊ | 88/100 [12:19<02:00, 10.04s/it]Best trial: 62. Best value: 0.596412:  89%|████████▉ | 89/100 [12:19<02:01, 11.07s/it]Best trial: 62. Best value: 0.596412:  89%|████████▉ | 89/100 [12:25<02:01, 11.07s/it]Best trial: 62. Best value: 0.596412:  90%|█████████ | 90/100 [12:25<01:35,  9.54s/it]Best trial: 62. Best value: 0.596412:  90%|█████████ | 90/100 [12:36<01:35,  9.54s/it]Best trial: 62. Best value: 0.596412:  91%|█████████ | 91/100 [12:36<01:29,  9.91s/it]Best trial: 62. Best value: 0.596412:  91%|█████████ | 91/100 [12:52<01:29,  9.91s/it]Best trial: 62. Best value: 0.596412:  92%|█████████▏| 92/100 [12:52<01:33, 11.73s/it]Best trial: 62. Best value: 0.596412:  92%|█████████▏| 92/100 [13:04<01:33, 11.73s/it]Best trial: 62. Best value: 0.596412:  93%|█████████▎| 93/100 [13:04<01:23, 11.97s/it]Best trial: 62. Best value: 0.596412:  93%|█████████▎| 93/100 [13:12<01:23, 11.97s/it]Best trial: 62. Best value: 0.596412:  94%|█████████▍| 94/100 [13:12<01:03, 10.63s/it]Best trial: 62. Best value: 0.596412:  94%|█████████▍| 94/100 [13:23<01:03, 10.63s/it]Best trial: 62. Best value: 0.596412:  95%|█████████▌| 95/100 [13:23<00:54, 10.91s/it]Best trial: 62. Best value: 0.596412:  95%|█████████▌| 95/100 [13:45<00:54, 10.91s/it]Best trial: 62. Best value: 0.596412:  96%|█████████▌| 96/100 [13:45<00:56, 14.10s/it]Best trial: 62. Best value: 0.596412:  96%|█████████▌| 96/100 [13:55<00:56, 14.10s/it]Best trial: 62. Best value: 0.596412:  97%|█████████▋| 97/100 [13:55<00:38, 12.93s/it]Best trial: 62. Best value: 0.596412:  97%|█████████▋| 97/100 [14:05<00:38, 12.93s/it]Best trial: 62. Best value: 0.596412:  98%|█████████▊| 98/100 [14:05<00:24, 12.03s/it]Best trial: 62. Best value: 0.596412:  98%|█████████▊| 98/100 [14:23<00:24, 12.03s/it]Best trial: 62. Best value: 0.596412:  99%|█████████▉| 99/100 [14:23<00:13, 13.70s/it]Best trial: 62. Best value: 0.596412:  99%|█████████▉| 99/100 [14:26<00:13, 13.70s/it]Best trial: 62. Best value: 0.596412: 100%|██████████| 100/100 [14:26<00:00, 10.78s/it]Best trial: 62. Best value: 0.596412: 100%|██████████| 100/100 [14:26<00:00,  8.67s/it]
2025-12-01 01:18:39,360 - INFO - HPO Complete. Best AUPRC: 0.5964
2025-12-01 01:18:39,360 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.04466970310714412, 'max_depth': 9, 'subsample': 0.6605900948091484, 'colsample_bytree': 0.7886771487253816, 'gamma': 0.30556768193745365, 'reg_lambda': 3.212123120567723e-05, 'reg_alpha': 3.30459678807265e-06}
2025-12-01 01:18:39,361 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:18:41,407 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: all_waveforms
2025-12-01 01:18:41,408 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:18:41,495 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:18:41,516 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:18:41,520 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 01:18:41,520 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:18:41,520 - INFO - Training model...
2025-12-01 01:18:44,766 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:18:49,861 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:18:49,861 - INFO - AUROC: 0.7883 (0.7469 - 0.8284)
2025-12-01 01:18:49,861 - INFO - AUPRC: 0.5700 (0.4999 - 0.6650)
2025-12-01 01:18:49,861 - INFO - Brier Score: 0.1305 (0.1151 - 0.1493)
2025-12-01 01:18:49,861 - INFO - Accuracy: 0.7919 (0.7653 - 0.8454)
2025-12-01 01:18:49,861 - INFO - Precision: 0.4972 (0.4630 - 0.6603)
2025-12-01 01:18:49,861 - INFO - Sensitivity (Recall): 0.6294 (0.4430 - 0.6714)
2025-12-01 01:18:49,861 - INFO - F1-Score: 0.5556 (0.5156 - 0.6241)
2025-12-01 01:18:49,861 - INFO - Best Threshold: 0.1900 (0.1660 - 0.3520)
2025-12-01 01:18:49,861 - INFO - Specificity: 0.8342 (0.7979 - 0.9317)
2025-12-01 01:18:49,887 - INFO - Calculating SHAP values...
2025-12-01 01:18:51,324 - INFO - SHAP plots saved.
2025-12-01 01:18:51,325 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:18:52,494 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-12-01 01:18:52,494 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:18:52,576 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:18:52,612 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:18:52,623 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 01:18:52,623 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.700253:   0%|          | 0/100 [00:05<?, ?it/s]Best trial: 0. Best value: 0.700253:   1%|          | 1/100 [00:05<09:02,  5.48s/it]Best trial: 0. Best value: 0.700253:   1%|          | 1/100 [00:09<09:02,  5.48s/it]Best trial: 0. Best value: 0.700253:   2%|▏         | 2/100 [00:09<07:22,  4.52s/it]Best trial: 0. Best value: 0.700253:   2%|▏         | 2/100 [00:16<07:22,  4.52s/it]Best trial: 0. Best value: 0.700253:   3%|▎         | 3/100 [00:16<09:08,  5.65s/it]Best trial: 3. Best value: 0.704411:   3%|▎         | 3/100 [00:24<09:08,  5.65s/it]Best trial: 3. Best value: 0.704411:   4%|▍         | 4/100 [00:24<10:26,  6.53s/it]Best trial: 3. Best value: 0.704411:   4%|▍         | 4/100 [00:28<10:26,  6.53s/it]Best trial: 3. Best value: 0.704411:   5%|▌         | 5/100 [00:28<09:05,  5.74s/it]Best trial: 5. Best value: 0.714294:   5%|▌         | 5/100 [00:34<09:05,  5.74s/it]Best trial: 5. Best value: 0.714294:   6%|▌         | 6/100 [00:34<09:07,  5.82s/it]Best trial: 5. Best value: 0.714294:   6%|▌         | 6/100 [00:42<09:07,  5.82s/it]Best trial: 5. Best value: 0.714294:   7%|▋         | 7/100 [00:42<10:11,  6.58s/it]Best trial: 5. Best value: 0.714294:   7%|▋         | 7/100 [00:52<10:11,  6.58s/it]Best trial: 5. Best value: 0.714294:   8%|▊         | 8/100 [00:52<11:30,  7.50s/it]Best trial: 5. Best value: 0.714294:   8%|▊         | 8/100 [01:07<11:30,  7.50s/it]Best trial: 5. Best value: 0.714294:   9%|▉         | 9/100 [01:07<15:01,  9.90s/it]Best trial: 5. Best value: 0.714294:   9%|▉         | 9/100 [01:24<15:01,  9.90s/it]Best trial: 5. Best value: 0.714294:  10%|█         | 10/100 [01:24<18:12, 12.13s/it]Best trial: 5. Best value: 0.714294:  10%|█         | 10/100 [01:26<18:12, 12.13s/it]Best trial: 5. Best value: 0.714294:  11%|█         | 11/100 [01:26<13:28,  9.08s/it]Best trial: 11. Best value: 0.715544:  11%|█         | 11/100 [01:31<13:28,  9.08s/it]Best trial: 11. Best value: 0.715544:  12%|█▏        | 12/100 [01:31<11:34,  7.89s/it]Best trial: 11. Best value: 0.715544:  12%|█▏        | 12/100 [01:37<11:34,  7.89s/it]Best trial: 11. Best value: 0.715544:  13%|█▎        | 13/100 [01:37<10:31,  7.26s/it]Best trial: 11. Best value: 0.715544:  13%|█▎        | 13/100 [01:41<10:31,  7.26s/it]Best trial: 11. Best value: 0.715544:  14%|█▍        | 14/100 [01:41<08:46,  6.12s/it]Best trial: 11. Best value: 0.715544:  14%|█▍        | 14/100 [01:43<08:46,  6.12s/it]Best trial: 11. Best value: 0.715544:  15%|█▌        | 15/100 [01:43<07:11,  5.08s/it]Best trial: 11. Best value: 0.715544:  15%|█▌        | 15/100 [01:52<07:11,  5.08s/it]Best trial: 11. Best value: 0.715544:  16%|█▌        | 16/100 [01:52<08:28,  6.05s/it]Best trial: 11. Best value: 0.715544:  16%|█▌        | 16/100 [01:55<08:28,  6.05s/it]Best trial: 11. Best value: 0.715544:  17%|█▋        | 17/100 [01:55<07:19,  5.30s/it]Best trial: 11. Best value: 0.715544:  17%|█▋        | 17/100 [02:00<07:19,  5.30s/it]Best trial: 11. Best value: 0.715544:  18%|█▊        | 18/100 [02:00<06:57,  5.09s/it]Best trial: 18. Best value: 0.717962:  18%|█▊        | 18/100 [02:08<06:57,  5.09s/it]Best trial: 18. Best value: 0.717962:  19%|█▉        | 19/100 [02:08<08:19,  6.17s/it]Best trial: 18. Best value: 0.717962:  19%|█▉        | 19/100 [02:15<08:19,  6.17s/it]Best trial: 18. Best value: 0.717962:  20%|██        | 20/100 [02:15<08:20,  6.26s/it]Best trial: 18. Best value: 0.717962:  20%|██        | 20/100 [02:19<08:20,  6.26s/it]Best trial: 18. Best value: 0.717962:  21%|██        | 21/100 [02:19<07:31,  5.71s/it]Best trial: 18. Best value: 0.717962:  21%|██        | 21/100 [02:23<07:31,  5.71s/it]Best trial: 18. Best value: 0.717962:  22%|██▏       | 22/100 [02:23<06:35,  5.07s/it]Best trial: 18. Best value: 0.717962:  22%|██▏       | 22/100 [02:29<06:35,  5.07s/it]Best trial: 18. Best value: 0.717962:  23%|██▎       | 23/100 [02:29<06:56,  5.41s/it]Best trial: 18. Best value: 0.717962:  23%|██▎       | 23/100 [02:35<06:56,  5.41s/it]Best trial: 18. Best value: 0.717962:  24%|██▍       | 24/100 [02:35<06:55,  5.47s/it]Best trial: 24. Best value: 0.720751:  24%|██▍       | 24/100 [02:38<06:55,  5.47s/it]Best trial: 24. Best value: 0.720751:  25%|██▌       | 25/100 [02:38<05:59,  4.79s/it]Best trial: 25. Best value: 0.726458:  25%|██▌       | 25/100 [02:41<05:59,  4.79s/it]Best trial: 25. Best value: 0.726458:  26%|██▌       | 26/100 [02:41<05:18,  4.31s/it]Best trial: 25. Best value: 0.726458:  26%|██▌       | 26/100 [02:44<05:18,  4.31s/it]Best trial: 25. Best value: 0.726458:  27%|██▋       | 27/100 [02:44<04:40,  3.84s/it]Best trial: 25. Best value: 0.726458:  27%|██▋       | 27/100 [02:47<04:40,  3.84s/it]Best trial: 25. Best value: 0.726458:  28%|██▊       | 28/100 [02:47<04:22,  3.65s/it]Best trial: 25. Best value: 0.726458:  28%|██▊       | 28/100 [02:49<04:22,  3.65s/it]Best trial: 25. Best value: 0.726458:  29%|██▉       | 29/100 [02:49<03:44,  3.16s/it]Best trial: 25. Best value: 0.726458:  29%|██▉       | 29/100 [02:52<03:44,  3.16s/it]Best trial: 25. Best value: 0.726458:  30%|███       | 30/100 [02:52<03:40,  3.15s/it]Best trial: 25. Best value: 0.726458:  30%|███       | 30/100 [02:57<03:40,  3.15s/it]Best trial: 25. Best value: 0.726458:  31%|███       | 31/100 [02:57<04:03,  3.52s/it]Best trial: 25. Best value: 0.726458:  31%|███       | 31/100 [03:00<04:03,  3.52s/it]Best trial: 25. Best value: 0.726458:  32%|███▏      | 32/100 [03:00<04:03,  3.58s/it]Best trial: 25. Best value: 0.726458:  32%|███▏      | 32/100 [03:04<04:03,  3.58s/it]Best trial: 25. Best value: 0.726458:  33%|███▎      | 33/100 [03:04<03:53,  3.49s/it]Best trial: 25. Best value: 0.726458:  33%|███▎      | 33/100 [03:07<03:53,  3.49s/it]Best trial: 25. Best value: 0.726458:  34%|███▍      | 34/100 [03:07<03:41,  3.36s/it]Best trial: 25. Best value: 0.726458:  34%|███▍      | 34/100 [03:12<03:41,  3.36s/it]Best trial: 25. Best value: 0.726458:  35%|███▌      | 35/100 [03:12<04:15,  3.93s/it]Best trial: 25. Best value: 0.726458:  35%|███▌      | 35/100 [03:17<04:15,  3.93s/it]Best trial: 25. Best value: 0.726458:  36%|███▌      | 36/100 [03:17<04:35,  4.30s/it]Best trial: 25. Best value: 0.726458:  36%|███▌      | 36/100 [03:19<04:35,  4.30s/it]Best trial: 25. Best value: 0.726458:  37%|███▋      | 37/100 [03:19<03:53,  3.71s/it]Best trial: 25. Best value: 0.726458:  37%|███▋      | 37/100 [03:22<03:53,  3.71s/it]Best trial: 25. Best value: 0.726458:  38%|███▊      | 38/100 [03:22<03:37,  3.52s/it]Best trial: 25. Best value: 0.726458:  38%|███▊      | 38/100 [03:28<03:37,  3.52s/it]Best trial: 25. Best value: 0.726458:  39%|███▉      | 39/100 [03:28<04:17,  4.22s/it]Best trial: 25. Best value: 0.726458:  39%|███▉      | 39/100 [03:33<04:17,  4.22s/it]Best trial: 25. Best value: 0.726458:  40%|████      | 40/100 [03:33<04:28,  4.48s/it]Best trial: 25. Best value: 0.726458:  40%|████      | 40/100 [03:39<04:28,  4.48s/it]Best trial: 25. Best value: 0.726458:  41%|████      | 41/100 [03:39<04:44,  4.82s/it]Best trial: 25. Best value: 0.726458:  41%|████      | 41/100 [03:42<04:44,  4.82s/it]Best trial: 25. Best value: 0.726458:  42%|████▏     | 42/100 [03:42<04:13,  4.36s/it]Best trial: 25. Best value: 0.726458:  42%|████▏     | 42/100 [03:46<04:13,  4.36s/it]Best trial: 25. Best value: 0.726458:  43%|████▎     | 43/100 [03:46<03:52,  4.08s/it]Best trial: 25. Best value: 0.726458:  43%|████▎     | 43/100 [03:48<03:52,  4.08s/it]Best trial: 25. Best value: 0.726458:  44%|████▍     | 44/100 [03:48<03:22,  3.62s/it]Best trial: 25. Best value: 0.726458:  44%|████▍     | 44/100 [03:52<03:22,  3.62s/it]Best trial: 25. Best value: 0.726458:  45%|████▌     | 45/100 [03:52<03:15,  3.55s/it]Best trial: 25. Best value: 0.726458:  45%|████▌     | 45/100 [03:54<03:15,  3.55s/it]Best trial: 25. Best value: 0.726458:  46%|████▌     | 46/100 [03:54<02:56,  3.28s/it]Best trial: 25. Best value: 0.726458:  46%|████▌     | 46/100 [04:00<02:56,  3.28s/it]Best trial: 25. Best value: 0.726458:  47%|████▋     | 47/100 [04:00<03:25,  3.88s/it]Best trial: 25. Best value: 0.726458:  47%|████▋     | 47/100 [04:03<03:25,  3.88s/it]Best trial: 25. Best value: 0.726458:  48%|████▊     | 48/100 [04:03<03:10,  3.66s/it]Best trial: 25. Best value: 0.726458:  48%|████▊     | 48/100 [04:11<03:10,  3.66s/it]Best trial: 25. Best value: 0.726458:  49%|████▉     | 49/100 [04:11<04:18,  5.08s/it]Best trial: 25. Best value: 0.726458:  49%|████▉     | 49/100 [04:14<04:18,  5.08s/it]Best trial: 25. Best value: 0.726458:  50%|█████     | 50/100 [04:14<03:34,  4.30s/it]Best trial: 25. Best value: 0.726458:  50%|█████     | 50/100 [04:17<03:34,  4.30s/it]Best trial: 25. Best value: 0.726458:  51%|█████     | 51/100 [04:17<03:19,  4.07s/it]Best trial: 25. Best value: 0.726458:  51%|█████     | 51/100 [04:20<03:19,  4.07s/it]Best trial: 25. Best value: 0.726458:  52%|█████▏    | 52/100 [04:20<03:02,  3.80s/it]Best trial: 25. Best value: 0.726458:  52%|█████▏    | 52/100 [04:24<03:02,  3.80s/it]Best trial: 25. Best value: 0.726458:  53%|█████▎    | 53/100 [04:24<02:51,  3.65s/it]Best trial: 25. Best value: 0.726458:  53%|█████▎    | 53/100 [04:26<02:51,  3.65s/it]Best trial: 25. Best value: 0.726458:  54%|█████▍    | 54/100 [04:26<02:33,  3.34s/it]Best trial: 25. Best value: 0.726458:  54%|█████▍    | 54/100 [04:30<02:33,  3.34s/it]Best trial: 25. Best value: 0.726458:  55%|█████▌    | 55/100 [04:30<02:35,  3.45s/it]Best trial: 25. Best value: 0.726458:  55%|█████▌    | 55/100 [04:33<02:35,  3.45s/it]Best trial: 25. Best value: 0.726458:  56%|█████▌    | 56/100 [04:33<02:26,  3.34s/it]Best trial: 25. Best value: 0.726458:  56%|█████▌    | 56/100 [04:36<02:26,  3.34s/it]Best trial: 25. Best value: 0.726458:  57%|█████▋    | 57/100 [04:36<02:17,  3.20s/it]Best trial: 25. Best value: 0.726458:  57%|█████▋    | 57/100 [04:43<02:17,  3.20s/it]Best trial: 25. Best value: 0.726458:  58%|█████▊    | 58/100 [04:43<03:02,  4.34s/it]Best trial: 25. Best value: 0.726458:  58%|█████▊    | 58/100 [04:45<03:02,  4.34s/it]Best trial: 25. Best value: 0.726458:  59%|█████▉    | 59/100 [04:45<02:33,  3.74s/it]Best trial: 25. Best value: 0.726458:  59%|█████▉    | 59/100 [04:48<02:33,  3.74s/it]Best trial: 25. Best value: 0.726458:  60%|██████    | 60/100 [04:48<02:16,  3.40s/it]Best trial: 25. Best value: 0.726458:  60%|██████    | 60/100 [04:54<02:16,  3.40s/it]Best trial: 25. Best value: 0.726458:  61%|██████    | 61/100 [04:54<02:46,  4.26s/it]Best trial: 61. Best value: 0.726553:  61%|██████    | 61/100 [04:57<02:46,  4.26s/it]Best trial: 61. Best value: 0.726553:  62%|██████▏   | 62/100 [04:57<02:29,  3.94s/it]Best trial: 61. Best value: 0.726553:  62%|██████▏   | 62/100 [05:00<02:29,  3.94s/it]Best trial: 61. Best value: 0.726553:  63%|██████▎   | 63/100 [05:00<02:14,  3.63s/it]Best trial: 61. Best value: 0.726553:  63%|██████▎   | 63/100 [05:06<02:14,  3.63s/it]Best trial: 61. Best value: 0.726553:  64%|██████▍   | 64/100 [05:06<02:31,  4.21s/it]Best trial: 61. Best value: 0.726553:  64%|██████▍   | 64/100 [05:08<02:31,  4.21s/it]Best trial: 61. Best value: 0.726553:  65%|██████▌   | 65/100 [05:08<02:09,  3.69s/it]Best trial: 61. Best value: 0.726553:  65%|██████▌   | 65/100 [05:11<02:09,  3.69s/it]Best trial: 61. Best value: 0.726553:  66%|██████▌   | 66/100 [05:11<02:00,  3.53s/it]Best trial: 61. Best value: 0.726553:  66%|██████▌   | 66/100 [05:17<02:00,  3.53s/it]Best trial: 61. Best value: 0.726553:  67%|██████▋   | 67/100 [05:17<02:14,  4.07s/it]Best trial: 61. Best value: 0.726553:  67%|██████▋   | 67/100 [05:21<02:14,  4.07s/it]Best trial: 61. Best value: 0.726553:  68%|██████▊   | 68/100 [05:21<02:08,  4.01s/it]Best trial: 61. Best value: 0.726553:  68%|██████▊   | 68/100 [05:23<02:08,  4.01s/it]Best trial: 61. Best value: 0.726553:  69%|██████▉   | 69/100 [05:23<01:52,  3.64s/it]Best trial: 61. Best value: 0.726553:  69%|██████▉   | 69/100 [05:27<01:52,  3.64s/it]Best trial: 61. Best value: 0.726553:  70%|███████   | 70/100 [05:27<01:52,  3.76s/it]Best trial: 61. Best value: 0.726553:  70%|███████   | 70/100 [05:32<01:52,  3.76s/it]Best trial: 61. Best value: 0.726553:  71%|███████   | 71/100 [05:32<01:58,  4.09s/it]Best trial: 61. Best value: 0.726553:  71%|███████   | 71/100 [05:35<01:58,  4.09s/it]Best trial: 61. Best value: 0.726553:  72%|███████▏  | 72/100 [05:35<01:45,  3.79s/it]Best trial: 61. Best value: 0.726553:  72%|███████▏  | 72/100 [05:38<01:45,  3.79s/it]Best trial: 61. Best value: 0.726553:  73%|███████▎  | 73/100 [05:38<01:37,  3.60s/it]Best trial: 61. Best value: 0.726553:  73%|███████▎  | 73/100 [05:42<01:37,  3.60s/it]Best trial: 61. Best value: 0.726553:  74%|███████▍  | 74/100 [05:42<01:29,  3.45s/it]Best trial: 61. Best value: 0.726553:  74%|███████▍  | 74/100 [05:45<01:29,  3.45s/it]Best trial: 61. Best value: 0.726553:  75%|███████▌  | 75/100 [05:45<01:27,  3.52s/it]Best trial: 61. Best value: 0.726553:  75%|███████▌  | 75/100 [05:51<01:27,  3.52s/it]Best trial: 61. Best value: 0.726553:  76%|███████▌  | 76/100 [05:51<01:37,  4.05s/it]Best trial: 61. Best value: 0.726553:  76%|███████▌  | 76/100 [05:54<01:37,  4.05s/it]Best trial: 61. Best value: 0.726553:  77%|███████▋  | 77/100 [05:54<01:25,  3.74s/it]Best trial: 61. Best value: 0.726553:  77%|███████▋  | 77/100 [05:57<01:25,  3.74s/it]Best trial: 61. Best value: 0.726553:  78%|███████▊  | 78/100 [05:57<01:20,  3.68s/it]Best trial: 61. Best value: 0.726553:  78%|███████▊  | 78/100 [06:03<01:20,  3.68s/it]Best trial: 61. Best value: 0.726553:  79%|███████▉  | 79/100 [06:03<01:33,  4.46s/it]Best trial: 61. Best value: 0.726553:  79%|███████▉  | 79/100 [06:07<01:33,  4.46s/it]Best trial: 61. Best value: 0.726553:  80%|████████  | 80/100 [06:07<01:21,  4.08s/it]Best trial: 61. Best value: 0.726553:  80%|████████  | 80/100 [06:11<01:21,  4.08s/it]Best trial: 61. Best value: 0.726553:  81%|████████  | 81/100 [06:11<01:20,  4.25s/it]Best trial: 61. Best value: 0.726553:  81%|████████  | 81/100 [06:14<01:20,  4.25s/it]Best trial: 61. Best value: 0.726553:  82%|████████▏ | 82/100 [06:14<01:10,  3.93s/it]Best trial: 61. Best value: 0.726553:  82%|████████▏ | 82/100 [06:17<01:10,  3.93s/it]Best trial: 61. Best value: 0.726553:  83%|████████▎ | 83/100 [06:17<00:59,  3.53s/it]Best trial: 61. Best value: 0.726553:  83%|████████▎ | 83/100 [06:20<00:59,  3.53s/it]Best trial: 61. Best value: 0.726553:  84%|████████▍ | 84/100 [06:20<00:55,  3.47s/it]Best trial: 84. Best value: 0.727039:  84%|████████▍ | 84/100 [06:24<00:55,  3.47s/it]Best trial: 84. Best value: 0.727039:  85%|████████▌ | 85/100 [06:24<00:52,  3.52s/it]Best trial: 84. Best value: 0.727039:  85%|████████▌ | 85/100 [06:28<00:52,  3.52s/it]Best trial: 84. Best value: 0.727039:  86%|████████▌ | 86/100 [06:28<00:51,  3.70s/it]Best trial: 84. Best value: 0.727039:  86%|████████▌ | 86/100 [06:33<00:51,  3.70s/it]Best trial: 84. Best value: 0.727039:  87%|████████▋ | 87/100 [06:33<00:52,  4.01s/it]Best trial: 84. Best value: 0.727039:  87%|████████▋ | 87/100 [06:39<00:52,  4.01s/it]Best trial: 84. Best value: 0.727039:  88%|████████▊ | 88/100 [06:39<00:57,  4.75s/it]Best trial: 84. Best value: 0.727039:  88%|████████▊ | 88/100 [06:42<00:57,  4.75s/it]Best trial: 84. Best value: 0.727039:  89%|████████▉ | 89/100 [06:42<00:45,  4.17s/it]Best trial: 89. Best value: 0.729122:  89%|████████▉ | 89/100 [06:45<00:45,  4.17s/it]Best trial: 89. Best value: 0.729122:  90%|█████████ | 90/100 [06:45<00:39,  3.93s/it]Best trial: 89. Best value: 0.729122:  90%|█████████ | 90/100 [06:57<00:39,  3.93s/it]Best trial: 89. Best value: 0.729122:  91%|█████████ | 91/100 [06:57<00:55,  6.22s/it]Best trial: 89. Best value: 0.729122:  91%|█████████ | 91/100 [07:01<00:55,  6.22s/it]Best trial: 89. Best value: 0.729122:  92%|█████████▏| 92/100 [07:01<00:43,  5.39s/it]Best trial: 89. Best value: 0.729122:  92%|█████████▏| 92/100 [07:05<00:43,  5.39s/it]Best trial: 89. Best value: 0.729122:  93%|█████████▎| 93/100 [07:05<00:34,  4.99s/it]Best trial: 89. Best value: 0.729122:  93%|█████████▎| 93/100 [07:08<00:34,  4.99s/it]Best trial: 89. Best value: 0.729122:  94%|█████████▍| 94/100 [07:08<00:27,  4.64s/it]Best trial: 89. Best value: 0.729122:  94%|█████████▍| 94/100 [07:11<00:27,  4.64s/it]Best trial: 89. Best value: 0.729122:  95%|█████████▌| 95/100 [07:11<00:19,  4.00s/it]Best trial: 89. Best value: 0.729122:  95%|█████████▌| 95/100 [07:15<00:19,  4.00s/it]Best trial: 89. Best value: 0.729122:  96%|█████████▌| 96/100 [07:15<00:16,  4.13s/it]Best trial: 89. Best value: 0.729122:  96%|█████████▌| 96/100 [07:19<00:16,  4.13s/it]Best trial: 89. Best value: 0.729122:  97%|█████████▋| 97/100 [07:19<00:11,  3.98s/it]Best trial: 89. Best value: 0.729122:  97%|█████████▋| 97/100 [07:23<00:11,  3.98s/it]Best trial: 89. Best value: 0.729122:  98%|█████████▊| 98/100 [07:23<00:08,  4.03s/it]Best trial: 89. Best value: 0.729122:  98%|█████████▊| 98/100 [07:32<00:08,  4.03s/it]Best trial: 89. Best value: 0.729122:  99%|█████████▉| 99/100 [07:32<00:05,  5.41s/it]Best trial: 89. Best value: 0.729122:  99%|█████████▉| 99/100 [07:36<00:05,  5.41s/it]Best trial: 89. Best value: 0.729122: 100%|██████████| 100/100 [07:36<00:00,  5.08s/it]Best trial: 89. Best value: 0.729122: 100%|██████████| 100/100 [07:36<00:00,  4.57s/it]
2025-12-01 01:26:29,170 - INFO - HPO Complete. Best AUPRC: 0.7291
2025-12-01 01:26:29,171 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.052760842411335336, 'max_depth': 3, 'subsample': 0.8980156338348618, 'colsample_bytree': 0.8229549617906701, 'gamma': 1.999483948463863, 'reg_lambda': 2.399402813604199e-05, 'reg_alpha': 0.0001748877535813279}
2025-12-01 01:26:29,171 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:26:31,094 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_waveforms
2025-12-01 01:26:31,094 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:26:31,178 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:26:31,214 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:26:31,226 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 01:26:31,226 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:26:31,226 - INFO - Training model...
2025-12-01 01:26:33,055 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:26:38,658 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:26:38,658 - INFO - AUROC: 0.8798 (0.8528 - 0.9088)
2025-12-01 01:26:38,658 - INFO - AUPRC: 0.7447 (0.6882 - 0.7996)
2025-12-01 01:26:38,658 - INFO - Brier Score: 0.1011 (0.0883 - 0.1161)
2025-12-01 01:26:38,658 - INFO - Accuracy: 0.8757 (0.8416 - 0.8994)
2025-12-01 01:26:38,658 - INFO - Precision: 0.7280 (0.6458 - 0.8265)
2025-12-01 01:26:38,658 - INFO - Sensitivity (Recall): 0.6364 (0.5462 - 0.7512)
2025-12-01 01:26:38,658 - INFO - F1-Score: 0.6791 (0.6264 - 0.7355)
2025-12-01 01:26:38,658 - INFO - Best Threshold: 0.5500 (0.3820 - 0.6440)
2025-12-01 01:26:38,658 - INFO - Specificity: 0.9381 (0.8799 - 0.9648)
2025-12-01 01:26:38,673 - INFO - Calculating SHAP values...
2025-12-01 01:26:39,805 - INFO - SHAP plots saved.
2025-12-01 01:26:39,806 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:26:40,990 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: ventilator_only
2025-12-01 01:26:40,990 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:26:41,075 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:26:41,087 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:26:41,089 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-12-01 01:26:41,090 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.537533:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.537533:   1%|          | 1/100 [00:02<03:18,  2.01s/it]Best trial: 1. Best value: 0.556948:   1%|          | 1/100 [00:03<03:18,  2.01s/it]Best trial: 1. Best value: 0.556948:   2%|▏         | 2/100 [00:03<03:14,  1.99s/it]Best trial: 1. Best value: 0.556948:   2%|▏         | 2/100 [00:05<03:14,  1.99s/it]Best trial: 1. Best value: 0.556948:   3%|▎         | 3/100 [00:05<02:48,  1.74s/it]Best trial: 1. Best value: 0.556948:   3%|▎         | 3/100 [00:08<02:48,  1.74s/it]Best trial: 1. Best value: 0.556948:   4%|▍         | 4/100 [00:08<03:53,  2.43s/it]Best trial: 1. Best value: 0.556948:   4%|▍         | 4/100 [00:13<03:53,  2.43s/it]Best trial: 1. Best value: 0.556948:   5%|▌         | 5/100 [00:13<04:55,  3.11s/it]Best trial: 1. Best value: 0.556948:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]Best trial: 1. Best value: 0.556948:   6%|▌         | 6/100 [00:15<04:12,  2.68s/it]Best trial: 1. Best value: 0.556948:   6%|▌         | 6/100 [00:19<04:12,  2.68s/it]Best trial: 1. Best value: 0.556948:   7%|▋         | 7/100 [00:19<04:52,  3.15s/it]Best trial: 7. Best value: 0.557042:   7%|▋         | 7/100 [00:20<04:52,  3.15s/it]Best trial: 7. Best value: 0.557042:   8%|▊         | 8/100 [00:20<04:03,  2.64s/it]Best trial: 7. Best value: 0.557042:   8%|▊         | 8/100 [00:24<04:03,  2.64s/it]Best trial: 7. Best value: 0.557042:   9%|▉         | 9/100 [00:24<04:19,  2.85s/it]Best trial: 7. Best value: 0.557042:   9%|▉         | 9/100 [00:30<04:19,  2.85s/it]Best trial: 7. Best value: 0.557042:  10%|█         | 10/100 [00:30<05:48,  3.87s/it]Best trial: 7. Best value: 0.557042:  10%|█         | 10/100 [00:31<05:48,  3.87s/it]Best trial: 7. Best value: 0.557042:  11%|█         | 11/100 [00:31<04:35,  3.10s/it]Best trial: 7. Best value: 0.557042:  11%|█         | 11/100 [00:32<04:35,  3.10s/it]Best trial: 7. Best value: 0.557042:  12%|█▏        | 12/100 [00:32<03:34,  2.44s/it]Best trial: 7. Best value: 0.557042:  12%|█▏        | 12/100 [00:33<03:34,  2.44s/it]Best trial: 7. Best value: 0.557042:  13%|█▎        | 13/100 [00:33<03:07,  2.15s/it]Best trial: 13. Best value: 0.563694:  13%|█▎        | 13/100 [00:36<03:07,  2.15s/it]Best trial: 13. Best value: 0.563694:  14%|█▍        | 14/100 [00:36<03:23,  2.36s/it]Best trial: 13. Best value: 0.563694:  14%|█▍        | 14/100 [00:39<03:23,  2.36s/it]Best trial: 13. Best value: 0.563694:  15%|█▌        | 15/100 [00:39<03:20,  2.36s/it]Best trial: 15. Best value: 0.566244:  15%|█▌        | 15/100 [00:41<03:20,  2.36s/it]Best trial: 15. Best value: 0.566244:  16%|█▌        | 16/100 [00:41<03:13,  2.30s/it]Best trial: 15. Best value: 0.566244:  16%|█▌        | 16/100 [00:42<03:13,  2.30s/it]Best trial: 15. Best value: 0.566244:  17%|█▋        | 17/100 [00:42<02:49,  2.05s/it]Best trial: 15. Best value: 0.566244:  17%|█▋        | 17/100 [00:46<02:49,  2.05s/it]Best trial: 15. Best value: 0.566244:  18%|█▊        | 18/100 [00:46<03:24,  2.49s/it]Best trial: 15. Best value: 0.566244:  18%|█▊        | 18/100 [00:48<03:24,  2.49s/it]Best trial: 15. Best value: 0.566244:  19%|█▉        | 19/100 [00:48<03:11,  2.36s/it]Best trial: 15. Best value: 0.566244:  19%|█▉        | 19/100 [00:50<03:11,  2.36s/it]Best trial: 15. Best value: 0.566244:  20%|██        | 20/100 [00:50<03:04,  2.30s/it]Best trial: 15. Best value: 0.566244:  20%|██        | 20/100 [00:54<03:04,  2.30s/it]Best trial: 15. Best value: 0.566244:  21%|██        | 21/100 [00:54<03:40,  2.79s/it]Best trial: 15. Best value: 0.566244:  21%|██        | 21/100 [00:57<03:40,  2.79s/it]Best trial: 15. Best value: 0.566244:  22%|██▏       | 22/100 [00:57<03:41,  2.84s/it]Best trial: 15. Best value: 0.566244:  22%|██▏       | 22/100 [01:00<03:41,  2.84s/it]Best trial: 15. Best value: 0.566244:  23%|██▎       | 23/100 [01:00<03:45,  2.93s/it]Best trial: 15. Best value: 0.566244:  23%|██▎       | 23/100 [01:03<03:45,  2.93s/it]Best trial: 15. Best value: 0.566244:  24%|██▍       | 24/100 [01:03<03:47,  3.00s/it]Best trial: 15. Best value: 0.566244:  24%|██▍       | 24/100 [01:07<03:47,  3.00s/it]Best trial: 15. Best value: 0.566244:  25%|██▌       | 25/100 [01:07<03:53,  3.11s/it]Best trial: 15. Best value: 0.566244:  25%|██▌       | 25/100 [01:08<03:53,  3.11s/it]Best trial: 15. Best value: 0.566244:  26%|██▌       | 26/100 [01:08<03:16,  2.66s/it]Best trial: 15. Best value: 0.566244:  26%|██▌       | 26/100 [01:11<03:16,  2.66s/it]Best trial: 15. Best value: 0.566244:  27%|██▋       | 27/100 [01:11<03:23,  2.78s/it]Best trial: 15. Best value: 0.566244:  27%|██▋       | 27/100 [01:14<03:23,  2.78s/it]Best trial: 15. Best value: 0.566244:  28%|██▊       | 28/100 [01:14<03:26,  2.87s/it]Best trial: 15. Best value: 0.566244:  28%|██▊       | 28/100 [01:17<03:26,  2.87s/it]Best trial: 15. Best value: 0.566244:  29%|██▉       | 29/100 [01:17<03:12,  2.72s/it]Best trial: 15. Best value: 0.566244:  29%|██▉       | 29/100 [01:21<03:12,  2.72s/it]Best trial: 15. Best value: 0.566244:  30%|███       | 30/100 [01:21<03:35,  3.07s/it]Best trial: 15. Best value: 0.566244:  30%|███       | 30/100 [01:23<03:35,  3.07s/it]Best trial: 15. Best value: 0.566244:  31%|███       | 31/100 [01:23<03:25,  2.98s/it]Best trial: 15. Best value: 0.566244:  31%|███       | 31/100 [01:25<03:25,  2.98s/it]Best trial: 15. Best value: 0.566244:  32%|███▏      | 32/100 [01:25<02:55,  2.59s/it]Best trial: 15. Best value: 0.566244:  32%|███▏      | 32/100 [01:27<02:55,  2.59s/it]Best trial: 15. Best value: 0.566244:  33%|███▎      | 33/100 [01:27<02:40,  2.39s/it]Best trial: 15. Best value: 0.566244:  33%|███▎      | 33/100 [01:29<02:40,  2.39s/it]Best trial: 15. Best value: 0.566244:  34%|███▍      | 34/100 [01:29<02:34,  2.34s/it]Best trial: 15. Best value: 0.566244:  34%|███▍      | 34/100 [01:31<02:34,  2.34s/it]Best trial: 15. Best value: 0.566244:  35%|███▌      | 35/100 [01:31<02:23,  2.21s/it]Best trial: 15. Best value: 0.566244:  35%|███▌      | 35/100 [01:33<02:23,  2.21s/it]Best trial: 15. Best value: 0.566244:  36%|███▌      | 36/100 [01:33<02:18,  2.17s/it]Best trial: 15. Best value: 0.566244:  36%|███▌      | 36/100 [01:37<02:18,  2.17s/it]Best trial: 15. Best value: 0.566244:  37%|███▋      | 37/100 [01:37<02:38,  2.52s/it]Best trial: 15. Best value: 0.566244:  37%|███▋      | 37/100 [01:39<02:38,  2.52s/it]Best trial: 15. Best value: 0.566244:  38%|███▊      | 38/100 [01:39<02:32,  2.47s/it]Best trial: 15. Best value: 0.566244:  38%|███▊      | 38/100 [01:42<02:32,  2.47s/it]Best trial: 15. Best value: 0.566244:  39%|███▉      | 39/100 [01:42<02:37,  2.59s/it]Best trial: 15. Best value: 0.566244:  39%|███▉      | 39/100 [01:46<02:37,  2.59s/it]Best trial: 15. Best value: 0.566244:  40%|████      | 40/100 [01:46<03:06,  3.10s/it]Best trial: 15. Best value: 0.566244:  40%|████      | 40/100 [01:48<03:06,  3.10s/it]Best trial: 15. Best value: 0.566244:  41%|████      | 41/100 [01:48<02:33,  2.61s/it]Best trial: 15. Best value: 0.566244:  41%|████      | 41/100 [01:49<02:33,  2.61s/it]Best trial: 15. Best value: 0.566244:  42%|████▏     | 42/100 [01:49<02:20,  2.42s/it]Best trial: 15. Best value: 0.566244:  42%|████▏     | 42/100 [01:51<02:20,  2.42s/it]Best trial: 15. Best value: 0.566244:  43%|████▎     | 43/100 [01:51<02:08,  2.25s/it]Best trial: 15. Best value: 0.566244:  43%|████▎     | 43/100 [01:53<02:08,  2.25s/it]Best trial: 15. Best value: 0.566244:  44%|████▍     | 44/100 [01:53<02:02,  2.19s/it]Best trial: 15. Best value: 0.566244:  44%|████▍     | 44/100 [01:55<02:02,  2.19s/it]Best trial: 15. Best value: 0.566244:  45%|████▌     | 45/100 [01:55<01:49,  1.98s/it]Best trial: 15. Best value: 0.566244:  45%|████▌     | 45/100 [01:56<01:49,  1.98s/it]Best trial: 15. Best value: 0.566244:  46%|████▌     | 46/100 [01:56<01:34,  1.74s/it]Best trial: 15. Best value: 0.566244:  46%|████▌     | 46/100 [02:00<01:34,  1.74s/it]Best trial: 15. Best value: 0.566244:  47%|████▋     | 47/100 [02:00<02:02,  2.31s/it]Best trial: 15. Best value: 0.566244:  47%|████▋     | 47/100 [02:02<02:02,  2.31s/it]Best trial: 15. Best value: 0.566244:  48%|████▊     | 48/100 [02:02<01:52,  2.17s/it]Best trial: 15. Best value: 0.566244:  48%|████▊     | 48/100 [02:03<01:52,  2.17s/it]Best trial: 15. Best value: 0.566244:  49%|████▉     | 49/100 [02:03<01:37,  1.92s/it]Best trial: 15. Best value: 0.566244:  49%|████▉     | 49/100 [02:06<01:37,  1.92s/it]Best trial: 15. Best value: 0.566244:  50%|█████     | 50/100 [02:06<01:56,  2.33s/it]Best trial: 15. Best value: 0.566244:  50%|█████     | 50/100 [02:08<01:56,  2.33s/it]Best trial: 15. Best value: 0.566244:  51%|█████     | 51/100 [02:08<01:47,  2.20s/it]Best trial: 15. Best value: 0.566244:  51%|█████     | 51/100 [02:11<01:47,  2.20s/it]Best trial: 15. Best value: 0.566244:  52%|█████▏    | 52/100 [02:11<01:56,  2.42s/it]Best trial: 15. Best value: 0.566244:  52%|█████▏    | 52/100 [02:16<01:56,  2.42s/it]Best trial: 15. Best value: 0.566244:  53%|█████▎    | 53/100 [02:16<02:26,  3.11s/it]Best trial: 15. Best value: 0.566244:  53%|█████▎    | 53/100 [02:19<02:26,  3.11s/it]Best trial: 15. Best value: 0.566244:  54%|█████▍    | 54/100 [02:19<02:29,  3.25s/it]Best trial: 15. Best value: 0.566244:  54%|█████▍    | 54/100 [02:22<02:29,  3.25s/it]Best trial: 15. Best value: 0.566244:  55%|█████▌    | 55/100 [02:22<02:25,  3.23s/it]Best trial: 15. Best value: 0.566244:  55%|█████▌    | 55/100 [02:24<02:25,  3.23s/it]Best trial: 15. Best value: 0.566244:  56%|█████▌    | 56/100 [02:24<02:01,  2.76s/it]Best trial: 56. Best value: 0.566596:  56%|█████▌    | 56/100 [02:27<02:01,  2.76s/it]Best trial: 56. Best value: 0.566596:  57%|█████▋    | 57/100 [02:27<01:58,  2.76s/it]Best trial: 56. Best value: 0.566596:  57%|█████▋    | 57/100 [02:30<01:58,  2.76s/it]Best trial: 56. Best value: 0.566596:  58%|█████▊    | 58/100 [02:30<01:53,  2.71s/it]Best trial: 56. Best value: 0.566596:  58%|█████▊    | 58/100 [02:32<01:53,  2.71s/it]Best trial: 56. Best value: 0.566596:  59%|█████▉    | 59/100 [02:32<01:50,  2.70s/it]Best trial: 56. Best value: 0.566596:  59%|█████▉    | 59/100 [02:35<01:50,  2.70s/it]Best trial: 56. Best value: 0.566596:  60%|██████    | 60/100 [02:35<01:53,  2.84s/it]Best trial: 56. Best value: 0.566596:  60%|██████    | 60/100 [02:39<01:53,  2.84s/it]Best trial: 56. Best value: 0.566596:  61%|██████    | 61/100 [02:39<02:03,  3.16s/it]Best trial: 56. Best value: 0.566596:  61%|██████    | 61/100 [02:42<02:03,  3.16s/it]Best trial: 56. Best value: 0.566596:  62%|██████▏   | 62/100 [02:42<01:55,  3.05s/it]Best trial: 56. Best value: 0.566596:  62%|██████▏   | 62/100 [02:44<01:55,  3.05s/it]Best trial: 56. Best value: 0.566596:  63%|██████▎   | 63/100 [02:44<01:44,  2.84s/it]Best trial: 56. Best value: 0.566596:  63%|██████▎   | 63/100 [02:47<01:44,  2.84s/it]Best trial: 56. Best value: 0.566596:  64%|██████▍   | 64/100 [02:47<01:43,  2.88s/it]Best trial: 56. Best value: 0.566596:  64%|██████▍   | 64/100 [02:50<01:43,  2.88s/it]Best trial: 56. Best value: 0.566596:  65%|██████▌   | 65/100 [02:50<01:35,  2.73s/it]Best trial: 56. Best value: 0.566596:  65%|██████▌   | 65/100 [02:53<01:35,  2.73s/it]Best trial: 56. Best value: 0.566596:  66%|██████▌   | 66/100 [02:53<01:38,  2.89s/it]Best trial: 56. Best value: 0.566596:  66%|██████▌   | 66/100 [02:56<01:38,  2.89s/it]Best trial: 56. Best value: 0.566596:  67%|██████▋   | 67/100 [02:56<01:33,  2.84s/it]Best trial: 56. Best value: 0.566596:  67%|██████▋   | 67/100 [02:59<01:33,  2.84s/it]Best trial: 56. Best value: 0.566596:  68%|██████▊   | 68/100 [02:59<01:38,  3.08s/it]Best trial: 56. Best value: 0.566596:  68%|██████▊   | 68/100 [03:02<01:38,  3.08s/it]Best trial: 56. Best value: 0.566596:  69%|██████▉   | 69/100 [03:02<01:30,  2.91s/it]Best trial: 56. Best value: 0.566596:  69%|██████▉   | 69/100 [03:05<01:30,  2.91s/it]Best trial: 56. Best value: 0.566596:  70%|███████   | 70/100 [03:05<01:25,  2.84s/it]Best trial: 56. Best value: 0.566596:  70%|███████   | 70/100 [03:07<01:25,  2.84s/it]Best trial: 56. Best value: 0.566596:  71%|███████   | 71/100 [03:07<01:22,  2.84s/it]Best trial: 56. Best value: 0.566596:  71%|███████   | 71/100 [03:10<01:22,  2.84s/it]Best trial: 56. Best value: 0.566596:  72%|███████▏  | 72/100 [03:10<01:18,  2.82s/it]Best trial: 56. Best value: 0.566596:  72%|███████▏  | 72/100 [03:12<01:18,  2.82s/it]Best trial: 56. Best value: 0.566596:  73%|███████▎  | 73/100 [03:12<01:09,  2.59s/it]Best trial: 56. Best value: 0.566596:  73%|███████▎  | 73/100 [03:16<01:09,  2.59s/it]Best trial: 56. Best value: 0.566596:  74%|███████▍  | 74/100 [03:16<01:14,  2.88s/it]Best trial: 56. Best value: 0.566596:  74%|███████▍  | 74/100 [03:19<01:14,  2.88s/it]Best trial: 56. Best value: 0.566596:  75%|███████▌  | 75/100 [03:19<01:15,  3.00s/it]Best trial: 56. Best value: 0.566596:  75%|███████▌  | 75/100 [03:22<01:15,  3.00s/it]Best trial: 56. Best value: 0.566596:  76%|███████▌  | 76/100 [03:22<01:12,  3.03s/it]Best trial: 56. Best value: 0.566596:  76%|███████▌  | 76/100 [03:26<01:12,  3.03s/it]Best trial: 56. Best value: 0.566596:  77%|███████▋  | 77/100 [03:26<01:12,  3.13s/it]Best trial: 56. Best value: 0.566596:  77%|███████▋  | 77/100 [03:28<01:12,  3.13s/it]Best trial: 56. Best value: 0.566596:  78%|███████▊  | 78/100 [03:28<01:03,  2.89s/it]Best trial: 56. Best value: 0.566596:  78%|███████▊  | 78/100 [03:31<01:03,  2.89s/it]Best trial: 56. Best value: 0.566596:  79%|███████▉  | 79/100 [03:31<00:59,  2.84s/it]Best trial: 56. Best value: 0.566596:  79%|███████▉  | 79/100 [03:33<00:59,  2.84s/it]Best trial: 56. Best value: 0.566596:  80%|████████  | 80/100 [03:33<00:52,  2.64s/it]Best trial: 56. Best value: 0.566596:  80%|████████  | 80/100 [03:41<00:52,  2.64s/it]Best trial: 56. Best value: 0.566596:  81%|████████  | 81/100 [03:41<01:20,  4.23s/it]Best trial: 56. Best value: 0.566596:  81%|████████  | 81/100 [03:46<01:20,  4.23s/it]Best trial: 56. Best value: 0.566596:  82%|████████▏ | 82/100 [03:46<01:21,  4.54s/it]Best trial: 56. Best value: 0.566596:  82%|████████▏ | 82/100 [03:51<01:21,  4.54s/it]Best trial: 56. Best value: 0.566596:  83%|████████▎ | 83/100 [03:51<01:19,  4.65s/it]Best trial: 56. Best value: 0.566596:  83%|████████▎ | 83/100 [03:53<01:19,  4.65s/it]Best trial: 56. Best value: 0.566596:  84%|████████▍ | 84/100 [03:53<01:01,  3.84s/it]Best trial: 56. Best value: 0.566596:  84%|████████▍ | 84/100 [03:58<01:01,  3.84s/it]Best trial: 56. Best value: 0.566596:  85%|████████▌ | 85/100 [03:58<01:04,  4.28s/it]Best trial: 56. Best value: 0.566596:  85%|████████▌ | 85/100 [04:01<01:04,  4.28s/it]Best trial: 56. Best value: 0.566596:  86%|████████▌ | 86/100 [04:01<00:55,  3.96s/it]Best trial: 56. Best value: 0.566596:  86%|████████▌ | 86/100 [04:04<00:55,  3.96s/it]Best trial: 56. Best value: 0.566596:  87%|████████▋ | 87/100 [04:04<00:46,  3.55s/it]Best trial: 56. Best value: 0.566596:  87%|████████▋ | 87/100 [04:06<00:46,  3.55s/it]Best trial: 56. Best value: 0.566596:  88%|████████▊ | 88/100 [04:06<00:36,  3.02s/it]Best trial: 56. Best value: 0.566596:  88%|████████▊ | 88/100 [04:09<00:36,  3.02s/it]Best trial: 56. Best value: 0.566596:  89%|████████▉ | 89/100 [04:09<00:34,  3.14s/it]Best trial: 56. Best value: 0.566596:  89%|████████▉ | 89/100 [04:11<00:34,  3.14s/it]Best trial: 56. Best value: 0.566596:  90%|█████████ | 90/100 [04:11<00:26,  2.66s/it]Best trial: 56. Best value: 0.566596:  90%|█████████ | 90/100 [04:14<00:26,  2.66s/it]Best trial: 56. Best value: 0.566596:  91%|█████████ | 91/100 [04:14<00:26,  2.93s/it]Best trial: 56. Best value: 0.566596:  91%|█████████ | 91/100 [04:17<00:26,  2.93s/it]Best trial: 56. Best value: 0.566596:  92%|█████████▏| 92/100 [04:17<00:23,  2.89s/it]Best trial: 56. Best value: 0.566596:  92%|█████████▏| 92/100 [04:20<00:23,  2.89s/it]Best trial: 56. Best value: 0.566596:  93%|█████████▎| 93/100 [04:20<00:19,  2.77s/it]Best trial: 56. Best value: 0.566596:  93%|█████████▎| 93/100 [04:22<00:19,  2.77s/it]Best trial: 56. Best value: 0.566596:  94%|█████████▍| 94/100 [04:22<00:16,  2.81s/it]Best trial: 56. Best value: 0.566596:  94%|█████████▍| 94/100 [04:25<00:16,  2.81s/it]Best trial: 56. Best value: 0.566596:  95%|█████████▌| 95/100 [04:25<00:13,  2.71s/it]Best trial: 56. Best value: 0.566596:  95%|█████████▌| 95/100 [04:28<00:13,  2.71s/it]Best trial: 56. Best value: 0.566596:  96%|█████████▌| 96/100 [04:28<00:11,  2.93s/it]Best trial: 56. Best value: 0.566596:  96%|█████████▌| 96/100 [04:31<00:11,  2.93s/it]Best trial: 56. Best value: 0.566596:  97%|█████████▋| 97/100 [04:31<00:08,  2.97s/it]Best trial: 56. Best value: 0.566596:  97%|█████████▋| 97/100 [04:33<00:08,  2.97s/it]Best trial: 56. Best value: 0.566596:  98%|█████████▊| 98/100 [04:33<00:05,  2.56s/it]Best trial: 56. Best value: 0.566596:  98%|█████████▊| 98/100 [04:41<00:05,  2.56s/it]Best trial: 56. Best value: 0.566596:  99%|█████████▉| 99/100 [04:41<00:04,  4.22s/it]Best trial: 56. Best value: 0.566596:  99%|█████████▉| 99/100 [04:43<00:04,  4.22s/it]Best trial: 56. Best value: 0.566596: 100%|██████████| 100/100 [04:43<00:00,  3.60s/it]Best trial: 56. Best value: 0.566596: 100%|██████████| 100/100 [04:43<00:00,  2.84s/it]
2025-12-01 01:31:24,852 - INFO - HPO Complete. Best AUPRC: 0.5666
2025-12-01 01:31:24,852 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.07321708814698079, 'max_depth': 8, 'subsample': 0.9211025463200906, 'colsample_bytree': 0.9585618340149061, 'gamma': 0.6416689398643167, 'reg_lambda': 0.0012541710979007633, 'reg_alpha': 0.23052167749264044}
2025-12-01 01:31:24,853 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:31:26,690 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: ventilator_only
2025-12-01 01:31:26,690 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:31:26,775 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:31:26,786 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:31:26,789 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-12-01 01:31:26,789 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:31:26,789 - INFO - Training model...
2025-12-01 01:31:27,643 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:31:32,489 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:31:32,489 - INFO - AUROC: 0.7554 (0.7079 - 0.7865)
2025-12-01 01:31:32,489 - INFO - AUPRC: 0.5198 (0.4393 - 0.6003)
2025-12-01 01:31:32,489 - INFO - Brier Score: 0.1399 (0.1255 - 0.1610)
2025-12-01 01:31:32,489 - INFO - Accuracy: 0.7760 (0.7014 - 0.8572)
2025-12-01 01:31:32,489 - INFO - Precision: 0.4655 (0.3756 - 0.7261)
2025-12-01 01:31:32,489 - INFO - Sensitivity (Recall): 0.5664 (0.3966 - 0.6654)
2025-12-01 01:31:32,489 - INFO - F1-Score: 0.5110 (0.4671 - 0.5741)
2025-12-01 01:31:32,489 - INFO - Best Threshold: 0.2800 (0.1800 - 0.6100)
2025-12-01 01:31:32,489 - INFO - Specificity: 0.8306 (0.7191 - 0.9606)
2025-12-01 01:31:32,501 - INFO - Calculating SHAP values...
2025-12-01 01:31:33,711 - INFO - SHAP plots saved.
2025-12-01 01:31:33,712 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:31:34,987 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: monitors_only
2025-12-01 01:31:34,987 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:31:35,090 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:31:35,104 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:31:35,107 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-12-01 01:31:35,107 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.448001:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.448001:   1%|          | 1/100 [00:01<02:55,  1.77s/it]Best trial: 0. Best value: 0.448001:   1%|          | 1/100 [00:03<02:55,  1.77s/it]Best trial: 0. Best value: 0.448001:   2%|▏         | 2/100 [00:03<03:04,  1.89s/it]Best trial: 0. Best value: 0.448001:   2%|▏         | 2/100 [00:05<03:04,  1.89s/it]Best trial: 0. Best value: 0.448001:   3%|▎         | 3/100 [00:05<02:51,  1.77s/it]Best trial: 0. Best value: 0.448001:   3%|▎         | 3/100 [00:08<02:51,  1.77s/it]Best trial: 0. Best value: 0.448001:   4%|▍         | 4/100 [00:08<03:47,  2.37s/it]Best trial: 0. Best value: 0.448001:   4%|▍         | 4/100 [00:10<03:47,  2.37s/it]Best trial: 0. Best value: 0.448001:   5%|▌         | 5/100 [00:10<03:15,  2.06s/it]Best trial: 0. Best value: 0.448001:   5%|▌         | 5/100 [00:11<03:15,  2.06s/it]Best trial: 0. Best value: 0.448001:   6%|▌         | 6/100 [00:11<02:47,  1.78s/it]Best trial: 0. Best value: 0.448001:   6%|▌         | 6/100 [00:13<02:47,  1.78s/it]Best trial: 0. Best value: 0.448001:   7%|▋         | 7/100 [00:13<03:09,  2.04s/it]Best trial: 0. Best value: 0.448001:   7%|▋         | 7/100 [00:15<03:09,  2.04s/it]Best trial: 0. Best value: 0.448001:   8%|▊         | 8/100 [00:15<02:58,  1.94s/it]Best trial: 0. Best value: 0.448001:   8%|▊         | 8/100 [00:17<02:58,  1.94s/it]Best trial: 0. Best value: 0.448001:   9%|▉         | 9/100 [00:17<03:06,  2.05s/it]Best trial: 0. Best value: 0.448001:   9%|▉         | 9/100 [00:20<03:06,  2.05s/it]Best trial: 0. Best value: 0.448001:  10%|█         | 10/100 [00:20<03:08,  2.10s/it]Best trial: 0. Best value: 0.448001:  10%|█         | 10/100 [00:22<03:08,  2.10s/it]Best trial: 0. Best value: 0.448001:  11%|█         | 11/100 [00:22<03:04,  2.07s/it]Best trial: 0. Best value: 0.448001:  11%|█         | 11/100 [00:25<03:04,  2.07s/it]Best trial: 0. Best value: 0.448001:  12%|█▏        | 12/100 [00:25<03:28,  2.37s/it]Best trial: 12. Best value: 0.448752:  12%|█▏        | 12/100 [00:27<03:28,  2.37s/it]Best trial: 12. Best value: 0.448752:  13%|█▎        | 13/100 [00:27<03:16,  2.26s/it]Best trial: 12. Best value: 0.448752:  13%|█▎        | 13/100 [00:29<03:16,  2.26s/it]Best trial: 12. Best value: 0.448752:  14%|█▍        | 14/100 [00:29<03:01,  2.11s/it]Best trial: 12. Best value: 0.448752:  14%|█▍        | 14/100 [00:30<03:01,  2.11s/it]Best trial: 12. Best value: 0.448752:  15%|█▌        | 15/100 [00:30<02:46,  1.95s/it]Best trial: 12. Best value: 0.448752:  15%|█▌        | 15/100 [00:31<02:46,  1.95s/it]Best trial: 12. Best value: 0.448752:  16%|█▌        | 16/100 [00:31<02:29,  1.78s/it]Best trial: 12. Best value: 0.448752:  16%|█▌        | 16/100 [00:33<02:29,  1.78s/it]Best trial: 12. Best value: 0.448752:  17%|█▋        | 17/100 [00:33<02:25,  1.75s/it]Best trial: 12. Best value: 0.448752:  17%|█▋        | 17/100 [00:35<02:25,  1.75s/it]Best trial: 12. Best value: 0.448752:  18%|█▊        | 18/100 [00:35<02:28,  1.81s/it]Best trial: 12. Best value: 0.448752:  18%|█▊        | 18/100 [00:40<02:28,  1.81s/it]Best trial: 12. Best value: 0.448752:  19%|█▉        | 19/100 [00:40<03:46,  2.80s/it]Best trial: 19. Best value: 0.457863:  19%|█▉        | 19/100 [00:42<03:46,  2.80s/it]Best trial: 19. Best value: 0.457863:  20%|██        | 20/100 [00:42<03:17,  2.47s/it]Best trial: 19. Best value: 0.457863:  20%|██        | 20/100 [00:43<03:17,  2.47s/it]Best trial: 19. Best value: 0.457863:  21%|██        | 21/100 [00:43<02:48,  2.13s/it]Best trial: 21. Best value: 0.464163:  21%|██        | 21/100 [00:46<02:48,  2.13s/it]Best trial: 21. Best value: 0.464163:  22%|██▏       | 22/100 [00:46<02:51,  2.20s/it]Best trial: 21. Best value: 0.464163:  22%|██▏       | 22/100 [00:48<02:51,  2.20s/it]Best trial: 21. Best value: 0.464163:  23%|██▎       | 23/100 [00:48<02:49,  2.20s/it]Best trial: 21. Best value: 0.464163:  23%|██▎       | 23/100 [00:49<02:49,  2.20s/it]Best trial: 21. Best value: 0.464163:  24%|██▍       | 24/100 [00:49<02:32,  2.01s/it]Best trial: 21. Best value: 0.464163:  24%|██▍       | 24/100 [00:51<02:32,  2.01s/it]Best trial: 21. Best value: 0.464163:  25%|██▌       | 25/100 [00:51<02:21,  1.89s/it]Best trial: 21. Best value: 0.464163:  25%|██▌       | 25/100 [00:52<02:21,  1.89s/it]Best trial: 21. Best value: 0.464163:  26%|██▌       | 26/100 [00:52<02:02,  1.66s/it]Best trial: 21. Best value: 0.464163:  26%|██▌       | 26/100 [00:54<02:02,  1.66s/it]Best trial: 21. Best value: 0.464163:  27%|██▋       | 27/100 [00:54<02:02,  1.68s/it]Best trial: 21. Best value: 0.464163:  27%|██▋       | 27/100 [00:55<02:02,  1.68s/it]Best trial: 21. Best value: 0.464163:  28%|██▊       | 28/100 [00:55<01:56,  1.62s/it]Best trial: 21. Best value: 0.464163:  28%|██▊       | 28/100 [00:57<01:56,  1.62s/it]Best trial: 21. Best value: 0.464163:  29%|██▉       | 29/100 [00:57<01:55,  1.62s/it]Best trial: 21. Best value: 0.464163:  29%|██▉       | 29/100 [00:59<01:55,  1.62s/it]Best trial: 21. Best value: 0.464163:  30%|███       | 30/100 [00:59<01:59,  1.71s/it]Best trial: 21. Best value: 0.464163:  30%|███       | 30/100 [01:00<01:59,  1.71s/it]Best trial: 21. Best value: 0.464163:  31%|███       | 31/100 [01:00<01:52,  1.63s/it]Best trial: 21. Best value: 0.464163:  31%|███       | 31/100 [01:02<01:52,  1.63s/it]Best trial: 21. Best value: 0.464163:  32%|███▏      | 32/100 [01:02<01:48,  1.59s/it]Best trial: 21. Best value: 0.464163:  32%|███▏      | 32/100 [01:03<01:48,  1.59s/it]Best trial: 21. Best value: 0.464163:  33%|███▎      | 33/100 [01:03<01:35,  1.42s/it]Best trial: 21. Best value: 0.464163:  33%|███▎      | 33/100 [01:04<01:35,  1.42s/it]Best trial: 21. Best value: 0.464163:  34%|███▍      | 34/100 [01:04<01:36,  1.47s/it]Best trial: 21. Best value: 0.464163:  34%|███▍      | 34/100 [01:07<01:36,  1.47s/it]Best trial: 21. Best value: 0.464163:  35%|███▌      | 35/100 [01:07<01:53,  1.75s/it]Best trial: 21. Best value: 0.464163:  35%|███▌      | 35/100 [01:09<01:53,  1.75s/it]Best trial: 21. Best value: 0.464163:  36%|███▌      | 36/100 [01:09<01:54,  1.79s/it]Best trial: 21. Best value: 0.464163:  36%|███▌      | 36/100 [01:10<01:54,  1.79s/it]Best trial: 21. Best value: 0.464163:  37%|███▋      | 37/100 [01:10<01:38,  1.56s/it]Best trial: 21. Best value: 0.464163:  37%|███▋      | 37/100 [01:12<01:38,  1.56s/it]Best trial: 21. Best value: 0.464163:  38%|███▊      | 38/100 [01:12<01:55,  1.86s/it]Best trial: 21. Best value: 0.464163:  38%|███▊      | 38/100 [01:14<01:55,  1.86s/it]Best trial: 21. Best value: 0.464163:  39%|███▉      | 39/100 [01:14<01:46,  1.74s/it]Best trial: 21. Best value: 0.464163:  39%|███▉      | 39/100 [01:15<01:46,  1.74s/it]Best trial: 21. Best value: 0.464163:  40%|████      | 40/100 [01:15<01:35,  1.60s/it]Best trial: 21. Best value: 0.464163:  40%|████      | 40/100 [01:19<01:35,  1.60s/it]Best trial: 21. Best value: 0.464163:  41%|████      | 41/100 [01:19<02:13,  2.26s/it]Best trial: 21. Best value: 0.464163:  41%|████      | 41/100 [01:20<02:13,  2.26s/it]Best trial: 21. Best value: 0.464163:  42%|████▏     | 42/100 [01:20<01:57,  2.02s/it]Best trial: 21. Best value: 0.464163:  42%|████▏     | 42/100 [01:21<01:57,  2.02s/it]Best trial: 21. Best value: 0.464163:  43%|████▎     | 43/100 [01:21<01:39,  1.75s/it]Best trial: 21. Best value: 0.464163:  43%|████▎     | 43/100 [01:23<01:39,  1.75s/it]Best trial: 21. Best value: 0.464163:  44%|████▍     | 44/100 [01:23<01:37,  1.73s/it]Best trial: 21. Best value: 0.464163:  44%|████▍     | 44/100 [01:25<01:37,  1.73s/it]Best trial: 21. Best value: 0.464163:  45%|████▌     | 45/100 [01:25<01:30,  1.65s/it]Best trial: 21. Best value: 0.464163:  45%|████▌     | 45/100 [01:26<01:30,  1.65s/it]Best trial: 21. Best value: 0.464163:  46%|████▌     | 46/100 [01:26<01:33,  1.73s/it]Best trial: 21. Best value: 0.464163:  46%|████▌     | 46/100 [01:28<01:33,  1.73s/it]Best trial: 21. Best value: 0.464163:  47%|████▋     | 47/100 [01:28<01:28,  1.67s/it]Best trial: 21. Best value: 0.464163:  47%|████▋     | 47/100 [01:30<01:28,  1.67s/it]Best trial: 21. Best value: 0.464163:  48%|████▊     | 48/100 [01:30<01:24,  1.62s/it]Best trial: 21. Best value: 0.464163:  48%|████▊     | 48/100 [01:31<01:24,  1.62s/it]Best trial: 21. Best value: 0.464163:  49%|████▉     | 49/100 [01:31<01:15,  1.47s/it]Best trial: 21. Best value: 0.464163:  49%|████▉     | 49/100 [01:32<01:15,  1.47s/it]Best trial: 21. Best value: 0.464163:  50%|█████     | 50/100 [01:32<01:05,  1.30s/it]Best trial: 21. Best value: 0.464163:  50%|█████     | 50/100 [01:33<01:05,  1.30s/it]Best trial: 21. Best value: 0.464163:  51%|█████     | 51/100 [01:33<00:58,  1.20s/it]Best trial: 21. Best value: 0.464163:  51%|█████     | 51/100 [01:34<00:58,  1.20s/it]Best trial: 21. Best value: 0.464163:  52%|█████▏    | 52/100 [01:34<00:54,  1.14s/it]Best trial: 21. Best value: 0.464163:  52%|█████▏    | 52/100 [01:35<00:54,  1.14s/it]Best trial: 21. Best value: 0.464163:  53%|█████▎    | 53/100 [01:35<00:51,  1.09s/it]Best trial: 21. Best value: 0.464163:  53%|█████▎    | 53/100 [01:37<00:51,  1.09s/it]Best trial: 21. Best value: 0.464163:  54%|█████▍    | 54/100 [01:37<01:03,  1.39s/it]Best trial: 21. Best value: 0.464163:  54%|█████▍    | 54/100 [01:38<01:03,  1.39s/it]Best trial: 21. Best value: 0.464163:  55%|█████▌    | 55/100 [01:38<01:00,  1.34s/it]Best trial: 55. Best value: 0.47031:  55%|█████▌    | 55/100 [01:39<01:00,  1.34s/it] Best trial: 55. Best value: 0.47031:  56%|█████▌    | 56/100 [01:39<00:59,  1.35s/it]Best trial: 55. Best value: 0.47031:  56%|█████▌    | 56/100 [01:41<00:59,  1.35s/it]Best trial: 55. Best value: 0.47031:  57%|█████▋    | 57/100 [01:41<00:59,  1.39s/it]Best trial: 55. Best value: 0.47031:  57%|█████▋    | 57/100 [01:42<00:59,  1.39s/it]Best trial: 55. Best value: 0.47031:  58%|█████▊    | 58/100 [01:42<00:57,  1.37s/it]Best trial: 55. Best value: 0.47031:  58%|█████▊    | 58/100 [01:44<00:57,  1.37s/it]Best trial: 55. Best value: 0.47031:  59%|█████▉    | 59/100 [01:44<01:08,  1.67s/it]Best trial: 55. Best value: 0.47031:  59%|█████▉    | 59/100 [01:46<01:08,  1.67s/it]Best trial: 55. Best value: 0.47031:  60%|██████    | 60/100 [01:46<01:02,  1.57s/it]Best trial: 55. Best value: 0.47031:  60%|██████    | 60/100 [01:47<01:02,  1.57s/it]Best trial: 55. Best value: 0.47031:  61%|██████    | 61/100 [01:47<01:01,  1.57s/it]Best trial: 55. Best value: 0.47031:  61%|██████    | 61/100 [01:49<01:01,  1.57s/it]Best trial: 55. Best value: 0.47031:  62%|██████▏   | 62/100 [01:49<01:03,  1.67s/it]Best trial: 55. Best value: 0.47031:  62%|██████▏   | 62/100 [01:51<01:03,  1.67s/it]Best trial: 55. Best value: 0.47031:  63%|██████▎   | 63/100 [01:51<01:00,  1.63s/it]Best trial: 55. Best value: 0.47031:  63%|██████▎   | 63/100 [01:52<01:00,  1.63s/it]Best trial: 55. Best value: 0.47031:  64%|██████▍   | 64/100 [01:52<00:56,  1.57s/it]Best trial: 55. Best value: 0.47031:  64%|██████▍   | 64/100 [01:53<00:56,  1.57s/it]Best trial: 55. Best value: 0.47031:  65%|██████▌   | 65/100 [01:53<00:51,  1.48s/it]Best trial: 55. Best value: 0.47031:  65%|██████▌   | 65/100 [01:55<00:51,  1.48s/it]Best trial: 55. Best value: 0.47031:  66%|██████▌   | 66/100 [01:55<00:47,  1.40s/it]Best trial: 55. Best value: 0.47031:  66%|██████▌   | 66/100 [01:56<00:47,  1.40s/it]Best trial: 55. Best value: 0.47031:  67%|██████▋   | 67/100 [01:56<00:47,  1.43s/it]Best trial: 55. Best value: 0.47031:  67%|██████▋   | 67/100 [02:00<00:47,  1.43s/it]Best trial: 55. Best value: 0.47031:  68%|██████▊   | 68/100 [02:00<01:06,  2.07s/it]Best trial: 55. Best value: 0.47031:  68%|██████▊   | 68/100 [02:01<01:06,  2.07s/it]Best trial: 55. Best value: 0.47031:  69%|██████▉   | 69/100 [02:01<00:58,  1.88s/it]Best trial: 55. Best value: 0.47031:  69%|██████▉   | 69/100 [02:02<00:58,  1.88s/it]Best trial: 55. Best value: 0.47031:  70%|███████   | 70/100 [02:02<00:51,  1.72s/it]Best trial: 55. Best value: 0.47031:  70%|███████   | 70/100 [02:05<00:51,  1.72s/it]Best trial: 55. Best value: 0.47031:  71%|███████   | 71/100 [02:05<00:55,  1.91s/it]Best trial: 55. Best value: 0.47031:  71%|███████   | 71/100 [02:06<00:55,  1.91s/it]Best trial: 55. Best value: 0.47031:  72%|███████▏  | 72/100 [02:06<00:44,  1.60s/it]Best trial: 55. Best value: 0.47031:  72%|███████▏  | 72/100 [02:07<00:44,  1.60s/it]Best trial: 55. Best value: 0.47031:  73%|███████▎  | 73/100 [02:07<00:37,  1.39s/it]Best trial: 55. Best value: 0.47031:  73%|███████▎  | 73/100 [02:08<00:37,  1.39s/it]Best trial: 55. Best value: 0.47031:  74%|███████▍  | 74/100 [02:08<00:36,  1.39s/it]Best trial: 55. Best value: 0.47031:  74%|███████▍  | 74/100 [02:09<00:36,  1.39s/it]Best trial: 55. Best value: 0.47031:  75%|███████▌  | 75/100 [02:09<00:30,  1.24s/it]Best trial: 55. Best value: 0.47031:  75%|███████▌  | 75/100 [02:10<00:30,  1.24s/it]Best trial: 55. Best value: 0.47031:  76%|███████▌  | 76/100 [02:10<00:31,  1.31s/it]Best trial: 55. Best value: 0.47031:  76%|███████▌  | 76/100 [02:13<00:31,  1.31s/it]Best trial: 55. Best value: 0.47031:  77%|███████▋  | 77/100 [02:13<00:40,  1.75s/it]Best trial: 55. Best value: 0.47031:  77%|███████▋  | 77/100 [02:16<00:40,  1.75s/it]Best trial: 55. Best value: 0.47031:  78%|███████▊  | 78/100 [02:16<00:47,  2.17s/it]Best trial: 55. Best value: 0.47031:  78%|███████▊  | 78/100 [02:17<00:47,  2.17s/it]Best trial: 55. Best value: 0.47031:  79%|███████▉  | 79/100 [02:17<00:38,  1.83s/it]Best trial: 55. Best value: 0.47031:  79%|███████▉  | 79/100 [02:18<00:38,  1.83s/it]Best trial: 55. Best value: 0.47031:  80%|████████  | 80/100 [02:18<00:32,  1.63s/it]Best trial: 55. Best value: 0.47031:  80%|████████  | 80/100 [02:20<00:32,  1.63s/it]Best trial: 55. Best value: 0.47031:  81%|████████  | 81/100 [02:20<00:28,  1.51s/it]Best trial: 55. Best value: 0.47031:  81%|████████  | 81/100 [02:21<00:28,  1.51s/it]Best trial: 55. Best value: 0.47031:  82%|████████▏ | 82/100 [02:21<00:24,  1.36s/it]Best trial: 55. Best value: 0.47031:  82%|████████▏ | 82/100 [02:22<00:24,  1.36s/it]Best trial: 55. Best value: 0.47031:  83%|████████▎ | 83/100 [02:22<00:22,  1.33s/it]Best trial: 55. Best value: 0.47031:  83%|████████▎ | 83/100 [02:23<00:22,  1.33s/it]Best trial: 55. Best value: 0.47031:  84%|████████▍ | 84/100 [02:23<00:19,  1.22s/it]Best trial: 55. Best value: 0.47031:  84%|████████▍ | 84/100 [02:24<00:19,  1.22s/it]Best trial: 55. Best value: 0.47031:  85%|████████▌ | 85/100 [02:24<00:19,  1.27s/it]Best trial: 55. Best value: 0.47031:  85%|████████▌ | 85/100 [02:25<00:19,  1.27s/it]Best trial: 55. Best value: 0.47031:  86%|████████▌ | 86/100 [02:25<00:16,  1.18s/it]Best trial: 55. Best value: 0.47031:  86%|████████▌ | 86/100 [02:27<00:16,  1.18s/it]Best trial: 55. Best value: 0.47031:  87%|████████▋ | 87/100 [02:27<00:16,  1.24s/it]Best trial: 55. Best value: 0.47031:  87%|████████▋ | 87/100 [02:30<00:16,  1.24s/it]Best trial: 55. Best value: 0.47031:  88%|████████▊ | 88/100 [02:30<00:21,  1.81s/it]Best trial: 55. Best value: 0.47031:  88%|████████▊ | 88/100 [02:31<00:21,  1.81s/it]Best trial: 55. Best value: 0.47031:  89%|████████▉ | 89/100 [02:31<00:18,  1.67s/it]Best trial: 55. Best value: 0.47031:  89%|████████▉ | 89/100 [02:33<00:18,  1.67s/it]Best trial: 55. Best value: 0.47031:  90%|█████████ | 90/100 [02:33<00:17,  1.75s/it]Best trial: 55. Best value: 0.47031:  90%|█████████ | 90/100 [02:34<00:17,  1.75s/it]Best trial: 55. Best value: 0.47031:  91%|█████████ | 91/100 [02:34<00:14,  1.59s/it]Best trial: 55. Best value: 0.47031:  91%|█████████ | 91/100 [02:35<00:14,  1.59s/it]Best trial: 55. Best value: 0.47031:  92%|█████████▏| 92/100 [02:35<00:11,  1.38s/it]Best trial: 55. Best value: 0.47031:  92%|█████████▏| 92/100 [02:36<00:11,  1.38s/it]Best trial: 55. Best value: 0.47031:  93%|█████████▎| 93/100 [02:36<00:08,  1.27s/it]Best trial: 55. Best value: 0.47031:  93%|█████████▎| 93/100 [02:37<00:08,  1.27s/it]Best trial: 55. Best value: 0.47031:  94%|█████████▍| 94/100 [02:37<00:07,  1.20s/it]Best trial: 55. Best value: 0.47031:  94%|█████████▍| 94/100 [02:38<00:07,  1.20s/it]Best trial: 55. Best value: 0.47031:  95%|█████████▌| 95/100 [02:38<00:05,  1.11s/it]Best trial: 55. Best value: 0.47031:  95%|█████████▌| 95/100 [02:39<00:05,  1.11s/it]Best trial: 55. Best value: 0.47031:  96%|█████████▌| 96/100 [02:39<00:04,  1.18s/it]Best trial: 55. Best value: 0.47031:  96%|█████████▌| 96/100 [02:41<00:04,  1.18s/it]Best trial: 55. Best value: 0.47031:  97%|█████████▋| 97/100 [02:41<00:04,  1.37s/it]Best trial: 55. Best value: 0.47031:  97%|█████████▋| 97/100 [02:43<00:04,  1.37s/it]Best trial: 55. Best value: 0.47031:  98%|█████████▊| 98/100 [02:43<00:02,  1.44s/it]Best trial: 55. Best value: 0.47031:  98%|█████████▊| 98/100 [02:44<00:02,  1.44s/it]Best trial: 55. Best value: 0.47031:  99%|█████████▉| 99/100 [02:44<00:01,  1.28s/it]Best trial: 55. Best value: 0.47031:  99%|█████████▉| 99/100 [02:45<00:01,  1.28s/it]Best trial: 55. Best value: 0.47031: 100%|██████████| 100/100 [02:45<00:00,  1.26s/it]Best trial: 55. Best value: 0.47031: 100%|██████████| 100/100 [02:45<00:00,  1.66s/it]
2025-12-01 01:34:20,644 - INFO - HPO Complete. Best AUPRC: 0.4703
2025-12-01 01:34:20,644 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.09912218030695095, 'max_depth': 4, 'subsample': 0.6001553923864019, 'colsample_bytree': 0.8265015846412912, 'gamma': 0.2038046087836226, 'reg_lambda': 0.005146311428983545, 'reg_alpha': 0.000489741979726948}
2025-12-01 01:34:20,645 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:34:22,629 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: monitors_only
2025-12-01 01:34:22,630 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:34:22,717 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:34:22,729 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:34:22,732 - INFO - Data prepared. Train shape: (2761, 48), Test shape: (692, 48)
2025-12-01 01:34:22,732 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:34:22,732 - INFO - Training model...
2025-12-01 01:34:23,503 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:34:28,297 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:34:28,297 - INFO - AUROC: 0.7249 (0.6566 - 0.7588)
2025-12-01 01:34:28,297 - INFO - AUPRC: 0.4705 (0.3559 - 0.5477)
2025-12-01 01:34:28,297 - INFO - Brier Score: 0.1549 (0.1441 - 0.1736)
2025-12-01 01:34:28,297 - INFO - Accuracy: 0.7688 (0.6280 - 0.8101)
2025-12-01 01:34:28,297 - INFO - Precision: 0.4452 (0.2751 - 0.5819)
2025-12-01 01:34:28,297 - INFO - Sensitivity (Recall): 0.4825 (0.4191 - 0.6351)
2025-12-01 01:34:28,297 - INFO - F1-Score: 0.4631 (0.3817 - 0.5407)
2025-12-01 01:34:28,297 - INFO - Best Threshold: 0.4200 (0.1900 - 0.5100)
2025-12-01 01:34:28,297 - INFO - Specificity: 0.8434 (0.6288 - 0.9080)
2025-12-01 01:34:28,310 - INFO - Calculating SHAP values...
2025-12-01 01:34:29,426 - INFO - SHAP plots saved.
2025-12-01 01:34:29,427 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:34:30,695 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_pleth
2025-12-01 01:34:30,695 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:34:30,789 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:34:30,817 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:34:30,824 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:34:30,824 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.658723:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.658723:   1%|          | 1/100 [00:04<07:31,  4.56s/it]Best trial: 0. Best value: 0.658723:   1%|          | 1/100 [00:07<07:31,  4.56s/it]Best trial: 0. Best value: 0.658723:   2%|▏         | 2/100 [00:07<05:54,  3.62s/it]Best trial: 2. Best value: 0.676454:   2%|▏         | 2/100 [00:12<05:54,  3.62s/it]Best trial: 2. Best value: 0.676454:   3%|▎         | 3/100 [00:12<06:37,  4.10s/it]Best trial: 3. Best value: 0.706734:   3%|▎         | 3/100 [00:14<06:37,  4.10s/it]Best trial: 3. Best value: 0.706734:   4%|▍         | 4/100 [00:14<05:09,  3.23s/it]Best trial: 3. Best value: 0.706734:   4%|▍         | 4/100 [00:18<05:09,  3.23s/it]Best trial: 3. Best value: 0.706734:   5%|▌         | 5/100 [00:18<05:51,  3.71s/it]Best trial: 3. Best value: 0.706734:   5%|▌         | 5/100 [00:21<05:51,  3.71s/it]Best trial: 3. Best value: 0.706734:   6%|▌         | 6/100 [00:21<05:11,  3.31s/it]Best trial: 3. Best value: 0.706734:   6%|▌         | 6/100 [00:25<05:11,  3.31s/it]Best trial: 3. Best value: 0.706734:   7%|▋         | 7/100 [00:25<05:41,  3.67s/it]Best trial: 3. Best value: 0.706734:   7%|▋         | 7/100 [00:28<05:41,  3.67s/it]Best trial: 3. Best value: 0.706734:   8%|▊         | 8/100 [00:28<05:23,  3.51s/it]Best trial: 3. Best value: 0.706734:   8%|▊         | 8/100 [00:31<05:23,  3.51s/it]Best trial: 3. Best value: 0.706734:   9%|▉         | 9/100 [00:31<04:53,  3.23s/it]Best trial: 3. Best value: 0.706734:   9%|▉         | 9/100 [00:33<04:53,  3.23s/it]Best trial: 3. Best value: 0.706734:  10%|█         | 10/100 [00:33<04:30,  3.01s/it]Best trial: 3. Best value: 0.706734:  10%|█         | 10/100 [00:37<04:30,  3.01s/it]Best trial: 3. Best value: 0.706734:  11%|█         | 11/100 [00:37<04:46,  3.22s/it]Best trial: 3. Best value: 0.706734:  11%|█         | 11/100 [00:41<04:46,  3.22s/it]Best trial: 3. Best value: 0.706734:  12%|█▏        | 12/100 [00:41<04:54,  3.34s/it]Best trial: 3. Best value: 0.706734:  12%|█▏        | 12/100 [00:43<04:54,  3.34s/it]Best trial: 3. Best value: 0.706734:  13%|█▎        | 13/100 [00:43<04:32,  3.13s/it]Best trial: 3. Best value: 0.706734:  13%|█▎        | 13/100 [00:48<04:32,  3.13s/it]Best trial: 3. Best value: 0.706734:  14%|█▍        | 14/100 [00:48<05:02,  3.52s/it]Best trial: 3. Best value: 0.706734:  14%|█▍        | 14/100 [00:51<05:02,  3.52s/it]Best trial: 3. Best value: 0.706734:  15%|█▌        | 15/100 [00:51<05:03,  3.57s/it]Best trial: 3. Best value: 0.706734:  15%|█▌        | 15/100 [00:55<05:03,  3.57s/it]Best trial: 3. Best value: 0.706734:  16%|█▌        | 16/100 [00:55<04:51,  3.47s/it]Best trial: 3. Best value: 0.706734:  16%|█▌        | 16/100 [00:58<04:51,  3.47s/it]Best trial: 3. Best value: 0.706734:  17%|█▋        | 17/100 [00:58<04:36,  3.33s/it]Best trial: 3. Best value: 0.706734:  17%|█▋        | 17/100 [01:01<04:36,  3.33s/it]Best trial: 3. Best value: 0.706734:  18%|█▊        | 18/100 [01:01<04:30,  3.30s/it]Best trial: 3. Best value: 0.706734:  18%|█▊        | 18/100 [01:06<04:30,  3.30s/it]Best trial: 3. Best value: 0.706734:  19%|█▉        | 19/100 [01:06<05:03,  3.75s/it]Best trial: 3. Best value: 0.706734:  19%|█▉        | 19/100 [01:09<05:03,  3.75s/it]Best trial: 3. Best value: 0.706734:  20%|██        | 20/100 [01:09<04:50,  3.63s/it]Best trial: 3. Best value: 0.706734:  20%|██        | 20/100 [01:12<04:50,  3.63s/it]Best trial: 3. Best value: 0.706734:  21%|██        | 21/100 [01:12<04:33,  3.46s/it]Best trial: 21. Best value: 0.708273:  21%|██        | 21/100 [01:16<04:33,  3.46s/it]Best trial: 21. Best value: 0.708273:  22%|██▏       | 22/100 [01:16<04:37,  3.56s/it]Best trial: 22. Best value: 0.709411:  22%|██▏       | 22/100 [01:19<04:37,  3.56s/it]Best trial: 22. Best value: 0.709411:  23%|██▎       | 23/100 [01:19<04:24,  3.43s/it]Best trial: 22. Best value: 0.709411:  23%|██▎       | 23/100 [01:22<04:24,  3.43s/it]Best trial: 22. Best value: 0.709411:  24%|██▍       | 24/100 [01:22<04:06,  3.24s/it]Best trial: 22. Best value: 0.709411:  24%|██▍       | 24/100 [01:25<04:06,  3.24s/it]Best trial: 22. Best value: 0.709411:  25%|██▌       | 25/100 [01:25<03:55,  3.14s/it]Best trial: 22. Best value: 0.709411:  25%|██▌       | 25/100 [01:33<03:55,  3.14s/it]Best trial: 22. Best value: 0.709411:  26%|██▌       | 26/100 [01:33<05:36,  4.55s/it]Best trial: 22. Best value: 0.709411:  26%|██▌       | 26/100 [01:35<05:36,  4.55s/it]Best trial: 22. Best value: 0.709411:  27%|██▋       | 27/100 [01:35<04:55,  4.04s/it]Best trial: 22. Best value: 0.709411:  27%|██▋       | 27/100 [01:39<04:55,  4.04s/it]Best trial: 22. Best value: 0.709411:  28%|██▊       | 28/100 [01:39<04:47,  3.99s/it]Best trial: 22. Best value: 0.709411:  28%|██▊       | 28/100 [01:44<04:47,  3.99s/it]Best trial: 22. Best value: 0.709411:  29%|██▉       | 29/100 [01:44<04:53,  4.13s/it]Best trial: 22. Best value: 0.709411:  29%|██▉       | 29/100 [01:51<04:53,  4.13s/it]Best trial: 22. Best value: 0.709411:  30%|███       | 30/100 [01:51<05:51,  5.02s/it]Best trial: 22. Best value: 0.709411:  30%|███       | 30/100 [01:52<05:51,  5.02s/it]Best trial: 22. Best value: 0.709411:  31%|███       | 31/100 [01:52<04:34,  3.98s/it]Best trial: 31. Best value: 0.711662:  31%|███       | 31/100 [01:55<04:34,  3.98s/it]Best trial: 31. Best value: 0.711662:  32%|███▏      | 32/100 [01:55<03:53,  3.43s/it]Best trial: 31. Best value: 0.711662:  32%|███▏      | 32/100 [01:57<03:53,  3.43s/it]Best trial: 31. Best value: 0.711662:  33%|███▎      | 33/100 [01:57<03:24,  3.05s/it]Best trial: 31. Best value: 0.711662:  33%|███▎      | 33/100 [01:59<03:24,  3.05s/it]Best trial: 31. Best value: 0.711662:  34%|███▍      | 34/100 [01:59<03:03,  2.78s/it]Best trial: 31. Best value: 0.711662:  34%|███▍      | 34/100 [02:01<03:03,  2.78s/it]Best trial: 31. Best value: 0.711662:  35%|███▌      | 35/100 [02:01<02:51,  2.63s/it]Best trial: 31. Best value: 0.711662:  35%|███▌      | 35/100 [02:03<02:51,  2.63s/it]Best trial: 31. Best value: 0.711662:  36%|███▌      | 36/100 [02:03<02:38,  2.47s/it]Best trial: 31. Best value: 0.711662:  36%|███▌      | 36/100 [02:06<02:38,  2.47s/it]Best trial: 31. Best value: 0.711662:  37%|███▋      | 37/100 [02:06<02:31,  2.40s/it]Best trial: 31. Best value: 0.711662:  37%|███▋      | 37/100 [02:09<02:31,  2.40s/it]Best trial: 31. Best value: 0.711662:  38%|███▊      | 38/100 [02:09<02:56,  2.85s/it]Best trial: 31. Best value: 0.711662:  38%|███▊      | 38/100 [02:11<02:56,  2.85s/it]Best trial: 31. Best value: 0.711662:  39%|███▉      | 39/100 [02:11<02:28,  2.43s/it]Best trial: 31. Best value: 0.711662:  39%|███▉      | 39/100 [02:13<02:28,  2.43s/it]Best trial: 31. Best value: 0.711662:  40%|████      | 40/100 [02:13<02:22,  2.38s/it]Best trial: 31. Best value: 0.711662:  40%|████      | 40/100 [02:16<02:22,  2.38s/it]Best trial: 31. Best value: 0.711662:  41%|████      | 41/100 [02:16<02:30,  2.56s/it]Best trial: 31. Best value: 0.711662:  41%|████      | 41/100 [02:19<02:30,  2.56s/it]Best trial: 31. Best value: 0.711662:  42%|████▏     | 42/100 [02:19<02:27,  2.55s/it]Best trial: 31. Best value: 0.711662:  42%|████▏     | 42/100 [02:22<02:27,  2.55s/it]Best trial: 31. Best value: 0.711662:  43%|████▎     | 43/100 [02:22<02:36,  2.74s/it]Best trial: 31. Best value: 0.711662:  43%|████▎     | 43/100 [02:24<02:36,  2.74s/it]Best trial: 31. Best value: 0.711662:  44%|████▍     | 44/100 [02:24<02:19,  2.49s/it]Best trial: 31. Best value: 0.711662:  44%|████▍     | 44/100 [02:26<02:19,  2.49s/it]Best trial: 31. Best value: 0.711662:  45%|████▌     | 45/100 [02:26<02:05,  2.28s/it]Best trial: 31. Best value: 0.711662:  45%|████▌     | 45/100 [02:29<02:05,  2.28s/it]Best trial: 31. Best value: 0.711662:  46%|████▌     | 46/100 [02:29<02:21,  2.62s/it]Best trial: 31. Best value: 0.711662:  46%|████▌     | 46/100 [02:32<02:21,  2.62s/it]Best trial: 31. Best value: 0.711662:  47%|████▋     | 47/100 [02:32<02:26,  2.77s/it]Best trial: 31. Best value: 0.711662:  47%|████▋     | 47/100 [02:34<02:26,  2.77s/it]Best trial: 31. Best value: 0.711662:  48%|████▊     | 48/100 [02:34<02:10,  2.51s/it]Best trial: 48. Best value: 0.712249:  48%|████▊     | 48/100 [02:36<02:10,  2.51s/it]Best trial: 48. Best value: 0.712249:  49%|████▉     | 49/100 [02:36<01:57,  2.30s/it]Best trial: 48. Best value: 0.712249:  49%|████▉     | 49/100 [02:38<01:57,  2.30s/it]Best trial: 48. Best value: 0.712249:  50%|█████     | 50/100 [02:38<01:47,  2.16s/it]Best trial: 48. Best value: 0.712249:  50%|█████     | 50/100 [02:40<01:47,  2.16s/it]Best trial: 48. Best value: 0.712249:  51%|█████     | 51/100 [02:40<01:42,  2.10s/it]Best trial: 48. Best value: 0.712249:  51%|█████     | 51/100 [02:41<01:42,  2.10s/it]Best trial: 48. Best value: 0.712249:  52%|█████▏    | 52/100 [02:41<01:34,  1.97s/it]Best trial: 48. Best value: 0.712249:  52%|█████▏    | 52/100 [02:44<01:34,  1.97s/it]Best trial: 48. Best value: 0.712249:  53%|█████▎    | 53/100 [02:44<01:40,  2.14s/it]Best trial: 53. Best value: 0.71243:  53%|█████▎    | 53/100 [02:47<01:40,  2.14s/it] Best trial: 53. Best value: 0.71243:  54%|█████▍    | 54/100 [02:47<01:52,  2.44s/it]Best trial: 53. Best value: 0.71243:  54%|█████▍    | 54/100 [02:49<01:52,  2.44s/it]Best trial: 53. Best value: 0.71243:  55%|█████▌    | 55/100 [02:49<01:50,  2.45s/it]Best trial: 53. Best value: 0.71243:  55%|█████▌    | 55/100 [02:53<01:50,  2.45s/it]Best trial: 53. Best value: 0.71243:  56%|█████▌    | 56/100 [02:53<01:59,  2.73s/it]Best trial: 53. Best value: 0.71243:  56%|█████▌    | 56/100 [02:56<01:59,  2.73s/it]Best trial: 53. Best value: 0.71243:  57%|█████▋    | 57/100 [02:56<02:07,  2.96s/it]Best trial: 53. Best value: 0.71243:  57%|█████▋    | 57/100 [02:59<02:07,  2.96s/it]Best trial: 53. Best value: 0.71243:  58%|█████▊    | 58/100 [02:59<02:03,  2.94s/it]Best trial: 53. Best value: 0.71243:  58%|█████▊    | 58/100 [03:01<02:03,  2.94s/it]Best trial: 53. Best value: 0.71243:  59%|█████▉    | 59/100 [03:01<01:44,  2.54s/it]Best trial: 53. Best value: 0.71243:  59%|█████▉    | 59/100 [03:07<01:44,  2.54s/it]Best trial: 53. Best value: 0.71243:  60%|██████    | 60/100 [03:07<02:27,  3.69s/it]Best trial: 53. Best value: 0.71243:  60%|██████    | 60/100 [03:09<02:27,  3.69s/it]Best trial: 53. Best value: 0.71243:  61%|██████    | 61/100 [03:09<01:57,  3.02s/it]Best trial: 53. Best value: 0.71243:  61%|██████    | 61/100 [03:11<01:57,  3.02s/it]Best trial: 53. Best value: 0.71243:  62%|██████▏   | 62/100 [03:11<01:48,  2.84s/it]Best trial: 53. Best value: 0.71243:  62%|██████▏   | 62/100 [03:13<01:48,  2.84s/it]Best trial: 53. Best value: 0.71243:  63%|██████▎   | 63/100 [03:13<01:32,  2.50s/it]Best trial: 53. Best value: 0.71243:  63%|██████▎   | 63/100 [03:15<01:32,  2.50s/it]Best trial: 53. Best value: 0.71243:  64%|██████▍   | 64/100 [03:15<01:30,  2.51s/it]Best trial: 53. Best value: 0.71243:  64%|██████▍   | 64/100 [03:18<01:30,  2.51s/it]Best trial: 53. Best value: 0.71243:  65%|██████▌   | 65/100 [03:18<01:32,  2.66s/it]Best trial: 53. Best value: 0.71243:  65%|██████▌   | 65/100 [03:21<01:32,  2.66s/it]Best trial: 53. Best value: 0.71243:  66%|██████▌   | 66/100 [03:21<01:31,  2.68s/it]Best trial: 53. Best value: 0.71243:  66%|██████▌   | 66/100 [03:23<01:31,  2.68s/it]Best trial: 53. Best value: 0.71243:  67%|██████▋   | 67/100 [03:23<01:20,  2.45s/it]Best trial: 53. Best value: 0.71243:  67%|██████▋   | 67/100 [03:26<01:20,  2.45s/it]Best trial: 53. Best value: 0.71243:  68%|██████▊   | 68/100 [03:26<01:22,  2.58s/it]Best trial: 53. Best value: 0.71243:  68%|██████▊   | 68/100 [03:28<01:22,  2.58s/it]Best trial: 53. Best value: 0.71243:  69%|██████▉   | 69/100 [03:28<01:16,  2.45s/it]Best trial: 53. Best value: 0.71243:  69%|██████▉   | 69/100 [03:31<01:16,  2.45s/it]Best trial: 53. Best value: 0.71243:  70%|███████   | 70/100 [03:31<01:17,  2.58s/it]Best trial: 53. Best value: 0.71243:  70%|███████   | 70/100 [03:34<01:17,  2.58s/it]Best trial: 53. Best value: 0.71243:  71%|███████   | 71/100 [03:34<01:22,  2.85s/it]Best trial: 53. Best value: 0.71243:  71%|███████   | 71/100 [03:37<01:22,  2.85s/it]Best trial: 53. Best value: 0.71243:  72%|███████▏  | 72/100 [03:37<01:18,  2.80s/it]Best trial: 53. Best value: 0.71243:  72%|███████▏  | 72/100 [03:39<01:18,  2.80s/it]Best trial: 53. Best value: 0.71243:  73%|███████▎  | 73/100 [03:39<01:09,  2.59s/it]Best trial: 73. Best value: 0.713186:  73%|███████▎  | 73/100 [03:41<01:09,  2.59s/it]Best trial: 73. Best value: 0.713186:  74%|███████▍  | 74/100 [03:41<01:04,  2.49s/it]Best trial: 73. Best value: 0.713186:  74%|███████▍  | 74/100 [03:43<01:04,  2.49s/it]Best trial: 73. Best value: 0.713186:  75%|███████▌  | 75/100 [03:43<00:59,  2.36s/it]Best trial: 73. Best value: 0.713186:  75%|███████▌  | 75/100 [03:45<00:59,  2.36s/it]Best trial: 73. Best value: 0.713186:  76%|███████▌  | 76/100 [03:45<00:54,  2.27s/it]Best trial: 73. Best value: 0.713186:  76%|███████▌  | 76/100 [03:50<00:54,  2.27s/it]Best trial: 73. Best value: 0.713186:  77%|███████▋  | 77/100 [03:50<01:07,  2.92s/it]Best trial: 73. Best value: 0.713186:  77%|███████▋  | 77/100 [03:52<01:07,  2.92s/it]Best trial: 73. Best value: 0.713186:  78%|███████▊  | 78/100 [03:52<00:58,  2.67s/it]Best trial: 73. Best value: 0.713186:  78%|███████▊  | 78/100 [03:54<00:58,  2.67s/it]Best trial: 73. Best value: 0.713186:  79%|███████▉  | 79/100 [03:54<00:51,  2.43s/it]Best trial: 73. Best value: 0.713186:  79%|███████▉  | 79/100 [03:56<00:51,  2.43s/it]Best trial: 73. Best value: 0.713186:  80%|████████  | 80/100 [03:56<00:46,  2.32s/it]Best trial: 73. Best value: 0.713186:  80%|████████  | 80/100 [03:59<00:46,  2.32s/it]Best trial: 73. Best value: 0.713186:  81%|████████  | 81/100 [03:59<00:49,  2.63s/it]Best trial: 73. Best value: 0.713186:  81%|████████  | 81/100 [04:02<00:49,  2.63s/it]Best trial: 73. Best value: 0.713186:  82%|████████▏ | 82/100 [04:02<00:46,  2.58s/it]Best trial: 73. Best value: 0.713186:  82%|████████▏ | 82/100 [04:04<00:46,  2.58s/it]Best trial: 73. Best value: 0.713186:  83%|████████▎ | 83/100 [04:04<00:40,  2.36s/it]Best trial: 73. Best value: 0.713186:  83%|████████▎ | 83/100 [04:05<00:40,  2.36s/it]Best trial: 73. Best value: 0.713186:  84%|████████▍ | 84/100 [04:05<00:34,  2.18s/it]Best trial: 73. Best value: 0.713186:  84%|████████▍ | 84/100 [04:07<00:34,  2.18s/it]Best trial: 73. Best value: 0.713186:  85%|████████▌ | 85/100 [04:07<00:30,  2.01s/it]Best trial: 73. Best value: 0.713186:  85%|████████▌ | 85/100 [04:09<00:30,  2.01s/it]Best trial: 73. Best value: 0.713186:  86%|████████▌ | 86/100 [04:09<00:30,  2.17s/it]Best trial: 73. Best value: 0.713186:  86%|████████▌ | 86/100 [04:11<00:30,  2.17s/it]Best trial: 73. Best value: 0.713186:  87%|████████▋ | 87/100 [04:12<00:27,  2.13s/it]Best trial: 73. Best value: 0.713186:  87%|████████▋ | 87/100 [04:15<00:27,  2.13s/it]Best trial: 73. Best value: 0.713186:  88%|████████▊ | 88/100 [04:15<00:29,  2.47s/it]Best trial: 73. Best value: 0.713186:  88%|████████▊ | 88/100 [04:18<00:29,  2.47s/it]Best trial: 73. Best value: 0.713186:  89%|████████▉ | 89/100 [04:18<00:30,  2.74s/it]Best trial: 73. Best value: 0.713186:  89%|████████▉ | 89/100 [04:21<00:30,  2.74s/it]Best trial: 73. Best value: 0.713186:  90%|█████████ | 90/100 [04:21<00:28,  2.80s/it]Best trial: 73. Best value: 0.713186:  90%|█████████ | 90/100 [04:24<00:28,  2.80s/it]Best trial: 73. Best value: 0.713186:  91%|█████████ | 91/100 [04:24<00:26,  2.94s/it]Best trial: 73. Best value: 0.713186:  91%|█████████ | 91/100 [04:26<00:26,  2.94s/it]Best trial: 73. Best value: 0.713186:  92%|█████████▏| 92/100 [04:26<00:21,  2.65s/it]Best trial: 73. Best value: 0.713186:  92%|█████████▏| 92/100 [04:29<00:21,  2.65s/it]Best trial: 73. Best value: 0.713186:  93%|█████████▎| 93/100 [04:29<00:18,  2.62s/it]Best trial: 73. Best value: 0.713186:  93%|█████████▎| 93/100 [04:31<00:18,  2.62s/it]Best trial: 73. Best value: 0.713186:  94%|█████████▍| 94/100 [04:31<00:14,  2.35s/it]Best trial: 73. Best value: 0.713186:  94%|█████████▍| 94/100 [04:33<00:14,  2.35s/it]Best trial: 73. Best value: 0.713186:  95%|█████████▌| 95/100 [04:33<00:11,  2.36s/it]Best trial: 73. Best value: 0.713186:  95%|█████████▌| 95/100 [04:35<00:11,  2.36s/it]Best trial: 73. Best value: 0.713186:  96%|█████████▌| 96/100 [04:35<00:09,  2.39s/it]Best trial: 73. Best value: 0.713186:  96%|█████████▌| 96/100 [04:39<00:09,  2.39s/it]Best trial: 73. Best value: 0.713186:  97%|█████████▋| 97/100 [04:39<00:08,  2.75s/it]Best trial: 73. Best value: 0.713186:  97%|█████████▋| 97/100 [04:42<00:08,  2.75s/it]Best trial: 73. Best value: 0.713186:  98%|█████████▊| 98/100 [04:42<00:05,  2.75s/it]Best trial: 73. Best value: 0.713186:  98%|█████████▊| 98/100 [04:45<00:05,  2.75s/it]Best trial: 73. Best value: 0.713186:  99%|█████████▉| 99/100 [04:45<00:02,  2.78s/it]Best trial: 73. Best value: 0.713186:  99%|█████████▉| 99/100 [04:46<00:02,  2.78s/it]Best trial: 73. Best value: 0.713186: 100%|██████████| 100/100 [04:46<00:00,  2.51s/it]Best trial: 73. Best value: 0.713186: 100%|██████████| 100/100 [04:46<00:00,  2.87s/it]
2025-12-01 01:39:17,826 - INFO - HPO Complete. Best AUPRC: 0.7132
2025-12-01 01:39:17,826 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.0645071838026565, 'max_depth': 3, 'subsample': 0.9601152260761852, 'colsample_bytree': 0.9366944703892376, 'gamma': 2.610758313722453, 'reg_lambda': 3.249393431283743e-08, 'reg_alpha': 4.082773694716119e-06}
2025-12-01 01:39:17,827 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:39:19,653 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_pleth
2025-12-01 01:39:19,654 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:39:19,739 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:39:19,761 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:39:19,766 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:39:19,767 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:39:19,767 - INFO - Training model...
2025-12-01 01:39:20,765 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:39:26,005 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:39:26,005 - INFO - AUROC: 0.8854 (0.8527 - 0.9008)
2025-12-01 01:39:26,005 - INFO - AUPRC: 0.7088 (0.6577 - 0.7614)
2025-12-01 01:39:26,005 - INFO - Brier Score: 0.1110 (0.1024 - 0.1249)
2025-12-01 01:39:26,005 - INFO - Accuracy: 0.8627 (0.7751 - 0.8806)
2025-12-01 01:39:26,005 - INFO - Precision: 0.6818 (0.4763 - 0.7432)
2025-12-01 01:39:26,005 - INFO - Sensitivity (Recall): 0.6294 (0.6008 - 0.8227)
2025-12-01 01:39:26,005 - INFO - F1-Score: 0.6545 (0.5962 - 0.7097)
2025-12-01 01:39:26,005 - INFO - Best Threshold: 0.5800 (0.3200 - 0.5840)
2025-12-01 01:39:26,005 - INFO - Specificity: 0.9235 (0.7704 - 0.9368)
2025-12-01 01:39:26,018 - INFO - Calculating SHAP values...
2025-12-01 01:39:27,017 - INFO - SHAP plots saved.
2025-12-01 01:39:27,018 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:39:28,274 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_ecg
2025-12-01 01:39:28,275 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:39:28,384 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:39:28,410 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:39:28,417 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:39:28,418 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.663178:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.663178:   1%|          | 1/100 [00:03<06:33,  3.98s/it]Best trial: 1. Best value: 0.684608:   1%|          | 1/100 [00:08<06:33,  3.98s/it]Best trial: 1. Best value: 0.684608:   2%|▏         | 2/100 [00:08<06:59,  4.28s/it]Best trial: 1. Best value: 0.684608:   2%|▏         | 2/100 [00:14<06:59,  4.28s/it]Best trial: 1. Best value: 0.684608:   3%|▎         | 3/100 [00:14<08:00,  4.96s/it]Best trial: 1. Best value: 0.684608:   3%|▎         | 3/100 [00:17<08:00,  4.96s/it]Best trial: 1. Best value: 0.684608:   4%|▍         | 4/100 [00:17<06:38,  4.15s/it]Best trial: 1. Best value: 0.684608:   4%|▍         | 4/100 [00:19<06:38,  4.15s/it]Best trial: 1. Best value: 0.684608:   5%|▌         | 5/100 [00:19<05:22,  3.39s/it]Best trial: 1. Best value: 0.684608:   5%|▌         | 5/100 [00:21<05:22,  3.39s/it]Best trial: 1. Best value: 0.684608:   6%|▌         | 6/100 [00:21<04:29,  2.86s/it]Best trial: 1. Best value: 0.684608:   6%|▌         | 6/100 [00:24<04:29,  2.86s/it]Best trial: 1. Best value: 0.684608:   7%|▋         | 7/100 [00:24<04:50,  3.12s/it]Best trial: 7. Best value: 0.703784:   7%|▋         | 7/100 [00:26<04:50,  3.12s/it]Best trial: 7. Best value: 0.703784:   8%|▊         | 8/100 [00:26<04:22,  2.85s/it]Best trial: 7. Best value: 0.703784:   8%|▊         | 8/100 [00:32<04:22,  2.85s/it]Best trial: 7. Best value: 0.703784:   9%|▉         | 9/100 [00:32<05:28,  3.61s/it]Best trial: 7. Best value: 0.703784:   9%|▉         | 9/100 [00:34<05:28,  3.61s/it]Best trial: 7. Best value: 0.703784:  10%|█         | 10/100 [00:34<04:44,  3.16s/it]Best trial: 7. Best value: 0.703784:  10%|█         | 10/100 [00:36<04:44,  3.16s/it]Best trial: 7. Best value: 0.703784:  11%|█         | 11/100 [00:36<04:00,  2.70s/it]Best trial: 7. Best value: 0.703784:  11%|█         | 11/100 [00:37<04:00,  2.70s/it]Best trial: 7. Best value: 0.703784:  12%|█▏        | 12/100 [00:37<03:35,  2.45s/it]Best trial: 7. Best value: 0.703784:  12%|█▏        | 12/100 [00:39<03:35,  2.45s/it]Best trial: 7. Best value: 0.703784:  13%|█▎        | 13/100 [00:39<03:09,  2.18s/it]Best trial: 7. Best value: 0.703784:  13%|█▎        | 13/100 [00:43<03:09,  2.18s/it]Best trial: 7. Best value: 0.703784:  14%|█▍        | 14/100 [00:43<03:57,  2.76s/it]Best trial: 7. Best value: 0.703784:  14%|█▍        | 14/100 [00:45<03:57,  2.76s/it]Best trial: 7. Best value: 0.703784:  15%|█▌        | 15/100 [00:45<03:45,  2.65s/it]Best trial: 7. Best value: 0.703784:  15%|█▌        | 15/100 [00:49<03:45,  2.65s/it]Best trial: 7. Best value: 0.703784:  16%|█▌        | 16/100 [00:49<03:55,  2.80s/it]Best trial: 7. Best value: 0.703784:  16%|█▌        | 16/100 [00:51<03:55,  2.80s/it]Best trial: 7. Best value: 0.703784:  17%|█▋        | 17/100 [00:51<03:38,  2.64s/it]Best trial: 7. Best value: 0.703784:  17%|█▋        | 17/100 [00:54<03:38,  2.64s/it]Best trial: 7. Best value: 0.703784:  18%|█▊        | 18/100 [00:54<03:39,  2.68s/it]Best trial: 7. Best value: 0.703784:  18%|█▊        | 18/100 [00:57<03:39,  2.68s/it]Best trial: 7. Best value: 0.703784:  19%|█▉        | 19/100 [00:57<03:54,  2.89s/it]Best trial: 7. Best value: 0.703784:  19%|█▉        | 19/100 [00:58<03:54,  2.89s/it]Best trial: 7. Best value: 0.703784:  20%|██        | 20/100 [00:58<03:15,  2.45s/it]Best trial: 7. Best value: 0.703784:  20%|██        | 20/100 [01:01<03:15,  2.45s/it]Best trial: 7. Best value: 0.703784:  21%|██        | 21/100 [01:01<03:21,  2.56s/it]Best trial: 7. Best value: 0.703784:  21%|██        | 21/100 [01:04<03:21,  2.56s/it]Best trial: 7. Best value: 0.703784:  22%|██▏       | 22/100 [01:04<03:24,  2.62s/it]Best trial: 7. Best value: 0.703784:  22%|██▏       | 22/100 [01:08<03:24,  2.62s/it]Best trial: 7. Best value: 0.703784:  23%|██▎       | 23/100 [01:08<03:42,  2.89s/it]Best trial: 7. Best value: 0.703784:  23%|██▎       | 23/100 [01:11<03:42,  2.89s/it]Best trial: 7. Best value: 0.703784:  24%|██▍       | 24/100 [01:11<03:42,  2.93s/it]Best trial: 7. Best value: 0.703784:  24%|██▍       | 24/100 [01:13<03:42,  2.93s/it]Best trial: 7. Best value: 0.703784:  25%|██▌       | 25/100 [01:13<03:28,  2.78s/it]Best trial: 7. Best value: 0.703784:  25%|██▌       | 25/100 [01:16<03:28,  2.78s/it]Best trial: 7. Best value: 0.703784:  26%|██▌       | 26/100 [01:16<03:26,  2.79s/it]Best trial: 7. Best value: 0.703784:  26%|██▌       | 26/100 [01:18<03:26,  2.79s/it]Best trial: 7. Best value: 0.703784:  27%|██▋       | 27/100 [01:18<03:18,  2.72s/it]Best trial: 7. Best value: 0.703784:  27%|██▋       | 27/100 [01:22<03:18,  2.72s/it]Best trial: 7. Best value: 0.703784:  28%|██▊       | 28/100 [01:22<03:27,  2.88s/it]Best trial: 7. Best value: 0.703784:  28%|██▊       | 28/100 [01:25<03:27,  2.88s/it]Best trial: 7. Best value: 0.703784:  29%|██▉       | 29/100 [01:25<03:43,  3.14s/it]Best trial: 7. Best value: 0.703784:  29%|██▉       | 29/100 [01:29<03:43,  3.14s/it]Best trial: 7. Best value: 0.703784:  30%|███       | 30/100 [01:29<03:49,  3.28s/it]Best trial: 7. Best value: 0.703784:  30%|███       | 30/100 [01:31<03:49,  3.28s/it]Best trial: 7. Best value: 0.703784:  31%|███       | 31/100 [01:31<03:26,  3.00s/it]Best trial: 7. Best value: 0.703784:  31%|███       | 31/100 [01:35<03:26,  3.00s/it]Best trial: 7. Best value: 0.703784:  32%|███▏      | 32/100 [01:35<03:37,  3.20s/it]Best trial: 7. Best value: 0.703784:  32%|███▏      | 32/100 [01:38<03:37,  3.20s/it]Best trial: 7. Best value: 0.703784:  33%|███▎      | 33/100 [01:38<03:21,  3.00s/it]Best trial: 7. Best value: 0.703784:  33%|███▎      | 33/100 [01:41<03:21,  3.00s/it]Best trial: 7. Best value: 0.703784:  34%|███▍      | 34/100 [01:41<03:36,  3.29s/it]Best trial: 7. Best value: 0.703784:  34%|███▍      | 34/100 [01:44<03:36,  3.29s/it]Best trial: 7. Best value: 0.703784:  35%|███▌      | 35/100 [01:44<03:24,  3.14s/it]Best trial: 7. Best value: 0.703784:  35%|███▌      | 35/100 [01:47<03:24,  3.14s/it]Best trial: 7. Best value: 0.703784:  36%|███▌      | 36/100 [01:47<03:17,  3.09s/it]Best trial: 7. Best value: 0.703784:  36%|███▌      | 36/100 [01:53<03:17,  3.09s/it]Best trial: 7. Best value: 0.703784:  37%|███▋      | 37/100 [01:53<03:59,  3.80s/it]Best trial: 7. Best value: 0.703784:  37%|███▋      | 37/100 [01:56<03:59,  3.80s/it]Best trial: 7. Best value: 0.703784:  38%|███▊      | 38/100 [01:56<03:51,  3.73s/it]Best trial: 7. Best value: 0.703784:  38%|███▊      | 38/100 [01:59<03:51,  3.73s/it]Best trial: 7. Best value: 0.703784:  39%|███▉      | 39/100 [01:59<03:36,  3.54s/it]Best trial: 7. Best value: 0.703784:  39%|███▉      | 39/100 [02:02<03:36,  3.54s/it]Best trial: 7. Best value: 0.703784:  40%|████      | 40/100 [02:02<03:14,  3.24s/it]Best trial: 7. Best value: 0.703784:  40%|████      | 40/100 [02:04<03:14,  3.24s/it]Best trial: 7. Best value: 0.703784:  41%|████      | 41/100 [02:04<02:54,  2.96s/it]Best trial: 7. Best value: 0.703784:  41%|████      | 41/100 [02:07<02:54,  2.96s/it]Best trial: 7. Best value: 0.703784:  42%|████▏     | 42/100 [02:07<02:51,  2.95s/it]Best trial: 7. Best value: 0.703784:  42%|████▏     | 42/100 [02:11<02:51,  2.95s/it]Best trial: 7. Best value: 0.703784:  43%|████▎     | 43/100 [02:11<03:00,  3.16s/it]Best trial: 7. Best value: 0.703784:  43%|████▎     | 43/100 [02:14<03:00,  3.16s/it]Best trial: 7. Best value: 0.703784:  44%|████▍     | 44/100 [02:14<02:53,  3.09s/it]Best trial: 7. Best value: 0.703784:  44%|████▍     | 44/100 [02:16<02:53,  3.09s/it]Best trial: 7. Best value: 0.703784:  45%|████▌     | 45/100 [02:16<02:41,  2.93s/it]Best trial: 7. Best value: 0.703784:  45%|████▌     | 45/100 [02:19<02:41,  2.93s/it]Best trial: 7. Best value: 0.703784:  46%|████▌     | 46/100 [02:19<02:40,  2.97s/it]Best trial: 7. Best value: 0.703784:  46%|████▌     | 46/100 [02:23<02:40,  2.97s/it]Best trial: 7. Best value: 0.703784:  47%|████▋     | 47/100 [02:23<02:42,  3.07s/it]Best trial: 7. Best value: 0.703784:  47%|████▋     | 47/100 [02:27<02:42,  3.07s/it]Best trial: 7. Best value: 0.703784:  48%|████▊     | 48/100 [02:27<02:53,  3.33s/it]Best trial: 7. Best value: 0.703784:  48%|████▊     | 48/100 [02:31<02:53,  3.33s/it]Best trial: 7. Best value: 0.703784:  49%|████▉     | 49/100 [02:31<03:07,  3.68s/it]Best trial: 7. Best value: 0.703784:  49%|████▉     | 49/100 [02:33<03:07,  3.68s/it]Best trial: 7. Best value: 0.703784:  50%|█████     | 50/100 [02:33<02:32,  3.06s/it]Best trial: 7. Best value: 0.703784:  50%|█████     | 50/100 [02:35<02:32,  3.06s/it]Best trial: 7. Best value: 0.703784:  51%|█████     | 51/100 [02:35<02:19,  2.85s/it]Best trial: 7. Best value: 0.703784:  51%|█████     | 51/100 [02:38<02:19,  2.85s/it]Best trial: 7. Best value: 0.703784:  52%|█████▏    | 52/100 [02:38<02:14,  2.80s/it]Best trial: 7. Best value: 0.703784:  52%|█████▏    | 52/100 [02:40<02:14,  2.80s/it]Best trial: 7. Best value: 0.703784:  53%|█████▎    | 53/100 [02:40<02:00,  2.56s/it]Best trial: 7. Best value: 0.703784:  53%|█████▎    | 53/100 [02:43<02:00,  2.56s/it]Best trial: 7. Best value: 0.703784:  54%|█████▍    | 54/100 [02:43<02:03,  2.69s/it]Best trial: 7. Best value: 0.703784:  54%|█████▍    | 54/100 [02:45<02:03,  2.69s/it]Best trial: 7. Best value: 0.703784:  55%|█████▌    | 55/100 [02:45<01:58,  2.64s/it]Best trial: 7. Best value: 0.703784:  55%|█████▌    | 55/100 [02:48<01:58,  2.64s/it]Best trial: 7. Best value: 0.703784:  56%|█████▌    | 56/100 [02:48<01:58,  2.69s/it]Best trial: 7. Best value: 0.703784:  56%|█████▌    | 56/100 [02:51<01:58,  2.69s/it]Best trial: 7. Best value: 0.703784:  57%|█████▋    | 57/100 [02:51<02:04,  2.90s/it]Best trial: 7. Best value: 0.703784:  57%|█████▋    | 57/100 [02:53<02:04,  2.90s/it]Best trial: 7. Best value: 0.703784:  58%|█████▊    | 58/100 [02:53<01:49,  2.61s/it]Best trial: 7. Best value: 0.703784:  58%|█████▊    | 58/100 [02:56<01:49,  2.61s/it]Best trial: 7. Best value: 0.703784:  59%|█████▉    | 59/100 [02:56<01:42,  2.50s/it]Best trial: 7. Best value: 0.703784:  59%|█████▉    | 59/100 [02:58<01:42,  2.50s/it]Best trial: 7. Best value: 0.703784:  60%|██████    | 60/100 [02:58<01:42,  2.57s/it]Best trial: 7. Best value: 0.703784:  60%|██████    | 60/100 [03:00<01:42,  2.57s/it]Best trial: 7. Best value: 0.703784:  61%|██████    | 61/100 [03:00<01:31,  2.33s/it]Best trial: 7. Best value: 0.703784:  61%|██████    | 61/100 [03:03<01:31,  2.33s/it]Best trial: 7. Best value: 0.703784:  62%|██████▏   | 62/100 [03:03<01:34,  2.48s/it]Best trial: 7. Best value: 0.703784:  62%|██████▏   | 62/100 [03:06<01:34,  2.48s/it]Best trial: 7. Best value: 0.703784:  63%|██████▎   | 63/100 [03:06<01:34,  2.56s/it]Best trial: 7. Best value: 0.703784:  63%|██████▎   | 63/100 [03:08<01:34,  2.56s/it]Best trial: 7. Best value: 0.703784:  64%|██████▍   | 64/100 [03:08<01:26,  2.41s/it]Best trial: 7. Best value: 0.703784:  64%|██████▍   | 64/100 [03:10<01:26,  2.41s/it]Best trial: 7. Best value: 0.703784:  65%|██████▌   | 65/100 [03:10<01:19,  2.26s/it]Best trial: 7. Best value: 0.703784:  65%|██████▌   | 65/100 [03:12<01:19,  2.26s/it]Best trial: 7. Best value: 0.703784:  66%|██████▌   | 66/100 [03:12<01:12,  2.14s/it]Best trial: 66. Best value: 0.704427:  66%|██████▌   | 66/100 [03:14<01:12,  2.14s/it]Best trial: 66. Best value: 0.704427:  67%|██████▋   | 67/100 [03:14<01:11,  2.18s/it]Best trial: 66. Best value: 0.704427:  67%|██████▋   | 67/100 [03:16<01:11,  2.18s/it]Best trial: 66. Best value: 0.704427:  68%|██████▊   | 68/100 [03:16<01:10,  2.20s/it]Best trial: 66. Best value: 0.704427:  68%|██████▊   | 68/100 [03:18<01:10,  2.20s/it]Best trial: 66. Best value: 0.704427:  69%|██████▉   | 69/100 [03:18<01:03,  2.04s/it]Best trial: 66. Best value: 0.704427:  69%|██████▉   | 69/100 [03:20<01:03,  2.04s/it]Best trial: 66. Best value: 0.704427:  70%|███████   | 70/100 [03:20<01:00,  2.01s/it]Best trial: 66. Best value: 0.704427:  70%|███████   | 70/100 [03:22<01:00,  2.01s/it]Best trial: 66. Best value: 0.704427:  71%|███████   | 71/100 [03:22<01:02,  2.15s/it]Best trial: 71. Best value: 0.706975:  71%|███████   | 71/100 [03:25<01:02,  2.15s/it]Best trial: 71. Best value: 0.706975:  72%|███████▏  | 72/100 [03:25<01:02,  2.24s/it]Best trial: 71. Best value: 0.706975:  72%|███████▏  | 72/100 [03:27<01:02,  2.24s/it]Best trial: 71. Best value: 0.706975:  73%|███████▎  | 73/100 [03:27<00:58,  2.16s/it]Best trial: 71. Best value: 0.706975:  73%|███████▎  | 73/100 [03:29<00:58,  2.16s/it]Best trial: 71. Best value: 0.706975:  74%|███████▍  | 74/100 [03:29<00:54,  2.09s/it]Best trial: 71. Best value: 0.706975:  74%|███████▍  | 74/100 [03:31<00:54,  2.09s/it]Best trial: 71. Best value: 0.706975:  75%|███████▌  | 75/100 [03:31<00:53,  2.15s/it]Best trial: 71. Best value: 0.706975:  75%|███████▌  | 75/100 [03:33<00:53,  2.15s/it]Best trial: 71. Best value: 0.706975:  76%|███████▌  | 76/100 [03:33<00:54,  2.29s/it]Best trial: 71. Best value: 0.706975:  76%|███████▌  | 76/100 [03:38<00:54,  2.29s/it]Best trial: 71. Best value: 0.706975:  77%|███████▋  | 77/100 [03:38<01:09,  3.02s/it]Best trial: 71. Best value: 0.706975:  77%|███████▋  | 77/100 [03:40<01:09,  3.02s/it]Best trial: 71. Best value: 0.706975:  78%|███████▊  | 78/100 [03:40<01:01,  2.79s/it]Best trial: 71. Best value: 0.706975:  78%|███████▊  | 78/100 [03:43<01:01,  2.79s/it]Best trial: 71. Best value: 0.706975:  79%|███████▉  | 79/100 [03:43<00:58,  2.76s/it]Best trial: 71. Best value: 0.706975:  79%|███████▉  | 79/100 [03:47<00:58,  2.76s/it]Best trial: 71. Best value: 0.706975:  80%|████████  | 80/100 [03:47<01:04,  3.24s/it]Best trial: 71. Best value: 0.706975:  80%|████████  | 80/100 [03:51<01:04,  3.24s/it]Best trial: 71. Best value: 0.706975:  81%|████████  | 81/100 [03:51<01:02,  3.29s/it]Best trial: 71. Best value: 0.706975:  81%|████████  | 81/100 [03:54<01:02,  3.29s/it]Best trial: 71. Best value: 0.706975:  82%|████████▏ | 82/100 [03:54<00:59,  3.32s/it]Best trial: 71. Best value: 0.706975:  82%|████████▏ | 82/100 [03:58<00:59,  3.32s/it]Best trial: 71. Best value: 0.706975:  83%|████████▎ | 83/100 [03:58<00:57,  3.41s/it]Best trial: 71. Best value: 0.706975:  83%|████████▎ | 83/100 [04:01<00:57,  3.41s/it]Best trial: 71. Best value: 0.706975:  84%|████████▍ | 84/100 [04:01<00:53,  3.33s/it]Best trial: 71. Best value: 0.706975:  84%|████████▍ | 84/100 [04:03<00:53,  3.33s/it]Best trial: 71. Best value: 0.706975:  85%|████████▌ | 85/100 [04:03<00:45,  3.05s/it]Best trial: 71. Best value: 0.706975:  85%|████████▌ | 85/100 [04:06<00:45,  3.05s/it]Best trial: 71. Best value: 0.706975:  86%|████████▌ | 86/100 [04:06<00:39,  2.79s/it]Best trial: 71. Best value: 0.706975:  86%|████████▌ | 86/100 [04:08<00:39,  2.79s/it]Best trial: 71. Best value: 0.706975:  87%|████████▋ | 87/100 [04:08<00:33,  2.61s/it]Best trial: 71. Best value: 0.706975:  87%|████████▋ | 87/100 [04:11<00:33,  2.61s/it]Best trial: 71. Best value: 0.706975:  88%|████████▊ | 88/100 [04:11<00:33,  2.76s/it]Best trial: 71. Best value: 0.706975:  88%|████████▊ | 88/100 [04:13<00:33,  2.76s/it]Best trial: 71. Best value: 0.706975:  89%|████████▉ | 89/100 [04:13<00:29,  2.70s/it]Best trial: 71. Best value: 0.706975:  89%|████████▉ | 89/100 [04:17<00:29,  2.70s/it]Best trial: 71. Best value: 0.706975:  90%|█████████ | 90/100 [04:17<00:29,  2.96s/it]Best trial: 71. Best value: 0.706975:  90%|█████████ | 90/100 [04:20<00:29,  2.96s/it]Best trial: 71. Best value: 0.706975:  91%|█████████ | 91/100 [04:20<00:25,  2.86s/it]Best trial: 71. Best value: 0.706975:  91%|█████████ | 91/100 [04:22<00:25,  2.86s/it]Best trial: 71. Best value: 0.706975:  92%|█████████▏| 92/100 [04:22<00:22,  2.85s/it]Best trial: 71. Best value: 0.706975:  92%|█████████▏| 92/100 [04:25<00:22,  2.85s/it]Best trial: 71. Best value: 0.706975:  93%|█████████▎| 93/100 [04:25<00:18,  2.62s/it]Best trial: 71. Best value: 0.706975:  93%|█████████▎| 93/100 [04:27<00:18,  2.62s/it]Best trial: 71. Best value: 0.706975:  94%|█████████▍| 94/100 [04:27<00:14,  2.46s/it]Best trial: 71. Best value: 0.706975:  94%|█████████▍| 94/100 [04:29<00:14,  2.46s/it]Best trial: 71. Best value: 0.706975:  95%|█████████▌| 95/100 [04:29<00:11,  2.32s/it]Best trial: 95. Best value: 0.709867:  95%|█████████▌| 95/100 [04:31<00:11,  2.32s/it]Best trial: 95. Best value: 0.709867:  96%|█████████▌| 96/100 [04:31<00:09,  2.48s/it]Best trial: 95. Best value: 0.709867:  96%|█████████▌| 96/100 [04:34<00:09,  2.48s/it]Best trial: 95. Best value: 0.709867:  97%|█████████▋| 97/100 [04:34<00:07,  2.47s/it]Best trial: 95. Best value: 0.709867:  97%|█████████▋| 97/100 [04:36<00:07,  2.47s/it]Best trial: 95. Best value: 0.709867:  98%|█████████▊| 98/100 [04:36<00:04,  2.39s/it]Best trial: 95. Best value: 0.709867:  98%|█████████▊| 98/100 [04:39<00:04,  2.39s/it]Best trial: 95. Best value: 0.709867:  99%|█████████▉| 99/100 [04:39<00:02,  2.43s/it]Best trial: 95. Best value: 0.709867:  99%|█████████▉| 99/100 [04:41<00:02,  2.43s/it]Best trial: 95. Best value: 0.709867: 100%|██████████| 100/100 [04:41<00:00,  2.32s/it]Best trial: 95. Best value: 0.709867: 100%|██████████| 100/100 [04:41<00:00,  2.81s/it]
2025-12-01 01:44:09,616 - INFO - HPO Complete. Best AUPRC: 0.7099
2025-12-01 01:44:09,616 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.056714141569864644, 'max_depth': 3, 'subsample': 0.6885100133941169, 'colsample_bytree': 0.614116096603417, 'gamma': 4.134339900083868, 'reg_lambda': 9.984866231298665e-06, 'reg_alpha': 3.710407739945137e-05}
2025-12-01 01:44:09,617 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:44:11,467 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_ecg
2025-12-01 01:44:11,468 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:44:11,552 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:44:11,575 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:44:11,580 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:44:11,580 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:44:11,580 - INFO - Training model...
2025-12-01 01:44:12,738 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:44:17,955 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:44:17,955 - INFO - AUROC: 0.8874 (0.8615 - 0.9026)
2025-12-01 01:44:17,955 - INFO - AUPRC: 0.7246 (0.6726 - 0.7709)
2025-12-01 01:44:17,955 - INFO - Brier Score: 0.1066 (0.0979 - 0.1216)
2025-12-01 01:44:17,955 - INFO - Accuracy: 0.8627 (0.8240 - 0.8974)
2025-12-01 01:44:17,955 - INFO - Precision: 0.6818 (0.5969 - 0.8929)
2025-12-01 01:44:17,955 - INFO - Sensitivity (Recall): 0.6294 (0.4943 - 0.7090)
2025-12-01 01:44:17,955 - INFO - F1-Score: 0.6545 (0.6034 - 0.7112)
2025-12-01 01:44:17,955 - INFO - Best Threshold: 0.5600 (0.4080 - 0.7560)
2025-12-01 01:44:17,955 - INFO - Specificity: 0.9235 (0.8658 - 0.9841)
2025-12-01 01:44:17,970 - INFO - Calculating SHAP values...
2025-12-01 01:44:19,019 - INFO - SHAP plots saved.
2025-12-01 01:44:19,021 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:44:20,297 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_co2
2025-12-01 01:44:20,297 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:44:20,391 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:44:20,415 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:44:20,422 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:44:20,422 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.667338:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.667338:   1%|          | 1/100 [00:04<07:40,  4.65s/it]Best trial: 1. Best value: 0.670007:   1%|          | 1/100 [00:07<07:40,  4.65s/it]Best trial: 1. Best value: 0.670007:   2%|▏         | 2/100 [00:07<05:36,  3.44s/it]Best trial: 2. Best value: 0.691409:   2%|▏         | 2/100 [00:11<05:36,  3.44s/it]Best trial: 2. Best value: 0.691409:   3%|▎         | 3/100 [00:11<06:23,  3.95s/it]Best trial: 2. Best value: 0.691409:   3%|▎         | 3/100 [00:20<06:23,  3.95s/it]Best trial: 2. Best value: 0.691409:   4%|▍         | 4/100 [00:20<09:02,  5.65s/it]Best trial: 4. Best value: 0.696424:   4%|▍         | 4/100 [00:24<09:02,  5.65s/it]Best trial: 4. Best value: 0.696424:   5%|▌         | 5/100 [00:24<08:10,  5.17s/it]Best trial: 4. Best value: 0.696424:   5%|▌         | 5/100 [00:29<08:10,  5.17s/it]Best trial: 4. Best value: 0.696424:   6%|▌         | 6/100 [00:29<08:00,  5.11s/it]Best trial: 4. Best value: 0.696424:   6%|▌         | 6/100 [00:31<08:00,  5.11s/it]Best trial: 4. Best value: 0.696424:   7%|▋         | 7/100 [00:31<06:26,  4.16s/it]Best trial: 7. Best value: 0.699865:   7%|▋         | 7/100 [00:32<06:26,  4.16s/it]Best trial: 7. Best value: 0.699865:   8%|▊         | 8/100 [00:32<05:02,  3.28s/it]Best trial: 7. Best value: 0.699865:   8%|▊         | 8/100 [00:38<05:02,  3.28s/it]Best trial: 7. Best value: 0.699865:   9%|▉         | 9/100 [00:38<06:16,  4.14s/it]Best trial: 7. Best value: 0.699865:   9%|▉         | 9/100 [00:41<06:16,  4.14s/it]Best trial: 7. Best value: 0.699865:  10%|█         | 10/100 [00:41<05:14,  3.50s/it]Best trial: 10. Best value: 0.700292:  10%|█         | 10/100 [00:42<05:14,  3.50s/it]Best trial: 10. Best value: 0.700292:  11%|█         | 11/100 [00:42<04:27,  3.01s/it]Best trial: 11. Best value: 0.701019:  11%|█         | 11/100 [00:44<04:27,  3.01s/it]Best trial: 11. Best value: 0.701019:  12%|█▏        | 12/100 [00:44<03:54,  2.67s/it]Best trial: 11. Best value: 0.701019:  12%|█▏        | 12/100 [00:46<03:54,  2.67s/it]Best trial: 11. Best value: 0.701019:  13%|█▎        | 13/100 [00:46<03:29,  2.40s/it]Best trial: 13. Best value: 0.709334:  13%|█▎        | 13/100 [00:49<03:29,  2.40s/it]Best trial: 13. Best value: 0.709334:  14%|█▍        | 14/100 [00:49<03:33,  2.48s/it]Best trial: 13. Best value: 0.709334:  14%|█▍        | 14/100 [00:52<03:33,  2.48s/it]Best trial: 13. Best value: 0.709334:  15%|█▌        | 15/100 [00:52<03:38,  2.57s/it]Best trial: 13. Best value: 0.709334:  15%|█▌        | 15/100 [00:54<03:38,  2.57s/it]Best trial: 13. Best value: 0.709334:  16%|█▌        | 16/100 [00:54<03:39,  2.62s/it]Best trial: 13. Best value: 0.709334:  16%|█▌        | 16/100 [00:56<03:39,  2.62s/it]Best trial: 13. Best value: 0.709334:  17%|█▋        | 17/100 [00:56<03:12,  2.32s/it]Best trial: 13. Best value: 0.709334:  17%|█▋        | 17/100 [00:59<03:12,  2.32s/it]Best trial: 13. Best value: 0.709334:  18%|█▊        | 18/100 [00:59<03:18,  2.43s/it]Best trial: 13. Best value: 0.709334:  18%|█▊        | 18/100 [01:04<03:18,  2.43s/it]Best trial: 13. Best value: 0.709334:  19%|█▉        | 19/100 [01:04<04:36,  3.42s/it]Best trial: 13. Best value: 0.709334:  19%|█▉        | 19/100 [01:10<04:36,  3.42s/it]Best trial: 13. Best value: 0.709334:  20%|██        | 20/100 [01:10<05:25,  4.07s/it]Best trial: 13. Best value: 0.709334:  20%|██        | 20/100 [01:13<05:25,  4.07s/it]Best trial: 13. Best value: 0.709334:  21%|██        | 21/100 [01:13<05:00,  3.80s/it]Best trial: 13. Best value: 0.709334:  21%|██        | 21/100 [01:18<05:00,  3.80s/it]Best trial: 13. Best value: 0.709334:  22%|██▏       | 22/100 [01:18<05:20,  4.11s/it]Best trial: 13. Best value: 0.709334:  22%|██▏       | 22/100 [01:23<05:20,  4.11s/it]Best trial: 13. Best value: 0.709334:  23%|██▎       | 23/100 [01:23<05:32,  4.32s/it]Best trial: 13. Best value: 0.709334:  23%|██▎       | 23/100 [01:29<05:32,  4.32s/it]Best trial: 13. Best value: 0.709334:  24%|██▍       | 24/100 [01:29<06:14,  4.93s/it]Best trial: 13. Best value: 0.709334:  24%|██▍       | 24/100 [01:31<06:14,  4.93s/it]Best trial: 13. Best value: 0.709334:  25%|██▌       | 25/100 [01:31<05:09,  4.13s/it]Best trial: 13. Best value: 0.709334:  25%|██▌       | 25/100 [01:33<05:09,  4.13s/it]Best trial: 13. Best value: 0.709334:  26%|██▌       | 26/100 [01:33<04:10,  3.38s/it]Best trial: 13. Best value: 0.709334:  26%|██▌       | 26/100 [01:36<04:10,  3.38s/it]Best trial: 13. Best value: 0.709334:  27%|██▋       | 27/100 [01:36<04:03,  3.33s/it]Best trial: 13. Best value: 0.709334:  27%|██▋       | 27/100 [01:40<04:03,  3.33s/it]Best trial: 13. Best value: 0.709334:  28%|██▊       | 28/100 [01:40<04:01,  3.35s/it]Best trial: 13. Best value: 0.709334:  28%|██▊       | 28/100 [01:44<04:01,  3.35s/it]Best trial: 13. Best value: 0.709334:  29%|██▉       | 29/100 [01:44<04:17,  3.62s/it]Best trial: 13. Best value: 0.709334:  29%|██▉       | 29/100 [01:48<04:17,  3.62s/it]Best trial: 13. Best value: 0.709334:  30%|███       | 30/100 [01:48<04:19,  3.70s/it]Best trial: 13. Best value: 0.709334:  30%|███       | 30/100 [01:52<04:19,  3.70s/it]Best trial: 13. Best value: 0.709334:  31%|███       | 31/100 [01:52<04:31,  3.93s/it]Best trial: 13. Best value: 0.709334:  31%|███       | 31/100 [01:55<04:31,  3.93s/it]Best trial: 13. Best value: 0.709334:  32%|███▏      | 32/100 [01:55<04:11,  3.71s/it]Best trial: 13. Best value: 0.709334:  32%|███▏      | 32/100 [02:00<04:11,  3.71s/it]Best trial: 13. Best value: 0.709334:  33%|███▎      | 33/100 [02:00<04:31,  4.05s/it]Best trial: 13. Best value: 0.709334:  33%|███▎      | 33/100 [02:03<04:31,  4.05s/it]Best trial: 13. Best value: 0.709334:  34%|███▍      | 34/100 [02:03<04:04,  3.70s/it]Best trial: 13. Best value: 0.709334:  34%|███▍      | 34/100 [02:06<04:04,  3.70s/it]Best trial: 13. Best value: 0.709334:  35%|███▌      | 35/100 [02:06<03:37,  3.34s/it]Best trial: 13. Best value: 0.709334:  35%|███▌      | 35/100 [02:13<03:37,  3.34s/it]Best trial: 13. Best value: 0.709334:  36%|███▌      | 36/100 [02:13<04:44,  4.45s/it]Best trial: 13. Best value: 0.709334:  36%|███▌      | 36/100 [02:18<04:44,  4.45s/it]Best trial: 13. Best value: 0.709334:  37%|███▋      | 37/100 [02:18<04:55,  4.68s/it]Best trial: 13. Best value: 0.709334:  37%|███▋      | 37/100 [02:23<04:55,  4.68s/it]Best trial: 13. Best value: 0.709334:  38%|███▊      | 38/100 [02:23<04:49,  4.67s/it]Best trial: 13. Best value: 0.709334:  38%|███▊      | 38/100 [02:27<04:49,  4.67s/it]Best trial: 13. Best value: 0.709334:  39%|███▉      | 39/100 [02:27<04:43,  4.64s/it]Best trial: 13. Best value: 0.709334:  39%|███▉      | 39/100 [02:32<04:43,  4.64s/it]Best trial: 13. Best value: 0.709334:  40%|████      | 40/100 [02:32<04:34,  4.58s/it]Best trial: 13. Best value: 0.709334:  40%|████      | 40/100 [02:37<04:34,  4.58s/it]Best trial: 13. Best value: 0.709334:  41%|████      | 41/100 [02:37<04:51,  4.94s/it]Best trial: 13. Best value: 0.709334:  41%|████      | 41/100 [02:39<04:51,  4.94s/it]Best trial: 13. Best value: 0.709334:  42%|████▏     | 42/100 [02:39<03:53,  4.02s/it]Best trial: 13. Best value: 0.709334:  42%|████▏     | 42/100 [02:43<03:53,  4.02s/it]Best trial: 13. Best value: 0.709334:  43%|████▎     | 43/100 [02:43<03:40,  3.88s/it]Best trial: 13. Best value: 0.709334:  43%|████▎     | 43/100 [02:45<03:40,  3.88s/it]Best trial: 13. Best value: 0.709334:  44%|████▍     | 44/100 [02:45<03:02,  3.26s/it]Best trial: 44. Best value: 0.716413:  44%|████▍     | 44/100 [02:47<03:02,  3.26s/it]Best trial: 44. Best value: 0.716413:  45%|████▌     | 45/100 [02:47<02:41,  2.93s/it]Best trial: 44. Best value: 0.716413:  45%|████▌     | 45/100 [02:49<02:41,  2.93s/it]Best trial: 44. Best value: 0.716413:  46%|████▌     | 46/100 [02:49<02:26,  2.70s/it]Best trial: 44. Best value: 0.716413:  46%|████▌     | 46/100 [02:51<02:26,  2.70s/it]Best trial: 44. Best value: 0.716413:  47%|████▋     | 47/100 [02:51<02:13,  2.52s/it]Best trial: 44. Best value: 0.716413:  47%|████▋     | 47/100 [02:53<02:13,  2.52s/it]Best trial: 44. Best value: 0.716413:  48%|████▊     | 48/100 [02:53<02:06,  2.44s/it]Best trial: 44. Best value: 0.716413:  48%|████▊     | 48/100 [02:55<02:06,  2.44s/it]Best trial: 44. Best value: 0.716413:  49%|████▉     | 49/100 [02:55<01:56,  2.29s/it]Best trial: 49. Best value: 0.716959:  49%|████▉     | 49/100 [02:57<01:56,  2.29s/it]Best trial: 49. Best value: 0.716959:  50%|█████     | 50/100 [02:57<01:51,  2.24s/it]Best trial: 49. Best value: 0.716959:  50%|█████     | 50/100 [02:59<01:51,  2.24s/it]Best trial: 49. Best value: 0.716959:  51%|█████     | 51/100 [02:59<01:40,  2.05s/it]Best trial: 49. Best value: 0.716959:  51%|█████     | 51/100 [03:01<01:40,  2.05s/it]Best trial: 49. Best value: 0.716959:  52%|█████▏    | 52/100 [03:01<01:37,  2.02s/it]Best trial: 49. Best value: 0.716959:  52%|█████▏    | 52/100 [03:04<01:37,  2.02s/it]Best trial: 49. Best value: 0.716959:  53%|█████▎    | 53/100 [03:04<01:53,  2.41s/it]Best trial: 49. Best value: 0.716959:  53%|█████▎    | 53/100 [03:07<01:53,  2.41s/it]Best trial: 49. Best value: 0.716959:  54%|█████▍    | 54/100 [03:07<01:53,  2.47s/it]Best trial: 49. Best value: 0.716959:  54%|█████▍    | 54/100 [03:09<01:53,  2.47s/it]Best trial: 49. Best value: 0.716959:  55%|█████▌    | 55/100 [03:09<01:44,  2.33s/it]Best trial: 49. Best value: 0.716959:  55%|█████▌    | 55/100 [03:11<01:44,  2.33s/it]Best trial: 49. Best value: 0.716959:  56%|█████▌    | 56/100 [03:11<01:35,  2.18s/it]Best trial: 49. Best value: 0.716959:  56%|█████▌    | 56/100 [03:12<01:35,  2.18s/it]Best trial: 49. Best value: 0.716959:  57%|█████▋    | 57/100 [03:12<01:27,  2.03s/it]Best trial: 49. Best value: 0.716959:  57%|█████▋    | 57/100 [03:15<01:27,  2.03s/it]Best trial: 49. Best value: 0.716959:  58%|█████▊    | 58/100 [03:15<01:36,  2.30s/it]Best trial: 49. Best value: 0.716959:  58%|█████▊    | 58/100 [03:17<01:36,  2.30s/it]Best trial: 49. Best value: 0.716959:  59%|█████▉    | 59/100 [03:17<01:25,  2.07s/it]Best trial: 49. Best value: 0.716959:  59%|█████▉    | 59/100 [03:19<01:25,  2.07s/it]Best trial: 49. Best value: 0.716959:  60%|██████    | 60/100 [03:19<01:29,  2.25s/it]Best trial: 49. Best value: 0.716959:  60%|██████    | 60/100 [03:21<01:29,  2.25s/it]Best trial: 49. Best value: 0.716959:  61%|██████    | 61/100 [03:21<01:23,  2.13s/it]Best trial: 49. Best value: 0.716959:  61%|██████    | 61/100 [03:23<01:23,  2.13s/it]Best trial: 49. Best value: 0.716959:  62%|██████▏   | 62/100 [03:23<01:18,  2.06s/it]Best trial: 49. Best value: 0.716959:  62%|██████▏   | 62/100 [03:25<01:18,  2.06s/it]Best trial: 49. Best value: 0.716959:  63%|██████▎   | 63/100 [03:25<01:16,  2.08s/it]Best trial: 63. Best value: 0.718166:  63%|██████▎   | 63/100 [03:27<01:16,  2.08s/it]Best trial: 63. Best value: 0.718166:  64%|██████▍   | 64/100 [03:27<01:13,  2.05s/it]Best trial: 63. Best value: 0.718166:  64%|██████▍   | 64/100 [03:29<01:13,  2.05s/it]Best trial: 63. Best value: 0.718166:  65%|██████▌   | 65/100 [03:29<01:12,  2.07s/it]Best trial: 63. Best value: 0.718166:  65%|██████▌   | 65/100 [03:32<01:12,  2.07s/it]Best trial: 63. Best value: 0.718166:  66%|██████▌   | 66/100 [03:32<01:19,  2.33s/it]Best trial: 63. Best value: 0.718166:  66%|██████▌   | 66/100 [03:35<01:19,  2.33s/it]Best trial: 63. Best value: 0.718166:  67%|██████▋   | 67/100 [03:35<01:22,  2.49s/it]Best trial: 63. Best value: 0.718166:  67%|██████▋   | 67/100 [03:37<01:22,  2.49s/it]Best trial: 63. Best value: 0.718166:  68%|██████▊   | 68/100 [03:37<01:17,  2.41s/it]Best trial: 63. Best value: 0.718166:  68%|██████▊   | 68/100 [03:40<01:17,  2.41s/it]Best trial: 63. Best value: 0.718166:  69%|██████▉   | 69/100 [03:40<01:19,  2.57s/it]Best trial: 63. Best value: 0.718166:  69%|██████▉   | 69/100 [03:43<01:19,  2.57s/it]Best trial: 63. Best value: 0.718166:  70%|███████   | 70/100 [03:43<01:20,  2.67s/it]Best trial: 63. Best value: 0.718166:  70%|███████   | 70/100 [03:46<01:20,  2.67s/it]Best trial: 63. Best value: 0.718166:  71%|███████   | 71/100 [03:46<01:13,  2.55s/it]Best trial: 63. Best value: 0.718166:  71%|███████   | 71/100 [03:48<01:13,  2.55s/it]Best trial: 63. Best value: 0.718166:  72%|███████▏  | 72/100 [03:48<01:10,  2.52s/it]Best trial: 63. Best value: 0.718166:  72%|███████▏  | 72/100 [03:50<01:10,  2.52s/it]Best trial: 63. Best value: 0.718166:  73%|███████▎  | 73/100 [03:50<01:06,  2.46s/it]Best trial: 63. Best value: 0.718166:  73%|███████▎  | 73/100 [03:52<01:06,  2.46s/it]Best trial: 63. Best value: 0.718166:  74%|███████▍  | 74/100 [03:52<01:01,  2.37s/it]Best trial: 63. Best value: 0.718166:  74%|███████▍  | 74/100 [03:55<01:01,  2.37s/it]Best trial: 63. Best value: 0.718166:  75%|███████▌  | 75/100 [03:55<00:59,  2.37s/it]Best trial: 63. Best value: 0.718166:  75%|███████▌  | 75/100 [03:57<00:59,  2.37s/it]Best trial: 63. Best value: 0.718166:  76%|███████▌  | 76/100 [03:57<00:54,  2.28s/it]Best trial: 63. Best value: 0.718166:  76%|███████▌  | 76/100 [04:01<00:54,  2.28s/it]Best trial: 63. Best value: 0.718166:  77%|███████▋  | 77/100 [04:01<01:01,  2.69s/it]Best trial: 63. Best value: 0.718166:  77%|███████▋  | 77/100 [04:03<01:01,  2.69s/it]Best trial: 63. Best value: 0.718166:  78%|███████▊  | 78/100 [04:03<00:58,  2.67s/it]Best trial: 63. Best value: 0.718166:  78%|███████▊  | 78/100 [04:05<00:58,  2.67s/it]Best trial: 63. Best value: 0.718166:  79%|███████▉  | 79/100 [04:05<00:48,  2.30s/it]Best trial: 63. Best value: 0.718166:  79%|███████▉  | 79/100 [04:07<00:48,  2.30s/it]Best trial: 63. Best value: 0.718166:  80%|████████  | 80/100 [04:07<00:44,  2.22s/it]Best trial: 63. Best value: 0.718166:  80%|████████  | 80/100 [04:09<00:44,  2.22s/it]Best trial: 63. Best value: 0.718166:  81%|████████  | 81/100 [04:09<00:44,  2.35s/it]Best trial: 63. Best value: 0.718166:  81%|████████  | 81/100 [04:11<00:44,  2.35s/it]Best trial: 63. Best value: 0.718166:  82%|████████▏ | 82/100 [04:11<00:39,  2.21s/it]Best trial: 63. Best value: 0.718166:  82%|████████▏ | 82/100 [04:14<00:39,  2.21s/it]Best trial: 63. Best value: 0.718166:  83%|████████▎ | 83/100 [04:14<00:38,  2.28s/it]Best trial: 63. Best value: 0.718166:  83%|████████▎ | 83/100 [04:16<00:38,  2.28s/it]Best trial: 63. Best value: 0.718166:  84%|████████▍ | 84/100 [04:16<00:38,  2.39s/it]Best trial: 63. Best value: 0.718166:  84%|████████▍ | 84/100 [04:19<00:38,  2.39s/it]Best trial: 63. Best value: 0.718166:  85%|████████▌ | 85/100 [04:19<00:37,  2.51s/it]Best trial: 63. Best value: 0.718166:  85%|████████▌ | 85/100 [04:21<00:37,  2.51s/it]Best trial: 63. Best value: 0.718166:  86%|████████▌ | 86/100 [04:21<00:34,  2.43s/it]Best trial: 63. Best value: 0.718166:  86%|████████▌ | 86/100 [04:23<00:34,  2.43s/it]Best trial: 63. Best value: 0.718166:  87%|████████▋ | 87/100 [04:23<00:29,  2.28s/it]Best trial: 63. Best value: 0.718166:  87%|████████▋ | 87/100 [04:26<00:29,  2.28s/it]Best trial: 63. Best value: 0.718166:  88%|████████▊ | 88/100 [04:26<00:29,  2.46s/it]Best trial: 63. Best value: 0.718166:  88%|████████▊ | 88/100 [04:29<00:29,  2.46s/it]Best trial: 63. Best value: 0.718166:  89%|████████▉ | 89/100 [04:29<00:27,  2.46s/it]Best trial: 63. Best value: 0.718166:  89%|████████▉ | 89/100 [04:32<00:27,  2.46s/it]Best trial: 63. Best value: 0.718166:  90%|█████████ | 90/100 [04:32<00:27,  2.77s/it]Best trial: 63. Best value: 0.718166:  90%|█████████ | 90/100 [04:35<00:27,  2.77s/it]Best trial: 63. Best value: 0.718166:  91%|█████████ | 91/100 [04:35<00:26,  2.91s/it]Best trial: 63. Best value: 0.718166:  91%|█████████ | 91/100 [04:38<00:26,  2.91s/it]Best trial: 63. Best value: 0.718166:  92%|█████████▏| 92/100 [04:38<00:21,  2.72s/it]Best trial: 63. Best value: 0.718166:  92%|█████████▏| 92/100 [04:40<00:21,  2.72s/it]Best trial: 63. Best value: 0.718166:  93%|█████████▎| 93/100 [04:40<00:18,  2.71s/it]Best trial: 63. Best value: 0.718166:  93%|█████████▎| 93/100 [04:43<00:18,  2.71s/it]Best trial: 63. Best value: 0.718166:  94%|█████████▍| 94/100 [04:43<00:16,  2.83s/it]Best trial: 63. Best value: 0.718166:  94%|█████████▍| 94/100 [04:47<00:16,  2.83s/it]Best trial: 63. Best value: 0.718166:  95%|█████████▌| 95/100 [04:47<00:14,  2.97s/it]Best trial: 63. Best value: 0.718166:  95%|█████████▌| 95/100 [04:50<00:14,  2.97s/it]Best trial: 63. Best value: 0.718166:  96%|█████████▌| 96/100 [04:50<00:12,  3.07s/it]Best trial: 63. Best value: 0.718166:  96%|█████████▌| 96/100 [04:53<00:12,  3.07s/it]Best trial: 63. Best value: 0.718166:  97%|█████████▋| 97/100 [04:53<00:09,  3.06s/it]Best trial: 63. Best value: 0.718166:  97%|█████████▋| 97/100 [04:55<00:09,  3.06s/it]Best trial: 63. Best value: 0.718166:  98%|█████████▊| 98/100 [04:55<00:05,  2.84s/it]Best trial: 63. Best value: 0.718166:  98%|█████████▊| 98/100 [04:59<00:05,  2.84s/it]Best trial: 63. Best value: 0.718166:  99%|█████████▉| 99/100 [04:59<00:03,  3.21s/it]Best trial: 63. Best value: 0.718166:  99%|█████████▉| 99/100 [05:03<00:03,  3.21s/it]Best trial: 63. Best value: 0.718166: 100%|██████████| 100/100 [05:03<00:00,  3.17s/it]Best trial: 63. Best value: 0.718166: 100%|██████████| 100/100 [05:03<00:00,  3.03s/it]
2025-12-01 01:49:23,434 - INFO - HPO Complete. Best AUPRC: 0.7182
2025-12-01 01:49:23,435 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.05224678162399533, 'max_depth': 3, 'subsample': 0.8972928651711604, 'colsample_bytree': 0.9672702741202394, 'gamma': 0.7268078077467806, 'reg_lambda': 4.270715308662214e-05, 'reg_alpha': 3.028191056206386e-06}
2025-12-01 01:49:23,435 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:49:25,317 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_co2
2025-12-01 01:49:25,317 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:49:25,401 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:49:25,423 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:49:25,428 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:49:25,428 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:49:25,428 - INFO - Training model...
2025-12-01 01:49:26,480 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:49:31,693 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:49:31,693 - INFO - AUROC: 0.8654 (0.8344 - 0.8856)
2025-12-01 01:49:31,693 - INFO - AUPRC: 0.7051 (0.6549 - 0.7518)
2025-12-01 01:49:31,694 - INFO - Brier Score: 0.1134 (0.1038 - 0.1297)
2025-12-01 01:49:31,694 - INFO - Accuracy: 0.8497 (0.8217 - 0.8821)
2025-12-01 01:49:31,694 - INFO - Precision: 0.6226 (0.5847 - 0.7493)
2025-12-01 01:49:31,694 - INFO - Sensitivity (Recall): 0.6923 (0.5893 - 0.7203)
2025-12-01 01:49:31,694 - INFO - F1-Score: 0.6556 (0.6176 - 0.6995)
2025-12-01 01:49:31,694 - INFO - Best Threshold: 0.4600 (0.4440 - 0.6580)
2025-12-01 01:49:31,694 - INFO - Specificity: 0.8907 (0.8666 - 0.9511)
2025-12-01 01:49:31,707 - INFO - Calculating SHAP values...
2025-12-01 01:49:32,731 - INFO - SHAP plots saved.
2025-12-01 01:49:32,732 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:49:33,964 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_awp
2025-12-01 01:49:33,964 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:49:34,073 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:49:34,100 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:49:34,107 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:49:34,108 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.688663:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.688663:   1%|          | 1/100 [00:07<12:12,  7.40s/it]Best trial: 0. Best value: 0.688663:   1%|          | 1/100 [00:10<12:12,  7.40s/it]Best trial: 0. Best value: 0.688663:   2%|▏         | 2/100 [00:10<07:44,  4.74s/it]Best trial: 0. Best value: 0.688663:   2%|▏         | 2/100 [00:14<07:44,  4.74s/it]Best trial: 0. Best value: 0.688663:   3%|▎         | 3/100 [00:14<07:04,  4.37s/it]Best trial: 0. Best value: 0.688663:   3%|▎         | 3/100 [00:19<07:04,  4.37s/it]Best trial: 0. Best value: 0.688663:   4%|▍         | 4/100 [00:19<07:24,  4.63s/it]Best trial: 0. Best value: 0.688663:   4%|▍         | 4/100 [00:23<07:24,  4.63s/it]Best trial: 0. Best value: 0.688663:   5%|▌         | 5/100 [00:23<07:15,  4.59s/it]Best trial: 5. Best value: 0.705391:   5%|▌         | 5/100 [00:29<07:15,  4.59s/it]Best trial: 5. Best value: 0.705391:   6%|▌         | 6/100 [00:29<07:47,  4.97s/it]Best trial: 5. Best value: 0.705391:   6%|▌         | 6/100 [00:32<07:47,  4.97s/it]Best trial: 5. Best value: 0.705391:   7%|▋         | 7/100 [00:32<06:33,  4.23s/it]Best trial: 5. Best value: 0.705391:   7%|▋         | 7/100 [00:34<06:33,  4.23s/it]Best trial: 5. Best value: 0.705391:   8%|▊         | 8/100 [00:34<05:29,  3.58s/it]Best trial: 5. Best value: 0.705391:   8%|▊         | 8/100 [00:40<05:29,  3.58s/it]Best trial: 5. Best value: 0.705391:   9%|▉         | 9/100 [00:40<06:38,  4.38s/it]Best trial: 5. Best value: 0.705391:   9%|▉         | 9/100 [00:42<06:38,  4.38s/it]Best trial: 5. Best value: 0.705391:  10%|█         | 10/100 [00:42<05:24,  3.60s/it]Best trial: 10. Best value: 0.707837:  10%|█         | 10/100 [00:43<05:24,  3.60s/it]Best trial: 10. Best value: 0.707837:  11%|█         | 11/100 [00:43<04:25,  2.98s/it]Best trial: 11. Best value: 0.711734:  11%|█         | 11/100 [00:45<04:25,  2.98s/it]Best trial: 11. Best value: 0.711734:  12%|█▏        | 12/100 [00:45<03:44,  2.56s/it]Best trial: 11. Best value: 0.711734:  12%|█▏        | 12/100 [00:47<03:44,  2.56s/it]Best trial: 11. Best value: 0.711734:  13%|█▎        | 13/100 [00:47<03:16,  2.25s/it]Best trial: 11. Best value: 0.711734:  13%|█▎        | 13/100 [00:48<03:16,  2.25s/it]Best trial: 11. Best value: 0.711734:  14%|█▍        | 14/100 [00:48<02:58,  2.08s/it]Best trial: 11. Best value: 0.711734:  14%|█▍        | 14/100 [00:50<02:58,  2.08s/it]Best trial: 11. Best value: 0.711734:  15%|█▌        | 15/100 [00:50<02:54,  2.06s/it]Best trial: 11. Best value: 0.711734:  15%|█▌        | 15/100 [00:53<02:54,  2.06s/it]Best trial: 11. Best value: 0.711734:  16%|█▌        | 16/100 [00:53<03:16,  2.34s/it]Best trial: 11. Best value: 0.711734:  16%|█▌        | 16/100 [00:55<03:16,  2.34s/it]Best trial: 11. Best value: 0.711734:  17%|█▋        | 17/100 [00:55<03:09,  2.28s/it]Best trial: 11. Best value: 0.711734:  17%|█▋        | 17/100 [00:58<03:09,  2.28s/it]Best trial: 11. Best value: 0.711734:  18%|█▊        | 18/100 [00:58<03:27,  2.52s/it]Best trial: 11. Best value: 0.711734:  18%|█▊        | 18/100 [01:01<03:27,  2.52s/it]Best trial: 11. Best value: 0.711734:  19%|█▉        | 19/100 [01:01<03:22,  2.49s/it]Best trial: 11. Best value: 0.711734:  19%|█▉        | 19/100 [01:03<03:22,  2.49s/it]Best trial: 11. Best value: 0.711734:  20%|██        | 20/100 [01:03<03:09,  2.37s/it]Best trial: 11. Best value: 0.711734:  20%|██        | 20/100 [01:05<03:09,  2.37s/it]Best trial: 11. Best value: 0.711734:  21%|██        | 21/100 [01:05<02:53,  2.19s/it]Best trial: 11. Best value: 0.711734:  21%|██        | 21/100 [01:06<02:53,  2.19s/it]Best trial: 11. Best value: 0.711734:  22%|██▏       | 22/100 [01:06<02:36,  2.01s/it]Best trial: 11. Best value: 0.711734:  22%|██▏       | 22/100 [01:08<02:36,  2.01s/it]Best trial: 11. Best value: 0.711734:  23%|██▎       | 23/100 [01:08<02:35,  2.02s/it]Best trial: 11. Best value: 0.711734:  23%|██▎       | 23/100 [01:10<02:35,  2.02s/it]Best trial: 11. Best value: 0.711734:  24%|██▍       | 24/100 [01:10<02:23,  1.88s/it]Best trial: 11. Best value: 0.711734:  24%|██▍       | 24/100 [01:12<02:23,  1.88s/it]Best trial: 11. Best value: 0.711734:  25%|██▌       | 25/100 [01:12<02:32,  2.04s/it]Best trial: 11. Best value: 0.711734:  25%|██▌       | 25/100 [01:14<02:32,  2.04s/it]Best trial: 11. Best value: 0.711734:  26%|██▌       | 26/100 [01:14<02:26,  1.98s/it]Best trial: 11. Best value: 0.711734:  26%|██▌       | 26/100 [01:16<02:26,  1.98s/it]Best trial: 11. Best value: 0.711734:  27%|██▋       | 27/100 [01:16<02:13,  1.83s/it]Best trial: 11. Best value: 0.711734:  27%|██▋       | 27/100 [01:19<02:13,  1.83s/it]Best trial: 11. Best value: 0.711734:  28%|██▊       | 28/100 [01:19<02:36,  2.18s/it]Best trial: 11. Best value: 0.711734:  28%|██▊       | 28/100 [01:22<02:36,  2.18s/it]Best trial: 11. Best value: 0.711734:  29%|██▉       | 29/100 [01:22<02:50,  2.40s/it]Best trial: 11. Best value: 0.711734:  29%|██▉       | 29/100 [01:29<02:50,  2.40s/it]Best trial: 11. Best value: 0.711734:  30%|███       | 30/100 [01:29<04:22,  3.75s/it]Best trial: 11. Best value: 0.711734:  30%|███       | 30/100 [01:30<04:22,  3.75s/it]Best trial: 11. Best value: 0.711734:  31%|███       | 31/100 [01:30<03:29,  3.03s/it]Best trial: 11. Best value: 0.711734:  31%|███       | 31/100 [01:32<03:29,  3.03s/it]Best trial: 11. Best value: 0.711734:  32%|███▏      | 32/100 [01:32<03:08,  2.77s/it]Best trial: 11. Best value: 0.711734:  32%|███▏      | 32/100 [01:34<03:08,  2.77s/it]Best trial: 11. Best value: 0.711734:  33%|███▎      | 33/100 [01:34<02:52,  2.57s/it]Best trial: 11. Best value: 0.711734:  33%|███▎      | 33/100 [01:36<02:52,  2.57s/it]Best trial: 11. Best value: 0.711734:  34%|███▍      | 34/100 [01:36<02:27,  2.24s/it]Best trial: 11. Best value: 0.711734:  34%|███▍      | 34/100 [01:38<02:27,  2.24s/it]Best trial: 11. Best value: 0.711734:  35%|███▌      | 35/100 [01:38<02:37,  2.42s/it]Best trial: 35. Best value: 0.7127:  35%|███▌      | 35/100 [01:41<02:37,  2.42s/it]  Best trial: 35. Best value: 0.7127:  36%|███▌      | 36/100 [01:41<02:44,  2.57s/it]Best trial: 35. Best value: 0.7127:  36%|███▌      | 36/100 [01:45<02:44,  2.57s/it]Best trial: 35. Best value: 0.7127:  37%|███▋      | 37/100 [01:45<03:04,  2.94s/it]Best trial: 35. Best value: 0.7127:  37%|███▋      | 37/100 [01:48<03:04,  2.94s/it]Best trial: 35. Best value: 0.7127:  38%|███▊      | 38/100 [01:48<03:03,  2.96s/it]Best trial: 35. Best value: 0.7127:  38%|███▊      | 38/100 [01:52<03:03,  2.96s/it]Best trial: 35. Best value: 0.7127:  39%|███▉      | 39/100 [01:52<03:08,  3.09s/it]Best trial: 35. Best value: 0.7127:  39%|███▉      | 39/100 [01:54<03:08,  3.09s/it]Best trial: 35. Best value: 0.7127:  40%|████      | 40/100 [01:54<02:49,  2.82s/it]Best trial: 35. Best value: 0.7127:  40%|████      | 40/100 [01:55<02:49,  2.82s/it]Best trial: 35. Best value: 0.7127:  41%|████      | 41/100 [01:55<02:27,  2.50s/it]Best trial: 41. Best value: 0.71271:  41%|████      | 41/100 [01:58<02:27,  2.50s/it]Best trial: 41. Best value: 0.71271:  42%|████▏     | 42/100 [01:58<02:19,  2.41s/it]Best trial: 41. Best value: 0.71271:  42%|████▏     | 42/100 [01:59<02:19,  2.41s/it]Best trial: 41. Best value: 0.71271:  43%|████▎     | 43/100 [01:59<02:02,  2.14s/it]Best trial: 43. Best value: 0.718859:  43%|████▎     | 43/100 [02:01<02:02,  2.14s/it]Best trial: 43. Best value: 0.718859:  44%|████▍     | 44/100 [02:01<01:54,  2.05s/it]Best trial: 43. Best value: 0.718859:  44%|████▍     | 44/100 [02:03<01:54,  2.05s/it]Best trial: 43. Best value: 0.718859:  45%|████▌     | 45/100 [02:03<01:53,  2.07s/it]Best trial: 43. Best value: 0.718859:  45%|████▌     | 45/100 [02:06<01:53,  2.07s/it]Best trial: 43. Best value: 0.718859:  46%|████▌     | 46/100 [02:06<02:07,  2.37s/it]Best trial: 43. Best value: 0.718859:  46%|████▌     | 46/100 [02:09<02:07,  2.37s/it]Best trial: 43. Best value: 0.718859:  47%|████▋     | 47/100 [02:09<02:13,  2.51s/it]Best trial: 43. Best value: 0.718859:  47%|████▋     | 47/100 [02:13<02:13,  2.51s/it]Best trial: 43. Best value: 0.718859:  48%|████▊     | 48/100 [02:13<02:31,  2.92s/it]Best trial: 43. Best value: 0.718859:  48%|████▊     | 48/100 [02:17<02:31,  2.92s/it]Best trial: 43. Best value: 0.718859:  49%|████▉     | 49/100 [02:17<02:43,  3.21s/it]Best trial: 43. Best value: 0.718859:  49%|████▉     | 49/100 [02:21<02:43,  3.21s/it]Best trial: 43. Best value: 0.718859:  50%|█████     | 50/100 [02:21<02:56,  3.52s/it]Best trial: 43. Best value: 0.718859:  50%|█████     | 50/100 [02:27<02:56,  3.52s/it]Best trial: 43. Best value: 0.718859:  51%|█████     | 51/100 [02:27<03:24,  4.18s/it]Best trial: 43. Best value: 0.718859:  51%|█████     | 51/100 [02:34<03:24,  4.18s/it]Best trial: 43. Best value: 0.718859:  52%|█████▏    | 52/100 [02:34<04:00,  5.00s/it]Best trial: 43. Best value: 0.718859:  52%|█████▏    | 52/100 [02:37<04:00,  5.00s/it]Best trial: 43. Best value: 0.718859:  53%|█████▎    | 53/100 [02:37<03:24,  4.34s/it]Best trial: 43. Best value: 0.718859:  53%|█████▎    | 53/100 [02:39<03:24,  4.34s/it]Best trial: 43. Best value: 0.718859:  54%|█████▍    | 54/100 [02:39<03:00,  3.92s/it]Best trial: 43. Best value: 0.718859:  54%|█████▍    | 54/100 [02:44<03:00,  3.92s/it]Best trial: 43. Best value: 0.718859:  55%|█████▌    | 55/100 [02:44<02:59,  3.99s/it]Best trial: 43. Best value: 0.718859:  55%|█████▌    | 55/100 [02:45<02:59,  3.99s/it]Best trial: 43. Best value: 0.718859:  56%|█████▌    | 56/100 [02:45<02:25,  3.30s/it]Best trial: 43. Best value: 0.718859:  56%|█████▌    | 56/100 [02:48<02:25,  3.30s/it]Best trial: 43. Best value: 0.718859:  57%|█████▋    | 57/100 [02:48<02:08,  3.00s/it]Best trial: 43. Best value: 0.718859:  57%|█████▋    | 57/100 [02:51<02:08,  3.00s/it]Best trial: 43. Best value: 0.718859:  58%|█████▊    | 58/100 [02:51<02:05,  2.98s/it]Best trial: 43. Best value: 0.718859:  58%|█████▊    | 58/100 [02:54<02:05,  2.98s/it]Best trial: 43. Best value: 0.718859:  59%|█████▉    | 59/100 [02:54<02:03,  3.02s/it]Best trial: 43. Best value: 0.718859:  59%|█████▉    | 59/100 [02:56<02:03,  3.02s/it]Best trial: 43. Best value: 0.718859:  60%|██████    | 60/100 [02:56<01:49,  2.73s/it]Best trial: 43. Best value: 0.718859:  60%|██████    | 60/100 [02:58<01:49,  2.73s/it]Best trial: 43. Best value: 0.718859:  61%|██████    | 61/100 [02:58<01:38,  2.52s/it]Best trial: 43. Best value: 0.718859:  61%|██████    | 61/100 [03:00<01:38,  2.52s/it]Best trial: 43. Best value: 0.718859:  62%|██████▏   | 62/100 [03:00<01:34,  2.48s/it]Best trial: 43. Best value: 0.718859:  62%|██████▏   | 62/100 [03:02<01:34,  2.48s/it]Best trial: 43. Best value: 0.718859:  63%|██████▎   | 63/100 [03:02<01:29,  2.42s/it]Best trial: 43. Best value: 0.718859:  63%|██████▎   | 63/100 [03:05<01:29,  2.42s/it]Best trial: 43. Best value: 0.718859:  64%|██████▍   | 64/100 [03:05<01:30,  2.52s/it]Best trial: 43. Best value: 0.718859:  64%|██████▍   | 64/100 [03:07<01:30,  2.52s/it]Best trial: 43. Best value: 0.718859:  65%|██████▌   | 65/100 [03:07<01:23,  2.39s/it]Best trial: 43. Best value: 0.718859:  65%|██████▌   | 65/100 [03:10<01:23,  2.39s/it]Best trial: 43. Best value: 0.718859:  66%|██████▌   | 66/100 [03:10<01:25,  2.50s/it]Best trial: 43. Best value: 0.718859:  66%|██████▌   | 66/100 [03:12<01:25,  2.50s/it]Best trial: 43. Best value: 0.718859:  67%|██████▋   | 67/100 [03:12<01:18,  2.37s/it]Best trial: 43. Best value: 0.718859:  67%|██████▋   | 67/100 [03:15<01:18,  2.37s/it]Best trial: 43. Best value: 0.718859:  68%|██████▊   | 68/100 [03:15<01:17,  2.42s/it]Best trial: 43. Best value: 0.718859:  68%|██████▊   | 68/100 [03:16<01:17,  2.42s/it]Best trial: 43. Best value: 0.718859:  69%|██████▉   | 69/100 [03:16<01:05,  2.10s/it]Best trial: 43. Best value: 0.718859:  69%|██████▉   | 69/100 [03:19<01:05,  2.10s/it]Best trial: 43. Best value: 0.718859:  70%|███████   | 70/100 [03:19<01:07,  2.26s/it]Best trial: 43. Best value: 0.718859:  70%|███████   | 70/100 [03:21<01:07,  2.26s/it]Best trial: 43. Best value: 0.718859:  71%|███████   | 71/100 [03:21<01:08,  2.36s/it]Best trial: 43. Best value: 0.718859:  71%|███████   | 71/100 [03:24<01:08,  2.36s/it]Best trial: 43. Best value: 0.718859:  72%|███████▏  | 72/100 [03:24<01:07,  2.42s/it]Best trial: 43. Best value: 0.718859:  72%|███████▏  | 72/100 [03:27<01:07,  2.42s/it]Best trial: 43. Best value: 0.718859:  73%|███████▎  | 73/100 [03:27<01:09,  2.56s/it]Best trial: 43. Best value: 0.718859:  73%|███████▎  | 73/100 [03:30<01:09,  2.56s/it]Best trial: 43. Best value: 0.718859:  74%|███████▍  | 74/100 [03:30<01:10,  2.71s/it]Best trial: 43. Best value: 0.718859:  74%|███████▍  | 74/100 [03:34<01:10,  2.71s/it]Best trial: 43. Best value: 0.718859:  75%|███████▌  | 75/100 [03:34<01:17,  3.10s/it]Best trial: 43. Best value: 0.718859:  75%|███████▌  | 75/100 [03:37<01:17,  3.10s/it]Best trial: 43. Best value: 0.718859:  76%|███████▌  | 76/100 [03:37<01:14,  3.09s/it]Best trial: 43. Best value: 0.718859:  76%|███████▌  | 76/100 [03:39<01:14,  3.09s/it]Best trial: 43. Best value: 0.718859:  77%|███████▋  | 77/100 [03:39<01:07,  2.94s/it]Best trial: 43. Best value: 0.718859:  77%|███████▋  | 77/100 [03:41<01:07,  2.94s/it]Best trial: 43. Best value: 0.718859:  78%|███████▊  | 78/100 [03:41<00:57,  2.59s/it]Best trial: 43. Best value: 0.718859:  78%|███████▊  | 78/100 [03:43<00:57,  2.59s/it]Best trial: 43. Best value: 0.718859:  79%|███████▉  | 79/100 [03:43<00:49,  2.37s/it]Best trial: 43. Best value: 0.718859:  79%|███████▉  | 79/100 [03:47<00:49,  2.37s/it]Best trial: 43. Best value: 0.718859:  80%|████████  | 80/100 [03:47<00:54,  2.75s/it]Best trial: 43. Best value: 0.718859:  80%|████████  | 80/100 [03:51<00:54,  2.75s/it]Best trial: 43. Best value: 0.718859:  81%|████████  | 81/100 [03:51<01:02,  3.31s/it]Best trial: 43. Best value: 0.718859:  81%|████████  | 81/100 [03:53<01:02,  3.31s/it]Best trial: 43. Best value: 0.718859:  82%|████████▏ | 82/100 [03:53<00:53,  2.95s/it]Best trial: 43. Best value: 0.718859:  82%|████████▏ | 82/100 [03:56<00:53,  2.95s/it]Best trial: 43. Best value: 0.718859:  83%|████████▎ | 83/100 [03:56<00:48,  2.88s/it]Best trial: 43. Best value: 0.718859:  83%|████████▎ | 83/100 [03:59<00:48,  2.88s/it]Best trial: 43. Best value: 0.718859:  84%|████████▍ | 84/100 [03:59<00:45,  2.85s/it]Best trial: 43. Best value: 0.718859:  84%|████████▍ | 84/100 [04:02<00:45,  2.85s/it]Best trial: 43. Best value: 0.718859:  85%|████████▌ | 85/100 [04:02<00:43,  2.92s/it]Best trial: 43. Best value: 0.718859:  85%|████████▌ | 85/100 [04:04<00:43,  2.92s/it]Best trial: 43. Best value: 0.718859:  86%|████████▌ | 86/100 [04:04<00:39,  2.81s/it]Best trial: 43. Best value: 0.718859:  86%|████████▌ | 86/100 [04:07<00:39,  2.81s/it]Best trial: 43. Best value: 0.718859:  87%|████████▋ | 87/100 [04:07<00:34,  2.67s/it]Best trial: 43. Best value: 0.718859:  87%|████████▋ | 87/100 [04:11<00:34,  2.67s/it]Best trial: 43. Best value: 0.718859:  88%|████████▊ | 88/100 [04:11<00:37,  3.14s/it]Best trial: 43. Best value: 0.718859:  88%|████████▊ | 88/100 [04:15<00:37,  3.14s/it]Best trial: 43. Best value: 0.718859:  89%|████████▉ | 89/100 [04:15<00:37,  3.41s/it]Best trial: 43. Best value: 0.718859:  89%|████████▉ | 89/100 [04:20<00:37,  3.41s/it]Best trial: 43. Best value: 0.718859:  90%|█████████ | 90/100 [04:20<00:37,  3.74s/it]Best trial: 43. Best value: 0.718859:  90%|█████████ | 90/100 [04:22<00:37,  3.74s/it]Best trial: 43. Best value: 0.718859:  91%|█████████ | 91/100 [04:22<00:30,  3.41s/it]Best trial: 43. Best value: 0.718859:  91%|█████████ | 91/100 [04:26<00:30,  3.41s/it]Best trial: 43. Best value: 0.718859:  92%|█████████▏| 92/100 [04:26<00:27,  3.49s/it]Best trial: 43. Best value: 0.718859:  92%|█████████▏| 92/100 [04:30<00:27,  3.49s/it]Best trial: 43. Best value: 0.718859:  93%|█████████▎| 93/100 [04:30<00:24,  3.53s/it]Best trial: 43. Best value: 0.718859:  93%|█████████▎| 93/100 [04:32<00:24,  3.53s/it]Best trial: 43. Best value: 0.718859:  94%|█████████▍| 94/100 [04:32<00:19,  3.24s/it]Best trial: 43. Best value: 0.718859:  94%|█████████▍| 94/100 [04:34<00:19,  3.24s/it]Best trial: 43. Best value: 0.718859:  95%|█████████▌| 95/100 [04:34<00:14,  2.97s/it]Best trial: 43. Best value: 0.718859:  95%|█████████▌| 95/100 [04:36<00:14,  2.97s/it]Best trial: 43. Best value: 0.718859:  96%|█████████▌| 96/100 [04:36<00:10,  2.65s/it]Best trial: 43. Best value: 0.718859:  96%|█████████▌| 96/100 [04:39<00:10,  2.65s/it]Best trial: 43. Best value: 0.718859:  97%|█████████▋| 97/100 [04:39<00:07,  2.63s/it]Best trial: 43. Best value: 0.718859:  97%|█████████▋| 97/100 [04:41<00:07,  2.63s/it]Best trial: 43. Best value: 0.718859:  98%|█████████▊| 98/100 [04:41<00:04,  2.45s/it]Best trial: 43. Best value: 0.718859:  98%|█████████▊| 98/100 [04:43<00:04,  2.45s/it]Best trial: 43. Best value: 0.718859:  99%|█████████▉| 99/100 [04:43<00:02,  2.22s/it]Best trial: 43. Best value: 0.718859:  99%|█████████▉| 99/100 [04:45<00:02,  2.22s/it]Best trial: 43. Best value: 0.718859: 100%|██████████| 100/100 [04:45<00:00,  2.35s/it]Best trial: 43. Best value: 0.718859: 100%|██████████| 100/100 [04:45<00:00,  2.86s/it]
2025-12-01 01:54:19,891 - INFO - HPO Complete. Best AUPRC: 0.7189
2025-12-01 01:54:19,892 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.07163225089479203, 'max_depth': 3, 'subsample': 0.9262568945145611, 'colsample_bytree': 0.6196818032399821, 'gamma': 0.7077893186438978, 'reg_lambda': 9.053950834524649e-08, 'reg_alpha': 0.07427730075142623}
2025-12-01 01:54:19,893 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 01:54:21,743 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_awp
2025-12-01 01:54:21,743 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:54:21,828 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:54:21,850 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:54:21,856 - INFO - Data prepared. Train shape: (2761, 116), Test shape: (692, 116)
2025-12-01 01:54:21,856 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 01:54:21,856 - INFO - Training model...
2025-12-01 01:54:22,423 - INFO - Evaluating model with bootstrapping...
2025-12-01 01:54:27,688 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 01:54:27,688 - INFO - AUROC: 0.8931 (0.8676 - 0.9121)
2025-12-01 01:54:27,688 - INFO - AUPRC: 0.7385 (0.6896 - 0.7951)
2025-12-01 01:54:27,688 - INFO - Brier Score: 0.1104 (0.1025 - 0.1220)
2025-12-01 01:54:27,688 - INFO - Accuracy: 0.8671 (0.8298 - 0.8968)
2025-12-01 01:54:27,688 - INFO - Precision: 0.7008 (0.5782 - 0.8650)
2025-12-01 01:54:27,688 - INFO - Sensitivity (Recall): 0.6224 (0.5428 - 0.7886)
2025-12-01 01:54:27,688 - INFO - F1-Score: 0.6593 (0.6307 - 0.7095)
2025-12-01 01:54:27,688 - INFO - Best Threshold: 0.6200 (0.4060 - 0.7180)
2025-12-01 01:54:27,688 - INFO - Specificity: 0.9308 (0.8410 - 0.9755)
2025-12-01 01:54:27,696 - INFO - Calculating SHAP values...
2025-12-01 01:54:28,637 - INFO - SHAP plots saved.
2025-12-01 01:54:28,638 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 01:54:29,791 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-12-01 01:54:29,792 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 01:54:29,873 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 01:54:29,904 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 01:54:29,912 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 01:54:29,912 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.674602:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.674602:   1%|          | 1/100 [00:03<06:10,  3.74s/it]Best trial: 1. Best value: 0.677813:   1%|          | 1/100 [00:07<06:10,  3.74s/it]Best trial: 1. Best value: 0.677813:   2%|▏         | 2/100 [00:07<06:00,  3.67s/it]Best trial: 2. Best value: 0.700017:   2%|▏         | 2/100 [00:12<06:00,  3.67s/it]Best trial: 2. Best value: 0.700017:   3%|▎         | 3/100 [00:12<07:03,  4.36s/it]Best trial: 2. Best value: 0.700017:   3%|▎         | 3/100 [00:19<07:03,  4.36s/it]Best trial: 2. Best value: 0.700017:   4%|▍         | 4/100 [00:19<08:47,  5.49s/it]Best trial: 2. Best value: 0.700017:   4%|▍         | 4/100 [00:22<08:47,  5.49s/it]Best trial: 2. Best value: 0.700017:   5%|▌         | 5/100 [00:22<07:19,  4.63s/it]Best trial: 2. Best value: 0.700017:   5%|▌         | 5/100 [00:26<07:19,  4.63s/it]Best trial: 2. Best value: 0.700017:   6%|▌         | 6/100 [00:26<06:55,  4.42s/it]Best trial: 6. Best value: 0.710016:   6%|▌         | 6/100 [00:32<06:55,  4.42s/it]Best trial: 6. Best value: 0.710016:   7%|▋         | 7/100 [00:32<07:23,  4.77s/it]Best trial: 6. Best value: 0.710016:   7%|▋         | 7/100 [00:38<07:23,  4.77s/it]Best trial: 6. Best value: 0.710016:   8%|▊         | 8/100 [00:38<07:55,  5.17s/it]Best trial: 6. Best value: 0.710016:   8%|▊         | 8/100 [00:46<07:55,  5.17s/it]Best trial: 6. Best value: 0.710016:   9%|▉         | 9/100 [00:46<09:17,  6.13s/it]Best trial: 6. Best value: 0.710016:   9%|▉         | 9/100 [00:53<09:17,  6.13s/it]Best trial: 6. Best value: 0.710016:  10%|█         | 10/100 [00:53<09:43,  6.49s/it]Best trial: 6. Best value: 0.710016:  10%|█         | 10/100 [00:56<09:43,  6.49s/it]Best trial: 6. Best value: 0.710016:  11%|█         | 11/100 [00:56<07:51,  5.30s/it]Best trial: 6. Best value: 0.710016:  11%|█         | 11/100 [01:00<07:51,  5.30s/it]Best trial: 6. Best value: 0.710016:  12%|█▏        | 12/100 [01:00<07:14,  4.93s/it]Best trial: 6. Best value: 0.710016:  12%|█▏        | 12/100 [01:05<07:14,  4.93s/it]Best trial: 6. Best value: 0.710016:  13%|█▎        | 13/100 [01:05<07:02,  4.86s/it]Best trial: 6. Best value: 0.710016:  13%|█▎        | 13/100 [01:11<07:02,  4.86s/it]Best trial: 6. Best value: 0.710016:  14%|█▍        | 14/100 [01:11<07:33,  5.28s/it]Best trial: 6. Best value: 0.710016:  14%|█▍        | 14/100 [01:17<07:33,  5.28s/it]Best trial: 6. Best value: 0.710016:  15%|█▌        | 15/100 [01:17<07:53,  5.57s/it]Best trial: 15. Best value: 0.715162:  15%|█▌        | 15/100 [01:25<07:53,  5.57s/it]Best trial: 15. Best value: 0.715162:  16%|█▌        | 16/100 [01:25<08:52,  6.33s/it]Best trial: 15. Best value: 0.715162:  16%|█▌        | 16/100 [01:32<08:52,  6.33s/it]Best trial: 15. Best value: 0.715162:  17%|█▋        | 17/100 [01:32<09:02,  6.54s/it]Best trial: 15. Best value: 0.715162:  17%|█▋        | 17/100 [01:42<09:02,  6.54s/it]Best trial: 15. Best value: 0.715162:  18%|█▊        | 18/100 [01:42<10:11,  7.45s/it]Best trial: 15. Best value: 0.715162:  18%|█▊        | 18/100 [01:50<10:11,  7.45s/it]Best trial: 15. Best value: 0.715162:  19%|█▉        | 19/100 [01:50<10:14,  7.58s/it]Best trial: 15. Best value: 0.715162:  19%|█▉        | 19/100 [01:53<10:14,  7.58s/it]Best trial: 15. Best value: 0.715162:  20%|██        | 20/100 [01:53<08:14,  6.18s/it]Best trial: 15. Best value: 0.715162:  20%|██        | 20/100 [01:59<08:14,  6.18s/it]Best trial: 15. Best value: 0.715162:  21%|██        | 21/100 [01:59<08:10,  6.21s/it]Best trial: 15. Best value: 0.715162:  21%|██        | 21/100 [02:06<08:10,  6.21s/it]Best trial: 15. Best value: 0.715162:  22%|██▏       | 22/100 [02:06<08:26,  6.49s/it]Best trial: 15. Best value: 0.715162:  22%|██▏       | 22/100 [02:11<08:26,  6.49s/it]Best trial: 15. Best value: 0.715162:  23%|██▎       | 23/100 [02:11<07:37,  5.94s/it]Best trial: 23. Best value: 0.715834:  23%|██▎       | 23/100 [02:19<07:37,  5.94s/it]Best trial: 23. Best value: 0.715834:  24%|██▍       | 24/100 [02:19<08:11,  6.47s/it]Best trial: 23. Best value: 0.715834:  24%|██▍       | 24/100 [02:24<08:11,  6.47s/it]Best trial: 23. Best value: 0.715834:  25%|██▌       | 25/100 [02:24<07:42,  6.16s/it]Best trial: 23. Best value: 0.715834:  25%|██▌       | 25/100 [02:30<07:42,  6.16s/it]Best trial: 23. Best value: 0.715834:  26%|██▌       | 26/100 [02:30<07:38,  6.20s/it]Best trial: 23. Best value: 0.715834:  26%|██▌       | 26/100 [02:36<07:38,  6.20s/it]Best trial: 23. Best value: 0.715834:  27%|██▋       | 27/100 [02:36<07:22,  6.06s/it]Best trial: 23. Best value: 0.715834:  27%|██▋       | 27/100 [02:40<07:22,  6.06s/it]Best trial: 23. Best value: 0.715834:  28%|██▊       | 28/100 [02:40<06:39,  5.54s/it]Best trial: 23. Best value: 0.715834:  28%|██▊       | 28/100 [02:50<06:39,  5.54s/it]Best trial: 23. Best value: 0.715834:  29%|██▉       | 29/100 [02:50<07:51,  6.64s/it]Best trial: 23. Best value: 0.715834:  29%|██▉       | 29/100 [02:53<07:51,  6.64s/it]Best trial: 23. Best value: 0.715834:  30%|███       | 30/100 [02:53<06:30,  5.58s/it]Best trial: 23. Best value: 0.715834:  30%|███       | 30/100 [02:56<06:30,  5.58s/it]Best trial: 23. Best value: 0.715834:  31%|███       | 31/100 [02:56<05:31,  4.81s/it]Best trial: 23. Best value: 0.715834:  31%|███       | 31/100 [03:00<05:31,  4.81s/it]Best trial: 23. Best value: 0.715834:  32%|███▏      | 32/100 [03:00<05:11,  4.58s/it]Best trial: 32. Best value: 0.724525:  32%|███▏      | 32/100 [03:04<05:11,  4.58s/it]Best trial: 32. Best value: 0.724525:  33%|███▎      | 33/100 [03:04<05:04,  4.54s/it]Best trial: 33. Best value: 0.726878:  33%|███▎      | 33/100 [03:08<05:04,  4.54s/it]Best trial: 33. Best value: 0.726878:  34%|███▍      | 34/100 [03:08<04:49,  4.39s/it]Best trial: 33. Best value: 0.726878:  34%|███▍      | 34/100 [03:13<04:49,  4.39s/it]Best trial: 33. Best value: 0.726878:  35%|███▌      | 35/100 [03:13<04:47,  4.42s/it]Best trial: 33. Best value: 0.726878:  35%|███▌      | 35/100 [03:17<04:47,  4.42s/it]Best trial: 33. Best value: 0.726878:  36%|███▌      | 36/100 [03:17<04:48,  4.51s/it]Best trial: 33. Best value: 0.726878:  36%|███▌      | 36/100 [03:21<04:48,  4.51s/it]Best trial: 33. Best value: 0.726878:  37%|███▋      | 37/100 [03:21<04:25,  4.21s/it]Best trial: 33. Best value: 0.726878:  37%|███▋      | 37/100 [03:25<04:25,  4.21s/it]Best trial: 33. Best value: 0.726878:  38%|███▊      | 38/100 [03:25<04:10,  4.05s/it]Best trial: 38. Best value: 0.728487:  38%|███▊      | 38/100 [03:27<04:10,  4.05s/it]Best trial: 38. Best value: 0.728487:  39%|███▉      | 39/100 [03:27<03:37,  3.57s/it]Best trial: 38. Best value: 0.728487:  39%|███▉      | 39/100 [03:29<03:37,  3.57s/it]Best trial: 38. Best value: 0.728487:  40%|████      | 40/100 [03:29<03:10,  3.18s/it]Best trial: 38. Best value: 0.728487:  40%|████      | 40/100 [03:31<03:10,  3.18s/it]Best trial: 38. Best value: 0.728487:  41%|████      | 41/100 [03:31<02:45,  2.80s/it]Best trial: 38. Best value: 0.728487:  41%|████      | 41/100 [03:33<02:45,  2.80s/it]Best trial: 38. Best value: 0.728487:  42%|████▏     | 42/100 [03:33<02:30,  2.59s/it]Best trial: 38. Best value: 0.728487:  42%|████▏     | 42/100 [03:37<02:30,  2.59s/it]Best trial: 38. Best value: 0.728487:  43%|████▎     | 43/100 [03:37<02:37,  2.76s/it]Best trial: 38. Best value: 0.728487:  43%|████▎     | 43/100 [03:39<02:37,  2.76s/it]Best trial: 38. Best value: 0.728487:  44%|████▍     | 44/100 [03:39<02:21,  2.53s/it]Best trial: 38. Best value: 0.728487:  44%|████▍     | 44/100 [03:41<02:21,  2.53s/it]Best trial: 38. Best value: 0.728487:  45%|████▌     | 45/100 [03:41<02:24,  2.62s/it]Best trial: 38. Best value: 0.728487:  45%|████▌     | 45/100 [03:44<02:24,  2.62s/it]Best trial: 38. Best value: 0.728487:  46%|████▌     | 46/100 [03:44<02:18,  2.57s/it]Best trial: 38. Best value: 0.728487:  46%|████▌     | 46/100 [03:47<02:18,  2.57s/it]Best trial: 38. Best value: 0.728487:  47%|████▋     | 47/100 [03:47<02:26,  2.77s/it]Best trial: 38. Best value: 0.728487:  47%|████▋     | 47/100 [03:52<02:26,  2.77s/it]Best trial: 38. Best value: 0.728487:  48%|████▊     | 48/100 [03:52<02:58,  3.44s/it]Best trial: 38. Best value: 0.728487:  48%|████▊     | 48/100 [03:55<02:58,  3.44s/it]Best trial: 38. Best value: 0.728487:  49%|████▉     | 49/100 [03:55<02:51,  3.37s/it]Best trial: 38. Best value: 0.728487:  49%|████▉     | 49/100 [03:59<02:51,  3.37s/it]Best trial: 38. Best value: 0.728487:  50%|█████     | 50/100 [03:59<02:55,  3.51s/it]Best trial: 38. Best value: 0.728487:  50%|█████     | 50/100 [04:01<02:55,  3.51s/it]Best trial: 38. Best value: 0.728487:  51%|█████     | 51/100 [04:01<02:34,  3.16s/it]Best trial: 38. Best value: 0.728487:  51%|█████     | 51/100 [04:05<02:34,  3.16s/it]Best trial: 38. Best value: 0.728487:  52%|█████▏    | 52/100 [04:05<02:34,  3.23s/it]Best trial: 38. Best value: 0.728487:  52%|█████▏    | 52/100 [04:08<02:34,  3.23s/it]Best trial: 38. Best value: 0.728487:  53%|█████▎    | 53/100 [04:08<02:30,  3.20s/it]Best trial: 38. Best value: 0.728487:  53%|█████▎    | 53/100 [04:12<02:30,  3.20s/it]Best trial: 38. Best value: 0.728487:  54%|█████▍    | 54/100 [04:12<02:40,  3.48s/it]Best trial: 38. Best value: 0.728487:  54%|█████▍    | 54/100 [04:16<02:40,  3.48s/it]Best trial: 38. Best value: 0.728487:  55%|█████▌    | 55/100 [04:16<02:46,  3.71s/it]Best trial: 38. Best value: 0.728487:  55%|█████▌    | 55/100 [04:19<02:46,  3.71s/it]Best trial: 38. Best value: 0.728487:  56%|█████▌    | 56/100 [04:19<02:31,  3.44s/it]Best trial: 38. Best value: 0.728487:  56%|█████▌    | 56/100 [04:22<02:31,  3.44s/it]Best trial: 38. Best value: 0.728487:  57%|█████▋    | 57/100 [04:22<02:15,  3.16s/it]Best trial: 38. Best value: 0.728487:  57%|█████▋    | 57/100 [04:26<02:15,  3.16s/it]Best trial: 38. Best value: 0.728487:  58%|█████▊    | 58/100 [04:26<02:26,  3.49s/it]Best trial: 38. Best value: 0.728487:  58%|█████▊    | 58/100 [04:30<02:26,  3.49s/it]Best trial: 38. Best value: 0.728487:  59%|█████▉    | 59/100 [04:30<02:25,  3.55s/it]Best trial: 38. Best value: 0.728487:  59%|█████▉    | 59/100 [04:32<02:25,  3.55s/it]Best trial: 38. Best value: 0.728487:  60%|██████    | 60/100 [04:32<02:09,  3.23s/it]Best trial: 38. Best value: 0.728487:  60%|██████    | 60/100 [04:36<02:09,  3.23s/it]Best trial: 38. Best value: 0.728487:  61%|██████    | 61/100 [04:36<02:08,  3.31s/it]Best trial: 38. Best value: 0.728487:  61%|██████    | 61/100 [04:41<02:08,  3.31s/it]Best trial: 38. Best value: 0.728487:  62%|██████▏   | 62/100 [04:41<02:29,  3.93s/it]Best trial: 38. Best value: 0.728487:  62%|██████▏   | 62/100 [04:44<02:29,  3.93s/it]Best trial: 38. Best value: 0.728487:  63%|██████▎   | 63/100 [04:44<02:20,  3.78s/it]Best trial: 38. Best value: 0.728487:  63%|██████▎   | 63/100 [04:48<02:20,  3.78s/it]Best trial: 38. Best value: 0.728487:  64%|██████▍   | 64/100 [04:48<02:10,  3.63s/it]Best trial: 38. Best value: 0.728487:  64%|██████▍   | 64/100 [04:51<02:10,  3.63s/it]Best trial: 38. Best value: 0.728487:  65%|██████▌   | 65/100 [04:51<02:05,  3.60s/it]Best trial: 38. Best value: 0.728487:  65%|██████▌   | 65/100 [04:54<02:05,  3.60s/it]Best trial: 38. Best value: 0.728487:  66%|██████▌   | 66/100 [04:54<01:50,  3.26s/it]Best trial: 38. Best value: 0.728487:  66%|██████▌   | 66/100 [04:57<01:50,  3.26s/it]Best trial: 38. Best value: 0.728487:  67%|██████▋   | 67/100 [04:57<01:49,  3.31s/it]Best trial: 38. Best value: 0.728487:  67%|██████▋   | 67/100 [05:01<01:49,  3.31s/it]Best trial: 38. Best value: 0.728487:  68%|██████▊   | 68/100 [05:01<01:47,  3.37s/it]Best trial: 38. Best value: 0.728487:  68%|██████▊   | 68/100 [05:04<01:47,  3.37s/it]Best trial: 38. Best value: 0.728487:  69%|██████▉   | 69/100 [05:04<01:48,  3.50s/it]Best trial: 38. Best value: 0.728487:  69%|██████▉   | 69/100 [05:07<01:48,  3.50s/it]Best trial: 38. Best value: 0.728487:  70%|███████   | 70/100 [05:07<01:38,  3.27s/it]Best trial: 38. Best value: 0.728487:  70%|███████   | 70/100 [05:09<01:38,  3.27s/it]Best trial: 38. Best value: 0.728487:  71%|███████   | 71/100 [05:09<01:21,  2.80s/it]Best trial: 38. Best value: 0.728487:  71%|███████   | 71/100 [05:13<01:21,  2.80s/it]Best trial: 38. Best value: 0.728487:  72%|███████▏  | 72/100 [05:13<01:30,  3.22s/it]Best trial: 38. Best value: 0.728487:  72%|███████▏  | 72/100 [05:17<01:30,  3.22s/it]Best trial: 38. Best value: 0.728487:  73%|███████▎  | 73/100 [05:17<01:29,  3.32s/it]Best trial: 38. Best value: 0.728487:  73%|███████▎  | 73/100 [05:20<01:29,  3.32s/it]Best trial: 38. Best value: 0.728487:  74%|███████▍  | 74/100 [05:20<01:24,  3.23s/it]Best trial: 38. Best value: 0.728487:  74%|███████▍  | 74/100 [05:23<01:24,  3.23s/it]Best trial: 38. Best value: 0.728487:  75%|███████▌  | 75/100 [05:23<01:21,  3.27s/it]Best trial: 38. Best value: 0.728487:  75%|███████▌  | 75/100 [05:26<01:21,  3.27s/it]Best trial: 38. Best value: 0.728487:  76%|███████▌  | 76/100 [05:26<01:13,  3.08s/it]Best trial: 38. Best value: 0.728487:  76%|███████▌  | 76/100 [05:29<01:13,  3.08s/it]Best trial: 38. Best value: 0.728487:  77%|███████▋  | 77/100 [05:29<01:15,  3.29s/it]Best trial: 38. Best value: 0.728487:  77%|███████▋  | 77/100 [05:32<01:15,  3.29s/it]Best trial: 38. Best value: 0.728487:  78%|███████▊  | 78/100 [05:32<01:09,  3.17s/it]Best trial: 38. Best value: 0.728487:  78%|███████▊  | 78/100 [05:35<01:09,  3.17s/it]Best trial: 38. Best value: 0.728487:  79%|███████▉  | 79/100 [05:35<01:00,  2.88s/it]Best trial: 38. Best value: 0.728487:  79%|███████▉  | 79/100 [05:37<01:00,  2.88s/it]Best trial: 38. Best value: 0.728487:  80%|████████  | 80/100 [05:37<00:58,  2.91s/it]Best trial: 38. Best value: 0.728487:  80%|████████  | 80/100 [05:41<00:58,  2.91s/it]Best trial: 38. Best value: 0.728487:  81%|████████  | 81/100 [05:41<00:56,  2.98s/it]Best trial: 38. Best value: 0.728487:  81%|████████  | 81/100 [05:44<00:56,  2.98s/it]Best trial: 38. Best value: 0.728487:  82%|████████▏ | 82/100 [05:44<00:53,  2.96s/it]Best trial: 38. Best value: 0.728487:  82%|████████▏ | 82/100 [05:47<00:53,  2.96s/it]Best trial: 38. Best value: 0.728487:  83%|████████▎ | 83/100 [05:47<00:54,  3.20s/it]Best trial: 38. Best value: 0.728487:  83%|████████▎ | 83/100 [05:50<00:54,  3.20s/it]Best trial: 38. Best value: 0.728487:  84%|████████▍ | 84/100 [05:50<00:48,  3.02s/it]Best trial: 38. Best value: 0.728487:  84%|████████▍ | 84/100 [05:53<00:48,  3.02s/it]Best trial: 38. Best value: 0.728487:  85%|████████▌ | 85/100 [05:53<00:46,  3.12s/it]Best trial: 38. Best value: 0.728487:  85%|████████▌ | 85/100 [05:58<00:46,  3.12s/it]Best trial: 38. Best value: 0.728487:  86%|████████▌ | 86/100 [05:58<00:50,  3.62s/it]Best trial: 86. Best value: 0.729221:  86%|████████▌ | 86/100 [06:01<00:50,  3.62s/it]Best trial: 86. Best value: 0.729221:  87%|████████▋ | 87/100 [06:01<00:46,  3.56s/it]Best trial: 86. Best value: 0.729221:  87%|████████▋ | 87/100 [06:04<00:46,  3.56s/it]Best trial: 86. Best value: 0.729221:  88%|████████▊ | 88/100 [06:04<00:39,  3.33s/it]Best trial: 86. Best value: 0.729221:  88%|████████▊ | 88/100 [06:08<00:39,  3.33s/it]Best trial: 86. Best value: 0.729221:  89%|████████▉ | 89/100 [06:08<00:36,  3.34s/it]Best trial: 89. Best value: 0.729527:  89%|████████▉ | 89/100 [06:10<00:36,  3.34s/it]Best trial: 89. Best value: 0.729527:  90%|█████████ | 90/100 [06:10<00:31,  3.11s/it]Best trial: 89. Best value: 0.729527:  90%|█████████ | 90/100 [06:16<00:31,  3.11s/it]Best trial: 89. Best value: 0.729527:  91%|█████████ | 91/100 [06:16<00:35,  4.00s/it]Best trial: 89. Best value: 0.729527:  91%|█████████ | 91/100 [06:19<00:35,  4.00s/it]Best trial: 89. Best value: 0.729527:  92%|█████████▏| 92/100 [06:19<00:29,  3.68s/it]Best trial: 89. Best value: 0.729527:  92%|█████████▏| 92/100 [06:22<00:29,  3.68s/it]Best trial: 89. Best value: 0.729527:  93%|█████████▎| 93/100 [06:22<00:23,  3.38s/it]Best trial: 89. Best value: 0.729527:  93%|█████████▎| 93/100 [06:26<00:23,  3.38s/it]Best trial: 89. Best value: 0.729527:  94%|█████████▍| 94/100 [06:26<00:21,  3.63s/it]Best trial: 89. Best value: 0.729527:  94%|█████████▍| 94/100 [06:30<00:21,  3.63s/it]Best trial: 89. Best value: 0.729527:  95%|█████████▌| 95/100 [06:30<00:18,  3.72s/it]Best trial: 89. Best value: 0.729527:  95%|█████████▌| 95/100 [06:33<00:18,  3.72s/it]Best trial: 89. Best value: 0.729527:  96%|█████████▌| 96/100 [06:33<00:14,  3.58s/it]Best trial: 89. Best value: 0.729527:  96%|█████████▌| 96/100 [06:36<00:14,  3.58s/it]Best trial: 89. Best value: 0.729527:  97%|█████████▋| 97/100 [06:36<00:10,  3.38s/it]Best trial: 89. Best value: 0.729527:  97%|█████████▋| 97/100 [06:40<00:10,  3.38s/it]Best trial: 89. Best value: 0.729527:  98%|█████████▊| 98/100 [06:40<00:07,  3.60s/it]Best trial: 89. Best value: 0.729527:  98%|█████████▊| 98/100 [06:44<00:07,  3.60s/it]Best trial: 89. Best value: 0.729527:  99%|█████████▉| 99/100 [06:44<00:03,  3.54s/it]Best trial: 89. Best value: 0.729527:  99%|█████████▉| 99/100 [06:47<00:03,  3.54s/it]Best trial: 89. Best value: 0.729527: 100%|██████████| 100/100 [06:47<00:00,  3.34s/it]Best trial: 89. Best value: 0.729527: 100%|██████████| 100/100 [06:47<00:00,  4.07s/it]
2025-12-01 02:01:16,963 - INFO - HPO Complete. Best AUPRC: 0.7295
2025-12-01 02:01:16,963 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.06302452843117018, 'max_depth': 3, 'subsample': 0.9934084313970735, 'colsample_bytree': 0.9119004970453841, 'gamma': 1.8736381305172385, 'reg_lambda': 0.12916813991970133, 'reg_alpha': 0.08777869147683753}
2025-12-01 02:01:16,963 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:01:18,771 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_pleth
2025-12-01 02:01:18,771 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:01:18,857 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:01:18,889 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:01:18,898 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:01:18,899 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:01:18,899 - INFO - Training model...
2025-12-01 02:01:19,980 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:01:25,448 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:01:25,448 - INFO - AUROC: 0.8745 (0.8471 - 0.8993)
2025-12-01 02:01:25,448 - INFO - AUPRC: 0.7118 (0.6445 - 0.7643)
2025-12-01 02:01:25,448 - INFO - Brier Score: 0.1110 (0.1019 - 0.1269)
2025-12-01 02:01:25,449 - INFO - Accuracy: 0.8627 (0.8312 - 0.8809)
2025-12-01 02:01:25,449 - INFO - Precision: 0.6714 (0.5492 - 0.7661)
2025-12-01 02:01:25,449 - INFO - Sensitivity (Recall): 0.6573 (0.5848 - 0.7233)
2025-12-01 02:01:25,449 - INFO - F1-Score: 0.6643 (0.6064 - 0.7152)
2025-12-01 02:01:25,449 - INFO - Best Threshold: 0.5500 (0.4700 - 0.6240)
2025-12-01 02:01:25,449 - INFO - Specificity: 0.9162 (0.8684 - 0.9477)
2025-12-01 02:01:25,459 - INFO - Calculating SHAP values...
2025-12-01 02:01:26,454 - INFO - SHAP plots saved.
2025-12-01 02:01:26,455 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:01:27,692 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-12-01 02:01:27,692 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:01:27,802 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:01:27,839 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:01:27,848 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:01:27,848 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.682829:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.682829:   1%|          | 1/100 [00:02<03:45,  2.28s/it]Best trial: 1. Best value: 0.694148:   1%|          | 1/100 [00:09<03:45,  2.28s/it]Best trial: 1. Best value: 0.694148:   2%|▏         | 2/100 [00:09<08:22,  5.12s/it]Best trial: 1. Best value: 0.694148:   2%|▏         | 2/100 [00:19<08:22,  5.12s/it]Best trial: 1. Best value: 0.694148:   3%|▎         | 3/100 [00:19<12:06,  7.49s/it]Best trial: 1. Best value: 0.694148:   3%|▎         | 3/100 [00:26<12:06,  7.49s/it]Best trial: 1. Best value: 0.694148:   4%|▍         | 4/100 [00:26<11:33,  7.23s/it]Best trial: 4. Best value: 0.7006:   4%|▍         | 4/100 [00:32<11:33,  7.23s/it]  Best trial: 4. Best value: 0.7006:   5%|▌         | 5/100 [00:32<10:44,  6.78s/it]Best trial: 4. Best value: 0.7006:   5%|▌         | 5/100 [00:38<10:44,  6.78s/it]Best trial: 4. Best value: 0.7006:   6%|▌         | 6/100 [00:38<10:18,  6.58s/it]Best trial: 4. Best value: 0.7006:   6%|▌         | 6/100 [00:46<10:18,  6.58s/it]Best trial: 4. Best value: 0.7006:   7%|▋         | 7/100 [00:46<10:38,  6.87s/it]Best trial: 7. Best value: 0.701181:   7%|▋         | 7/100 [00:51<10:38,  6.87s/it]Best trial: 7. Best value: 0.701181:   8%|▊         | 8/100 [00:51<09:34,  6.24s/it]Best trial: 8. Best value: 0.704585:   8%|▊         | 8/100 [01:01<09:34,  6.24s/it]Best trial: 8. Best value: 0.704585:   9%|▉         | 9/100 [01:01<11:25,  7.54s/it]Best trial: 8. Best value: 0.704585:   9%|▉         | 9/100 [01:08<11:25,  7.54s/it]Best trial: 8. Best value: 0.704585:  10%|█         | 10/100 [01:08<10:51,  7.24s/it]Best trial: 10. Best value: 0.713631:  10%|█         | 10/100 [01:11<10:51,  7.24s/it]Best trial: 10. Best value: 0.713631:  11%|█         | 11/100 [01:11<09:00,  6.07s/it]Best trial: 10. Best value: 0.713631:  11%|█         | 11/100 [01:14<09:00,  6.07s/it]Best trial: 10. Best value: 0.713631:  12%|█▏        | 12/100 [01:14<07:40,  5.24s/it]Best trial: 10. Best value: 0.713631:  12%|█▏        | 12/100 [01:18<07:40,  5.24s/it]Best trial: 10. Best value: 0.713631:  13%|█▎        | 13/100 [01:18<06:47,  4.68s/it]Best trial: 10. Best value: 0.713631:  13%|█▎        | 13/100 [01:22<06:47,  4.68s/it]Best trial: 10. Best value: 0.713631:  14%|█▍        | 14/100 [01:22<06:44,  4.70s/it]Best trial: 10. Best value: 0.713631:  14%|█▍        | 14/100 [01:25<06:44,  4.70s/it]Best trial: 10. Best value: 0.713631:  15%|█▌        | 15/100 [01:25<05:56,  4.20s/it]Best trial: 15. Best value: 0.715293:  15%|█▌        | 15/100 [01:31<05:56,  4.20s/it]Best trial: 15. Best value: 0.715293:  16%|█▌        | 16/100 [01:31<06:18,  4.50s/it]Best trial: 15. Best value: 0.715293:  16%|█▌        | 16/100 [01:36<06:18,  4.50s/it]Best trial: 15. Best value: 0.715293:  17%|█▋        | 17/100 [01:36<06:25,  4.64s/it]Best trial: 15. Best value: 0.715293:  17%|█▋        | 17/100 [01:38<06:25,  4.64s/it]Best trial: 15. Best value: 0.715293:  18%|█▊        | 18/100 [01:38<05:29,  4.02s/it]Best trial: 15. Best value: 0.715293:  18%|█▊        | 18/100 [01:44<05:29,  4.02s/it]Best trial: 15. Best value: 0.715293:  19%|█▉        | 19/100 [01:44<06:13,  4.62s/it]Best trial: 15. Best value: 0.715293:  19%|█▉        | 19/100 [01:49<06:13,  4.62s/it]Best trial: 15. Best value: 0.715293:  20%|██        | 20/100 [01:49<06:09,  4.61s/it]Best trial: 15. Best value: 0.715293:  20%|██        | 20/100 [01:52<06:09,  4.61s/it]Best trial: 15. Best value: 0.715293:  21%|██        | 21/100 [01:52<05:27,  4.14s/it]Best trial: 15. Best value: 0.715293:  21%|██        | 21/100 [01:57<05:27,  4.14s/it]Best trial: 15. Best value: 0.715293:  22%|██▏       | 22/100 [01:57<05:47,  4.46s/it]Best trial: 15. Best value: 0.715293:  22%|██▏       | 22/100 [02:02<05:47,  4.46s/it]Best trial: 15. Best value: 0.715293:  23%|██▎       | 23/100 [02:02<05:45,  4.49s/it]Best trial: 15. Best value: 0.715293:  23%|██▎       | 23/100 [02:05<05:45,  4.49s/it]Best trial: 15. Best value: 0.715293:  24%|██▍       | 24/100 [02:05<05:17,  4.18s/it]Best trial: 15. Best value: 0.715293:  24%|██▍       | 24/100 [02:08<05:17,  4.18s/it]Best trial: 15. Best value: 0.715293:  25%|██▌       | 25/100 [02:08<04:39,  3.73s/it]Best trial: 25. Best value: 0.71873:  25%|██▌       | 25/100 [02:12<04:39,  3.73s/it] Best trial: 25. Best value: 0.71873:  26%|██▌       | 26/100 [02:12<04:49,  3.91s/it]Best trial: 25. Best value: 0.71873:  26%|██▌       | 26/100 [02:19<04:49,  3.91s/it]Best trial: 25. Best value: 0.71873:  27%|██▋       | 27/100 [02:19<05:46,  4.74s/it]Best trial: 25. Best value: 0.71873:  27%|██▋       | 27/100 [02:22<05:46,  4.74s/it]Best trial: 25. Best value: 0.71873:  28%|██▊       | 28/100 [02:22<05:14,  4.37s/it]Best trial: 25. Best value: 0.71873:  28%|██▊       | 28/100 [02:35<05:14,  4.37s/it]Best trial: 25. Best value: 0.71873:  29%|██▉       | 29/100 [02:35<08:05,  6.84s/it]Best trial: 25. Best value: 0.71873:  29%|██▉       | 29/100 [02:38<08:05,  6.84s/it]Best trial: 25. Best value: 0.71873:  30%|███       | 30/100 [02:38<06:50,  5.86s/it]Best trial: 25. Best value: 0.71873:  30%|███       | 30/100 [02:41<06:50,  5.86s/it]Best trial: 25. Best value: 0.71873:  31%|███       | 31/100 [02:41<05:34,  4.85s/it]Best trial: 25. Best value: 0.71873:  31%|███       | 31/100 [02:47<05:34,  4.85s/it]Best trial: 25. Best value: 0.71873:  32%|███▏      | 32/100 [02:47<05:47,  5.11s/it]Best trial: 25. Best value: 0.71873:  32%|███▏      | 32/100 [02:53<05:47,  5.11s/it]Best trial: 25. Best value: 0.71873:  33%|███▎      | 33/100 [02:53<05:57,  5.33s/it]Best trial: 25. Best value: 0.71873:  33%|███▎      | 33/100 [02:55<05:57,  5.33s/it]Best trial: 25. Best value: 0.71873:  34%|███▍      | 34/100 [02:55<04:52,  4.44s/it]Best trial: 25. Best value: 0.71873:  34%|███▍      | 34/100 [02:58<04:52,  4.44s/it]Best trial: 25. Best value: 0.71873:  35%|███▌      | 35/100 [02:58<04:16,  3.95s/it]Best trial: 25. Best value: 0.71873:  35%|███▌      | 35/100 [03:10<04:16,  3.95s/it]Best trial: 25. Best value: 0.71873:  36%|███▌      | 36/100 [03:10<06:44,  6.32s/it]Best trial: 25. Best value: 0.71873:  36%|███▌      | 36/100 [03:13<06:44,  6.32s/it]Best trial: 25. Best value: 0.71873:  37%|███▋      | 37/100 [03:13<05:50,  5.56s/it]Best trial: 25. Best value: 0.71873:  37%|███▋      | 37/100 [03:19<05:50,  5.56s/it]Best trial: 25. Best value: 0.71873:  38%|███▊      | 38/100 [03:19<05:47,  5.61s/it]Best trial: 25. Best value: 0.71873:  38%|███▊      | 38/100 [03:22<05:47,  5.61s/it]Best trial: 25. Best value: 0.71873:  39%|███▉      | 39/100 [03:22<04:49,  4.75s/it]Best trial: 25. Best value: 0.71873:  39%|███▉      | 39/100 [03:27<04:49,  4.75s/it]Best trial: 25. Best value: 0.71873:  40%|████      | 40/100 [03:27<04:51,  4.86s/it]Best trial: 40. Best value: 0.720739:  40%|████      | 40/100 [03:31<04:51,  4.86s/it]Best trial: 40. Best value: 0.720739:  41%|████      | 41/100 [03:31<04:25,  4.49s/it]Best trial: 40. Best value: 0.720739:  41%|████      | 41/100 [03:35<04:25,  4.49s/it]Best trial: 40. Best value: 0.720739:  42%|████▏     | 42/100 [03:35<04:14,  4.39s/it]Best trial: 40. Best value: 0.720739:  42%|████▏     | 42/100 [03:39<04:14,  4.39s/it]Best trial: 40. Best value: 0.720739:  43%|████▎     | 43/100 [03:39<04:01,  4.24s/it]Best trial: 40. Best value: 0.720739:  43%|████▎     | 43/100 [03:43<04:01,  4.24s/it]Best trial: 40. Best value: 0.720739:  44%|████▍     | 44/100 [03:43<04:04,  4.36s/it]Best trial: 40. Best value: 0.720739:  44%|████▍     | 44/100 [03:48<04:04,  4.36s/it]Best trial: 40. Best value: 0.720739:  45%|████▌     | 45/100 [03:48<04:07,  4.50s/it]Best trial: 40. Best value: 0.720739:  45%|████▌     | 45/100 [03:53<04:07,  4.50s/it]Best trial: 40. Best value: 0.720739:  46%|████▌     | 46/100 [03:53<04:10,  4.64s/it]Best trial: 40. Best value: 0.720739:  46%|████▌     | 46/100 [03:58<04:10,  4.64s/it]Best trial: 40. Best value: 0.720739:  47%|████▋     | 47/100 [03:58<04:17,  4.85s/it]Best trial: 40. Best value: 0.720739:  47%|████▋     | 47/100 [04:03<04:17,  4.85s/it]Best trial: 40. Best value: 0.720739:  48%|████▊     | 48/100 [04:03<04:06,  4.74s/it]Best trial: 40. Best value: 0.720739:  48%|████▊     | 48/100 [04:06<04:06,  4.74s/it]Best trial: 40. Best value: 0.720739:  49%|████▉     | 49/100 [04:06<03:34,  4.20s/it]Best trial: 40. Best value: 0.720739:  49%|████▉     | 49/100 [04:09<03:34,  4.20s/it]Best trial: 40. Best value: 0.720739:  50%|█████     | 50/100 [04:09<03:15,  3.90s/it]Best trial: 40. Best value: 0.720739:  50%|█████     | 50/100 [04:15<03:15,  3.90s/it]Best trial: 40. Best value: 0.720739:  51%|█████     | 51/100 [04:15<03:47,  4.65s/it]Best trial: 40. Best value: 0.720739:  51%|█████     | 51/100 [04:19<03:47,  4.65s/it]Best trial: 40. Best value: 0.720739:  52%|█████▏    | 52/100 [04:19<03:32,  4.43s/it]Best trial: 52. Best value: 0.725563:  52%|█████▏    | 52/100 [04:22<03:32,  4.43s/it]Best trial: 52. Best value: 0.725563:  53%|█████▎    | 53/100 [04:22<03:03,  3.90s/it]Best trial: 52. Best value: 0.725563:  53%|█████▎    | 53/100 [04:25<03:03,  3.90s/it]Best trial: 52. Best value: 0.725563:  54%|█████▍    | 54/100 [04:25<02:43,  3.55s/it]Best trial: 52. Best value: 0.725563:  54%|█████▍    | 54/100 [04:28<02:43,  3.55s/it]Best trial: 52. Best value: 0.725563:  55%|█████▌    | 55/100 [04:28<02:33,  3.41s/it]Best trial: 52. Best value: 0.725563:  55%|█████▌    | 55/100 [04:31<02:33,  3.41s/it]Best trial: 52. Best value: 0.725563:  56%|█████▌    | 56/100 [04:31<02:24,  3.29s/it]Best trial: 52. Best value: 0.725563:  56%|█████▌    | 56/100 [04:34<02:24,  3.29s/it]Best trial: 52. Best value: 0.725563:  57%|█████▋    | 57/100 [04:34<02:20,  3.26s/it]Best trial: 52. Best value: 0.725563:  57%|█████▋    | 57/100 [04:37<02:20,  3.26s/it]Best trial: 52. Best value: 0.725563:  58%|█████▊    | 58/100 [04:37<02:08,  3.06s/it]Best trial: 52. Best value: 0.725563:  58%|█████▊    | 58/100 [04:39<02:08,  3.06s/it]Best trial: 52. Best value: 0.725563:  59%|█████▉    | 59/100 [04:39<01:58,  2.89s/it]Best trial: 52. Best value: 0.725563:  59%|█████▉    | 59/100 [04:42<01:58,  2.89s/it]Best trial: 52. Best value: 0.725563:  60%|██████    | 60/100 [04:42<01:52,  2.82s/it]Best trial: 52. Best value: 0.725563:  60%|██████    | 60/100 [04:44<01:52,  2.82s/it]Best trial: 52. Best value: 0.725563:  61%|██████    | 61/100 [04:44<01:45,  2.69s/it]Best trial: 52. Best value: 0.725563:  61%|██████    | 61/100 [04:46<01:45,  2.69s/it]Best trial: 52. Best value: 0.725563:  62%|██████▏   | 62/100 [04:46<01:37,  2.57s/it]Best trial: 52. Best value: 0.725563:  62%|██████▏   | 62/100 [04:49<01:37,  2.57s/it]Best trial: 52. Best value: 0.725563:  63%|██████▎   | 63/100 [04:49<01:37,  2.63s/it]Best trial: 52. Best value: 0.725563:  63%|██████▎   | 63/100 [04:52<01:37,  2.63s/it]Best trial: 52. Best value: 0.725563:  64%|██████▍   | 64/100 [04:52<01:34,  2.62s/it]Best trial: 52. Best value: 0.725563:  64%|██████▍   | 64/100 [04:54<01:34,  2.62s/it]Best trial: 52. Best value: 0.725563:  65%|██████▌   | 65/100 [04:54<01:30,  2.59s/it]Best trial: 52. Best value: 0.725563:  65%|██████▌   | 65/100 [04:57<01:30,  2.59s/it]Best trial: 52. Best value: 0.725563:  66%|██████▌   | 66/100 [04:57<01:33,  2.76s/it]Best trial: 52. Best value: 0.725563:  66%|██████▌   | 66/100 [05:01<01:33,  2.76s/it]Best trial: 52. Best value: 0.725563:  67%|██████▋   | 67/100 [05:01<01:43,  3.14s/it]Best trial: 52. Best value: 0.725563:  67%|██████▋   | 67/100 [05:07<01:43,  3.14s/it]Best trial: 52. Best value: 0.725563:  68%|██████▊   | 68/100 [05:07<02:01,  3.78s/it]Best trial: 52. Best value: 0.725563:  68%|██████▊   | 68/100 [05:12<02:01,  3.78s/it]Best trial: 52. Best value: 0.725563:  69%|██████▉   | 69/100 [05:12<02:08,  4.15s/it]Best trial: 52. Best value: 0.725563:  69%|██████▉   | 69/100 [05:15<02:08,  4.15s/it]Best trial: 52. Best value: 0.725563:  70%|███████   | 70/100 [05:15<01:58,  3.95s/it]Best trial: 52. Best value: 0.725563:  70%|███████   | 70/100 [05:18<01:58,  3.95s/it]Best trial: 52. Best value: 0.725563:  71%|███████   | 71/100 [05:18<01:48,  3.73s/it]Best trial: 52. Best value: 0.725563:  71%|███████   | 71/100 [05:23<01:48,  3.73s/it]Best trial: 52. Best value: 0.725563:  72%|███████▏  | 72/100 [05:23<01:47,  3.85s/it]Best trial: 52. Best value: 0.725563:  72%|███████▏  | 72/100 [05:26<01:47,  3.85s/it]Best trial: 52. Best value: 0.725563:  73%|███████▎  | 73/100 [05:26<01:41,  3.75s/it]Best trial: 52. Best value: 0.725563:  73%|███████▎  | 73/100 [05:29<01:41,  3.75s/it]Best trial: 52. Best value: 0.725563:  74%|███████▍  | 74/100 [05:29<01:30,  3.46s/it]Best trial: 52. Best value: 0.725563:  74%|███████▍  | 74/100 [05:32<01:30,  3.46s/it]Best trial: 52. Best value: 0.725563:  75%|███████▌  | 75/100 [05:32<01:22,  3.32s/it]Best trial: 52. Best value: 0.725563:  75%|███████▌  | 75/100 [05:35<01:22,  3.32s/it]Best trial: 52. Best value: 0.725563:  76%|███████▌  | 76/100 [05:35<01:19,  3.33s/it]Best trial: 52. Best value: 0.725563:  76%|███████▌  | 76/100 [05:40<01:19,  3.33s/it]Best trial: 52. Best value: 0.725563:  77%|███████▋  | 77/100 [05:40<01:24,  3.66s/it]Best trial: 52. Best value: 0.725563:  77%|███████▋  | 77/100 [05:42<01:24,  3.66s/it]Best trial: 52. Best value: 0.725563:  78%|███████▊  | 78/100 [05:42<01:11,  3.26s/it]Best trial: 52. Best value: 0.725563:  78%|███████▊  | 78/100 [05:46<01:11,  3.26s/it]Best trial: 52. Best value: 0.725563:  79%|███████▉  | 79/100 [05:46<01:10,  3.37s/it]Best trial: 52. Best value: 0.725563:  79%|███████▉  | 79/100 [05:49<01:10,  3.37s/it]Best trial: 52. Best value: 0.725563:  80%|████████  | 80/100 [05:49<01:06,  3.35s/it]Best trial: 52. Best value: 0.725563:  80%|████████  | 80/100 [05:54<01:06,  3.35s/it]Best trial: 52. Best value: 0.725563:  81%|████████  | 81/100 [05:54<01:13,  3.86s/it]Best trial: 52. Best value: 0.725563:  81%|████████  | 81/100 [05:59<01:13,  3.86s/it]Best trial: 52. Best value: 0.725563:  82%|████████▏ | 82/100 [05:59<01:13,  4.10s/it]Best trial: 52. Best value: 0.725563:  82%|████████▏ | 82/100 [06:03<01:13,  4.10s/it]Best trial: 52. Best value: 0.725563:  83%|████████▎ | 83/100 [06:03<01:08,  4.04s/it]Best trial: 52. Best value: 0.725563:  83%|████████▎ | 83/100 [06:07<01:08,  4.04s/it]Best trial: 52. Best value: 0.725563:  84%|████████▍ | 84/100 [06:07<01:04,  4.05s/it]Best trial: 52. Best value: 0.725563:  84%|████████▍ | 84/100 [06:11<01:04,  4.05s/it]Best trial: 52. Best value: 0.725563:  85%|████████▌ | 85/100 [06:11<01:02,  4.15s/it]Best trial: 52. Best value: 0.725563:  85%|████████▌ | 85/100 [06:16<01:02,  4.15s/it]Best trial: 52. Best value: 0.725563:  86%|████████▌ | 86/100 [06:16<01:03,  4.51s/it]Best trial: 52. Best value: 0.725563:  86%|████████▌ | 86/100 [06:22<01:03,  4.51s/it]Best trial: 52. Best value: 0.725563:  87%|████████▋ | 87/100 [06:22<01:02,  4.81s/it]Best trial: 52. Best value: 0.725563:  87%|████████▋ | 87/100 [06:29<01:02,  4.81s/it]Best trial: 52. Best value: 0.725563:  88%|████████▊ | 88/100 [06:29<01:06,  5.57s/it]Best trial: 52. Best value: 0.725563:  88%|████████▊ | 88/100 [06:35<01:06,  5.57s/it]Best trial: 52. Best value: 0.725563:  89%|████████▉ | 89/100 [06:35<01:01,  5.55s/it]Best trial: 52. Best value: 0.725563:  89%|████████▉ | 89/100 [06:37<01:01,  5.55s/it]Best trial: 52. Best value: 0.725563:  90%|█████████ | 90/100 [06:37<00:46,  4.69s/it]Best trial: 52. Best value: 0.725563:  90%|█████████ | 90/100 [06:45<00:46,  4.69s/it]Best trial: 52. Best value: 0.725563:  91%|█████████ | 91/100 [06:45<00:49,  5.45s/it]Best trial: 52. Best value: 0.725563:  91%|█████████ | 91/100 [06:48<00:49,  5.45s/it]Best trial: 52. Best value: 0.725563:  92%|█████████▏| 92/100 [06:48<00:38,  4.84s/it]Best trial: 52. Best value: 0.725563:  92%|█████████▏| 92/100 [06:53<00:38,  4.84s/it]Best trial: 52. Best value: 0.725563:  93%|█████████▎| 93/100 [06:53<00:33,  4.83s/it]Best trial: 52. Best value: 0.725563:  93%|█████████▎| 93/100 [06:56<00:33,  4.83s/it]Best trial: 52. Best value: 0.725563:  94%|█████████▍| 94/100 [06:56<00:26,  4.37s/it]Best trial: 52. Best value: 0.725563:  94%|█████████▍| 94/100 [06:59<00:26,  4.37s/it]Best trial: 52. Best value: 0.725563:  95%|█████████▌| 95/100 [06:59<00:19,  3.88s/it]Best trial: 52. Best value: 0.725563:  95%|█████████▌| 95/100 [07:03<00:19,  3.88s/it]Best trial: 52. Best value: 0.725563:  96%|█████████▌| 96/100 [07:03<00:15,  3.92s/it]Best trial: 52. Best value: 0.725563:  96%|█████████▌| 96/100 [07:06<00:15,  3.92s/it]Best trial: 52. Best value: 0.725563:  97%|█████████▋| 97/100 [07:06<00:11,  3.79s/it]Best trial: 52. Best value: 0.725563:  97%|█████████▋| 97/100 [07:09<00:11,  3.79s/it]Best trial: 52. Best value: 0.725563:  98%|█████████▊| 98/100 [07:09<00:06,  3.32s/it]Best trial: 52. Best value: 0.725563:  98%|█████████▊| 98/100 [07:13<00:06,  3.32s/it]Best trial: 52. Best value: 0.725563:  99%|█████████▉| 99/100 [07:13<00:03,  3.64s/it]Best trial: 52. Best value: 0.725563:  99%|█████████▉| 99/100 [07:16<00:03,  3.64s/it]Best trial: 52. Best value: 0.725563: 100%|██████████| 100/100 [07:16<00:00,  3.41s/it]Best trial: 52. Best value: 0.725563: 100%|██████████| 100/100 [07:16<00:00,  4.36s/it]
2025-12-01 02:08:44,175 - INFO - HPO Complete. Best AUPRC: 0.7256
2025-12-01 02:08:44,175 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.06017794681571544, 'max_depth': 3, 'subsample': 0.9136557858778521, 'colsample_bytree': 0.9398203483358055, 'gamma': 0.3994224059404692, 'reg_lambda': 1.2200649359704582e-08, 'reg_alpha': 7.16140655014165e-08}
2025-12-01 02:08:44,176 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:08:45,991 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_ecg
2025-12-01 02:08:45,991 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:08:46,078 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:08:46,110 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:08:46,119 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:08:46,119 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:08:46,120 - INFO - Training model...
2025-12-01 02:08:47,887 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:08:53,367 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:08:53,367 - INFO - AUROC: 0.8730 (0.8452 - 0.9029)
2025-12-01 02:08:53,367 - INFO - AUPRC: 0.7219 (0.6749 - 0.7811)
2025-12-01 02:08:53,367 - INFO - Brier Score: 0.1041 (0.0913 - 0.1200)
2025-12-01 02:08:53,367 - INFO - Accuracy: 0.8540 (0.8217 - 0.8763)
2025-12-01 02:08:53,367 - INFO - Precision: 0.6265 (0.5514 - 0.7123)
2025-12-01 02:08:53,367 - INFO - Sensitivity (Recall): 0.7273 (0.6800 - 0.8053)
2025-12-01 02:08:53,367 - INFO - F1-Score: 0.6731 (0.6336 - 0.7263)
2025-12-01 02:08:53,367 - INFO - Best Threshold: 0.3900 (0.3100 - 0.4100)
2025-12-01 02:08:53,367 - INFO - Specificity: 0.8871 (0.8479 - 0.9146)
2025-12-01 02:08:53,381 - INFO - Calculating SHAP values...
2025-12-01 02:08:54,415 - INFO - SHAP plots saved.
2025-12-01 02:08:54,416 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:08:55,695 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-12-01 02:08:55,696 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:08:55,789 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:08:55,824 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:08:55,832 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:08:55,832 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.671182:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.671182:   1%|          | 1/100 [00:02<04:01,  2.44s/it]Best trial: 0. Best value: 0.671182:   1%|          | 1/100 [00:14<04:01,  2.44s/it]Best trial: 0. Best value: 0.671182:   2%|▏         | 2/100 [00:14<12:45,  7.81s/it]Best trial: 2. Best value: 0.689955:   2%|▏         | 2/100 [00:24<12:45,  7.81s/it]Best trial: 2. Best value: 0.689955:   3%|▎         | 3/100 [00:24<14:55,  9.23s/it]Best trial: 2. Best value: 0.689955:   3%|▎         | 3/100 [00:35<14:55,  9.23s/it]Best trial: 2. Best value: 0.689955:   4%|▍         | 4/100 [00:35<15:36,  9.75s/it]Best trial: 2. Best value: 0.689955:   4%|▍         | 4/100 [00:57<15:36,  9.75s/it]Best trial: 2. Best value: 0.689955:   5%|▌         | 5/100 [00:57<22:18, 14.09s/it]Best trial: 2. Best value: 0.689955:   5%|▌         | 5/100 [00:59<22:18, 14.09s/it]Best trial: 2. Best value: 0.689955:   6%|▌         | 6/100 [00:59<15:51, 10.12s/it]Best trial: 2. Best value: 0.689955:   6%|▌         | 6/100 [01:07<15:51, 10.12s/it]Best trial: 2. Best value: 0.689955:   7%|▋         | 7/100 [01:07<14:29,  9.35s/it]Best trial: 7. Best value: 0.706081:   7%|▋         | 7/100 [01:20<14:29,  9.35s/it]Best trial: 7. Best value: 0.706081:   8%|▊         | 8/100 [01:20<16:15, 10.60s/it]Best trial: 8. Best value: 0.715281:   8%|▊         | 8/100 [01:24<16:15, 10.60s/it]Best trial: 8. Best value: 0.715281:   9%|▉         | 9/100 [01:24<12:39,  8.35s/it]Best trial: 8. Best value: 0.715281:   9%|▉         | 9/100 [01:29<12:39,  8.35s/it]Best trial: 8. Best value: 0.715281:  10%|█         | 10/100 [01:29<10:56,  7.30s/it]Best trial: 8. Best value: 0.715281:  10%|█         | 10/100 [01:31<10:56,  7.30s/it]Best trial: 8. Best value: 0.715281:  11%|█         | 11/100 [01:31<08:33,  5.77s/it]Best trial: 8. Best value: 0.715281:  11%|█         | 11/100 [01:33<08:33,  5.77s/it]Best trial: 8. Best value: 0.715281:  12%|█▏        | 12/100 [01:33<07:01,  4.79s/it]Best trial: 12. Best value: 0.715719:  12%|█▏        | 12/100 [01:37<07:01,  4.79s/it]Best trial: 12. Best value: 0.715719:  13%|█▎        | 13/100 [01:37<06:15,  4.32s/it]Best trial: 12. Best value: 0.715719:  13%|█▎        | 13/100 [01:41<06:15,  4.32s/it]Best trial: 12. Best value: 0.715719:  14%|█▍        | 14/100 [01:41<06:18,  4.40s/it]Best trial: 12. Best value: 0.715719:  14%|█▍        | 14/100 [01:47<06:18,  4.40s/it]Best trial: 12. Best value: 0.715719:  15%|█▌        | 15/100 [01:47<06:56,  4.90s/it]Best trial: 12. Best value: 0.715719:  15%|█▌        | 15/100 [01:53<06:56,  4.90s/it]Best trial: 12. Best value: 0.715719:  16%|█▌        | 16/100 [01:53<07:06,  5.08s/it]Best trial: 16. Best value: 0.71578:  16%|█▌        | 16/100 [02:00<07:06,  5.08s/it] Best trial: 16. Best value: 0.71578:  17%|█▋        | 17/100 [02:00<07:47,  5.63s/it]Best trial: 16. Best value: 0.71578:  17%|█▋        | 17/100 [02:06<07:47,  5.63s/it]Best trial: 16. Best value: 0.71578:  18%|█▊        | 18/100 [02:06<07:55,  5.80s/it]Best trial: 16. Best value: 0.71578:  18%|█▊        | 18/100 [02:12<07:55,  5.80s/it]Best trial: 16. Best value: 0.71578:  19%|█▉        | 19/100 [02:12<07:55,  5.87s/it]Best trial: 16. Best value: 0.71578:  19%|█▉        | 19/100 [02:16<07:55,  5.87s/it]Best trial: 16. Best value: 0.71578:  20%|██        | 20/100 [02:16<07:09,  5.37s/it]Best trial: 16. Best value: 0.71578:  20%|██        | 20/100 [02:19<07:09,  5.37s/it]Best trial: 16. Best value: 0.71578:  21%|██        | 21/100 [02:19<05:58,  4.54s/it]Best trial: 21. Best value: 0.716427:  21%|██        | 21/100 [02:22<05:58,  4.54s/it]Best trial: 21. Best value: 0.716427:  22%|██▏       | 22/100 [02:22<05:26,  4.19s/it]Best trial: 22. Best value: 0.718762:  22%|██▏       | 22/100 [02:27<05:26,  4.19s/it]Best trial: 22. Best value: 0.718762:  23%|██▎       | 23/100 [02:27<05:29,  4.28s/it]Best trial: 22. Best value: 0.718762:  23%|██▎       | 23/100 [02:31<05:29,  4.28s/it]Best trial: 22. Best value: 0.718762:  24%|██▍       | 24/100 [02:31<05:24,  4.27s/it]Best trial: 22. Best value: 0.718762:  24%|██▍       | 24/100 [02:34<05:24,  4.27s/it]Best trial: 22. Best value: 0.718762:  25%|██▌       | 25/100 [02:34<05:02,  4.03s/it]Best trial: 22. Best value: 0.718762:  25%|██▌       | 25/100 [02:40<05:02,  4.03s/it]Best trial: 22. Best value: 0.718762:  26%|██▌       | 26/100 [02:40<05:24,  4.39s/it]Best trial: 22. Best value: 0.718762:  26%|██▌       | 26/100 [02:43<05:24,  4.39s/it]Best trial: 22. Best value: 0.718762:  27%|██▋       | 27/100 [02:43<04:55,  4.04s/it]Best trial: 22. Best value: 0.718762:  27%|██▋       | 27/100 [02:47<04:55,  4.04s/it]Best trial: 22. Best value: 0.718762:  28%|██▊       | 28/100 [02:47<04:50,  4.03s/it]Best trial: 22. Best value: 0.718762:  28%|██▊       | 28/100 [02:55<04:50,  4.03s/it]Best trial: 22. Best value: 0.718762:  29%|██▉       | 29/100 [02:55<06:06,  5.16s/it]Best trial: 22. Best value: 0.718762:  29%|██▉       | 29/100 [02:57<06:06,  5.16s/it]Best trial: 22. Best value: 0.718762:  30%|███       | 30/100 [02:57<05:10,  4.43s/it]Best trial: 22. Best value: 0.718762:  30%|███       | 30/100 [03:01<05:10,  4.43s/it]Best trial: 22. Best value: 0.718762:  31%|███       | 31/100 [03:01<04:49,  4.19s/it]Best trial: 22. Best value: 0.718762:  31%|███       | 31/100 [03:06<04:49,  4.19s/it]Best trial: 22. Best value: 0.718762:  32%|███▏      | 32/100 [03:06<05:04,  4.47s/it]Best trial: 22. Best value: 0.718762:  32%|███▏      | 32/100 [03:12<05:04,  4.47s/it]Best trial: 22. Best value: 0.718762:  33%|███▎      | 33/100 [03:12<05:18,  4.76s/it]Best trial: 22. Best value: 0.718762:  33%|███▎      | 33/100 [03:15<05:18,  4.76s/it]Best trial: 22. Best value: 0.718762:  34%|███▍      | 34/100 [03:15<04:42,  4.28s/it]Best trial: 22. Best value: 0.718762:  34%|███▍      | 34/100 [03:18<04:42,  4.28s/it]Best trial: 22. Best value: 0.718762:  35%|███▌      | 35/100 [03:18<04:25,  4.09s/it]Best trial: 35. Best value: 0.72068:  35%|███▌      | 35/100 [03:21<04:25,  4.09s/it] Best trial: 35. Best value: 0.72068:  36%|███▌      | 36/100 [03:21<04:04,  3.82s/it]Best trial: 35. Best value: 0.72068:  36%|███▌      | 36/100 [03:24<04:04,  3.82s/it]Best trial: 35. Best value: 0.72068:  37%|███▋      | 37/100 [03:24<03:40,  3.50s/it]Best trial: 35. Best value: 0.72068:  37%|███▋      | 37/100 [03:29<03:40,  3.50s/it]Best trial: 35. Best value: 0.72068:  38%|███▊      | 38/100 [03:29<04:04,  3.94s/it]Best trial: 35. Best value: 0.72068:  38%|███▊      | 38/100 [03:37<04:04,  3.94s/it]Best trial: 35. Best value: 0.72068:  39%|███▉      | 39/100 [03:37<05:17,  5.20s/it]Best trial: 35. Best value: 0.72068:  39%|███▉      | 39/100 [03:40<05:17,  5.20s/it]Best trial: 35. Best value: 0.72068:  40%|████      | 40/100 [03:40<04:17,  4.29s/it]Best trial: 35. Best value: 0.72068:  40%|████      | 40/100 [03:42<04:17,  4.29s/it]Best trial: 35. Best value: 0.72068:  41%|████      | 41/100 [03:42<03:39,  3.72s/it]Best trial: 35. Best value: 0.72068:  41%|████      | 41/100 [03:45<03:39,  3.72s/it]Best trial: 35. Best value: 0.72068:  42%|████▏     | 42/100 [03:45<03:28,  3.59s/it]Best trial: 35. Best value: 0.72068:  42%|████▏     | 42/100 [03:49<03:28,  3.59s/it]Best trial: 35. Best value: 0.72068:  43%|████▎     | 43/100 [03:49<03:27,  3.64s/it]Best trial: 35. Best value: 0.72068:  43%|████▎     | 43/100 [03:52<03:27,  3.64s/it]Best trial: 35. Best value: 0.72068:  44%|████▍     | 44/100 [03:52<03:12,  3.43s/it]Best trial: 35. Best value: 0.72068:  44%|████▍     | 44/100 [03:55<03:12,  3.43s/it]Best trial: 35. Best value: 0.72068:  45%|████▌     | 45/100 [03:55<03:11,  3.48s/it]Best trial: 35. Best value: 0.72068:  45%|████▌     | 45/100 [03:58<03:11,  3.48s/it]Best trial: 35. Best value: 0.72068:  46%|████▌     | 46/100 [03:58<02:49,  3.15s/it]Best trial: 35. Best value: 0.72068:  46%|████▌     | 46/100 [04:04<02:49,  3.15s/it]Best trial: 35. Best value: 0.72068:  47%|████▋     | 47/100 [04:04<03:41,  4.18s/it]Best trial: 35. Best value: 0.72068:  47%|████▋     | 47/100 [04:08<03:41,  4.18s/it]Best trial: 35. Best value: 0.72068:  48%|████▊     | 48/100 [04:08<03:26,  3.98s/it]Best trial: 35. Best value: 0.72068:  48%|████▊     | 48/100 [04:21<03:26,  3.98s/it]Best trial: 35. Best value: 0.72068:  49%|████▉     | 49/100 [04:21<05:40,  6.67s/it]Best trial: 35. Best value: 0.72068:  49%|████▉     | 49/100 [04:27<05:40,  6.67s/it]Best trial: 35. Best value: 0.72068:  50%|█████     | 50/100 [04:27<05:22,  6.44s/it]Best trial: 35. Best value: 0.72068:  50%|█████     | 50/100 [04:30<05:22,  6.44s/it]Best trial: 35. Best value: 0.72068:  51%|█████     | 51/100 [04:30<04:23,  5.38s/it]Best trial: 35. Best value: 0.72068:  51%|█████     | 51/100 [04:34<04:23,  5.38s/it]Best trial: 35. Best value: 0.72068:  52%|█████▏    | 52/100 [04:34<04:06,  5.13s/it]Best trial: 35. Best value: 0.72068:  52%|█████▏    | 52/100 [04:38<04:06,  5.13s/it]Best trial: 35. Best value: 0.72068:  53%|█████▎    | 53/100 [04:38<03:45,  4.80s/it]Best trial: 35. Best value: 0.72068:  53%|█████▎    | 53/100 [04:44<03:45,  4.80s/it]Best trial: 35. Best value: 0.72068:  54%|█████▍    | 54/100 [04:44<03:54,  5.10s/it]Best trial: 35. Best value: 0.72068:  54%|█████▍    | 54/100 [04:48<03:54,  5.10s/it]Best trial: 35. Best value: 0.72068:  55%|█████▌    | 55/100 [04:48<03:32,  4.71s/it]Best trial: 35. Best value: 0.72068:  55%|█████▌    | 55/100 [04:51<03:32,  4.71s/it]Best trial: 35. Best value: 0.72068:  56%|█████▌    | 56/100 [04:51<02:59,  4.09s/it]Best trial: 35. Best value: 0.72068:  56%|█████▌    | 56/100 [04:56<02:59,  4.09s/it]Best trial: 35. Best value: 0.72068:  57%|█████▋    | 57/100 [04:56<03:08,  4.39s/it]Best trial: 35. Best value: 0.72068:  57%|█████▋    | 57/100 [05:07<03:08,  4.39s/it]Best trial: 35. Best value: 0.72068:  58%|█████▊    | 58/100 [05:07<04:27,  6.37s/it]Best trial: 35. Best value: 0.72068:  58%|█████▊    | 58/100 [05:09<04:27,  6.37s/it]Best trial: 35. Best value: 0.72068:  59%|█████▉    | 59/100 [05:09<03:35,  5.25s/it]Best trial: 35. Best value: 0.72068:  59%|█████▉    | 59/100 [05:13<03:35,  5.25s/it]Best trial: 35. Best value: 0.72068:  60%|██████    | 60/100 [05:13<03:11,  4.79s/it]Best trial: 35. Best value: 0.72068:  60%|██████    | 60/100 [05:19<03:11,  4.79s/it]Best trial: 35. Best value: 0.72068:  61%|██████    | 61/100 [05:19<03:22,  5.19s/it]Best trial: 35. Best value: 0.72068:  61%|██████    | 61/100 [05:22<03:22,  5.19s/it]Best trial: 35. Best value: 0.72068:  62%|██████▏   | 62/100 [05:22<02:55,  4.61s/it]Best trial: 35. Best value: 0.72068:  62%|██████▏   | 62/100 [05:26<02:55,  4.61s/it]Best trial: 35. Best value: 0.72068:  63%|██████▎   | 63/100 [05:26<02:40,  4.33s/it]Best trial: 35. Best value: 0.72068:  63%|██████▎   | 63/100 [05:29<02:40,  4.33s/it]Best trial: 35. Best value: 0.72068:  64%|██████▍   | 64/100 [05:29<02:24,  4.00s/it]Best trial: 35. Best value: 0.72068:  64%|██████▍   | 64/100 [05:32<02:24,  4.00s/it]Best trial: 35. Best value: 0.72068:  65%|██████▌   | 65/100 [05:32<02:11,  3.75s/it]Best trial: 35. Best value: 0.72068:  65%|██████▌   | 65/100 [05:38<02:11,  3.75s/it]Best trial: 35. Best value: 0.72068:  66%|██████▌   | 66/100 [05:38<02:23,  4.22s/it]Best trial: 66. Best value: 0.722301:  66%|██████▌   | 66/100 [05:42<02:23,  4.22s/it]Best trial: 66. Best value: 0.722301:  67%|██████▋   | 67/100 [05:42<02:16,  4.12s/it]Best trial: 66. Best value: 0.722301:  67%|██████▋   | 67/100 [05:46<02:16,  4.12s/it]Best trial: 66. Best value: 0.722301:  68%|██████▊   | 68/100 [05:46<02:11,  4.11s/it]Best trial: 66. Best value: 0.722301:  68%|██████▊   | 68/100 [05:49<02:11,  4.11s/it]Best trial: 66. Best value: 0.722301:  69%|██████▉   | 69/100 [05:49<01:57,  3.80s/it]Best trial: 66. Best value: 0.722301:  69%|██████▉   | 69/100 [05:53<01:57,  3.80s/it]Best trial: 66. Best value: 0.722301:  70%|███████   | 70/100 [05:53<02:01,  4.04s/it]Best trial: 66. Best value: 0.722301:  70%|███████   | 70/100 [05:57<02:01,  4.04s/it]Best trial: 66. Best value: 0.722301:  71%|███████   | 71/100 [05:57<01:51,  3.85s/it]Best trial: 66. Best value: 0.722301:  71%|███████   | 71/100 [06:01<01:51,  3.85s/it]Best trial: 66. Best value: 0.722301:  72%|███████▏  | 72/100 [06:01<01:54,  4.09s/it]Best trial: 72. Best value: 0.723169:  72%|███████▏  | 72/100 [06:06<01:54,  4.09s/it]Best trial: 72. Best value: 0.723169:  73%|███████▎  | 73/100 [06:06<01:50,  4.08s/it]Best trial: 72. Best value: 0.723169:  73%|███████▎  | 73/100 [06:09<01:50,  4.08s/it]Best trial: 72. Best value: 0.723169:  74%|███████▍  | 74/100 [06:09<01:38,  3.77s/it]Best trial: 72. Best value: 0.723169:  74%|███████▍  | 74/100 [06:12<01:38,  3.77s/it]Best trial: 72. Best value: 0.723169:  75%|███████▌  | 75/100 [06:12<01:31,  3.66s/it]Best trial: 72. Best value: 0.723169:  75%|███████▌  | 75/100 [06:15<01:31,  3.66s/it]Best trial: 72. Best value: 0.723169:  76%|███████▌  | 76/100 [06:15<01:19,  3.33s/it]Best trial: 72. Best value: 0.723169:  76%|███████▌  | 76/100 [06:17<01:19,  3.33s/it]Best trial: 72. Best value: 0.723169:  77%|███████▋  | 77/100 [06:17<01:12,  3.13s/it]Best trial: 72. Best value: 0.723169:  77%|███████▋  | 77/100 [06:20<01:12,  3.13s/it]Best trial: 72. Best value: 0.723169:  78%|███████▊  | 78/100 [06:20<01:04,  2.92s/it]Best trial: 72. Best value: 0.723169:  78%|███████▊  | 78/100 [06:22<01:04,  2.92s/it]Best trial: 72. Best value: 0.723169:  79%|███████▉  | 79/100 [06:22<00:58,  2.80s/it]Best trial: 79. Best value: 0.724986:  79%|███████▉  | 79/100 [06:25<00:58,  2.80s/it]Best trial: 79. Best value: 0.724986:  80%|████████  | 80/100 [06:25<00:57,  2.85s/it]Best trial: 79. Best value: 0.724986:  80%|████████  | 80/100 [06:27<00:57,  2.85s/it]Best trial: 79. Best value: 0.724986:  81%|████████  | 81/100 [06:27<00:51,  2.69s/it]Best trial: 79. Best value: 0.724986:  81%|████████  | 81/100 [06:30<00:51,  2.69s/it]Best trial: 79. Best value: 0.724986:  82%|████████▏ | 82/100 [06:30<00:48,  2.69s/it]Best trial: 79. Best value: 0.724986:  82%|████████▏ | 82/100 [06:33<00:48,  2.69s/it]Best trial: 79. Best value: 0.724986:  83%|████████▎ | 83/100 [06:33<00:45,  2.67s/it]Best trial: 79. Best value: 0.724986:  83%|████████▎ | 83/100 [06:35<00:45,  2.67s/it]Best trial: 79. Best value: 0.724986:  84%|████████▍ | 84/100 [06:35<00:41,  2.58s/it]Best trial: 79. Best value: 0.724986:  84%|████████▍ | 84/100 [06:37<00:41,  2.58s/it]Best trial: 79. Best value: 0.724986:  85%|████████▌ | 85/100 [06:37<00:36,  2.41s/it]Best trial: 79. Best value: 0.724986:  85%|████████▌ | 85/100 [06:40<00:36,  2.41s/it]Best trial: 79. Best value: 0.724986:  86%|████████▌ | 86/100 [06:40<00:34,  2.45s/it]Best trial: 79. Best value: 0.724986:  86%|████████▌ | 86/100 [06:42<00:34,  2.45s/it]Best trial: 79. Best value: 0.724986:  87%|████████▋ | 87/100 [06:42<00:32,  2.49s/it]Best trial: 79. Best value: 0.724986:  87%|████████▋ | 87/100 [06:44<00:32,  2.49s/it]Best trial: 79. Best value: 0.724986:  88%|████████▊ | 88/100 [06:44<00:28,  2.38s/it]Best trial: 79. Best value: 0.724986:  88%|████████▊ | 88/100 [06:47<00:28,  2.38s/it]Best trial: 79. Best value: 0.724986:  89%|████████▉ | 89/100 [06:47<00:27,  2.51s/it]Best trial: 79. Best value: 0.724986:  89%|████████▉ | 89/100 [06:50<00:27,  2.51s/it]Best trial: 79. Best value: 0.724986:  90%|█████████ | 90/100 [06:50<00:27,  2.73s/it]Best trial: 79. Best value: 0.724986:  90%|█████████ | 90/100 [06:52<00:27,  2.73s/it]Best trial: 79. Best value: 0.724986:  91%|█████████ | 91/100 [06:52<00:22,  2.50s/it]Best trial: 79. Best value: 0.724986:  91%|█████████ | 91/100 [06:55<00:22,  2.50s/it]Best trial: 79. Best value: 0.724986:  92%|█████████▏| 92/100 [06:55<00:20,  2.58s/it]Best trial: 79. Best value: 0.724986:  92%|█████████▏| 92/100 [06:58<00:20,  2.58s/it]Best trial: 79. Best value: 0.724986:  93%|█████████▎| 93/100 [06:58<00:18,  2.63s/it]Best trial: 79. Best value: 0.724986:  93%|█████████▎| 93/100 [07:01<00:18,  2.63s/it]Best trial: 79. Best value: 0.724986:  94%|█████████▍| 94/100 [07:01<00:16,  2.70s/it]Best trial: 79. Best value: 0.724986:  94%|█████████▍| 94/100 [07:03<00:16,  2.70s/it]Best trial: 79. Best value: 0.724986:  95%|█████████▌| 95/100 [07:03<00:12,  2.57s/it]Best trial: 79. Best value: 0.724986:  95%|█████████▌| 95/100 [07:07<00:12,  2.57s/it]Best trial: 79. Best value: 0.724986:  96%|█████████▌| 96/100 [07:07<00:11,  2.86s/it]Best trial: 79. Best value: 0.724986:  96%|█████████▌| 96/100 [07:09<00:11,  2.86s/it]Best trial: 79. Best value: 0.724986:  97%|█████████▋| 97/100 [07:09<00:08,  2.79s/it]Best trial: 79. Best value: 0.724986:  97%|█████████▋| 97/100 [07:13<00:08,  2.79s/it]Best trial: 79. Best value: 0.724986:  98%|█████████▊| 98/100 [07:13<00:06,  3.21s/it]Best trial: 79. Best value: 0.724986:  98%|█████████▊| 98/100 [07:16<00:06,  3.21s/it]Best trial: 79. Best value: 0.724986:  99%|█████████▉| 99/100 [07:16<00:03,  3.04s/it]Best trial: 79. Best value: 0.724986:  99%|█████████▉| 99/100 [07:18<00:03,  3.04s/it]Best trial: 79. Best value: 0.724986: 100%|██████████| 100/100 [07:18<00:00,  2.86s/it]Best trial: 79. Best value: 0.724986: 100%|██████████| 100/100 [07:18<00:00,  4.39s/it]
2025-12-01 02:16:14,816 - INFO - HPO Complete. Best AUPRC: 0.7250
2025-12-01 02:16:14,816 - INFO - Best Params: {'n_estimators': 300, 'learning_rate': 0.048239236755003294, 'max_depth': 3, 'subsample': 0.935494084577333, 'colsample_bytree': 0.8234615782752116, 'gamma': 4.974804966800082, 'reg_lambda': 1.1836397673433654e-07, 'reg_alpha': 0.010713412092913897}
2025-12-01 02:16:14,816 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:16:16,616 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_co2
2025-12-01 02:16:16,616 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:16:16,703 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:16:16,734 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:16:16,744 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:16:16,744 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:16:16,744 - INFO - Training model...
2025-12-01 02:16:17,549 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:16:22,960 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:16:22,961 - INFO - AUROC: 0.8973 (0.8761 - 0.9157)
2025-12-01 02:16:22,961 - INFO - AUPRC: 0.7386 (0.6762 - 0.7918)
2025-12-01 02:16:22,961 - INFO - Brier Score: 0.1120 (0.1033 - 0.1237)
2025-12-01 02:16:22,961 - INFO - Accuracy: 0.8728 (0.8185 - 0.8902)
2025-12-01 02:16:22,961 - INFO - Precision: 0.7391 (0.5868 - 0.8065)
2025-12-01 02:16:22,961 - INFO - Sensitivity (Recall): 0.5944 (0.5459 - 0.8365)
2025-12-01 02:16:22,961 - INFO - F1-Score: 0.6589 (0.6254 - 0.7114)
2025-12-01 02:16:22,961 - INFO - Best Threshold: 0.6500 (0.4100 - 0.6800)
2025-12-01 02:16:22,961 - INFO - Specificity: 0.9454 (0.8150 - 0.9642)
2025-12-01 02:16:22,967 - INFO - Calculating SHAP values...
2025-12-01 02:16:23,911 - INFO - SHAP plots saved.
2025-12-01 02:16:23,911 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=non_windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:16:25,155 - INFO - Starting HPO for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 02:16:25,156 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:16:25,257 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:16:25,289 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:16:25,297 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:16:25,297 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.696486:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.696486:   1%|          | 1/100 [00:03<05:32,  3.35s/it]Best trial: 1. Best value: 0.713966:   1%|          | 1/100 [00:07<05:32,  3.35s/it]Best trial: 1. Best value: 0.713966:   2%|▏         | 2/100 [00:07<06:16,  3.85s/it]Best trial: 1. Best value: 0.713966:   2%|▏         | 2/100 [00:11<06:16,  3.85s/it]Best trial: 1. Best value: 0.713966:   3%|▎         | 3/100 [00:11<06:07,  3.79s/it]Best trial: 1. Best value: 0.713966:   3%|▎         | 3/100 [00:15<06:07,  3.79s/it]Best trial: 1. Best value: 0.713966:   4%|▍         | 4/100 [00:15<06:07,  3.83s/it]Best trial: 1. Best value: 0.713966:   4%|▍         | 4/100 [00:24<06:07,  3.83s/it]Best trial: 1. Best value: 0.713966:   5%|▌         | 5/100 [00:24<09:20,  5.90s/it]Best trial: 1. Best value: 0.713966:   5%|▌         | 5/100 [00:30<09:20,  5.90s/it]Best trial: 1. Best value: 0.713966:   6%|▌         | 6/100 [00:30<08:58,  5.73s/it]Best trial: 1. Best value: 0.713966:   6%|▌         | 6/100 [00:33<08:58,  5.73s/it]Best trial: 1. Best value: 0.713966:   7%|▋         | 7/100 [00:33<07:45,  5.00s/it]Best trial: 1. Best value: 0.713966:   7%|▋         | 7/100 [00:38<07:45,  5.00s/it]Best trial: 1. Best value: 0.713966:   8%|▊         | 8/100 [00:38<07:37,  4.97s/it]Best trial: 1. Best value: 0.713966:   8%|▊         | 8/100 [00:48<07:37,  4.97s/it]Best trial: 1. Best value: 0.713966:   9%|▉         | 9/100 [00:48<09:46,  6.45s/it]Best trial: 1. Best value: 0.713966:   9%|▉         | 9/100 [00:54<09:46,  6.45s/it]Best trial: 1. Best value: 0.713966:  10%|█         | 10/100 [00:54<09:30,  6.34s/it]Best trial: 1. Best value: 0.713966:  10%|█         | 10/100 [00:58<09:30,  6.34s/it]Best trial: 1. Best value: 0.713966:  11%|█         | 11/100 [00:58<08:16,  5.58s/it]Best trial: 11. Best value: 0.71983:  11%|█         | 11/100 [01:02<08:16,  5.58s/it]Best trial: 11. Best value: 0.71983:  12%|█▏        | 12/100 [01:02<07:41,  5.25s/it]Best trial: 11. Best value: 0.71983:  12%|█▏        | 12/100 [01:06<07:41,  5.25s/it]Best trial: 11. Best value: 0.71983:  13%|█▎        | 13/100 [01:06<06:55,  4.78s/it]Best trial: 11. Best value: 0.71983:  13%|█▎        | 13/100 [01:11<06:55,  4.78s/it]Best trial: 11. Best value: 0.71983:  14%|█▍        | 14/100 [01:11<06:58,  4.87s/it]Best trial: 11. Best value: 0.71983:  14%|█▍        | 14/100 [01:17<06:58,  4.87s/it]Best trial: 11. Best value: 0.71983:  15%|█▌        | 15/100 [01:17<07:27,  5.26s/it]Best trial: 11. Best value: 0.71983:  15%|█▌        | 15/100 [01:22<07:27,  5.26s/it]Best trial: 11. Best value: 0.71983:  16%|█▌        | 16/100 [01:22<07:05,  5.06s/it]Best trial: 11. Best value: 0.71983:  16%|█▌        | 16/100 [01:25<07:05,  5.06s/it]Best trial: 11. Best value: 0.71983:  17%|█▋        | 17/100 [01:25<06:07,  4.43s/it]Best trial: 11. Best value: 0.71983:  17%|█▋        | 17/100 [01:33<06:07,  4.43s/it]Best trial: 11. Best value: 0.71983:  18%|█▊        | 18/100 [01:33<07:40,  5.61s/it]Best trial: 11. Best value: 0.71983:  18%|█▊        | 18/100 [01:44<07:40,  5.61s/it]Best trial: 11. Best value: 0.71983:  19%|█▉        | 19/100 [01:44<09:52,  7.31s/it]Best trial: 11. Best value: 0.71983:  19%|█▉        | 19/100 [01:46<09:52,  7.31s/it]Best trial: 11. Best value: 0.71983:  20%|██        | 20/100 [01:46<07:34,  5.69s/it]Best trial: 11. Best value: 0.71983:  20%|██        | 20/100 [01:50<07:34,  5.69s/it]Best trial: 11. Best value: 0.71983:  21%|██        | 21/100 [01:50<06:46,  5.14s/it]Best trial: 11. Best value: 0.71983:  21%|██        | 21/100 [01:57<06:46,  5.14s/it]Best trial: 11. Best value: 0.71983:  22%|██▏       | 22/100 [01:57<07:16,  5.60s/it]Best trial: 11. Best value: 0.71983:  22%|██▏       | 22/100 [02:03<07:16,  5.60s/it]Best trial: 11. Best value: 0.71983:  23%|██▎       | 23/100 [02:03<07:17,  5.68s/it]Best trial: 11. Best value: 0.71983:  23%|██▎       | 23/100 [02:05<07:17,  5.68s/it]Best trial: 11. Best value: 0.71983:  24%|██▍       | 24/100 [02:05<05:51,  4.63s/it]Best trial: 11. Best value: 0.71983:  24%|██▍       | 24/100 [02:10<05:51,  4.63s/it]Best trial: 11. Best value: 0.71983:  25%|██▌       | 25/100 [02:10<06:02,  4.83s/it]Best trial: 11. Best value: 0.71983:  25%|██▌       | 25/100 [02:13<06:02,  4.83s/it]Best trial: 11. Best value: 0.71983:  26%|██▌       | 26/100 [02:13<05:13,  4.24s/it]Best trial: 11. Best value: 0.71983:  26%|██▌       | 26/100 [02:16<05:13,  4.24s/it]Best trial: 11. Best value: 0.71983:  27%|██▋       | 27/100 [02:16<04:33,  3.75s/it]Best trial: 11. Best value: 0.71983:  27%|██▋       | 27/100 [02:20<04:33,  3.75s/it]Best trial: 11. Best value: 0.71983:  28%|██▊       | 28/100 [02:20<04:41,  3.90s/it]Best trial: 11. Best value: 0.71983:  28%|██▊       | 28/100 [02:24<04:41,  3.90s/it]Best trial: 11. Best value: 0.71983:  29%|██▉       | 29/100 [02:24<04:45,  4.02s/it]Best trial: 11. Best value: 0.71983:  29%|██▉       | 29/100 [02:28<04:45,  4.02s/it]Best trial: 11. Best value: 0.71983:  30%|███       | 30/100 [02:28<04:31,  3.88s/it]Best trial: 11. Best value: 0.71983:  30%|███       | 30/100 [02:32<04:31,  3.88s/it]Best trial: 11. Best value: 0.71983:  31%|███       | 31/100 [02:32<04:30,  3.91s/it]Best trial: 11. Best value: 0.71983:  31%|███       | 31/100 [02:35<04:30,  3.91s/it]Best trial: 11. Best value: 0.71983:  32%|███▏      | 32/100 [02:35<04:22,  3.87s/it]Best trial: 11. Best value: 0.71983:  32%|███▏      | 32/100 [02:40<04:22,  3.87s/it]Best trial: 11. Best value: 0.71983:  33%|███▎      | 33/100 [02:40<04:30,  4.04s/it]Best trial: 11. Best value: 0.71983:  33%|███▎      | 33/100 [02:43<04:30,  4.04s/it]Best trial: 11. Best value: 0.71983:  34%|███▍      | 34/100 [02:43<03:59,  3.63s/it]Best trial: 11. Best value: 0.71983:  34%|███▍      | 34/100 [02:45<03:59,  3.63s/it]Best trial: 11. Best value: 0.71983:  35%|███▌      | 35/100 [02:45<03:26,  3.17s/it]Best trial: 11. Best value: 0.71983:  35%|███▌      | 35/100 [02:47<03:26,  3.17s/it]Best trial: 11. Best value: 0.71983:  36%|███▌      | 36/100 [02:47<03:02,  2.85s/it]Best trial: 11. Best value: 0.71983:  36%|███▌      | 36/100 [02:49<03:02,  2.85s/it]Best trial: 11. Best value: 0.71983:  37%|███▋      | 37/100 [02:49<02:41,  2.56s/it]Best trial: 11. Best value: 0.71983:  37%|███▋      | 37/100 [02:51<02:41,  2.56s/it]Best trial: 11. Best value: 0.71983:  38%|███▊      | 38/100 [02:51<02:42,  2.61s/it]Best trial: 11. Best value: 0.71983:  38%|███▊      | 38/100 [02:57<02:42,  2.61s/it]Best trial: 11. Best value: 0.71983:  39%|███▉      | 39/100 [02:57<03:25,  3.37s/it]Best trial: 11. Best value: 0.71983:  39%|███▉      | 39/100 [03:02<03:25,  3.37s/it]Best trial: 11. Best value: 0.71983:  40%|████      | 40/100 [03:02<04:01,  4.02s/it]Best trial: 11. Best value: 0.71983:  40%|████      | 40/100 [03:04<04:01,  4.02s/it]Best trial: 11. Best value: 0.71983:  41%|████      | 41/100 [03:04<03:26,  3.50s/it]Best trial: 41. Best value: 0.722923:  41%|████      | 41/100 [03:10<03:26,  3.50s/it]Best trial: 41. Best value: 0.722923:  42%|████▏     | 42/100 [03:10<03:54,  4.05s/it]Best trial: 41. Best value: 0.722923:  42%|████▏     | 42/100 [03:13<03:54,  4.05s/it]Best trial: 41. Best value: 0.722923:  43%|████▎     | 43/100 [03:13<03:34,  3.77s/it]Best trial: 41. Best value: 0.722923:  43%|████▎     | 43/100 [03:17<03:34,  3.77s/it]Best trial: 41. Best value: 0.722923:  44%|████▍     | 44/100 [03:17<03:34,  3.83s/it]Best trial: 41. Best value: 0.722923:  44%|████▍     | 44/100 [03:20<03:34,  3.83s/it]Best trial: 41. Best value: 0.722923:  45%|████▌     | 45/100 [03:20<03:13,  3.51s/it]Best trial: 41. Best value: 0.722923:  45%|████▌     | 45/100 [03:23<03:13,  3.51s/it]Best trial: 41. Best value: 0.722923:  46%|████▌     | 46/100 [03:23<03:04,  3.42s/it]Best trial: 41. Best value: 0.722923:  46%|████▌     | 46/100 [03:26<03:04,  3.42s/it]Best trial: 41. Best value: 0.722923:  47%|████▋     | 47/100 [03:26<02:52,  3.25s/it]Best trial: 41. Best value: 0.722923:  47%|████▋     | 47/100 [03:31<02:52,  3.25s/it]Best trial: 41. Best value: 0.722923:  48%|████▊     | 48/100 [03:31<03:22,  3.90s/it]Best trial: 41. Best value: 0.722923:  48%|████▊     | 48/100 [03:37<03:22,  3.90s/it]Best trial: 41. Best value: 0.722923:  49%|████▉     | 49/100 [03:37<03:51,  4.54s/it]Best trial: 41. Best value: 0.722923:  49%|████▉     | 49/100 [03:44<03:51,  4.54s/it]Best trial: 41. Best value: 0.722923:  50%|█████     | 50/100 [03:44<04:30,  5.40s/it]Best trial: 41. Best value: 0.722923:  50%|█████     | 50/100 [03:48<04:30,  5.40s/it]Best trial: 41. Best value: 0.722923:  51%|█████     | 51/100 [03:48<03:57,  4.85s/it]Best trial: 41. Best value: 0.722923:  51%|█████     | 51/100 [03:52<03:57,  4.85s/it]Best trial: 41. Best value: 0.722923:  52%|█████▏    | 52/100 [03:52<03:42,  4.64s/it]Best trial: 41. Best value: 0.722923:  52%|█████▏    | 52/100 [03:55<03:42,  4.64s/it]Best trial: 41. Best value: 0.722923:  53%|█████▎    | 53/100 [03:55<03:08,  4.00s/it]Best trial: 41. Best value: 0.722923:  53%|█████▎    | 53/100 [03:59<03:08,  4.00s/it]Best trial: 41. Best value: 0.722923:  54%|█████▍    | 54/100 [03:59<03:04,  4.02s/it]Best trial: 41. Best value: 0.722923:  54%|█████▍    | 54/100 [04:05<03:04,  4.02s/it]Best trial: 41. Best value: 0.722923:  55%|█████▌    | 55/100 [04:05<03:24,  4.55s/it]Best trial: 41. Best value: 0.722923:  55%|█████▌    | 55/100 [04:10<03:24,  4.55s/it]Best trial: 41. Best value: 0.722923:  56%|█████▌    | 56/100 [04:10<03:37,  4.95s/it]Best trial: 41. Best value: 0.722923:  56%|█████▌    | 56/100 [04:16<03:37,  4.95s/it]Best trial: 41. Best value: 0.722923:  57%|█████▋    | 57/100 [04:16<03:41,  5.14s/it]Best trial: 41. Best value: 0.722923:  57%|█████▋    | 57/100 [04:21<03:41,  5.14s/it]Best trial: 41. Best value: 0.722923:  58%|█████▊    | 58/100 [04:21<03:38,  5.19s/it]Best trial: 41. Best value: 0.722923:  58%|█████▊    | 58/100 [04:28<03:38,  5.19s/it]Best trial: 41. Best value: 0.722923:  59%|█████▉    | 59/100 [04:28<03:46,  5.53s/it]Best trial: 41. Best value: 0.722923:  59%|█████▉    | 59/100 [04:31<03:46,  5.53s/it]Best trial: 41. Best value: 0.722923:  60%|██████    | 60/100 [04:31<03:19,  5.00s/it]Best trial: 41. Best value: 0.722923:  60%|██████    | 60/100 [04:35<03:19,  5.00s/it]Best trial: 41. Best value: 0.722923:  61%|██████    | 61/100 [04:35<02:54,  4.48s/it]Best trial: 41. Best value: 0.722923:  61%|██████    | 61/100 [04:41<02:54,  4.48s/it]Best trial: 41. Best value: 0.722923:  62%|██████▏   | 62/100 [04:41<03:14,  5.12s/it]Best trial: 41. Best value: 0.722923:  62%|██████▏   | 62/100 [04:46<03:14,  5.12s/it]Best trial: 41. Best value: 0.722923:  63%|██████▎   | 63/100 [04:46<03:04,  4.98s/it]Best trial: 41. Best value: 0.722923:  63%|██████▎   | 63/100 [04:51<03:04,  4.98s/it]Best trial: 41. Best value: 0.722923:  64%|██████▍   | 64/100 [04:51<03:02,  5.08s/it]Best trial: 41. Best value: 0.722923:  64%|██████▍   | 64/100 [04:55<03:02,  5.08s/it]Best trial: 41. Best value: 0.722923:  65%|██████▌   | 65/100 [04:55<02:45,  4.73s/it]Best trial: 41. Best value: 0.722923:  65%|██████▌   | 65/100 [05:02<02:45,  4.73s/it]Best trial: 41. Best value: 0.722923:  66%|██████▌   | 66/100 [05:02<02:58,  5.24s/it]Best trial: 41. Best value: 0.722923:  66%|██████▌   | 66/100 [05:06<02:58,  5.24s/it]Best trial: 41. Best value: 0.722923:  67%|██████▋   | 67/100 [05:06<02:44,  5.00s/it]Best trial: 41. Best value: 0.722923:  67%|██████▋   | 67/100 [05:11<02:44,  5.00s/it]Best trial: 41. Best value: 0.722923:  68%|██████▊   | 68/100 [05:11<02:36,  4.89s/it]Best trial: 41. Best value: 0.722923:  68%|██████▊   | 68/100 [05:21<02:36,  4.89s/it]Best trial: 41. Best value: 0.722923:  69%|██████▉   | 69/100 [05:21<03:21,  6.48s/it]Best trial: 41. Best value: 0.722923:  69%|██████▉   | 69/100 [05:28<03:21,  6.48s/it]Best trial: 41. Best value: 0.722923:  70%|███████   | 70/100 [05:28<03:20,  6.68s/it]Best trial: 41. Best value: 0.722923:  70%|███████   | 70/100 [05:30<03:20,  6.68s/it]Best trial: 41. Best value: 0.722923:  71%|███████   | 71/100 [05:30<02:33,  5.28s/it]Best trial: 41. Best value: 0.722923:  71%|███████   | 71/100 [05:34<02:33,  5.28s/it]Best trial: 41. Best value: 0.722923:  72%|███████▏  | 72/100 [05:34<02:17,  4.90s/it]Best trial: 72. Best value: 0.724687:  72%|███████▏  | 72/100 [05:40<02:17,  4.90s/it]Best trial: 72. Best value: 0.724687:  73%|███████▎  | 73/100 [05:40<02:22,  5.29s/it]Best trial: 72. Best value: 0.724687:  73%|███████▎  | 73/100 [05:46<02:22,  5.29s/it]Best trial: 72. Best value: 0.724687:  74%|███████▍  | 74/100 [05:46<02:18,  5.32s/it]Best trial: 72. Best value: 0.724687:  74%|███████▍  | 74/100 [05:51<02:18,  5.32s/it]Best trial: 72. Best value: 0.724687:  75%|███████▌  | 75/100 [05:51<02:10,  5.23s/it]Best trial: 72. Best value: 0.724687:  75%|███████▌  | 75/100 [05:57<02:10,  5.23s/it]Best trial: 72. Best value: 0.724687:  76%|███████▌  | 76/100 [05:57<02:15,  5.66s/it]Best trial: 72. Best value: 0.724687:  76%|███████▌  | 76/100 [06:05<02:15,  5.66s/it]Best trial: 72. Best value: 0.724687:  77%|███████▋  | 77/100 [06:05<02:27,  6.39s/it]Best trial: 72. Best value: 0.724687:  77%|███████▋  | 77/100 [06:10<02:27,  6.39s/it]Best trial: 72. Best value: 0.724687:  78%|███████▊  | 78/100 [06:10<02:09,  5.90s/it]Best trial: 72. Best value: 0.724687:  78%|███████▊  | 78/100 [06:14<02:09,  5.90s/it]Best trial: 72. Best value: 0.724687:  79%|███████▉  | 79/100 [06:14<01:50,  5.25s/it]Best trial: 72. Best value: 0.724687:  79%|███████▉  | 79/100 [06:16<01:50,  5.25s/it]Best trial: 72. Best value: 0.724687:  80%|████████  | 80/100 [06:16<01:27,  4.39s/it]Best trial: 72. Best value: 0.724687:  80%|████████  | 80/100 [06:21<01:27,  4.39s/it]Best trial: 72. Best value: 0.724687:  81%|████████  | 81/100 [06:21<01:27,  4.60s/it]Best trial: 72. Best value: 0.724687:  81%|████████  | 81/100 [06:26<01:27,  4.60s/it]Best trial: 72. Best value: 0.724687:  82%|████████▏ | 82/100 [06:26<01:23,  4.63s/it]Best trial: 72. Best value: 0.724687:  82%|████████▏ | 82/100 [06:31<01:23,  4.63s/it]Best trial: 72. Best value: 0.724687:  83%|████████▎ | 83/100 [06:31<01:19,  4.68s/it]Best trial: 72. Best value: 0.724687:  83%|████████▎ | 83/100 [06:34<01:19,  4.68s/it]Best trial: 72. Best value: 0.724687:  84%|████████▍ | 84/100 [06:34<01:08,  4.29s/it]Best trial: 72. Best value: 0.724687:  84%|████████▍ | 84/100 [06:37<01:08,  4.29s/it]Best trial: 72. Best value: 0.724687:  85%|████████▌ | 85/100 [06:37<00:59,  3.96s/it]Best trial: 72. Best value: 0.724687:  85%|████████▌ | 85/100 [06:41<00:59,  3.96s/it]Best trial: 72. Best value: 0.724687:  86%|████████▌ | 86/100 [06:41<00:52,  3.76s/it]Best trial: 72. Best value: 0.724687:  86%|████████▌ | 86/100 [06:44<00:52,  3.76s/it]Best trial: 72. Best value: 0.724687:  87%|████████▋ | 87/100 [06:44<00:45,  3.53s/it]Best trial: 72. Best value: 0.724687:  87%|████████▋ | 87/100 [06:46<00:45,  3.53s/it]Best trial: 72. Best value: 0.724687:  88%|████████▊ | 88/100 [06:46<00:39,  3.28s/it]Best trial: 72. Best value: 0.724687:  88%|████████▊ | 88/100 [06:51<00:39,  3.28s/it]Best trial: 72. Best value: 0.724687:  89%|████████▉ | 89/100 [06:51<00:39,  3.57s/it]Best trial: 72. Best value: 0.724687:  89%|████████▉ | 89/100 [06:53<00:39,  3.57s/it]Best trial: 72. Best value: 0.724687:  90%|█████████ | 90/100 [06:53<00:32,  3.25s/it]Best trial: 72. Best value: 0.724687:  90%|█████████ | 90/100 [06:57<00:32,  3.25s/it]Best trial: 72. Best value: 0.724687:  91%|█████████ | 91/100 [06:57<00:30,  3.34s/it]Best trial: 72. Best value: 0.724687:  91%|█████████ | 91/100 [07:00<00:30,  3.34s/it]Best trial: 72. Best value: 0.724687:  92%|█████████▏| 92/100 [07:00<00:25,  3.22s/it]Best trial: 72. Best value: 0.724687:  92%|█████████▏| 92/100 [07:05<00:25,  3.22s/it]Best trial: 72. Best value: 0.724687:  93%|█████████▎| 93/100 [07:05<00:26,  3.73s/it]Best trial: 72. Best value: 0.724687:  93%|█████████▎| 93/100 [07:09<00:26,  3.73s/it]Best trial: 72. Best value: 0.724687:  94%|█████████▍| 94/100 [07:09<00:23,  3.84s/it]Best trial: 72. Best value: 0.724687:  94%|█████████▍| 94/100 [07:12<00:23,  3.84s/it]Best trial: 72. Best value: 0.724687:  95%|█████████▌| 95/100 [07:12<00:17,  3.59s/it]Best trial: 72. Best value: 0.724687:  95%|█████████▌| 95/100 [07:15<00:17,  3.59s/it]Best trial: 72. Best value: 0.724687:  96%|█████████▌| 96/100 [07:15<00:13,  3.41s/it]Best trial: 96. Best value: 0.72551:  96%|█████████▌| 96/100 [07:17<00:13,  3.41s/it] Best trial: 96. Best value: 0.72551:  97%|█████████▋| 97/100 [07:17<00:09,  3.22s/it]Best trial: 96. Best value: 0.72551:  97%|█████████▋| 97/100 [07:20<00:09,  3.22s/it]Best trial: 96. Best value: 0.72551:  98%|█████████▊| 98/100 [07:20<00:06,  3.11s/it]Best trial: 96. Best value: 0.72551:  98%|█████████▊| 98/100 [07:24<00:06,  3.11s/it]Best trial: 96. Best value: 0.72551:  99%|█████████▉| 99/100 [07:24<00:03,  3.26s/it]Best trial: 96. Best value: 0.72551:  99%|█████████▉| 99/100 [07:27<00:03,  3.26s/it]Best trial: 96. Best value: 0.72551: 100%|██████████| 100/100 [07:27<00:00,  3.12s/it]Best trial: 96. Best value: 0.72551: 100%|██████████| 100/100 [07:27<00:00,  4.47s/it]
2025-12-01 02:23:52,482 - INFO - HPO Complete. Best AUPRC: 0.7255
2025-12-01 02:23:52,482 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.07541095070539554, 'max_depth': 3, 'subsample': 0.8391717698066402, 'colsample_bytree': 0.6709363913364003, 'gamma': 2.507369930401669, 'reg_lambda': 0.6117575621278745, 'reg_alpha': 1.1320346657626363e-07}
2025-12-01 02:23:52,483 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/non_windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:23:54,375 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: non_windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 02:23:54,375 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2025-12-01 02:23:54,460 - INFO - Data loaded. Shape: (3453, 195)
2025-12-01 02:23:54,493 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:23:54,502 - INFO - Data prepared. Train shape: (2761, 164), Test shape: (692, 164)
2025-12-01 02:23:54,502 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:23:54,502 - INFO - Training model...
2025-12-01 02:23:55,640 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:24:01,270 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:24:01,270 - INFO - AUROC: 0.8796 (0.8516 - 0.9001)
2025-12-01 02:24:01,270 - INFO - AUPRC: 0.7315 (0.6798 - 0.7822)
2025-12-01 02:24:01,270 - INFO - Brier Score: 0.1059 (0.0948 - 0.1217)
2025-12-01 02:24:01,270 - INFO - Accuracy: 0.8671 (0.8483 - 0.8916)
2025-12-01 02:24:01,270 - INFO - Precision: 0.6689 (0.6258 - 0.7956)
2025-12-01 02:24:01,270 - INFO - Sensitivity (Recall): 0.7063 (0.5724 - 0.7362)
2025-12-01 02:24:01,270 - INFO - F1-Score: 0.6871 (0.6220 - 0.7374)
2025-12-01 02:24:01,270 - INFO - Best Threshold: 0.5100 (0.4760 - 0.6460)
2025-12-01 02:24:01,270 - INFO - Specificity: 0.9089 (0.8922 - 0.9546)
2025-12-01 02:24:01,282 - INFO - Calculating SHAP values...
2025-12-01 02:24:02,338 - INFO - SHAP plots saved.
2025-12-01 02:24:02,339 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/non_windowed/preop_and_all_minus_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:24:03,610 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_only
2025-12-01 02:24:03,610 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:24:03,847 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:24:03,867 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:24:03,873 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-12-01 02:24:03,873 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.671175:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.671175:   1%|          | 1/100 [00:01<02:42,  1.64s/it]Best trial: 1. Best value: 0.6733:   1%|          | 1/100 [00:04<02:42,  1.64s/it]  Best trial: 1. Best value: 0.6733:   2%|▏         | 2/100 [00:04<03:59,  2.45s/it]Best trial: 1. Best value: 0.6733:   2%|▏         | 2/100 [00:07<03:59,  2.45s/it]Best trial: 1. Best value: 0.6733:   3%|▎         | 3/100 [00:07<04:31,  2.80s/it]Best trial: 1. Best value: 0.6733:   3%|▎         | 3/100 [00:09<04:31,  2.80s/it]Best trial: 1. Best value: 0.6733:   4%|▍         | 4/100 [00:09<03:48,  2.38s/it]Best trial: 1. Best value: 0.6733:   4%|▍         | 4/100 [00:12<03:48,  2.38s/it]Best trial: 1. Best value: 0.6733:   5%|▌         | 5/100 [00:12<04:13,  2.66s/it]Best trial: 5. Best value: 0.689336:   5%|▌         | 5/100 [00:14<04:13,  2.66s/it]Best trial: 5. Best value: 0.689336:   6%|▌         | 6/100 [00:14<03:34,  2.28s/it]Best trial: 5. Best value: 0.689336:   6%|▌         | 6/100 [00:17<03:34,  2.28s/it]Best trial: 5. Best value: 0.689336:   7%|▋         | 7/100 [00:17<04:08,  2.68s/it]Best trial: 7. Best value: 0.692351:   7%|▋         | 7/100 [00:19<04:08,  2.68s/it]Best trial: 7. Best value: 0.692351:   8%|▊         | 8/100 [00:19<03:41,  2.41s/it]Best trial: 7. Best value: 0.692351:   8%|▊         | 8/100 [00:21<03:41,  2.41s/it]Best trial: 7. Best value: 0.692351:   9%|▉         | 9/100 [00:21<03:22,  2.23s/it]Best trial: 7. Best value: 0.692351:   9%|▉         | 9/100 [00:25<03:22,  2.23s/it]Best trial: 7. Best value: 0.692351:  10%|█         | 10/100 [00:25<04:12,  2.80s/it]Best trial: 7. Best value: 0.692351:  10%|█         | 10/100 [00:27<04:12,  2.80s/it]Best trial: 7. Best value: 0.692351:  11%|█         | 11/100 [00:27<03:41,  2.49s/it]Best trial: 7. Best value: 0.692351:  11%|█         | 11/100 [00:28<03:41,  2.49s/it]Best trial: 7. Best value: 0.692351:  12%|█▏        | 12/100 [00:28<03:06,  2.12s/it]Best trial: 7. Best value: 0.692351:  12%|█▏        | 12/100 [00:31<03:06,  2.12s/it]Best trial: 7. Best value: 0.692351:  13%|█▎        | 13/100 [00:31<03:11,  2.21s/it]Best trial: 7. Best value: 0.692351:  13%|█▎        | 13/100 [00:33<03:11,  2.21s/it]Best trial: 7. Best value: 0.692351:  14%|█▍        | 14/100 [00:33<03:05,  2.15s/it]Best trial: 7. Best value: 0.692351:  14%|█▍        | 14/100 [00:34<03:05,  2.15s/it]Best trial: 7. Best value: 0.692351:  15%|█▌        | 15/100 [00:34<02:57,  2.08s/it]Best trial: 7. Best value: 0.692351:  15%|█▌        | 15/100 [00:37<02:57,  2.08s/it]Best trial: 7. Best value: 0.692351:  16%|█▌        | 16/100 [00:37<03:03,  2.18s/it]Best trial: 7. Best value: 0.692351:  16%|█▌        | 16/100 [00:40<03:03,  2.18s/it]Best trial: 7. Best value: 0.692351:  17%|█▋        | 17/100 [00:40<03:21,  2.42s/it]Best trial: 7. Best value: 0.692351:  17%|█▋        | 17/100 [00:41<03:21,  2.42s/it]Best trial: 7. Best value: 0.692351:  18%|█▊        | 18/100 [00:41<02:48,  2.06s/it]Best trial: 7. Best value: 0.692351:  18%|█▊        | 18/100 [00:43<02:48,  2.06s/it]Best trial: 7. Best value: 0.692351:  19%|█▉        | 19/100 [00:43<02:46,  2.06s/it]Best trial: 7. Best value: 0.692351:  19%|█▉        | 19/100 [00:45<02:46,  2.06s/it]Best trial: 7. Best value: 0.692351:  20%|██        | 20/100 [00:45<02:50,  2.13s/it]Best trial: 20. Best value: 0.695439:  20%|██        | 20/100 [00:49<02:50,  2.13s/it]Best trial: 20. Best value: 0.695439:  21%|██        | 21/100 [00:49<03:20,  2.54s/it]Best trial: 20. Best value: 0.695439:  21%|██        | 21/100 [00:51<03:20,  2.54s/it]Best trial: 20. Best value: 0.695439:  22%|██▏       | 22/100 [00:51<03:02,  2.34s/it]Best trial: 20. Best value: 0.695439:  22%|██▏       | 22/100 [00:53<03:02,  2.34s/it]Best trial: 20. Best value: 0.695439:  23%|██▎       | 23/100 [00:53<02:57,  2.30s/it]Best trial: 20. Best value: 0.695439:  23%|██▎       | 23/100 [00:55<02:57,  2.30s/it]Best trial: 20. Best value: 0.695439:  24%|██▍       | 24/100 [00:55<02:47,  2.20s/it]Best trial: 24. Best value: 0.697234:  24%|██▍       | 24/100 [00:58<02:47,  2.20s/it]Best trial: 24. Best value: 0.697234:  25%|██▌       | 25/100 [00:58<03:14,  2.59s/it]Best trial: 24. Best value: 0.697234:  25%|██▌       | 25/100 [01:01<03:14,  2.59s/it]Best trial: 24. Best value: 0.697234:  26%|██▌       | 26/100 [01:01<03:15,  2.64s/it]Best trial: 24. Best value: 0.697234:  26%|██▌       | 26/100 [01:04<03:15,  2.64s/it]Best trial: 24. Best value: 0.697234:  27%|██▋       | 27/100 [01:04<03:14,  2.66s/it]Best trial: 24. Best value: 0.697234:  27%|██▋       | 27/100 [01:07<03:14,  2.66s/it]Best trial: 24. Best value: 0.697234:  28%|██▊       | 28/100 [01:07<03:18,  2.76s/it]Best trial: 24. Best value: 0.697234:  28%|██▊       | 28/100 [01:08<03:18,  2.76s/it]Best trial: 24. Best value: 0.697234:  29%|██▉       | 29/100 [01:08<02:47,  2.36s/it]Best trial: 24. Best value: 0.697234:  29%|██▉       | 29/100 [01:10<02:47,  2.36s/it]Best trial: 24. Best value: 0.697234:  30%|███       | 30/100 [01:10<02:27,  2.11s/it]Best trial: 24. Best value: 0.697234:  30%|███       | 30/100 [01:11<02:27,  2.11s/it]Best trial: 24. Best value: 0.697234:  31%|███       | 31/100 [01:11<02:14,  1.95s/it]Best trial: 24. Best value: 0.697234:  31%|███       | 31/100 [01:13<02:14,  1.95s/it]Best trial: 24. Best value: 0.697234:  32%|███▏      | 32/100 [01:13<02:09,  1.91s/it]Best trial: 24. Best value: 0.697234:  32%|███▏      | 32/100 [01:15<02:09,  1.91s/it]Best trial: 24. Best value: 0.697234:  33%|███▎      | 33/100 [01:15<01:56,  1.74s/it]Best trial: 24. Best value: 0.697234:  33%|███▎      | 33/100 [01:18<01:56,  1.74s/it]Best trial: 24. Best value: 0.697234:  34%|███▍      | 34/100 [01:18<02:19,  2.11s/it]Best trial: 24. Best value: 0.697234:  34%|███▍      | 34/100 [01:20<02:19,  2.11s/it]Best trial: 24. Best value: 0.697234:  35%|███▌      | 35/100 [01:20<02:24,  2.23s/it]Best trial: 24. Best value: 0.697234:  35%|███▌      | 35/100 [01:22<02:24,  2.23s/it]Best trial: 24. Best value: 0.697234:  36%|███▌      | 36/100 [01:22<02:08,  2.01s/it]Best trial: 24. Best value: 0.697234:  36%|███▌      | 36/100 [01:24<02:08,  2.01s/it]Best trial: 24. Best value: 0.697234:  37%|███▋      | 37/100 [01:24<02:19,  2.21s/it]Best trial: 24. Best value: 0.697234:  37%|███▋      | 37/100 [01:26<02:19,  2.21s/it]Best trial: 24. Best value: 0.697234:  38%|███▊      | 38/100 [01:26<02:14,  2.18s/it]Best trial: 24. Best value: 0.697234:  38%|███▊      | 38/100 [01:28<02:14,  2.18s/it]Best trial: 24. Best value: 0.697234:  39%|███▉      | 39/100 [01:28<02:02,  2.01s/it]Best trial: 24. Best value: 0.697234:  39%|███▉      | 39/100 [01:30<02:02,  2.01s/it]Best trial: 24. Best value: 0.697234:  40%|████      | 40/100 [01:30<01:55,  1.92s/it]Best trial: 40. Best value: 0.698329:  40%|████      | 40/100 [01:31<01:55,  1.92s/it]Best trial: 40. Best value: 0.698329:  41%|████      | 41/100 [01:31<01:44,  1.77s/it]Best trial: 40. Best value: 0.698329:  41%|████      | 41/100 [01:33<01:44,  1.77s/it]Best trial: 40. Best value: 0.698329:  42%|████▏     | 42/100 [01:33<01:43,  1.78s/it]Best trial: 40. Best value: 0.698329:  42%|████▏     | 42/100 [01:35<01:43,  1.78s/it]Best trial: 40. Best value: 0.698329:  43%|████▎     | 43/100 [01:35<01:39,  1.75s/it]Best trial: 40. Best value: 0.698329:  43%|████▎     | 43/100 [01:36<01:39,  1.75s/it]Best trial: 40. Best value: 0.698329:  44%|████▍     | 44/100 [01:36<01:37,  1.75s/it]Best trial: 40. Best value: 0.698329:  44%|████▍     | 44/100 [01:38<01:37,  1.75s/it]Best trial: 40. Best value: 0.698329:  45%|████▌     | 45/100 [01:38<01:35,  1.74s/it]Best trial: 40. Best value: 0.698329:  45%|████▌     | 45/100 [01:40<01:35,  1.74s/it]Best trial: 40. Best value: 0.698329:  46%|████▌     | 46/100 [01:40<01:30,  1.67s/it]Best trial: 40. Best value: 0.698329:  46%|████▌     | 46/100 [01:41<01:30,  1.67s/it]Best trial: 40. Best value: 0.698329:  47%|████▋     | 47/100 [01:41<01:23,  1.58s/it]Best trial: 40. Best value: 0.698329:  47%|████▋     | 47/100 [01:43<01:23,  1.58s/it]Best trial: 40. Best value: 0.698329:  48%|████▊     | 48/100 [01:43<01:22,  1.58s/it]Best trial: 40. Best value: 0.698329:  48%|████▊     | 48/100 [01:44<01:22,  1.58s/it]Best trial: 40. Best value: 0.698329:  49%|████▉     | 49/100 [01:44<01:23,  1.64s/it]Best trial: 40. Best value: 0.698329:  49%|████▉     | 49/100 [01:47<01:23,  1.64s/it]Best trial: 40. Best value: 0.698329:  50%|█████     | 50/100 [01:47<01:38,  1.98s/it]Best trial: 40. Best value: 0.698329:  50%|█████     | 50/100 [01:49<01:38,  1.98s/it]Best trial: 40. Best value: 0.698329:  51%|█████     | 51/100 [01:49<01:41,  2.07s/it]Best trial: 51. Best value: 0.698491:  51%|█████     | 51/100 [01:51<01:41,  2.07s/it]Best trial: 51. Best value: 0.698491:  52%|█████▏    | 52/100 [01:51<01:33,  1.95s/it]Best trial: 51. Best value: 0.698491:  52%|█████▏    | 52/100 [01:52<01:33,  1.95s/it]Best trial: 51. Best value: 0.698491:  53%|█████▎    | 53/100 [01:52<01:24,  1.80s/it]Best trial: 51. Best value: 0.698491:  53%|█████▎    | 53/100 [01:54<01:24,  1.80s/it]Best trial: 51. Best value: 0.698491:  54%|█████▍    | 54/100 [01:54<01:24,  1.83s/it]Best trial: 54. Best value: 0.700171:  54%|█████▍    | 54/100 [01:57<01:24,  1.83s/it]Best trial: 54. Best value: 0.700171:  55%|█████▌    | 55/100 [01:57<01:27,  1.95s/it]Best trial: 54. Best value: 0.700171:  55%|█████▌    | 55/100 [01:59<01:27,  1.95s/it]Best trial: 54. Best value: 0.700171:  56%|█████▌    | 56/100 [01:59<01:33,  2.14s/it]Best trial: 56. Best value: 0.700259:  56%|█████▌    | 56/100 [02:01<01:33,  2.14s/it]Best trial: 56. Best value: 0.700259:  57%|█████▋    | 57/100 [02:01<01:30,  2.11s/it]Best trial: 56. Best value: 0.700259:  57%|█████▋    | 57/100 [02:03<01:30,  2.11s/it]Best trial: 56. Best value: 0.700259:  58%|█████▊    | 58/100 [02:03<01:30,  2.15s/it]Best trial: 56. Best value: 0.700259:  58%|█████▊    | 58/100 [02:06<01:30,  2.15s/it]Best trial: 56. Best value: 0.700259:  59%|█████▉    | 59/100 [02:06<01:29,  2.18s/it]Best trial: 56. Best value: 0.700259:  59%|█████▉    | 59/100 [02:08<01:29,  2.18s/it]Best trial: 56. Best value: 0.700259:  60%|██████    | 60/100 [02:08<01:27,  2.19s/it]Best trial: 56. Best value: 0.700259:  60%|██████    | 60/100 [02:10<01:27,  2.19s/it]Best trial: 56. Best value: 0.700259:  61%|██████    | 61/100 [02:10<01:29,  2.30s/it]Best trial: 56. Best value: 0.700259:  61%|██████    | 61/100 [02:12<01:29,  2.30s/it]Best trial: 56. Best value: 0.700259:  62%|██████▏   | 62/100 [02:12<01:22,  2.16s/it]Best trial: 56. Best value: 0.700259:  62%|██████▏   | 62/100 [02:15<01:22,  2.16s/it]Best trial: 56. Best value: 0.700259:  63%|██████▎   | 63/100 [02:15<01:23,  2.26s/it]Best trial: 56. Best value: 0.700259:  63%|██████▎   | 63/100 [02:17<01:23,  2.26s/it]Best trial: 56. Best value: 0.700259:  64%|██████▍   | 64/100 [02:17<01:18,  2.17s/it]Best trial: 56. Best value: 0.700259:  64%|██████▍   | 64/100 [02:18<01:18,  2.17s/it]Best trial: 56. Best value: 0.700259:  65%|██████▌   | 65/100 [02:18<01:10,  2.00s/it]Best trial: 56. Best value: 0.700259:  65%|██████▌   | 65/100 [02:21<01:10,  2.00s/it]Best trial: 56. Best value: 0.700259:  66%|██████▌   | 66/100 [02:21<01:10,  2.06s/it]Best trial: 56. Best value: 0.700259:  66%|██████▌   | 66/100 [02:22<01:10,  2.06s/it]Best trial: 56. Best value: 0.700259:  67%|██████▋   | 67/100 [02:22<01:03,  1.94s/it]Best trial: 56. Best value: 0.700259:  67%|██████▋   | 67/100 [02:24<01:03,  1.94s/it]Best trial: 56. Best value: 0.700259:  68%|██████▊   | 68/100 [02:24<01:03,  1.98s/it]Best trial: 56. Best value: 0.700259:  68%|██████▊   | 68/100 [02:26<01:03,  1.98s/it]Best trial: 56. Best value: 0.700259:  69%|██████▉   | 69/100 [02:26<00:57,  1.85s/it]Best trial: 56. Best value: 0.700259:  69%|██████▉   | 69/100 [02:27<00:57,  1.85s/it]Best trial: 56. Best value: 0.700259:  70%|███████   | 70/100 [02:27<00:53,  1.77s/it]Best trial: 56. Best value: 0.700259:  70%|███████   | 70/100 [02:29<00:53,  1.77s/it]Best trial: 56. Best value: 0.700259:  71%|███████   | 71/100 [02:29<00:52,  1.80s/it]Best trial: 71. Best value: 0.704157:  71%|███████   | 71/100 [02:31<00:52,  1.80s/it]Best trial: 71. Best value: 0.704157:  72%|███████▏  | 72/100 [02:31<00:50,  1.79s/it]Best trial: 71. Best value: 0.704157:  72%|███████▏  | 72/100 [02:33<00:50,  1.79s/it]Best trial: 71. Best value: 0.704157:  73%|███████▎  | 73/100 [02:33<00:51,  1.92s/it]Best trial: 71. Best value: 0.704157:  73%|███████▎  | 73/100 [02:35<00:51,  1.92s/it]Best trial: 71. Best value: 0.704157:  74%|███████▍  | 74/100 [02:35<00:49,  1.89s/it]Best trial: 71. Best value: 0.704157:  74%|███████▍  | 74/100 [02:37<00:49,  1.89s/it]Best trial: 71. Best value: 0.704157:  75%|███████▌  | 75/100 [02:37<00:47,  1.90s/it]Best trial: 71. Best value: 0.704157:  75%|███████▌  | 75/100 [02:39<00:47,  1.90s/it]Best trial: 71. Best value: 0.704157:  76%|███████▌  | 76/100 [02:39<00:48,  2.03s/it]Best trial: 71. Best value: 0.704157:  76%|███████▌  | 76/100 [02:42<00:48,  2.03s/it]Best trial: 71. Best value: 0.704157:  77%|███████▋  | 77/100 [02:42<00:51,  2.25s/it]Best trial: 71. Best value: 0.704157:  77%|███████▋  | 77/100 [02:45<00:51,  2.25s/it]Best trial: 71. Best value: 0.704157:  78%|███████▊  | 78/100 [02:45<00:56,  2.56s/it]Best trial: 71. Best value: 0.704157:  78%|███████▊  | 78/100 [02:47<00:56,  2.56s/it]Best trial: 71. Best value: 0.704157:  79%|███████▉  | 79/100 [02:47<00:45,  2.16s/it]Best trial: 71. Best value: 0.704157:  79%|███████▉  | 79/100 [02:49<00:45,  2.16s/it]Best trial: 71. Best value: 0.704157:  80%|████████  | 80/100 [02:49<00:44,  2.25s/it]Best trial: 71. Best value: 0.704157:  80%|████████  | 80/100 [02:51<00:44,  2.25s/it]Best trial: 71. Best value: 0.704157:  81%|████████  | 81/100 [02:51<00:42,  2.26s/it]Best trial: 71. Best value: 0.704157:  81%|████████  | 81/100 [02:53<00:42,  2.26s/it]Best trial: 71. Best value: 0.704157:  82%|████████▏ | 82/100 [02:53<00:36,  2.04s/it]Best trial: 71. Best value: 0.704157:  82%|████████▏ | 82/100 [02:55<00:36,  2.04s/it]Best trial: 71. Best value: 0.704157:  83%|████████▎ | 83/100 [02:55<00:33,  1.98s/it]Best trial: 71. Best value: 0.704157:  83%|████████▎ | 83/100 [02:56<00:33,  1.98s/it]Best trial: 71. Best value: 0.704157:  84%|████████▍ | 84/100 [02:56<00:29,  1.87s/it]Best trial: 71. Best value: 0.704157:  84%|████████▍ | 84/100 [02:58<00:29,  1.87s/it]Best trial: 71. Best value: 0.704157:  85%|████████▌ | 85/100 [02:58<00:27,  1.82s/it]Best trial: 71. Best value: 0.704157:  85%|████████▌ | 85/100 [02:59<00:27,  1.82s/it]Best trial: 71. Best value: 0.704157:  86%|████████▌ | 86/100 [02:59<00:23,  1.64s/it]Best trial: 71. Best value: 0.704157:  86%|████████▌ | 86/100 [03:01<00:23,  1.64s/it]Best trial: 71. Best value: 0.704157:  87%|████████▋ | 87/100 [03:01<00:20,  1.54s/it]Best trial: 71. Best value: 0.704157:  87%|████████▋ | 87/100 [03:03<00:20,  1.54s/it]Best trial: 71. Best value: 0.704157:  88%|████████▊ | 88/100 [03:03<00:22,  1.85s/it]Best trial: 71. Best value: 0.704157:  88%|████████▊ | 88/100 [03:05<00:22,  1.85s/it]Best trial: 71. Best value: 0.704157:  89%|████████▉ | 89/100 [03:05<00:20,  1.82s/it]Best trial: 71. Best value: 0.704157:  89%|████████▉ | 89/100 [03:06<00:20,  1.82s/it]Best trial: 71. Best value: 0.704157:  90%|█████████ | 90/100 [03:06<00:16,  1.61s/it]Best trial: 71. Best value: 0.704157:  90%|█████████ | 90/100 [03:09<00:16,  1.61s/it]Best trial: 71. Best value: 0.704157:  91%|█████████ | 91/100 [03:09<00:17,  1.91s/it]Best trial: 71. Best value: 0.704157:  91%|█████████ | 91/100 [03:10<00:17,  1.91s/it]Best trial: 71. Best value: 0.704157:  92%|█████████▏| 92/100 [03:10<00:14,  1.77s/it]Best trial: 71. Best value: 0.704157:  92%|█████████▏| 92/100 [03:11<00:14,  1.77s/it]Best trial: 71. Best value: 0.704157:  93%|█████████▎| 93/100 [03:11<00:11,  1.64s/it]Best trial: 71. Best value: 0.704157:  93%|█████████▎| 93/100 [03:13<00:11,  1.64s/it]Best trial: 71. Best value: 0.704157:  94%|█████████▍| 94/100 [03:13<00:10,  1.68s/it]Best trial: 71. Best value: 0.704157:  94%|█████████▍| 94/100 [03:16<00:10,  1.68s/it]Best trial: 71. Best value: 0.704157:  95%|█████████▌| 95/100 [03:16<00:09,  1.90s/it]Best trial: 71. Best value: 0.704157:  95%|█████████▌| 95/100 [03:17<00:09,  1.90s/it]Best trial: 71. Best value: 0.704157:  96%|█████████▌| 96/100 [03:17<00:07,  1.76s/it]Best trial: 71. Best value: 0.704157:  96%|█████████▌| 96/100 [03:19<00:07,  1.76s/it]Best trial: 71. Best value: 0.704157:  97%|█████████▋| 97/100 [03:19<00:05,  1.76s/it]Best trial: 71. Best value: 0.704157:  97%|█████████▋| 97/100 [03:21<00:05,  1.76s/it]Best trial: 71. Best value: 0.704157:  98%|█████████▊| 98/100 [03:21<00:03,  1.95s/it]Best trial: 71. Best value: 0.704157:  98%|█████████▊| 98/100 [03:23<00:03,  1.95s/it]Best trial: 71. Best value: 0.704157:  99%|█████████▉| 99/100 [03:23<00:01,  1.88s/it]Best trial: 71. Best value: 0.704157:  99%|█████████▉| 99/100 [03:25<00:01,  1.88s/it]Best trial: 71. Best value: 0.704157: 100%|██████████| 100/100 [03:25<00:00,  1.84s/it]Best trial: 71. Best value: 0.704157: 100%|██████████| 100/100 [03:25<00:00,  2.05s/it]
2025-12-01 02:27:29,056 - INFO - HPO Complete. Best AUPRC: 0.7042
2025-12-01 02:27:29,056 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.05350249253310134, 'max_depth': 3, 'subsample': 0.9076706218297846, 'colsample_bytree': 0.7349914414157125, 'gamma': 1.2983250211403219, 'reg_lambda': 1.6747137833319204e-08, 'reg_alpha': 0.23459942996607525}
2025-12-01 02:27:29,057 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:27:30,874 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_only
2025-12-01 02:27:30,874 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:27:31,064 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:27:31,082 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:27:31,087 - INFO - Data prepared. Train shape: (2761, 92), Test shape: (692, 92)
2025-12-01 02:27:31,087 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:27:31,087 - INFO - Training model...
2025-12-01 02:27:31,803 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:27:36,925 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:27:36,925 - INFO - AUROC: 0.8739 (0.8474 - 0.8919)
2025-12-01 02:27:36,925 - INFO - AUPRC: 0.6930 (0.6408 - 0.7576)
2025-12-01 02:27:36,925 - INFO - Brier Score: 0.1189 (0.1065 - 0.1322)
2025-12-01 02:27:36,926 - INFO - Accuracy: 0.8526 (0.7818 - 0.8754)
2025-12-01 02:27:36,926 - INFO - Precision: 0.6614 (0.5040 - 0.7738)
2025-12-01 02:27:36,926 - INFO - Sensitivity (Recall): 0.5874 (0.5344 - 0.8152)
2025-12-01 02:27:36,926 - INFO - F1-Score: 0.6222 (0.5947 - 0.6742)
2025-12-01 02:27:36,926 - INFO - Best Threshold: 0.6100 (0.3440 - 0.6620)
2025-12-01 02:27:36,926 - INFO - Specificity: 0.9217 (0.7735 - 0.9496)
2025-12-01 02:27:36,938 - INFO - Calculating SHAP values...
2025-12-01 02:27:37,901 - INFO - SHAP plots saved.
2025-12-01 02:27:37,902 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:27:39,175 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: pleth_only
2025-12-01 02:27:39,175 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:27:39,398 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:27:39,419 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:27:39,425 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:27:39,425 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.391023:   0%|          | 0/100 [00:02<?, ?it/s]Best trial: 0. Best value: 0.391023:   1%|          | 1/100 [00:02<04:13,  2.56s/it]Best trial: 1. Best value: 0.423876:   1%|          | 1/100 [00:18<04:13,  2.56s/it]Best trial: 1. Best value: 0.423876:   2%|▏         | 2/100 [00:18<17:29, 10.71s/it]Best trial: 1. Best value: 0.423876:   2%|▏         | 2/100 [00:28<17:29, 10.71s/it]Best trial: 1. Best value: 0.423876:   3%|▎         | 3/100 [00:28<16:18, 10.08s/it]Best trial: 1. Best value: 0.423876:   3%|▎         | 3/100 [00:30<16:18, 10.08s/it]Best trial: 1. Best value: 0.423876:   4%|▍         | 4/100 [00:30<11:22,  7.11s/it]Best trial: 1. Best value: 0.423876:   4%|▍         | 4/100 [00:40<11:22,  7.11s/it]Best trial: 1. Best value: 0.423876:   5%|▌         | 5/100 [00:40<12:46,  8.07s/it]Best trial: 1. Best value: 0.423876:   5%|▌         | 5/100 [00:45<12:46,  8.07s/it]Best trial: 1. Best value: 0.423876:   6%|▌         | 6/100 [00:45<10:56,  6.99s/it]Best trial: 1. Best value: 0.423876:   6%|▌         | 6/100 [00:50<10:56,  6.99s/it]Best trial: 1. Best value: 0.423876:   7%|▋         | 7/100 [00:50<09:52,  6.37s/it]Best trial: 7. Best value: 0.435999:   7%|▋         | 7/100 [00:55<09:52,  6.37s/it]Best trial: 7. Best value: 0.435999:   8%|▊         | 8/100 [00:55<08:53,  5.80s/it]Best trial: 7. Best value: 0.435999:   8%|▊         | 8/100 [01:07<08:53,  5.80s/it]Best trial: 7. Best value: 0.435999:   9%|▉         | 9/100 [01:07<11:50,  7.80s/it]Best trial: 7. Best value: 0.435999:   9%|▉         | 9/100 [01:19<11:50,  7.80s/it]Best trial: 7. Best value: 0.435999:  10%|█         | 10/100 [01:19<13:46,  9.18s/it]Best trial: 7. Best value: 0.435999:  10%|█         | 10/100 [01:21<13:46,  9.18s/it]Best trial: 7. Best value: 0.435999:  11%|█         | 11/100 [01:21<10:28,  7.06s/it]Best trial: 7. Best value: 0.435999:  11%|█         | 11/100 [01:28<10:28,  7.06s/it]Best trial: 7. Best value: 0.435999:  12%|█▏        | 12/100 [01:28<10:18,  7.02s/it]Best trial: 7. Best value: 0.435999:  12%|█▏        | 12/100 [01:33<10:18,  7.02s/it]Best trial: 7. Best value: 0.435999:  13%|█▎        | 13/100 [01:33<08:55,  6.15s/it]Best trial: 7. Best value: 0.435999:  13%|█▎        | 13/100 [01:35<08:55,  6.15s/it]Best trial: 7. Best value: 0.435999:  14%|█▍        | 14/100 [01:35<07:20,  5.12s/it]Best trial: 7. Best value: 0.435999:  14%|█▍        | 14/100 [01:38<07:20,  5.12s/it]Best trial: 7. Best value: 0.435999:  15%|█▌        | 15/100 [01:38<06:24,  4.52s/it]Best trial: 7. Best value: 0.435999:  15%|█▌        | 15/100 [01:40<06:24,  4.52s/it]Best trial: 7. Best value: 0.435999:  16%|█▌        | 16/100 [01:40<05:07,  3.66s/it]Best trial: 7. Best value: 0.435999:  16%|█▌        | 16/100 [01:46<05:07,  3.66s/it]Best trial: 7. Best value: 0.435999:  17%|█▋        | 17/100 [01:46<06:08,  4.44s/it]Best trial: 7. Best value: 0.435999:  17%|█▋        | 17/100 [01:48<06:08,  4.44s/it]Best trial: 7. Best value: 0.435999:  18%|█▊        | 18/100 [01:48<05:02,  3.69s/it]Best trial: 7. Best value: 0.435999:  18%|█▊        | 18/100 [01:53<05:02,  3.69s/it]Best trial: 7. Best value: 0.435999:  19%|█▉        | 19/100 [01:53<05:12,  3.86s/it]Best trial: 7. Best value: 0.435999:  19%|█▉        | 19/100 [01:58<05:12,  3.86s/it]Best trial: 7. Best value: 0.435999:  20%|██        | 20/100 [01:58<05:46,  4.33s/it]Best trial: 7. Best value: 0.435999:  20%|██        | 20/100 [02:01<05:46,  4.33s/it]Best trial: 7. Best value: 0.435999:  21%|██        | 21/100 [02:01<05:08,  3.91s/it]Best trial: 7. Best value: 0.435999:  21%|██        | 21/100 [02:05<05:08,  3.91s/it]Best trial: 7. Best value: 0.435999:  22%|██▏       | 22/100 [02:05<05:01,  3.86s/it]Best trial: 7. Best value: 0.435999:  22%|██▏       | 22/100 [02:11<05:01,  3.86s/it]Best trial: 7. Best value: 0.435999:  23%|██▎       | 23/100 [02:11<05:56,  4.62s/it]Best trial: 7. Best value: 0.435999:  23%|██▎       | 23/100 [02:18<05:56,  4.62s/it]Best trial: 7. Best value: 0.435999:  24%|██▍       | 24/100 [02:18<06:48,  5.37s/it]Best trial: 7. Best value: 0.435999:  24%|██▍       | 24/100 [02:22<06:48,  5.37s/it]Best trial: 7. Best value: 0.435999:  25%|██▌       | 25/100 [02:22<05:57,  4.77s/it]Best trial: 7. Best value: 0.435999:  25%|██▌       | 25/100 [02:30<05:57,  4.77s/it]Best trial: 7. Best value: 0.435999:  26%|██▌       | 26/100 [02:30<07:05,  5.75s/it]Best trial: 7. Best value: 0.435999:  26%|██▌       | 26/100 [02:37<07:05,  5.75s/it]Best trial: 7. Best value: 0.435999:  27%|██▋       | 27/100 [02:37<07:34,  6.23s/it]Best trial: 7. Best value: 0.435999:  27%|██▋       | 27/100 [02:45<07:34,  6.23s/it]Best trial: 7. Best value: 0.435999:  28%|██▊       | 28/100 [02:45<08:14,  6.87s/it]Best trial: 7. Best value: 0.435999:  28%|██▊       | 28/100 [02:48<08:14,  6.87s/it]Best trial: 7. Best value: 0.435999:  29%|██▉       | 29/100 [02:48<06:46,  5.72s/it]Best trial: 7. Best value: 0.435999:  29%|██▉       | 29/100 [02:52<06:46,  5.72s/it]Best trial: 7. Best value: 0.435999:  30%|███       | 30/100 [02:52<05:57,  5.11s/it]Best trial: 7. Best value: 0.435999:  30%|███       | 30/100 [03:02<05:57,  5.11s/it]Best trial: 7. Best value: 0.435999:  31%|███       | 31/100 [03:02<07:36,  6.62s/it]Best trial: 7. Best value: 0.435999:  31%|███       | 31/100 [03:10<07:36,  6.62s/it]Best trial: 7. Best value: 0.435999:  32%|███▏      | 32/100 [03:10<08:04,  7.13s/it]Best trial: 7. Best value: 0.435999:  32%|███▏      | 32/100 [03:16<08:04,  7.13s/it]Best trial: 7. Best value: 0.435999:  33%|███▎      | 33/100 [03:16<07:32,  6.76s/it]Best trial: 7. Best value: 0.435999:  33%|███▎      | 33/100 [03:26<07:32,  6.76s/it]Best trial: 7. Best value: 0.435999:  34%|███▍      | 34/100 [03:26<08:20,  7.58s/it]Best trial: 7. Best value: 0.435999:  34%|███▍      | 34/100 [03:34<08:20,  7.58s/it]Best trial: 7. Best value: 0.435999:  35%|███▌      | 35/100 [03:34<08:19,  7.68s/it]Best trial: 7. Best value: 0.435999:  35%|███▌      | 35/100 [03:40<08:19,  7.68s/it]Best trial: 7. Best value: 0.435999:  36%|███▌      | 36/100 [03:40<07:39,  7.18s/it]Best trial: 7. Best value: 0.435999:  36%|███▌      | 36/100 [03:46<07:39,  7.18s/it]Best trial: 7. Best value: 0.435999:  37%|███▋      | 37/100 [03:46<07:22,  7.03s/it]Best trial: 7. Best value: 0.435999:  37%|███▋      | 37/100 [03:50<07:22,  7.03s/it]Best trial: 7. Best value: 0.435999:  38%|███▊      | 38/100 [03:50<06:16,  6.08s/it]Best trial: 7. Best value: 0.435999:  38%|███▊      | 38/100 [03:59<06:16,  6.08s/it]Best trial: 7. Best value: 0.435999:  39%|███▉      | 39/100 [04:00<07:08,  7.02s/it]Best trial: 7. Best value: 0.435999:  39%|███▉      | 39/100 [04:13<07:08,  7.02s/it]Best trial: 7. Best value: 0.435999:  40%|████      | 40/100 [04:13<09:03,  9.05s/it]Best trial: 7. Best value: 0.435999:  40%|████      | 40/100 [04:17<09:03,  9.05s/it]Best trial: 7. Best value: 0.435999:  41%|████      | 41/100 [04:17<07:14,  7.36s/it]Best trial: 7. Best value: 0.435999:  41%|████      | 41/100 [04:19<07:14,  7.36s/it]Best trial: 7. Best value: 0.435999:  42%|████▏     | 42/100 [04:19<05:47,  5.99s/it]Best trial: 7. Best value: 0.435999:  42%|████▏     | 42/100 [04:22<05:47,  5.99s/it]Best trial: 7. Best value: 0.435999:  43%|████▎     | 43/100 [04:22<04:48,  5.05s/it]Best trial: 43. Best value: 0.440113:  43%|████▎     | 43/100 [04:25<04:48,  5.05s/it]Best trial: 43. Best value: 0.440113:  44%|████▍     | 44/100 [04:25<04:03,  4.34s/it]Best trial: 43. Best value: 0.440113:  44%|████▍     | 44/100 [04:27<04:03,  4.34s/it]Best trial: 43. Best value: 0.440113:  45%|████▌     | 45/100 [04:27<03:19,  3.63s/it]Best trial: 43. Best value: 0.440113:  45%|████▌     | 45/100 [04:28<03:19,  3.63s/it]Best trial: 43. Best value: 0.440113:  46%|████▌     | 46/100 [04:28<02:41,  2.99s/it]Best trial: 43. Best value: 0.440113:  46%|████▌     | 46/100 [04:31<02:41,  2.99s/it]Best trial: 43. Best value: 0.440113:  47%|████▋     | 47/100 [04:31<02:27,  2.78s/it]Best trial: 43. Best value: 0.440113:  47%|████▋     | 47/100 [04:33<02:27,  2.78s/it]Best trial: 43. Best value: 0.440113:  48%|████▊     | 48/100 [04:33<02:21,  2.71s/it]Best trial: 43. Best value: 0.440113:  48%|████▊     | 48/100 [04:36<02:21,  2.71s/it]Best trial: 43. Best value: 0.440113:  49%|████▉     | 49/100 [04:36<02:16,  2.68s/it]Best trial: 43. Best value: 0.440113:  49%|████▉     | 49/100 [04:38<02:16,  2.68s/it]Best trial: 43. Best value: 0.440113:  50%|█████     | 50/100 [04:38<02:05,  2.51s/it]Best trial: 43. Best value: 0.440113:  50%|█████     | 50/100 [04:40<02:05,  2.51s/it]Best trial: 43. Best value: 0.440113:  51%|█████     | 51/100 [04:40<01:55,  2.36s/it]Best trial: 43. Best value: 0.440113:  51%|█████     | 51/100 [04:43<01:55,  2.36s/it]Best trial: 43. Best value: 0.440113:  52%|█████▏    | 52/100 [04:43<01:57,  2.45s/it]Best trial: 43. Best value: 0.440113:  52%|█████▏    | 52/100 [04:45<01:57,  2.45s/it]Best trial: 43. Best value: 0.440113:  53%|█████▎    | 53/100 [04:45<01:57,  2.51s/it]Best trial: 43. Best value: 0.440113:  53%|█████▎    | 53/100 [04:47<01:57,  2.51s/it]Best trial: 43. Best value: 0.440113:  54%|█████▍    | 54/100 [04:47<01:48,  2.36s/it]Best trial: 43. Best value: 0.440113:  54%|█████▍    | 54/100 [04:50<01:48,  2.36s/it]Best trial: 43. Best value: 0.440113:  55%|█████▌    | 55/100 [04:50<01:55,  2.56s/it]Best trial: 43. Best value: 0.440113:  55%|█████▌    | 55/100 [04:53<01:55,  2.56s/it]Best trial: 43. Best value: 0.440113:  56%|█████▌    | 56/100 [04:53<01:56,  2.64s/it]Best trial: 43. Best value: 0.440113:  56%|█████▌    | 56/100 [04:56<01:56,  2.64s/it]Best trial: 43. Best value: 0.440113:  57%|█████▋    | 57/100 [04:56<01:56,  2.71s/it]Best trial: 43. Best value: 0.440113:  57%|█████▋    | 57/100 [04:58<01:56,  2.71s/it]Best trial: 43. Best value: 0.440113:  58%|█████▊    | 58/100 [04:58<01:47,  2.55s/it]Best trial: 43. Best value: 0.440113:  58%|█████▊    | 58/100 [05:01<01:47,  2.55s/it]Best trial: 43. Best value: 0.440113:  59%|█████▉    | 59/100 [05:01<01:47,  2.63s/it]Best trial: 43. Best value: 0.440113:  59%|█████▉    | 59/100 [05:04<01:47,  2.63s/it]Best trial: 43. Best value: 0.440113:  60%|██████    | 60/100 [05:04<01:47,  2.69s/it]Best trial: 43. Best value: 0.440113:  60%|██████    | 60/100 [05:07<01:47,  2.69s/it]Best trial: 43. Best value: 0.440113:  61%|██████    | 61/100 [05:07<01:47,  2.76s/it]Best trial: 61. Best value: 0.440485:  61%|██████    | 61/100 [05:10<01:47,  2.76s/it]Best trial: 61. Best value: 0.440485:  62%|██████▏   | 62/100 [05:10<01:49,  2.88s/it]Best trial: 61. Best value: 0.440485:  62%|██████▏   | 62/100 [05:13<01:49,  2.88s/it]Best trial: 61. Best value: 0.440485:  63%|██████▎   | 63/100 [05:13<01:51,  3.02s/it]Best trial: 61. Best value: 0.440485:  63%|██████▎   | 63/100 [05:17<01:51,  3.02s/it]Best trial: 61. Best value: 0.440485:  64%|██████▍   | 64/100 [05:17<01:51,  3.11s/it]Best trial: 61. Best value: 0.440485:  64%|██████▍   | 64/100 [05:21<01:51,  3.11s/it]Best trial: 61. Best value: 0.440485:  65%|██████▌   | 65/100 [05:21<01:59,  3.40s/it]Best trial: 61. Best value: 0.440485:  65%|██████▌   | 65/100 [05:24<01:59,  3.40s/it]Best trial: 61. Best value: 0.440485:  66%|██████▌   | 66/100 [05:24<01:51,  3.27s/it]Best trial: 61. Best value: 0.440485:  66%|██████▌   | 66/100 [05:27<01:51,  3.27s/it]Best trial: 61. Best value: 0.440485:  67%|██████▋   | 67/100 [05:27<01:45,  3.19s/it]Best trial: 61. Best value: 0.440485:  67%|██████▋   | 67/100 [05:28<01:45,  3.19s/it]Best trial: 61. Best value: 0.440485:  68%|██████▊   | 68/100 [05:28<01:27,  2.73s/it]Best trial: 61. Best value: 0.440485:  68%|██████▊   | 68/100 [05:32<01:27,  2.73s/it]Best trial: 61. Best value: 0.440485:  69%|██████▉   | 69/100 [05:32<01:37,  3.14s/it]Best trial: 61. Best value: 0.440485:  69%|██████▉   | 69/100 [05:35<01:37,  3.14s/it]Best trial: 61. Best value: 0.440485:  70%|███████   | 70/100 [05:35<01:32,  3.09s/it]Best trial: 61. Best value: 0.440485:  70%|███████   | 70/100 [05:39<01:32,  3.09s/it]Best trial: 61. Best value: 0.440485:  71%|███████   | 71/100 [05:39<01:33,  3.22s/it]Best trial: 61. Best value: 0.440485:  71%|███████   | 71/100 [05:41<01:33,  3.22s/it]Best trial: 61. Best value: 0.440485:  72%|███████▏  | 72/100 [05:41<01:24,  3.01s/it]Best trial: 61. Best value: 0.440485:  72%|███████▏  | 72/100 [05:44<01:24,  3.01s/it]Best trial: 61. Best value: 0.440485:  73%|███████▎  | 73/100 [05:44<01:19,  2.93s/it]Best trial: 61. Best value: 0.440485:  73%|███████▎  | 73/100 [05:47<01:19,  2.93s/it]Best trial: 61. Best value: 0.440485:  74%|███████▍  | 74/100 [05:47<01:15,  2.92s/it]Best trial: 61. Best value: 0.440485:  74%|███████▍  | 74/100 [05:50<01:15,  2.92s/it]Best trial: 61. Best value: 0.440485:  75%|███████▌  | 75/100 [05:50<01:11,  2.86s/it]Best trial: 61. Best value: 0.440485:  75%|███████▌  | 75/100 [05:52<01:11,  2.86s/it]Best trial: 61. Best value: 0.440485:  76%|███████▌  | 76/100 [05:52<01:02,  2.59s/it]Best trial: 76. Best value: 0.442948:  76%|███████▌  | 76/100 [05:54<01:02,  2.59s/it]Best trial: 76. Best value: 0.442948:  77%|███████▋  | 77/100 [05:54<00:58,  2.56s/it]Best trial: 76. Best value: 0.442948:  77%|███████▋  | 77/100 [05:57<00:58,  2.56s/it]Best trial: 76. Best value: 0.442948:  78%|███████▊  | 78/100 [05:57<00:54,  2.49s/it]Best trial: 76. Best value: 0.442948:  78%|███████▊  | 78/100 [05:59<00:54,  2.49s/it]Best trial: 76. Best value: 0.442948:  79%|███████▉  | 79/100 [05:59<00:50,  2.42s/it]Best trial: 76. Best value: 0.442948:  79%|███████▉  | 79/100 [06:01<00:50,  2.42s/it]Best trial: 76. Best value: 0.442948:  80%|████████  | 80/100 [06:01<00:45,  2.28s/it]Best trial: 76. Best value: 0.442948:  80%|████████  | 80/100 [06:03<00:45,  2.28s/it]Best trial: 76. Best value: 0.442948:  81%|████████  | 81/100 [06:03<00:43,  2.28s/it]Best trial: 76. Best value: 0.442948:  81%|████████  | 81/100 [06:07<00:43,  2.28s/it]Best trial: 76. Best value: 0.442948:  82%|████████▏ | 82/100 [06:07<00:48,  2.72s/it]Best trial: 82. Best value: 0.44425:  82%|████████▏ | 82/100 [06:11<00:48,  2.72s/it] Best trial: 82. Best value: 0.44425:  83%|████████▎ | 83/100 [06:11<00:53,  3.17s/it]Best trial: 82. Best value: 0.44425:  83%|████████▎ | 83/100 [06:14<00:53,  3.17s/it]Best trial: 82. Best value: 0.44425:  84%|████████▍ | 84/100 [06:14<00:49,  3.10s/it]Best trial: 82. Best value: 0.44425:  84%|████████▍ | 84/100 [06:17<00:49,  3.10s/it]Best trial: 82. Best value: 0.44425:  85%|████████▌ | 85/100 [06:17<00:46,  3.13s/it]Best trial: 82. Best value: 0.44425:  85%|████████▌ | 85/100 [06:21<00:46,  3.13s/it]Best trial: 82. Best value: 0.44425:  86%|████████▌ | 86/100 [06:21<00:46,  3.30s/it]Best trial: 82. Best value: 0.44425:  86%|████████▌ | 86/100 [06:25<00:46,  3.30s/it]Best trial: 82. Best value: 0.44425:  87%|████████▋ | 87/100 [06:25<00:44,  3.44s/it]Best trial: 82. Best value: 0.44425:  87%|████████▋ | 87/100 [06:28<00:44,  3.44s/it]Best trial: 82. Best value: 0.44425:  88%|████████▊ | 88/100 [06:28<00:40,  3.36s/it]Best trial: 82. Best value: 0.44425:  88%|████████▊ | 88/100 [06:33<00:40,  3.36s/it]Best trial: 82. Best value: 0.44425:  89%|████████▉ | 89/100 [06:33<00:41,  3.80s/it]Best trial: 82. Best value: 0.44425:  89%|████████▉ | 89/100 [06:36<00:41,  3.80s/it]Best trial: 82. Best value: 0.44425:  90%|█████████ | 90/100 [06:36<00:36,  3.68s/it]Best trial: 82. Best value: 0.44425:  90%|█████████ | 90/100 [06:38<00:36,  3.68s/it]Best trial: 82. Best value: 0.44425:  91%|█████████ | 91/100 [06:38<00:28,  3.15s/it]Best trial: 82. Best value: 0.44425:  91%|█████████ | 91/100 [06:41<00:28,  3.15s/it]Best trial: 82. Best value: 0.44425:  92%|█████████▏| 92/100 [06:41<00:24,  3.05s/it]Best trial: 82. Best value: 0.44425:  92%|█████████▏| 92/100 [06:44<00:24,  3.05s/it]Best trial: 82. Best value: 0.44425:  93%|█████████▎| 93/100 [06:44<00:21,  3.11s/it]Best trial: 82. Best value: 0.44425:  93%|█████████▎| 93/100 [06:47<00:21,  3.11s/it]Best trial: 82. Best value: 0.44425:  94%|█████████▍| 94/100 [06:47<00:17,  3.00s/it]Best trial: 82. Best value: 0.44425:  94%|█████████▍| 94/100 [06:49<00:17,  3.00s/it]Best trial: 82. Best value: 0.44425:  95%|█████████▌| 95/100 [06:49<00:14,  2.86s/it]Best trial: 82. Best value: 0.44425:  95%|█████████▌| 95/100 [06:52<00:14,  2.86s/it]Best trial: 82. Best value: 0.44425:  96%|█████████▌| 96/100 [06:52<00:10,  2.68s/it]Best trial: 82. Best value: 0.44425:  96%|█████████▌| 96/100 [06:55<00:10,  2.68s/it]Best trial: 82. Best value: 0.44425:  97%|█████████▋| 97/100 [06:55<00:08,  2.78s/it]Best trial: 82. Best value: 0.44425:  97%|█████████▋| 97/100 [06:57<00:08,  2.78s/it]Best trial: 82. Best value: 0.44425:  98%|█████████▊| 98/100 [06:57<00:05,  2.54s/it]Best trial: 82. Best value: 0.44425:  98%|█████████▊| 98/100 [06:59<00:05,  2.54s/it]Best trial: 82. Best value: 0.44425:  99%|█████████▉| 99/100 [06:59<00:02,  2.52s/it]Best trial: 82. Best value: 0.44425:  99%|█████████▉| 99/100 [07:01<00:02,  2.52s/it]Best trial: 82. Best value: 0.44425: 100%|██████████| 100/100 [07:01<00:00,  2.48s/it]Best trial: 82. Best value: 0.44425: 100%|██████████| 100/100 [07:01<00:00,  4.22s/it]
2025-12-01 02:34:41,343 - INFO - HPO Complete. Best AUPRC: 0.4443
2025-12-01 02:34:41,343 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.02983420381584574, 'max_depth': 4, 'subsample': 0.6193386488484447, 'colsample_bytree': 0.870249773147964, 'gamma': 4.76357910490097, 'reg_lambda': 2.1020318194432026e-06, 'reg_alpha': 0.0011388460550233084}
2025-12-01 02:34:41,344 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/pleth_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:34:43,228 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: pleth_only
2025-12-01 02:34:43,228 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:34:43,421 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:34:43,441 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:34:43,445 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:34:43,445 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:34:43,445 - INFO - Training model...
2025-12-01 02:34:45,021 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:34:50,010 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:34:50,010 - INFO - AUROC: 0.7119 (0.6498 - 0.7353)
2025-12-01 02:34:50,010 - INFO - AUPRC: 0.4008 (0.3034 - 0.4502)
2025-12-01 02:34:50,010 - INFO - Brier Score: 0.1671 (0.1570 - 0.1868)
2025-12-01 02:34:50,010 - INFO - Accuracy: 0.7269 (0.5038 - 0.7569)
2025-12-01 02:34:50,010 - INFO - Precision: 0.3873 (0.2806 - 0.4493)
2025-12-01 02:34:50,010 - INFO - Sensitivity (Recall): 0.5524 (0.4825 - 0.8677)
2025-12-01 02:34:50,010 - INFO - F1-Score: 0.4553 (0.3983 - 0.5105)
2025-12-01 02:34:50,010 - INFO - Best Threshold: 0.4200 (0.1820 - 0.4280)
2025-12-01 02:34:50,010 - INFO - Specificity: 0.7723 (0.4097 - 0.8085)
2025-12-01 02:34:50,024 - INFO - Calculating SHAP values...
2025-12-01 02:34:51,179 - INFO - SHAP plots saved.
2025-12-01 02:34:51,180 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/pleth_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:34:52,452 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: ecg_only
2025-12-01 02:34:52,452 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:34:52,658 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:34:52,681 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:34:52,687 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:34:52,688 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.448972:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.448972:   1%|          | 1/100 [00:03<05:15,  3.18s/it]Best trial: 1. Best value: 0.454199:   1%|          | 1/100 [00:05<05:15,  3.18s/it]Best trial: 1. Best value: 0.454199:   2%|▏         | 2/100 [00:05<04:42,  2.89s/it]Best trial: 1. Best value: 0.454199:   2%|▏         | 2/100 [00:07<04:42,  2.89s/it]Best trial: 1. Best value: 0.454199:   3%|▎         | 3/100 [00:07<03:51,  2.38s/it]Best trial: 3. Best value: 0.464063:   3%|▎         | 3/100 [00:17<03:51,  2.38s/it]Best trial: 3. Best value: 0.464063:   4%|▍         | 4/100 [00:17<08:23,  5.24s/it]Best trial: 4. Best value: 0.471024:   4%|▍         | 4/100 [00:20<08:23,  5.24s/it]Best trial: 4. Best value: 0.471024:   5%|▌         | 5/100 [00:20<07:10,  4.53s/it]Best trial: 4. Best value: 0.471024:   5%|▌         | 5/100 [00:24<07:10,  4.53s/it]Best trial: 4. Best value: 0.471024:   6%|▌         | 6/100 [00:24<06:51,  4.37s/it]Best trial: 4. Best value: 0.471024:   6%|▌         | 6/100 [00:33<06:51,  4.37s/it]Best trial: 4. Best value: 0.471024:   7%|▋         | 7/100 [00:33<09:05,  5.86s/it]Best trial: 4. Best value: 0.471024:   7%|▋         | 7/100 [00:40<09:05,  5.86s/it]Best trial: 4. Best value: 0.471024:   8%|▊         | 8/100 [00:40<09:36,  6.27s/it]Best trial: 4. Best value: 0.471024:   8%|▊         | 8/100 [00:53<09:36,  6.27s/it]Best trial: 4. Best value: 0.471024:   9%|▉         | 9/100 [00:53<12:28,  8.23s/it]Best trial: 9. Best value: 0.484134:   9%|▉         | 9/100 [01:11<12:28,  8.23s/it]Best trial: 9. Best value: 0.484134:  10%|█         | 10/100 [01:11<17:02, 11.36s/it]Best trial: 9. Best value: 0.484134:  10%|█         | 10/100 [01:22<17:02, 11.36s/it]Best trial: 9. Best value: 0.484134:  11%|█         | 11/100 [01:22<16:50, 11.35s/it]Best trial: 9. Best value: 0.484134:  11%|█         | 11/100 [01:25<16:50, 11.35s/it]Best trial: 9. Best value: 0.484134:  12%|█▏        | 12/100 [01:25<12:34,  8.58s/it]Best trial: 9. Best value: 0.484134:  12%|█▏        | 12/100 [01:27<12:34,  8.58s/it]Best trial: 9. Best value: 0.484134:  13%|█▎        | 13/100 [01:27<09:41,  6.68s/it]Best trial: 9. Best value: 0.484134:  13%|█▎        | 13/100 [01:29<09:41,  6.68s/it]Best trial: 9. Best value: 0.484134:  14%|█▍        | 14/100 [01:29<07:23,  5.15s/it]Best trial: 9. Best value: 0.484134:  14%|█▍        | 14/100 [01:33<07:23,  5.15s/it]Best trial: 9. Best value: 0.484134:  15%|█▌        | 15/100 [01:33<07:07,  5.03s/it]Best trial: 9. Best value: 0.484134:  15%|█▌        | 15/100 [01:43<07:07,  5.03s/it]Best trial: 9. Best value: 0.484134:  16%|█▌        | 16/100 [01:43<09:01,  6.44s/it]Best trial: 9. Best value: 0.484134:  16%|█▌        | 16/100 [01:48<09:01,  6.44s/it]Best trial: 9. Best value: 0.484134:  17%|█▋        | 17/100 [01:48<08:11,  5.92s/it]Best trial: 9. Best value: 0.484134:  17%|█▋        | 17/100 [01:58<08:11,  5.92s/it]Best trial: 9. Best value: 0.484134:  18%|█▊        | 18/100 [01:58<10:02,  7.35s/it]Best trial: 18. Best value: 0.491919:  18%|█▊        | 18/100 [02:05<10:02,  7.35s/it]Best trial: 18. Best value: 0.491919:  19%|█▉        | 19/100 [02:05<09:47,  7.25s/it]Best trial: 18. Best value: 0.491919:  19%|█▉        | 19/100 [02:19<09:47,  7.25s/it]Best trial: 18. Best value: 0.491919:  20%|██        | 20/100 [02:19<12:07,  9.09s/it]Best trial: 18. Best value: 0.491919:  20%|██        | 20/100 [02:28<12:07,  9.09s/it]Best trial: 18. Best value: 0.491919:  21%|██        | 21/100 [02:28<12:04,  9.17s/it]Best trial: 21. Best value: 0.492383:  21%|██        | 21/100 [02:36<12:04,  9.17s/it]Best trial: 21. Best value: 0.492383:  22%|██▏       | 22/100 [02:36<11:21,  8.74s/it]Best trial: 21. Best value: 0.492383:  22%|██▏       | 22/100 [02:43<11:21,  8.74s/it]Best trial: 21. Best value: 0.492383:  23%|██▎       | 23/100 [02:43<10:23,  8.10s/it]Best trial: 21. Best value: 0.492383:  23%|██▎       | 23/100 [02:48<10:23,  8.10s/it]Best trial: 21. Best value: 0.492383:  24%|██▍       | 24/100 [02:48<09:07,  7.21s/it]Best trial: 21. Best value: 0.492383:  24%|██▍       | 24/100 [02:53<09:07,  7.21s/it]Best trial: 21. Best value: 0.492383:  25%|██▌       | 25/100 [02:53<08:13,  6.58s/it]Best trial: 21. Best value: 0.492383:  25%|██▌       | 25/100 [02:58<08:13,  6.58s/it]Best trial: 21. Best value: 0.492383:  26%|██▌       | 26/100 [02:58<07:32,  6.11s/it]Best trial: 21. Best value: 0.492383:  26%|██▌       | 26/100 [03:01<07:32,  6.11s/it]Best trial: 21. Best value: 0.492383:  27%|██▋       | 27/100 [03:01<06:30,  5.35s/it]Best trial: 21. Best value: 0.492383:  27%|██▋       | 27/100 [03:07<06:30,  5.35s/it]Best trial: 21. Best value: 0.492383:  28%|██▊       | 28/100 [03:07<06:41,  5.58s/it]Best trial: 21. Best value: 0.492383:  28%|██▊       | 28/100 [03:14<06:41,  5.58s/it]Best trial: 21. Best value: 0.492383:  29%|██▉       | 29/100 [03:14<06:56,  5.86s/it]Best trial: 21. Best value: 0.492383:  29%|██▉       | 29/100 [03:18<06:56,  5.86s/it]Best trial: 21. Best value: 0.492383:  30%|███       | 30/100 [03:18<06:11,  5.31s/it]Best trial: 21. Best value: 0.492383:  30%|███       | 30/100 [03:21<06:11,  5.31s/it]Best trial: 21. Best value: 0.492383:  31%|███       | 31/100 [03:21<05:16,  4.58s/it]Best trial: 21. Best value: 0.492383:  31%|███       | 31/100 [03:26<05:16,  4.58s/it]Best trial: 21. Best value: 0.492383:  32%|███▏      | 32/100 [03:26<05:19,  4.69s/it]Best trial: 21. Best value: 0.492383:  32%|███▏      | 32/100 [03:33<05:19,  4.69s/it]Best trial: 21. Best value: 0.492383:  33%|███▎      | 33/100 [03:33<05:58,  5.34s/it]Best trial: 21. Best value: 0.492383:  33%|███▎      | 33/100 [03:36<05:58,  5.34s/it]Best trial: 21. Best value: 0.492383:  34%|███▍      | 34/100 [03:36<05:16,  4.79s/it]Best trial: 21. Best value: 0.492383:  34%|███▍      | 34/100 [03:39<05:16,  4.79s/it]Best trial: 21. Best value: 0.492383:  35%|███▌      | 35/100 [03:39<04:36,  4.26s/it]Best trial: 21. Best value: 0.492383:  35%|███▌      | 35/100 [03:46<04:36,  4.26s/it]Best trial: 21. Best value: 0.492383:  36%|███▌      | 36/100 [03:46<05:21,  5.03s/it]Best trial: 21. Best value: 0.492383:  36%|███▌      | 36/100 [03:48<05:21,  5.03s/it]Best trial: 21. Best value: 0.492383:  37%|███▋      | 37/100 [03:48<04:25,  4.22s/it]Best trial: 21. Best value: 0.492383:  37%|███▋      | 37/100 [03:58<04:25,  4.22s/it]Best trial: 21. Best value: 0.492383:  38%|███▊      | 38/100 [03:58<05:52,  5.69s/it]Best trial: 21. Best value: 0.492383:  38%|███▊      | 38/100 [04:03<05:52,  5.69s/it]Best trial: 21. Best value: 0.492383:  39%|███▉      | 39/100 [04:03<05:34,  5.48s/it]Best trial: 21. Best value: 0.492383:  39%|███▉      | 39/100 [04:09<05:34,  5.48s/it]Best trial: 21. Best value: 0.492383:  40%|████      | 40/100 [04:09<05:38,  5.63s/it]Best trial: 21. Best value: 0.492383:  40%|████      | 40/100 [04:16<05:38,  5.63s/it]Best trial: 21. Best value: 0.492383:  41%|████      | 41/100 [04:16<06:01,  6.13s/it]Best trial: 21. Best value: 0.492383:  41%|████      | 41/100 [04:20<06:01,  6.13s/it]Best trial: 21. Best value: 0.492383:  42%|████▏     | 42/100 [04:20<05:27,  5.65s/it]Best trial: 21. Best value: 0.492383:  42%|████▏     | 42/100 [04:25<05:27,  5.65s/it]Best trial: 21. Best value: 0.492383:  43%|████▎     | 43/100 [04:25<05:03,  5.32s/it]Best trial: 21. Best value: 0.492383:  43%|████▎     | 43/100 [04:34<05:03,  5.32s/it]Best trial: 21. Best value: 0.492383:  44%|████▍     | 44/100 [04:34<05:58,  6.40s/it]Best trial: 21. Best value: 0.492383:  44%|████▍     | 44/100 [04:39<05:58,  6.40s/it]Best trial: 21. Best value: 0.492383:  45%|████▌     | 45/100 [04:39<05:37,  6.14s/it]Best trial: 21. Best value: 0.492383:  45%|████▌     | 45/100 [04:43<05:37,  6.14s/it]Best trial: 21. Best value: 0.492383:  46%|████▌     | 46/100 [04:43<04:44,  5.27s/it]Best trial: 21. Best value: 0.492383:  46%|████▌     | 46/100 [04:48<04:44,  5.27s/it]Best trial: 21. Best value: 0.492383:  47%|████▋     | 47/100 [04:48<04:36,  5.23s/it]Best trial: 21. Best value: 0.492383:  47%|████▋     | 47/100 [04:55<04:36,  5.23s/it]Best trial: 21. Best value: 0.492383:  48%|████▊     | 48/100 [04:55<05:03,  5.83s/it]Best trial: 21. Best value: 0.492383:  48%|████▊     | 48/100 [04:59<05:03,  5.83s/it]Best trial: 21. Best value: 0.492383:  49%|████▉     | 49/100 [04:59<04:30,  5.30s/it]Best trial: 21. Best value: 0.492383:  49%|████▉     | 49/100 [05:03<04:30,  5.30s/it]Best trial: 21. Best value: 0.492383:  50%|█████     | 50/100 [05:03<04:05,  4.91s/it]Best trial: 21. Best value: 0.492383:  50%|█████     | 50/100 [05:18<04:05,  4.91s/it]Best trial: 21. Best value: 0.492383:  51%|█████     | 51/100 [05:18<06:27,  7.92s/it]Best trial: 51. Best value: 0.493981:  51%|█████     | 51/100 [05:23<06:27,  7.92s/it]Best trial: 51. Best value: 0.493981:  52%|█████▏    | 52/100 [05:23<05:32,  6.92s/it]Best trial: 51. Best value: 0.493981:  52%|█████▏    | 52/100 [05:27<05:32,  6.92s/it]Best trial: 51. Best value: 0.493981:  53%|█████▎    | 53/100 [05:27<04:54,  6.27s/it]Best trial: 51. Best value: 0.493981:  53%|█████▎    | 53/100 [05:31<04:54,  6.27s/it]Best trial: 51. Best value: 0.493981:  54%|█████▍    | 54/100 [05:31<04:18,  5.61s/it]Best trial: 51. Best value: 0.493981:  54%|█████▍    | 54/100 [05:34<04:18,  5.61s/it]Best trial: 51. Best value: 0.493981:  55%|█████▌    | 55/100 [05:34<03:37,  4.83s/it]Best trial: 51. Best value: 0.493981:  55%|█████▌    | 55/100 [05:40<03:37,  4.83s/it]Best trial: 51. Best value: 0.493981:  56%|█████▌    | 56/100 [05:40<03:38,  4.96s/it]Best trial: 51. Best value: 0.493981:  56%|█████▌    | 56/100 [05:43<03:38,  4.96s/it]Best trial: 51. Best value: 0.493981:  57%|█████▋    | 57/100 [05:43<03:10,  4.42s/it]Best trial: 51. Best value: 0.493981:  57%|█████▋    | 57/100 [05:46<03:10,  4.42s/it]Best trial: 51. Best value: 0.493981:  58%|█████▊    | 58/100 [05:46<02:46,  3.96s/it]Best trial: 51. Best value: 0.493981:  58%|█████▊    | 58/100 [05:51<02:46,  3.96s/it]Best trial: 51. Best value: 0.493981:  59%|█████▉    | 59/100 [05:51<02:54,  4.26s/it]Best trial: 51. Best value: 0.493981:  59%|█████▉    | 59/100 [05:52<02:54,  4.26s/it]Best trial: 51. Best value: 0.493981:  60%|██████    | 60/100 [05:52<02:18,  3.46s/it]Best trial: 51. Best value: 0.493981:  60%|██████    | 60/100 [05:59<02:18,  3.46s/it]Best trial: 51. Best value: 0.493981:  61%|██████    | 61/100 [05:59<02:51,  4.39s/it]Best trial: 51. Best value: 0.493981:  61%|██████    | 61/100 [06:03<02:51,  4.39s/it]Best trial: 51. Best value: 0.493981:  62%|██████▏   | 62/100 [06:03<02:44,  4.33s/it]Best trial: 51. Best value: 0.493981:  62%|██████▏   | 62/100 [06:06<02:44,  4.33s/it]Best trial: 51. Best value: 0.493981:  63%|██████▎   | 63/100 [06:06<02:27,  3.98s/it]Best trial: 51. Best value: 0.493981:  63%|██████▎   | 63/100 [06:15<02:27,  3.98s/it]Best trial: 51. Best value: 0.493981:  64%|██████▍   | 64/100 [06:15<03:15,  5.42s/it]Best trial: 51. Best value: 0.493981:  64%|██████▍   | 64/100 [06:19<03:15,  5.42s/it]Best trial: 51. Best value: 0.493981:  65%|██████▌   | 65/100 [06:19<02:57,  5.07s/it]Best trial: 51. Best value: 0.493981:  65%|██████▌   | 65/100 [06:23<02:57,  5.07s/it]Best trial: 51. Best value: 0.493981:  66%|██████▌   | 66/100 [06:23<02:43,  4.81s/it]Best trial: 51. Best value: 0.493981:  66%|██████▌   | 66/100 [06:27<02:43,  4.81s/it]Best trial: 51. Best value: 0.493981:  67%|██████▋   | 67/100 [06:27<02:24,  4.38s/it]Best trial: 51. Best value: 0.493981:  67%|██████▋   | 67/100 [06:32<02:24,  4.38s/it]Best trial: 51. Best value: 0.493981:  68%|██████▊   | 68/100 [06:32<02:25,  4.54s/it]Best trial: 51. Best value: 0.493981:  68%|██████▊   | 68/100 [06:35<02:25,  4.54s/it]Best trial: 51. Best value: 0.493981:  69%|██████▉   | 69/100 [06:35<02:05,  4.04s/it]Best trial: 51. Best value: 0.493981:  69%|██████▉   | 69/100 [06:38<02:05,  4.04s/it]Best trial: 51. Best value: 0.493981:  70%|███████   | 70/100 [06:38<01:56,  3.88s/it]Best trial: 51. Best value: 0.493981:  70%|███████   | 70/100 [06:44<01:56,  3.88s/it]Best trial: 51. Best value: 0.493981:  71%|███████   | 71/100 [06:44<02:11,  4.53s/it]Best trial: 71. Best value: 0.495166:  71%|███████   | 71/100 [06:48<02:11,  4.53s/it]Best trial: 71. Best value: 0.495166:  72%|███████▏  | 72/100 [06:48<02:04,  4.45s/it]Best trial: 71. Best value: 0.495166:  72%|███████▏  | 72/100 [06:54<02:04,  4.45s/it]Best trial: 71. Best value: 0.495166:  73%|███████▎  | 73/100 [06:54<02:06,  4.67s/it]Best trial: 71. Best value: 0.495166:  73%|███████▎  | 73/100 [06:57<02:06,  4.67s/it]Best trial: 71. Best value: 0.495166:  74%|███████▍  | 74/100 [06:57<01:50,  4.26s/it]Best trial: 71. Best value: 0.495166:  74%|███████▍  | 74/100 [07:01<01:50,  4.26s/it]Best trial: 71. Best value: 0.495166:  75%|███████▌  | 75/100 [07:01<01:47,  4.31s/it]Best trial: 71. Best value: 0.495166:  75%|███████▌  | 75/100 [07:09<01:47,  4.31s/it]Best trial: 71. Best value: 0.495166:  76%|███████▌  | 76/100 [07:09<02:07,  5.32s/it]Best trial: 71. Best value: 0.495166:  76%|███████▌  | 76/100 [07:12<02:07,  5.32s/it]Best trial: 71. Best value: 0.495166:  77%|███████▋  | 77/100 [07:12<01:48,  4.71s/it]Best trial: 71. Best value: 0.495166:  77%|███████▋  | 77/100 [07:16<01:48,  4.71s/it]Best trial: 71. Best value: 0.495166:  78%|███████▊  | 78/100 [07:16<01:37,  4.42s/it]Best trial: 71. Best value: 0.495166:  78%|███████▊  | 78/100 [07:19<01:37,  4.42s/it]Best trial: 71. Best value: 0.495166:  79%|███████▉  | 79/100 [07:19<01:25,  4.09s/it]Best trial: 71. Best value: 0.495166:  79%|███████▉  | 79/100 [07:24<01:25,  4.09s/it]Best trial: 71. Best value: 0.495166:  80%|████████  | 80/100 [07:24<01:22,  4.14s/it]Best trial: 71. Best value: 0.495166:  80%|████████  | 80/100 [07:27<01:22,  4.14s/it]Best trial: 71. Best value: 0.495166:  81%|████████  | 81/100 [07:27<01:16,  4.04s/it]Best trial: 71. Best value: 0.495166:  81%|████████  | 81/100 [07:31<01:16,  4.04s/it]Best trial: 71. Best value: 0.495166:  82%|████████▏ | 82/100 [07:31<01:12,  4.02s/it]Best trial: 71. Best value: 0.495166:  82%|████████▏ | 82/100 [07:35<01:12,  4.02s/it]Best trial: 71. Best value: 0.495166:  83%|████████▎ | 83/100 [07:35<01:05,  3.84s/it]Best trial: 71. Best value: 0.495166:  83%|████████▎ | 83/100 [07:37<01:05,  3.84s/it]Best trial: 71. Best value: 0.495166:  84%|████████▍ | 84/100 [07:37<00:55,  3.49s/it]Best trial: 71. Best value: 0.495166:  84%|████████▍ | 84/100 [07:41<00:55,  3.49s/it]Best trial: 71. Best value: 0.495166:  85%|████████▌ | 85/100 [07:41<00:51,  3.43s/it]Best trial: 71. Best value: 0.495166:  85%|████████▌ | 85/100 [07:44<00:51,  3.43s/it]Best trial: 71. Best value: 0.495166:  86%|████████▌ | 86/100 [07:44<00:46,  3.34s/it]Best trial: 71. Best value: 0.495166:  86%|████████▌ | 86/100 [07:46<00:46,  3.34s/it]Best trial: 71. Best value: 0.495166:  87%|████████▋ | 87/100 [07:46<00:39,  3.00s/it]Best trial: 71. Best value: 0.495166:  87%|████████▋ | 87/100 [07:49<00:39,  3.00s/it]Best trial: 71. Best value: 0.495166:  88%|████████▊ | 88/100 [07:49<00:35,  2.94s/it]Best trial: 71. Best value: 0.495166:  88%|████████▊ | 88/100 [07:53<00:35,  2.94s/it]Best trial: 71. Best value: 0.495166:  89%|████████▉ | 89/100 [07:53<00:37,  3.43s/it]Best trial: 71. Best value: 0.495166:  89%|████████▉ | 89/100 [07:57<00:37,  3.43s/it]Best trial: 71. Best value: 0.495166:  90%|█████████ | 90/100 [07:57<00:34,  3.44s/it]Best trial: 71. Best value: 0.495166:  90%|█████████ | 90/100 [08:00<00:34,  3.44s/it]Best trial: 71. Best value: 0.495166:  91%|█████████ | 91/100 [08:00<00:31,  3.49s/it]Best trial: 71. Best value: 0.495166:  91%|█████████ | 91/100 [08:03<00:31,  3.49s/it]Best trial: 71. Best value: 0.495166:  92%|█████████▏| 92/100 [08:03<00:26,  3.31s/it]Best trial: 71. Best value: 0.495166:  92%|█████████▏| 92/100 [08:07<00:26,  3.31s/it]Best trial: 71. Best value: 0.495166:  93%|█████████▎| 93/100 [08:07<00:24,  3.50s/it]Best trial: 71. Best value: 0.495166:  93%|█████████▎| 93/100 [08:11<00:24,  3.50s/it]Best trial: 71. Best value: 0.495166:  94%|█████████▍| 94/100 [08:11<00:22,  3.70s/it]Best trial: 71. Best value: 0.495166:  94%|█████████▍| 94/100 [08:15<00:22,  3.70s/it]Best trial: 71. Best value: 0.495166:  95%|█████████▌| 95/100 [08:15<00:18,  3.67s/it]Best trial: 71. Best value: 0.495166:  95%|█████████▌| 95/100 [08:19<00:18,  3.67s/it]Best trial: 71. Best value: 0.495166:  96%|█████████▌| 96/100 [08:19<00:14,  3.63s/it]Best trial: 71. Best value: 0.495166:  96%|█████████▌| 96/100 [08:22<00:14,  3.63s/it]Best trial: 71. Best value: 0.495166:  97%|█████████▋| 97/100 [08:22<00:10,  3.51s/it]Best trial: 71. Best value: 0.495166:  97%|█████████▋| 97/100 [08:27<00:10,  3.51s/it]Best trial: 71. Best value: 0.495166:  98%|█████████▊| 98/100 [08:27<00:08,  4.08s/it]Best trial: 71. Best value: 0.495166:  98%|█████████▊| 98/100 [08:31<00:08,  4.08s/it]Best trial: 71. Best value: 0.495166:  99%|█████████▉| 99/100 [08:31<00:03,  3.96s/it]Best trial: 71. Best value: 0.495166:  99%|█████████▉| 99/100 [08:34<00:03,  3.96s/it]Best trial: 71. Best value: 0.495166: 100%|██████████| 100/100 [08:34<00:00,  3.55s/it]Best trial: 71. Best value: 0.495166: 100%|██████████| 100/100 [08:34<00:00,  5.14s/it]
2025-12-01 02:43:26,750 - INFO - HPO Complete. Best AUPRC: 0.4952
2025-12-01 02:43:26,750 - INFO - Best Params: {'n_estimators': 400, 'learning_rate': 0.0357288558966891, 'max_depth': 5, 'subsample': 0.6714443882471952, 'colsample_bytree': 0.8919319681118794, 'gamma': 0.2864731105263113, 'reg_lambda': 7.327318619098978e-08, 'reg_alpha': 3.8534774337536393e-07}
2025-12-01 02:43:26,751 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/ecg_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:43:28,768 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: ecg_only
2025-12-01 02:43:28,769 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:43:28,977 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:43:29,001 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:43:29,005 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:43:29,005 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:43:29,006 - INFO - Training model...
2025-12-01 02:43:30,608 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:43:35,580 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:43:35,580 - INFO - AUROC: 0.7343 (0.6839 - 0.7728)
2025-12-01 02:43:35,580 - INFO - AUPRC: 0.4328 (0.3625 - 0.4899)
2025-12-01 02:43:35,580 - INFO - Brier Score: 0.1510 (0.1364 - 0.1706)
2025-12-01 02:43:35,580 - INFO - Accuracy: 0.7124 (0.6832 - 0.8014)
2025-12-01 02:43:35,580 - INFO - Precision: 0.3852 (0.3493 - 0.5000)
2025-12-01 02:43:35,580 - INFO - Sensitivity (Recall): 0.6573 (0.5023 - 0.7174)
2025-12-01 02:43:35,580 - INFO - F1-Score: 0.4858 (0.4350 - 0.5465)
2025-12-01 02:43:35,580 - INFO - Best Threshold: 0.2700 (0.2380 - 0.4520)
2025-12-01 02:43:35,580 - INFO - Specificity: 0.7268 (0.6946 - 0.8750)
2025-12-01 02:43:35,598 - INFO - Calculating SHAP values...
2025-12-01 02:43:36,801 - INFO - SHAP plots saved.
2025-12-01 02:43:36,803 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/ecg_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=co2_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:43:38,166 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: co2_only
2025-12-01 02:43:38,166 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:43:38,363 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:43:38,383 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:43:38,388 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:43:38,388 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.588454:   0%|          | 0/100 [00:10<?, ?it/s]Best trial: 0. Best value: 0.588454:   1%|          | 1/100 [00:10<16:55, 10.26s/it]Best trial: 0. Best value: 0.588454:   1%|          | 1/100 [00:12<16:55, 10.26s/it]Best trial: 0. Best value: 0.588454:   2%|▏         | 2/100 [00:12<09:11,  5.63s/it]Best trial: 0. Best value: 0.588454:   2%|▏         | 2/100 [00:25<09:11,  5.63s/it]Best trial: 0. Best value: 0.588454:   3%|▎         | 3/100 [00:25<14:47,  9.15s/it]Best trial: 0. Best value: 0.588454:   3%|▎         | 3/100 [00:32<14:47,  9.15s/it]Best trial: 0. Best value: 0.588454:   4%|▍         | 4/100 [00:32<12:56,  8.09s/it]Best trial: 0. Best value: 0.588454:   4%|▍         | 4/100 [00:36<12:56,  8.09s/it]Best trial: 0. Best value: 0.588454:   5%|▌         | 5/100 [00:36<10:42,  6.77s/it]Best trial: 0. Best value: 0.588454:   5%|▌         | 5/100 [00:38<10:42,  6.77s/it]Best trial: 0. Best value: 0.588454:   6%|▌         | 6/100 [00:38<08:00,  5.11s/it]Best trial: 0. Best value: 0.588454:   6%|▌         | 6/100 [00:43<08:00,  5.11s/it]Best trial: 0. Best value: 0.588454:   7%|▋         | 7/100 [00:43<07:54,  5.10s/it]Best trial: 0. Best value: 0.588454:   7%|▋         | 7/100 [00:46<07:54,  5.10s/it]Best trial: 0. Best value: 0.588454:   8%|▊         | 8/100 [00:46<06:31,  4.25s/it]Best trial: 0. Best value: 0.588454:   8%|▊         | 8/100 [00:53<06:31,  4.25s/it]Best trial: 0. Best value: 0.588454:   9%|▉         | 9/100 [00:53<08:02,  5.30s/it]Best trial: 0. Best value: 0.588454:   9%|▉         | 9/100 [00:57<08:02,  5.30s/it]Best trial: 0. Best value: 0.588454:  10%|█         | 10/100 [00:57<07:05,  4.73s/it]Best trial: 10. Best value: 0.591442:  10%|█         | 10/100 [01:02<07:05,  4.73s/it]Best trial: 10. Best value: 0.591442:  11%|█         | 11/100 [01:02<07:21,  4.96s/it]Best trial: 10. Best value: 0.591442:  11%|█         | 11/100 [01:08<07:21,  4.96s/it]Best trial: 10. Best value: 0.591442:  12%|█▏        | 12/100 [01:08<07:39,  5.22s/it]Best trial: 10. Best value: 0.591442:  12%|█▏        | 12/100 [01:20<07:39,  5.22s/it]Best trial: 10. Best value: 0.591442:  13%|█▎        | 13/100 [01:20<10:38,  7.33s/it]Best trial: 10. Best value: 0.591442:  13%|█▎        | 13/100 [01:25<10:38,  7.33s/it]Best trial: 10. Best value: 0.591442:  14%|█▍        | 14/100 [01:25<09:18,  6.50s/it]Best trial: 10. Best value: 0.591442:  14%|█▍        | 14/100 [01:37<09:18,  6.50s/it]Best trial: 10. Best value: 0.591442:  15%|█▌        | 15/100 [01:37<11:39,  8.23s/it]Best trial: 15. Best value: 0.593697:  15%|█▌        | 15/100 [01:47<11:39,  8.23s/it]Best trial: 15. Best value: 0.593697:  16%|█▌        | 16/100 [01:47<12:17,  8.78s/it]Best trial: 15. Best value: 0.593697:  16%|█▌        | 16/100 [01:52<12:17,  8.78s/it]Best trial: 15. Best value: 0.593697:  17%|█▋        | 17/100 [01:52<10:39,  7.70s/it]Best trial: 15. Best value: 0.593697:  17%|█▋        | 17/100 [02:07<10:39,  7.70s/it]Best trial: 15. Best value: 0.593697:  18%|█▊        | 18/100 [02:07<13:14,  9.69s/it]Best trial: 15. Best value: 0.593697:  18%|█▊        | 18/100 [02:10<13:14,  9.69s/it]Best trial: 15. Best value: 0.593697:  19%|█▉        | 19/100 [02:10<10:19,  7.65s/it]Best trial: 15. Best value: 0.593697:  19%|█▉        | 19/100 [02:20<10:19,  7.65s/it]Best trial: 15. Best value: 0.593697:  20%|██        | 20/100 [02:20<11:11,  8.39s/it]Best trial: 15. Best value: 0.593697:  20%|██        | 20/100 [02:27<11:11,  8.39s/it]Best trial: 15. Best value: 0.593697:  21%|██        | 21/100 [02:27<10:29,  7.96s/it]Best trial: 15. Best value: 0.593697:  21%|██        | 21/100 [02:31<10:29,  7.96s/it]Best trial: 15. Best value: 0.593697:  22%|██▏       | 22/100 [02:31<09:06,  7.01s/it]Best trial: 15. Best value: 0.593697:  22%|██▏       | 22/100 [02:39<09:06,  7.01s/it]Best trial: 15. Best value: 0.593697:  23%|██▎       | 23/100 [02:39<09:01,  7.03s/it]Best trial: 15. Best value: 0.593697:  23%|██▎       | 23/100 [02:44<09:01,  7.03s/it]Best trial: 15. Best value: 0.593697:  24%|██▍       | 24/100 [02:44<08:19,  6.57s/it]Best trial: 15. Best value: 0.593697:  24%|██▍       | 24/100 [02:50<08:19,  6.57s/it]Best trial: 15. Best value: 0.593697:  25%|██▌       | 25/100 [02:50<07:54,  6.33s/it]Best trial: 15. Best value: 0.593697:  25%|██▌       | 25/100 [03:13<07:54,  6.33s/it]Best trial: 15. Best value: 0.593697:  26%|██▌       | 26/100 [03:13<14:07, 11.45s/it]Best trial: 15. Best value: 0.593697:  26%|██▌       | 26/100 [03:21<14:07, 11.45s/it]Best trial: 15. Best value: 0.593697:  27%|██▋       | 27/100 [03:21<12:45, 10.49s/it]Best trial: 15. Best value: 0.593697:  27%|██▋       | 27/100 [03:34<12:45, 10.49s/it]Best trial: 15. Best value: 0.593697:  28%|██▊       | 28/100 [03:34<13:27, 11.22s/it]Best trial: 15. Best value: 0.593697:  28%|██▊       | 28/100 [03:39<13:27, 11.22s/it]Best trial: 15. Best value: 0.593697:  29%|██▉       | 29/100 [03:39<10:59,  9.29s/it]Best trial: 15. Best value: 0.593697:  29%|██▉       | 29/100 [03:50<10:59,  9.29s/it]Best trial: 15. Best value: 0.593697:  30%|███       | 30/100 [03:50<11:27,  9.82s/it]Best trial: 15. Best value: 0.593697:  30%|███       | 30/100 [03:59<11:27,  9.82s/it]Best trial: 15. Best value: 0.593697:  31%|███       | 31/100 [03:59<10:59,  9.56s/it]Best trial: 15. Best value: 0.593697:  31%|███       | 31/100 [04:04<10:59,  9.56s/it]Best trial: 15. Best value: 0.593697:  32%|███▏      | 32/100 [04:04<09:03,  7.99s/it]Best trial: 15. Best value: 0.593697:  32%|███▏      | 32/100 [04:07<09:03,  7.99s/it]Best trial: 15. Best value: 0.593697:  33%|███▎      | 33/100 [04:07<07:19,  6.55s/it]Best trial: 15. Best value: 0.593697:  33%|███▎      | 33/100 [04:10<07:19,  6.55s/it]Best trial: 15. Best value: 0.593697:  34%|███▍      | 34/100 [04:10<06:15,  5.69s/it]Best trial: 34. Best value: 0.596958:  34%|███▍      | 34/100 [04:19<06:15,  5.69s/it]Best trial: 34. Best value: 0.596958:  35%|███▌      | 35/100 [04:19<07:02,  6.49s/it]Best trial: 34. Best value: 0.596958:  35%|███▌      | 35/100 [04:34<07:02,  6.49s/it]Best trial: 34. Best value: 0.596958:  36%|███▌      | 36/100 [04:34<09:38,  9.05s/it]Best trial: 34. Best value: 0.596958:  36%|███▌      | 36/100 [04:50<09:38,  9.05s/it]Best trial: 34. Best value: 0.596958:  37%|███▋      | 37/100 [04:50<11:41, 11.14s/it]Best trial: 34. Best value: 0.596958:  37%|███▋      | 37/100 [05:06<11:41, 11.14s/it]Best trial: 34. Best value: 0.596958:  38%|███▊      | 38/100 [05:06<12:56, 12.52s/it]Best trial: 34. Best value: 0.596958:  38%|███▊      | 38/100 [05:20<12:56, 12.52s/it]Best trial: 34. Best value: 0.596958:  39%|███▉      | 39/100 [05:20<13:14, 13.02s/it]Best trial: 34. Best value: 0.596958:  39%|███▉      | 39/100 [05:31<13:14, 13.02s/it]Best trial: 34. Best value: 0.596958:  40%|████      | 40/100 [05:31<12:29, 12.50s/it]Best trial: 34. Best value: 0.596958:  40%|████      | 40/100 [05:35<12:29, 12.50s/it]Best trial: 34. Best value: 0.596958:  41%|████      | 41/100 [05:35<09:51, 10.02s/it]Best trial: 34. Best value: 0.596958:  41%|████      | 41/100 [05:41<09:51, 10.02s/it]Best trial: 34. Best value: 0.596958:  42%|████▏     | 42/100 [05:41<08:25,  8.71s/it]Best trial: 34. Best value: 0.596958:  42%|████▏     | 42/100 [05:46<08:25,  8.71s/it]Best trial: 34. Best value: 0.596958:  43%|████▎     | 43/100 [05:46<07:14,  7.63s/it]Best trial: 34. Best value: 0.596958:  43%|████▎     | 43/100 [05:57<07:14,  7.63s/it]Best trial: 34. Best value: 0.596958:  44%|████▍     | 44/100 [05:57<08:00,  8.58s/it]Best trial: 34. Best value: 0.596958:  44%|████▍     | 44/100 [06:02<08:00,  8.58s/it]Best trial: 34. Best value: 0.596958:  45%|████▌     | 45/100 [06:02<06:56,  7.57s/it]Best trial: 34. Best value: 0.596958:  45%|████▌     | 45/100 [06:08<06:56,  7.57s/it]Best trial: 34. Best value: 0.596958:  46%|████▌     | 46/100 [06:08<06:30,  7.24s/it]Best trial: 34. Best value: 0.596958:  46%|████▌     | 46/100 [06:15<06:30,  7.24s/it]Best trial: 34. Best value: 0.596958:  47%|████▋     | 47/100 [06:15<06:10,  6.99s/it]Best trial: 34. Best value: 0.596958:  47%|████▋     | 47/100 [06:19<06:10,  6.99s/it]Best trial: 34. Best value: 0.596958:  48%|████▊     | 48/100 [06:19<05:11,  5.99s/it]Best trial: 34. Best value: 0.596958:  48%|████▊     | 48/100 [06:25<05:11,  5.99s/it]Best trial: 34. Best value: 0.596958:  49%|████▉     | 49/100 [06:25<05:19,  6.27s/it]Best trial: 34. Best value: 0.596958:  49%|████▉     | 49/100 [06:32<05:19,  6.27s/it]Best trial: 34. Best value: 0.596958:  50%|█████     | 50/100 [06:32<05:13,  6.28s/it]Best trial: 34. Best value: 0.596958:  50%|█████     | 50/100 [06:38<05:13,  6.28s/it]Best trial: 34. Best value: 0.596958:  51%|█████     | 51/100 [06:38<05:02,  6.18s/it]Best trial: 34. Best value: 0.596958:  51%|█████     | 51/100 [06:44<05:02,  6.18s/it]Best trial: 34. Best value: 0.596958:  52%|█████▏    | 52/100 [06:44<05:04,  6.35s/it]Best trial: 34. Best value: 0.596958:  52%|█████▏    | 52/100 [06:53<05:04,  6.35s/it]Best trial: 34. Best value: 0.596958:  53%|█████▎    | 53/100 [06:53<05:25,  6.92s/it]Best trial: 34. Best value: 0.596958:  53%|█████▎    | 53/100 [06:59<05:25,  6.92s/it]Best trial: 34. Best value: 0.596958:  54%|█████▍    | 54/100 [06:59<05:07,  6.68s/it]Best trial: 34. Best value: 0.596958:  54%|█████▍    | 54/100 [07:06<05:07,  6.68s/it]Best trial: 34. Best value: 0.596958:  55%|█████▌    | 55/100 [07:06<05:12,  6.95s/it]Best trial: 34. Best value: 0.596958:  55%|█████▌    | 55/100 [07:15<05:12,  6.95s/it]Best trial: 34. Best value: 0.596958:  56%|█████▌    | 56/100 [07:15<05:29,  7.49s/it]Best trial: 34. Best value: 0.596958:  56%|█████▌    | 56/100 [07:19<05:29,  7.49s/it]Best trial: 34. Best value: 0.596958:  57%|█████▋    | 57/100 [07:19<04:40,  6.53s/it]Best trial: 34. Best value: 0.596958:  57%|█████▋    | 57/100 [07:22<04:40,  6.53s/it]Best trial: 34. Best value: 0.596958:  58%|█████▊    | 58/100 [07:22<03:47,  5.41s/it]Best trial: 34. Best value: 0.596958:  58%|█████▊    | 58/100 [07:27<03:47,  5.41s/it]Best trial: 34. Best value: 0.596958:  59%|█████▉    | 59/100 [07:27<03:31,  5.15s/it]Best trial: 34. Best value: 0.596958:  59%|█████▉    | 59/100 [07:36<03:31,  5.15s/it]Best trial: 34. Best value: 0.596958:  60%|██████    | 60/100 [07:36<04:16,  6.41s/it]Best trial: 34. Best value: 0.596958:  60%|██████    | 60/100 [07:47<04:16,  6.41s/it]Best trial: 34. Best value: 0.596958:  61%|██████    | 61/100 [07:47<04:57,  7.62s/it]Best trial: 34. Best value: 0.596958:  61%|██████    | 61/100 [07:53<04:57,  7.62s/it]Best trial: 34. Best value: 0.596958:  62%|██████▏   | 62/100 [07:53<04:32,  7.17s/it]Best trial: 34. Best value: 0.596958:  62%|██████▏   | 62/100 [07:59<04:32,  7.17s/it]Best trial: 34. Best value: 0.596958:  63%|██████▎   | 63/100 [07:59<04:14,  6.88s/it]Best trial: 34. Best value: 0.596958:  63%|██████▎   | 63/100 [08:05<04:14,  6.88s/it]Best trial: 34. Best value: 0.596958:  64%|██████▍   | 64/100 [08:05<03:54,  6.50s/it]Best trial: 34. Best value: 0.596958:  64%|██████▍   | 64/100 [08:11<03:54,  6.50s/it]Best trial: 34. Best value: 0.596958:  65%|██████▌   | 65/100 [08:11<03:51,  6.61s/it]Best trial: 34. Best value: 0.596958:  65%|██████▌   | 65/100 [08:16<03:51,  6.61s/it]Best trial: 34. Best value: 0.596958:  66%|██████▌   | 66/100 [08:16<03:28,  6.12s/it]Best trial: 34. Best value: 0.596958:  66%|██████▌   | 66/100 [08:23<03:28,  6.12s/it]Best trial: 34. Best value: 0.596958:  67%|██████▋   | 67/100 [08:23<03:25,  6.22s/it]Best trial: 34. Best value: 0.596958:  67%|██████▋   | 67/100 [08:33<03:25,  6.22s/it]Best trial: 34. Best value: 0.596958:  68%|██████▊   | 68/100 [08:33<03:59,  7.49s/it]Best trial: 34. Best value: 0.596958:  68%|██████▊   | 68/100 [08:42<03:59,  7.49s/it]Best trial: 34. Best value: 0.596958:  69%|██████▉   | 69/100 [08:42<04:01,  7.79s/it]Best trial: 34. Best value: 0.596958:  69%|██████▉   | 69/100 [08:45<04:01,  7.79s/it]Best trial: 34. Best value: 0.596958:  70%|███████   | 70/100 [08:45<03:14,  6.50s/it]Best trial: 34. Best value: 0.596958:  70%|███████   | 70/100 [08:51<03:14,  6.50s/it]Best trial: 34. Best value: 0.596958:  71%|███████   | 71/100 [08:51<03:00,  6.22s/it]Best trial: 34. Best value: 0.596958:  71%|███████   | 71/100 [08:56<03:00,  6.22s/it]Best trial: 34. Best value: 0.596958:  72%|███████▏  | 72/100 [08:56<02:46,  5.96s/it]Best trial: 34. Best value: 0.596958:  72%|███████▏  | 72/100 [09:02<02:46,  5.96s/it]Best trial: 34. Best value: 0.596958:  73%|███████▎  | 73/100 [09:02<02:42,  6.02s/it]Best trial: 34. Best value: 0.596958:  73%|███████▎  | 73/100 [09:08<02:42,  6.02s/it]Best trial: 34. Best value: 0.596958:  74%|███████▍  | 74/100 [09:08<02:32,  5.87s/it]Best trial: 34. Best value: 0.596958:  74%|███████▍  | 74/100 [09:15<02:32,  5.87s/it]Best trial: 34. Best value: 0.596958:  75%|███████▌  | 75/100 [09:15<02:37,  6.31s/it]Best trial: 34. Best value: 0.596958:  75%|███████▌  | 75/100 [09:18<02:37,  6.31s/it]Best trial: 34. Best value: 0.596958:  76%|███████▌  | 76/100 [09:18<02:09,  5.41s/it]Best trial: 34. Best value: 0.596958:  76%|███████▌  | 76/100 [09:21<02:09,  5.41s/it]Best trial: 34. Best value: 0.596958:  77%|███████▋  | 77/100 [09:21<01:45,  4.60s/it]Best trial: 34. Best value: 0.596958:  77%|███████▋  | 77/100 [09:25<01:45,  4.60s/it]Best trial: 34. Best value: 0.596958:  78%|███████▊  | 78/100 [09:25<01:36,  4.36s/it]Best trial: 34. Best value: 0.596958:  78%|███████▊  | 78/100 [09:32<01:36,  4.36s/it]Best trial: 34. Best value: 0.596958:  79%|███████▉  | 79/100 [09:32<01:48,  5.19s/it]Best trial: 34. Best value: 0.596958:  79%|███████▉  | 79/100 [09:37<01:48,  5.19s/it]Best trial: 34. Best value: 0.596958:  80%|████████  | 80/100 [09:37<01:44,  5.22s/it]Best trial: 34. Best value: 0.596958:  80%|████████  | 80/100 [09:41<01:44,  5.22s/it]Best trial: 34. Best value: 0.596958:  81%|████████  | 81/100 [09:41<01:29,  4.71s/it]Best trial: 34. Best value: 0.596958:  81%|████████  | 81/100 [09:46<01:29,  4.71s/it]Best trial: 34. Best value: 0.596958:  82%|████████▏ | 82/100 [09:46<01:26,  4.79s/it]Best trial: 34. Best value: 0.596958:  82%|████████▏ | 82/100 [09:50<01:26,  4.79s/it]Best trial: 34. Best value: 0.596958:  83%|████████▎ | 83/100 [09:50<01:18,  4.65s/it]Best trial: 34. Best value: 0.596958:  83%|████████▎ | 83/100 [09:54<01:18,  4.65s/it]Best trial: 34. Best value: 0.596958:  84%|████████▍ | 84/100 [09:54<01:08,  4.31s/it]Best trial: 34. Best value: 0.596958:  84%|████████▍ | 84/100 [10:02<01:08,  4.31s/it]Best trial: 34. Best value: 0.596958:  85%|████████▌ | 85/100 [10:02<01:24,  5.61s/it]Best trial: 34. Best value: 0.596958:  85%|████████▌ | 85/100 [10:07<01:24,  5.61s/it]Best trial: 34. Best value: 0.596958:  86%|████████▌ | 86/100 [10:07<01:14,  5.35s/it]Best trial: 34. Best value: 0.596958:  86%|████████▌ | 86/100 [10:13<01:14,  5.35s/it]Best trial: 34. Best value: 0.596958:  87%|████████▋ | 87/100 [10:13<01:10,  5.45s/it]Best trial: 34. Best value: 0.596958:  87%|████████▋ | 87/100 [10:16<01:10,  5.45s/it]Best trial: 34. Best value: 0.596958:  88%|████████▊ | 88/100 [10:16<00:58,  4.86s/it]Best trial: 34. Best value: 0.596958:  88%|████████▊ | 88/100 [10:19<00:58,  4.86s/it]Best trial: 34. Best value: 0.596958:  89%|████████▉ | 89/100 [10:19<00:45,  4.15s/it]Best trial: 34. Best value: 0.596958:  89%|████████▉ | 89/100 [10:26<00:45,  4.15s/it]Best trial: 34. Best value: 0.596958:  90%|█████████ | 90/100 [10:26<00:50,  5.04s/it]Best trial: 34. Best value: 0.596958:  90%|█████████ | 90/100 [10:28<00:50,  5.04s/it]Best trial: 34. Best value: 0.596958:  91%|█████████ | 91/100 [10:28<00:37,  4.15s/it]Best trial: 34. Best value: 0.596958:  91%|█████████ | 91/100 [10:31<00:37,  4.15s/it]Best trial: 34. Best value: 0.596958:  92%|█████████▏| 92/100 [10:31<00:31,  3.90s/it]Best trial: 34. Best value: 0.596958:  92%|█████████▏| 92/100 [10:35<00:31,  3.90s/it]Best trial: 34. Best value: 0.596958:  93%|█████████▎| 93/100 [10:35<00:26,  3.85s/it]Best trial: 34. Best value: 0.596958:  93%|█████████▎| 93/100 [10:41<00:26,  3.85s/it]Best trial: 34. Best value: 0.596958:  94%|█████████▍| 94/100 [10:41<00:26,  4.39s/it]Best trial: 34. Best value: 0.596958:  94%|█████████▍| 94/100 [10:45<00:26,  4.39s/it]Best trial: 34. Best value: 0.596958:  95%|█████████▌| 95/100 [10:45<00:21,  4.28s/it]Best trial: 34. Best value: 0.596958:  95%|█████████▌| 95/100 [10:50<00:21,  4.28s/it]Best trial: 34. Best value: 0.596958:  96%|█████████▌| 96/100 [10:50<00:17,  4.48s/it]Best trial: 34. Best value: 0.596958:  96%|█████████▌| 96/100 [10:57<00:17,  4.48s/it]Best trial: 34. Best value: 0.596958:  97%|█████████▋| 97/100 [10:57<00:15,  5.30s/it]Best trial: 34. Best value: 0.596958:  97%|█████████▋| 97/100 [11:05<00:15,  5.30s/it]Best trial: 34. Best value: 0.596958:  98%|█████████▊| 98/100 [11:05<00:12,  6.02s/it]Best trial: 34. Best value: 0.596958:  98%|█████████▊| 98/100 [11:07<00:12,  6.02s/it]Best trial: 34. Best value: 0.596958:  99%|█████████▉| 99/100 [11:07<00:04,  4.91s/it]Best trial: 34. Best value: 0.596958:  99%|█████████▉| 99/100 [11:10<00:04,  4.91s/it]Best trial: 34. Best value: 0.596958: 100%|██████████| 100/100 [11:10<00:00,  4.31s/it]Best trial: 34. Best value: 0.596958: 100%|██████████| 100/100 [11:10<00:00,  6.70s/it]
2025-12-01 02:54:48,664 - INFO - HPO Complete. Best AUPRC: 0.5970
2025-12-01 02:54:48,664 - INFO - Best Params: {'n_estimators': 800, 'learning_rate': 0.030880793077724327, 'max_depth': 8, 'subsample': 0.8168284446362952, 'colsample_bytree': 0.8581453902325673, 'gamma': 0.3083693575589654, 'reg_lambda': 2.409567454665562e-05, 'reg_alpha': 0.0009343113099614989}
2025-12-01 02:54:48,665 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/co2_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 02:54:50,546 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: co2_only
2025-12-01 02:54:50,546 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:54:50,746 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:54:50,770 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:54:50,774 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:54:50,774 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 02:54:50,774 - INFO - Training model...
2025-12-01 02:54:55,442 - INFO - Evaluating model with bootstrapping...
2025-12-01 02:55:00,484 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 02:55:00,484 - INFO - AUROC: 0.7917 (0.7539 - 0.8373)
2025-12-01 02:55:00,484 - INFO - AUPRC: 0.5401 (0.4988 - 0.6540)
2025-12-01 02:55:00,484 - INFO - Brier Score: 0.1415 (0.1235 - 0.1545)
2025-12-01 02:55:00,484 - INFO - Accuracy: 0.7919 (0.7382 - 0.8445)
2025-12-01 02:55:00,484 - INFO - Precision: 0.4971 (0.4244 - 0.6582)
2025-12-01 02:55:00,484 - INFO - Sensitivity (Recall): 0.5944 (0.5308 - 0.7484)
2025-12-01 02:55:00,484 - INFO - F1-Score: 0.5414 (0.5084 - 0.6239)
2025-12-01 02:55:00,484 - INFO - Best Threshold: 0.2200 (0.0940 - 0.3620)
2025-12-01 02:55:00,484 - INFO - Specificity: 0.8434 (0.7344 - 0.9208)
2025-12-01 02:55:00,517 - INFO - Calculating SHAP values...
2025-12-01 02:55:02,078 - INFO - SHAP plots saved.
2025-12-01 02:55:02,081 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/co2_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=awp_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 02:55:03,317 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: awp_only
2025-12-01 02:55:03,317 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 02:55:03,516 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 02:55:03,536 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 02:55:03,541 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 02:55:03,541 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.567109:   0%|          | 0/100 [00:04<?, ?it/s]Best trial: 0. Best value: 0.567109:   1%|          | 1/100 [00:04<07:54,  4.79s/it]Best trial: 0. Best value: 0.567109:   1%|          | 1/100 [00:10<07:54,  4.79s/it]Best trial: 0. Best value: 0.567109:   2%|▏         | 2/100 [00:10<08:39,  5.30s/it]Best trial: 0. Best value: 0.567109:   2%|▏         | 2/100 [00:21<08:39,  5.30s/it]Best trial: 0. Best value: 0.567109:   3%|▎         | 3/100 [00:21<12:44,  7.88s/it]Best trial: 0. Best value: 0.567109:   3%|▎         | 3/100 [00:28<12:44,  7.88s/it]Best trial: 0. Best value: 0.567109:   4%|▍         | 4/100 [00:28<11:53,  7.43s/it]Best trial: 0. Best value: 0.567109:   4%|▍         | 4/100 [00:39<11:53,  7.43s/it]Best trial: 0. Best value: 0.567109:   5%|▌         | 5/100 [00:39<14:15,  9.01s/it]Best trial: 0. Best value: 0.567109:   5%|▌         | 5/100 [00:51<14:15,  9.01s/it]Best trial: 0. Best value: 0.567109:   6%|▌         | 6/100 [00:51<15:16,  9.75s/it]Best trial: 6. Best value: 0.569967:   6%|▌         | 6/100 [00:54<15:16,  9.75s/it]Best trial: 6. Best value: 0.569967:   7%|▋         | 7/100 [00:54<11:52,  7.66s/it]Best trial: 6. Best value: 0.569967:   7%|▋         | 7/100 [00:58<11:52,  7.66s/it]Best trial: 6. Best value: 0.569967:   8%|▊         | 8/100 [00:58<10:10,  6.64s/it]Best trial: 6. Best value: 0.569967:   8%|▊         | 8/100 [01:01<10:10,  6.64s/it]Best trial: 6. Best value: 0.569967:   9%|▉         | 9/100 [01:01<08:17,  5.47s/it]Best trial: 9. Best value: 0.577094:   9%|▉         | 9/100 [01:12<08:17,  5.47s/it]Best trial: 9. Best value: 0.577094:  10%|█         | 10/100 [01:12<10:42,  7.14s/it]Best trial: 9. Best value: 0.577094:  10%|█         | 10/100 [01:17<10:42,  7.14s/it]Best trial: 9. Best value: 0.577094:  11%|█         | 11/100 [01:17<09:43,  6.55s/it]Best trial: 9. Best value: 0.577094:  11%|█         | 11/100 [01:20<09:43,  6.55s/it]Best trial: 9. Best value: 0.577094:  12%|█▏        | 12/100 [01:20<07:45,  5.29s/it]Best trial: 9. Best value: 0.577094:  12%|█▏        | 12/100 [01:23<07:45,  5.29s/it]Best trial: 9. Best value: 0.577094:  13%|█▎        | 13/100 [01:23<06:35,  4.54s/it]Best trial: 9. Best value: 0.577094:  13%|█▎        | 13/100 [01:27<06:35,  4.54s/it]Best trial: 9. Best value: 0.577094:  14%|█▍        | 14/100 [01:27<06:28,  4.52s/it]Best trial: 14. Best value: 0.580629:  14%|█▍        | 14/100 [01:33<06:28,  4.52s/it]Best trial: 14. Best value: 0.580629:  15%|█▌        | 15/100 [01:33<06:58,  4.93s/it]Best trial: 14. Best value: 0.580629:  15%|█▌        | 15/100 [01:37<06:58,  4.93s/it]Best trial: 14. Best value: 0.580629:  16%|█▌        | 16/100 [01:37<06:27,  4.61s/it]Best trial: 14. Best value: 0.580629:  16%|█▌        | 16/100 [01:57<06:27,  4.61s/it]Best trial: 14. Best value: 0.580629:  17%|█▋        | 17/100 [01:57<12:42,  9.19s/it]Best trial: 14. Best value: 0.580629:  17%|█▋        | 17/100 [02:03<12:42,  9.19s/it]Best trial: 14. Best value: 0.580629:  18%|█▊        | 18/100 [02:03<11:28,  8.40s/it]Best trial: 14. Best value: 0.580629:  18%|█▊        | 18/100 [02:15<11:28,  8.40s/it]Best trial: 14. Best value: 0.580629:  19%|█▉        | 19/100 [02:15<12:41,  9.40s/it]Best trial: 14. Best value: 0.580629:  19%|█▉        | 19/100 [02:21<12:41,  9.40s/it]Best trial: 14. Best value: 0.580629:  20%|██        | 20/100 [02:21<11:14,  8.44s/it]Best trial: 14. Best value: 0.580629:  20%|██        | 20/100 [02:25<11:14,  8.44s/it]Best trial: 14. Best value: 0.580629:  21%|██        | 21/100 [02:25<09:09,  6.95s/it]Best trial: 14. Best value: 0.580629:  21%|██        | 21/100 [02:30<09:09,  6.95s/it]Best trial: 14. Best value: 0.580629:  22%|██▏       | 22/100 [02:30<08:28,  6.53s/it]Best trial: 14. Best value: 0.580629:  22%|██▏       | 22/100 [02:35<08:28,  6.53s/it]Best trial: 14. Best value: 0.580629:  23%|██▎       | 23/100 [02:35<07:34,  5.90s/it]Best trial: 14. Best value: 0.580629:  23%|██▎       | 23/100 [02:37<07:34,  5.90s/it]Best trial: 14. Best value: 0.580629:  24%|██▍       | 24/100 [02:37<05:57,  4.70s/it]Best trial: 14. Best value: 0.580629:  24%|██▍       | 24/100 [02:39<05:57,  4.70s/it]Best trial: 14. Best value: 0.580629:  25%|██▌       | 25/100 [02:39<05:09,  4.13s/it]Best trial: 14. Best value: 0.580629:  25%|██▌       | 25/100 [02:54<05:09,  4.13s/it]Best trial: 14. Best value: 0.580629:  26%|██▌       | 26/100 [02:54<08:50,  7.17s/it]Best trial: 14. Best value: 0.580629:  26%|██▌       | 26/100 [03:00<08:50,  7.17s/it]Best trial: 14. Best value: 0.580629:  27%|██▋       | 27/100 [03:00<08:30,  6.99s/it]Best trial: 14. Best value: 0.580629:  27%|██▋       | 27/100 [03:06<08:30,  6.99s/it]Best trial: 14. Best value: 0.580629:  28%|██▊       | 28/100 [03:06<08:03,  6.71s/it]Best trial: 14. Best value: 0.580629:  28%|██▊       | 28/100 [03:09<08:03,  6.71s/it]Best trial: 14. Best value: 0.580629:  29%|██▉       | 29/100 [03:09<06:28,  5.48s/it]Best trial: 14. Best value: 0.580629:  29%|██▉       | 29/100 [03:15<06:28,  5.48s/it]Best trial: 14. Best value: 0.580629:  30%|███       | 30/100 [03:15<06:44,  5.78s/it]Best trial: 30. Best value: 0.582982:  30%|███       | 30/100 [03:22<06:44,  5.78s/it]Best trial: 30. Best value: 0.582982:  31%|███       | 31/100 [03:22<06:54,  6.00s/it]Best trial: 31. Best value: 0.587422:  31%|███       | 31/100 [03:29<06:54,  6.00s/it]Best trial: 31. Best value: 0.587422:  32%|███▏      | 32/100 [03:29<07:14,  6.39s/it]Best trial: 31. Best value: 0.587422:  32%|███▏      | 32/100 [03:35<07:14,  6.39s/it]Best trial: 31. Best value: 0.587422:  33%|███▎      | 33/100 [03:35<06:56,  6.21s/it]Best trial: 31. Best value: 0.587422:  33%|███▎      | 33/100 [03:44<06:56,  6.21s/it]Best trial: 31. Best value: 0.587422:  34%|███▍      | 34/100 [03:44<07:40,  6.98s/it]Best trial: 31. Best value: 0.587422:  34%|███▍      | 34/100 [03:51<07:40,  6.98s/it]Best trial: 31. Best value: 0.587422:  35%|███▌      | 35/100 [03:51<07:30,  6.92s/it]Best trial: 31. Best value: 0.587422:  35%|███▌      | 35/100 [03:58<07:30,  6.92s/it]Best trial: 31. Best value: 0.587422:  36%|███▌      | 36/100 [03:58<07:38,  7.17s/it]Best trial: 31. Best value: 0.587422:  36%|███▌      | 36/100 [04:14<07:38,  7.17s/it]Best trial: 31. Best value: 0.587422:  37%|███▋      | 37/100 [04:14<10:21,  9.86s/it]Best trial: 31. Best value: 0.587422:  37%|███▋      | 37/100 [04:30<10:21,  9.86s/it]Best trial: 31. Best value: 0.587422:  38%|███▊      | 38/100 [04:30<11:58, 11.58s/it]Best trial: 31. Best value: 0.587422:  38%|███▊      | 38/100 [04:40<11:58, 11.58s/it]Best trial: 31. Best value: 0.587422:  39%|███▉      | 39/100 [04:40<11:22, 11.19s/it]Best trial: 31. Best value: 0.587422:  39%|███▉      | 39/100 [04:48<11:22, 11.19s/it]Best trial: 31. Best value: 0.587422:  40%|████      | 40/100 [04:48<10:15, 10.25s/it]Best trial: 31. Best value: 0.587422:  40%|████      | 40/100 [04:57<10:15, 10.25s/it]Best trial: 31. Best value: 0.587422:  41%|████      | 41/100 [04:57<09:29,  9.65s/it]Best trial: 31. Best value: 0.587422:  41%|████      | 41/100 [05:02<09:29,  9.65s/it]Best trial: 31. Best value: 0.587422:  42%|████▏     | 42/100 [05:02<08:03,  8.33s/it]Best trial: 31. Best value: 0.587422:  42%|████▏     | 42/100 [05:07<08:03,  8.33s/it]Best trial: 31. Best value: 0.587422:  43%|████▎     | 43/100 [05:07<07:08,  7.52s/it]Best trial: 31. Best value: 0.587422:  43%|████▎     | 43/100 [05:11<07:08,  7.52s/it]Best trial: 31. Best value: 0.587422:  44%|████▍     | 44/100 [05:11<05:50,  6.26s/it]Best trial: 31. Best value: 0.587422:  44%|████▍     | 44/100 [05:18<05:50,  6.26s/it]Best trial: 31. Best value: 0.587422:  45%|████▌     | 45/100 [05:18<05:54,  6.44s/it]Best trial: 31. Best value: 0.587422:  45%|████▌     | 45/100 [05:22<05:54,  6.44s/it]Best trial: 31. Best value: 0.587422:  46%|████▌     | 46/100 [05:22<05:21,  5.95s/it]Best trial: 31. Best value: 0.587422:  46%|████▌     | 46/100 [05:30<05:21,  5.95s/it]Best trial: 31. Best value: 0.587422:  47%|████▋     | 47/100 [05:30<05:34,  6.32s/it]Best trial: 31. Best value: 0.587422:  47%|████▋     | 47/100 [05:34<05:34,  6.32s/it]Best trial: 31. Best value: 0.587422:  48%|████▊     | 48/100 [05:34<04:53,  5.65s/it]Best trial: 31. Best value: 0.587422:  48%|████▊     | 48/100 [05:41<04:53,  5.65s/it]Best trial: 31. Best value: 0.587422:  49%|████▉     | 49/100 [05:41<05:10,  6.09s/it]Best trial: 31. Best value: 0.587422:  49%|████▉     | 49/100 [05:55<05:10,  6.09s/it]Best trial: 31. Best value: 0.587422:  50%|█████     | 50/100 [05:55<07:06,  8.52s/it]Best trial: 31. Best value: 0.587422:  50%|█████     | 50/100 [06:08<07:06,  8.52s/it]Best trial: 31. Best value: 0.587422:  51%|█████     | 51/100 [06:08<07:59,  9.78s/it]Best trial: 31. Best value: 0.587422:  51%|█████     | 51/100 [06:20<07:59,  9.78s/it]Best trial: 31. Best value: 0.587422:  52%|█████▏    | 52/100 [06:20<08:19, 10.40s/it]Best trial: 31. Best value: 0.587422:  52%|█████▏    | 52/100 [06:27<08:19, 10.40s/it]Best trial: 31. Best value: 0.587422:  53%|█████▎    | 53/100 [06:27<07:26,  9.51s/it]Best trial: 31. Best value: 0.587422:  53%|█████▎    | 53/100 [06:35<07:26,  9.51s/it]Best trial: 31. Best value: 0.587422:  54%|█████▍    | 54/100 [06:35<06:51,  8.94s/it]Best trial: 31. Best value: 0.587422:  54%|█████▍    | 54/100 [06:45<06:51,  8.94s/it]Best trial: 31. Best value: 0.587422:  55%|█████▌    | 55/100 [06:45<07:02,  9.39s/it]Best trial: 31. Best value: 0.587422:  55%|█████▌    | 55/100 [06:56<07:02,  9.39s/it]Best trial: 31. Best value: 0.587422:  56%|█████▌    | 56/100 [06:56<07:09,  9.77s/it]Best trial: 31. Best value: 0.587422:  56%|█████▌    | 56/100 [07:10<07:09,  9.77s/it]Best trial: 31. Best value: 0.587422:  57%|█████▋    | 57/100 [07:10<07:52, 10.99s/it]Best trial: 31. Best value: 0.587422:  57%|█████▋    | 57/100 [07:19<07:52, 10.99s/it]Best trial: 31. Best value: 0.587422:  58%|█████▊    | 58/100 [07:19<07:21, 10.50s/it]Best trial: 31. Best value: 0.587422:  58%|█████▊    | 58/100 [07:27<07:21, 10.50s/it]Best trial: 31. Best value: 0.587422:  59%|█████▉    | 59/100 [07:27<06:36,  9.67s/it]Best trial: 31. Best value: 0.587422:  59%|█████▉    | 59/100 [07:31<06:36,  9.67s/it]Best trial: 31. Best value: 0.587422:  60%|██████    | 60/100 [07:31<05:27,  8.18s/it]Best trial: 31. Best value: 0.587422:  60%|██████    | 60/100 [07:44<05:27,  8.18s/it]Best trial: 31. Best value: 0.587422:  61%|██████    | 61/100 [07:44<06:11,  9.53s/it]Best trial: 31. Best value: 0.587422:  61%|██████    | 61/100 [07:48<06:11,  9.53s/it]Best trial: 31. Best value: 0.587422:  62%|██████▏   | 62/100 [07:48<05:01,  7.94s/it]Best trial: 31. Best value: 0.587422:  62%|██████▏   | 62/100 [07:51<05:01,  7.94s/it]Best trial: 31. Best value: 0.587422:  63%|██████▎   | 63/100 [07:51<03:52,  6.29s/it]Best trial: 31. Best value: 0.587422:  63%|██████▎   | 63/100 [07:56<03:52,  6.29s/it]Best trial: 31. Best value: 0.587422:  64%|██████▍   | 64/100 [07:56<03:33,  5.92s/it]Best trial: 31. Best value: 0.587422:  64%|██████▍   | 64/100 [08:03<03:33,  5.92s/it]Best trial: 31. Best value: 0.587422:  65%|██████▌   | 65/100 [08:03<03:38,  6.23s/it]Best trial: 31. Best value: 0.587422:  65%|██████▌   | 65/100 [08:05<03:38,  6.23s/it]Best trial: 31. Best value: 0.587422:  66%|██████▌   | 66/100 [08:05<02:52,  5.06s/it]Best trial: 31. Best value: 0.587422:  66%|██████▌   | 66/100 [08:12<02:52,  5.06s/it]Best trial: 31. Best value: 0.587422:  67%|██████▋   | 67/100 [08:12<03:02,  5.53s/it]Best trial: 31. Best value: 0.587422:  67%|██████▋   | 67/100 [08:17<03:02,  5.53s/it]Best trial: 31. Best value: 0.587422:  68%|██████▊   | 68/100 [08:17<02:56,  5.51s/it]Best trial: 31. Best value: 0.587422:  68%|██████▊   | 68/100 [08:23<02:56,  5.51s/it]Best trial: 31. Best value: 0.587422:  69%|██████▉   | 69/100 [08:23<02:51,  5.52s/it]Best trial: 31. Best value: 0.587422:  69%|██████▉   | 69/100 [08:33<02:51,  5.52s/it]Best trial: 31. Best value: 0.587422:  70%|███████   | 70/100 [08:33<03:24,  6.83s/it]Best trial: 31. Best value: 0.587422:  70%|███████   | 70/100 [08:37<03:24,  6.83s/it]Best trial: 31. Best value: 0.587422:  71%|███████   | 71/100 [08:37<02:54,  6.03s/it]Best trial: 31. Best value: 0.587422:  71%|███████   | 71/100 [08:40<02:54,  6.03s/it]Best trial: 31. Best value: 0.587422:  72%|███████▏  | 72/100 [08:40<02:27,  5.26s/it]Best trial: 31. Best value: 0.587422:  72%|███████▏  | 72/100 [08:45<02:27,  5.26s/it]Best trial: 31. Best value: 0.587422:  73%|███████▎  | 73/100 [08:45<02:19,  5.17s/it]Best trial: 31. Best value: 0.587422:  73%|███████▎  | 73/100 [08:48<02:19,  5.17s/it]Best trial: 31. Best value: 0.587422:  74%|███████▍  | 74/100 [08:48<01:54,  4.41s/it]Best trial: 31. Best value: 0.587422:  74%|███████▍  | 74/100 [08:54<01:54,  4.41s/it]Best trial: 31. Best value: 0.587422:  75%|███████▌  | 75/100 [08:54<02:03,  4.93s/it]Best trial: 31. Best value: 0.587422:  75%|███████▌  | 75/100 [08:59<02:03,  4.93s/it]Best trial: 31. Best value: 0.587422:  76%|███████▌  | 76/100 [08:59<02:01,  5.07s/it]Best trial: 31. Best value: 0.587422:  76%|███████▌  | 76/100 [09:06<02:01,  5.07s/it]Best trial: 31. Best value: 0.587422:  77%|███████▋  | 77/100 [09:06<02:09,  5.63s/it]Best trial: 31. Best value: 0.587422:  77%|███████▋  | 77/100 [09:10<02:09,  5.63s/it]Best trial: 31. Best value: 0.587422:  78%|███████▊  | 78/100 [09:10<01:53,  5.16s/it]Best trial: 31. Best value: 0.587422:  78%|███████▊  | 78/100 [09:15<01:53,  5.16s/it]Best trial: 31. Best value: 0.587422:  79%|███████▉  | 79/100 [09:15<01:45,  5.00s/it]Best trial: 31. Best value: 0.587422:  79%|███████▉  | 79/100 [09:31<01:45,  5.00s/it]Best trial: 31. Best value: 0.587422:  80%|████████  | 80/100 [09:31<02:46,  8.31s/it]Best trial: 31. Best value: 0.587422:  80%|████████  | 80/100 [09:45<02:46,  8.31s/it]Best trial: 31. Best value: 0.587422:  81%|████████  | 81/100 [09:45<03:09,  9.99s/it]Best trial: 31. Best value: 0.587422:  81%|████████  | 81/100 [10:04<03:09,  9.99s/it]Best trial: 31. Best value: 0.587422:  82%|████████▏ | 82/100 [10:04<03:48, 12.70s/it]Best trial: 31. Best value: 0.587422:  82%|████████▏ | 82/100 [10:23<03:48, 12.70s/it]Best trial: 31. Best value: 0.587422:  83%|████████▎ | 83/100 [10:23<04:10, 14.72s/it]Best trial: 31. Best value: 0.587422:  83%|████████▎ | 83/100 [11:04<04:10, 14.72s/it]Best trial: 31. Best value: 0.587422:  84%|████████▍ | 84/100 [11:04<06:00, 22.56s/it]Best trial: 31. Best value: 0.587422:  84%|████████▍ | 84/100 [11:38<06:00, 22.56s/it]Best trial: 31. Best value: 0.587422:  85%|████████▌ | 85/100 [11:38<06:30, 26.04s/it]Best trial: 31. Best value: 0.587422:  85%|████████▌ | 85/100 [12:00<06:30, 26.04s/it]Best trial: 31. Best value: 0.587422:  86%|████████▌ | 86/100 [12:00<05:47, 24.80s/it]Best trial: 31. Best value: 0.587422:  86%|████████▌ | 86/100 [12:21<05:47, 24.80s/it]Best trial: 31. Best value: 0.587422:  87%|████████▋ | 87/100 [12:21<05:07, 23.65s/it]Best trial: 31. Best value: 0.587422:  87%|████████▋ | 87/100 [12:37<05:07, 23.65s/it]Best trial: 31. Best value: 0.587422:  88%|████████▊ | 88/100 [12:37<04:15, 21.32s/it]Best trial: 31. Best value: 0.587422:  88%|████████▊ | 88/100 [13:06<04:15, 21.32s/it]Best trial: 31. Best value: 0.587422:  89%|████████▉ | 89/100 [13:06<04:18, 23.48s/it]Best trial: 31. Best value: 0.587422:  89%|████████▉ | 89/100 [13:44<04:18, 23.48s/it]Best trial: 31. Best value: 0.587422:  90%|█████████ | 90/100 [13:44<04:39, 27.98s/it]Best trial: 31. Best value: 0.587422:  90%|█████████ | 90/100 [13:57<04:39, 27.98s/it]Best trial: 31. Best value: 0.587422:  91%|█████████ | 91/100 [13:57<03:31, 23.55s/it]Best trial: 31. Best value: 0.587422:  91%|█████████ | 91/100 [14:19<03:31, 23.55s/it]Best trial: 31. Best value: 0.587422:  92%|█████████▏| 92/100 [14:19<03:03, 22.88s/it]Best trial: 31. Best value: 0.587422:  92%|█████████▏| 92/100 [14:27<03:03, 22.88s/it]Best trial: 31. Best value: 0.587422:  93%|█████████▎| 93/100 [14:27<02:09, 18.56s/it]Best trial: 31. Best value: 0.587422:  93%|█████████▎| 93/100 [14:35<02:09, 18.56s/it]Best trial: 31. Best value: 0.587422:  94%|█████████▍| 94/100 [14:35<01:32, 15.46s/it]Best trial: 31. Best value: 0.587422:  94%|█████████▍| 94/100 [14:45<01:32, 15.46s/it]Best trial: 31. Best value: 0.587422:  95%|█████████▌| 95/100 [14:45<01:07, 13.58s/it]Best trial: 31. Best value: 0.587422:  95%|█████████▌| 95/100 [15:03<01:07, 13.58s/it]Best trial: 31. Best value: 0.587422:  96%|█████████▌| 96/100 [15:03<00:59, 14.96s/it]Best trial: 31. Best value: 0.587422:  96%|█████████▌| 96/100 [15:09<00:59, 14.96s/it]Best trial: 31. Best value: 0.587422:  97%|█████████▋| 97/100 [15:09<00:36, 12.27s/it]Best trial: 31. Best value: 0.587422:  97%|█████████▋| 97/100 [15:16<00:36, 12.27s/it]Best trial: 31. Best value: 0.587422:  98%|█████████▊| 98/100 [15:16<00:21, 10.70s/it]Best trial: 31. Best value: 0.587422:  98%|█████████▊| 98/100 [15:36<00:21, 10.70s/it]Best trial: 31. Best value: 0.587422:  99%|█████████▉| 99/100 [15:36<00:13, 13.66s/it]Best trial: 31. Best value: 0.587422:  99%|█████████▉| 99/100 [15:58<00:13, 13.66s/it]Best trial: 31. Best value: 0.587422: 100%|██████████| 100/100 [15:58<00:00, 16.16s/it]Best trial: 31. Best value: 0.587422: 100%|██████████| 100/100 [15:58<00:00,  9.59s/it]
2025-12-01 03:11:02,346 - INFO - HPO Complete. Best AUPRC: 0.5874
2025-12-01 03:11:02,346 - INFO - Best Params: {'n_estimators': 1000, 'learning_rate': 0.06475387135881285, 'max_depth': 8, 'subsample': 0.9363490917863001, 'colsample_bytree': 0.8322245598152738, 'gamma': 0.31991431494343514, 'reg_lambda': 7.682704439686024e-05, 'reg_alpha': 0.0015972452526239458}
2025-12-01 03:11:02,347 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/awp_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 03:11:04,237 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: awp_only
2025-12-01 03:11:04,237 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 03:11:04,435 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 03:11:04,455 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 03:11:04,459 - INFO - Data prepared. Train shape: (2761, 96), Test shape: (692, 96)
2025-12-01 03:11:04,459 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 03:11:04,459 - INFO - Training model...
2025-12-01 03:11:07,151 - INFO - Evaluating model with bootstrapping...
2025-12-01 03:11:12,101 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 03:11:12,101 - INFO - AUROC: 0.7775 (0.7208 - 0.8121)
2025-12-01 03:11:12,101 - INFO - AUPRC: 0.5344 (0.4590 - 0.6377)
2025-12-01 03:11:12,101 - INFO - Brier Score: 0.1342 (0.1201 - 0.1516)
2025-12-01 03:11:12,101 - INFO - Accuracy: 0.8367 (0.7899 - 0.8598)
2025-12-01 03:11:12,101 - INFO - Precision: 0.6293 (0.5079 - 0.7341)
2025-12-01 03:11:12,101 - INFO - Sensitivity (Recall): 0.5105 (0.4739 - 0.6260)
2025-12-01 03:11:12,101 - INFO - F1-Score: 0.5637 (0.5175 - 0.6406)
2025-12-01 03:11:12,101 - INFO - Best Threshold: 0.4100 (0.2000 - 0.4100)
2025-12-01 03:11:12,101 - INFO - Specificity: 0.9217 (0.8462 - 0.9449)
2025-12-01 03:11:12,121 - INFO - Calculating SHAP values...
2025-12-01 03:11:13,407 - INFO - SHAP plots saved.
2025-12-01 03:11:13,408 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/awp_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 03:11:14,585 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: all_waveforms
2025-12-01 03:11:14,585 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 03:11:14,780 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 03:11:14,849 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 03:11:14,861 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-12-01 03:11:14,861 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.569726:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.569726:   1%|          | 1/100 [00:07<12:00,  7.27s/it]Best trial: 1. Best value: 0.596226:   1%|          | 1/100 [01:00<12:00,  7.27s/it]Best trial: 1. Best value: 0.596226:   2%|▏         | 2/100 [01:00<56:03, 34.33s/it]Best trial: 2. Best value: 0.634211:   2%|▏         | 2/100 [01:59<56:03, 34.33s/it]Best trial: 2. Best value: 0.634211:   3%|▎         | 3/100 [01:59<1:13:35, 45.52s/it]Best trial: 2. Best value: 0.634211:   3%|▎         | 3/100 [02:08<1:13:35, 45.52s/it]Best trial: 2. Best value: 0.634211:   4%|▍         | 4/100 [02:08<49:44, 31.09s/it]  Best trial: 2. Best value: 0.634211:   4%|▍         | 4/100 [02:28<49:44, 31.09s/it]Best trial: 2. Best value: 0.634211:   5%|▌         | 5/100 [02:28<42:53, 27.09s/it]Best trial: 2. Best value: 0.634211:   5%|▌         | 5/100 [03:20<42:53, 27.09s/it]Best trial: 2. Best value: 0.634211:   6%|▌         | 6/100 [03:20<56:02, 35.77s/it]Best trial: 2. Best value: 0.634211:   6%|▌         | 6/100 [03:46<56:02, 35.77s/it]Best trial: 2. Best value: 0.634211:   7%|▋         | 7/100 [03:46<50:04, 32.31s/it]Best trial: 2. Best value: 0.634211:   7%|▋         | 7/100 [04:26<50:04, 32.31s/it]Best trial: 2. Best value: 0.634211:   8%|▊         | 8/100 [04:26<53:31, 34.91s/it]Best trial: 2. Best value: 0.634211:   8%|▊         | 8/100 [05:01<53:31, 34.91s/it]Best trial: 2. Best value: 0.634211:   9%|▉         | 9/100 [05:01<52:44, 34.77s/it]Best trial: 2. Best value: 0.634211:   9%|▉         | 9/100 [05:51<52:44, 34.77s/it]Best trial: 2. Best value: 0.634211:  10%|█         | 10/100 [05:51<59:28, 39.65s/it]Best trial: 2. Best value: 0.634211:  10%|█         | 10/100 [06:09<59:28, 39.65s/it]Best trial: 2. Best value: 0.634211:  11%|█         | 11/100 [06:09<48:57, 33.01s/it]Best trial: 2. Best value: 0.634211:  11%|█         | 11/100 [06:24<48:57, 33.01s/it]Best trial: 2. Best value: 0.634211:  12%|█▏        | 12/100 [06:24<40:15, 27.45s/it]Best trial: 2. Best value: 0.634211:  12%|█▏        | 12/100 [06:39<40:15, 27.45s/it]Best trial: 2. Best value: 0.634211:  13%|█▎        | 13/100 [06:39<34:30, 23.80s/it]Best trial: 13. Best value: 0.644153:  13%|█▎        | 13/100 [07:01<34:30, 23.80s/it]Best trial: 13. Best value: 0.644153:  14%|█▍        | 14/100 [07:01<33:08, 23.13s/it]Best trial: 13. Best value: 0.644153:  14%|█▍        | 14/100 [07:23<33:08, 23.13s/it]Best trial: 13. Best value: 0.644153:  15%|█▌        | 15/100 [07:23<32:30, 22.95s/it]Best trial: 13. Best value: 0.644153:  15%|█▌        | 15/100 [07:51<32:30, 22.95s/it]Best trial: 13. Best value: 0.644153:  16%|█▌        | 16/100 [07:51<33:55, 24.23s/it]Best trial: 13. Best value: 0.644153:  16%|█▌        | 16/100 [08:05<33:55, 24.23s/it]Best trial: 13. Best value: 0.644153:  17%|█▋        | 17/100 [08:05<29:15, 21.15s/it]Best trial: 17. Best value: 0.644982:  17%|█▋        | 17/100 [08:19<29:15, 21.15s/it]Best trial: 17. Best value: 0.644982:  18%|█▊        | 18/100 [08:19<26:14, 19.20s/it]Best trial: 17. Best value: 0.644982:  18%|█▊        | 18/100 [08:30<26:14, 19.20s/it]Best trial: 17. Best value: 0.644982:  19%|█▉        | 19/100 [08:30<22:23, 16.58s/it]Best trial: 17. Best value: 0.644982:  19%|█▉        | 19/100 [08:47<22:23, 16.58s/it]Best trial: 17. Best value: 0.644982:  20%|██        | 20/100 [08:47<22:26, 16.83s/it]Best trial: 17. Best value: 0.644982:  20%|██        | 20/100 [09:17<22:26, 16.83s/it]Best trial: 17. Best value: 0.644982:  21%|██        | 21/100 [09:17<27:14, 20.69s/it]Best trial: 17. Best value: 0.644982:  21%|██        | 21/100 [09:30<27:14, 20.69s/it]Best trial: 17. Best value: 0.644982:  22%|██▏       | 22/100 [09:30<24:04, 18.52s/it]Best trial: 22. Best value: 0.647324:  22%|██▏       | 22/100 [09:42<24:04, 18.52s/it]Best trial: 22. Best value: 0.647324:  23%|██▎       | 23/100 [09:42<21:04, 16.42s/it]Best trial: 23. Best value: 0.649316:  23%|██▎       | 23/100 [09:58<21:04, 16.42s/it]Best trial: 23. Best value: 0.649316:  24%|██▍       | 24/100 [09:58<20:48, 16.43s/it]Best trial: 24. Best value: 0.650966:  24%|██▍       | 24/100 [10:15<20:48, 16.43s/it]Best trial: 24. Best value: 0.650966:  25%|██▌       | 25/100 [10:15<20:33, 16.44s/it]Best trial: 24. Best value: 0.650966:  25%|██▌       | 25/100 [10:28<20:33, 16.44s/it]Best trial: 24. Best value: 0.650966:  26%|██▌       | 26/100 [10:28<19:00, 15.42s/it]Best trial: 24. Best value: 0.650966:  26%|██▌       | 26/100 [10:49<19:00, 15.42s/it]Best trial: 24. Best value: 0.650966:  27%|██▋       | 27/100 [10:49<20:56, 17.21s/it]Best trial: 24. Best value: 0.650966:  27%|██▋       | 27/100 [11:06<20:56, 17.21s/it]Best trial: 24. Best value: 0.650966:  28%|██▊       | 28/100 [11:06<20:30, 17.09s/it]Best trial: 24. Best value: 0.650966:  28%|██▊       | 28/100 [11:26<20:30, 17.09s/it]Best trial: 24. Best value: 0.650966:  29%|██▉       | 29/100 [11:26<21:06, 17.84s/it]Best trial: 24. Best value: 0.650966:  29%|██▉       | 29/100 [11:33<21:06, 17.84s/it]Best trial: 24. Best value: 0.650966:  30%|███       | 30/100 [11:33<17:15, 14.79s/it]Best trial: 24. Best value: 0.650966:  30%|███       | 30/100 [11:59<17:15, 14.79s/it]Best trial: 24. Best value: 0.650966:  31%|███       | 31/100 [11:59<20:38, 17.95s/it]Best trial: 24. Best value: 0.650966:  31%|███       | 31/100 [12:10<20:38, 17.95s/it]Best trial: 24. Best value: 0.650966:  32%|███▏      | 32/100 [12:10<18:17, 16.14s/it]Best trial: 24. Best value: 0.650966:  32%|███▏      | 32/100 [12:20<18:17, 16.14s/it]Best trial: 24. Best value: 0.650966:  33%|███▎      | 33/100 [12:20<15:43, 14.08s/it]Best trial: 24. Best value: 0.650966:  33%|███▎      | 33/100 [12:53<15:43, 14.08s/it]Best trial: 24. Best value: 0.650966:  34%|███▍      | 34/100 [12:53<21:56, 19.94s/it]Best trial: 24. Best value: 0.650966:  34%|███▍      | 34/100 [13:08<21:56, 19.94s/it]Best trial: 24. Best value: 0.650966:  35%|███▌      | 35/100 [13:08<19:51, 18.33s/it]Best trial: 24. Best value: 0.650966:  35%|███▌      | 35/100 [13:26<19:51, 18.33s/it]Best trial: 24. Best value: 0.650966:  36%|███▌      | 36/100 [13:26<19:24, 18.20s/it]Best trial: 24. Best value: 0.650966:  36%|███▌      | 36/100 [14:09<19:24, 18.20s/it]Best trial: 24. Best value: 0.650966:  37%|███▋      | 37/100 [14:09<26:58, 25.69s/it]Best trial: 24. Best value: 0.650966:  37%|███▋      | 37/100 [14:23<26:58, 25.69s/it]Best trial: 24. Best value: 0.650966:  38%|███▊      | 38/100 [14:23<22:56, 22.20s/it]Best trial: 24. Best value: 0.650966:  38%|███▊      | 38/100 [14:53<22:56, 22.20s/it]Best trial: 24. Best value: 0.650966:  39%|███▉      | 39/100 [14:53<25:05, 24.68s/it]Best trial: 24. Best value: 0.650966:  39%|███▉      | 39/100 [15:15<25:05, 24.68s/it]Best trial: 24. Best value: 0.650966:  40%|████      | 40/100 [15:15<23:41, 23.69s/it]Best trial: 24. Best value: 0.650966:  40%|████      | 40/100 [15:27<23:41, 23.69s/it]Best trial: 24. Best value: 0.650966:  41%|████      | 41/100 [15:27<20:01, 20.37s/it]Best trial: 24. Best value: 0.650966:  41%|████      | 41/100 [16:09<20:01, 20.37s/it]Best trial: 24. Best value: 0.650966:  42%|████▏     | 42/100 [16:09<25:48, 26.70s/it]Best trial: 24. Best value: 0.650966:  42%|████▏     | 42/100 [16:30<25:48, 26.70s/it]Best trial: 24. Best value: 0.650966:  43%|████▎     | 43/100 [16:30<23:44, 24.99s/it]Best trial: 24. Best value: 0.650966:  43%|████▎     | 43/100 [16:48<23:44, 24.99s/it]Best trial: 24. Best value: 0.650966:  44%|████▍     | 44/100 [16:48<21:28, 23.01s/it]Best trial: 24. Best value: 0.650966:  44%|████▍     | 44/100 [17:34<21:28, 23.01s/it]Best trial: 24. Best value: 0.650966:  45%|████▌     | 45/100 [17:34<27:25, 29.92s/it]Best trial: 45. Best value: 0.654024:  45%|████▌     | 45/100 [17:52<27:25, 29.92s/it]Best trial: 45. Best value: 0.654024:  46%|████▌     | 46/100 [17:52<23:31, 26.14s/it]Best trial: 46. Best value: 0.660147:  46%|████▌     | 46/100 [18:10<23:31, 26.14s/it]Best trial: 46. Best value: 0.660147:  47%|████▋     | 47/100 [18:10<21:05, 23.87s/it]Best trial: 46. Best value: 0.660147:  47%|████▋     | 47/100 [18:28<21:05, 23.87s/it]Best trial: 46. Best value: 0.660147:  48%|████▊     | 48/100 [18:28<19:03, 22.00s/it]Best trial: 46. Best value: 0.660147:  48%|████▊     | 48/100 [18:48<19:03, 22.00s/it]Best trial: 46. Best value: 0.660147:  49%|████▉     | 49/100 [18:48<18:15, 21.47s/it]Best trial: 46. Best value: 0.660147:  49%|████▉     | 49/100 [19:07<18:15, 21.47s/it]Best trial: 46. Best value: 0.660147:  50%|█████     | 50/100 [19:07<17:11, 20.64s/it]Best trial: 46. Best value: 0.660147:  50%|█████     | 50/100 [19:26<17:11, 20.64s/it]Best trial: 46. Best value: 0.660147:  51%|█████     | 51/100 [19:26<16:34, 20.30s/it]Best trial: 46. Best value: 0.660147:  51%|█████     | 51/100 [19:44<16:34, 20.30s/it]Best trial: 46. Best value: 0.660147:  52%|█████▏    | 52/100 [19:44<15:41, 19.62s/it]Best trial: 46. Best value: 0.660147:  52%|█████▏    | 52/100 [20:00<15:41, 19.62s/it]Best trial: 46. Best value: 0.660147:  53%|█████▎    | 53/100 [20:00<14:19, 18.29s/it]Best trial: 46. Best value: 0.660147:  53%|█████▎    | 53/100 [20:13<14:19, 18.29s/it]Best trial: 46. Best value: 0.660147:  54%|█████▍    | 54/100 [20:13<12:58, 16.93s/it]Best trial: 46. Best value: 0.660147:  54%|█████▍    | 54/100 [20:29<12:58, 16.93s/it]Best trial: 46. Best value: 0.660147:  55%|█████▌    | 55/100 [20:29<12:22, 16.50s/it]Best trial: 46. Best value: 0.660147:  55%|█████▌    | 55/100 [20:51<12:22, 16.50s/it]Best trial: 46. Best value: 0.660147:  56%|█████▌    | 56/100 [20:51<13:22, 18.25s/it]Best trial: 46. Best value: 0.660147:  56%|█████▌    | 56/100 [21:10<13:22, 18.25s/it]Best trial: 46. Best value: 0.660147:  57%|█████▋    | 57/100 [21:10<13:11, 18.42s/it]Best trial: 46. Best value: 0.660147:  57%|█████▋    | 57/100 [21:36<13:11, 18.42s/it]Best trial: 46. Best value: 0.660147:  58%|█████▊    | 58/100 [21:36<14:24, 20.57s/it]Best trial: 46. Best value: 0.660147:  58%|█████▊    | 58/100 [22:08<14:24, 20.57s/it]Best trial: 46. Best value: 0.660147:  59%|█████▉    | 59/100 [22:08<16:28, 24.12s/it]Best trial: 46. Best value: 0.660147:  59%|█████▉    | 59/100 [22:33<16:28, 24.12s/it]Best trial: 46. Best value: 0.660147:  60%|██████    | 60/100 [22:33<16:19, 24.48s/it]Best trial: 46. Best value: 0.660147:  60%|██████    | 60/100 [22:49<16:19, 24.48s/it]Best trial: 46. Best value: 0.660147:  61%|██████    | 61/100 [22:49<14:17, 21.99s/it]Best trial: 46. Best value: 0.660147:  61%|██████    | 61/100 [23:04<14:17, 21.99s/it]Best trial: 46. Best value: 0.660147:  62%|██████▏   | 62/100 [23:04<12:28, 19.69s/it]Best trial: 46. Best value: 0.660147:  62%|██████▏   | 62/100 [23:14<12:28, 19.69s/it]Best trial: 46. Best value: 0.660147:  63%|██████▎   | 63/100 [23:14<10:18, 16.72s/it]Best trial: 46. Best value: 0.660147:  63%|██████▎   | 63/100 [23:45<10:18, 16.72s/it]Best trial: 46. Best value: 0.660147:  64%|██████▍   | 64/100 [23:45<12:43, 21.20s/it]Best trial: 46. Best value: 0.660147:  64%|██████▍   | 64/100 [24:01<12:43, 21.20s/it]Best trial: 46. Best value: 0.660147:  65%|██████▌   | 65/100 [24:01<11:24, 19.56s/it]Best trial: 46. Best value: 0.660147:  65%|██████▌   | 65/100 [24:17<11:24, 19.56s/it]Best trial: 46. Best value: 0.660147:  66%|██████▌   | 66/100 [24:17<10:30, 18.56s/it]Best trial: 46. Best value: 0.660147:  66%|██████▌   | 66/100 [24:48<10:30, 18.56s/it]Best trial: 46. Best value: 0.660147:  67%|██████▋   | 67/100 [24:48<12:16, 22.32s/it]Best trial: 46. Best value: 0.660147:  67%|██████▋   | 67/100 [25:03<12:16, 22.32s/it]Best trial: 46. Best value: 0.660147:  68%|██████▊   | 68/100 [25:03<10:39, 19.99s/it]Best trial: 46. Best value: 0.660147:  68%|██████▊   | 68/100 [25:16<10:39, 19.99s/it]Best trial: 46. Best value: 0.660147:  69%|██████▉   | 69/100 [25:16<09:18, 18.00s/it]Best trial: 46. Best value: 0.660147:  69%|██████▉   | 69/100 [25:31<09:18, 18.00s/it]Best trial: 46. Best value: 0.660147:  70%|███████   | 70/100 [25:31<08:34, 17.13s/it]Best trial: 46. Best value: 0.660147:  70%|███████   | 70/100 [25:52<08:34, 17.13s/it]Best trial: 46. Best value: 0.660147:  71%|███████   | 71/100 [25:52<08:44, 18.08s/it]Best trial: 46. Best value: 0.660147:  71%|███████   | 71/100 [26:09<08:44, 18.08s/it]Best trial: 46. Best value: 0.660147:  72%|███████▏  | 72/100 [26:09<08:23, 17.99s/it]Best trial: 46. Best value: 0.660147:  72%|███████▏  | 72/100 [26:27<08:23, 17.99s/it]Best trial: 46. Best value: 0.660147:  73%|███████▎  | 73/100 [26:27<07:59, 17.78s/it]Best trial: 46. Best value: 0.660147:  73%|███████▎  | 73/100 [26:45<07:59, 17.78s/it]Best trial: 46. Best value: 0.660147:  74%|███████▍  | 74/100 [26:45<07:50, 18.09s/it]Best trial: 46. Best value: 0.660147:  74%|███████▍  | 74/100 [27:06<07:50, 18.09s/it]Best trial: 46. Best value: 0.660147:  75%|███████▌  | 75/100 [27:06<07:47, 18.70s/it]Best trial: 46. Best value: 0.660147:  75%|███████▌  | 75/100 [27:29<07:47, 18.70s/it]Best trial: 46. Best value: 0.660147:  76%|███████▌  | 76/100 [27:29<07:59, 19.99s/it]Best trial: 46. Best value: 0.660147:  76%|███████▌  | 76/100 [27:56<07:59, 19.99s/it]Best trial: 46. Best value: 0.660147:  77%|███████▋  | 77/100 [27:56<08:34, 22.36s/it]Best trial: 46. Best value: 0.660147:  77%|███████▋  | 77/100 [28:08<08:34, 22.36s/it]Best trial: 46. Best value: 0.660147:  78%|███████▊  | 78/100 [28:08<07:00, 19.09s/it]Best trial: 46. Best value: 0.660147:  78%|███████▊  | 78/100 [28:36<07:00, 19.09s/it]Best trial: 46. Best value: 0.660147:  79%|███████▉  | 79/100 [28:36<07:37, 21.77s/it]Best trial: 46. Best value: 0.660147:  79%|███████▉  | 79/100 [28:59<07:37, 21.77s/it]Best trial: 46. Best value: 0.660147:  80%|████████  | 80/100 [28:59<07:23, 22.16s/it]Best trial: 46. Best value: 0.660147:  80%|████████  | 80/100 [29:14<07:23, 22.16s/it]Best trial: 46. Best value: 0.660147:  81%|████████  | 81/100 [29:14<06:20, 20.04s/it]Best trial: 46. Best value: 0.660147:  81%|████████  | 81/100 [29:27<06:20, 20.04s/it]Best trial: 46. Best value: 0.660147:  82%|████████▏ | 82/100 [29:27<05:22, 17.92s/it]Best trial: 46. Best value: 0.660147:  82%|████████▏ | 82/100 [29:39<05:22, 17.92s/it]Best trial: 46. Best value: 0.660147:  83%|████████▎ | 83/100 [29:39<04:32, 16.05s/it]Best trial: 46. Best value: 0.660147:  83%|████████▎ | 83/100 [30:14<04:32, 16.05s/it]Best trial: 46. Best value: 0.660147:  84%|████████▍ | 84/100 [30:14<05:50, 21.89s/it]Best trial: 46. Best value: 0.660147:  84%|████████▍ | 84/100 [30:30<05:50, 21.89s/it]Best trial: 46. Best value: 0.660147:  85%|████████▌ | 85/100 [30:30<04:59, 19.99s/it]Best trial: 46. Best value: 0.660147:  85%|████████▌ | 85/100 [30:48<04:59, 19.99s/it]Best trial: 46. Best value: 0.660147:  86%|████████▌ | 86/100 [30:48<04:32, 19.48s/it]Best trial: 46. Best value: 0.660147:  86%|████████▌ | 86/100 [31:04<04:32, 19.48s/it]Best trial: 46. Best value: 0.660147:  87%|████████▋ | 87/100 [31:04<03:57, 18.30s/it]Best trial: 46. Best value: 0.660147:  87%|████████▋ | 87/100 [31:16<03:57, 18.30s/it]Best trial: 46. Best value: 0.660147:  88%|████████▊ | 88/100 [31:16<03:19, 16.63s/it]Best trial: 46. Best value: 0.660147:  88%|████████▊ | 88/100 [31:26<03:19, 16.63s/it]Best trial: 46. Best value: 0.660147:  89%|████████▉ | 89/100 [31:26<02:38, 14.45s/it]Best trial: 46. Best value: 0.660147:  89%|████████▉ | 89/100 [31:37<02:38, 14.45s/it]Best trial: 46. Best value: 0.660147:  90%|█████████ | 90/100 [31:37<02:14, 13.49s/it]Best trial: 46. Best value: 0.660147:  90%|█████████ | 90/100 [31:54<02:14, 13.49s/it]Best trial: 46. Best value: 0.660147:  91%|█████████ | 91/100 [31:54<02:10, 14.47s/it]Best trial: 46. Best value: 0.660147:  91%|█████████ | 91/100 [32:10<02:10, 14.47s/it]Best trial: 46. Best value: 0.660147:  92%|█████████▏| 92/100 [32:10<02:00, 15.11s/it]Best trial: 46. Best value: 0.660147:  92%|█████████▏| 92/100 [32:25<02:00, 15.11s/it]Best trial: 46. Best value: 0.660147:  93%|█████████▎| 93/100 [32:25<01:43, 14.82s/it]Best trial: 46. Best value: 0.660147:  93%|█████████▎| 93/100 [32:35<01:43, 14.82s/it]Best trial: 46. Best value: 0.660147:  94%|█████████▍| 94/100 [32:35<01:21, 13.61s/it]Best trial: 46. Best value: 0.660147:  94%|█████████▍| 94/100 [32:44<01:21, 13.61s/it]Best trial: 46. Best value: 0.660147:  95%|█████████▌| 95/100 [32:44<01:00, 12.14s/it]Best trial: 46. Best value: 0.660147:  95%|█████████▌| 95/100 [33:04<01:00, 12.14s/it]Best trial: 46. Best value: 0.660147:  96%|█████████▌| 96/100 [33:04<00:58, 14.50s/it]Best trial: 46. Best value: 0.660147:  96%|█████████▌| 96/100 [33:23<00:58, 14.50s/it]Best trial: 46. Best value: 0.660147:  97%|█████████▋| 97/100 [33:23<00:47, 15.78s/it]Best trial: 46. Best value: 0.660147:  97%|█████████▋| 97/100 [33:39<00:47, 15.78s/it]Best trial: 46. Best value: 0.660147:  98%|█████████▊| 98/100 [33:39<00:31, 15.92s/it]Best trial: 46. Best value: 0.660147:  98%|█████████▊| 98/100 [33:56<00:31, 15.92s/it]Best trial: 46. Best value: 0.660147:  99%|█████████▉| 99/100 [33:56<00:16, 16.19s/it]Best trial: 46. Best value: 0.660147:  99%|█████████▉| 99/100 [34:39<00:16, 16.19s/it]Best trial: 46. Best value: 0.660147: 100%|██████████| 100/100 [34:39<00:00, 24.38s/it]Best trial: 46. Best value: 0.660147: 100%|██████████| 100/100 [34:39<00:00, 20.80s/it]
2025-12-01 03:45:54,755 - INFO - HPO Complete. Best AUPRC: 0.6601
2025-12-01 03:45:54,755 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.06393816597993483, 'max_depth': 5, 'subsample': 0.68220834593847, 'colsample_bytree': 0.8371084460149135, 'gamma': 0.35747253542250146, 'reg_lambda': 0.8744450578940572, 'reg_alpha': 3.6786206632485647e-06}
2025-12-01 03:45:54,756 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 03:45:56,659 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: all_waveforms
2025-12-01 03:45:56,659 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 03:45:56,856 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 03:45:56,924 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 03:45:56,937 - INFO - Data prepared. Train shape: (2761, 384), Test shape: (692, 384)
2025-12-01 03:45:56,937 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 03:45:56,937 - INFO - Training model...
2025-12-01 03:46:05,265 - INFO - Evaluating model with bootstrapping...
2025-12-01 03:46:11,708 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 03:46:11,708 - INFO - AUROC: 0.8268 (0.7957 - 0.8602)
2025-12-01 03:46:11,708 - INFO - AUPRC: 0.6154 (0.5572 - 0.6852)
2025-12-01 03:46:11,708 - INFO - Brier Score: 0.1253 (0.1144 - 0.1421)
2025-12-01 03:46:11,708 - INFO - Accuracy: 0.8266 (0.7873 - 0.8532)
2025-12-01 03:46:11,708 - INFO - Precision: 0.5697 (0.4831 - 0.6639)
2025-12-01 03:46:11,708 - INFO - Sensitivity (Recall): 0.6573 (0.5370 - 0.7558)
2025-12-01 03:46:11,708 - INFO - F1-Score: 0.6104 (0.5625 - 0.6612)
2025-12-01 03:46:11,708 - INFO - Best Threshold: 0.2500 (0.1500 - 0.4080)
2025-12-01 03:46:11,708 - INFO - Specificity: 0.8707 (0.8014 - 0.9270)
2025-12-01 03:46:11,730 - INFO - Calculating SHAP values...
2025-12-01 03:46:12,969 - INFO - SHAP plots saved.
2025-12-01 03:46:12,970 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_all_waveforms
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 03:46:14,301 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-12-01 03:46:14,301 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 03:46:14,541 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 03:46:14,627 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 03:46:14,658 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-12-01 03:46:14,659 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.642476:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.642476:   1%|          | 1/100 [00:06<10:24,  6.31s/it]Best trial: 1. Best value: 0.667262:   1%|          | 1/100 [00:12<10:24,  6.31s/it]Best trial: 1. Best value: 0.667262:   2%|▏         | 2/100 [00:12<09:57,  6.10s/it]Best trial: 2. Best value: 0.715926:   2%|▏         | 2/100 [01:48<09:57,  6.10s/it]Best trial: 2. Best value: 0.715926:   3%|▎         | 3/100 [01:48<1:16:41, 47.44s/it]Best trial: 3. Best value: 0.721342:   3%|▎         | 3/100 [02:01<1:16:41, 47.44s/it]Best trial: 3. Best value: 0.721342:   4%|▍         | 4/100 [02:01<53:38, 33.52s/it]  Best trial: 4. Best value: 0.722357:   4%|▍         | 4/100 [02:12<53:38, 33.52s/it]Best trial: 4. Best value: 0.722357:   5%|▌         | 5/100 [02:12<40:29, 25.57s/it]Best trial: 4. Best value: 0.722357:   5%|▌         | 5/100 [02:32<40:29, 25.57s/it]Best trial: 4. Best value: 0.722357:   6%|▌         | 6/100 [02:32<37:02, 23.64s/it]Best trial: 4. Best value: 0.722357:   6%|▌         | 6/100 [03:05<37:02, 23.64s/it]Best trial: 4. Best value: 0.722357:   7%|▋         | 7/100 [03:05<41:24, 26.71s/it]Best trial: 4. Best value: 0.722357:   7%|▋         | 7/100 [03:43<41:24, 26.71s/it]Best trial: 4. Best value: 0.722357:   8%|▊         | 8/100 [03:43<46:25, 30.27s/it]Best trial: 4. Best value: 0.722357:   8%|▊         | 8/100 [04:30<46:25, 30.27s/it]Best trial: 4. Best value: 0.722357:   9%|▉         | 9/100 [04:30<53:40, 35.39s/it]Best trial: 4. Best value: 0.722357:   9%|▉         | 9/100 [05:08<53:40, 35.39s/it]Best trial: 4. Best value: 0.722357:  10%|█         | 10/100 [05:08<54:18, 36.20s/it]Best trial: 4. Best value: 0.722357:  10%|█         | 10/100 [05:23<54:18, 36.20s/it]Best trial: 4. Best value: 0.722357:  11%|█         | 11/100 [05:23<44:27, 29.98s/it]Best trial: 4. Best value: 0.722357:  11%|█         | 11/100 [05:36<44:27, 29.98s/it]Best trial: 4. Best value: 0.722357:  12%|█▏        | 12/100 [05:36<36:10, 24.66s/it]Best trial: 4. Best value: 0.722357:  12%|█▏        | 12/100 [05:49<36:10, 24.66s/it]Best trial: 4. Best value: 0.722357:  13%|█▎        | 13/100 [05:49<30:38, 21.13s/it]Best trial: 13. Best value: 0.726303:  13%|█▎        | 13/100 [06:23<30:38, 21.13s/it]Best trial: 13. Best value: 0.726303:  14%|█▍        | 14/100 [06:23<35:58, 25.10s/it]Best trial: 14. Best value: 0.729736:  14%|█▍        | 14/100 [06:56<35:58, 25.10s/it]Best trial: 14. Best value: 0.729736:  15%|█▌        | 15/100 [06:56<38:45, 27.36s/it]Best trial: 14. Best value: 0.729736:  15%|█▌        | 15/100 [07:32<38:45, 27.36s/it]Best trial: 14. Best value: 0.729736:  16%|█▌        | 16/100 [07:32<42:09, 30.11s/it]Best trial: 14. Best value: 0.729736:  16%|█▌        | 16/100 [08:06<42:09, 30.11s/it]Best trial: 14. Best value: 0.729736:  17%|█▋        | 17/100 [08:06<42:59, 31.07s/it]Best trial: 14. Best value: 0.729736:  17%|█▋        | 17/100 [08:28<42:59, 31.07s/it]Best trial: 14. Best value: 0.729736:  18%|█▊        | 18/100 [08:28<38:59, 28.53s/it]Best trial: 14. Best value: 0.729736:  18%|█▊        | 18/100 [09:09<38:59, 28.53s/it]Best trial: 14. Best value: 0.729736:  19%|█▉        | 19/100 [09:09<43:39, 32.34s/it]Best trial: 14. Best value: 0.729736:  19%|█▉        | 19/100 [09:34<43:39, 32.34s/it]Best trial: 14. Best value: 0.729736:  20%|██        | 20/100 [09:34<39:57, 29.97s/it]Best trial: 14. Best value: 0.729736:  20%|██        | 20/100 [10:04<39:57, 29.97s/it]Best trial: 14. Best value: 0.729736:  21%|██        | 21/100 [10:04<39:24, 29.93s/it]Best trial: 14. Best value: 0.729736:  21%|██        | 21/100 [10:46<39:24, 29.93s/it]Best trial: 14. Best value: 0.729736:  22%|██▏       | 22/100 [10:46<43:52, 33.75s/it]Best trial: 14. Best value: 0.729736:  22%|██▏       | 22/100 [11:12<43:52, 33.75s/it]Best trial: 14. Best value: 0.729736:  23%|██▎       | 23/100 [11:12<40:03, 31.22s/it]Best trial: 14. Best value: 0.729736:  23%|██▎       | 23/100 [12:16<40:03, 31.22s/it]Best trial: 14. Best value: 0.729736:  24%|██▍       | 24/100 [12:16<52:09, 41.17s/it]Best trial: 14. Best value: 0.729736:  24%|██▍       | 24/100 [13:03<52:09, 41.17s/it]Best trial: 14. Best value: 0.729736:  25%|██▌       | 25/100 [13:03<53:48, 43.05s/it]Best trial: 14. Best value: 0.729736:  25%|██▌       | 25/100 [13:41<53:48, 43.05s/it]Best trial: 14. Best value: 0.729736:  26%|██▌       | 26/100 [13:41<50:58, 41.33s/it]Best trial: 14. Best value: 0.729736:  26%|██▌       | 26/100 [14:11<50:58, 41.33s/it]Best trial: 14. Best value: 0.729736:  27%|██▋       | 27/100 [14:11<46:03, 37.86s/it]Best trial: 14. Best value: 0.729736:  27%|██▋       | 27/100 [14:37<46:03, 37.86s/it]Best trial: 14. Best value: 0.729736:  28%|██▊       | 28/100 [14:37<41:27, 34.55s/it]Best trial: 14. Best value: 0.729736:  28%|██▊       | 28/100 [15:14<41:27, 34.55s/it]Best trial: 14. Best value: 0.729736:  29%|██▉       | 29/100 [15:14<41:28, 35.05s/it]Best trial: 14. Best value: 0.729736:  29%|██▉       | 29/100 [15:49<41:28, 35.05s/it]Best trial: 14. Best value: 0.729736:  30%|███       | 30/100 [15:49<40:51, 35.01s/it]Best trial: 14. Best value: 0.729736:  30%|███       | 30/100 [16:31<40:51, 35.01s/it]Best trial: 14. Best value: 0.729736:  31%|███       | 31/100 [16:31<42:46, 37.20s/it]Best trial: 31. Best value: 0.731915:  31%|███       | 31/100 [17:13<42:46, 37.20s/it]Best trial: 31. Best value: 0.731915:  32%|███▏      | 32/100 [17:13<43:45, 38.61s/it]Best trial: 31. Best value: 0.731915:  32%|███▏      | 32/100 [17:55<43:45, 38.61s/it]Best trial: 31. Best value: 0.731915:  33%|███▎      | 33/100 [17:55<44:26, 39.80s/it]Best trial: 31. Best value: 0.731915:  33%|███▎      | 33/100 [18:28<44:26, 39.80s/it]Best trial: 31. Best value: 0.731915:  34%|███▍      | 34/100 [18:28<41:29, 37.72s/it]Best trial: 31. Best value: 0.731915:  34%|███▍      | 34/100 [18:53<41:29, 37.72s/it]Best trial: 31. Best value: 0.731915:  35%|███▌      | 35/100 [18:53<36:34, 33.76s/it]Best trial: 31. Best value: 0.731915:  35%|███▌      | 35/100 [19:18<36:34, 33.76s/it]Best trial: 31. Best value: 0.731915:  36%|███▌      | 36/100 [19:18<33:26, 31.35s/it]Best trial: 31. Best value: 0.731915:  36%|███▌      | 36/100 [19:45<33:26, 31.35s/it]Best trial: 31. Best value: 0.731915:  37%|███▋      | 37/100 [19:45<31:27, 29.96s/it]Best trial: 31. Best value: 0.731915:  37%|███▋      | 37/100 [20:04<31:27, 29.96s/it]Best trial: 31. Best value: 0.731915:  38%|███▊      | 38/100 [20:04<27:28, 26.60s/it]Best trial: 31. Best value: 0.731915:  38%|███▊      | 38/100 [20:23<27:28, 26.60s/it]Best trial: 31. Best value: 0.731915:  39%|███▉      | 39/100 [20:23<24:45, 24.36s/it]Best trial: 31. Best value: 0.731915:  39%|███▉      | 39/100 [20:57<24:45, 24.36s/it]Best trial: 31. Best value: 0.731915:  40%|████      | 40/100 [20:57<27:21, 27.35s/it]Best trial: 31. Best value: 0.731915:  40%|████      | 40/100 [22:06<27:21, 27.35s/it]Best trial: 31. Best value: 0.731915:  41%|████      | 41/100 [22:06<39:06, 39.77s/it]Best trial: 31. Best value: 0.731915:  41%|████      | 41/100 [22:42<39:06, 39.77s/it]Best trial: 31. Best value: 0.731915:  42%|████▏     | 42/100 [22:42<37:14, 38.52s/it]Best trial: 31. Best value: 0.731915:  42%|████▏     | 42/100 [23:10<37:14, 38.52s/it]Best trial: 31. Best value: 0.731915:  43%|████▎     | 43/100 [23:10<33:39, 35.44s/it]Best trial: 31. Best value: 0.731915:  43%|████▎     | 43/100 [23:47<33:39, 35.44s/it]Best trial: 31. Best value: 0.731915:  44%|████▍     | 44/100 [23:47<33:25, 35.82s/it]Best trial: 31. Best value: 0.731915:  44%|████▍     | 44/100 [24:01<33:25, 35.82s/it]Best trial: 31. Best value: 0.731915:  45%|████▌     | 45/100 [24:01<27:00, 29.46s/it]Best trial: 31. Best value: 0.731915:  45%|████▌     | 45/100 [24:09<27:00, 29.46s/it]Best trial: 31. Best value: 0.731915:  46%|████▌     | 46/100 [24:09<20:32, 22.82s/it]Best trial: 31. Best value: 0.731915:  46%|████▌     | 46/100 [24:23<20:32, 22.82s/it]Best trial: 31. Best value: 0.731915:  47%|████▋     | 47/100 [24:23<17:59, 20.37s/it]Best trial: 31. Best value: 0.731915:  47%|████▋     | 47/100 [24:39<17:59, 20.37s/it]Best trial: 31. Best value: 0.731915:  48%|████▊     | 48/100 [24:39<16:20, 18.86s/it]Best trial: 31. Best value: 0.731915:  48%|████▊     | 48/100 [25:01<16:20, 18.86s/it]Best trial: 31. Best value: 0.731915:  49%|████▉     | 49/100 [25:01<16:54, 19.89s/it]Best trial: 49. Best value: 0.733397:  49%|████▉     | 49/100 [25:18<16:54, 19.89s/it]Best trial: 49. Best value: 0.733397:  50%|█████     | 50/100 [25:18<15:45, 18.91s/it]Best trial: 49. Best value: 0.733397:  50%|█████     | 50/100 [25:38<15:45, 18.91s/it]Best trial: 49. Best value: 0.733397:  51%|█████     | 51/100 [25:38<15:43, 19.25s/it]Best trial: 49. Best value: 0.733397:  51%|█████     | 51/100 [25:58<15:43, 19.25s/it]Best trial: 49. Best value: 0.733397:  52%|█████▏    | 52/100 [25:58<15:40, 19.59s/it]Best trial: 49. Best value: 0.733397:  52%|█████▏    | 52/100 [26:16<15:40, 19.59s/it]Best trial: 49. Best value: 0.733397:  53%|█████▎    | 53/100 [26:16<15:04, 19.25s/it]Best trial: 49. Best value: 0.733397:  53%|█████▎    | 53/100 [26:35<15:04, 19.25s/it]Best trial: 49. Best value: 0.733397:  54%|█████▍    | 54/100 [26:35<14:35, 19.02s/it]Best trial: 49. Best value: 0.733397:  54%|█████▍    | 54/100 [26:58<14:35, 19.02s/it]Best trial: 49. Best value: 0.733397:  55%|█████▌    | 55/100 [26:58<15:08, 20.19s/it]Best trial: 49. Best value: 0.733397:  55%|█████▌    | 55/100 [27:23<15:08, 20.19s/it]Best trial: 49. Best value: 0.733397:  56%|█████▌    | 56/100 [27:23<15:55, 21.71s/it]Best trial: 49. Best value: 0.733397:  56%|█████▌    | 56/100 [27:36<15:55, 21.71s/it]Best trial: 49. Best value: 0.733397:  57%|█████▋    | 57/100 [27:36<13:45, 19.20s/it]Best trial: 49. Best value: 0.733397:  57%|█████▋    | 57/100 [27:58<13:45, 19.20s/it]Best trial: 49. Best value: 0.733397:  58%|█████▊    | 58/100 [27:58<13:54, 19.87s/it]Best trial: 49. Best value: 0.733397:  58%|█████▊    | 58/100 [28:26<13:54, 19.87s/it]Best trial: 49. Best value: 0.733397:  59%|█████▉    | 59/100 [28:26<15:21, 22.47s/it]Best trial: 59. Best value: 0.734206:  59%|█████▉    | 59/100 [28:50<15:21, 22.47s/it]Best trial: 59. Best value: 0.734206:  60%|██████    | 60/100 [28:50<15:13, 22.84s/it]Best trial: 59. Best value: 0.734206:  60%|██████    | 60/100 [29:21<15:13, 22.84s/it]Best trial: 59. Best value: 0.734206:  61%|██████    | 61/100 [29:21<16:21, 25.17s/it]Best trial: 59. Best value: 0.734206:  61%|██████    | 61/100 [29:40<16:21, 25.17s/it]Best trial: 59. Best value: 0.734206:  62%|██████▏   | 62/100 [29:40<14:54, 23.53s/it]Best trial: 59. Best value: 0.734206:  62%|██████▏   | 62/100 [30:05<14:54, 23.53s/it]Best trial: 59. Best value: 0.734206:  63%|██████▎   | 63/100 [30:05<14:37, 23.71s/it]Best trial: 59. Best value: 0.734206:  63%|██████▎   | 63/100 [30:33<14:37, 23.71s/it]Best trial: 59. Best value: 0.734206:  64%|██████▍   | 64/100 [30:33<15:06, 25.19s/it]Best trial: 59. Best value: 0.734206:  64%|██████▍   | 64/100 [30:56<15:06, 25.19s/it]Best trial: 59. Best value: 0.734206:  65%|██████▌   | 65/100 [30:56<14:14, 24.40s/it]Best trial: 59. Best value: 0.734206:  65%|██████▌   | 65/100 [31:26<14:14, 24.40s/it]Best trial: 59. Best value: 0.734206:  66%|██████▌   | 66/100 [31:26<14:50, 26.20s/it]Best trial: 59. Best value: 0.734206:  66%|██████▌   | 66/100 [31:48<14:50, 26.20s/it]Best trial: 59. Best value: 0.734206:  67%|██████▋   | 67/100 [31:48<13:40, 24.85s/it]Best trial: 67. Best value: 0.738157:  67%|██████▋   | 67/100 [32:14<13:40, 24.85s/it]Best trial: 67. Best value: 0.738157:  68%|██████▊   | 68/100 [32:14<13:27, 25.24s/it]Best trial: 67. Best value: 0.738157:  68%|██████▊   | 68/100 [32:40<13:27, 25.24s/it]Best trial: 67. Best value: 0.738157:  69%|██████▉   | 69/100 [32:40<13:06, 25.37s/it]Best trial: 67. Best value: 0.738157:  69%|██████▉   | 69/100 [32:48<13:06, 25.37s/it]Best trial: 67. Best value: 0.738157:  70%|███████   | 70/100 [32:48<10:08, 20.27s/it]Best trial: 67. Best value: 0.738157:  70%|███████   | 70/100 [33:06<10:08, 20.27s/it]Best trial: 67. Best value: 0.738157:  71%|███████   | 71/100 [33:06<09:26, 19.52s/it]Best trial: 67. Best value: 0.738157:  71%|███████   | 71/100 [33:30<09:26, 19.52s/it]Best trial: 67. Best value: 0.738157:  72%|███████▏  | 72/100 [33:30<09:47, 21.00s/it]Best trial: 67. Best value: 0.738157:  72%|███████▏  | 72/100 [33:50<09:47, 21.00s/it]Best trial: 67. Best value: 0.738157:  73%|███████▎  | 73/100 [33:50<09:17, 20.66s/it]Best trial: 67. Best value: 0.738157:  73%|███████▎  | 73/100 [34:06<09:17, 20.66s/it]Best trial: 67. Best value: 0.738157:  74%|███████▍  | 74/100 [34:06<08:18, 19.16s/it]Best trial: 67. Best value: 0.738157:  74%|███████▍  | 74/100 [34:28<08:18, 19.16s/it]Best trial: 67. Best value: 0.738157:  75%|███████▌  | 75/100 [34:28<08:24, 20.17s/it]Best trial: 67. Best value: 0.738157:  75%|███████▌  | 75/100 [34:55<08:24, 20.17s/it]Best trial: 67. Best value: 0.738157:  76%|███████▌  | 76/100 [34:55<08:52, 22.18s/it]Best trial: 67. Best value: 0.738157:  76%|███████▌  | 76/100 [35:09<08:52, 22.18s/it]Best trial: 67. Best value: 0.738157:  77%|███████▋  | 77/100 [35:09<07:30, 19.58s/it]Best trial: 67. Best value: 0.738157:  77%|███████▋  | 77/100 [35:35<07:30, 19.58s/it]Best trial: 67. Best value: 0.738157:  78%|███████▊  | 78/100 [35:35<07:56, 21.67s/it]Best trial: 67. Best value: 0.738157:  78%|███████▊  | 78/100 [36:15<07:56, 21.67s/it]Best trial: 67. Best value: 0.738157:  79%|███████▉  | 79/100 [36:15<09:30, 27.16s/it]Best trial: 67. Best value: 0.738157:  79%|███████▉  | 79/100 [36:33<09:30, 27.16s/it]Best trial: 67. Best value: 0.738157:  80%|████████  | 80/100 [36:33<08:05, 24.30s/it]Best trial: 67. Best value: 0.738157:  80%|████████  | 80/100 [36:41<08:05, 24.30s/it]Best trial: 67. Best value: 0.738157:  81%|████████  | 81/100 [36:41<06:09, 19.47s/it]Best trial: 67. Best value: 0.738157:  81%|████████  | 81/100 [36:57<06:09, 19.47s/it]Best trial: 67. Best value: 0.738157:  82%|████████▏ | 82/100 [36:57<05:28, 18.27s/it]Best trial: 67. Best value: 0.738157:  82%|████████▏ | 82/100 [37:12<05:28, 18.27s/it]Best trial: 67. Best value: 0.738157:  83%|████████▎ | 83/100 [37:12<04:54, 17.32s/it]Best trial: 67. Best value: 0.738157:  83%|████████▎ | 83/100 [37:35<04:54, 17.32s/it]Best trial: 67. Best value: 0.738157:  84%|████████▍ | 84/100 [37:35<05:06, 19.17s/it]Best trial: 67. Best value: 0.738157:  84%|████████▍ | 84/100 [37:51<05:06, 19.17s/it]Best trial: 67. Best value: 0.738157:  85%|████████▌ | 85/100 [37:51<04:33, 18.26s/it]Best trial: 67. Best value: 0.738157:  85%|████████▌ | 85/100 [38:13<04:33, 18.26s/it]Best trial: 67. Best value: 0.738157:  86%|████████▌ | 86/100 [38:13<04:31, 19.43s/it]Best trial: 67. Best value: 0.738157:  86%|████████▌ | 86/100 [38:29<04:31, 19.43s/it]Best trial: 67. Best value: 0.738157:  87%|████████▋ | 87/100 [38:29<03:58, 18.37s/it]Best trial: 67. Best value: 0.738157:  87%|████████▋ | 87/100 [38:41<03:58, 18.37s/it]Best trial: 67. Best value: 0.738157:  88%|████████▊ | 88/100 [38:41<03:15, 16.25s/it]Best trial: 67. Best value: 0.738157:  88%|████████▊ | 88/100 [38:59<03:15, 16.25s/it]Best trial: 67. Best value: 0.738157:  89%|████████▉ | 89/100 [38:59<03:05, 16.87s/it]Best trial: 67. Best value: 0.738157:  89%|████████▉ | 89/100 [39:23<03:05, 16.87s/it]Best trial: 67. Best value: 0.738157:  90%|█████████ | 90/100 [39:23<03:09, 18.93s/it]Best trial: 67. Best value: 0.738157:  90%|█████████ | 90/100 [39:37<03:09, 18.93s/it]Best trial: 67. Best value: 0.738157:  91%|█████████ | 91/100 [39:37<02:36, 17.43s/it]Best trial: 67. Best value: 0.738157:  91%|█████████ | 91/100 [39:50<02:36, 17.43s/it]Best trial: 67. Best value: 0.738157:  92%|█████████▏| 92/100 [39:50<02:10, 16.28s/it]Best trial: 67. Best value: 0.738157:  92%|█████████▏| 92/100 [40:04<02:10, 16.28s/it]Best trial: 67. Best value: 0.738157:  93%|█████████▎| 93/100 [40:04<01:49, 15.66s/it]Best trial: 67. Best value: 0.738157:  93%|█████████▎| 93/100 [40:21<01:49, 15.66s/it]Best trial: 67. Best value: 0.738157:  94%|█████████▍| 94/100 [40:21<01:35, 15.85s/it]Best trial: 67. Best value: 0.738157:  94%|█████████▍| 94/100 [40:30<01:35, 15.85s/it]Best trial: 67. Best value: 0.738157:  95%|█████████▌| 95/100 [40:30<01:09, 13.88s/it]Best trial: 67. Best value: 0.738157:  95%|█████████▌| 95/100 [40:43<01:09, 13.88s/it]Best trial: 67. Best value: 0.738157:  96%|█████████▌| 96/100 [40:43<00:54, 13.57s/it]Best trial: 67. Best value: 0.738157:  96%|█████████▌| 96/100 [40:57<00:54, 13.57s/it]Best trial: 67. Best value: 0.738157:  97%|█████████▋| 97/100 [40:57<00:41, 13.88s/it]Best trial: 67. Best value: 0.738157:  97%|█████████▋| 97/100 [41:09<00:41, 13.88s/it]Best trial: 67. Best value: 0.738157:  98%|█████████▊| 98/100 [41:09<00:26, 13.28s/it]Best trial: 67. Best value: 0.738157:  98%|█████████▊| 98/100 [41:25<00:26, 13.28s/it]Best trial: 67. Best value: 0.738157:  99%|█████████▉| 99/100 [41:25<00:13, 13.93s/it]Best trial: 67. Best value: 0.738157:  99%|█████████▉| 99/100 [41:39<00:13, 13.93s/it]Best trial: 67. Best value: 0.738157: 100%|██████████| 100/100 [41:39<00:00, 13.95s/it]Best trial: 67. Best value: 0.738157: 100%|██████████| 100/100 [41:39<00:00, 24.99s/it]
2025-12-01 04:27:53,944 - INFO - HPO Complete. Best AUPRC: 0.7382
2025-12-01 04:27:53,944 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.018125736693407793, 'max_depth': 3, 'subsample': 0.8358640174162423, 'colsample_bytree': 0.8657602863473799, 'gamma': 2.1015592767051383, 'reg_lambda': 0.13610407635971863, 'reg_alpha': 2.0520806388139348e-05}
2025-12-01 04:27:53,944 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_all_waveforms.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 04:27:55,856 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_waveforms
2025-12-01 04:27:55,856 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 04:27:56,050 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 04:27:56,130 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 04:27:56,153 - INFO - Data prepared. Train shape: (2761, 476), Test shape: (692, 476)
2025-12-01 04:27:56,153 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 04:27:56,153 - INFO - Training model...
2025-12-01 04:28:03,454 - INFO - Evaluating model with bootstrapping...
2025-12-01 04:28:10,513 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 04:28:10,513 - INFO - AUROC: 0.8927 (0.8643 - 0.9165)
2025-12-01 04:28:10,513 - INFO - AUPRC: 0.7439 (0.6922 - 0.7932)
2025-12-01 04:28:10,513 - INFO - Brier Score: 0.1034 (0.0958 - 0.1178)
2025-12-01 04:28:10,513 - INFO - Accuracy: 0.8454 (0.8171 - 0.8954)
2025-12-01 04:28:10,513 - INFO - Precision: 0.5968 (0.5488 - 0.8020)
2025-12-01 04:28:10,513 - INFO - Sensitivity (Recall): 0.7762 (0.5785 - 0.8236)
2025-12-01 04:28:10,513 - INFO - F1-Score: 0.6748 (0.6288 - 0.7227)
2025-12-01 04:28:10,513 - INFO - Best Threshold: 0.4200 (0.3560 - 0.6740)
2025-12-01 04:28:10,513 - INFO - Specificity: 0.8634 (0.8305 - 0.9612)
2025-12-01 04:28:10,536 - INFO - Calculating SHAP values...
2025-12-01 04:28:11,753 - INFO - SHAP plots saved.
2025-12-01 04:28:11,755 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_all_waveforms
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=ventilator_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 04:28:13,104 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: ventilator_only
2025-12-01 04:28:13,104 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 04:28:13,345 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 04:28:13,384 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 04:28:13,393 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-12-01 04:28:13,393 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.592906:   0%|          | 0/100 [00:10<?, ?it/s]Best trial: 0. Best value: 0.592906:   1%|          | 1/100 [00:10<17:19, 10.50s/it]Best trial: 0. Best value: 0.592906:   1%|          | 1/100 [00:25<17:19, 10.50s/it]Best trial: 0. Best value: 0.592906:   2%|▏         | 2/100 [00:25<21:56, 13.43s/it]Best trial: 0. Best value: 0.592906:   2%|▏         | 2/100 [00:31<21:56, 13.43s/it]Best trial: 0. Best value: 0.592906:   3%|▎         | 3/100 [00:31<15:41,  9.71s/it]Best trial: 3. Best value: 0.613546:   3%|▎         | 3/100 [00:42<15:41,  9.71s/it]Best trial: 3. Best value: 0.613546:   4%|▍         | 4/100 [00:42<16:18, 10.19s/it]Best trial: 3. Best value: 0.613546:   4%|▍         | 4/100 [00:56<16:18, 10.19s/it]Best trial: 3. Best value: 0.613546:   5%|▌         | 5/100 [00:56<18:34, 11.73s/it]Best trial: 3. Best value: 0.613546:   5%|▌         | 5/100 [01:00<18:34, 11.73s/it]Best trial: 3. Best value: 0.613546:   6%|▌         | 6/100 [01:00<14:06,  9.00s/it]Best trial: 3. Best value: 0.613546:   6%|▌         | 6/100 [01:07<14:06,  9.00s/it]Best trial: 3. Best value: 0.613546:   7%|▋         | 7/100 [01:07<12:54,  8.33s/it]Best trial: 3. Best value: 0.613546:   7%|▋         | 7/100 [01:11<12:54,  8.33s/it]Best trial: 3. Best value: 0.613546:   8%|▊         | 8/100 [01:11<10:50,  7.07s/it]Best trial: 3. Best value: 0.613546:   8%|▊         | 8/100 [01:17<10:50,  7.07s/it]Best trial: 3. Best value: 0.613546:   9%|▉         | 9/100 [01:17<09:56,  6.55s/it]Best trial: 3. Best value: 0.613546:   9%|▉         | 9/100 [01:25<09:56,  6.55s/it]Best trial: 3. Best value: 0.613546:  10%|█         | 10/100 [01:25<10:41,  7.13s/it]Best trial: 10. Best value: 0.616733:  10%|█         | 10/100 [01:46<10:41,  7.13s/it]Best trial: 10. Best value: 0.616733:  11%|█         | 11/100 [01:46<16:46, 11.30s/it]Best trial: 10. Best value: 0.616733:  11%|█         | 11/100 [01:59<16:46, 11.30s/it]Best trial: 10. Best value: 0.616733:  12%|█▏        | 12/100 [01:59<17:27, 11.90s/it]Best trial: 10. Best value: 0.616733:  12%|█▏        | 12/100 [02:25<17:27, 11.90s/it]Best trial: 10. Best value: 0.616733:  13%|█▎        | 13/100 [02:25<23:25, 16.16s/it]Best trial: 10. Best value: 0.616733:  13%|█▎        | 13/100 [02:31<23:25, 16.16s/it]Best trial: 10. Best value: 0.616733:  14%|█▍        | 14/100 [02:31<18:43, 13.06s/it]Best trial: 10. Best value: 0.616733:  14%|█▍        | 14/100 [02:48<18:43, 13.06s/it]Best trial: 10. Best value: 0.616733:  15%|█▌        | 15/100 [02:48<20:19, 14.35s/it]Best trial: 10. Best value: 0.616733:  15%|█▌        | 15/100 [02:56<20:19, 14.35s/it]Best trial: 10. Best value: 0.616733:  16%|█▌        | 16/100 [02:56<17:17, 12.35s/it]Best trial: 10. Best value: 0.616733:  16%|█▌        | 16/100 [03:28<17:17, 12.35s/it]Best trial: 10. Best value: 0.616733:  17%|█▋        | 17/100 [03:28<25:13, 18.24s/it]Best trial: 17. Best value: 0.61947:  17%|█▋        | 17/100 [03:44<25:13, 18.24s/it] Best trial: 17. Best value: 0.61947:  18%|█▊        | 18/100 [03:44<23:58, 17.54s/it]Best trial: 17. Best value: 0.61947:  18%|█▊        | 18/100 [04:02<23:58, 17.54s/it]Best trial: 17. Best value: 0.61947:  19%|█▉        | 19/100 [04:02<24:01, 17.80s/it]Best trial: 17. Best value: 0.61947:  19%|█▉        | 19/100 [04:17<24:01, 17.80s/it]Best trial: 17. Best value: 0.61947:  20%|██        | 20/100 [04:17<22:38, 16.98s/it]Best trial: 17. Best value: 0.61947:  20%|██        | 20/100 [04:41<22:38, 16.98s/it]Best trial: 17. Best value: 0.61947:  21%|██        | 21/100 [04:41<24:54, 18.92s/it]Best trial: 17. Best value: 0.61947:  21%|██        | 21/100 [04:56<24:54, 18.92s/it]Best trial: 17. Best value: 0.61947:  22%|██▏       | 22/100 [04:56<23:19, 17.94s/it]Best trial: 17. Best value: 0.61947:  22%|██▏       | 22/100 [05:02<23:19, 17.94s/it]Best trial: 17. Best value: 0.61947:  23%|██▎       | 23/100 [05:02<18:18, 14.26s/it]Best trial: 17. Best value: 0.61947:  23%|██▎       | 23/100 [05:25<18:18, 14.26s/it]Best trial: 17. Best value: 0.61947:  24%|██▍       | 24/100 [05:25<21:16, 16.79s/it]Best trial: 17. Best value: 0.61947:  24%|██▍       | 24/100 [05:44<21:16, 16.79s/it]Best trial: 17. Best value: 0.61947:  25%|██▌       | 25/100 [05:44<21:57, 17.56s/it]Best trial: 17. Best value: 0.61947:  25%|██▌       | 25/100 [06:00<21:57, 17.56s/it]Best trial: 17. Best value: 0.61947:  26%|██▌       | 26/100 [06:00<20:55, 16.97s/it]Best trial: 17. Best value: 0.61947:  26%|██▌       | 26/100 [06:22<20:55, 16.97s/it]Best trial: 17. Best value: 0.61947:  27%|██▋       | 27/100 [06:22<22:43, 18.68s/it]Best trial: 17. Best value: 0.61947:  27%|██▋       | 27/100 [06:38<22:43, 18.68s/it]Best trial: 17. Best value: 0.61947:  28%|██▊       | 28/100 [06:38<21:15, 17.72s/it]Best trial: 17. Best value: 0.61947:  28%|██▊       | 28/100 [06:50<21:15, 17.72s/it]Best trial: 17. Best value: 0.61947:  29%|██▉       | 29/100 [06:50<18:52, 15.95s/it]Best trial: 17. Best value: 0.61947:  29%|██▉       | 29/100 [07:30<18:52, 15.95s/it]Best trial: 17. Best value: 0.61947:  30%|███       | 30/100 [07:30<27:06, 23.24s/it]Best trial: 17. Best value: 0.61947:  30%|███       | 30/100 [07:48<27:06, 23.24s/it]Best trial: 17. Best value: 0.61947:  31%|███       | 31/100 [07:48<25:06, 21.83s/it]Best trial: 17. Best value: 0.61947:  31%|███       | 31/100 [07:58<25:06, 21.83s/it]Best trial: 17. Best value: 0.61947:  32%|███▏      | 32/100 [07:58<20:34, 18.15s/it]Best trial: 17. Best value: 0.61947:  32%|███▏      | 32/100 [08:05<20:34, 18.15s/it]Best trial: 17. Best value: 0.61947:  33%|███▎      | 33/100 [08:05<16:24, 14.70s/it]Best trial: 17. Best value: 0.61947:  33%|███▎      | 33/100 [08:18<16:24, 14.70s/it]Best trial: 17. Best value: 0.61947:  34%|███▍      | 34/100 [08:18<15:39, 14.24s/it]Best trial: 17. Best value: 0.61947:  34%|███▍      | 34/100 [08:30<15:39, 14.24s/it]Best trial: 17. Best value: 0.61947:  35%|███▌      | 35/100 [08:30<14:37, 13.49s/it]Best trial: 17. Best value: 0.61947:  35%|███▌      | 35/100 [08:53<14:37, 13.49s/it]Best trial: 17. Best value: 0.61947:  36%|███▌      | 36/100 [08:53<17:29, 16.40s/it]Best trial: 17. Best value: 0.61947:  36%|███▌      | 36/100 [09:12<17:29, 16.40s/it]Best trial: 17. Best value: 0.61947:  37%|███▋      | 37/100 [09:12<18:13, 17.36s/it]Best trial: 17. Best value: 0.61947:  37%|███▋      | 37/100 [09:29<18:13, 17.36s/it]Best trial: 17. Best value: 0.61947:  38%|███▊      | 38/100 [09:29<17:44, 17.17s/it]Best trial: 17. Best value: 0.61947:  38%|███▊      | 38/100 [09:37<17:44, 17.17s/it]Best trial: 17. Best value: 0.61947:  39%|███▉      | 39/100 [09:37<14:45, 14.52s/it]Best trial: 17. Best value: 0.61947:  39%|███▉      | 39/100 [09:51<14:45, 14.52s/it]Best trial: 17. Best value: 0.61947:  40%|████      | 40/100 [09:51<14:07, 14.13s/it]Best trial: 17. Best value: 0.61947:  40%|████      | 40/100 [10:08<14:07, 14.13s/it]Best trial: 17. Best value: 0.61947:  41%|████      | 41/100 [10:08<14:57, 15.21s/it]Best trial: 17. Best value: 0.61947:  41%|████      | 41/100 [10:23<14:57, 15.21s/it]Best trial: 17. Best value: 0.61947:  42%|████▏     | 42/100 [10:23<14:33, 15.05s/it]Best trial: 17. Best value: 0.61947:  42%|████▏     | 42/100 [10:37<14:33, 15.05s/it]Best trial: 17. Best value: 0.61947:  43%|████▎     | 43/100 [10:37<13:50, 14.58s/it]Best trial: 17. Best value: 0.61947:  43%|████▎     | 43/100 [10:53<13:50, 14.58s/it]Best trial: 17. Best value: 0.61947:  44%|████▍     | 44/100 [10:53<14:11, 15.20s/it]Best trial: 17. Best value: 0.61947:  44%|████▍     | 44/100 [11:13<14:11, 15.20s/it]Best trial: 17. Best value: 0.61947:  45%|████▌     | 45/100 [11:13<15:04, 16.45s/it]Best trial: 17. Best value: 0.61947:  45%|████▌     | 45/100 [11:20<15:04, 16.45s/it]Best trial: 17. Best value: 0.61947:  46%|████▌     | 46/100 [11:20<12:18, 13.67s/it]Best trial: 17. Best value: 0.61947:  46%|████▌     | 46/100 [11:25<12:18, 13.67s/it]Best trial: 17. Best value: 0.61947:  47%|████▋     | 47/100 [11:25<09:53, 11.20s/it]Best trial: 17. Best value: 0.61947:  47%|████▋     | 47/100 [11:40<09:53, 11.20s/it]Best trial: 17. Best value: 0.61947:  48%|████▊     | 48/100 [11:40<10:36, 12.24s/it]Best trial: 17. Best value: 0.61947:  48%|████▊     | 48/100 [11:44<10:36, 12.24s/it]Best trial: 17. Best value: 0.61947:  49%|████▉     | 49/100 [11:44<08:18,  9.77s/it]Best trial: 17. Best value: 0.61947:  49%|████▉     | 49/100 [11:54<08:18,  9.77s/it]Best trial: 17. Best value: 0.61947:  50%|█████     | 50/100 [11:54<08:14,  9.90s/it]Best trial: 17. Best value: 0.61947:  50%|█████     | 50/100 [11:59<08:14,  9.90s/it]Best trial: 17. Best value: 0.61947:  51%|█████     | 51/100 [11:59<06:47,  8.32s/it]Best trial: 17. Best value: 0.61947:  51%|█████     | 51/100 [12:14<06:47,  8.32s/it]Best trial: 17. Best value: 0.61947:  52%|█████▏    | 52/100 [12:14<08:19, 10.40s/it]Best trial: 52. Best value: 0.623348:  52%|█████▏    | 52/100 [12:32<08:19, 10.40s/it]Best trial: 52. Best value: 0.623348:  53%|█████▎    | 53/100 [12:32<09:51, 12.59s/it]Best trial: 52. Best value: 0.623348:  53%|█████▎    | 53/100 [12:40<09:51, 12.59s/it]Best trial: 52. Best value: 0.623348:  54%|█████▍    | 54/100 [12:40<08:47, 11.46s/it]Best trial: 52. Best value: 0.623348:  54%|█████▍    | 54/100 [12:50<08:47, 11.46s/it]Best trial: 52. Best value: 0.623348:  55%|█████▌    | 55/100 [12:50<08:14, 11.00s/it]Best trial: 52. Best value: 0.623348:  55%|█████▌    | 55/100 [13:17<08:14, 11.00s/it]Best trial: 52. Best value: 0.623348:  56%|█████▌    | 56/100 [13:17<11:35, 15.81s/it]Best trial: 52. Best value: 0.623348:  56%|█████▌    | 56/100 [13:36<11:35, 15.81s/it]Best trial: 52. Best value: 0.623348:  57%|█████▋    | 57/100 [13:36<11:58, 16.72s/it]Best trial: 52. Best value: 0.623348:  57%|█████▋    | 57/100 [13:55<11:58, 16.72s/it]Best trial: 52. Best value: 0.623348:  58%|█████▊    | 58/100 [13:55<12:03, 17.21s/it]Best trial: 52. Best value: 0.623348:  58%|█████▊    | 58/100 [14:17<12:03, 17.21s/it]Best trial: 52. Best value: 0.623348:  59%|█████▉    | 59/100 [14:17<12:53, 18.87s/it]Best trial: 52. Best value: 0.623348:  59%|█████▉    | 59/100 [14:27<12:53, 18.87s/it]Best trial: 52. Best value: 0.623348:  60%|██████    | 60/100 [14:27<10:43, 16.08s/it]Best trial: 52. Best value: 0.623348:  60%|██████    | 60/100 [14:50<10:43, 16.08s/it]Best trial: 52. Best value: 0.623348:  61%|██████    | 61/100 [14:50<11:50, 18.22s/it]Best trial: 52. Best value: 0.623348:  61%|██████    | 61/100 [15:02<11:50, 18.22s/it]Best trial: 52. Best value: 0.623348:  62%|██████▏   | 62/100 [15:02<10:19, 16.30s/it]Best trial: 52. Best value: 0.623348:  62%|██████▏   | 62/100 [15:14<10:19, 16.30s/it]Best trial: 52. Best value: 0.623348:  63%|██████▎   | 63/100 [15:14<09:19, 15.13s/it]Best trial: 52. Best value: 0.623348:  63%|██████▎   | 63/100 [15:27<09:19, 15.13s/it]Best trial: 52. Best value: 0.623348:  64%|██████▍   | 64/100 [15:27<08:34, 14.28s/it]Best trial: 52. Best value: 0.623348:  64%|██████▍   | 64/100 [15:37<08:34, 14.28s/it]Best trial: 52. Best value: 0.623348:  65%|██████▌   | 65/100 [15:37<07:39, 13.13s/it]Best trial: 52. Best value: 0.623348:  65%|██████▌   | 65/100 [15:53<07:39, 13.13s/it]Best trial: 52. Best value: 0.623348:  66%|██████▌   | 66/100 [15:53<07:50, 13.84s/it]Best trial: 52. Best value: 0.623348:  66%|██████▌   | 66/100 [16:24<07:50, 13.84s/it]Best trial: 52. Best value: 0.623348:  67%|██████▋   | 67/100 [16:24<10:26, 18.98s/it]Best trial: 52. Best value: 0.623348:  67%|██████▋   | 67/100 [16:33<10:26, 18.98s/it]Best trial: 52. Best value: 0.623348:  68%|██████▊   | 68/100 [16:33<08:35, 16.10s/it]Best trial: 52. Best value: 0.623348:  68%|██████▊   | 68/100 [16:37<08:35, 16.10s/it]Best trial: 52. Best value: 0.623348:  69%|██████▉   | 69/100 [16:37<06:26, 12.46s/it]Best trial: 52. Best value: 0.623348:  69%|██████▉   | 69/100 [16:44<06:26, 12.46s/it]Best trial: 52. Best value: 0.623348:  70%|███████   | 70/100 [16:44<05:27, 10.93s/it]Best trial: 52. Best value: 0.623348:  70%|███████   | 70/100 [17:00<05:27, 10.93s/it]Best trial: 52. Best value: 0.623348:  71%|███████   | 71/100 [17:00<05:55, 12.25s/it]Best trial: 52. Best value: 0.623348:  71%|███████   | 71/100 [17:20<05:55, 12.25s/it]Best trial: 52. Best value: 0.623348:  72%|███████▏  | 72/100 [17:20<06:55, 14.84s/it]Best trial: 52. Best value: 0.623348:  72%|███████▏  | 72/100 [17:40<06:55, 14.84s/it]Best trial: 52. Best value: 0.623348:  73%|███████▎  | 73/100 [17:40<07:21, 16.37s/it]Best trial: 52. Best value: 0.623348:  73%|███████▎  | 73/100 [17:56<07:21, 16.37s/it]Best trial: 52. Best value: 0.623348:  74%|███████▍  | 74/100 [17:56<07:00, 16.18s/it]Best trial: 52. Best value: 0.623348:  74%|███████▍  | 74/100 [18:10<07:00, 16.18s/it]Best trial: 52. Best value: 0.623348:  75%|███████▌  | 75/100 [18:10<06:23, 15.36s/it]Best trial: 52. Best value: 0.623348:  75%|███████▌  | 75/100 [18:16<06:23, 15.36s/it]Best trial: 52. Best value: 0.623348:  76%|███████▌  | 76/100 [18:16<05:06, 12.78s/it]Best trial: 52. Best value: 0.623348:  76%|███████▌  | 76/100 [18:33<05:06, 12.78s/it]Best trial: 52. Best value: 0.623348:  77%|███████▋  | 77/100 [18:33<05:17, 13.80s/it]Best trial: 52. Best value: 0.623348:  77%|███████▋  | 77/100 [18:51<05:17, 13.80s/it]Best trial: 52. Best value: 0.623348:  78%|███████▊  | 78/100 [18:51<05:35, 15.25s/it]Best trial: 52. Best value: 0.623348:  78%|███████▊  | 78/100 [19:04<05:35, 15.25s/it]Best trial: 52. Best value: 0.623348:  79%|███████▉  | 79/100 [19:04<05:07, 14.65s/it]Best trial: 52. Best value: 0.623348:  79%|███████▉  | 79/100 [19:17<05:07, 14.65s/it]Best trial: 52. Best value: 0.623348:  80%|████████  | 80/100 [19:17<04:43, 14.18s/it]Best trial: 52. Best value: 0.623348:  80%|████████  | 80/100 [19:29<04:43, 14.18s/it]Best trial: 52. Best value: 0.623348:  81%|████████  | 81/100 [19:29<04:14, 13.40s/it]Best trial: 52. Best value: 0.623348:  81%|████████  | 81/100 [19:41<04:14, 13.40s/it]Best trial: 52. Best value: 0.623348:  82%|████████▏ | 82/100 [19:41<03:54, 13.02s/it]Best trial: 52. Best value: 0.623348:  82%|████████▏ | 82/100 [19:50<03:54, 13.02s/it]Best trial: 52. Best value: 0.623348:  83%|████████▎ | 83/100 [19:50<03:17, 11.61s/it]Best trial: 52. Best value: 0.623348:  83%|████████▎ | 83/100 [20:06<03:17, 11.61s/it]Best trial: 52. Best value: 0.623348:  84%|████████▍ | 84/100 [20:06<03:31, 13.21s/it]Best trial: 52. Best value: 0.623348:  84%|████████▍ | 84/100 [20:26<03:31, 13.21s/it]Best trial: 52. Best value: 0.623348:  85%|████████▌ | 85/100 [20:26<03:46, 15.12s/it]Best trial: 52. Best value: 0.623348:  85%|████████▌ | 85/100 [20:39<03:46, 15.12s/it]Best trial: 52. Best value: 0.623348:  86%|████████▌ | 86/100 [20:39<03:23, 14.52s/it]Best trial: 52. Best value: 0.623348:  86%|████████▌ | 86/100 [21:05<03:23, 14.52s/it]Best trial: 52. Best value: 0.623348:  87%|████████▋ | 87/100 [21:05<03:53, 18.00s/it]Best trial: 52. Best value: 0.623348:  87%|████████▋ | 87/100 [21:18<03:53, 18.00s/it]Best trial: 52. Best value: 0.623348:  88%|████████▊ | 88/100 [21:18<03:18, 16.54s/it]Best trial: 52. Best value: 0.623348:  88%|████████▊ | 88/100 [21:25<03:18, 16.54s/it]Best trial: 52. Best value: 0.623348:  89%|████████▉ | 89/100 [21:25<02:29, 13.61s/it]Best trial: 52. Best value: 0.623348:  89%|████████▉ | 89/100 [21:36<02:29, 13.61s/it]Best trial: 52. Best value: 0.623348:  90%|█████████ | 90/100 [21:36<02:08, 12.88s/it]Best trial: 52. Best value: 0.623348:  90%|█████████ | 90/100 [21:53<02:08, 12.88s/it]Best trial: 52. Best value: 0.623348:  91%|█████████ | 91/100 [21:53<02:05, 13.95s/it]Best trial: 52. Best value: 0.623348:  91%|█████████ | 91/100 [22:10<02:05, 13.95s/it]Best trial: 52. Best value: 0.623348:  92%|█████████▏| 92/100 [22:10<01:59, 14.88s/it]Best trial: 52. Best value: 0.623348:  92%|█████████▏| 92/100 [22:17<01:59, 14.88s/it]Best trial: 52. Best value: 0.623348:  93%|█████████▎| 93/100 [22:17<01:27, 12.47s/it]Best trial: 52. Best value: 0.623348:  93%|█████████▎| 93/100 [22:24<01:27, 12.47s/it]Best trial: 52. Best value: 0.623348:  94%|█████████▍| 94/100 [22:24<01:04, 10.82s/it]Best trial: 52. Best value: 0.623348:  94%|█████████▍| 94/100 [22:36<01:04, 10.82s/it]Best trial: 52. Best value: 0.623348:  95%|█████████▌| 95/100 [22:36<00:55, 11.14s/it]Best trial: 52. Best value: 0.623348:  95%|█████████▌| 95/100 [22:53<00:55, 11.14s/it]Best trial: 52. Best value: 0.623348:  96%|█████████▌| 96/100 [22:53<00:51, 12.99s/it]Best trial: 52. Best value: 0.623348:  96%|█████████▌| 96/100 [23:19<00:51, 12.99s/it]Best trial: 52. Best value: 0.623348:  97%|█████████▋| 97/100 [23:19<00:50, 16.97s/it]Best trial: 52. Best value: 0.623348:  97%|█████████▋| 97/100 [23:31<00:50, 16.97s/it]Best trial: 52. Best value: 0.623348:  98%|█████████▊| 98/100 [23:31<00:30, 15.49s/it]Best trial: 52. Best value: 0.623348:  98%|█████████▊| 98/100 [23:44<00:30, 15.49s/it]Best trial: 52. Best value: 0.623348:  99%|█████████▉| 99/100 [23:44<00:14, 14.79s/it]Best trial: 52. Best value: 0.623348:  99%|█████████▉| 99/100 [23:55<00:14, 14.79s/it]Best trial: 52. Best value: 0.623348: 100%|██████████| 100/100 [23:55<00:00, 13.46s/it]Best trial: 52. Best value: 0.623348: 100%|██████████| 100/100 [23:55<00:00, 14.35s/it]
2025-12-01 04:52:08,587 - INFO - HPO Complete. Best AUPRC: 0.6233
2025-12-01 04:52:08,587 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.0355116512067932, 'max_depth': 8, 'subsample': 0.8296369334404463, 'colsample_bytree': 0.754846665441585, 'gamma': 0.6041711327732453, 'reg_lambda': 1.599146955918483e-07, 'reg_alpha': 1.614318003860351e-08}
2025-12-01 04:52:08,587 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/ventilator_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 04:52:10,498 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: ventilator_only
2025-12-01 04:52:10,498 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 04:52:10,696 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 04:52:10,732 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 04:52:10,739 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-12-01 04:52:10,739 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 04:52:10,740 - INFO - Training model...
2025-12-01 04:52:16,488 - INFO - Evaluating model with bootstrapping...
2025-12-01 04:52:21,893 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 04:52:21,893 - INFO - AUROC: 0.7946 (0.7483 - 0.8372)
2025-12-01 04:52:21,893 - INFO - AUPRC: 0.5653 (0.5101 - 0.6736)
2025-12-01 04:52:21,893 - INFO - Brier Score: 0.1290 (0.1126 - 0.1435)
2025-12-01 04:52:21,893 - INFO - Accuracy: 0.7962 (0.7821 - 0.8517)
2025-12-01 04:52:21,893 - INFO - Precision: 0.5051 (0.5054 - 0.6903)
2025-12-01 04:52:21,893 - INFO - Sensitivity (Recall): 0.6923 (0.5209 - 0.7377)
2025-12-01 04:52:21,893 - INFO - F1-Score: 0.5841 (0.5400 - 0.6613)
2025-12-01 04:52:21,893 - INFO - Best Threshold: 0.1800 (0.1600 - 0.3900)
2025-12-01 04:52:21,893 - INFO - Specificity: 0.8233 (0.8076 - 0.9301)
2025-12-01 04:52:21,918 - INFO - Calculating SHAP values...
2025-12-01 04:52:23,308 - INFO - SHAP plots saved.
2025-12-01 04:52:23,309 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/ventilator_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=monitors_only
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 04:52:24,526 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: monitors_only
2025-12-01 04:52:24,526 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 04:52:24,772 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 04:52:24,811 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 04:52:24,819 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-12-01 04:52:24,819 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.493166:   0%|          | 0/100 [00:28<?, ?it/s]Best trial: 0. Best value: 0.493166:   1%|          | 1/100 [00:28<46:46, 28.35s/it]Best trial: 0. Best value: 0.493166:   1%|          | 1/100 [00:34<46:46, 28.35s/it]Best trial: 0. Best value: 0.493166:   2%|▏         | 2/100 [00:34<25:26, 15.58s/it]Best trial: 0. Best value: 0.493166:   2%|▏         | 2/100 [00:51<25:26, 15.58s/it]Best trial: 0. Best value: 0.493166:   3%|▎         | 3/100 [00:51<26:02, 16.11s/it]Best trial: 0. Best value: 0.493166:   3%|▎         | 3/100 [01:04<26:02, 16.11s/it]Best trial: 0. Best value: 0.493166:   4%|▍         | 4/100 [01:04<23:36, 14.76s/it]Best trial: 0. Best value: 0.493166:   4%|▍         | 4/100 [01:22<23:36, 14.76s/it]Best trial: 0. Best value: 0.493166:   5%|▌         | 5/100 [01:22<25:23, 16.03s/it]Best trial: 0. Best value: 0.493166:   5%|▌         | 5/100 [01:31<25:23, 16.03s/it]Best trial: 0. Best value: 0.493166:   6%|▌         | 6/100 [01:31<21:09, 13.51s/it]Best trial: 0. Best value: 0.493166:   6%|▌         | 6/100 [01:57<21:09, 13.51s/it]Best trial: 0. Best value: 0.493166:   7%|▋         | 7/100 [01:57<27:21, 17.65s/it]Best trial: 7. Best value: 0.502936:   7%|▋         | 7/100 [02:08<27:21, 17.65s/it]Best trial: 7. Best value: 0.502936:   8%|▊         | 8/100 [02:08<23:58, 15.64s/it]Best trial: 7. Best value: 0.502936:   8%|▊         | 8/100 [02:23<23:58, 15.64s/it]Best trial: 7. Best value: 0.502936:   9%|▉         | 9/100 [02:23<23:07, 15.25s/it]Best trial: 9. Best value: 0.507175:   9%|▉         | 9/100 [02:28<23:07, 15.25s/it]Best trial: 9. Best value: 0.507175:  10%|█         | 10/100 [02:28<18:15, 12.17s/it]Best trial: 9. Best value: 0.507175:  10%|█         | 10/100 [02:31<18:15, 12.17s/it]Best trial: 9. Best value: 0.507175:  11%|█         | 11/100 [02:31<13:45,  9.27s/it]Best trial: 11. Best value: 0.510653:  11%|█         | 11/100 [02:37<13:45,  9.27s/it]Best trial: 11. Best value: 0.510653:  12%|█▏        | 12/100 [02:37<12:24,  8.46s/it]Best trial: 12. Best value: 0.518079:  12%|█▏        | 12/100 [02:44<12:24,  8.46s/it]Best trial: 12. Best value: 0.518079:  13%|█▎        | 13/100 [02:44<11:40,  8.05s/it]Best trial: 12. Best value: 0.518079:  13%|█▎        | 13/100 [02:51<11:40,  8.05s/it]Best trial: 12. Best value: 0.518079:  14%|█▍        | 14/100 [02:51<10:44,  7.50s/it]Best trial: 12. Best value: 0.518079:  14%|█▍        | 14/100 [03:01<10:44,  7.50s/it]Best trial: 12. Best value: 0.518079:  15%|█▌        | 15/100 [03:01<12:00,  8.48s/it]Best trial: 12. Best value: 0.518079:  15%|█▌        | 15/100 [03:07<12:00,  8.48s/it]Best trial: 12. Best value: 0.518079:  16%|█▌        | 16/100 [03:07<10:41,  7.64s/it]Best trial: 12. Best value: 0.518079:  16%|█▌        | 16/100 [03:16<10:41,  7.64s/it]Best trial: 12. Best value: 0.518079:  17%|█▋        | 17/100 [03:16<11:17,  8.16s/it]Best trial: 12. Best value: 0.518079:  17%|█▋        | 17/100 [03:23<11:17,  8.16s/it]Best trial: 12. Best value: 0.518079:  18%|█▊        | 18/100 [03:23<10:41,  7.82s/it]Best trial: 12. Best value: 0.518079:  18%|█▊        | 18/100 [03:29<10:41,  7.82s/it]Best trial: 12. Best value: 0.518079:  19%|█▉        | 19/100 [03:29<09:43,  7.20s/it]Best trial: 12. Best value: 0.518079:  19%|█▉        | 19/100 [03:43<09:43,  7.20s/it]Best trial: 12. Best value: 0.518079:  20%|██        | 20/100 [03:43<12:21,  9.27s/it]Best trial: 12. Best value: 0.518079:  20%|██        | 20/100 [03:53<12:21,  9.27s/it]Best trial: 12. Best value: 0.518079:  21%|██        | 21/100 [03:53<12:28,  9.48s/it]Best trial: 12. Best value: 0.518079:  21%|██        | 21/100 [04:03<12:28,  9.48s/it]Best trial: 12. Best value: 0.518079:  22%|██▏       | 22/100 [04:03<12:22,  9.52s/it]Best trial: 12. Best value: 0.518079:  22%|██▏       | 22/100 [04:12<12:22,  9.52s/it]Best trial: 12. Best value: 0.518079:  23%|██▎       | 23/100 [04:12<12:04,  9.41s/it]Best trial: 12. Best value: 0.518079:  23%|██▎       | 23/100 [04:17<12:04,  9.41s/it]Best trial: 12. Best value: 0.518079:  24%|██▍       | 24/100 [04:17<10:21,  8.18s/it]Best trial: 12. Best value: 0.518079:  24%|██▍       | 24/100 [04:34<10:21,  8.18s/it]Best trial: 12. Best value: 0.518079:  25%|██▌       | 25/100 [04:34<13:13, 10.58s/it]Best trial: 12. Best value: 0.518079:  25%|██▌       | 25/100 [04:40<13:13, 10.58s/it]Best trial: 12. Best value: 0.518079:  26%|██▌       | 26/100 [04:40<11:25,  9.26s/it]Best trial: 12. Best value: 0.518079:  26%|██▌       | 26/100 [04:50<11:25,  9.26s/it]Best trial: 12. Best value: 0.518079:  27%|██▋       | 27/100 [04:50<11:44,  9.64s/it]Best trial: 12. Best value: 0.518079:  27%|██▋       | 27/100 [04:58<11:44,  9.64s/it]Best trial: 12. Best value: 0.518079:  28%|██▊       | 28/100 [04:58<10:47,  9.00s/it]Best trial: 12. Best value: 0.518079:  28%|██▊       | 28/100 [05:08<10:47,  9.00s/it]Best trial: 12. Best value: 0.518079:  29%|██▉       | 29/100 [05:08<11:06,  9.39s/it]Best trial: 12. Best value: 0.518079:  29%|██▉       | 29/100 [05:34<11:06,  9.39s/it]Best trial: 12. Best value: 0.518079:  30%|███       | 30/100 [05:34<16:47, 14.39s/it]Best trial: 12. Best value: 0.518079:  30%|███       | 30/100 [05:43<16:47, 14.39s/it]Best trial: 12. Best value: 0.518079:  31%|███       | 31/100 [05:43<14:42, 12.80s/it]Best trial: 12. Best value: 0.518079:  31%|███       | 31/100 [05:50<14:42, 12.80s/it]Best trial: 12. Best value: 0.518079:  32%|███▏      | 32/100 [05:50<12:20, 10.89s/it]Best trial: 12. Best value: 0.518079:  32%|███▏      | 32/100 [05:56<12:20, 10.89s/it]Best trial: 12. Best value: 0.518079:  33%|███▎      | 33/100 [05:56<10:36,  9.49s/it]Best trial: 33. Best value: 0.520514:  33%|███▎      | 33/100 [06:07<10:36,  9.49s/it]Best trial: 33. Best value: 0.520514:  34%|███▍      | 34/100 [06:07<11:07, 10.11s/it]Best trial: 33. Best value: 0.520514:  34%|███▍      | 34/100 [06:24<11:07, 10.11s/it]Best trial: 33. Best value: 0.520514:  35%|███▌      | 35/100 [06:24<12:54, 11.92s/it]Best trial: 33. Best value: 0.520514:  35%|███▌      | 35/100 [06:44<12:54, 11.92s/it]Best trial: 33. Best value: 0.520514:  36%|███▌      | 36/100 [06:44<15:25, 14.45s/it]Best trial: 33. Best value: 0.520514:  36%|███▌      | 36/100 [06:55<15:25, 14.45s/it]Best trial: 33. Best value: 0.520514:  37%|███▋      | 37/100 [06:55<14:02, 13.37s/it]Best trial: 33. Best value: 0.520514:  37%|███▋      | 37/100 [07:08<14:02, 13.37s/it]Best trial: 33. Best value: 0.520514:  38%|███▊      | 38/100 [07:08<13:48, 13.36s/it]Best trial: 33. Best value: 0.520514:  38%|███▊      | 38/100 [07:11<13:48, 13.36s/it]Best trial: 33. Best value: 0.520514:  39%|███▉      | 39/100 [07:11<10:31, 10.36s/it]Best trial: 33. Best value: 0.520514:  39%|███▉      | 39/100 [07:24<10:31, 10.36s/it]Best trial: 33. Best value: 0.520514:  40%|████      | 40/100 [07:24<11:00, 11.01s/it]Best trial: 33. Best value: 0.520514:  40%|████      | 40/100 [07:39<11:00, 11.01s/it]Best trial: 33. Best value: 0.520514:  41%|████      | 41/100 [07:39<12:05, 12.30s/it]Best trial: 33. Best value: 0.520514:  41%|████      | 41/100 [07:48<12:05, 12.30s/it]Best trial: 33. Best value: 0.520514:  42%|████▏     | 42/100 [07:48<10:54, 11.28s/it]Best trial: 33. Best value: 0.520514:  42%|████▏     | 42/100 [07:55<10:54, 11.28s/it]Best trial: 33. Best value: 0.520514:  43%|████▎     | 43/100 [07:55<09:29,  9.98s/it]Best trial: 33. Best value: 0.520514:  43%|████▎     | 43/100 [08:01<09:29,  9.98s/it]Best trial: 33. Best value: 0.520514:  44%|████▍     | 44/100 [08:01<08:06,  8.69s/it]Best trial: 33. Best value: 0.520514:  44%|████▍     | 44/100 [08:25<08:06,  8.69s/it]Best trial: 33. Best value: 0.520514:  45%|████▌     | 45/100 [08:25<12:11, 13.29s/it]Best trial: 33. Best value: 0.520514:  45%|████▌     | 45/100 [08:38<12:11, 13.29s/it]Best trial: 33. Best value: 0.520514:  46%|████▌     | 46/100 [08:38<12:01, 13.36s/it]Best trial: 33. Best value: 0.520514:  46%|████▌     | 46/100 [08:46<12:01, 13.36s/it]Best trial: 33. Best value: 0.520514:  47%|████▋     | 47/100 [08:46<10:20, 11.70s/it]Best trial: 33. Best value: 0.520514:  47%|████▋     | 47/100 [08:54<10:20, 11.70s/it]Best trial: 33. Best value: 0.520514:  48%|████▊     | 48/100 [08:54<09:04, 10.47s/it]Best trial: 33. Best value: 0.520514:  48%|████▊     | 48/100 [08:59<09:04, 10.47s/it]Best trial: 33. Best value: 0.520514:  49%|████▉     | 49/100 [08:59<07:34,  8.91s/it]Best trial: 33. Best value: 0.520514:  49%|████▉     | 49/100 [09:11<07:34,  8.91s/it]Best trial: 33. Best value: 0.520514:  50%|█████     | 50/100 [09:11<08:05,  9.70s/it]Best trial: 33. Best value: 0.520514:  50%|█████     | 50/100 [09:24<08:05,  9.70s/it]Best trial: 33. Best value: 0.520514:  51%|█████     | 51/100 [09:24<08:45, 10.72s/it]Best trial: 33. Best value: 0.520514:  51%|█████     | 51/100 [09:42<08:45, 10.72s/it]Best trial: 33. Best value: 0.520514:  52%|█████▏    | 52/100 [09:42<10:27, 13.07s/it]Best trial: 33. Best value: 0.520514:  52%|█████▏    | 52/100 [09:57<10:27, 13.07s/it]Best trial: 33. Best value: 0.520514:  53%|█████▎    | 53/100 [09:57<10:36, 13.55s/it]Best trial: 33. Best value: 0.520514:  53%|█████▎    | 53/100 [10:16<10:36, 13.55s/it]Best trial: 33. Best value: 0.520514:  54%|█████▍    | 54/100 [10:16<11:41, 15.25s/it]Best trial: 33. Best value: 0.520514:  54%|█████▍    | 54/100 [10:27<11:41, 15.25s/it]Best trial: 33. Best value: 0.520514:  55%|█████▌    | 55/100 [10:27<10:21, 13.80s/it]Best trial: 33. Best value: 0.520514:  55%|█████▌    | 55/100 [10:35<10:21, 13.80s/it]Best trial: 33. Best value: 0.520514:  56%|█████▌    | 56/100 [10:35<08:59, 12.26s/it]Best trial: 33. Best value: 0.520514:  56%|█████▌    | 56/100 [10:52<08:59, 12.26s/it]Best trial: 33. Best value: 0.520514:  57%|█████▋    | 57/100 [10:52<09:40, 13.50s/it]Best trial: 33. Best value: 0.520514:  57%|█████▋    | 57/100 [11:00<09:40, 13.50s/it]Best trial: 33. Best value: 0.520514:  58%|█████▊    | 58/100 [11:00<08:23, 11.99s/it]Best trial: 33. Best value: 0.520514:  58%|█████▊    | 58/100 [11:13<08:23, 11.99s/it]Best trial: 33. Best value: 0.520514:  59%|█████▉    | 59/100 [11:13<08:21, 12.24s/it]Best trial: 33. Best value: 0.520514:  59%|█████▉    | 59/100 [11:23<08:21, 12.24s/it]Best trial: 33. Best value: 0.520514:  60%|██████    | 60/100 [11:23<07:40, 11.51s/it]Best trial: 33. Best value: 0.520514:  60%|██████    | 60/100 [11:30<07:40, 11.51s/it]Best trial: 33. Best value: 0.520514:  61%|██████    | 61/100 [11:30<06:43, 10.35s/it]Best trial: 33. Best value: 0.520514:  61%|██████    | 61/100 [11:35<06:43, 10.35s/it]Best trial: 33. Best value: 0.520514:  62%|██████▏   | 62/100 [11:35<05:24,  8.53s/it]Best trial: 33. Best value: 0.520514:  62%|██████▏   | 62/100 [11:44<05:24,  8.53s/it]Best trial: 33. Best value: 0.520514:  63%|██████▎   | 63/100 [11:44<05:29,  8.90s/it]Best trial: 33. Best value: 0.520514:  63%|██████▎   | 63/100 [11:54<05:29,  8.90s/it]Best trial: 33. Best value: 0.520514:  64%|██████▍   | 64/100 [11:54<05:24,  9.02s/it]Best trial: 33. Best value: 0.520514:  64%|██████▍   | 64/100 [12:00<05:24,  9.02s/it]Best trial: 33. Best value: 0.520514:  65%|██████▌   | 65/100 [12:00<04:50,  8.29s/it]Best trial: 33. Best value: 0.520514:  65%|██████▌   | 65/100 [12:07<04:50,  8.29s/it]Best trial: 33. Best value: 0.520514:  66%|██████▌   | 66/100 [12:07<04:30,  7.95s/it]Best trial: 33. Best value: 0.520514:  66%|██████▌   | 66/100 [12:17<04:30,  7.95s/it]Best trial: 33. Best value: 0.520514:  67%|██████▋   | 67/100 [12:17<04:37,  8.42s/it]Best trial: 33. Best value: 0.520514:  67%|██████▋   | 67/100 [12:21<04:37,  8.42s/it]Best trial: 33. Best value: 0.520514:  68%|██████▊   | 68/100 [12:21<03:45,  7.04s/it]Best trial: 33. Best value: 0.520514:  68%|██████▊   | 68/100 [12:28<03:45,  7.04s/it]Best trial: 33. Best value: 0.520514:  69%|██████▉   | 69/100 [12:28<03:40,  7.10s/it]Best trial: 33. Best value: 0.520514:  69%|██████▉   | 69/100 [12:35<03:40,  7.10s/it]Best trial: 33. Best value: 0.520514:  70%|███████   | 70/100 [12:35<03:33,  7.12s/it]Best trial: 33. Best value: 0.520514:  70%|███████   | 70/100 [12:44<03:33,  7.12s/it]Best trial: 33. Best value: 0.520514:  71%|███████   | 71/100 [12:44<03:36,  7.47s/it]Best trial: 33. Best value: 0.520514:  71%|███████   | 71/100 [12:53<03:36,  7.47s/it]Best trial: 33. Best value: 0.520514:  72%|███████▏  | 72/100 [12:53<03:49,  8.18s/it]Best trial: 33. Best value: 0.520514:  72%|███████▏  | 72/100 [13:02<03:49,  8.18s/it]Best trial: 33. Best value: 0.520514:  73%|███████▎  | 73/100 [13:02<03:42,  8.25s/it]Best trial: 33. Best value: 0.520514:  73%|███████▎  | 73/100 [13:10<03:42,  8.25s/it]Best trial: 33. Best value: 0.520514:  74%|███████▍  | 74/100 [13:10<03:33,  8.19s/it]Best trial: 33. Best value: 0.520514:  74%|███████▍  | 74/100 [13:16<03:33,  8.19s/it]Best trial: 33. Best value: 0.520514:  75%|███████▌  | 75/100 [13:16<03:11,  7.67s/it]Best trial: 33. Best value: 0.520514:  75%|███████▌  | 75/100 [13:23<03:11,  7.67s/it]Best trial: 33. Best value: 0.520514:  76%|███████▌  | 76/100 [13:23<02:54,  7.26s/it]Best trial: 33. Best value: 0.520514:  76%|███████▌  | 76/100 [13:28<02:54,  7.26s/it]Best trial: 33. Best value: 0.520514:  77%|███████▋  | 77/100 [13:28<02:36,  6.78s/it]Best trial: 33. Best value: 0.520514:  77%|███████▋  | 77/100 [13:34<02:36,  6.78s/it]Best trial: 33. Best value: 0.520514:  78%|███████▊  | 78/100 [13:34<02:20,  6.40s/it]Best trial: 33. Best value: 0.520514:  78%|███████▊  | 78/100 [13:37<02:20,  6.40s/it]Best trial: 33. Best value: 0.520514:  79%|███████▉  | 79/100 [13:37<01:56,  5.56s/it]Best trial: 33. Best value: 0.520514:  79%|███████▉  | 79/100 [13:43<01:56,  5.56s/it]Best trial: 33. Best value: 0.520514:  80%|████████  | 80/100 [13:43<01:49,  5.46s/it]Best trial: 33. Best value: 0.520514:  80%|████████  | 80/100 [13:47<01:49,  5.46s/it]Best trial: 33. Best value: 0.520514:  81%|████████  | 81/100 [13:47<01:39,  5.21s/it]Best trial: 33. Best value: 0.520514:  81%|████████  | 81/100 [13:58<01:39,  5.21s/it]Best trial: 33. Best value: 0.520514:  82%|████████▏ | 82/100 [13:58<02:02,  6.79s/it]Best trial: 33. Best value: 0.520514:  82%|████████▏ | 82/100 [14:06<02:02,  6.79s/it]Best trial: 33. Best value: 0.520514:  83%|████████▎ | 83/100 [14:06<02:03,  7.29s/it]Best trial: 33. Best value: 0.520514:  83%|████████▎ | 83/100 [14:15<02:03,  7.29s/it]Best trial: 33. Best value: 0.520514:  84%|████████▍ | 84/100 [14:15<02:04,  7.81s/it]Best trial: 33. Best value: 0.520514:  84%|████████▍ | 84/100 [14:24<02:04,  7.81s/it]Best trial: 33. Best value: 0.520514:  85%|████████▌ | 85/100 [14:24<02:03,  8.26s/it]Best trial: 33. Best value: 0.520514:  85%|████████▌ | 85/100 [14:35<02:03,  8.26s/it]Best trial: 33. Best value: 0.520514:  86%|████████▌ | 86/100 [14:35<02:03,  8.82s/it]Best trial: 33. Best value: 0.520514:  86%|████████▌ | 86/100 [14:43<02:03,  8.82s/it]Best trial: 33. Best value: 0.520514:  87%|████████▋ | 87/100 [14:43<01:52,  8.68s/it]Best trial: 33. Best value: 0.520514:  87%|████████▋ | 87/100 [14:51<01:52,  8.68s/it]Best trial: 33. Best value: 0.520514:  88%|████████▊ | 88/100 [14:51<01:41,  8.48s/it]Best trial: 33. Best value: 0.520514:  88%|████████▊ | 88/100 [15:01<01:41,  8.48s/it]Best trial: 33. Best value: 0.520514:  89%|████████▉ | 89/100 [15:01<01:37,  8.83s/it]Best trial: 33. Best value: 0.520514:  89%|████████▉ | 89/100 [15:10<01:37,  8.83s/it]Best trial: 33. Best value: 0.520514:  90%|█████████ | 90/100 [15:10<01:30,  9.06s/it]Best trial: 33. Best value: 0.520514:  90%|█████████ | 90/100 [15:17<01:30,  9.06s/it]Best trial: 33. Best value: 0.520514:  91%|█████████ | 91/100 [15:17<01:16,  8.52s/it]Best trial: 33. Best value: 0.520514:  91%|█████████ | 91/100 [15:26<01:16,  8.52s/it]Best trial: 33. Best value: 0.520514:  92%|█████████▏| 92/100 [15:26<01:08,  8.60s/it]Best trial: 33. Best value: 0.520514:  92%|█████████▏| 92/100 [15:35<01:08,  8.60s/it]Best trial: 33. Best value: 0.520514:  93%|█████████▎| 93/100 [15:35<01:00,  8.70s/it]Best trial: 33. Best value: 0.520514:  93%|█████████▎| 93/100 [15:45<01:00,  8.70s/it]Best trial: 33. Best value: 0.520514:  94%|█████████▍| 94/100 [15:45<00:53,  8.94s/it]Best trial: 33. Best value: 0.520514:  94%|█████████▍| 94/100 [15:52<00:53,  8.94s/it]Best trial: 33. Best value: 0.520514:  95%|█████████▌| 95/100 [15:52<00:42,  8.45s/it]Best trial: 33. Best value: 0.520514:  95%|█████████▌| 95/100 [16:02<00:42,  8.45s/it]Best trial: 33. Best value: 0.520514:  96%|█████████▌| 96/100 [16:02<00:35,  8.89s/it]Best trial: 33. Best value: 0.520514:  96%|█████████▌| 96/100 [16:09<00:35,  8.89s/it]Best trial: 33. Best value: 0.520514:  97%|█████████▋| 97/100 [16:09<00:25,  8.34s/it]Best trial: 33. Best value: 0.520514:  97%|█████████▋| 97/100 [16:19<00:25,  8.34s/it]Best trial: 33. Best value: 0.520514:  98%|█████████▊| 98/100 [16:19<00:17,  8.89s/it]Best trial: 33. Best value: 0.520514:  98%|█████████▊| 98/100 [16:27<00:17,  8.89s/it]Best trial: 33. Best value: 0.520514:  99%|█████████▉| 99/100 [16:27<00:08,  8.64s/it]Best trial: 33. Best value: 0.520514:  99%|█████████▉| 99/100 [16:35<00:08,  8.64s/it]Best trial: 33. Best value: 0.520514: 100%|██████████| 100/100 [16:35<00:00,  8.27s/it]Best trial: 33. Best value: 0.520514: 100%|██████████| 100/100 [16:35<00:00,  9.95s/it]
2025-12-01 05:08:59,961 - INFO - HPO Complete. Best AUPRC: 0.5205
2025-12-01 05:08:59,961 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.0246436744177065, 'max_depth': 6, 'subsample': 0.6924596344132484, 'colsample_bytree': 0.8410669854511796, 'gamma': 3.4280360489031576, 'reg_lambda': 1.4655762491686626e-05, 'reg_alpha': 0.14794048354785574}
2025-12-01 05:08:59,962 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/monitors_only.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 05:09:01,995 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: monitors_only
2025-12-01 05:09:01,995 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:09:02,194 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:09:02,230 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:09:02,237 - INFO - Data prepared. Train shape: (2761, 192), Test shape: (692, 192)
2025-12-01 05:09:02,237 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 05:09:02,238 - INFO - Training model...
2025-12-01 05:09:05,864 - INFO - Evaluating model with bootstrapping...
2025-12-01 05:09:11,286 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 05:09:11,286 - INFO - AUROC: 0.7691 (0.7247 - 0.7880)
2025-12-01 05:09:11,286 - INFO - AUPRC: 0.4740 (0.3833 - 0.5429)
2025-12-01 05:09:11,286 - INFO - Brier Score: 0.1428 (0.1331 - 0.1614)
2025-12-01 05:09:11,286 - INFO - Accuracy: 0.7225 (0.6697 - 0.7777)
2025-12-01 05:09:11,286 - INFO - Precision: 0.4032 (0.3502 - 0.4839)
2025-12-01 05:09:11,286 - INFO - Sensitivity (Recall): 0.7133 (0.5934 - 0.8236)
2025-12-01 05:09:11,286 - INFO - F1-Score: 0.5152 (0.4798 - 0.5713)
2025-12-01 05:09:11,286 - INFO - Best Threshold: 0.2800 (0.2280 - 0.3380)
2025-12-01 05:09:11,286 - INFO - Specificity: 0.7250 (0.6412 - 0.8180)
2025-12-01 05:09:11,303 - INFO - Calculating SHAP values...
2025-12-01 05:09:12,505 - INFO - SHAP plots saved.
2025-12-01 05:09:12,507 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/monitors_only
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 05:09:13,675 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_pleth
2025-12-01 05:09:13,675 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:09:13,871 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:09:13,907 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:09:13,915 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:09:13,915 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.684634:   0%|          | 0/100 [00:17<?, ?it/s]Best trial: 0. Best value: 0.684634:   1%|          | 1/100 [00:17<28:48, 17.46s/it]Best trial: 0. Best value: 0.684634:   1%|          | 1/100 [00:24<28:48, 17.46s/it]Best trial: 0. Best value: 0.684634:   2%|▏         | 2/100 [00:24<18:51, 11.55s/it]Best trial: 0. Best value: 0.684634:   2%|▏         | 2/100 [00:34<18:51, 11.55s/it]Best trial: 0. Best value: 0.684634:   3%|▎         | 3/100 [00:34<17:05, 10.57s/it]Best trial: 3. Best value: 0.703053:   3%|▎         | 3/100 [00:42<17:05, 10.57s/it]Best trial: 3. Best value: 0.703053:   4%|▍         | 4/100 [00:42<15:17,  9.56s/it]Best trial: 3. Best value: 0.703053:   4%|▍         | 4/100 [00:49<15:17,  9.56s/it]Best trial: 3. Best value: 0.703053:   5%|▌         | 5/100 [00:49<13:39,  8.63s/it]Best trial: 3. Best value: 0.703053:   5%|▌         | 5/100 [00:55<13:39,  8.63s/it]Best trial: 3. Best value: 0.703053:   6%|▌         | 6/100 [00:55<12:19,  7.86s/it]Best trial: 3. Best value: 0.703053:   6%|▌         | 6/100 [01:04<12:19,  7.86s/it]Best trial: 3. Best value: 0.703053:   7%|▋         | 7/100 [01:04<12:29,  8.06s/it]Best trial: 3. Best value: 0.703053:   7%|▋         | 7/100 [01:20<12:29,  8.06s/it]Best trial: 3. Best value: 0.703053:   8%|▊         | 8/100 [01:20<16:17, 10.62s/it]Best trial: 3. Best value: 0.703053:   8%|▊         | 8/100 [01:28<16:17, 10.62s/it]Best trial: 3. Best value: 0.703053:   9%|▉         | 9/100 [01:28<15:04,  9.94s/it]Best trial: 3. Best value: 0.703053:   9%|▉         | 9/100 [01:35<15:04,  9.94s/it]Best trial: 3. Best value: 0.703053:  10%|█         | 10/100 [01:35<13:26,  8.96s/it]Best trial: 3. Best value: 0.703053:  10%|█         | 10/100 [01:38<13:26,  8.96s/it]Best trial: 3. Best value: 0.703053:  11%|█         | 11/100 [01:38<10:32,  7.10s/it]Best trial: 3. Best value: 0.703053:  11%|█         | 11/100 [01:41<10:32,  7.10s/it]Best trial: 3. Best value: 0.703053:  12%|█▏        | 12/100 [01:41<08:47,  6.00s/it]Best trial: 12. Best value: 0.710517:  12%|█▏        | 12/100 [01:52<08:47,  6.00s/it]Best trial: 12. Best value: 0.710517:  13%|█▎        | 13/100 [01:52<10:44,  7.40s/it]Best trial: 12. Best value: 0.710517:  13%|█▎        | 13/100 [02:05<10:44,  7.40s/it]Best trial: 12. Best value: 0.710517:  14%|█▍        | 14/100 [02:05<12:54,  9.01s/it]Best trial: 12. Best value: 0.710517:  14%|█▍        | 14/100 [02:17<12:54,  9.01s/it]Best trial: 12. Best value: 0.710517:  15%|█▌        | 15/100 [02:17<14:15, 10.06s/it]Best trial: 12. Best value: 0.710517:  15%|█▌        | 15/100 [02:27<14:15, 10.06s/it]Best trial: 12. Best value: 0.710517:  16%|█▌        | 16/100 [02:27<14:10, 10.13s/it]Best trial: 16. Best value: 0.713002:  16%|█▌        | 16/100 [02:36<14:10, 10.13s/it]Best trial: 16. Best value: 0.713002:  17%|█▋        | 17/100 [02:36<13:14,  9.57s/it]Best trial: 16. Best value: 0.713002:  17%|█▋        | 17/100 [02:45<13:14,  9.57s/it]Best trial: 16. Best value: 0.713002:  18%|█▊        | 18/100 [02:45<12:57,  9.48s/it]Best trial: 16. Best value: 0.713002:  18%|█▊        | 18/100 [02:52<12:57,  9.48s/it]Best trial: 16. Best value: 0.713002:  19%|█▉        | 19/100 [02:52<11:59,  8.88s/it]Best trial: 16. Best value: 0.713002:  19%|█▉        | 19/100 [03:01<11:59,  8.88s/it]Best trial: 16. Best value: 0.713002:  20%|██        | 20/100 [03:01<11:37,  8.72s/it]Best trial: 16. Best value: 0.713002:  20%|██        | 20/100 [03:06<11:37,  8.72s/it]Best trial: 16. Best value: 0.713002:  21%|██        | 21/100 [03:06<10:17,  7.82s/it]Best trial: 21. Best value: 0.713804:  21%|██        | 21/100 [03:13<10:17,  7.82s/it]Best trial: 21. Best value: 0.713804:  22%|██▏       | 22/100 [03:13<09:30,  7.31s/it]Best trial: 21. Best value: 0.713804:  22%|██▏       | 22/100 [03:19<09:30,  7.31s/it]Best trial: 21. Best value: 0.713804:  23%|██▎       | 23/100 [03:19<08:57,  6.97s/it]Best trial: 23. Best value: 0.716922:  23%|██▎       | 23/100 [03:25<08:57,  6.97s/it]Best trial: 23. Best value: 0.716922:  24%|██▍       | 24/100 [03:25<08:31,  6.73s/it]Best trial: 23. Best value: 0.716922:  24%|██▍       | 24/100 [03:32<08:31,  6.73s/it]Best trial: 23. Best value: 0.716922:  25%|██▌       | 25/100 [03:32<08:32,  6.84s/it]Best trial: 23. Best value: 0.716922:  25%|██▌       | 25/100 [03:36<08:32,  6.84s/it]Best trial: 23. Best value: 0.716922:  26%|██▌       | 26/100 [03:36<07:28,  6.06s/it]Best trial: 23. Best value: 0.716922:  26%|██▌       | 26/100 [03:42<07:28,  6.06s/it]Best trial: 23. Best value: 0.716922:  27%|██▋       | 27/100 [03:42<07:13,  5.94s/it]Best trial: 23. Best value: 0.716922:  27%|██▋       | 27/100 [03:46<07:13,  5.94s/it]Best trial: 23. Best value: 0.716922:  28%|██▊       | 28/100 [03:46<06:24,  5.34s/it]Best trial: 23. Best value: 0.716922:  28%|██▊       | 28/100 [03:57<06:24,  5.34s/it]Best trial: 23. Best value: 0.716922:  29%|██▉       | 29/100 [03:57<08:21,  7.07s/it]Best trial: 23. Best value: 0.716922:  29%|██▉       | 29/100 [04:05<08:21,  7.07s/it]Best trial: 23. Best value: 0.716922:  30%|███       | 30/100 [04:05<08:28,  7.27s/it]Best trial: 23. Best value: 0.716922:  30%|███       | 30/100 [04:12<08:28,  7.27s/it]Best trial: 23. Best value: 0.716922:  31%|███       | 31/100 [04:12<08:31,  7.41s/it]Best trial: 23. Best value: 0.716922:  31%|███       | 31/100 [04:23<08:31,  7.41s/it]Best trial: 23. Best value: 0.716922:  32%|███▏      | 32/100 [04:23<09:35,  8.46s/it]Best trial: 23. Best value: 0.716922:  32%|███▏      | 32/100 [04:30<09:35,  8.46s/it]Best trial: 23. Best value: 0.716922:  33%|███▎      | 33/100 [04:30<08:57,  8.02s/it]Best trial: 23. Best value: 0.716922:  33%|███▎      | 33/100 [04:39<08:57,  8.02s/it]Best trial: 23. Best value: 0.716922:  34%|███▍      | 34/100 [04:39<08:55,  8.11s/it]Best trial: 23. Best value: 0.716922:  34%|███▍      | 34/100 [04:52<08:55,  8.11s/it]Best trial: 23. Best value: 0.716922:  35%|███▌      | 35/100 [04:52<10:31,  9.72s/it]Best trial: 35. Best value: 0.718292:  35%|███▌      | 35/100 [04:59<10:31,  9.72s/it]Best trial: 35. Best value: 0.718292:  36%|███▌      | 36/100 [04:59<09:22,  8.79s/it]Best trial: 35. Best value: 0.718292:  36%|███▌      | 36/100 [05:07<09:22,  8.79s/it]Best trial: 35. Best value: 0.718292:  37%|███▋      | 37/100 [05:07<09:08,  8.71s/it]Best trial: 35. Best value: 0.718292:  37%|███▋      | 37/100 [05:12<09:08,  8.71s/it]Best trial: 35. Best value: 0.718292:  38%|███▊      | 38/100 [05:12<07:51,  7.61s/it]Best trial: 35. Best value: 0.718292:  38%|███▊      | 38/100 [05:22<07:51,  7.61s/it]Best trial: 35. Best value: 0.718292:  39%|███▉      | 39/100 [05:22<08:30,  8.36s/it]Best trial: 35. Best value: 0.718292:  39%|███▉      | 39/100 [05:29<08:30,  8.36s/it]Best trial: 35. Best value: 0.718292:  40%|████      | 40/100 [05:29<07:41,  7.68s/it]Best trial: 35. Best value: 0.718292:  40%|████      | 40/100 [05:38<07:41,  7.68s/it]Best trial: 35. Best value: 0.718292:  41%|████      | 41/100 [05:38<08:00,  8.15s/it]Best trial: 35. Best value: 0.718292:  41%|████      | 41/100 [05:46<08:00,  8.15s/it]Best trial: 35. Best value: 0.718292:  42%|████▏     | 42/100 [05:46<07:47,  8.07s/it]Best trial: 35. Best value: 0.718292:  42%|████▏     | 42/100 [05:54<07:47,  8.07s/it]Best trial: 35. Best value: 0.718292:  43%|████▎     | 43/100 [05:54<07:51,  8.28s/it]Best trial: 35. Best value: 0.718292:  43%|████▎     | 43/100 [05:58<07:51,  8.28s/it]Best trial: 35. Best value: 0.718292:  44%|████▍     | 44/100 [05:58<06:24,  6.87s/it]Best trial: 35. Best value: 0.718292:  44%|████▍     | 44/100 [06:02<06:24,  6.87s/it]Best trial: 35. Best value: 0.718292:  45%|████▌     | 45/100 [06:02<05:27,  5.96s/it]Best trial: 35. Best value: 0.718292:  45%|████▌     | 45/100 [06:06<05:27,  5.96s/it]Best trial: 35. Best value: 0.718292:  46%|████▌     | 46/100 [06:06<04:48,  5.34s/it]Best trial: 35. Best value: 0.718292:  46%|████▌     | 46/100 [06:14<04:48,  5.34s/it]Best trial: 35. Best value: 0.718292:  47%|████▋     | 47/100 [06:14<05:27,  6.17s/it]Best trial: 35. Best value: 0.718292:  47%|████▋     | 47/100 [06:18<05:27,  6.17s/it]Best trial: 35. Best value: 0.718292:  48%|████▊     | 48/100 [06:18<04:55,  5.68s/it]Best trial: 35. Best value: 0.718292:  48%|████▊     | 48/100 [06:27<04:55,  5.68s/it]Best trial: 35. Best value: 0.718292:  49%|████▉     | 49/100 [06:27<05:28,  6.43s/it]Best trial: 35. Best value: 0.718292:  49%|████▉     | 49/100 [06:34<05:28,  6.43s/it]Best trial: 35. Best value: 0.718292:  50%|█████     | 50/100 [06:34<05:35,  6.71s/it]Best trial: 35. Best value: 0.718292:  50%|█████     | 50/100 [06:38<05:35,  6.71s/it]Best trial: 35. Best value: 0.718292:  51%|█████     | 51/100 [06:38<04:48,  5.89s/it]Best trial: 35. Best value: 0.718292:  51%|█████     | 51/100 [06:43<04:48,  5.89s/it]Best trial: 35. Best value: 0.718292:  52%|█████▏    | 52/100 [06:43<04:27,  5.57s/it]Best trial: 35. Best value: 0.718292:  52%|█████▏    | 52/100 [06:48<04:27,  5.57s/it]Best trial: 35. Best value: 0.718292:  53%|█████▎    | 53/100 [06:48<04:17,  5.47s/it]Best trial: 35. Best value: 0.718292:  53%|█████▎    | 53/100 [06:57<04:17,  5.47s/it]Best trial: 35. Best value: 0.718292:  54%|█████▍    | 54/100 [06:57<04:57,  6.46s/it]Best trial: 35. Best value: 0.718292:  54%|█████▍    | 54/100 [07:13<04:57,  6.46s/it]Best trial: 35. Best value: 0.718292:  55%|█████▌    | 55/100 [07:13<06:59,  9.33s/it]Best trial: 35. Best value: 0.718292:  55%|█████▌    | 55/100 [07:29<06:59,  9.33s/it]Best trial: 35. Best value: 0.718292:  56%|█████▌    | 56/100 [07:29<08:27, 11.54s/it]Best trial: 35. Best value: 0.718292:  56%|█████▌    | 56/100 [07:39<08:27, 11.54s/it]Best trial: 35. Best value: 0.718292:  57%|█████▋    | 57/100 [07:39<07:43, 10.79s/it]Best trial: 35. Best value: 0.718292:  57%|█████▋    | 57/100 [07:51<07:43, 10.79s/it]Best trial: 35. Best value: 0.718292:  58%|█████▊    | 58/100 [07:51<07:49, 11.19s/it]Best trial: 35. Best value: 0.718292:  58%|█████▊    | 58/100 [08:08<07:49, 11.19s/it]Best trial: 35. Best value: 0.718292:  59%|█████▉    | 59/100 [08:08<08:49, 12.91s/it]Best trial: 35. Best value: 0.718292:  59%|█████▉    | 59/100 [08:24<08:49, 12.91s/it]Best trial: 35. Best value: 0.718292:  60%|██████    | 60/100 [08:24<09:13, 13.83s/it]Best trial: 35. Best value: 0.718292:  60%|██████    | 60/100 [08:31<09:13, 13.83s/it]Best trial: 35. Best value: 0.718292:  61%|██████    | 61/100 [08:31<07:42, 11.86s/it]Best trial: 35. Best value: 0.718292:  61%|██████    | 61/100 [08:39<07:42, 11.86s/it]Best trial: 35. Best value: 0.718292:  62%|██████▏   | 62/100 [08:39<06:52, 10.85s/it]Best trial: 35. Best value: 0.718292:  62%|██████▏   | 62/100 [08:49<06:52, 10.85s/it]Best trial: 35. Best value: 0.718292:  63%|██████▎   | 63/100 [08:49<06:28, 10.50s/it]Best trial: 35. Best value: 0.718292:  63%|██████▎   | 63/100 [09:00<06:28, 10.50s/it]Best trial: 35. Best value: 0.718292:  64%|██████▍   | 64/100 [09:00<06:20, 10.58s/it]Best trial: 35. Best value: 0.718292:  64%|██████▍   | 64/100 [09:13<06:20, 10.58s/it]Best trial: 35. Best value: 0.718292:  65%|██████▌   | 65/100 [09:13<06:42, 11.50s/it]Best trial: 35. Best value: 0.718292:  65%|██████▌   | 65/100 [09:21<06:42, 11.50s/it]Best trial: 35. Best value: 0.718292:  66%|██████▌   | 66/100 [09:21<05:50, 10.31s/it]Best trial: 35. Best value: 0.718292:  66%|██████▌   | 66/100 [09:25<05:50, 10.31s/it]Best trial: 35. Best value: 0.718292:  67%|██████▋   | 67/100 [09:25<04:33,  8.29s/it]Best trial: 35. Best value: 0.718292:  67%|██████▋   | 67/100 [09:28<04:33,  8.29s/it]Best trial: 35. Best value: 0.718292:  68%|██████▊   | 68/100 [09:28<03:34,  6.72s/it]Best trial: 35. Best value: 0.718292:  68%|██████▊   | 68/100 [09:36<03:34,  6.72s/it]Best trial: 35. Best value: 0.718292:  69%|██████▉   | 69/100 [09:36<03:43,  7.21s/it]Best trial: 35. Best value: 0.718292:  69%|██████▉   | 69/100 [09:44<03:43,  7.21s/it]Best trial: 35. Best value: 0.718292:  70%|███████   | 70/100 [09:44<03:39,  7.32s/it]Best trial: 35. Best value: 0.718292:  70%|███████   | 70/100 [09:50<03:39,  7.32s/it]Best trial: 35. Best value: 0.718292:  71%|███████   | 71/100 [09:50<03:26,  7.12s/it]Best trial: 35. Best value: 0.718292:  71%|███████   | 71/100 [09:57<03:26,  7.12s/it]Best trial: 35. Best value: 0.718292:  72%|███████▏  | 72/100 [09:57<03:17,  7.05s/it]Best trial: 35. Best value: 0.718292:  72%|███████▏  | 72/100 [10:12<03:17,  7.05s/it]Best trial: 35. Best value: 0.718292:  73%|███████▎  | 73/100 [10:12<04:16,  9.50s/it]Best trial: 35. Best value: 0.718292:  73%|███████▎  | 73/100 [10:18<04:16,  9.50s/it]Best trial: 35. Best value: 0.718292:  74%|███████▍  | 74/100 [10:18<03:40,  8.47s/it]Best trial: 35. Best value: 0.718292:  74%|███████▍  | 74/100 [10:32<03:40,  8.47s/it]Best trial: 35. Best value: 0.718292:  75%|███████▌  | 75/100 [10:32<04:13, 10.13s/it]Best trial: 35. Best value: 0.718292:  75%|███████▌  | 75/100 [10:38<04:13, 10.13s/it]Best trial: 35. Best value: 0.718292:  76%|███████▌  | 76/100 [10:38<03:31,  8.80s/it]Best trial: 35. Best value: 0.718292:  76%|███████▌  | 76/100 [10:43<03:31,  8.80s/it]Best trial: 35. Best value: 0.718292:  77%|███████▋  | 77/100 [10:43<02:54,  7.60s/it]Best trial: 35. Best value: 0.718292:  77%|███████▋  | 77/100 [10:54<02:54,  7.60s/it]Best trial: 35. Best value: 0.718292:  78%|███████▊  | 78/100 [10:54<03:10,  8.68s/it]Best trial: 35. Best value: 0.718292:  78%|███████▊  | 78/100 [11:02<03:10,  8.68s/it]Best trial: 35. Best value: 0.718292:  79%|███████▉  | 79/100 [11:02<02:56,  8.43s/it]Best trial: 35. Best value: 0.718292:  79%|███████▉  | 79/100 [11:08<02:56,  8.43s/it]Best trial: 35. Best value: 0.718292:  80%|████████  | 80/100 [11:08<02:32,  7.60s/it]Best trial: 35. Best value: 0.718292:  80%|████████  | 80/100 [11:14<02:32,  7.60s/it]Best trial: 35. Best value: 0.718292:  81%|████████  | 81/100 [11:14<02:18,  7.28s/it]Best trial: 35. Best value: 0.718292:  81%|████████  | 81/100 [11:22<02:18,  7.28s/it]Best trial: 35. Best value: 0.718292:  82%|████████▏ | 82/100 [11:22<02:16,  7.61s/it]Best trial: 35. Best value: 0.718292:  82%|████████▏ | 82/100 [11:32<02:16,  7.61s/it]Best trial: 35. Best value: 0.718292:  83%|████████▎ | 83/100 [11:32<02:18,  8.14s/it]Best trial: 35. Best value: 0.718292:  83%|████████▎ | 83/100 [11:42<02:18,  8.14s/it]Best trial: 35. Best value: 0.718292:  84%|████████▍ | 84/100 [11:42<02:18,  8.66s/it]Best trial: 35. Best value: 0.718292:  84%|████████▍ | 84/100 [11:46<02:18,  8.66s/it]Best trial: 35. Best value: 0.718292:  85%|████████▌ | 85/100 [11:46<01:52,  7.47s/it]Best trial: 35. Best value: 0.718292:  85%|████████▌ | 85/100 [11:57<01:52,  7.47s/it]Best trial: 35. Best value: 0.718292:  86%|████████▌ | 86/100 [11:57<01:58,  8.47s/it]Best trial: 35. Best value: 0.718292:  86%|████████▌ | 86/100 [12:03<01:58,  8.47s/it]Best trial: 35. Best value: 0.718292:  87%|████████▋ | 87/100 [12:03<01:39,  7.69s/it]Best trial: 35. Best value: 0.718292:  87%|████████▋ | 87/100 [12:08<01:39,  7.69s/it]Best trial: 35. Best value: 0.718292:  88%|████████▊ | 88/100 [12:08<01:23,  7.00s/it]Best trial: 35. Best value: 0.718292:  88%|████████▊ | 88/100 [12:14<01:23,  7.00s/it]Best trial: 35. Best value: 0.718292:  89%|████████▉ | 89/100 [12:14<01:13,  6.69s/it]Best trial: 35. Best value: 0.718292:  89%|████████▉ | 89/100 [12:21<01:13,  6.69s/it]Best trial: 35. Best value: 0.718292:  90%|█████████ | 90/100 [12:21<01:05,  6.56s/it]Best trial: 35. Best value: 0.718292:  90%|█████████ | 90/100 [12:28<01:05,  6.56s/it]Best trial: 35. Best value: 0.718292:  91%|█████████ | 91/100 [12:28<01:00,  6.73s/it]Best trial: 35. Best value: 0.718292:  91%|█████████ | 91/100 [12:37<01:00,  6.73s/it]Best trial: 35. Best value: 0.718292:  92%|█████████▏| 92/100 [12:37<00:58,  7.34s/it]Best trial: 35. Best value: 0.718292:  92%|█████████▏| 92/100 [12:41<00:58,  7.34s/it]Best trial: 35. Best value: 0.718292:  93%|█████████▎| 93/100 [12:41<00:46,  6.60s/it]Best trial: 35. Best value: 0.718292:  93%|█████████▎| 93/100 [12:50<00:46,  6.60s/it]Best trial: 35. Best value: 0.718292:  94%|█████████▍| 94/100 [12:50<00:43,  7.30s/it]Best trial: 35. Best value: 0.718292:  94%|█████████▍| 94/100 [12:57<00:43,  7.30s/it]Best trial: 35. Best value: 0.718292:  95%|█████████▌| 95/100 [12:57<00:35,  7.05s/it]Best trial: 35. Best value: 0.718292:  95%|█████████▌| 95/100 [13:03<00:35,  7.05s/it]Best trial: 35. Best value: 0.718292:  96%|█████████▌| 96/100 [13:03<00:27,  6.78s/it]Best trial: 35. Best value: 0.718292:  96%|█████████▌| 96/100 [13:08<00:27,  6.78s/it]Best trial: 35. Best value: 0.718292:  97%|█████████▋| 97/100 [13:08<00:18,  6.17s/it]Best trial: 35. Best value: 0.718292:  97%|█████████▋| 97/100 [13:15<00:18,  6.17s/it]Best trial: 35. Best value: 0.718292:  98%|█████████▊| 98/100 [13:15<00:12,  6.50s/it]Best trial: 35. Best value: 0.718292:  98%|█████████▊| 98/100 [13:19<00:12,  6.50s/it]Best trial: 35. Best value: 0.718292:  99%|█████████▉| 99/100 [13:19<00:05,  5.89s/it]Best trial: 35. Best value: 0.718292:  99%|█████████▉| 99/100 [13:29<00:05,  5.89s/it]Best trial: 35. Best value: 0.718292: 100%|██████████| 100/100 [13:29<00:00,  6.96s/it]Best trial: 35. Best value: 0.718292: 100%|██████████| 100/100 [13:29<00:00,  8.09s/it]
2025-12-01 05:22:43,350 - INFO - HPO Complete. Best AUPRC: 0.7183
2025-12-01 05:22:43,350 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.03481080266381626, 'max_depth': 3, 'subsample': 0.9294362721222104, 'colsample_bytree': 0.6401074844281652, 'gamma': 1.3578911010326529, 'reg_lambda': 0.10262809695042693, 'reg_alpha': 0.0002541466544489226}
2025-12-01 05:22:43,351 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 05:22:45,554 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_pleth
2025-12-01 05:22:45,555 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:22:45,798 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:22:45,833 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:22:45,841 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:22:45,841 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 05:22:45,841 - INFO - Training model...
2025-12-01 05:22:49,074 - INFO - Evaluating model with bootstrapping...
2025-12-01 05:22:54,730 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 05:22:54,730 - INFO - AUROC: 0.8877 (0.8614 - 0.8987)
2025-12-01 05:22:54,730 - INFO - AUPRC: 0.7311 (0.6718 - 0.7715)
2025-12-01 05:22:54,730 - INFO - Brier Score: 0.1077 (0.1001 - 0.1215)
2025-12-01 05:22:54,730 - INFO - Accuracy: 0.8743 (0.8249 - 0.8902)
2025-12-01 05:22:54,730 - INFO - Precision: 0.7456 (0.5742 - 0.8029)
2025-12-01 05:22:54,730 - INFO - Sensitivity (Recall): 0.5944 (0.5646 - 0.7266)
2025-12-01 05:22:54,730 - INFO - F1-Score: 0.6615 (0.6059 - 0.6958)
2025-12-01 05:22:54,730 - INFO - Best Threshold: 0.6100 (0.4100 - 0.6280)
2025-12-01 05:22:54,730 - INFO - Specificity: 0.9472 (0.8578 - 0.9583)
2025-12-01 05:22:54,744 - INFO - Calculating SHAP values...
2025-12-01 05:22:55,810 - INFO - SHAP plots saved.
2025-12-01 05:22:55,812 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 05:22:57,024 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_ecg
2025-12-01 05:22:57,024 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:22:57,220 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:22:57,253 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:22:57,261 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:22:57,262 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.713015:   0%|          | 0/100 [00:26<?, ?it/s]Best trial: 0. Best value: 0.713015:   1%|          | 1/100 [00:26<43:13, 26.20s/it]Best trial: 0. Best value: 0.713015:   1%|          | 1/100 [00:32<43:13, 26.20s/it]Best trial: 0. Best value: 0.713015:   2%|▏         | 2/100 [00:32<23:30, 14.39s/it]Best trial: 0. Best value: 0.713015:   2%|▏         | 2/100 [00:38<23:30, 14.39s/it]Best trial: 0. Best value: 0.713015:   3%|▎         | 3/100 [00:38<16:52, 10.44s/it]Best trial: 0. Best value: 0.713015:   3%|▎         | 3/100 [00:44<16:52, 10.44s/it]Best trial: 0. Best value: 0.713015:   4%|▍         | 4/100 [00:44<14:01,  8.77s/it]Best trial: 0. Best value: 0.713015:   4%|▍         | 4/100 [00:47<14:01,  8.77s/it]Best trial: 0. Best value: 0.713015:   5%|▌         | 5/100 [00:47<10:48,  6.83s/it]Best trial: 0. Best value: 0.713015:   5%|▌         | 5/100 [01:00<10:48,  6.83s/it]Best trial: 0. Best value: 0.713015:   6%|▌         | 6/100 [01:00<13:55,  8.89s/it]Best trial: 0. Best value: 0.713015:   6%|▌         | 6/100 [01:03<13:55,  8.89s/it]Best trial: 0. Best value: 0.713015:   7%|▋         | 7/100 [01:03<10:59,  7.09s/it]Best trial: 0. Best value: 0.713015:   7%|▋         | 7/100 [01:09<10:59,  7.09s/it]Best trial: 0. Best value: 0.713015:   8%|▊         | 8/100 [01:09<10:05,  6.58s/it]Best trial: 0. Best value: 0.713015:   8%|▊         | 8/100 [01:16<10:05,  6.58s/it]Best trial: 0. Best value: 0.713015:   9%|▉         | 9/100 [01:16<10:09,  6.70s/it]Best trial: 0. Best value: 0.713015:   9%|▉         | 9/100 [01:25<10:09,  6.70s/it]Best trial: 0. Best value: 0.713015:  10%|█         | 10/100 [01:25<11:18,  7.54s/it]Best trial: 10. Best value: 0.722489:  10%|█         | 10/100 [01:35<11:18,  7.54s/it]Best trial: 10. Best value: 0.722489:  11%|█         | 11/100 [01:35<12:23,  8.35s/it]Best trial: 10. Best value: 0.722489:  11%|█         | 11/100 [01:50<12:23,  8.35s/it]Best trial: 10. Best value: 0.722489:  12%|█▏        | 12/100 [01:50<14:49, 10.11s/it]Best trial: 10. Best value: 0.722489:  12%|█▏        | 12/100 [02:05<14:49, 10.11s/it]Best trial: 10. Best value: 0.722489:  13%|█▎        | 13/100 [02:05<16:48, 11.60s/it]Best trial: 10. Best value: 0.722489:  13%|█▎        | 13/100 [02:11<16:48, 11.60s/it]Best trial: 10. Best value: 0.722489:  14%|█▍        | 14/100 [02:11<14:18,  9.99s/it]Best trial: 10. Best value: 0.722489:  14%|█▍        | 14/100 [02:26<14:18,  9.99s/it]Best trial: 10. Best value: 0.722489:  15%|█▌        | 15/100 [02:26<16:18, 11.51s/it]Best trial: 15. Best value: 0.726234:  15%|█▌        | 15/100 [02:41<16:18, 11.51s/it]Best trial: 15. Best value: 0.726234:  16%|█▌        | 16/100 [02:41<17:42, 12.65s/it]Best trial: 15. Best value: 0.726234:  16%|█▌        | 16/100 [02:57<17:42, 12.65s/it]Best trial: 15. Best value: 0.726234:  17%|█▋        | 17/100 [02:57<18:50, 13.62s/it]Best trial: 15. Best value: 0.726234:  17%|█▋        | 17/100 [03:08<18:50, 13.62s/it]Best trial: 15. Best value: 0.726234:  18%|█▊        | 18/100 [03:08<17:36, 12.89s/it]Best trial: 15. Best value: 0.726234:  18%|█▊        | 18/100 [03:18<17:36, 12.89s/it]Best trial: 15. Best value: 0.726234:  19%|█▉        | 19/100 [03:18<16:14, 12.03s/it]Best trial: 15. Best value: 0.726234:  19%|█▉        | 19/100 [03:27<16:14, 12.03s/it]Best trial: 15. Best value: 0.726234:  20%|██        | 20/100 [03:27<14:30, 10.88s/it]Best trial: 15. Best value: 0.726234:  20%|██        | 20/100 [03:37<14:30, 10.88s/it]Best trial: 15. Best value: 0.726234:  21%|██        | 21/100 [03:37<14:04, 10.69s/it]Best trial: 15. Best value: 0.726234:  21%|██        | 21/100 [03:48<14:04, 10.69s/it]Best trial: 15. Best value: 0.726234:  22%|██▏       | 22/100 [03:48<14:10, 10.90s/it]Best trial: 15. Best value: 0.726234:  22%|██▏       | 22/100 [04:02<14:10, 10.90s/it]Best trial: 15. Best value: 0.726234:  23%|██▎       | 23/100 [04:02<15:06, 11.77s/it]Best trial: 15. Best value: 0.726234:  23%|██▎       | 23/100 [04:21<15:06, 11.77s/it]Best trial: 15. Best value: 0.726234:  24%|██▍       | 24/100 [04:21<17:29, 13.81s/it]Best trial: 15. Best value: 0.726234:  24%|██▍       | 24/100 [04:33<17:29, 13.81s/it]Best trial: 15. Best value: 0.726234:  25%|██▌       | 25/100 [04:33<16:53, 13.51s/it]Best trial: 15. Best value: 0.726234:  25%|██▌       | 25/100 [04:38<16:53, 13.51s/it]Best trial: 15. Best value: 0.726234:  26%|██▌       | 26/100 [04:38<13:31, 10.97s/it]Best trial: 15. Best value: 0.726234:  26%|██▌       | 26/100 [04:50<13:31, 10.97s/it]Best trial: 15. Best value: 0.726234:  27%|██▋       | 27/100 [04:50<13:26, 11.04s/it]Best trial: 15. Best value: 0.726234:  27%|██▋       | 27/100 [04:59<13:26, 11.04s/it]Best trial: 15. Best value: 0.726234:  28%|██▊       | 28/100 [04:59<12:48, 10.67s/it]Best trial: 15. Best value: 0.726234:  28%|██▊       | 28/100 [05:16<12:48, 10.67s/it]Best trial: 15. Best value: 0.726234:  29%|██▉       | 29/100 [05:16<14:39, 12.39s/it]Best trial: 15. Best value: 0.726234:  29%|██▉       | 29/100 [05:42<14:39, 12.39s/it]Best trial: 15. Best value: 0.726234:  30%|███       | 30/100 [05:42<19:11, 16.45s/it]Best trial: 15. Best value: 0.726234:  30%|███       | 30/100 [05:59<19:11, 16.45s/it]Best trial: 15. Best value: 0.726234:  31%|███       | 31/100 [05:59<19:14, 16.73s/it]Best trial: 15. Best value: 0.726234:  31%|███       | 31/100 [06:14<19:14, 16.73s/it]Best trial: 15. Best value: 0.726234:  32%|███▏      | 32/100 [06:14<18:17, 16.14s/it]Best trial: 15. Best value: 0.726234:  32%|███▏      | 32/100 [06:27<18:17, 16.14s/it]Best trial: 15. Best value: 0.726234:  33%|███▎      | 33/100 [06:27<17:01, 15.24s/it]Best trial: 15. Best value: 0.726234:  33%|███▎      | 33/100 [06:39<17:01, 15.24s/it]Best trial: 15. Best value: 0.726234:  34%|███▍      | 34/100 [06:39<15:45, 14.33s/it]Best trial: 15. Best value: 0.726234:  34%|███▍      | 34/100 [06:49<15:45, 14.33s/it]Best trial: 15. Best value: 0.726234:  35%|███▌      | 35/100 [06:49<13:58, 12.89s/it]Best trial: 15. Best value: 0.726234:  35%|███▌      | 35/100 [07:02<13:58, 12.89s/it]Best trial: 15. Best value: 0.726234:  36%|███▌      | 36/100 [07:02<13:43, 12.86s/it]Best trial: 15. Best value: 0.726234:  36%|███▌      | 36/100 [07:09<13:43, 12.86s/it]Best trial: 15. Best value: 0.726234:  37%|███▋      | 37/100 [07:09<11:53, 11.32s/it]Best trial: 15. Best value: 0.726234:  37%|███▋      | 37/100 [07:27<11:53, 11.32s/it]Best trial: 15. Best value: 0.726234:  38%|███▊      | 38/100 [07:27<13:37, 13.19s/it]Best trial: 15. Best value: 0.726234:  38%|███▊      | 38/100 [07:35<13:37, 13.19s/it]Best trial: 15. Best value: 0.726234:  39%|███▉      | 39/100 [07:35<11:56, 11.74s/it]Best trial: 15. Best value: 0.726234:  39%|███▉      | 39/100 [07:42<11:56, 11.74s/it]Best trial: 15. Best value: 0.726234:  40%|████      | 40/100 [07:42<10:09, 10.16s/it]Best trial: 15. Best value: 0.726234:  40%|████      | 40/100 [07:53<10:09, 10.16s/it]Best trial: 15. Best value: 0.726234:  41%|████      | 41/100 [07:53<10:28, 10.65s/it]Best trial: 15. Best value: 0.726234:  41%|████      | 41/100 [08:02<10:28, 10.65s/it]Best trial: 15. Best value: 0.726234:  42%|████▏     | 42/100 [08:02<09:36,  9.94s/it]Best trial: 15. Best value: 0.726234:  42%|████▏     | 42/100 [08:13<09:36,  9.94s/it]Best trial: 15. Best value: 0.726234:  43%|████▎     | 43/100 [08:13<09:54, 10.42s/it]Best trial: 15. Best value: 0.726234:  43%|████▎     | 43/100 [08:24<09:54, 10.42s/it]Best trial: 15. Best value: 0.726234:  44%|████▍     | 44/100 [08:24<09:40, 10.37s/it]Best trial: 15. Best value: 0.726234:  44%|████▍     | 44/100 [08:40<09:40, 10.37s/it]Best trial: 15. Best value: 0.726234:  45%|████▌     | 45/100 [08:40<11:04, 12.08s/it]Best trial: 15. Best value: 0.726234:  45%|████▌     | 45/100 [08:50<11:04, 12.08s/it]Best trial: 15. Best value: 0.726234:  46%|████▌     | 46/100 [08:50<10:19, 11.46s/it]Best trial: 15. Best value: 0.726234:  46%|████▌     | 46/100 [09:00<10:19, 11.46s/it]Best trial: 15. Best value: 0.726234:  47%|████▋     | 47/100 [09:00<09:44, 11.03s/it]Best trial: 15. Best value: 0.726234:  47%|████▋     | 47/100 [09:10<09:44, 11.03s/it]Best trial: 15. Best value: 0.726234:  48%|████▊     | 48/100 [09:10<09:15, 10.69s/it]Best trial: 15. Best value: 0.726234:  48%|████▊     | 48/100 [09:15<09:15, 10.69s/it]Best trial: 15. Best value: 0.726234:  49%|████▉     | 49/100 [09:15<07:38,  8.99s/it]Best trial: 49. Best value: 0.727084:  49%|████▉     | 49/100 [09:23<07:38,  8.99s/it]Best trial: 49. Best value: 0.727084:  50%|█████     | 50/100 [09:23<07:25,  8.91s/it]Best trial: 49. Best value: 0.727084:  50%|█████     | 50/100 [09:38<07:25,  8.91s/it]Best trial: 49. Best value: 0.727084:  51%|█████     | 51/100 [09:38<08:45, 10.73s/it]Best trial: 49. Best value: 0.727084:  51%|█████     | 51/100 [09:47<08:45, 10.73s/it]Best trial: 49. Best value: 0.727084:  52%|█████▏    | 52/100 [09:47<08:11, 10.25s/it]Best trial: 49. Best value: 0.727084:  52%|█████▏    | 52/100 [09:56<08:11, 10.25s/it]Best trial: 49. Best value: 0.727084:  53%|█████▎    | 53/100 [09:56<07:35,  9.68s/it]Best trial: 49. Best value: 0.727084:  53%|█████▎    | 53/100 [10:08<07:35,  9.68s/it]Best trial: 49. Best value: 0.727084:  54%|█████▍    | 54/100 [10:08<07:54, 10.32s/it]Best trial: 49. Best value: 0.727084:  54%|█████▍    | 54/100 [10:18<07:54, 10.32s/it]Best trial: 49. Best value: 0.727084:  55%|█████▌    | 55/100 [10:18<07:43, 10.31s/it]Best trial: 49. Best value: 0.727084:  55%|█████▌    | 55/100 [10:29<07:43, 10.31s/it]Best trial: 49. Best value: 0.727084:  56%|█████▌    | 56/100 [10:29<07:44, 10.55s/it]Best trial: 49. Best value: 0.727084:  56%|█████▌    | 56/100 [10:37<07:44, 10.55s/it]Best trial: 49. Best value: 0.727084:  57%|█████▋    | 57/100 [10:37<07:01,  9.79s/it]Best trial: 49. Best value: 0.727084:  57%|█████▋    | 57/100 [10:48<07:01,  9.79s/it]Best trial: 49. Best value: 0.727084:  58%|█████▊    | 58/100 [10:48<07:05, 10.13s/it]Best trial: 49. Best value: 0.727084:  58%|█████▊    | 58/100 [10:56<07:05, 10.13s/it]Best trial: 49. Best value: 0.727084:  59%|█████▉    | 59/100 [10:56<06:26,  9.42s/it]Best trial: 49. Best value: 0.727084:  59%|█████▉    | 59/100 [11:11<06:26,  9.42s/it]Best trial: 49. Best value: 0.727084:  60%|██████    | 60/100 [11:11<07:29, 11.25s/it]Best trial: 49. Best value: 0.727084:  60%|██████    | 60/100 [11:30<07:29, 11.25s/it]Best trial: 49. Best value: 0.727084:  61%|██████    | 61/100 [11:30<08:44, 13.45s/it]Best trial: 49. Best value: 0.727084:  61%|██████    | 61/100 [11:39<08:44, 13.45s/it]Best trial: 49. Best value: 0.727084:  62%|██████▏   | 62/100 [11:39<07:46, 12.28s/it]Best trial: 49. Best value: 0.727084:  62%|██████▏   | 62/100 [11:47<07:46, 12.28s/it]Best trial: 49. Best value: 0.727084:  63%|██████▎   | 63/100 [11:47<06:46, 10.98s/it]Best trial: 49. Best value: 0.727084:  63%|██████▎   | 63/100 [11:51<06:46, 10.98s/it]Best trial: 49. Best value: 0.727084:  64%|██████▍   | 64/100 [11:51<05:20,  8.89s/it]Best trial: 49. Best value: 0.727084:  64%|██████▍   | 64/100 [12:05<05:20,  8.89s/it]Best trial: 49. Best value: 0.727084:  65%|██████▌   | 65/100 [12:05<06:06, 10.47s/it]Best trial: 49. Best value: 0.727084:  65%|██████▌   | 65/100 [12:17<06:06, 10.47s/it]Best trial: 49. Best value: 0.727084:  66%|██████▌   | 66/100 [12:17<06:11, 10.94s/it]Best trial: 49. Best value: 0.727084:  66%|██████▌   | 66/100 [12:34<06:11, 10.94s/it]Best trial: 49. Best value: 0.727084:  67%|██████▋   | 67/100 [12:34<06:54, 12.56s/it]Best trial: 49. Best value: 0.727084:  67%|██████▋   | 67/100 [12:44<06:54, 12.56s/it]Best trial: 49. Best value: 0.727084:  68%|██████▊   | 68/100 [12:44<06:20, 11.90s/it]Best trial: 49. Best value: 0.727084:  68%|██████▊   | 68/100 [12:52<06:20, 11.90s/it]Best trial: 49. Best value: 0.727084:  69%|██████▉   | 69/100 [12:52<05:28, 10.61s/it]Best trial: 69. Best value: 0.730853:  69%|██████▉   | 69/100 [13:02<05:28, 10.61s/it]Best trial: 69. Best value: 0.730853:  70%|███████   | 70/100 [13:02<05:11, 10.39s/it]Best trial: 69. Best value: 0.730853:  70%|███████   | 70/100 [13:10<05:11, 10.39s/it]Best trial: 69. Best value: 0.730853:  71%|███████   | 71/100 [13:10<04:42,  9.74s/it]Best trial: 69. Best value: 0.730853:  71%|███████   | 71/100 [13:16<04:42,  9.74s/it]Best trial: 69. Best value: 0.730853:  72%|███████▏  | 72/100 [13:16<04:01,  8.63s/it]Best trial: 69. Best value: 0.730853:  72%|███████▏  | 72/100 [13:26<04:01,  8.63s/it]Best trial: 69. Best value: 0.730853:  73%|███████▎  | 73/100 [13:26<04:05,  9.08s/it]Best trial: 69. Best value: 0.730853:  73%|███████▎  | 73/100 [13:39<04:05,  9.08s/it]Best trial: 69. Best value: 0.730853:  74%|███████▍  | 74/100 [13:39<04:29, 10.37s/it]Best trial: 69. Best value: 0.730853:  74%|███████▍  | 74/100 [13:47<04:29, 10.37s/it]Best trial: 69. Best value: 0.730853:  75%|███████▌  | 75/100 [13:47<03:54,  9.40s/it]Best trial: 69. Best value: 0.730853:  75%|███████▌  | 75/100 [13:54<03:54,  9.40s/it]Best trial: 69. Best value: 0.730853:  76%|███████▌  | 76/100 [13:54<03:28,  8.70s/it]Best trial: 69. Best value: 0.730853:  76%|███████▌  | 76/100 [13:58<03:28,  8.70s/it]Best trial: 69. Best value: 0.730853:  77%|███████▋  | 77/100 [13:58<02:49,  7.38s/it]Best trial: 69. Best value: 0.730853:  77%|███████▋  | 77/100 [14:16<02:49,  7.38s/it]Best trial: 69. Best value: 0.730853:  78%|███████▊  | 78/100 [14:16<03:51, 10.51s/it]Best trial: 69. Best value: 0.730853:  78%|███████▊  | 78/100 [14:26<03:51, 10.51s/it]Best trial: 69. Best value: 0.730853:  79%|███████▉  | 79/100 [14:26<03:38, 10.39s/it]Best trial: 79. Best value: 0.733675:  79%|███████▉  | 79/100 [14:33<03:38, 10.39s/it]Best trial: 79. Best value: 0.733675:  80%|████████  | 80/100 [14:33<03:07,  9.39s/it]Best trial: 79. Best value: 0.733675:  80%|████████  | 80/100 [14:38<03:07,  9.39s/it]Best trial: 79. Best value: 0.733675:  81%|████████  | 81/100 [14:38<02:32,  8.04s/it]Best trial: 79. Best value: 0.733675:  81%|████████  | 81/100 [14:45<02:32,  8.04s/it]Best trial: 79. Best value: 0.733675:  82%|████████▏ | 82/100 [14:45<02:19,  7.77s/it]Best trial: 79. Best value: 0.733675:  82%|████████▏ | 82/100 [14:52<02:19,  7.77s/it]Best trial: 79. Best value: 0.733675:  83%|████████▎ | 83/100 [14:52<02:07,  7.48s/it]Best trial: 79. Best value: 0.733675:  83%|████████▎ | 83/100 [14:58<02:07,  7.48s/it]Best trial: 79. Best value: 0.733675:  84%|████████▍ | 84/100 [14:58<01:54,  7.19s/it]Best trial: 79. Best value: 0.733675:  84%|████████▍ | 84/100 [15:03<01:54,  7.19s/it]Best trial: 79. Best value: 0.733675:  85%|████████▌ | 85/100 [15:03<01:36,  6.43s/it]Best trial: 79. Best value: 0.733675:  85%|████████▌ | 85/100 [15:13<01:36,  6.43s/it]Best trial: 79. Best value: 0.733675:  86%|████████▌ | 86/100 [15:13<01:47,  7.65s/it]Best trial: 79. Best value: 0.733675:  86%|████████▌ | 86/100 [15:18<01:47,  7.65s/it]Best trial: 79. Best value: 0.733675:  87%|████████▋ | 87/100 [15:18<01:29,  6.86s/it]Best trial: 79. Best value: 0.733675:  87%|████████▋ | 87/100 [15:31<01:29,  6.86s/it]Best trial: 79. Best value: 0.733675:  88%|████████▊ | 88/100 [15:31<01:42,  8.54s/it]Best trial: 79. Best value: 0.733675:  88%|████████▊ | 88/100 [15:36<01:42,  8.54s/it]Best trial: 79. Best value: 0.733675:  89%|████████▉ | 89/100 [15:36<01:22,  7.51s/it]Best trial: 79. Best value: 0.733675:  89%|████████▉ | 89/100 [15:43<01:22,  7.51s/it]Best trial: 79. Best value: 0.733675:  90%|█████████ | 90/100 [15:43<01:14,  7.43s/it]Best trial: 79. Best value: 0.733675:  90%|█████████ | 90/100 [15:53<01:14,  7.43s/it]Best trial: 79. Best value: 0.733675:  91%|█████████ | 91/100 [15:53<01:14,  8.28s/it]Best trial: 79. Best value: 0.733675:  91%|█████████ | 91/100 [16:02<01:14,  8.28s/it]Best trial: 79. Best value: 0.733675:  92%|█████████▏| 92/100 [16:02<01:05,  8.23s/it]Best trial: 79. Best value: 0.733675:  92%|█████████▏| 92/100 [16:08<01:05,  8.23s/it]Best trial: 79. Best value: 0.733675:  93%|█████████▎| 93/100 [16:08<00:54,  7.79s/it]Best trial: 79. Best value: 0.733675:  93%|█████████▎| 93/100 [16:21<00:54,  7.79s/it]Best trial: 79. Best value: 0.733675:  94%|█████████▍| 94/100 [16:21<00:55,  9.29s/it]Best trial: 79. Best value: 0.733675:  94%|█████████▍| 94/100 [16:35<00:55,  9.29s/it]Best trial: 79. Best value: 0.733675:  95%|█████████▌| 95/100 [16:35<00:53, 10.65s/it]Best trial: 79. Best value: 0.733675:  95%|█████████▌| 95/100 [16:42<00:53, 10.65s/it]Best trial: 79. Best value: 0.733675:  96%|█████████▌| 96/100 [16:42<00:38,  9.54s/it]Best trial: 79. Best value: 0.733675:  96%|█████████▌| 96/100 [16:51<00:38,  9.54s/it]Best trial: 79. Best value: 0.733675:  97%|█████████▋| 97/100 [16:51<00:28,  9.42s/it]Best trial: 79. Best value: 0.733675:  97%|█████████▋| 97/100 [17:05<00:28,  9.42s/it]Best trial: 79. Best value: 0.733675:  98%|█████████▊| 98/100 [17:05<00:21, 10.72s/it]Best trial: 79. Best value: 0.733675:  98%|█████████▊| 98/100 [17:18<00:21, 10.72s/it]Best trial: 79. Best value: 0.733675:  99%|█████████▉| 99/100 [17:18<00:11, 11.34s/it]Best trial: 79. Best value: 0.733675:  99%|█████████▉| 99/100 [17:23<00:11, 11.34s/it]Best trial: 79. Best value: 0.733675: 100%|██████████| 100/100 [17:23<00:00,  9.63s/it]Best trial: 79. Best value: 0.733675: 100%|██████████| 100/100 [17:23<00:00, 10.44s/it]
2025-12-01 05:40:20,977 - INFO - HPO Complete. Best AUPRC: 0.7337
2025-12-01 05:40:20,977 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.07882920061917303, 'max_depth': 3, 'subsample': 0.8892274328068749, 'colsample_bytree': 0.8395693404952526, 'gamma': 2.114874075327503, 'reg_lambda': 1.0073409266117713e-06, 'reg_alpha': 0.0006423463764579355}
2025-12-01 05:40:20,978 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 05:40:23,142 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_ecg
2025-12-01 05:40:23,143 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:40:23,366 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:40:23,402 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:40:23,410 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:40:23,410 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 05:40:23,410 - INFO - Training model...
2025-12-01 05:40:26,996 - INFO - Evaluating model with bootstrapping...
2025-12-01 05:40:32,637 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 05:40:32,638 - INFO - AUROC: 0.8813 (0.8536 - 0.9011)
2025-12-01 05:40:32,638 - INFO - AUPRC: 0.7259 (0.6574 - 0.7770)
2025-12-01 05:40:32,638 - INFO - Brier Score: 0.1036 (0.0921 - 0.1226)
2025-12-01 05:40:32,638 - INFO - Accuracy: 0.8627 (0.8087 - 0.8873)
2025-12-01 05:40:32,638 - INFO - Precision: 0.6791 (0.5279 - 0.7662)
2025-12-01 05:40:32,638 - INFO - Sensitivity (Recall): 0.6364 (0.5751 - 0.8123)
2025-12-01 05:40:32,638 - INFO - F1-Score: 0.6570 (0.6083 - 0.7158)
2025-12-01 05:40:32,638 - INFO - Best Threshold: 0.5400 (0.2580 - 0.6200)
2025-12-01 05:40:32,638 - INFO - Specificity: 0.9217 (0.8190 - 0.9496)
2025-12-01 05:40:32,657 - INFO - Calculating SHAP values...
2025-12-01 05:40:33,787 - INFO - SHAP plots saved.
2025-12-01 05:40:33,791 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_co2
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 05:40:35,195 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_co2
2025-12-01 05:40:35,195 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:40:35,439 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:40:35,477 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:40:35,486 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:40:35,486 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.67394:   0%|          | 0/100 [00:06<?, ?it/s]Best trial: 0. Best value: 0.67394:   1%|          | 1/100 [00:06<10:17,  6.23s/it]Best trial: 0. Best value: 0.67394:   1%|          | 1/100 [00:20<10:17,  6.23s/it]Best trial: 0. Best value: 0.67394:   2%|▏         | 2/100 [00:20<18:08, 11.11s/it]Best trial: 2. Best value: 0.690007:   2%|▏         | 2/100 [00:25<18:08, 11.11s/it]Best trial: 2. Best value: 0.690007:   3%|▎         | 3/100 [00:25<13:12,  8.17s/it]Best trial: 2. Best value: 0.690007:   3%|▎         | 3/100 [00:36<13:12,  8.17s/it]Best trial: 2. Best value: 0.690007:   4%|▍         | 4/100 [00:36<14:59,  9.37s/it]Best trial: 2. Best value: 0.690007:   4%|▍         | 4/100 [00:40<14:59,  9.37s/it]Best trial: 2. Best value: 0.690007:   5%|▌         | 5/100 [00:40<11:52,  7.50s/it]Best trial: 2. Best value: 0.690007:   5%|▌         | 5/100 [00:48<11:52,  7.50s/it]Best trial: 2. Best value: 0.690007:   6%|▌         | 6/100 [00:48<11:37,  7.42s/it]Best trial: 6. Best value: 0.699591:   6%|▌         | 6/100 [00:57<11:37,  7.42s/it]Best trial: 6. Best value: 0.699591:   7%|▋         | 7/100 [00:57<12:21,  7.97s/it]Best trial: 6. Best value: 0.699591:   7%|▋         | 7/100 [01:06<12:21,  7.97s/it]Best trial: 6. Best value: 0.699591:   8%|▊         | 8/100 [01:06<12:58,  8.46s/it]Best trial: 6. Best value: 0.699591:   8%|▊         | 8/100 [01:23<12:58,  8.46s/it]Best trial: 6. Best value: 0.699591:   9%|▉         | 9/100 [01:23<16:49, 11.10s/it]Best trial: 9. Best value: 0.703458:   9%|▉         | 9/100 [01:36<16:49, 11.10s/it]Best trial: 9. Best value: 0.703458:  10%|█         | 10/100 [01:36<17:24, 11.61s/it]Best trial: 10. Best value: 0.713377:  10%|█         | 10/100 [01:39<17:24, 11.61s/it]Best trial: 10. Best value: 0.713377:  11%|█         | 11/100 [01:39<13:20,  8.99s/it]Best trial: 10. Best value: 0.713377:  11%|█         | 11/100 [01:43<13:20,  8.99s/it]Best trial: 10. Best value: 0.713377:  12%|█▏        | 12/100 [01:43<11:00,  7.51s/it]Best trial: 10. Best value: 0.713377:  12%|█▏        | 12/100 [01:46<11:00,  7.51s/it]Best trial: 10. Best value: 0.713377:  13%|█▎        | 13/100 [01:46<09:02,  6.24s/it]Best trial: 10. Best value: 0.713377:  13%|█▎        | 13/100 [01:50<09:02,  6.24s/it]Best trial: 10. Best value: 0.713377:  14%|█▍        | 14/100 [01:50<07:43,  5.38s/it]Best trial: 10. Best value: 0.713377:  14%|█▍        | 14/100 [01:56<07:43,  5.38s/it]Best trial: 10. Best value: 0.713377:  15%|█▌        | 15/100 [01:56<08:02,  5.67s/it]Best trial: 10. Best value: 0.713377:  15%|█▌        | 15/100 [02:00<08:02,  5.67s/it]Best trial: 10. Best value: 0.713377:  16%|█▌        | 16/100 [02:00<07:17,  5.20s/it]Best trial: 16. Best value: 0.716174:  16%|█▌        | 16/100 [02:07<07:17,  5.20s/it]Best trial: 16. Best value: 0.716174:  17%|█▋        | 17/100 [02:07<07:50,  5.66s/it]Best trial: 16. Best value: 0.716174:  17%|█▋        | 17/100 [02:16<07:50,  5.66s/it]Best trial: 16. Best value: 0.716174:  18%|█▊        | 18/100 [02:16<09:12,  6.74s/it]Best trial: 16. Best value: 0.716174:  18%|█▊        | 18/100 [02:21<09:12,  6.74s/it]Best trial: 16. Best value: 0.716174:  19%|█▉        | 19/100 [02:21<08:22,  6.20s/it]Best trial: 16. Best value: 0.716174:  19%|█▉        | 19/100 [02:29<08:22,  6.20s/it]Best trial: 16. Best value: 0.716174:  20%|██        | 20/100 [02:29<08:57,  6.72s/it]Best trial: 16. Best value: 0.716174:  20%|██        | 20/100 [02:36<08:57,  6.72s/it]Best trial: 16. Best value: 0.716174:  21%|██        | 21/100 [02:36<08:48,  6.70s/it]Best trial: 16. Best value: 0.716174:  21%|██        | 21/100 [02:40<08:48,  6.70s/it]Best trial: 16. Best value: 0.716174:  22%|██▏       | 22/100 [02:40<07:46,  5.98s/it]Best trial: 16. Best value: 0.716174:  22%|██▏       | 22/100 [02:43<07:46,  5.98s/it]Best trial: 16. Best value: 0.716174:  23%|██▎       | 23/100 [02:43<06:41,  5.21s/it]Best trial: 16. Best value: 0.716174:  23%|██▎       | 23/100 [02:48<06:41,  5.21s/it]Best trial: 16. Best value: 0.716174:  24%|██▍       | 24/100 [02:48<06:28,  5.11s/it]Best trial: 16. Best value: 0.716174:  24%|██▍       | 24/100 [02:54<06:28,  5.11s/it]Best trial: 16. Best value: 0.716174:  25%|██▌       | 25/100 [02:54<06:27,  5.16s/it]Best trial: 16. Best value: 0.716174:  25%|██▌       | 25/100 [02:59<06:27,  5.16s/it]Best trial: 16. Best value: 0.716174:  26%|██▌       | 26/100 [02:59<06:17,  5.10s/it]Best trial: 16. Best value: 0.716174:  26%|██▌       | 26/100 [03:05<06:17,  5.10s/it]Best trial: 16. Best value: 0.716174:  27%|██▋       | 27/100 [03:05<06:35,  5.41s/it]Best trial: 16. Best value: 0.716174:  27%|██▋       | 27/100 [03:11<06:35,  5.41s/it]Best trial: 16. Best value: 0.716174:  28%|██▊       | 28/100 [03:11<06:52,  5.73s/it]Best trial: 16. Best value: 0.716174:  28%|██▊       | 28/100 [03:16<06:52,  5.73s/it]Best trial: 16. Best value: 0.716174:  29%|██▉       | 29/100 [03:16<06:21,  5.37s/it]Best trial: 16. Best value: 0.716174:  29%|██▉       | 29/100 [03:21<06:21,  5.37s/it]Best trial: 16. Best value: 0.716174:  30%|███       | 30/100 [03:21<06:20,  5.43s/it]Best trial: 16. Best value: 0.716174:  30%|███       | 30/100 [03:29<06:20,  5.43s/it]Best trial: 16. Best value: 0.716174:  31%|███       | 31/100 [03:29<07:11,  6.25s/it]Best trial: 16. Best value: 0.716174:  31%|███       | 31/100 [03:34<07:11,  6.25s/it]Best trial: 16. Best value: 0.716174:  32%|███▏      | 32/100 [03:34<06:30,  5.74s/it]Best trial: 16. Best value: 0.716174:  32%|███▏      | 32/100 [03:37<06:30,  5.74s/it]Best trial: 16. Best value: 0.716174:  33%|███▎      | 33/100 [03:37<05:38,  5.06s/it]Best trial: 33. Best value: 0.717724:  33%|███▎      | 33/100 [03:43<05:38,  5.06s/it]Best trial: 33. Best value: 0.717724:  34%|███▍      | 34/100 [03:43<05:34,  5.07s/it]Best trial: 33. Best value: 0.717724:  34%|███▍      | 34/100 [03:49<05:34,  5.07s/it]Best trial: 33. Best value: 0.717724:  35%|███▌      | 35/100 [03:49<05:51,  5.41s/it]Best trial: 33. Best value: 0.717724:  35%|███▌      | 35/100 [03:53<05:51,  5.41s/it]Best trial: 33. Best value: 0.717724:  36%|███▌      | 36/100 [03:53<05:20,  5.00s/it]Best trial: 33. Best value: 0.717724:  36%|███▌      | 36/100 [03:59<05:20,  5.00s/it]Best trial: 33. Best value: 0.717724:  37%|███▋      | 37/100 [03:59<05:40,  5.40s/it]Best trial: 33. Best value: 0.717724:  37%|███▋      | 37/100 [04:06<05:40,  5.40s/it]Best trial: 33. Best value: 0.717724:  38%|███▊      | 38/100 [04:06<06:00,  5.81s/it]Best trial: 33. Best value: 0.717724:  38%|███▊      | 38/100 [04:13<06:00,  5.81s/it]Best trial: 33. Best value: 0.717724:  39%|███▉      | 39/100 [04:13<06:25,  6.32s/it]Best trial: 33. Best value: 0.717724:  39%|███▉      | 39/100 [04:23<06:25,  6.32s/it]Best trial: 33. Best value: 0.717724:  40%|████      | 40/100 [04:23<07:24,  7.41s/it]Best trial: 33. Best value: 0.717724:  40%|████      | 40/100 [04:33<07:24,  7.41s/it]Best trial: 33. Best value: 0.717724:  41%|████      | 41/100 [04:33<08:03,  8.19s/it]Best trial: 33. Best value: 0.717724:  41%|████      | 41/100 [04:38<08:03,  8.19s/it]Best trial: 33. Best value: 0.717724:  42%|████▏     | 42/100 [04:38<06:46,  7.01s/it]Best trial: 33. Best value: 0.717724:  42%|████▏     | 42/100 [04:41<06:46,  7.01s/it]Best trial: 33. Best value: 0.717724:  43%|████▎     | 43/100 [04:41<05:37,  5.92s/it]Best trial: 33. Best value: 0.717724:  43%|████▎     | 43/100 [04:47<05:37,  5.92s/it]Best trial: 33. Best value: 0.717724:  44%|████▍     | 44/100 [04:47<05:26,  5.83s/it]Best trial: 33. Best value: 0.717724:  44%|████▍     | 44/100 [04:54<05:26,  5.83s/it]Best trial: 33. Best value: 0.717724:  45%|████▌     | 45/100 [04:54<05:49,  6.36s/it]Best trial: 33. Best value: 0.717724:  45%|████▌     | 45/100 [04:58<05:49,  6.36s/it]Best trial: 33. Best value: 0.717724:  46%|████▌     | 46/100 [04:58<05:02,  5.60s/it]Best trial: 33. Best value: 0.717724:  46%|████▌     | 46/100 [05:06<05:02,  5.60s/it]Best trial: 33. Best value: 0.717724:  47%|████▋     | 47/100 [05:06<05:29,  6.22s/it]Best trial: 33. Best value: 0.717724:  47%|████▋     | 47/100 [05:11<05:29,  6.22s/it]Best trial: 33. Best value: 0.717724:  48%|████▊     | 48/100 [05:11<05:10,  5.98s/it]Best trial: 33. Best value: 0.717724:  48%|████▊     | 48/100 [05:18<05:10,  5.98s/it]Best trial: 33. Best value: 0.717724:  49%|████▉     | 49/100 [05:18<05:22,  6.31s/it]Best trial: 33. Best value: 0.717724:  49%|████▉     | 49/100 [05:24<05:22,  6.31s/it]Best trial: 33. Best value: 0.717724:  50%|█████     | 50/100 [05:24<05:14,  6.29s/it]Best trial: 33. Best value: 0.717724:  50%|█████     | 50/100 [05:31<05:14,  6.29s/it]Best trial: 33. Best value: 0.717724:  51%|█████     | 51/100 [05:31<05:12,  6.37s/it]Best trial: 33. Best value: 0.717724:  51%|█████     | 51/100 [05:35<05:12,  6.37s/it]Best trial: 33. Best value: 0.717724:  52%|█████▏    | 52/100 [05:35<04:28,  5.59s/it]Best trial: 33. Best value: 0.717724:  52%|█████▏    | 52/100 [05:38<04:28,  5.59s/it]Best trial: 33. Best value: 0.717724:  53%|█████▎    | 53/100 [05:38<03:46,  4.81s/it]Best trial: 33. Best value: 0.717724:  53%|█████▎    | 53/100 [05:43<03:46,  4.81s/it]Best trial: 33. Best value: 0.717724:  54%|█████▍    | 54/100 [05:43<03:44,  4.88s/it]Best trial: 33. Best value: 0.717724:  54%|█████▍    | 54/100 [05:46<03:44,  4.88s/it]Best trial: 33. Best value: 0.717724:  55%|█████▌    | 55/100 [05:46<03:17,  4.39s/it]Best trial: 33. Best value: 0.717724:  55%|█████▌    | 55/100 [05:50<03:17,  4.39s/it]Best trial: 33. Best value: 0.717724:  56%|█████▌    | 56/100 [05:50<03:00,  4.11s/it]Best trial: 33. Best value: 0.717724:  56%|█████▌    | 56/100 [05:54<03:00,  4.11s/it]Best trial: 33. Best value: 0.717724:  57%|█████▋    | 57/100 [05:54<02:59,  4.18s/it]Best trial: 33. Best value: 0.717724:  57%|█████▋    | 57/100 [05:59<02:59,  4.18s/it]Best trial: 33. Best value: 0.717724:  58%|█████▊    | 58/100 [05:59<03:05,  4.42s/it]Best trial: 33. Best value: 0.717724:  58%|█████▊    | 58/100 [06:03<03:05,  4.42s/it]Best trial: 33. Best value: 0.717724:  59%|█████▉    | 59/100 [06:03<02:56,  4.29s/it]Best trial: 33. Best value: 0.717724:  59%|█████▉    | 59/100 [06:07<02:56,  4.29s/it]Best trial: 33. Best value: 0.717724:  60%|██████    | 60/100 [06:07<02:45,  4.14s/it]Best trial: 33. Best value: 0.717724:  60%|██████    | 60/100 [06:15<02:45,  4.14s/it]Best trial: 33. Best value: 0.717724:  61%|██████    | 61/100 [06:15<03:29,  5.38s/it]Best trial: 33. Best value: 0.717724:  61%|██████    | 61/100 [06:20<03:29,  5.38s/it]Best trial: 33. Best value: 0.717724:  62%|██████▏   | 62/100 [06:20<03:21,  5.30s/it]Best trial: 62. Best value: 0.720004:  62%|██████▏   | 62/100 [06:24<03:21,  5.30s/it]Best trial: 62. Best value: 0.720004:  63%|██████▎   | 63/100 [06:24<03:00,  4.87s/it]Best trial: 62. Best value: 0.720004:  63%|██████▎   | 63/100 [06:29<03:00,  4.87s/it]Best trial: 62. Best value: 0.720004:  64%|██████▍   | 64/100 [06:29<02:57,  4.92s/it]Best trial: 62. Best value: 0.720004:  64%|██████▍   | 64/100 [06:41<02:57,  4.92s/it]Best trial: 62. Best value: 0.720004:  65%|██████▌   | 65/100 [06:41<04:02,  6.94s/it]Best trial: 62. Best value: 0.720004:  65%|██████▌   | 65/100 [06:46<04:02,  6.94s/it]Best trial: 62. Best value: 0.720004:  66%|██████▌   | 66/100 [06:46<03:44,  6.60s/it]Best trial: 62. Best value: 0.720004:  66%|██████▌   | 66/100 [06:53<03:44,  6.60s/it]Best trial: 62. Best value: 0.720004:  67%|██████▋   | 67/100 [06:53<03:37,  6.60s/it]Best trial: 62. Best value: 0.720004:  67%|██████▋   | 67/100 [06:58<03:37,  6.60s/it]Best trial: 62. Best value: 0.720004:  68%|██████▊   | 68/100 [06:58<03:13,  6.05s/it]Best trial: 62. Best value: 0.720004:  68%|██████▊   | 68/100 [07:08<03:13,  6.05s/it]Best trial: 62. Best value: 0.720004:  69%|██████▉   | 69/100 [07:08<03:47,  7.34s/it]Best trial: 62. Best value: 0.720004:  69%|██████▉   | 69/100 [07:17<03:47,  7.34s/it]Best trial: 62. Best value: 0.720004:  70%|███████   | 70/100 [07:17<03:52,  7.74s/it]Best trial: 62. Best value: 0.720004:  70%|███████   | 70/100 [07:24<03:52,  7.74s/it]Best trial: 62. Best value: 0.720004:  71%|███████   | 71/100 [07:24<03:41,  7.63s/it]Best trial: 62. Best value: 0.720004:  71%|███████   | 71/100 [07:30<03:41,  7.63s/it]Best trial: 62. Best value: 0.720004:  72%|███████▏  | 72/100 [07:30<03:19,  7.12s/it]Best trial: 62. Best value: 0.720004:  72%|███████▏  | 72/100 [07:37<03:19,  7.12s/it]Best trial: 62. Best value: 0.720004:  73%|███████▎  | 73/100 [07:37<03:10,  7.07s/it]Best trial: 62. Best value: 0.720004:  73%|███████▎  | 73/100 [07:42<03:10,  7.07s/it]Best trial: 62. Best value: 0.720004:  74%|███████▍  | 74/100 [07:42<02:43,  6.30s/it]Best trial: 62. Best value: 0.720004:  74%|███████▍  | 74/100 [07:46<02:43,  6.30s/it]Best trial: 62. Best value: 0.720004:  75%|███████▌  | 75/100 [07:46<02:22,  5.69s/it]Best trial: 62. Best value: 0.720004:  75%|███████▌  | 75/100 [07:50<02:22,  5.69s/it]Best trial: 62. Best value: 0.720004:  76%|███████▌  | 76/100 [07:50<02:09,  5.39s/it]Best trial: 62. Best value: 0.720004:  76%|███████▌  | 76/100 [07:57<02:09,  5.39s/it]Best trial: 62. Best value: 0.720004:  77%|███████▋  | 77/100 [07:57<02:11,  5.70s/it]Best trial: 62. Best value: 0.720004:  77%|███████▋  | 77/100 [08:01<02:11,  5.70s/it]Best trial: 62. Best value: 0.720004:  78%|███████▊  | 78/100 [08:01<01:53,  5.16s/it]Best trial: 62. Best value: 0.720004:  78%|███████▊  | 78/100 [08:08<01:53,  5.16s/it]Best trial: 62. Best value: 0.720004:  79%|███████▉  | 79/100 [08:08<01:59,  5.71s/it]Best trial: 62. Best value: 0.720004:  79%|███████▉  | 79/100 [08:18<01:59,  5.71s/it]Best trial: 62. Best value: 0.720004:  80%|████████  | 80/100 [08:18<02:18,  6.92s/it]Best trial: 62. Best value: 0.720004:  80%|████████  | 80/100 [08:24<02:18,  6.92s/it]Best trial: 62. Best value: 0.720004:  81%|████████  | 81/100 [08:24<02:11,  6.92s/it]Best trial: 62. Best value: 0.720004:  81%|████████  | 81/100 [08:29<02:11,  6.92s/it]Best trial: 62. Best value: 0.720004:  82%|████████▏ | 82/100 [08:29<01:53,  6.29s/it]Best trial: 62. Best value: 0.720004:  82%|████████▏ | 82/100 [08:33<01:53,  6.29s/it]Best trial: 62. Best value: 0.720004:  83%|████████▎ | 83/100 [08:33<01:35,  5.60s/it]Best trial: 62. Best value: 0.720004:  83%|████████▎ | 83/100 [08:40<01:35,  5.60s/it]Best trial: 62. Best value: 0.720004:  84%|████████▍ | 84/100 [08:40<01:33,  5.87s/it]Best trial: 62. Best value: 0.720004:  84%|████████▍ | 84/100 [08:45<01:33,  5.87s/it]Best trial: 62. Best value: 0.720004:  85%|████████▌ | 85/100 [08:45<01:24,  5.66s/it]Best trial: 85. Best value: 0.720614:  85%|████████▌ | 85/100 [08:49<01:24,  5.66s/it]Best trial: 85. Best value: 0.720614:  86%|████████▌ | 86/100 [08:49<01:13,  5.27s/it]Best trial: 85. Best value: 0.720614:  86%|████████▌ | 86/100 [08:54<01:13,  5.27s/it]Best trial: 85. Best value: 0.720614:  87%|████████▋ | 87/100 [08:54<01:05,  5.06s/it]Best trial: 85. Best value: 0.720614:  87%|████████▋ | 87/100 [08:58<01:05,  5.06s/it]Best trial: 85. Best value: 0.720614:  88%|████████▊ | 88/100 [08:58<00:58,  4.86s/it]Best trial: 85. Best value: 0.720614:  88%|████████▊ | 88/100 [09:02<00:58,  4.86s/it]Best trial: 85. Best value: 0.720614:  89%|████████▉ | 89/100 [09:02<00:50,  4.59s/it]Best trial: 85. Best value: 0.720614:  89%|████████▉ | 89/100 [09:07<00:50,  4.59s/it]Best trial: 85. Best value: 0.720614:  90%|█████████ | 90/100 [09:07<00:45,  4.57s/it]Best trial: 85. Best value: 0.720614:  90%|█████████ | 90/100 [09:11<00:45,  4.57s/it]Best trial: 85. Best value: 0.720614:  91%|█████████ | 91/100 [09:11<00:41,  4.58s/it]Best trial: 85. Best value: 0.720614:  91%|█████████ | 91/100 [09:16<00:41,  4.58s/it]Best trial: 85. Best value: 0.720614:  92%|█████████▏| 92/100 [09:16<00:35,  4.49s/it]Best trial: 85. Best value: 0.720614:  92%|█████████▏| 92/100 [09:20<00:35,  4.49s/it]Best trial: 85. Best value: 0.720614:  93%|█████████▎| 93/100 [09:20<00:31,  4.54s/it]Best trial: 85. Best value: 0.720614:  93%|█████████▎| 93/100 [09:24<00:31,  4.54s/it]Best trial: 85. Best value: 0.720614:  94%|█████████▍| 94/100 [09:24<00:25,  4.24s/it]Best trial: 85. Best value: 0.720614:  94%|█████████▍| 94/100 [09:28<00:25,  4.24s/it]Best trial: 85. Best value: 0.720614:  95%|█████████▌| 95/100 [09:28<00:21,  4.26s/it]Best trial: 85. Best value: 0.720614:  95%|█████████▌| 95/100 [09:33<00:21,  4.26s/it]Best trial: 85. Best value: 0.720614:  96%|█████████▌| 96/100 [09:33<00:17,  4.40s/it]Best trial: 85. Best value: 0.720614:  96%|█████████▌| 96/100 [09:37<00:17,  4.40s/it]Best trial: 85. Best value: 0.720614:  97%|█████████▋| 97/100 [09:37<00:12,  4.30s/it]Best trial: 85. Best value: 0.720614:  97%|█████████▋| 97/100 [09:42<00:12,  4.30s/it]Best trial: 85. Best value: 0.720614:  98%|█████████▊| 98/100 [09:42<00:09,  4.54s/it]Best trial: 85. Best value: 0.720614:  98%|█████████▊| 98/100 [09:47<00:09,  4.54s/it]Best trial: 85. Best value: 0.720614:  99%|█████████▉| 99/100 [09:47<00:04,  4.67s/it]Best trial: 85. Best value: 0.720614:  99%|█████████▉| 99/100 [09:50<00:04,  4.67s/it]Best trial: 85. Best value: 0.720614: 100%|██████████| 100/100 [09:50<00:00,  4.20s/it]Best trial: 85. Best value: 0.720614: 100%|██████████| 100/100 [09:50<00:00,  5.91s/it]
2025-12-01 05:50:26,066 - INFO - HPO Complete. Best AUPRC: 0.7206
2025-12-01 05:50:26,067 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.090740993751643, 'max_depth': 3, 'subsample': 0.9889034088969535, 'colsample_bytree': 0.6327383256371191, 'gamma': 2.2361113837638924, 'reg_lambda': 2.7882612071666036e-07, 'reg_alpha': 1.6063978444806802e-06}
2025-12-01 05:50:26,067 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 05:50:28,239 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_co2
2025-12-01 05:50:28,239 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:50:28,479 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:50:28,516 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:50:28,525 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:50:28,525 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 05:50:28,525 - INFO - Training model...
2025-12-01 05:50:29,942 - INFO - Evaluating model with bootstrapping...
2025-12-01 05:50:35,564 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 05:50:35,565 - INFO - AUROC: 0.8789 (0.8515 - 0.9057)
2025-12-01 05:50:35,565 - INFO - AUPRC: 0.7140 (0.6611 - 0.7680)
2025-12-01 05:50:35,565 - INFO - Brier Score: 0.1074 (0.0960 - 0.1224)
2025-12-01 05:50:35,565 - INFO - Accuracy: 0.8468 (0.8329 - 0.8841)
2025-12-01 05:50:35,565 - INFO - Precision: 0.6095 (0.5648 - 0.7852)
2025-12-01 05:50:35,565 - INFO - Sensitivity (Recall): 0.7203 (0.5362 - 0.7487)
2025-12-01 05:50:35,565 - INFO - F1-Score: 0.6603 (0.6201 - 0.7162)
2025-12-01 05:50:35,565 - INFO - Best Threshold: 0.4500 (0.4280 - 0.6600)
2025-12-01 05:50:35,565 - INFO - Specificity: 0.8798 (0.8657 - 0.9582)
2025-12-01 05:50:35,577 - INFO - Calculating SHAP values...
2025-12-01 05:50:36,711 - INFO - SHAP plots saved.
2025-12-01 05:50:36,713 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_awp
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 05:50:38,310 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_awp
2025-12-01 05:50:38,311 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 05:50:38,547 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 05:50:38,585 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 05:50:38,593 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 05:50:38,593 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.708824:   0%|          | 0/100 [00:07<?, ?it/s]Best trial: 0. Best value: 0.708824:   1%|          | 1/100 [00:07<12:31,  7.59s/it]Best trial: 0. Best value: 0.708824:   1%|          | 1/100 [00:22<12:31,  7.59s/it]Best trial: 0. Best value: 0.708824:   2%|▏         | 2/100 [00:22<19:40, 12.05s/it]Best trial: 0. Best value: 0.708824:   2%|▏         | 2/100 [00:28<19:40, 12.05s/it]Best trial: 0. Best value: 0.708824:   3%|▎         | 3/100 [00:28<14:45,  9.13s/it]Best trial: 0. Best value: 0.708824:   3%|▎         | 3/100 [00:40<14:45,  9.13s/it]Best trial: 0. Best value: 0.708824:   4%|▍         | 4/100 [00:40<16:42, 10.45s/it]Best trial: 0. Best value: 0.708824:   4%|▍         | 4/100 [00:59<16:42, 10.45s/it]Best trial: 0. Best value: 0.708824:   5%|▌         | 5/100 [00:59<21:18, 13.45s/it]Best trial: 0. Best value: 0.708824:   5%|▌         | 5/100 [01:07<21:18, 13.45s/it]Best trial: 0. Best value: 0.708824:   6%|▌         | 6/100 [01:07<18:18, 11.69s/it]Best trial: 0. Best value: 0.708824:   6%|▌         | 6/100 [01:10<18:18, 11.69s/it]Best trial: 0. Best value: 0.708824:   7%|▋         | 7/100 [01:10<13:27,  8.69s/it]Best trial: 0. Best value: 0.708824:   7%|▋         | 7/100 [01:12<13:27,  8.69s/it]Best trial: 0. Best value: 0.708824:   8%|▊         | 8/100 [01:12<10:18,  6.72s/it]Best trial: 0. Best value: 0.708824:   8%|▊         | 8/100 [01:16<10:18,  6.72s/it]Best trial: 0. Best value: 0.708824:   9%|▉         | 9/100 [01:16<08:31,  5.62s/it]Best trial: 0. Best value: 0.708824:   9%|▉         | 9/100 [01:26<08:31,  5.62s/it]Best trial: 0. Best value: 0.708824:  10%|█         | 10/100 [01:26<10:50,  7.23s/it]Best trial: 0. Best value: 0.708824:  10%|█         | 10/100 [01:37<10:50,  7.23s/it]Best trial: 0. Best value: 0.708824:  11%|█         | 11/100 [01:37<12:04,  8.14s/it]Best trial: 11. Best value: 0.720442:  11%|█         | 11/100 [01:41<12:04,  8.14s/it]Best trial: 11. Best value: 0.720442:  12%|█▏        | 12/100 [01:41<10:15,  6.99s/it]Best trial: 11. Best value: 0.720442:  12%|█▏        | 12/100 [01:46<10:15,  6.99s/it]Best trial: 11. Best value: 0.720442:  13%|█▎        | 13/100 [01:46<09:17,  6.41s/it]Best trial: 11. Best value: 0.720442:  13%|█▎        | 13/100 [01:52<09:17,  6.41s/it]Best trial: 11. Best value: 0.720442:  14%|█▍        | 14/100 [01:52<08:58,  6.26s/it]Best trial: 11. Best value: 0.720442:  14%|█▍        | 14/100 [01:58<08:58,  6.26s/it]Best trial: 11. Best value: 0.720442:  15%|█▌        | 15/100 [01:58<08:37,  6.08s/it]Best trial: 11. Best value: 0.720442:  15%|█▌        | 15/100 [02:01<08:37,  6.08s/it]Best trial: 11. Best value: 0.720442:  16%|█▌        | 16/100 [02:01<07:08,  5.10s/it]Best trial: 11. Best value: 0.720442:  16%|█▌        | 16/100 [02:10<07:08,  5.10s/it]Best trial: 11. Best value: 0.720442:  17%|█▋        | 17/100 [02:10<08:48,  6.37s/it]Best trial: 11. Best value: 0.720442:  17%|█▋        | 17/100 [02:13<08:48,  6.37s/it]Best trial: 11. Best value: 0.720442:  18%|█▊        | 18/100 [02:13<07:30,  5.49s/it]Best trial: 11. Best value: 0.720442:  18%|█▊        | 18/100 [02:19<07:30,  5.49s/it]Best trial: 11. Best value: 0.720442:  19%|█▉        | 19/100 [02:19<07:39,  5.67s/it]Best trial: 11. Best value: 0.720442:  19%|█▉        | 19/100 [02:33<07:39,  5.67s/it]Best trial: 11. Best value: 0.720442:  20%|██        | 20/100 [02:33<10:35,  7.95s/it]Best trial: 11. Best value: 0.720442:  20%|██        | 20/100 [02:39<10:35,  7.95s/it]Best trial: 11. Best value: 0.720442:  21%|██        | 21/100 [02:39<09:52,  7.50s/it]Best trial: 11. Best value: 0.720442:  21%|██        | 21/100 [02:45<09:52,  7.50s/it]Best trial: 11. Best value: 0.720442:  22%|██▏       | 22/100 [02:45<09:10,  7.06s/it]Best trial: 11. Best value: 0.720442:  22%|██▏       | 22/100 [02:51<09:10,  7.06s/it]Best trial: 11. Best value: 0.720442:  23%|██▎       | 23/100 [02:51<08:25,  6.56s/it]Best trial: 11. Best value: 0.720442:  23%|██▎       | 23/100 [02:58<08:25,  6.56s/it]Best trial: 11. Best value: 0.720442:  24%|██▍       | 24/100 [02:58<08:29,  6.71s/it]Best trial: 11. Best value: 0.720442:  24%|██▍       | 24/100 [03:04<08:29,  6.71s/it]Best trial: 11. Best value: 0.720442:  25%|██▌       | 25/100 [03:04<08:23,  6.71s/it]Best trial: 11. Best value: 0.720442:  25%|██▌       | 25/100 [03:09<08:23,  6.71s/it]Best trial: 11. Best value: 0.720442:  26%|██▌       | 26/100 [03:09<07:37,  6.18s/it]Best trial: 11. Best value: 0.720442:  26%|██▌       | 26/100 [03:18<07:37,  6.18s/it]Best trial: 11. Best value: 0.720442:  27%|██▋       | 27/100 [03:18<08:19,  6.84s/it]Best trial: 11. Best value: 0.720442:  27%|██▋       | 27/100 [03:23<08:19,  6.84s/it]Best trial: 11. Best value: 0.720442:  28%|██▊       | 28/100 [03:23<07:46,  6.49s/it]Best trial: 11. Best value: 0.720442:  28%|██▊       | 28/100 [03:28<07:46,  6.49s/it]Best trial: 11. Best value: 0.720442:  29%|██▉       | 29/100 [03:28<07:04,  5.98s/it]Best trial: 11. Best value: 0.720442:  29%|██▉       | 29/100 [03:31<07:04,  5.98s/it]Best trial: 11. Best value: 0.720442:  30%|███       | 30/100 [03:31<05:55,  5.08s/it]Best trial: 11. Best value: 0.720442:  30%|███       | 30/100 [03:35<05:55,  5.08s/it]Best trial: 11. Best value: 0.720442:  31%|███       | 31/100 [03:35<05:30,  4.79s/it]Best trial: 11. Best value: 0.720442:  31%|███       | 31/100 [03:41<05:30,  4.79s/it]Best trial: 11. Best value: 0.720442:  32%|███▏      | 32/100 [03:41<05:50,  5.16s/it]Best trial: 11. Best value: 0.720442:  32%|███▏      | 32/100 [03:48<05:50,  5.16s/it]Best trial: 11. Best value: 0.720442:  33%|███▎      | 33/100 [03:48<06:20,  5.67s/it]Best trial: 11. Best value: 0.720442:  33%|███▎      | 33/100 [03:52<06:20,  5.67s/it]Best trial: 11. Best value: 0.720442:  34%|███▍      | 34/100 [03:52<05:42,  5.20s/it]Best trial: 11. Best value: 0.720442:  34%|███▍      | 34/100 [04:05<05:42,  5.20s/it]Best trial: 11. Best value: 0.720442:  35%|███▌      | 35/100 [04:05<08:03,  7.44s/it]Best trial: 11. Best value: 0.720442:  35%|███▌      | 35/100 [04:09<08:03,  7.44s/it]Best trial: 11. Best value: 0.720442:  36%|███▌      | 36/100 [04:09<06:51,  6.43s/it]Best trial: 11. Best value: 0.720442:  36%|███▌      | 36/100 [04:22<06:51,  6.43s/it]Best trial: 11. Best value: 0.720442:  37%|███▋      | 37/100 [04:22<08:50,  8.42s/it]Best trial: 11. Best value: 0.720442:  37%|███▋      | 37/100 [04:28<08:50,  8.42s/it]Best trial: 11. Best value: 0.720442:  38%|███▊      | 38/100 [04:28<08:00,  7.75s/it]Best trial: 11. Best value: 0.720442:  38%|███▊      | 38/100 [04:34<08:00,  7.75s/it]Best trial: 11. Best value: 0.720442:  39%|███▉      | 39/100 [04:34<07:15,  7.14s/it]Best trial: 11. Best value: 0.720442:  39%|███▉      | 39/100 [04:43<07:15,  7.14s/it]Best trial: 11. Best value: 0.720442:  40%|████      | 40/100 [04:43<07:46,  7.77s/it]Best trial: 11. Best value: 0.720442:  40%|████      | 40/100 [04:46<07:46,  7.77s/it]Best trial: 11. Best value: 0.720442:  41%|████      | 41/100 [04:46<06:20,  6.46s/it]Best trial: 11. Best value: 0.720442:  41%|████      | 41/100 [04:53<06:20,  6.46s/it]Best trial: 11. Best value: 0.720442:  42%|████▏     | 42/100 [04:53<06:13,  6.44s/it]Best trial: 11. Best value: 0.720442:  42%|████▏     | 42/100 [04:59<06:13,  6.44s/it]Best trial: 11. Best value: 0.720442:  43%|████▎     | 43/100 [04:59<05:55,  6.23s/it]Best trial: 11. Best value: 0.720442:  43%|████▎     | 43/100 [05:09<05:55,  6.23s/it]Best trial: 11. Best value: 0.720442:  44%|████▍     | 44/100 [05:09<06:56,  7.45s/it]Best trial: 11. Best value: 0.720442:  44%|████▍     | 44/100 [05:12<06:56,  7.45s/it]Best trial: 11. Best value: 0.720442:  45%|████▌     | 45/100 [05:12<05:32,  6.04s/it]Best trial: 11. Best value: 0.720442:  45%|████▌     | 45/100 [05:22<05:32,  6.04s/it]Best trial: 11. Best value: 0.720442:  46%|████▌     | 46/100 [05:22<06:28,  7.20s/it]Best trial: 11. Best value: 0.720442:  46%|████▌     | 46/100 [05:28<06:28,  7.20s/it]Best trial: 11. Best value: 0.720442:  47%|████▋     | 47/100 [05:28<06:13,  7.04s/it]Best trial: 11. Best value: 0.720442:  47%|████▋     | 47/100 [05:33<06:13,  7.04s/it]Best trial: 11. Best value: 0.720442:  48%|████▊     | 48/100 [05:33<05:35,  6.44s/it]Best trial: 11. Best value: 0.720442:  48%|████▊     | 48/100 [05:43<05:35,  6.44s/it]Best trial: 11. Best value: 0.720442:  49%|████▉     | 49/100 [05:43<06:12,  7.30s/it]Best trial: 11. Best value: 0.720442:  49%|████▉     | 49/100 [05:49<06:12,  7.30s/it]Best trial: 11. Best value: 0.720442:  50%|█████     | 50/100 [05:49<05:57,  7.16s/it]Best trial: 11. Best value: 0.720442:  50%|█████     | 50/100 [05:55<05:57,  7.16s/it]Best trial: 11. Best value: 0.720442:  51%|█████     | 51/100 [05:55<05:34,  6.83s/it]Best trial: 11. Best value: 0.720442:  51%|█████     | 51/100 [06:02<05:34,  6.83s/it]Best trial: 11. Best value: 0.720442:  52%|█████▏    | 52/100 [06:02<05:20,  6.68s/it]Best trial: 52. Best value: 0.72226:  52%|█████▏    | 52/100 [06:10<05:20,  6.68s/it] Best trial: 52. Best value: 0.72226:  53%|█████▎    | 53/100 [06:10<05:34,  7.12s/it]Best trial: 52. Best value: 0.72226:  53%|█████▎    | 53/100 [06:20<05:34,  7.12s/it]Best trial: 52. Best value: 0.72226:  54%|█████▍    | 54/100 [06:20<06:08,  8.01s/it]Best trial: 52. Best value: 0.72226:  54%|█████▍    | 54/100 [06:29<06:08,  8.01s/it]Best trial: 52. Best value: 0.72226:  55%|█████▌    | 55/100 [06:29<06:15,  8.34s/it]Best trial: 52. Best value: 0.72226:  55%|█████▌    | 55/100 [06:36<06:15,  8.34s/it]Best trial: 52. Best value: 0.72226:  56%|█████▌    | 56/100 [06:36<05:52,  8.01s/it]Best trial: 52. Best value: 0.72226:  56%|█████▌    | 56/100 [06:45<05:52,  8.01s/it]Best trial: 52. Best value: 0.72226:  57%|█████▋    | 57/100 [06:45<05:58,  8.34s/it]Best trial: 52. Best value: 0.72226:  57%|█████▋    | 57/100 [06:52<05:58,  8.34s/it]Best trial: 52. Best value: 0.72226:  58%|█████▊    | 58/100 [06:52<05:22,  7.69s/it]Best trial: 52. Best value: 0.72226:  58%|█████▊    | 58/100 [06:57<05:22,  7.69s/it]Best trial: 52. Best value: 0.72226:  59%|█████▉    | 59/100 [06:57<04:45,  6.96s/it]Best trial: 52. Best value: 0.72226:  59%|█████▉    | 59/100 [07:01<04:45,  6.96s/it]Best trial: 52. Best value: 0.72226:  60%|██████    | 60/100 [07:01<04:04,  6.12s/it]Best trial: 52. Best value: 0.72226:  60%|██████    | 60/100 [07:08<04:04,  6.12s/it]Best trial: 52. Best value: 0.72226:  61%|██████    | 61/100 [07:08<04:08,  6.38s/it]Best trial: 52. Best value: 0.72226:  61%|██████    | 61/100 [07:17<04:08,  6.38s/it]Best trial: 52. Best value: 0.72226:  62%|██████▏   | 62/100 [07:17<04:32,  7.18s/it]Best trial: 62. Best value: 0.722926:  62%|██████▏   | 62/100 [07:28<04:32,  7.18s/it]Best trial: 62. Best value: 0.722926:  63%|██████▎   | 63/100 [07:28<05:03,  8.19s/it]Best trial: 62. Best value: 0.722926:  63%|██████▎   | 63/100 [07:36<05:03,  8.19s/it]Best trial: 62. Best value: 0.722926:  64%|██████▍   | 64/100 [07:36<04:56,  8.23s/it]Best trial: 62. Best value: 0.722926:  64%|██████▍   | 64/100 [07:44<04:56,  8.23s/it]Best trial: 62. Best value: 0.722926:  65%|██████▌   | 65/100 [07:44<04:50,  8.29s/it]Best trial: 62. Best value: 0.722926:  65%|██████▌   | 65/100 [07:56<04:50,  8.29s/it]Best trial: 62. Best value: 0.722926:  66%|██████▌   | 66/100 [07:56<05:10,  9.14s/it]Best trial: 62. Best value: 0.722926:  66%|██████▌   | 66/100 [08:05<05:10,  9.14s/it]Best trial: 62. Best value: 0.722926:  67%|██████▋   | 67/100 [08:05<05:01,  9.12s/it]Best trial: 62. Best value: 0.722926:  67%|██████▋   | 67/100 [08:12<05:01,  9.12s/it]Best trial: 62. Best value: 0.722926:  68%|██████▊   | 68/100 [08:12<04:34,  8.58s/it]Best trial: 62. Best value: 0.722926:  68%|██████▊   | 68/100 [08:17<04:34,  8.58s/it]Best trial: 62. Best value: 0.722926:  69%|██████▉   | 69/100 [08:17<03:49,  7.40s/it]Best trial: 62. Best value: 0.722926:  69%|██████▉   | 69/100 [08:20<03:49,  7.40s/it]Best trial: 62. Best value: 0.722926:  70%|███████   | 70/100 [08:20<03:07,  6.24s/it]Best trial: 62. Best value: 0.722926:  70%|███████   | 70/100 [08:27<03:07,  6.24s/it]Best trial: 62. Best value: 0.722926:  71%|███████   | 71/100 [08:27<03:08,  6.49s/it]Best trial: 62. Best value: 0.722926:  71%|███████   | 71/100 [08:32<03:08,  6.49s/it]Best trial: 62. Best value: 0.722926:  72%|███████▏  | 72/100 [08:32<02:45,  5.90s/it]Best trial: 62. Best value: 0.722926:  72%|███████▏  | 72/100 [08:38<02:45,  5.90s/it]Best trial: 62. Best value: 0.722926:  73%|███████▎  | 73/100 [08:38<02:44,  6.10s/it]Best trial: 62. Best value: 0.722926:  73%|███████▎  | 73/100 [08:44<02:44,  6.10s/it]Best trial: 62. Best value: 0.722926:  74%|███████▍  | 74/100 [08:44<02:34,  5.95s/it]Best trial: 62. Best value: 0.722926:  74%|███████▍  | 74/100 [08:53<02:34,  5.95s/it]Best trial: 62. Best value: 0.722926:  75%|███████▌  | 75/100 [08:53<02:52,  6.91s/it]Best trial: 62. Best value: 0.722926:  75%|███████▌  | 75/100 [09:03<02:52,  6.91s/it]Best trial: 62. Best value: 0.722926:  76%|███████▌  | 76/100 [09:03<03:06,  7.78s/it]Best trial: 62. Best value: 0.722926:  76%|███████▌  | 76/100 [09:09<03:06,  7.78s/it]Best trial: 62. Best value: 0.722926:  77%|███████▋  | 77/100 [09:09<02:47,  7.27s/it]Best trial: 62. Best value: 0.722926:  77%|███████▋  | 77/100 [09:15<02:47,  7.27s/it]Best trial: 62. Best value: 0.722926:  78%|███████▊  | 78/100 [09:15<02:30,  6.85s/it]Best trial: 62. Best value: 0.722926:  78%|███████▊  | 78/100 [09:22<02:30,  6.85s/it]Best trial: 62. Best value: 0.722926:  79%|███████▉  | 79/100 [09:22<02:26,  6.98s/it]Best trial: 62. Best value: 0.722926:  79%|███████▉  | 79/100 [09:28<02:26,  6.98s/it]Best trial: 62. Best value: 0.722926:  80%|████████  | 80/100 [09:28<02:15,  6.75s/it]Best trial: 62. Best value: 0.722926:  80%|████████  | 80/100 [09:40<02:15,  6.75s/it]Best trial: 62. Best value: 0.722926:  81%|████████  | 81/100 [09:40<02:38,  8.32s/it]Best trial: 62. Best value: 0.722926:  81%|████████  | 81/100 [09:46<02:38,  8.32s/it]Best trial: 62. Best value: 0.722926:  82%|████████▏ | 82/100 [09:46<02:17,  7.62s/it]Best trial: 62. Best value: 0.722926:  82%|████████▏ | 82/100 [09:52<02:17,  7.62s/it]Best trial: 62. Best value: 0.722926:  83%|████████▎ | 83/100 [09:52<02:00,  7.06s/it]Best trial: 62. Best value: 0.722926:  83%|████████▎ | 83/100 [10:03<02:00,  7.06s/it]Best trial: 62. Best value: 0.722926:  84%|████████▍ | 84/100 [10:03<02:10,  8.16s/it]Best trial: 62. Best value: 0.722926:  84%|████████▍ | 84/100 [10:13<02:10,  8.16s/it]Best trial: 62. Best value: 0.722926:  85%|████████▌ | 85/100 [10:13<02:11,  8.80s/it]Best trial: 62. Best value: 0.722926:  85%|████████▌ | 85/100 [10:19<02:11,  8.80s/it]Best trial: 62. Best value: 0.722926:  86%|████████▌ | 86/100 [10:19<01:49,  7.82s/it]Best trial: 62. Best value: 0.722926:  86%|████████▌ | 86/100 [10:24<01:49,  7.82s/it]Best trial: 62. Best value: 0.722926:  87%|████████▋ | 87/100 [10:24<01:33,  7.16s/it]Best trial: 62. Best value: 0.722926:  87%|████████▋ | 87/100 [10:33<01:33,  7.16s/it]Best trial: 62. Best value: 0.722926:  88%|████████▊ | 88/100 [10:33<01:30,  7.56s/it]Best trial: 62. Best value: 0.722926:  88%|████████▊ | 88/100 [10:40<01:30,  7.56s/it]Best trial: 62. Best value: 0.722926:  89%|████████▉ | 89/100 [10:40<01:24,  7.64s/it]Best trial: 62. Best value: 0.722926:  89%|████████▉ | 89/100 [10:43<01:24,  7.64s/it]Best trial: 62. Best value: 0.722926:  90%|█████████ | 90/100 [10:43<01:01,  6.18s/it]Best trial: 62. Best value: 0.722926:  90%|█████████ | 90/100 [10:51<01:01,  6.18s/it]Best trial: 62. Best value: 0.722926:  91%|█████████ | 91/100 [10:51<00:58,  6.55s/it]Best trial: 62. Best value: 0.722926:  91%|█████████ | 91/100 [10:56<00:58,  6.55s/it]Best trial: 62. Best value: 0.722926:  92%|█████████▏| 92/100 [10:56<00:50,  6.33s/it]Best trial: 62. Best value: 0.722926:  92%|█████████▏| 92/100 [11:03<00:50,  6.33s/it]Best trial: 62. Best value: 0.722926:  93%|█████████▎| 93/100 [11:03<00:43,  6.26s/it]Best trial: 62. Best value: 0.722926:  93%|█████████▎| 93/100 [11:13<00:43,  6.26s/it]Best trial: 62. Best value: 0.722926:  94%|█████████▍| 94/100 [11:13<00:45,  7.52s/it]Best trial: 62. Best value: 0.722926:  94%|█████████▍| 94/100 [11:21<00:45,  7.52s/it]Best trial: 62. Best value: 0.722926:  95%|█████████▌| 95/100 [11:21<00:37,  7.55s/it]Best trial: 62. Best value: 0.722926:  95%|█████████▌| 95/100 [11:27<00:37,  7.55s/it]Best trial: 62. Best value: 0.722926:  96%|█████████▌| 96/100 [11:27<00:28,  7.21s/it]Best trial: 62. Best value: 0.722926:  96%|█████████▌| 96/100 [11:32<00:28,  7.21s/it]Best trial: 62. Best value: 0.722926:  97%|█████████▋| 97/100 [11:32<00:19,  6.51s/it]Best trial: 62. Best value: 0.722926:  97%|█████████▋| 97/100 [11:42<00:19,  6.51s/it]Best trial: 62. Best value: 0.722926:  98%|█████████▊| 98/100 [11:42<00:14,  7.49s/it]Best trial: 62. Best value: 0.722926:  98%|█████████▊| 98/100 [11:50<00:14,  7.49s/it]Best trial: 62. Best value: 0.722926:  99%|█████████▉| 99/100 [11:50<00:07,  7.80s/it]Best trial: 62. Best value: 0.722926:  99%|█████████▉| 99/100 [11:56<00:07,  7.80s/it]Best trial: 62. Best value: 0.722926: 100%|██████████| 100/100 [11:56<00:00,  7.22s/it]Best trial: 62. Best value: 0.722926: 100%|██████████| 100/100 [11:56<00:00,  7.17s/it]
2025-12-01 06:02:35,198 - INFO - HPO Complete. Best AUPRC: 0.7229
2025-12-01 06:02:35,199 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.04769491343402987, 'max_depth': 3, 'subsample': 0.9091950769093919, 'colsample_bytree': 0.6185388581434224, 'gamma': 1.323955249244026, 'reg_lambda': 2.65958091369915e-07, 'reg_alpha': 1.9138807433718607e-06}
2025-12-01 06:02:35,199 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 06:02:37,047 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_awp
2025-12-01 06:02:37,047 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:02:37,245 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:02:37,278 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:02:37,286 - INFO - Data prepared. Train shape: (2761, 188), Test shape: (692, 188)
2025-12-01 06:02:37,286 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 06:02:37,286 - INFO - Training model...
2025-12-01 06:02:39,360 - INFO - Evaluating model with bootstrapping...
2025-12-01 06:02:44,997 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 06:02:44,997 - INFO - AUROC: 0.8923 (0.8538 - 0.9097)
2025-12-01 06:02:44,998 - INFO - AUPRC: 0.7243 (0.6664 - 0.7764)
2025-12-01 06:02:44,998 - INFO - Brier Score: 0.1046 (0.0956 - 0.1188)
2025-12-01 06:02:44,998 - INFO - Accuracy: 0.8396 (0.8038 - 0.8948)
2025-12-01 06:02:44,998 - INFO - Precision: 0.5899 (0.5371 - 0.8430)
2025-12-01 06:02:44,998 - INFO - Sensitivity (Recall): 0.7343 (0.5476 - 0.8685)
2025-12-01 06:02:44,998 - INFO - F1-Score: 0.6542 (0.6219 - 0.7129)
2025-12-01 06:02:44,998 - INFO - Best Threshold: 0.4200 (0.2880 - 0.6780)
2025-12-01 06:02:44,998 - INFO - Specificity: 0.8670 (0.7946 - 0.9744)
2025-12-01 06:02:45,009 - INFO - Calculating SHAP values...
2025-12-01 06:02:46,039 - INFO - SHAP plots saved.
2025-12-01 06:02:46,040 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_awp
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_all_minus_pleth
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 06:02:47,194 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-12-01 06:02:47,194 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:02:47,389 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:02:47,454 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:02:47,467 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 06:02:47,467 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.694584:   0%|          | 0/100 [00:22<?, ?it/s]Best trial: 0. Best value: 0.694584:   1%|          | 1/100 [00:22<36:36, 22.19s/it]Best trial: 0. Best value: 0.694584:   1%|          | 1/100 [01:43<36:36, 22.19s/it]Best trial: 0. Best value: 0.694584:   2%|▏         | 2/100 [01:43<1:32:56, 56.90s/it]Best trial: 0. Best value: 0.694584:   2%|▏         | 2/100 [02:21<1:32:56, 56.90s/it]Best trial: 0. Best value: 0.694584:   3%|▎         | 3/100 [02:21<1:18:20, 48.46s/it]Best trial: 0. Best value: 0.694584:   3%|▎         | 3/100 [02:36<1:18:20, 48.46s/it]Best trial: 0. Best value: 0.694584:   4%|▍         | 4/100 [02:36<56:26, 35.28s/it]  Best trial: 0. Best value: 0.694584:   4%|▍         | 4/100 [02:45<56:26, 35.28s/it]Best trial: 0. Best value: 0.694584:   5%|▌         | 5/100 [02:45<40:25, 25.53s/it]Best trial: 5. Best value: 0.697456:   5%|▌         | 5/100 [03:26<40:25, 25.53s/it]Best trial: 5. Best value: 0.697456:   6%|▌         | 6/100 [03:26<48:37, 31.04s/it]Best trial: 5. Best value: 0.697456:   6%|▌         | 6/100 [03:41<48:37, 31.04s/it]Best trial: 5. Best value: 0.697456:   7%|▋         | 7/100 [03:41<40:01, 25.82s/it]Best trial: 7. Best value: 0.728434:   7%|▋         | 7/100 [03:54<40:01, 25.82s/it]Best trial: 7. Best value: 0.728434:   8%|▊         | 8/100 [03:54<33:02, 21.55s/it]Best trial: 7. Best value: 0.728434:   8%|▊         | 8/100 [04:03<33:02, 21.55s/it]Best trial: 7. Best value: 0.728434:   9%|▉         | 9/100 [04:03<26:53, 17.74s/it]Best trial: 7. Best value: 0.728434:   9%|▉         | 9/100 [04:19<26:53, 17.74s/it]Best trial: 7. Best value: 0.728434:  10%|█         | 10/100 [04:19<25:42, 17.14s/it]Best trial: 7. Best value: 0.728434:  10%|█         | 10/100 [04:30<25:42, 17.14s/it]Best trial: 7. Best value: 0.728434:  11%|█         | 11/100 [04:30<22:35, 15.23s/it]Best trial: 7. Best value: 0.728434:  11%|█         | 11/100 [04:39<22:35, 15.23s/it]Best trial: 7. Best value: 0.728434:  12%|█▏        | 12/100 [04:39<19:38, 13.39s/it]Best trial: 7. Best value: 0.728434:  12%|█▏        | 12/100 [04:59<19:38, 13.39s/it]Best trial: 7. Best value: 0.728434:  13%|█▎        | 13/100 [04:59<22:29, 15.51s/it]Best trial: 7. Best value: 0.728434:  13%|█▎        | 13/100 [05:16<22:29, 15.51s/it]Best trial: 7. Best value: 0.728434:  14%|█▍        | 14/100 [05:16<22:38, 15.80s/it]Best trial: 7. Best value: 0.728434:  14%|█▍        | 14/100 [05:36<22:38, 15.80s/it]Best trial: 7. Best value: 0.728434:  15%|█▌        | 15/100 [05:36<24:15, 17.12s/it]Best trial: 7. Best value: 0.728434:  15%|█▌        | 15/100 [05:41<24:15, 17.12s/it]Best trial: 7. Best value: 0.728434:  16%|█▌        | 16/100 [05:41<19:00, 13.57s/it]Best trial: 7. Best value: 0.728434:  16%|█▌        | 16/100 [06:10<19:00, 13.57s/it]Best trial: 7. Best value: 0.728434:  17%|█▋        | 17/100 [06:10<24:51, 17.98s/it]Best trial: 7. Best value: 0.728434:  17%|█▋        | 17/100 [06:25<24:51, 17.98s/it]Best trial: 7. Best value: 0.728434:  18%|█▊        | 18/100 [06:25<23:19, 17.06s/it]Best trial: 7. Best value: 0.728434:  18%|█▊        | 18/100 [06:59<23:19, 17.06s/it]Best trial: 7. Best value: 0.728434:  19%|█▉        | 19/100 [06:59<30:02, 22.25s/it]Best trial: 7. Best value: 0.728434:  19%|█▉        | 19/100 [07:11<30:02, 22.25s/it]Best trial: 7. Best value: 0.728434:  20%|██        | 20/100 [07:11<25:24, 19.06s/it]Best trial: 7. Best value: 0.728434:  20%|██        | 20/100 [07:23<25:24, 19.06s/it]Best trial: 7. Best value: 0.728434:  21%|██        | 21/100 [07:23<22:22, 16.99s/it]Best trial: 7. Best value: 0.728434:  21%|██        | 21/100 [07:46<22:22, 16.99s/it]Best trial: 7. Best value: 0.728434:  22%|██▏       | 22/100 [07:46<24:24, 18.77s/it]Best trial: 7. Best value: 0.728434:  22%|██▏       | 22/100 [08:18<24:24, 18.77s/it]Best trial: 7. Best value: 0.728434:  23%|██▎       | 23/100 [08:18<29:10, 22.73s/it]Best trial: 7. Best value: 0.728434:  23%|██▎       | 23/100 [08:28<29:10, 22.73s/it]Best trial: 7. Best value: 0.728434:  24%|██▍       | 24/100 [08:28<24:09, 19.08s/it]Best trial: 7. Best value: 0.728434:  24%|██▍       | 24/100 [08:45<24:09, 19.08s/it]Best trial: 7. Best value: 0.728434:  25%|██▌       | 25/100 [08:45<23:08, 18.51s/it]Best trial: 7. Best value: 0.728434:  25%|██▌       | 25/100 [09:14<23:08, 18.51s/it]Best trial: 7. Best value: 0.728434:  26%|██▌       | 26/100 [09:14<26:37, 21.58s/it]Best trial: 7. Best value: 0.728434:  26%|██▌       | 26/100 [09:58<26:37, 21.58s/it]Best trial: 7. Best value: 0.728434:  27%|██▋       | 27/100 [09:58<34:27, 28.32s/it]Best trial: 7. Best value: 0.728434:  27%|██▋       | 27/100 [10:09<34:27, 28.32s/it]Best trial: 7. Best value: 0.728434:  28%|██▊       | 28/100 [10:09<27:45, 23.13s/it]Best trial: 7. Best value: 0.728434:  28%|██▊       | 28/100 [10:24<27:45, 23.13s/it]Best trial: 7. Best value: 0.728434:  29%|██▉       | 29/100 [10:24<24:25, 20.64s/it]Best trial: 7. Best value: 0.728434:  29%|██▉       | 29/100 [10:46<24:25, 20.64s/it]Best trial: 7. Best value: 0.728434:  30%|███       | 30/100 [10:46<24:36, 21.10s/it]Best trial: 7. Best value: 0.728434:  30%|███       | 30/100 [11:04<24:36, 21.10s/it]Best trial: 7. Best value: 0.728434:  31%|███       | 31/100 [11:04<23:10, 20.15s/it]Best trial: 7. Best value: 0.728434:  31%|███       | 31/100 [11:22<23:10, 20.15s/it]Best trial: 7. Best value: 0.728434:  32%|███▏      | 32/100 [11:22<22:07, 19.52s/it]Best trial: 7. Best value: 0.728434:  32%|███▏      | 32/100 [11:31<22:07, 19.52s/it]Best trial: 7. Best value: 0.728434:  33%|███▎      | 33/100 [11:31<18:14, 16.33s/it]Best trial: 7. Best value: 0.728434:  33%|███▎      | 33/100 [11:42<18:14, 16.33s/it]Best trial: 7. Best value: 0.728434:  34%|███▍      | 34/100 [11:42<16:06, 14.65s/it]Best trial: 7. Best value: 0.728434:  34%|███▍      | 34/100 [12:05<16:06, 14.65s/it]Best trial: 7. Best value: 0.728434:  35%|███▌      | 35/100 [12:05<18:40, 17.23s/it]Best trial: 7. Best value: 0.728434:  35%|███▌      | 35/100 [12:21<18:40, 17.23s/it]Best trial: 7. Best value: 0.728434:  36%|███▌      | 36/100 [12:21<17:52, 16.75s/it]Best trial: 7. Best value: 0.728434:  36%|███▌      | 36/100 [12:47<17:52, 16.75s/it]Best trial: 7. Best value: 0.728434:  37%|███▋      | 37/100 [12:47<20:28, 19.51s/it]Best trial: 7. Best value: 0.728434:  37%|███▋      | 37/100 [13:05<20:28, 19.51s/it]Best trial: 7. Best value: 0.728434:  38%|███▊      | 38/100 [13:05<19:52, 19.23s/it]Best trial: 7. Best value: 0.728434:  38%|███▊      | 38/100 [13:16<19:52, 19.23s/it]Best trial: 7. Best value: 0.728434:  39%|███▉      | 39/100 [13:16<17:08, 16.86s/it]Best trial: 7. Best value: 0.728434:  39%|███▉      | 39/100 [13:32<17:08, 16.86s/it]Best trial: 7. Best value: 0.728434:  40%|████      | 40/100 [13:32<16:24, 16.40s/it]Best trial: 7. Best value: 0.728434:  40%|████      | 40/100 [13:43<16:24, 16.40s/it]Best trial: 7. Best value: 0.728434:  41%|████      | 41/100 [13:43<14:32, 14.78s/it]Best trial: 7. Best value: 0.728434:  41%|████      | 41/100 [13:58<14:32, 14.78s/it]Best trial: 7. Best value: 0.728434:  42%|████▏     | 42/100 [13:58<14:29, 14.99s/it]Best trial: 7. Best value: 0.728434:  42%|████▏     | 42/100 [14:20<14:29, 14.99s/it]Best trial: 7. Best value: 0.728434:  43%|████▎     | 43/100 [14:20<16:17, 17.15s/it]Best trial: 7. Best value: 0.728434:  43%|████▎     | 43/100 [14:52<16:17, 17.15s/it]Best trial: 7. Best value: 0.728434:  44%|████▍     | 44/100 [14:52<19:59, 21.42s/it]Best trial: 7. Best value: 0.728434:  44%|████▍     | 44/100 [15:11<19:59, 21.42s/it]Best trial: 7. Best value: 0.728434:  45%|████▌     | 45/100 [15:11<19:01, 20.75s/it]Best trial: 7. Best value: 0.728434:  45%|████▌     | 45/100 [15:22<19:01, 20.75s/it]Best trial: 7. Best value: 0.728434:  46%|████▌     | 46/100 [15:22<15:53, 17.66s/it]Best trial: 7. Best value: 0.728434:  46%|████▌     | 46/100 [15:39<15:53, 17.66s/it]Best trial: 7. Best value: 0.728434:  47%|████▋     | 47/100 [15:39<15:37, 17.68s/it]Best trial: 7. Best value: 0.728434:  47%|████▋     | 47/100 [15:59<15:37, 17.68s/it]Best trial: 7. Best value: 0.728434:  48%|████▊     | 48/100 [15:59<15:51, 18.29s/it]Best trial: 48. Best value: 0.728633:  48%|████▊     | 48/100 [16:17<15:51, 18.29s/it]Best trial: 48. Best value: 0.728633:  49%|████▉     | 49/100 [16:17<15:36, 18.36s/it]Best trial: 48. Best value: 0.728633:  49%|████▉     | 49/100 [16:28<15:36, 18.36s/it]Best trial: 48. Best value: 0.728633:  50%|█████     | 50/100 [16:28<13:27, 16.15s/it]Best trial: 48. Best value: 0.728633:  50%|█████     | 50/100 [16:34<13:27, 16.15s/it]Best trial: 48. Best value: 0.728633:  51%|█████     | 51/100 [16:34<10:42, 13.11s/it]Best trial: 48. Best value: 0.728633:  51%|█████     | 51/100 [16:50<10:42, 13.11s/it]Best trial: 48. Best value: 0.728633:  52%|█████▏    | 52/100 [16:50<10:57, 13.70s/it]Best trial: 48. Best value: 0.728633:  52%|█████▏    | 52/100 [16:58<10:57, 13.70s/it]Best trial: 48. Best value: 0.728633:  53%|█████▎    | 53/100 [16:58<09:25, 12.03s/it]Best trial: 48. Best value: 0.728633:  53%|█████▎    | 53/100 [17:05<09:25, 12.03s/it]Best trial: 48. Best value: 0.728633:  54%|█████▍    | 54/100 [17:05<08:10, 10.67s/it]Best trial: 48. Best value: 0.728633:  54%|█████▍    | 54/100 [17:29<08:10, 10.67s/it]Best trial: 48. Best value: 0.728633:  55%|█████▌    | 55/100 [17:29<10:55, 14.56s/it]Best trial: 55. Best value: 0.729609:  55%|█████▌    | 55/100 [17:44<10:55, 14.56s/it]Best trial: 55. Best value: 0.729609:  56%|█████▌    | 56/100 [17:44<10:45, 14.68s/it]Best trial: 55. Best value: 0.729609:  56%|█████▌    | 56/100 [17:56<10:45, 14.68s/it]Best trial: 55. Best value: 0.729609:  57%|█████▋    | 57/100 [17:56<09:57, 13.89s/it]Best trial: 55. Best value: 0.729609:  57%|█████▋    | 57/100 [18:04<09:57, 13.89s/it]Best trial: 55. Best value: 0.729609:  58%|█████▊    | 58/100 [18:04<08:27, 12.08s/it]Best trial: 55. Best value: 0.729609:  58%|█████▊    | 58/100 [18:10<08:27, 12.08s/it]Best trial: 55. Best value: 0.729609:  59%|█████▉    | 59/100 [18:10<07:09, 10.48s/it]Best trial: 55. Best value: 0.729609:  59%|█████▉    | 59/100 [18:25<07:09, 10.48s/it]Best trial: 55. Best value: 0.729609:  60%|██████    | 60/100 [18:25<07:50, 11.77s/it]Best trial: 55. Best value: 0.729609:  60%|██████    | 60/100 [18:35<07:50, 11.77s/it]Best trial: 55. Best value: 0.729609:  61%|██████    | 61/100 [18:35<07:12, 11.10s/it]Best trial: 55. Best value: 0.729609:  61%|██████    | 61/100 [18:50<07:12, 11.10s/it]Best trial: 55. Best value: 0.729609:  62%|██████▏   | 62/100 [18:50<07:49, 12.35s/it]Best trial: 55. Best value: 0.729609:  62%|██████▏   | 62/100 [19:04<07:49, 12.35s/it]Best trial: 55. Best value: 0.729609:  63%|██████▎   | 63/100 [19:04<07:56, 12.88s/it]Best trial: 55. Best value: 0.729609:  63%|██████▎   | 63/100 [19:14<07:56, 12.88s/it]Best trial: 55. Best value: 0.729609:  64%|██████▍   | 64/100 [19:14<07:14, 12.08s/it]Best trial: 55. Best value: 0.729609:  64%|██████▍   | 64/100 [19:29<07:14, 12.08s/it]Best trial: 55. Best value: 0.729609:  65%|██████▌   | 65/100 [19:29<07:31, 12.90s/it]Best trial: 65. Best value: 0.731031:  65%|██████▌   | 65/100 [19:37<07:31, 12.90s/it]Best trial: 65. Best value: 0.731031:  66%|██████▌   | 66/100 [19:37<06:23, 11.27s/it]Best trial: 65. Best value: 0.731031:  66%|██████▌   | 66/100 [19:47<06:23, 11.27s/it]Best trial: 65. Best value: 0.731031:  67%|██████▋   | 67/100 [19:47<06:02, 10.99s/it]Best trial: 65. Best value: 0.731031:  67%|██████▋   | 67/100 [19:56<06:02, 10.99s/it]Best trial: 65. Best value: 0.731031:  68%|██████▊   | 68/100 [19:56<05:37, 10.54s/it]Best trial: 65. Best value: 0.731031:  68%|██████▊   | 68/100 [20:05<05:37, 10.54s/it]Best trial: 65. Best value: 0.731031:  69%|██████▉   | 69/100 [20:05<05:05,  9.84s/it]Best trial: 65. Best value: 0.731031:  69%|██████▉   | 69/100 [20:11<05:05,  9.84s/it]Best trial: 65. Best value: 0.731031:  70%|███████   | 70/100 [20:11<04:26,  8.88s/it]Best trial: 65. Best value: 0.731031:  70%|███████   | 70/100 [20:19<04:26,  8.88s/it]Best trial: 65. Best value: 0.731031:  71%|███████   | 71/100 [20:19<04:09,  8.60s/it]Best trial: 65. Best value: 0.731031:  71%|███████   | 71/100 [20:29<04:09,  8.60s/it]Best trial: 65. Best value: 0.731031:  72%|███████▏  | 72/100 [20:29<04:11,  8.98s/it]Best trial: 72. Best value: 0.732446:  72%|███████▏  | 72/100 [20:37<04:11,  8.98s/it]Best trial: 72. Best value: 0.732446:  73%|███████▎  | 73/100 [20:37<03:51,  8.56s/it]Best trial: 72. Best value: 0.732446:  73%|███████▎  | 73/100 [20:45<03:51,  8.56s/it]Best trial: 72. Best value: 0.732446:  74%|███████▍  | 74/100 [20:45<03:41,  8.52s/it]Best trial: 72. Best value: 0.732446:  74%|███████▍  | 74/100 [20:51<03:41,  8.52s/it]Best trial: 72. Best value: 0.732446:  75%|███████▌  | 75/100 [20:51<03:15,  7.80s/it]Best trial: 72. Best value: 0.732446:  75%|███████▌  | 75/100 [21:00<03:15,  7.80s/it]Best trial: 72. Best value: 0.732446:  76%|███████▌  | 76/100 [21:00<03:12,  8.03s/it]Best trial: 72. Best value: 0.732446:  76%|███████▌  | 76/100 [21:07<03:12,  8.03s/it]Best trial: 72. Best value: 0.732446:  77%|███████▋  | 77/100 [21:07<03:00,  7.83s/it]Best trial: 72. Best value: 0.732446:  77%|███████▋  | 77/100 [21:15<03:00,  7.83s/it]Best trial: 72. Best value: 0.732446:  78%|███████▊  | 78/100 [21:15<02:51,  7.81s/it]Best trial: 72. Best value: 0.732446:  78%|███████▊  | 78/100 [21:23<02:51,  7.81s/it]Best trial: 72. Best value: 0.732446:  79%|███████▉  | 79/100 [21:23<02:42,  7.74s/it]Best trial: 72. Best value: 0.732446:  79%|███████▉  | 79/100 [21:33<02:42,  7.74s/it]Best trial: 72. Best value: 0.732446:  80%|████████  | 80/100 [21:33<02:48,  8.42s/it]Best trial: 72. Best value: 0.732446:  80%|████████  | 80/100 [21:42<02:48,  8.42s/it]Best trial: 72. Best value: 0.732446:  81%|████████  | 81/100 [21:42<02:46,  8.78s/it]Best trial: 72. Best value: 0.732446:  81%|████████  | 81/100 [21:50<02:46,  8.78s/it]Best trial: 72. Best value: 0.732446:  82%|████████▏ | 82/100 [21:50<02:32,  8.49s/it]Best trial: 72. Best value: 0.732446:  82%|████████▏ | 82/100 [22:01<02:32,  8.49s/it]Best trial: 72. Best value: 0.732446:  83%|████████▎ | 83/100 [22:01<02:36,  9.19s/it]Best trial: 72. Best value: 0.732446:  83%|████████▎ | 83/100 [22:13<02:36,  9.19s/it]Best trial: 72. Best value: 0.732446:  84%|████████▍ | 84/100 [22:13<02:40, 10.04s/it]Best trial: 72. Best value: 0.732446:  84%|████████▍ | 84/100 [22:21<02:40, 10.04s/it]Best trial: 72. Best value: 0.732446:  85%|████████▌ | 85/100 [22:21<02:22,  9.53s/it]Best trial: 72. Best value: 0.732446:  85%|████████▌ | 85/100 [22:30<02:22,  9.53s/it]Best trial: 72. Best value: 0.732446:  86%|████████▌ | 86/100 [22:30<02:11,  9.41s/it]Best trial: 72. Best value: 0.732446:  86%|████████▌ | 86/100 [22:38<02:11,  9.41s/it]Best trial: 72. Best value: 0.732446:  87%|████████▋ | 87/100 [22:38<01:54,  8.81s/it]Best trial: 72. Best value: 0.732446:  87%|████████▋ | 87/100 [22:46<01:54,  8.81s/it]Best trial: 72. Best value: 0.732446:  88%|████████▊ | 88/100 [22:46<01:44,  8.72s/it]Best trial: 72. Best value: 0.732446:  88%|████████▊ | 88/100 [22:55<01:44,  8.72s/it]Best trial: 72. Best value: 0.732446:  89%|████████▉ | 89/100 [22:55<01:35,  8.72s/it]Best trial: 72. Best value: 0.732446:  89%|████████▉ | 89/100 [23:04<01:35,  8.72s/it]Best trial: 72. Best value: 0.732446:  90%|█████████ | 90/100 [23:04<01:27,  8.78s/it]Best trial: 72. Best value: 0.732446:  90%|█████████ | 90/100 [23:16<01:27,  8.78s/it]Best trial: 72. Best value: 0.732446:  91%|█████████ | 91/100 [23:16<01:28,  9.84s/it]Best trial: 72. Best value: 0.732446:  91%|█████████ | 91/100 [23:26<01:28,  9.84s/it]Best trial: 72. Best value: 0.732446:  92%|█████████▏| 92/100 [23:26<01:18,  9.84s/it]Best trial: 72. Best value: 0.732446:  92%|█████████▏| 92/100 [23:37<01:18,  9.84s/it]Best trial: 72. Best value: 0.732446:  93%|█████████▎| 93/100 [23:37<01:10, 10.07s/it]Best trial: 72. Best value: 0.732446:  93%|█████████▎| 93/100 [23:44<01:10, 10.07s/it]Best trial: 72. Best value: 0.732446:  94%|█████████▍| 94/100 [23:44<00:56,  9.34s/it]Best trial: 72. Best value: 0.732446:  94%|█████████▍| 94/100 [23:51<00:56,  9.34s/it]Best trial: 72. Best value: 0.732446:  95%|█████████▌| 95/100 [23:51<00:42,  8.43s/it]Best trial: 72. Best value: 0.732446:  95%|█████████▌| 95/100 [24:00<00:42,  8.43s/it]Best trial: 72. Best value: 0.732446:  96%|█████████▌| 96/100 [24:00<00:35,  8.79s/it]Best trial: 72. Best value: 0.732446:  96%|█████████▌| 96/100 [24:05<00:35,  8.79s/it]Best trial: 72. Best value: 0.732446:  97%|█████████▋| 97/100 [24:05<00:23,  7.72s/it]Best trial: 72. Best value: 0.732446:  97%|█████████▋| 97/100 [24:18<00:23,  7.72s/it]Best trial: 72. Best value: 0.732446:  98%|█████████▊| 98/100 [24:18<00:18,  9.08s/it]Best trial: 72. Best value: 0.732446:  98%|█████████▊| 98/100 [24:28<00:18,  9.08s/it]Best trial: 72. Best value: 0.732446:  99%|█████████▉| 99/100 [24:28<00:09,  9.60s/it]Best trial: 72. Best value: 0.732446:  99%|█████████▉| 99/100 [24:40<00:09,  9.60s/it]Best trial: 72. Best value: 0.732446: 100%|██████████| 100/100 [24:40<00:00, 10.20s/it]Best trial: 72. Best value: 0.732446: 100%|██████████| 100/100 [24:40<00:00, 14.81s/it]
2025-12-01 06:27:28,033 - INFO - HPO Complete. Best AUPRC: 0.7324
2025-12-01 06:27:28,033 - INFO - Best Params: {'n_estimators': 600, 'learning_rate': 0.07067417071981234, 'max_depth': 3, 'subsample': 0.687616125067448, 'colsample_bytree': 0.6676602921987097, 'gamma': 4.384299995471582, 'reg_lambda': 0.0021362173875713224, 'reg_alpha': 0.0006150708801130756}
2025-12-01 06:27:28,034 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_all_minus_pleth.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 06:27:30,275 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_pleth
2025-12-01 06:27:30,275 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:27:30,508 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:27:30,581 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:27:30,595 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 06:27:30,595 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 06:27:30,596 - INFO - Training model...
2025-12-01 06:27:33,628 - INFO - Evaluating model with bootstrapping...
2025-12-01 06:27:40,513 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 06:27:40,513 - INFO - AUROC: 0.8933 (0.8630 - 0.9147)
2025-12-01 06:27:40,513 - INFO - AUPRC: 0.7523 (0.7032 - 0.7996)
2025-12-01 06:27:40,513 - INFO - Brier Score: 0.0993 (0.0903 - 0.1128)
2025-12-01 06:27:40,513 - INFO - Accuracy: 0.8483 (0.8390 - 0.8928)
2025-12-01 06:27:40,513 - INFO - Precision: 0.6044 (0.5863 - 0.8028)
2025-12-01 06:27:40,513 - INFO - Sensitivity (Recall): 0.7692 (0.5639 - 0.8174)
2025-12-01 06:27:40,513 - INFO - F1-Score: 0.6769 (0.6397 - 0.7354)
2025-12-01 06:27:40,513 - INFO - Best Threshold: 0.4100 (0.4060 - 0.6560)
2025-12-01 06:27:40,513 - INFO - Specificity: 0.8689 (0.8643 - 0.9664)
2025-12-01 06:27:40,526 - INFO - Calculating SHAP values...
2025-12-01 06:27:41,772 - INFO - SHAP plots saved.
2025-12-01 06:27:41,775 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_all_minus_pleth
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_all_minus_ecg
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 06:27:43,339 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-12-01 06:27:43,340 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:27:43,576 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:27:43,650 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:27:43,664 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 06:27:43,664 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.713712:   0%|          | 0/100 [00:20<?, ?it/s]Best trial: 0. Best value: 0.713712:   1%|          | 1/100 [00:20<33:05, 20.05s/it]Best trial: 0. Best value: 0.713712:   1%|          | 1/100 [00:59<33:05, 20.05s/it]Best trial: 0. Best value: 0.713712:   2%|▏         | 2/100 [00:59<51:50, 31.74s/it]Best trial: 0. Best value: 0.713712:   2%|▏         | 2/100 [01:14<51:50, 31.74s/it]Best trial: 0. Best value: 0.713712:   3%|▎         | 3/100 [01:14<38:36, 23.88s/it]Best trial: 0. Best value: 0.713712:   3%|▎         | 3/100 [01:23<38:36, 23.88s/it]Best trial: 0. Best value: 0.713712:   4%|▍         | 4/100 [01:23<28:42, 17.95s/it]Best trial: 0. Best value: 0.713712:   4%|▍         | 4/100 [01:35<28:42, 17.95s/it]Best trial: 0. Best value: 0.713712:   5%|▌         | 5/100 [01:35<25:22, 16.02s/it]Best trial: 0. Best value: 0.713712:   5%|▌         | 5/100 [01:43<25:22, 16.02s/it]Best trial: 0. Best value: 0.713712:   6%|▌         | 6/100 [01:43<20:25, 13.03s/it]Best trial: 0. Best value: 0.713712:   6%|▌         | 6/100 [02:14<20:25, 13.03s/it]Best trial: 0. Best value: 0.713712:   7%|▋         | 7/100 [02:14<29:19, 18.92s/it]Best trial: 0. Best value: 0.713712:   7%|▋         | 7/100 [02:33<29:19, 18.92s/it]Best trial: 0. Best value: 0.713712:   8%|▊         | 8/100 [02:33<29:13, 19.06s/it]Best trial: 0. Best value: 0.713712:   8%|▊         | 8/100 [02:38<29:13, 19.06s/it]Best trial: 0. Best value: 0.713712:   9%|▉         | 9/100 [02:38<22:22, 14.75s/it]Best trial: 0. Best value: 0.713712:   9%|▉         | 9/100 [03:20<22:22, 14.75s/it]Best trial: 0. Best value: 0.713712:  10%|█         | 10/100 [03:20<34:40, 23.12s/it]Best trial: 0. Best value: 0.713712:  10%|█         | 10/100 [03:34<34:40, 23.12s/it]Best trial: 0. Best value: 0.713712:  11%|█         | 11/100 [03:34<30:12, 20.36s/it]Best trial: 0. Best value: 0.713712:  11%|█         | 11/100 [03:50<30:12, 20.36s/it]Best trial: 0. Best value: 0.713712:  12%|█▏        | 12/100 [03:50<27:40, 18.87s/it]Best trial: 0. Best value: 0.713712:  12%|█▏        | 12/100 [04:01<27:40, 18.87s/it]Best trial: 0. Best value: 0.713712:  13%|█▎        | 13/100 [04:01<23:48, 16.42s/it]Best trial: 0. Best value: 0.713712:  13%|█▎        | 13/100 [04:27<23:48, 16.42s/it]Best trial: 0. Best value: 0.713712:  14%|█▍        | 14/100 [04:27<27:58, 19.52s/it]Best trial: 0. Best value: 0.713712:  14%|█▍        | 14/100 [04:47<27:58, 19.52s/it]Best trial: 0. Best value: 0.713712:  15%|█▌        | 15/100 [04:47<27:50, 19.66s/it]Best trial: 0. Best value: 0.713712:  15%|█▌        | 15/100 [05:01<27:50, 19.66s/it]Best trial: 0. Best value: 0.713712:  16%|█▌        | 16/100 [05:01<25:02, 17.89s/it]Best trial: 16. Best value: 0.718374:  16%|█▌        | 16/100 [05:54<25:02, 17.89s/it]Best trial: 16. Best value: 0.718374:  17%|█▋        | 17/100 [05:54<39:17, 28.40s/it]Best trial: 16. Best value: 0.718374:  17%|█▋        | 17/100 [06:33<39:17, 28.40s/it]Best trial: 16. Best value: 0.718374:  18%|█▊        | 18/100 [06:33<43:25, 31.77s/it]Best trial: 16. Best value: 0.718374:  18%|█▊        | 18/100 [06:47<43:25, 31.77s/it]Best trial: 16. Best value: 0.718374:  19%|█▉        | 19/100 [06:47<35:29, 26.29s/it]Best trial: 16. Best value: 0.718374:  19%|█▉        | 19/100 [07:16<35:29, 26.29s/it]Best trial: 16. Best value: 0.718374:  20%|██        | 20/100 [07:16<36:14, 27.19s/it]Best trial: 16. Best value: 0.718374:  20%|██        | 20/100 [07:48<36:14, 27.19s/it]Best trial: 16. Best value: 0.718374:  21%|██        | 21/100 [07:48<37:26, 28.44s/it]Best trial: 16. Best value: 0.718374:  21%|██        | 21/100 [08:37<37:26, 28.44s/it]Best trial: 16. Best value: 0.718374:  22%|██▏       | 22/100 [08:37<45:06, 34.70s/it]Best trial: 16. Best value: 0.718374:  22%|██▏       | 22/100 [09:11<45:06, 34.70s/it]Best trial: 16. Best value: 0.718374:  23%|██▎       | 23/100 [09:11<44:28, 34.65s/it]Best trial: 16. Best value: 0.718374:  23%|██▎       | 23/100 [09:28<44:28, 34.65s/it]Best trial: 16. Best value: 0.718374:  24%|██▍       | 24/100 [09:28<37:09, 29.33s/it]Best trial: 16. Best value: 0.718374:  24%|██▍       | 24/100 [10:00<37:09, 29.33s/it]Best trial: 16. Best value: 0.718374:  25%|██▌       | 25/100 [10:00<37:38, 30.11s/it]Best trial: 16. Best value: 0.718374:  25%|██▌       | 25/100 [10:29<37:38, 30.11s/it]Best trial: 16. Best value: 0.718374:  26%|██▌       | 26/100 [10:29<36:34, 29.65s/it]Best trial: 16. Best value: 0.718374:  26%|██▌       | 26/100 [10:44<36:34, 29.65s/it]Best trial: 16. Best value: 0.718374:  27%|██▋       | 27/100 [10:44<30:45, 25.28s/it]Best trial: 16. Best value: 0.718374:  27%|██▋       | 27/100 [11:04<30:45, 25.28s/it]Best trial: 16. Best value: 0.718374:  28%|██▊       | 28/100 [11:04<28:35, 23.82s/it]Best trial: 16. Best value: 0.718374:  28%|██▊       | 28/100 [11:15<28:35, 23.82s/it]Best trial: 16. Best value: 0.718374:  29%|██▉       | 29/100 [11:15<23:24, 19.78s/it]Best trial: 29. Best value: 0.719795:  29%|██▉       | 29/100 [11:31<23:24, 19.78s/it]Best trial: 29. Best value: 0.719795:  30%|███       | 30/100 [11:31<21:42, 18.60s/it]Best trial: 29. Best value: 0.719795:  30%|███       | 30/100 [12:06<21:42, 18.60s/it]Best trial: 29. Best value: 0.719795:  31%|███       | 31/100 [12:06<27:17, 23.73s/it]Best trial: 31. Best value: 0.723833:  31%|███       | 31/100 [12:29<27:17, 23.73s/it]Best trial: 31. Best value: 0.723833:  32%|███▏      | 32/100 [12:29<26:22, 23.28s/it]Best trial: 31. Best value: 0.723833:  32%|███▏      | 32/100 [12:49<26:22, 23.28s/it]Best trial: 31. Best value: 0.723833:  33%|███▎      | 33/100 [12:49<24:54, 22.30s/it]Best trial: 31. Best value: 0.723833:  33%|███▎      | 33/100 [13:24<24:54, 22.30s/it]Best trial: 31. Best value: 0.723833:  34%|███▍      | 34/100 [13:24<28:59, 26.35s/it]Best trial: 34. Best value: 0.723955:  34%|███▍      | 34/100 [13:39<28:59, 26.35s/it]Best trial: 34. Best value: 0.723955:  35%|███▌      | 35/100 [13:39<24:50, 22.93s/it]Best trial: 34. Best value: 0.723955:  35%|███▌      | 35/100 [14:05<24:50, 22.93s/it]Best trial: 34. Best value: 0.723955:  36%|███▌      | 36/100 [14:05<25:18, 23.73s/it]Best trial: 34. Best value: 0.723955:  36%|███▌      | 36/100 [14:23<25:18, 23.73s/it]Best trial: 34. Best value: 0.723955:  37%|███▋      | 37/100 [14:23<23:14, 22.13s/it]Best trial: 34. Best value: 0.723955:  37%|███▋      | 37/100 [14:44<23:14, 22.13s/it]Best trial: 34. Best value: 0.723955:  38%|███▊      | 38/100 [14:44<22:22, 21.65s/it]Best trial: 38. Best value: 0.726892:  38%|███▊      | 38/100 [14:57<22:22, 21.65s/it]Best trial: 38. Best value: 0.726892:  39%|███▉      | 39/100 [14:57<19:21, 19.04s/it]Best trial: 38. Best value: 0.726892:  39%|███▉      | 39/100 [15:05<19:21, 19.04s/it]Best trial: 38. Best value: 0.726892:  40%|████      | 40/100 [15:05<15:46, 15.77s/it]Best trial: 40. Best value: 0.729825:  40%|████      | 40/100 [15:18<15:46, 15.77s/it]Best trial: 40. Best value: 0.729825:  41%|████      | 41/100 [15:18<14:45, 15.01s/it]Best trial: 41. Best value: 0.731071:  41%|████      | 41/100 [15:31<14:45, 15.01s/it]Best trial: 41. Best value: 0.731071:  42%|████▏     | 42/100 [15:31<13:50, 14.31s/it]Best trial: 42. Best value: 0.735167:  42%|████▏     | 42/100 [15:43<13:50, 14.31s/it]Best trial: 42. Best value: 0.735167:  43%|████▎     | 43/100 [15:43<13:02, 13.72s/it]Best trial: 42. Best value: 0.735167:  43%|████▎     | 43/100 [15:56<13:02, 13.72s/it]Best trial: 42. Best value: 0.735167:  44%|████▍     | 44/100 [15:56<12:27, 13.35s/it]Best trial: 42. Best value: 0.735167:  44%|████▍     | 44/100 [16:07<12:27, 13.35s/it]Best trial: 42. Best value: 0.735167:  45%|████▌     | 45/100 [16:07<11:48, 12.89s/it]Best trial: 42. Best value: 0.735167:  45%|████▌     | 45/100 [16:19<11:48, 12.89s/it]Best trial: 42. Best value: 0.735167:  46%|████▌     | 46/100 [16:19<11:11, 12.43s/it]Best trial: 42. Best value: 0.735167:  46%|████▌     | 46/100 [16:26<11:11, 12.43s/it]Best trial: 42. Best value: 0.735167:  47%|████▋     | 47/100 [16:26<09:40, 10.96s/it]Best trial: 42. Best value: 0.735167:  47%|████▋     | 47/100 [16:41<09:40, 10.96s/it]Best trial: 42. Best value: 0.735167:  48%|████▊     | 48/100 [16:41<10:30, 12.13s/it]Best trial: 42. Best value: 0.735167:  48%|████▊     | 48/100 [16:53<10:30, 12.13s/it]Best trial: 42. Best value: 0.735167:  49%|████▉     | 49/100 [16:53<10:06, 11.90s/it]Best trial: 42. Best value: 0.735167:  49%|████▉     | 49/100 [16:59<10:06, 11.90s/it]Best trial: 42. Best value: 0.735167:  50%|█████     | 50/100 [16:59<08:36, 10.34s/it]Best trial: 42. Best value: 0.735167:  50%|█████     | 50/100 [17:08<08:36, 10.34s/it]Best trial: 42. Best value: 0.735167:  51%|█████     | 51/100 [17:08<07:56,  9.72s/it]Best trial: 42. Best value: 0.735167:  51%|█████     | 51/100 [17:17<07:56,  9.72s/it]Best trial: 42. Best value: 0.735167:  52%|█████▏    | 52/100 [17:17<07:49,  9.77s/it]Best trial: 42. Best value: 0.735167:  52%|█████▏    | 52/100 [17:29<07:49,  9.77s/it]Best trial: 42. Best value: 0.735167:  53%|█████▎    | 53/100 [17:29<08:03, 10.29s/it]Best trial: 42. Best value: 0.735167:  53%|█████▎    | 53/100 [17:38<08:03, 10.29s/it]Best trial: 42. Best value: 0.735167:  54%|█████▍    | 54/100 [17:38<07:37,  9.96s/it]Best trial: 42. Best value: 0.735167:  54%|█████▍    | 54/100 [17:47<07:37,  9.96s/it]Best trial: 42. Best value: 0.735167:  55%|█████▌    | 55/100 [17:47<07:11,  9.58s/it]Best trial: 42. Best value: 0.735167:  55%|█████▌    | 55/100 [18:06<07:11,  9.58s/it]Best trial: 42. Best value: 0.735167:  56%|█████▌    | 56/100 [18:06<09:02, 12.33s/it]Best trial: 42. Best value: 0.735167:  56%|█████▌    | 56/100 [18:12<09:02, 12.33s/it]Best trial: 42. Best value: 0.735167:  57%|█████▋    | 57/100 [18:12<07:29, 10.45s/it]Best trial: 42. Best value: 0.735167:  57%|█████▋    | 57/100 [18:18<07:29, 10.45s/it]Best trial: 42. Best value: 0.735167:  58%|█████▊    | 58/100 [18:18<06:27,  9.21s/it]Best trial: 42. Best value: 0.735167:  58%|█████▊    | 58/100 [18:38<06:27,  9.21s/it]Best trial: 42. Best value: 0.735167:  59%|█████▉    | 59/100 [18:38<08:35, 12.57s/it]Best trial: 42. Best value: 0.735167:  59%|█████▉    | 59/100 [18:54<08:35, 12.57s/it]Best trial: 42. Best value: 0.735167:  60%|██████    | 60/100 [18:54<08:54, 13.37s/it]Best trial: 42. Best value: 0.735167:  60%|██████    | 60/100 [19:00<08:54, 13.37s/it]Best trial: 42. Best value: 0.735167:  61%|██████    | 61/100 [19:00<07:19, 11.28s/it]Best trial: 42. Best value: 0.735167:  61%|██████    | 61/100 [19:08<07:19, 11.28s/it]Best trial: 42. Best value: 0.735167:  62%|██████▏   | 62/100 [19:08<06:33, 10.36s/it]Best trial: 42. Best value: 0.735167:  62%|██████▏   | 62/100 [19:19<06:33, 10.36s/it]Best trial: 42. Best value: 0.735167:  63%|██████▎   | 63/100 [19:19<06:24, 10.40s/it]Best trial: 42. Best value: 0.735167:  63%|██████▎   | 63/100 [19:28<06:24, 10.40s/it]Best trial: 42. Best value: 0.735167:  64%|██████▍   | 64/100 [19:28<06:05, 10.14s/it]Best trial: 42. Best value: 0.735167:  64%|██████▍   | 64/100 [19:42<06:05, 10.14s/it]Best trial: 42. Best value: 0.735167:  65%|██████▌   | 65/100 [19:42<06:34, 11.26s/it]Best trial: 42. Best value: 0.735167:  65%|██████▌   | 65/100 [19:47<06:34, 11.26s/it]Best trial: 42. Best value: 0.735167:  66%|██████▌   | 66/100 [19:47<05:21,  9.46s/it]Best trial: 42. Best value: 0.735167:  66%|██████▌   | 66/100 [19:56<05:21,  9.46s/it]Best trial: 42. Best value: 0.735167:  67%|██████▋   | 67/100 [19:56<05:01,  9.13s/it]Best trial: 42. Best value: 0.735167:  67%|██████▋   | 67/100 [20:13<05:01,  9.13s/it]Best trial: 42. Best value: 0.735167:  68%|██████▊   | 68/100 [20:13<06:07, 11.49s/it]Best trial: 42. Best value: 0.735167:  68%|██████▊   | 68/100 [20:17<06:07, 11.49s/it]Best trial: 42. Best value: 0.735167:  69%|██████▉   | 69/100 [20:17<04:52,  9.44s/it]Best trial: 42. Best value: 0.735167:  69%|██████▉   | 69/100 [20:29<04:52,  9.44s/it]Best trial: 42. Best value: 0.735167:  70%|███████   | 70/100 [20:29<04:59,  9.97s/it]Best trial: 42. Best value: 0.735167:  70%|███████   | 70/100 [20:36<04:59,  9.97s/it]Best trial: 42. Best value: 0.735167:  71%|███████   | 71/100 [20:36<04:29,  9.30s/it]Best trial: 42. Best value: 0.735167:  71%|███████   | 71/100 [20:47<04:29,  9.30s/it]Best trial: 42. Best value: 0.735167:  72%|███████▏  | 72/100 [20:47<04:29,  9.64s/it]Best trial: 42. Best value: 0.735167:  72%|███████▏  | 72/100 [20:55<04:29,  9.64s/it]Best trial: 42. Best value: 0.735167:  73%|███████▎  | 73/100 [20:55<04:09,  9.25s/it]Best trial: 42. Best value: 0.735167:  73%|███████▎  | 73/100 [21:08<04:09,  9.25s/it]Best trial: 42. Best value: 0.735167:  74%|███████▍  | 74/100 [21:08<04:31, 10.43s/it]Best trial: 42. Best value: 0.735167:  74%|███████▍  | 74/100 [21:20<04:31, 10.43s/it]Best trial: 42. Best value: 0.735167:  75%|███████▌  | 75/100 [21:20<04:32, 10.88s/it]Best trial: 42. Best value: 0.735167:  75%|███████▌  | 75/100 [21:34<04:32, 10.88s/it]Best trial: 42. Best value: 0.735167:  76%|███████▌  | 76/100 [21:34<04:41, 11.74s/it]Best trial: 42. Best value: 0.735167:  76%|███████▌  | 76/100 [21:51<04:41, 11.74s/it]Best trial: 42. Best value: 0.735167:  77%|███████▋  | 77/100 [21:51<05:04, 13.23s/it]Best trial: 42. Best value: 0.735167:  77%|███████▋  | 77/100 [22:00<05:04, 13.23s/it]Best trial: 42. Best value: 0.735167:  78%|███████▊  | 78/100 [22:00<04:27, 12.14s/it]Best trial: 42. Best value: 0.735167:  78%|███████▊  | 78/100 [22:14<04:27, 12.14s/it]Best trial: 42. Best value: 0.735167:  79%|███████▉  | 79/100 [22:14<04:24, 12.59s/it]Best trial: 42. Best value: 0.735167:  79%|███████▉  | 79/100 [22:38<04:24, 12.59s/it]Best trial: 42. Best value: 0.735167:  80%|████████  | 80/100 [22:38<05:17, 15.90s/it]Best trial: 42. Best value: 0.735167:  80%|████████  | 80/100 [22:57<05:17, 15.90s/it]Best trial: 42. Best value: 0.735167:  81%|████████  | 81/100 [22:57<05:23, 17.00s/it]Best trial: 42. Best value: 0.735167:  81%|████████  | 81/100 [23:07<05:23, 17.00s/it]Best trial: 42. Best value: 0.735167:  82%|████████▏ | 82/100 [23:08<04:30, 15.02s/it]Best trial: 42. Best value: 0.735167:  82%|████████▏ | 82/100 [23:19<04:30, 15.02s/it]Best trial: 42. Best value: 0.735167:  83%|████████▎ | 83/100 [23:19<03:55, 13.85s/it]Best trial: 42. Best value: 0.735167:  83%|████████▎ | 83/100 [23:27<03:55, 13.85s/it]Best trial: 42. Best value: 0.735167:  84%|████████▍ | 84/100 [23:27<03:17, 12.35s/it]Best trial: 42. Best value: 0.735167:  84%|████████▍ | 84/100 [23:34<03:17, 12.35s/it]Best trial: 42. Best value: 0.735167:  85%|████████▌ | 85/100 [23:34<02:38, 10.59s/it]Best trial: 42. Best value: 0.735167:  85%|████████▌ | 85/100 [23:46<02:38, 10.59s/it]Best trial: 42. Best value: 0.735167:  86%|████████▌ | 86/100 [23:46<02:32, 10.88s/it]Best trial: 42. Best value: 0.735167:  86%|████████▌ | 86/100 [24:01<02:32, 10.88s/it]Best trial: 42. Best value: 0.735167:  87%|████████▋ | 87/100 [24:01<02:39, 12.30s/it]Best trial: 42. Best value: 0.735167:  87%|████████▋ | 87/100 [24:14<02:39, 12.30s/it]Best trial: 42. Best value: 0.735167:  88%|████████▊ | 88/100 [24:14<02:31, 12.59s/it]Best trial: 42. Best value: 0.735167:  88%|████████▊ | 88/100 [24:27<02:31, 12.59s/it]Best trial: 42. Best value: 0.735167:  89%|████████▉ | 89/100 [24:27<02:19, 12.71s/it]Best trial: 42. Best value: 0.735167:  89%|████████▉ | 89/100 [24:40<02:19, 12.71s/it]Best trial: 42. Best value: 0.735167:  90%|█████████ | 90/100 [24:40<02:07, 12.71s/it]Best trial: 42. Best value: 0.735167:  90%|█████████ | 90/100 [24:48<02:07, 12.71s/it]Best trial: 42. Best value: 0.735167:  91%|█████████ | 91/100 [24:48<01:40, 11.15s/it]Best trial: 42. Best value: 0.735167:  91%|█████████ | 91/100 [25:00<01:40, 11.15s/it]Best trial: 42. Best value: 0.735167:  92%|█████████▏| 92/100 [25:00<01:32, 11.60s/it]Best trial: 42. Best value: 0.735167:  92%|█████████▏| 92/100 [25:15<01:32, 11.60s/it]Best trial: 42. Best value: 0.735167:  93%|█████████▎| 93/100 [25:15<01:27, 12.50s/it]Best trial: 42. Best value: 0.735167:  93%|█████████▎| 93/100 [25:30<01:27, 12.50s/it]Best trial: 42. Best value: 0.735167:  94%|█████████▍| 94/100 [25:30<01:19, 13.31s/it]Best trial: 42. Best value: 0.735167:  94%|█████████▍| 94/100 [25:42<01:19, 13.31s/it]Best trial: 42. Best value: 0.735167:  95%|█████████▌| 95/100 [25:42<01:04, 12.99s/it]Best trial: 42. Best value: 0.735167:  95%|█████████▌| 95/100 [25:53<01:04, 12.99s/it]Best trial: 42. Best value: 0.735167:  96%|█████████▌| 96/100 [25:53<00:48, 12.22s/it]Best trial: 42. Best value: 0.735167:  96%|█████████▌| 96/100 [26:08<00:48, 12.22s/it]Best trial: 42. Best value: 0.735167:  97%|█████████▋| 97/100 [26:08<00:39, 13.24s/it]Best trial: 42. Best value: 0.735167:  97%|█████████▋| 97/100 [26:23<00:39, 13.24s/it]Best trial: 42. Best value: 0.735167:  98%|█████████▊| 98/100 [26:23<00:27, 13.75s/it]Best trial: 42. Best value: 0.735167:  98%|█████████▊| 98/100 [26:45<00:27, 13.75s/it]Best trial: 42. Best value: 0.735167:  99%|█████████▉| 99/100 [26:45<00:16, 16.12s/it]Best trial: 42. Best value: 0.735167:  99%|█████████▉| 99/100 [26:58<00:16, 16.12s/it]Best trial: 42. Best value: 0.735167: 100%|██████████| 100/100 [26:58<00:00, 15.24s/it]Best trial: 42. Best value: 0.735167: 100%|██████████| 100/100 [26:58<00:00, 16.19s/it]
2025-12-01 06:54:42,269 - INFO - HPO Complete. Best AUPRC: 0.7352
2025-12-01 06:54:42,269 - INFO - Best Params: {'n_estimators': 900, 'learning_rate': 0.035691860636654686, 'max_depth': 3, 'subsample': 0.9304920962782424, 'colsample_bytree': 0.9957563792092586, 'gamma': 3.4962345729665527, 'reg_lambda': 6.078622422365e-07, 'reg_alpha': 1.9643848924089524e-05}
2025-12-01 06:54:42,269 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_all_minus_ecg.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 06:54:44,195 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_ecg
2025-12-01 06:54:44,195 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:54:44,387 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:54:44,453 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:54:44,466 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 06:54:44,466 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 06:54:44,466 - INFO - Training model...
2025-12-01 06:54:49,188 - INFO - Evaluating model with bootstrapping...
2025-12-01 06:54:55,747 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 06:54:55,747 - INFO - AUROC: 0.8859 (0.8578 - 0.9090)
2025-12-01 06:54:55,747 - INFO - AUPRC: 0.7316 (0.6765 - 0.7757)
2025-12-01 06:54:55,748 - INFO - Brier Score: 0.1043 (0.0956 - 0.1199)
2025-12-01 06:54:55,748 - INFO - Accuracy: 0.8627 (0.7991 - 0.8893)
2025-12-01 06:54:55,748 - INFO - Precision: 0.6791 (0.5141 - 0.7989)
2025-12-01 06:54:55,748 - INFO - Sensitivity (Recall): 0.6364 (0.5610 - 0.7837)
2025-12-01 06:54:55,748 - INFO - F1-Score: 0.6570 (0.6091 - 0.7133)
2025-12-01 06:54:55,748 - INFO - Best Threshold: 0.5500 (0.3280 - 0.6680)
2025-12-01 06:54:55,748 - INFO - Specificity: 0.9217 (0.8128 - 0.9616)
2025-12-01 06:54:55,766 - INFO - Calculating SHAP values...
2025-12-01 06:54:56,886 - INFO - SHAP plots saved.
2025-12-01 06:54:56,887 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_all_minus_ecg
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_all_minus_co2
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 06:54:58,189 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-12-01 06:54:58,189 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 06:54:58,425 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 06:54:58,495 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 06:54:58,508 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 06:54:58,508 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.65435:   0%|          | 0/100 [00:08<?, ?it/s]Best trial: 0. Best value: 0.65435:   1%|          | 1/100 [00:08<13:14,  8.03s/it]Best trial: 1. Best value: 0.697723:   1%|          | 1/100 [00:22<13:14,  8.03s/it]Best trial: 1. Best value: 0.697723:   2%|▏         | 2/100 [00:22<18:50, 11.53s/it]Best trial: 1. Best value: 0.697723:   2%|▏         | 2/100 [00:40<18:50, 11.53s/it]Best trial: 1. Best value: 0.697723:   3%|▎         | 3/100 [00:40<23:39, 14.63s/it]Best trial: 3. Best value: 0.703067:   3%|▎         | 3/100 [01:06<23:39, 14.63s/it]Best trial: 3. Best value: 0.703067:   4%|▍         | 4/100 [01:06<30:32, 19.09s/it]Best trial: 4. Best value: 0.722264:   4%|▍         | 4/100 [01:18<30:32, 19.09s/it]Best trial: 4. Best value: 0.722264:   5%|▌         | 5/100 [01:18<26:03, 16.45s/it]Best trial: 4. Best value: 0.722264:   5%|▌         | 5/100 [01:28<26:03, 16.45s/it]Best trial: 4. Best value: 0.722264:   6%|▌         | 6/100 [01:28<22:21, 14.27s/it]Best trial: 4. Best value: 0.722264:   6%|▌         | 6/100 [01:36<22:21, 14.27s/it]Best trial: 4. Best value: 0.722264:   7%|▋         | 7/100 [01:36<18:57, 12.23s/it]Best trial: 4. Best value: 0.722264:   7%|▋         | 7/100 [02:11<18:57, 12.23s/it]Best trial: 4. Best value: 0.722264:   8%|▊         | 8/100 [02:11<29:50, 19.46s/it]Best trial: 4. Best value: 0.722264:   8%|▊         | 8/100 [03:01<29:50, 19.46s/it]Best trial: 4. Best value: 0.722264:   9%|▉         | 9/100 [03:01<44:25, 29.29s/it]Best trial: 4. Best value: 0.722264:   9%|▉         | 9/100 [03:18<44:25, 29.29s/it]Best trial: 4. Best value: 0.722264:  10%|█         | 10/100 [03:18<38:07, 25.42s/it]Best trial: 10. Best value: 0.731486:  10%|█         | 10/100 [03:26<38:07, 25.42s/it]Best trial: 10. Best value: 0.731486:  11%|█         | 11/100 [03:26<29:29, 19.89s/it]Best trial: 11. Best value: 0.73229:  11%|█         | 11/100 [03:31<29:29, 19.89s/it] Best trial: 11. Best value: 0.73229:  12%|█▏        | 12/100 [03:31<22:52, 15.60s/it]Best trial: 12. Best value: 0.734748:  12%|█▏        | 12/100 [03:39<22:52, 15.60s/it]Best trial: 12. Best value: 0.734748:  13%|█▎        | 13/100 [03:39<18:59, 13.09s/it]Best trial: 12. Best value: 0.734748:  13%|█▎        | 13/100 [03:49<18:59, 13.09s/it]Best trial: 12. Best value: 0.734748:  14%|█▍        | 14/100 [03:49<17:41, 12.34s/it]Best trial: 12. Best value: 0.734748:  14%|█▍        | 14/100 [03:59<17:41, 12.34s/it]Best trial: 12. Best value: 0.734748:  15%|█▌        | 15/100 [03:59<16:26, 11.60s/it]Best trial: 12. Best value: 0.734748:  15%|█▌        | 15/100 [04:11<16:26, 11.60s/it]Best trial: 12. Best value: 0.734748:  16%|█▌        | 16/100 [04:11<16:17, 11.64s/it]Best trial: 12. Best value: 0.734748:  16%|█▌        | 16/100 [04:45<16:17, 11.64s/it]Best trial: 12. Best value: 0.734748:  17%|█▋        | 17/100 [04:45<25:32, 18.46s/it]Best trial: 12. Best value: 0.734748:  17%|█▋        | 17/100 [05:00<25:32, 18.46s/it]Best trial: 12. Best value: 0.734748:  18%|█▊        | 18/100 [05:00<23:55, 17.50s/it]Best trial: 12. Best value: 0.734748:  18%|█▊        | 18/100 [05:07<23:55, 17.50s/it]Best trial: 12. Best value: 0.734748:  19%|█▉        | 19/100 [05:07<19:20, 14.32s/it]Best trial: 12. Best value: 0.734748:  19%|█▉        | 19/100 [05:17<19:20, 14.32s/it]Best trial: 12. Best value: 0.734748:  20%|██        | 20/100 [05:17<17:06, 12.84s/it]Best trial: 12. Best value: 0.734748:  20%|██        | 20/100 [05:41<17:06, 12.84s/it]Best trial: 12. Best value: 0.734748:  21%|██        | 21/100 [05:41<21:29, 16.32s/it]Best trial: 12. Best value: 0.734748:  21%|██        | 21/100 [05:49<21:29, 16.32s/it]Best trial: 12. Best value: 0.734748:  22%|██▏       | 22/100 [05:49<17:42, 13.62s/it]Best trial: 12. Best value: 0.734748:  22%|██▏       | 22/100 [05:56<17:42, 13.62s/it]Best trial: 12. Best value: 0.734748:  23%|██▎       | 23/100 [05:56<15:14, 11.87s/it]Best trial: 12. Best value: 0.734748:  23%|██▎       | 23/100 [06:06<15:14, 11.87s/it]Best trial: 12. Best value: 0.734748:  24%|██▍       | 24/100 [06:06<14:12, 11.22s/it]Best trial: 12. Best value: 0.734748:  24%|██▍       | 24/100 [06:14<14:12, 11.22s/it]Best trial: 12. Best value: 0.734748:  25%|██▌       | 25/100 [06:14<12:37, 10.10s/it]Best trial: 12. Best value: 0.734748:  25%|██▌       | 25/100 [06:27<12:37, 10.10s/it]Best trial: 12. Best value: 0.734748:  26%|██▌       | 26/100 [06:27<13:31, 10.97s/it]Best trial: 12. Best value: 0.734748:  26%|██▌       | 26/100 [06:35<13:31, 10.97s/it]Best trial: 12. Best value: 0.734748:  27%|██▋       | 27/100 [06:35<12:22, 10.17s/it]Best trial: 12. Best value: 0.734748:  27%|██▋       | 27/100 [06:47<12:22, 10.17s/it]Best trial: 12. Best value: 0.734748:  28%|██▊       | 28/100 [06:47<12:51, 10.71s/it]Best trial: 12. Best value: 0.734748:  28%|██▊       | 28/100 [06:59<12:51, 10.71s/it]Best trial: 12. Best value: 0.734748:  29%|██▉       | 29/100 [06:59<13:05, 11.06s/it]Best trial: 12. Best value: 0.734748:  29%|██▉       | 29/100 [07:24<13:05, 11.06s/it]Best trial: 12. Best value: 0.734748:  30%|███       | 30/100 [07:24<17:43, 15.20s/it]Best trial: 12. Best value: 0.734748:  30%|███       | 30/100 [07:40<17:43, 15.20s/it]Best trial: 12. Best value: 0.734748:  31%|███       | 31/100 [07:40<17:45, 15.45s/it]Best trial: 12. Best value: 0.734748:  31%|███       | 31/100 [07:46<17:45, 15.45s/it]Best trial: 12. Best value: 0.734748:  32%|███▏      | 32/100 [07:46<14:34, 12.86s/it]Best trial: 12. Best value: 0.734748:  32%|███▏      | 32/100 [07:54<14:34, 12.86s/it]Best trial: 12. Best value: 0.734748:  33%|███▎      | 33/100 [07:54<12:30, 11.21s/it]Best trial: 12. Best value: 0.734748:  33%|███▎      | 33/100 [08:00<12:30, 11.21s/it]Best trial: 12. Best value: 0.734748:  34%|███▍      | 34/100 [08:00<10:36,  9.64s/it]Best trial: 12. Best value: 0.734748:  34%|███▍      | 34/100 [08:05<10:36,  9.64s/it]Best trial: 12. Best value: 0.734748:  35%|███▌      | 35/100 [08:05<09:09,  8.45s/it]Best trial: 12. Best value: 0.734748:  35%|███▌      | 35/100 [08:15<09:09,  8.45s/it]Best trial: 12. Best value: 0.734748:  36%|███▌      | 36/100 [08:15<09:26,  8.85s/it]Best trial: 12. Best value: 0.734748:  36%|███▌      | 36/100 [08:25<09:26,  8.85s/it]Best trial: 12. Best value: 0.734748:  37%|███▋      | 37/100 [08:25<09:41,  9.23s/it]Best trial: 12. Best value: 0.734748:  37%|███▋      | 37/100 [08:36<09:41,  9.23s/it]Best trial: 12. Best value: 0.734748:  38%|███▊      | 38/100 [08:36<09:56,  9.61s/it]Best trial: 12. Best value: 0.734748:  38%|███▊      | 38/100 [08:58<09:56,  9.61s/it]Best trial: 12. Best value: 0.734748:  39%|███▉      | 39/100 [08:58<13:32, 13.32s/it]Best trial: 12. Best value: 0.734748:  39%|███▉      | 39/100 [09:04<13:32, 13.32s/it]Best trial: 12. Best value: 0.734748:  40%|████      | 40/100 [09:04<11:18, 11.31s/it]Best trial: 12. Best value: 0.734748:  40%|████      | 40/100 [09:14<11:18, 11.31s/it]Best trial: 12. Best value: 0.734748:  41%|████      | 41/100 [09:14<10:41, 10.88s/it]Best trial: 12. Best value: 0.734748:  41%|████      | 41/100 [09:28<10:41, 10.88s/it]Best trial: 12. Best value: 0.734748:  42%|████▏     | 42/100 [09:28<11:15, 11.65s/it]Best trial: 12. Best value: 0.734748:  42%|████▏     | 42/100 [09:34<11:15, 11.65s/it]Best trial: 12. Best value: 0.734748:  43%|████▎     | 43/100 [09:34<09:40, 10.18s/it]Best trial: 12. Best value: 0.734748:  43%|████▎     | 43/100 [09:41<09:40, 10.18s/it]Best trial: 12. Best value: 0.734748:  44%|████▍     | 44/100 [09:41<08:24,  9.01s/it]Best trial: 12. Best value: 0.734748:  44%|████▍     | 44/100 [09:50<08:24,  9.01s/it]Best trial: 12. Best value: 0.734748:  45%|████▌     | 45/100 [09:50<08:20,  9.10s/it]Best trial: 12. Best value: 0.734748:  45%|████▌     | 45/100 [09:55<08:20,  9.10s/it]Best trial: 12. Best value: 0.734748:  46%|████▌     | 46/100 [09:55<07:12,  8.01s/it]Best trial: 12. Best value: 0.734748:  46%|████▌     | 46/100 [10:10<07:12,  8.01s/it]Best trial: 12. Best value: 0.734748:  47%|████▋     | 47/100 [10:10<08:40,  9.82s/it]Best trial: 12. Best value: 0.734748:  47%|████▋     | 47/100 [10:19<08:40,  9.82s/it]Best trial: 12. Best value: 0.734748:  48%|████▊     | 48/100 [10:19<08:23,  9.69s/it]Best trial: 12. Best value: 0.734748:  48%|████▊     | 48/100 [10:24<08:23,  9.69s/it]Best trial: 12. Best value: 0.734748:  49%|████▉     | 49/100 [10:24<07:07,  8.39s/it]Best trial: 12. Best value: 0.734748:  49%|████▉     | 49/100 [10:47<07:07,  8.39s/it]Best trial: 12. Best value: 0.734748:  50%|█████     | 50/100 [10:47<10:41, 12.83s/it]Best trial: 12. Best value: 0.734748:  50%|█████     | 50/100 [11:12<10:41, 12.83s/it]Best trial: 12. Best value: 0.734748:  51%|█████     | 51/100 [11:12<13:15, 16.24s/it]Best trial: 12. Best value: 0.734748:  51%|█████     | 51/100 [11:24<13:15, 16.24s/it]Best trial: 12. Best value: 0.734748:  52%|█████▏    | 52/100 [11:24<12:09, 15.19s/it]Best trial: 12. Best value: 0.734748:  52%|█████▏    | 52/100 [11:33<12:09, 15.19s/it]Best trial: 12. Best value: 0.734748:  53%|█████▎    | 53/100 [11:33<10:14, 13.07s/it]Best trial: 12. Best value: 0.734748:  53%|█████▎    | 53/100 [11:39<10:14, 13.07s/it]Best trial: 12. Best value: 0.734748:  54%|█████▍    | 54/100 [11:39<08:30, 11.09s/it]Best trial: 12. Best value: 0.734748:  54%|█████▍    | 54/100 [11:48<08:30, 11.09s/it]Best trial: 12. Best value: 0.734748:  55%|█████▌    | 55/100 [11:48<07:53, 10.53s/it]Best trial: 12. Best value: 0.734748:  55%|█████▌    | 55/100 [11:57<07:53, 10.53s/it]Best trial: 12. Best value: 0.734748:  56%|█████▌    | 56/100 [11:57<07:24, 10.11s/it]Best trial: 12. Best value: 0.734748:  56%|█████▌    | 56/100 [12:05<07:24, 10.11s/it]Best trial: 12. Best value: 0.734748:  57%|█████▋    | 57/100 [12:05<06:45,  9.44s/it]Best trial: 12. Best value: 0.734748:  57%|█████▋    | 57/100 [12:12<06:45,  9.44s/it]Best trial: 12. Best value: 0.734748:  58%|█████▊    | 58/100 [12:12<06:04,  8.69s/it]Best trial: 12. Best value: 0.734748:  58%|█████▊    | 58/100 [12:22<06:04,  8.69s/it]Best trial: 12. Best value: 0.734748:  59%|█████▉    | 59/100 [12:22<06:14,  9.13s/it]Best trial: 12. Best value: 0.734748:  59%|█████▉    | 59/100 [12:43<06:14,  9.13s/it]Best trial: 12. Best value: 0.734748:  60%|██████    | 60/100 [12:43<08:24, 12.62s/it]Best trial: 12. Best value: 0.734748:  60%|██████    | 60/100 [12:51<08:24, 12.62s/it]Best trial: 12. Best value: 0.734748:  61%|██████    | 61/100 [12:51<07:21, 11.31s/it]Best trial: 12. Best value: 0.734748:  61%|██████    | 61/100 [12:59<07:21, 11.31s/it]Best trial: 12. Best value: 0.734748:  62%|██████▏   | 62/100 [12:59<06:25, 10.14s/it]Best trial: 12. Best value: 0.734748:  62%|██████▏   | 62/100 [13:07<06:25, 10.14s/it]Best trial: 12. Best value: 0.734748:  63%|██████▎   | 63/100 [13:07<05:55,  9.60s/it]Best trial: 12. Best value: 0.734748:  63%|██████▎   | 63/100 [13:20<05:55,  9.60s/it]Best trial: 12. Best value: 0.734748:  64%|██████▍   | 64/100 [13:20<06:20, 10.58s/it]Best trial: 12. Best value: 0.734748:  64%|██████▍   | 64/100 [13:30<06:20, 10.58s/it]Best trial: 12. Best value: 0.734748:  65%|██████▌   | 65/100 [13:30<06:06, 10.48s/it]Best trial: 12. Best value: 0.734748:  65%|██████▌   | 65/100 [13:37<06:06, 10.48s/it]Best trial: 12. Best value: 0.734748:  66%|██████▌   | 66/100 [13:37<05:20,  9.44s/it]Best trial: 12. Best value: 0.734748:  66%|██████▌   | 66/100 [13:47<05:20,  9.44s/it]Best trial: 12. Best value: 0.734748:  67%|██████▋   | 67/100 [13:47<05:13,  9.49s/it]Best trial: 67. Best value: 0.734781:  67%|██████▋   | 67/100 [13:58<05:13,  9.49s/it]Best trial: 67. Best value: 0.734781:  68%|██████▊   | 68/100 [13:58<05:16,  9.90s/it]Best trial: 67. Best value: 0.734781:  68%|██████▊   | 68/100 [14:16<05:16,  9.90s/it]Best trial: 67. Best value: 0.734781:  69%|██████▉   | 69/100 [14:16<06:29, 12.58s/it]Best trial: 67. Best value: 0.734781:  69%|██████▉   | 69/100 [14:26<06:29, 12.58s/it]Best trial: 67. Best value: 0.734781:  70%|███████   | 70/100 [14:26<05:51, 11.70s/it]Best trial: 67. Best value: 0.734781:  70%|███████   | 70/100 [14:39<05:51, 11.70s/it]Best trial: 67. Best value: 0.734781:  71%|███████   | 71/100 [14:39<05:47, 11.98s/it]Best trial: 67. Best value: 0.734781:  71%|███████   | 71/100 [14:49<05:47, 11.98s/it]Best trial: 67. Best value: 0.734781:  72%|███████▏  | 72/100 [14:49<05:23, 11.56s/it]Best trial: 67. Best value: 0.734781:  72%|███████▏  | 72/100 [14:59<05:23, 11.56s/it]Best trial: 67. Best value: 0.734781:  73%|███████▎  | 73/100 [14:59<04:57, 11.01s/it]Best trial: 67. Best value: 0.734781:  73%|███████▎  | 73/100 [15:09<04:57, 11.01s/it]Best trial: 67. Best value: 0.734781:  74%|███████▍  | 74/100 [15:09<04:39, 10.76s/it]Best trial: 67. Best value: 0.734781:  74%|███████▍  | 74/100 [15:19<04:39, 10.76s/it]Best trial: 67. Best value: 0.734781:  75%|███████▌  | 75/100 [15:19<04:19, 10.37s/it]Best trial: 67. Best value: 0.734781:  75%|███████▌  | 75/100 [15:26<04:19, 10.37s/it]Best trial: 67. Best value: 0.734781:  76%|███████▌  | 76/100 [15:26<03:49,  9.56s/it]Best trial: 67. Best value: 0.734781:  76%|███████▌  | 76/100 [15:36<03:49,  9.56s/it]Best trial: 67. Best value: 0.734781:  77%|███████▋  | 77/100 [15:36<03:41,  9.61s/it]Best trial: 67. Best value: 0.734781:  77%|███████▋  | 77/100 [15:46<03:41,  9.61s/it]Best trial: 67. Best value: 0.734781:  78%|███████▊  | 78/100 [15:46<03:32,  9.67s/it]Best trial: 67. Best value: 0.734781:  78%|███████▊  | 78/100 [15:57<03:32,  9.67s/it]Best trial: 67. Best value: 0.734781:  79%|███████▉  | 79/100 [15:57<03:33, 10.18s/it]Best trial: 67. Best value: 0.734781:  79%|███████▉  | 79/100 [16:08<03:33, 10.18s/it]Best trial: 67. Best value: 0.734781:  80%|████████  | 80/100 [16:08<03:29, 10.48s/it]Best trial: 67. Best value: 0.734781:  80%|████████  | 80/100 [16:15<03:29, 10.48s/it]Best trial: 67. Best value: 0.734781:  81%|████████  | 81/100 [16:15<02:55,  9.21s/it]Best trial: 81. Best value: 0.735537:  81%|████████  | 81/100 [16:23<02:55,  9.21s/it]Best trial: 81. Best value: 0.735537:  82%|████████▏ | 82/100 [16:23<02:40,  8.91s/it]Best trial: 81. Best value: 0.735537:  82%|████████▏ | 82/100 [16:31<02:40,  8.91s/it]Best trial: 81. Best value: 0.735537:  83%|████████▎ | 83/100 [16:31<02:24,  8.52s/it]Best trial: 81. Best value: 0.735537:  83%|████████▎ | 83/100 [16:41<02:24,  8.52s/it]Best trial: 81. Best value: 0.735537:  84%|████████▍ | 84/100 [16:41<02:26,  9.17s/it]Best trial: 81. Best value: 0.735537:  84%|████████▍ | 84/100 [16:53<02:26,  9.17s/it]Best trial: 81. Best value: 0.735537:  85%|████████▌ | 85/100 [16:53<02:26,  9.79s/it]Best trial: 81. Best value: 0.735537:  85%|████████▌ | 85/100 [17:05<02:26,  9.79s/it]Best trial: 81. Best value: 0.735537:  86%|████████▌ | 86/100 [17:05<02:26, 10.50s/it]Best trial: 81. Best value: 0.735537:  86%|████████▌ | 86/100 [17:20<02:26, 10.50s/it]Best trial: 81. Best value: 0.735537:  87%|████████▋ | 87/100 [17:20<02:36, 12.05s/it]Best trial: 87. Best value: 0.737725:  87%|████████▋ | 87/100 [17:32<02:36, 12.05s/it]Best trial: 87. Best value: 0.737725:  88%|████████▊ | 88/100 [17:32<02:23, 12.00s/it]Best trial: 87. Best value: 0.737725:  88%|████████▊ | 88/100 [17:43<02:23, 12.00s/it]Best trial: 87. Best value: 0.737725:  89%|████████▉ | 89/100 [17:43<02:08, 11.65s/it]Best trial: 87. Best value: 0.737725:  89%|████████▉ | 89/100 [17:50<02:08, 11.65s/it]Best trial: 87. Best value: 0.737725:  90%|█████████ | 90/100 [17:50<01:41, 10.20s/it]Best trial: 87. Best value: 0.737725:  90%|█████████ | 90/100 [17:58<01:41, 10.20s/it]Best trial: 87. Best value: 0.737725:  91%|█████████ | 91/100 [17:58<01:26,  9.66s/it]Best trial: 87. Best value: 0.737725:  91%|█████████ | 91/100 [18:12<01:26,  9.66s/it]Best trial: 87. Best value: 0.737725:  92%|█████████▏| 92/100 [18:12<01:27, 10.99s/it]Best trial: 87. Best value: 0.737725:  92%|█████████▏| 92/100 [18:23<01:27, 10.99s/it]Best trial: 87. Best value: 0.737725:  93%|█████████▎| 93/100 [18:23<01:15, 10.80s/it]Best trial: 87. Best value: 0.737725:  93%|█████████▎| 93/100 [18:32<01:15, 10.80s/it]Best trial: 87. Best value: 0.737725:  94%|█████████▍| 94/100 [18:32<01:01, 10.25s/it]Best trial: 87. Best value: 0.737725:  94%|█████████▍| 94/100 [18:39<01:01, 10.25s/it]Best trial: 87. Best value: 0.737725:  95%|█████████▌| 95/100 [18:39<00:46,  9.23s/it]Best trial: 87. Best value: 0.737725:  95%|█████████▌| 95/100 [18:51<00:46,  9.23s/it]Best trial: 87. Best value: 0.737725:  96%|█████████▌| 96/100 [18:51<00:40, 10.10s/it]Best trial: 87. Best value: 0.737725:  96%|█████████▌| 96/100 [19:12<00:40, 10.10s/it]Best trial: 87. Best value: 0.737725:  97%|█████████▋| 97/100 [19:12<00:40, 13.41s/it]Best trial: 87. Best value: 0.737725:  97%|█████████▋| 97/100 [19:22<00:40, 13.41s/it]Best trial: 87. Best value: 0.737725:  98%|█████████▊| 98/100 [19:22<00:24, 12.37s/it]Best trial: 87. Best value: 0.737725:  98%|█████████▊| 98/100 [19:29<00:24, 12.37s/it]Best trial: 87. Best value: 0.737725:  99%|█████████▉| 99/100 [19:29<00:10, 10.87s/it]Best trial: 87. Best value: 0.737725:  99%|█████████▉| 99/100 [19:39<00:10, 10.87s/it]Best trial: 87. Best value: 0.737725: 100%|██████████| 100/100 [19:39<00:00, 10.65s/it]Best trial: 87. Best value: 0.737725: 100%|██████████| 100/100 [19:39<00:00, 11.80s/it]
2025-12-01 07:14:38,235 - INFO - HPO Complete. Best AUPRC: 0.7377
2025-12-01 07:14:38,236 - INFO - Best Params: {'n_estimators': 500, 'learning_rate': 0.036703381481680286, 'max_depth': 3, 'subsample': 0.8305609356007191, 'colsample_bytree': 0.6229832612109628, 'gamma': 4.437704561011136, 'reg_lambda': 3.8828099701576164e-07, 'reg_alpha': 2.293479024848364e-08}
2025-12-01 07:14:38,237 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_all_minus_co2.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 07:14:40,474 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_co2
2025-12-01 07:14:40,475 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 07:14:40,727 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 07:14:40,795 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 07:14:40,808 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 07:14:40,808 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 07:14:40,809 - INFO - Training model...
2025-12-01 07:14:43,747 - INFO - Evaluating model with bootstrapping...
2025-12-01 07:14:50,371 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 07:14:50,371 - INFO - AUROC: 0.8904 (0.8530 - 0.9057)
2025-12-01 07:14:50,371 - INFO - AUPRC: 0.7400 (0.6759 - 0.7810)
2025-12-01 07:14:50,371 - INFO - Brier Score: 0.1042 (0.0975 - 0.1210)
2025-12-01 07:14:50,371 - INFO - Accuracy: 0.8584 (0.8035 - 0.8879)
2025-12-01 07:14:50,371 - INFO - Precision: 0.6490 (0.5027 - 0.7280)
2025-12-01 07:14:50,371 - INFO - Sensitivity (Recall): 0.6853 (0.5927 - 0.8441)
2025-12-01 07:14:50,371 - INFO - F1-Score: 0.6667 (0.6087 - 0.7248)
2025-12-01 07:14:50,372 - INFO - Best Threshold: 0.4900 (0.3200 - 0.5840)
2025-12-01 07:14:50,372 - INFO - Specificity: 0.9035 (0.8062 - 0.9415)
2025-12-01 07:14:50,387 - INFO - Calculating SHAP values...
2025-12-01 07:14:51,525 - INFO - SHAP plots saved.
2025-12-01 07:14:51,527 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_all_minus_co2
  > Training Complete.
----------------------------------------------------------------
Running: Outcome=icu_admission | Branch=windowed | FeatureSet=preop_and_all_minus_awp
----------------------------------------------------------------
  > Starting HPO...
2025-12-01 07:14:52,970 - INFO - Starting HPO for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 07:14:52,970 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 07:14:53,202 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 07:14:53,271 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 07:14:53,283 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 07:14:53,283 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.719226:   0%|          | 0/100 [00:22<?, ?it/s]Best trial: 0. Best value: 0.719226:   1%|          | 1/100 [00:22<37:40, 22.83s/it]Best trial: 1. Best value: 0.721768:   1%|          | 1/100 [00:38<37:40, 22.83s/it]Best trial: 1. Best value: 0.721768:   2%|▏         | 2/100 [00:38<30:16, 18.54s/it]Best trial: 1. Best value: 0.721768:   2%|▏         | 2/100 [00:48<30:16, 18.54s/it]Best trial: 1. Best value: 0.721768:   3%|▎         | 3/100 [00:48<24:01, 14.86s/it]Best trial: 1. Best value: 0.721768:   3%|▎         | 3/100 [01:54<24:01, 14.86s/it]Best trial: 1. Best value: 0.721768:   4%|▍         | 4/100 [01:54<55:59, 34.99s/it]Best trial: 4. Best value: 0.733247:   4%|▍         | 4/100 [02:16<55:59, 34.99s/it]Best trial: 4. Best value: 0.733247:   5%|▌         | 5/100 [02:16<48:06, 30.38s/it]Best trial: 4. Best value: 0.733247:   5%|▌         | 5/100 [02:53<48:06, 30.38s/it]Best trial: 4. Best value: 0.733247:   6%|▌         | 6/100 [02:53<50:55, 32.50s/it]Best trial: 4. Best value: 0.733247:   6%|▌         | 6/100 [03:30<50:55, 32.50s/it]Best trial: 4. Best value: 0.733247:   7%|▋         | 7/100 [03:30<52:28, 33.86s/it]Best trial: 4. Best value: 0.733247:   7%|▋         | 7/100 [04:19<52:28, 33.86s/it]Best trial: 4. Best value: 0.733247:   8%|▊         | 8/100 [04:19<59:25, 38.75s/it]Best trial: 4. Best value: 0.733247:   8%|▊         | 8/100 [05:00<59:25, 38.75s/it]Best trial: 4. Best value: 0.733247:   9%|▉         | 9/100 [05:00<59:48, 39.43s/it]Best trial: 4. Best value: 0.733247:   9%|▉         | 9/100 [05:44<59:48, 39.43s/it]Best trial: 4. Best value: 0.733247:  10%|█         | 10/100 [05:44<1:01:06, 40.74s/it]Best trial: 4. Best value: 0.733247:  10%|█         | 10/100 [05:53<1:01:06, 40.74s/it]Best trial: 4. Best value: 0.733247:  11%|█         | 11/100 [05:53<46:12, 31.15s/it]  Best trial: 4. Best value: 0.733247:  11%|█         | 11/100 [06:13<46:12, 31.15s/it]Best trial: 4. Best value: 0.733247:  12%|█▏        | 12/100 [06:13<40:54, 27.89s/it]Best trial: 4. Best value: 0.733247:  12%|█▏        | 12/100 [06:25<40:54, 27.89s/it]Best trial: 4. Best value: 0.733247:  13%|█▎        | 13/100 [06:25<33:25, 23.05s/it]Best trial: 4. Best value: 0.733247:  13%|█▎        | 13/100 [06:55<33:25, 23.05s/it]Best trial: 4. Best value: 0.733247:  14%|█▍        | 14/100 [06:55<35:51, 25.01s/it]Best trial: 4. Best value: 0.733247:  14%|█▍        | 14/100 [07:26<35:51, 25.01s/it]Best trial: 4. Best value: 0.733247:  15%|█▌        | 15/100 [07:26<38:13, 26.98s/it]Best trial: 4. Best value: 0.733247:  15%|█▌        | 15/100 [07:48<38:13, 26.98s/it]Best trial: 4. Best value: 0.733247:  16%|█▌        | 16/100 [07:48<35:24, 25.29s/it]Best trial: 4. Best value: 0.733247:  16%|█▌        | 16/100 [08:05<35:24, 25.29s/it]Best trial: 4. Best value: 0.733247:  17%|█▋        | 17/100 [08:05<31:33, 22.81s/it]Best trial: 4. Best value: 0.733247:  17%|█▋        | 17/100 [08:20<31:33, 22.81s/it]Best trial: 4. Best value: 0.733247:  18%|█▊        | 18/100 [08:20<27:55, 20.44s/it]Best trial: 4. Best value: 0.733247:  18%|█▊        | 18/100 [08:32<27:55, 20.44s/it]Best trial: 4. Best value: 0.733247:  19%|█▉        | 19/100 [08:32<24:09, 17.89s/it]Best trial: 4. Best value: 0.733247:  19%|█▉        | 19/100 [08:48<24:09, 17.89s/it]Best trial: 4. Best value: 0.733247:  20%|██        | 20/100 [08:48<23:14, 17.43s/it]Best trial: 4. Best value: 0.733247:  20%|██        | 20/100 [09:41<23:14, 17.43s/it]Best trial: 4. Best value: 0.733247:  21%|██        | 21/100 [09:41<37:01, 28.12s/it]Best trial: 4. Best value: 0.733247:  21%|██        | 21/100 [10:00<37:01, 28.12s/it]Best trial: 4. Best value: 0.733247:  22%|██▏       | 22/100 [10:00<32:48, 25.24s/it]Best trial: 4. Best value: 0.733247:  22%|██▏       | 22/100 [10:24<32:48, 25.24s/it]Best trial: 4. Best value: 0.733247:  23%|██▎       | 23/100 [10:24<31:57, 24.90s/it]Best trial: 4. Best value: 0.733247:  23%|██▎       | 23/100 [10:33<31:57, 24.90s/it]Best trial: 4. Best value: 0.733247:  24%|██▍       | 24/100 [10:33<25:34, 20.19s/it]Best trial: 4. Best value: 0.733247:  24%|██▍       | 24/100 [10:46<25:34, 20.19s/it]Best trial: 4. Best value: 0.733247:  25%|██▌       | 25/100 [10:46<22:28, 17.99s/it]Best trial: 25. Best value: 0.735247:  25%|██▌       | 25/100 [10:59<22:28, 17.99s/it]Best trial: 25. Best value: 0.735247:  26%|██▌       | 26/100 [10:59<20:22, 16.53s/it]Best trial: 25. Best value: 0.735247:  26%|██▌       | 26/100 [11:17<20:22, 16.53s/it]Best trial: 25. Best value: 0.735247:  27%|██▋       | 27/100 [11:17<20:34, 16.91s/it]Best trial: 25. Best value: 0.735247:  27%|██▋       | 27/100 [11:44<20:34, 16.91s/it]Best trial: 25. Best value: 0.735247:  28%|██▊       | 28/100 [11:44<24:03, 20.05s/it]Best trial: 25. Best value: 0.735247:  28%|██▊       | 28/100 [11:54<24:03, 20.05s/it]Best trial: 25. Best value: 0.735247:  29%|██▉       | 29/100 [11:54<20:18, 17.16s/it]Best trial: 25. Best value: 0.735247:  29%|██▉       | 29/100 [12:19<20:18, 17.16s/it]Best trial: 25. Best value: 0.735247:  30%|███       | 30/100 [12:19<22:35, 19.36s/it]Best trial: 25. Best value: 0.735247:  30%|███       | 30/100 [12:30<22:35, 19.36s/it]Best trial: 25. Best value: 0.735247:  31%|███       | 31/100 [12:30<19:30, 16.96s/it]Best trial: 25. Best value: 0.735247:  31%|███       | 31/100 [12:53<19:30, 16.96s/it]Best trial: 25. Best value: 0.735247:  32%|███▏      | 32/100 [12:53<21:20, 18.84s/it]Best trial: 25. Best value: 0.735247:  32%|███▏      | 32/100 [13:10<21:20, 18.84s/it]Best trial: 25. Best value: 0.735247:  33%|███▎      | 33/100 [13:10<20:15, 18.14s/it]Best trial: 25. Best value: 0.735247:  33%|███▎      | 33/100 [13:36<20:15, 18.14s/it]Best trial: 25. Best value: 0.735247:  34%|███▍      | 34/100 [13:36<22:36, 20.56s/it]Best trial: 25. Best value: 0.735247:  34%|███▍      | 34/100 [13:56<22:36, 20.56s/it]Best trial: 25. Best value: 0.735247:  35%|███▌      | 35/100 [13:56<22:00, 20.31s/it]Best trial: 25. Best value: 0.735247:  35%|███▌      | 35/100 [14:12<22:00, 20.31s/it]Best trial: 25. Best value: 0.735247:  36%|███▌      | 36/100 [14:12<20:14, 18.98s/it]Best trial: 25. Best value: 0.735247:  36%|███▌      | 36/100 [14:20<20:14, 18.98s/it]Best trial: 25. Best value: 0.735247:  37%|███▋      | 37/100 [14:20<16:27, 15.67s/it]Best trial: 25. Best value: 0.735247:  37%|███▋      | 37/100 [14:36<16:27, 15.67s/it]Best trial: 25. Best value: 0.735247:  38%|███▊      | 38/100 [14:36<16:13, 15.70s/it]Best trial: 25. Best value: 0.735247:  38%|███▊      | 38/100 [14:44<16:13, 15.70s/it]Best trial: 25. Best value: 0.735247:  39%|███▉      | 39/100 [14:44<13:53, 13.66s/it]Best trial: 25. Best value: 0.735247:  39%|███▉      | 39/100 [15:03<13:53, 13.66s/it]Best trial: 25. Best value: 0.735247:  40%|████      | 40/100 [15:03<15:06, 15.10s/it]Best trial: 25. Best value: 0.735247:  40%|████      | 40/100 [15:24<15:06, 15.10s/it]Best trial: 25. Best value: 0.735247:  41%|████      | 41/100 [15:24<16:40, 16.95s/it]Best trial: 25. Best value: 0.735247:  41%|████      | 41/100 [15:42<16:40, 16.95s/it]Best trial: 25. Best value: 0.735247:  42%|████▏     | 42/100 [15:42<16:46, 17.36s/it]Best trial: 25. Best value: 0.735247:  42%|████▏     | 42/100 [15:58<16:46, 17.36s/it]Best trial: 25. Best value: 0.735247:  43%|████▎     | 43/100 [15:58<15:56, 16.77s/it]Best trial: 25. Best value: 0.735247:  43%|████▎     | 43/100 [16:15<15:56, 16.77s/it]Best trial: 25. Best value: 0.735247:  44%|████▍     | 44/100 [16:15<15:47, 16.92s/it]Best trial: 25. Best value: 0.735247:  44%|████▍     | 44/100 [16:28<15:47, 16.92s/it]Best trial: 25. Best value: 0.735247:  45%|████▌     | 45/100 [16:28<14:24, 15.71s/it]Best trial: 25. Best value: 0.735247:  45%|████▌     | 45/100 [16:37<14:24, 15.71s/it]Best trial: 25. Best value: 0.735247:  46%|████▌     | 46/100 [16:37<12:17, 13.66s/it]Best trial: 25. Best value: 0.735247:  46%|████▌     | 46/100 [16:46<12:17, 13.66s/it]Best trial: 25. Best value: 0.735247:  47%|████▋     | 47/100 [16:46<10:48, 12.23s/it]Best trial: 25. Best value: 0.735247:  47%|████▋     | 47/100 [16:57<10:48, 12.23s/it]Best trial: 25. Best value: 0.735247:  48%|████▊     | 48/100 [16:57<10:24, 12.02s/it]Best trial: 25. Best value: 0.735247:  48%|████▊     | 48/100 [17:12<10:24, 12.02s/it]Best trial: 25. Best value: 0.735247:  49%|████▉     | 49/100 [17:12<10:58, 12.91s/it]Best trial: 25. Best value: 0.735247:  49%|████▉     | 49/100 [17:23<10:58, 12.91s/it]Best trial: 25. Best value: 0.735247:  50%|█████     | 50/100 [17:23<10:16, 12.33s/it]Best trial: 25. Best value: 0.735247:  50%|█████     | 50/100 [17:34<10:16, 12.33s/it]Best trial: 25. Best value: 0.735247:  51%|█████     | 51/100 [17:34<09:41, 11.86s/it]Best trial: 25. Best value: 0.735247:  51%|█████     | 51/100 [17:45<09:41, 11.86s/it]Best trial: 25. Best value: 0.735247:  52%|█████▏    | 52/100 [17:45<09:10, 11.46s/it]Best trial: 25. Best value: 0.735247:  52%|█████▏    | 52/100 [18:01<09:10, 11.46s/it]Best trial: 25. Best value: 0.735247:  53%|█████▎    | 53/100 [18:01<10:15, 13.10s/it]Best trial: 25. Best value: 0.735247:  53%|█████▎    | 53/100 [18:17<10:15, 13.10s/it]Best trial: 25. Best value: 0.735247:  54%|█████▍    | 54/100 [18:17<10:35, 13.82s/it]Best trial: 25. Best value: 0.735247:  54%|█████▍    | 54/100 [18:41<10:35, 13.82s/it]Best trial: 25. Best value: 0.735247:  55%|█████▌    | 55/100 [18:41<12:34, 16.77s/it]Best trial: 25. Best value: 0.735247:  55%|█████▌    | 55/100 [19:30<12:34, 16.77s/it]Best trial: 25. Best value: 0.735247:  56%|█████▌    | 56/100 [19:30<19:25, 26.49s/it]Best trial: 25. Best value: 0.735247:  56%|█████▌    | 56/100 [19:41<19:25, 26.49s/it]Best trial: 25. Best value: 0.735247:  57%|█████▋    | 57/100 [19:41<15:38, 21.82s/it]Best trial: 25. Best value: 0.735247:  57%|█████▋    | 57/100 [19:56<15:38, 21.82s/it]Best trial: 25. Best value: 0.735247:  58%|█████▊    | 58/100 [19:56<13:51, 19.79s/it]Best trial: 25. Best value: 0.735247:  58%|█████▊    | 58/100 [20:07<13:51, 19.79s/it]Best trial: 25. Best value: 0.735247:  59%|█████▉    | 59/100 [20:07<11:42, 17.14s/it]Best trial: 25. Best value: 0.735247:  59%|█████▉    | 59/100 [20:18<11:42, 17.14s/it]Best trial: 25. Best value: 0.735247:  60%|██████    | 60/100 [20:18<10:08, 15.22s/it]Best trial: 25. Best value: 0.735247:  60%|██████    | 60/100 [20:42<10:08, 15.22s/it]Best trial: 25. Best value: 0.735247:  61%|██████    | 61/100 [20:42<11:46, 18.12s/it]Best trial: 25. Best value: 0.735247:  61%|██████    | 61/100 [20:56<11:46, 18.12s/it]Best trial: 25. Best value: 0.735247:  62%|██████▏   | 62/100 [20:56<10:36, 16.74s/it]Best trial: 25. Best value: 0.735247:  62%|██████▏   | 62/100 [21:14<10:36, 16.74s/it]Best trial: 25. Best value: 0.735247:  63%|██████▎   | 63/100 [21:14<10:38, 17.26s/it]Best trial: 25. Best value: 0.735247:  63%|██████▎   | 63/100 [21:26<10:38, 17.26s/it]Best trial: 25. Best value: 0.735247:  64%|██████▍   | 64/100 [21:26<09:15, 15.44s/it]Best trial: 25. Best value: 0.735247:  64%|██████▍   | 64/100 [21:36<09:15, 15.44s/it]Best trial: 25. Best value: 0.735247:  65%|██████▌   | 65/100 [21:36<08:09, 13.98s/it]Best trial: 25. Best value: 0.735247:  65%|██████▌   | 65/100 [21:46<08:09, 13.98s/it]Best trial: 25. Best value: 0.735247:  66%|██████▌   | 66/100 [21:46<07:14, 12.79s/it]Best trial: 25. Best value: 0.735247:  66%|██████▌   | 66/100 [21:53<07:14, 12.79s/it]Best trial: 25. Best value: 0.735247:  67%|██████▋   | 67/100 [21:53<05:59, 10.91s/it]Best trial: 25. Best value: 0.735247:  67%|██████▋   | 67/100 [22:03<05:59, 10.91s/it]Best trial: 25. Best value: 0.735247:  68%|██████▊   | 68/100 [22:03<05:47, 10.84s/it]Best trial: 68. Best value: 0.736313:  68%|██████▊   | 68/100 [22:47<05:47, 10.84s/it]Best trial: 68. Best value: 0.736313:  69%|██████▉   | 69/100 [22:47<10:44, 20.78s/it]Best trial: 68. Best value: 0.736313:  69%|██████▉   | 69/100 [23:10<10:44, 20.78s/it]Best trial: 68. Best value: 0.736313:  70%|███████   | 70/100 [23:10<10:42, 21.43s/it]Best trial: 68. Best value: 0.736313:  70%|███████   | 70/100 [23:29<10:42, 21.43s/it]Best trial: 68. Best value: 0.736313:  71%|███████   | 71/100 [23:29<09:59, 20.67s/it]Best trial: 68. Best value: 0.736313:  71%|███████   | 71/100 [24:04<09:59, 20.67s/it]Best trial: 68. Best value: 0.736313:  72%|███████▏  | 72/100 [24:04<11:36, 24.89s/it]Best trial: 68. Best value: 0.736313:  72%|███████▏  | 72/100 [24:34<11:36, 24.89s/it]Best trial: 68. Best value: 0.736313:  73%|███████▎  | 73/100 [24:34<11:52, 26.39s/it]Best trial: 68. Best value: 0.736313:  73%|███████▎  | 73/100 [24:58<11:52, 26.39s/it]Best trial: 68. Best value: 0.736313:  74%|███████▍  | 74/100 [24:58<11:07, 25.68s/it]Best trial: 68. Best value: 0.736313:  74%|███████▍  | 74/100 [25:16<11:07, 25.68s/it]Best trial: 68. Best value: 0.736313:  75%|███████▌  | 75/100 [25:16<09:46, 23.47s/it]Best trial: 68. Best value: 0.736313:  75%|███████▌  | 75/100 [25:27<09:46, 23.47s/it]Best trial: 68. Best value: 0.736313:  76%|███████▌  | 76/100 [25:27<07:53, 19.75s/it]Best trial: 68. Best value: 0.736313:  76%|███████▌  | 76/100 [25:38<07:53, 19.75s/it]Best trial: 68. Best value: 0.736313:  77%|███████▋  | 77/100 [25:38<06:33, 17.10s/it]Best trial: 68. Best value: 0.736313:  77%|███████▋  | 77/100 [25:43<06:33, 17.10s/it]Best trial: 68. Best value: 0.736313:  78%|███████▊  | 78/100 [25:43<04:55, 13.45s/it]Best trial: 68. Best value: 0.736313:  78%|███████▊  | 78/100 [25:52<04:55, 13.45s/it]Best trial: 68. Best value: 0.736313:  79%|███████▉  | 79/100 [25:52<04:14, 12.13s/it]Best trial: 68. Best value: 0.736313:  79%|███████▉  | 79/100 [26:04<04:14, 12.13s/it]Best trial: 68. Best value: 0.736313:  80%|████████  | 80/100 [26:04<03:59, 11.96s/it]Best trial: 68. Best value: 0.736313:  80%|████████  | 80/100 [26:20<03:59, 11.96s/it]Best trial: 68. Best value: 0.736313:  81%|████████  | 81/100 [26:20<04:10, 13.19s/it]Best trial: 68. Best value: 0.736313:  81%|████████  | 81/100 [26:33<04:10, 13.19s/it]Best trial: 68. Best value: 0.736313:  82%|████████▏ | 82/100 [26:33<03:56, 13.16s/it]Best trial: 68. Best value: 0.736313:  82%|████████▏ | 82/100 [26:43<03:56, 13.16s/it]Best trial: 68. Best value: 0.736313:  83%|████████▎ | 83/100 [26:43<03:30, 12.38s/it]Best trial: 68. Best value: 0.736313:  83%|████████▎ | 83/100 [26:52<03:30, 12.38s/it]Best trial: 68. Best value: 0.736313:  84%|████████▍ | 84/100 [26:52<03:01, 11.33s/it]Best trial: 68. Best value: 0.736313:  84%|████████▍ | 84/100 [27:00<03:01, 11.33s/it]Best trial: 68. Best value: 0.736313:  85%|████████▌ | 85/100 [27:00<02:33, 10.26s/it]Best trial: 68. Best value: 0.736313:  85%|████████▌ | 85/100 [27:12<02:33, 10.26s/it]Best trial: 68. Best value: 0.736313:  86%|████████▌ | 86/100 [27:12<02:29, 10.69s/it]Best trial: 68. Best value: 0.736313:  86%|████████▌ | 86/100 [27:23<02:29, 10.69s/it]Best trial: 68. Best value: 0.736313:  87%|████████▋ | 87/100 [27:23<02:21, 10.86s/it]Best trial: 68. Best value: 0.736313:  87%|████████▋ | 87/100 [27:29<02:21, 10.86s/it]Best trial: 68. Best value: 0.736313:  88%|████████▊ | 88/100 [27:29<01:54,  9.52s/it]Best trial: 68. Best value: 0.736313:  88%|████████▊ | 88/100 [27:48<01:54,  9.52s/it]Best trial: 68. Best value: 0.736313:  89%|████████▉ | 89/100 [27:48<02:13, 12.16s/it]Best trial: 68. Best value: 0.736313:  89%|████████▉ | 89/100 [27:57<02:13, 12.16s/it]Best trial: 68. Best value: 0.736313:  90%|█████████ | 90/100 [27:57<01:53, 11.34s/it]Best trial: 68. Best value: 0.736313:  90%|█████████ | 90/100 [28:28<01:53, 11.34s/it]Best trial: 68. Best value: 0.736313:  91%|█████████ | 91/100 [28:28<02:35, 17.29s/it]Best trial: 68. Best value: 0.736313:  91%|█████████ | 91/100 [28:40<02:35, 17.29s/it]Best trial: 68. Best value: 0.736313:  92%|█████████▏| 92/100 [28:40<02:04, 15.52s/it]Best trial: 68. Best value: 0.736313:  92%|█████████▏| 92/100 [28:51<02:04, 15.52s/it]Best trial: 68. Best value: 0.736313:  93%|█████████▎| 93/100 [28:51<01:39, 14.19s/it]Best trial: 68. Best value: 0.736313:  93%|█████████▎| 93/100 [29:07<01:39, 14.19s/it]Best trial: 68. Best value: 0.736313:  94%|█████████▍| 94/100 [29:07<01:28, 14.67s/it]Best trial: 68. Best value: 0.736313:  94%|█████████▍| 94/100 [29:18<01:28, 14.67s/it]Best trial: 68. Best value: 0.736313:  95%|█████████▌| 95/100 [29:18<01:08, 13.73s/it]Best trial: 68. Best value: 0.736313:  95%|█████████▌| 95/100 [29:27<01:08, 13.73s/it]Best trial: 68. Best value: 0.736313:  96%|█████████▌| 96/100 [29:27<00:49, 12.43s/it]Best trial: 68. Best value: 0.736313:  96%|█████████▌| 96/100 [29:54<00:49, 12.43s/it]Best trial: 68. Best value: 0.736313:  97%|█████████▋| 97/100 [29:54<00:49, 16.63s/it]Best trial: 68. Best value: 0.736313:  97%|█████████▋| 97/100 [30:01<00:49, 16.63s/it]Best trial: 68. Best value: 0.736313:  98%|█████████▊| 98/100 [30:01<00:27, 13.88s/it]Best trial: 68. Best value: 0.736313:  98%|█████████▊| 98/100 [30:19<00:27, 13.88s/it]Best trial: 68. Best value: 0.736313:  99%|█████████▉| 99/100 [30:19<00:14, 14.86s/it]Best trial: 68. Best value: 0.736313:  99%|█████████▉| 99/100 [30:27<00:14, 14.86s/it]Best trial: 68. Best value: 0.736313: 100%|██████████| 100/100 [30:27<00:00, 13.01s/it]Best trial: 68. Best value: 0.736313: 100%|██████████| 100/100 [30:27<00:00, 18.28s/it]
2025-12-01 07:45:20,984 - INFO - HPO Complete. Best AUPRC: 0.7363
2025-12-01 07:45:20,985 - INFO - Best Params: {'n_estimators': 700, 'learning_rate': 0.043483642230313875, 'max_depth': 7, 'subsample': 0.8028805867445723, 'colsample_bytree': 0.9266718378520434, 'gamma': 0.00952028928287351, 'reg_lambda': 0.0034566879155439843, 'reg_alpha': 6.9622481562619574e-06}
2025-12-01 07:45:20,985 - INFO - Best parameters saved to /media/volume/catch22/projects/aki_prediction_project/results/params/icu_admission/windowed/preop_and_all_minus_awp.json
  > HPO Complete.
  > Starting Training & Evaluation...
2025-12-01 07:45:23,320 - INFO - Starting Training/Evaluation for Outcome: icu_admission, Branch: windowed, Feature Set: preop_and_all_minus_awp
2025-12-01 07:45:23,320 - INFO - Loading data from /media/volume/catch22/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
2025-12-01 07:45:23,548 - INFO - Data loaded. Shape: (3453, 483)
2025-12-01 07:45:23,619 - INFO - Using existing 'split_group' column for train/test split.
2025-12-01 07:45:23,634 - INFO - Data prepared. Train shape: (2761, 380), Test shape: (692, 380)
2025-12-01 07:45:23,634 - INFO - Positive samples in train: 647, Negative: 2114, Scale Pos Weight: 3.2674
2025-12-01 07:45:23,634 - INFO - Training model...
2025-12-01 07:45:35,333 - INFO - Evaluating model with bootstrapping...
2025-12-01 07:45:42,201 - INFO - --- Final Metrics (with 95% CIs) ---
2025-12-01 07:45:42,201 - INFO - AUROC: 0.8946 (0.8700 - 0.9197)
2025-12-01 07:45:42,201 - INFO - AUPRC: 0.7634 (0.7191 - 0.8081)
2025-12-01 07:45:42,201 - INFO - Brier Score: 0.0952 (0.0856 - 0.1157)
2025-12-01 07:45:42,201 - INFO - Accuracy: 0.8801 (0.8410 - 0.8951)
2025-12-01 07:45:42,201 - INFO - Precision: 0.7273 (0.5910 - 0.7531)
2025-12-01 07:45:42,201 - INFO - Sensitivity (Recall): 0.6713 (0.6297 - 0.8804)
2025-12-01 07:45:42,201 - INFO - F1-Score: 0.6982 (0.6516 - 0.7477)
2025-12-01 07:45:42,201 - INFO - Best Threshold: 0.3700 (0.0900 - 0.4240)
2025-12-01 07:45:42,201 - INFO - Specificity: 0.9344 (0.8490 - 0.9452)
2025-12-01 07:45:42,236 - INFO - Calculating SHAP values...
2025-12-01 07:45:43,835 - INFO - SHAP plots saved.
2025-12-01 07:45:43,838 - INFO - Results saved to /media/volume/catch22/projects/aki_prediction_project/results/models/icu_admission/windowed/preop_and_all_minus_awp
  > Training Complete.
All experiments finished.
Starting Experiments...
Prep mode: force | Models: xgboost | Results dir: /home/exouser/js2-volume/projects/aki_prediction_project/results
--- Running data preparation (steps 01–05) ---
Total cases in VitalDB: 6388
All department cases: 6388
Cases after removing missing essential data: 6016

Initial Cohort DataFrame Head:
   caseid  subjectid  casestart  ...  intraop_phe  intraop_epi  intraop_ca
0       1       5955          0  ...            0            0           0
1       2       2487          0  ...            0            0           0
2       3       2861          0  ...            0            0           0
3       4       1903          0  ...            0            0           0
4       5       4416          0  ...          900            0        2100

[5 rows x 74 columns]
Missing value percentages for preoperative variables (>0%):
cline2                 99.069149
aline2                 98.420878
lmasize                98.337766
preop_be               91.356383
preop_sao2             91.339761
preop_hco3             91.339761
preop_pao2             91.256649
preop_paco2            91.256649
preop_ph               91.123670
dltubesize             86.768617
iv2                    77.892287
cline1                 76.861702
aline1                 46.841755
intraop_uo             42.021277
intraop_ebl            37.333777
tubesize               21.725399
cormack                12.998670
airway                  6.399601
intraop_crystalloid     6.183511
preop_na                4.421543
preop_k                 4.388298
position                3.075133
preop_aptt              1.579122
preop_pt                1.363032
iv1                     1.146941
preop_gluc              0.631649
preop_plt               0.548537
preop_hb                0.349069
preop_ast               0.249335
preop_alt               0.216090
preop_alb               0.116356
preop_bun               0.099734
dtype: float64
Using vitaldb.find_cases() to find all cases with the '['SNUADC/PLETH', 'SNUADC/ECG_II', 'Primus/CO2', 'Primus/AWP']' waveforms...
Total cases in VitalDB with 'SNUADC/PLETH' or substitute 'None': 6157
Found 5802 cases with 'SNUADC/PLETH' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.44%
Total cases in VitalDB with 'SNUADC/ECG_II' or substitute '['SNUADC/ECG_V5']': 6355
Found 5801 cases with 'SNUADC/ECG_II' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.43%
Total cases in VitalDB with 'Primus/CO2' or substitute 'None': 6362
Found 5778 cases with 'Primus/CO2' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.04%
Total cases in VitalDB with 'Primus/AWP' or substitute 'None': 6360
Found 5776 cases with 'Primus/AWP' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.01%

Your final cohort with available waveform data now has 5776 cases.
Cases after excluding severe kidney disease: 5584
Cohort size after ensuring sample independence: 5343

Filtering cohort to include only patients with postoperative creatinine labs...
Final study cohort size after excluding patients without post-op labs: 3462
Loading lab data...
Lab data loaded and filtered for creatinine.
Calculating AKI Stages:   0%|          | 0/3462 [00:00<?, ?it/s]Calculating AKI Stages:   3%|▎         | 97/3462 [00:00<00:03, 966.12it/s]Calculating AKI Stages:   6%|▌         | 200/3462 [00:00<00:03, 999.68it/s]Calculating AKI Stages:   9%|▉         | 305/3462 [00:00<00:03, 1020.70it/s]Calculating AKI Stages:  12%|█▏        | 410/3462 [00:00<00:02, 1031.66it/s]Calculating AKI Stages:  15%|█▍        | 514/3462 [00:00<00:02, 1034.61it/s]Calculating AKI Stages:  18%|█▊        | 620/3462 [00:00<00:02, 1040.50it/s]Calculating AKI Stages:  21%|██        | 725/3462 [00:00<00:02, 1043.27it/s]Calculating AKI Stages:  24%|██▍       | 832/3462 [00:00<00:02, 1050.58it/s]Calculating AKI Stages:  27%|██▋       | 938/3462 [00:00<00:02, 1045.93it/s]Calculating AKI Stages:  30%|███       | 1043/3462 [00:01<00:02, 1045.18it/s]Calculating AKI Stages:  33%|███▎      | 1149/3462 [00:01<00:02, 1046.89it/s]Calculating AKI Stages:  36%|███▋      | 1256/3462 [00:01<00:02, 1051.45it/s]Calculating AKI Stages:  39%|███▉      | 1362/3462 [00:01<00:01, 1052.61it/s]Calculating AKI Stages:  42%|████▏     | 1468/3462 [00:01<00:01, 1049.49it/s]Calculating AKI Stages:  45%|████▌     | 1574/3462 [00:01<00:01, 1051.14it/s]Calculating AKI Stages:  49%|████▊     | 1680/3462 [00:01<00:01, 1045.92it/s]Calculating AKI Stages:  52%|█████▏    | 1787/3462 [00:01<00:01, 1052.23it/s]Calculating AKI Stages:  55%|█████▍    | 1893/3462 [00:01<00:01, 1050.64it/s]Calculating AKI Stages:  58%|█████▊    | 2000/3462 [00:01<00:01, 1054.98it/s]Calculating AKI Stages:  61%|██████    | 2108/3462 [00:02<00:01, 1060.34it/s]Calculating AKI Stages:  64%|██████▍   | 2215/3462 [00:02<00:01, 1055.83it/s]Calculating AKI Stages:  67%|██████▋   | 2321/3462 [00:02<00:01, 1056.50it/s]Calculating AKI Stages:  70%|███████   | 2427/3462 [00:02<00:00, 1056.41it/s]Calculating AKI Stages:  73%|███████▎  | 2533/3462 [00:02<00:00, 1056.84it/s]Calculating AKI Stages:  76%|███████▌  | 2639/3462 [00:02<00:00, 1051.38it/s]Calculating AKI Stages:  79%|███████▉  | 2745/3462 [00:02<00:00, 1047.75it/s]Calculating AKI Stages:  82%|████████▏ | 2850/3462 [00:02<00:00, 1048.32it/s]Calculating AKI Stages:  85%|████████▌ | 2956/3462 [00:02<00:00, 1049.49it/s]Calculating AKI Stages:  88%|████████▊ | 3062/3462 [00:02<00:00, 1050.85it/s]Calculating AKI Stages:  92%|█████████▏| 3172/3462 [00:03<00:00, 1064.00it/s]Calculating AKI Stages:  95%|█████████▍| 3283/3462 [00:03<00:00, 1075.64it/s]Calculating AKI Stages:  98%|█████████▊| 3393/3462 [00:03<00:00, 1079.95it/s]Calculating AKI Stages: 100%|██████████| 3462/3462 [00:03<00:00, 1050.94it/s]

AKI Labeling Complete.
Distribution of AKI Stages:
aki_stage
0    3290
1     128
2      23
3      21
Name: count, dtype: int64

Distribution of AKI Binary (Stage >= 1):
aki_label
0    3290
1     172
Name: count, dtype: int64

Distribution of Severe AKI (Stage >= 2):
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Your final cohort after all custom filters has 3462 cases.
      caseid  subjectid  casestart  ...  aki_stage  aki_label  y_severe_aki
3593    3594          1          0  ...          0          0             0
6197    6198          3          0  ...          0          0             0
3416    3417          4          0  ...          0          0             0
733      734          5          0  ...          0          0             0
1579    1580          6          0  ...          0          0             0

[5 rows x 77 columns]

--- Deriving Additional Outcomes ---
Mapping 'icu_days' to 'los_icu'...
Calculating 'los_postop' from 'dis' and 'opend'...
In-hospital mortality (y_inhosp_mortality) counts:
y_inhosp_mortality
0    3435
1      27
Name: count, dtype: Int64
ICU admission (y_icu_admit) counts:
y_icu_admit
0    2669
1     793
Name: count, dtype: Int64
Prolonged LOS Threshold (75th percentile): 7.57 days
Prolonged LOS (y_prolonged_los_postop) counts:
y_prolonged_los_postop
0    2596
1     866
Name: count, dtype: Int64
Severe AKI (y_severe_aki) counts:
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Final cohort saved to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:27:56,514 - INFO - Starting catch22 feature extraction...
2026-01-03 23:27:56,514 - INFO - Mode 'full': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors.csv
2026-01-03 23:27:56,514 - INFO - Mode 'windowed': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_windowed.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors_windowed.csv
2026-01-03 23:27:56,548 - INFO - Loaded 3462 cases from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:27:56,596 - INFO - Mode 'full': Found 13715 previously processed pairs.
2026-01-03 23:27:56,773 - INFO - Mode 'windowed': Found 13715 previously processed pairs.
2026-01-03 23:27:56,867 - INFO - 133 pairs to process.
2026-01-03 23:27:56,867 - INFO - Using 30 worker processes.
Extracting Features:   0%|          | 0/133 [00:00<?, ?it/s]Extracting Features:   1%|          | 1/133 [00:02<06:12,  2.83s/it]Extracting Features:   2%|▏         | 3/133 [00:02<01:40,  1.29it/s]Extracting Features:   4%|▍         | 5/133 [00:03<00:55,  2.31it/s]Extracting Features:   5%|▌         | 7/133 [00:03<00:34,  3.69it/s]Extracting Features:   8%|▊         | 11/133 [00:03<00:17,  6.90it/s]Extracting Features:  10%|▉         | 13/133 [00:03<00:17,  6.98it/s]Extracting Features:  11%|█▏        | 15/133 [00:03<00:14,  8.32it/s]Extracting Features:  14%|█▎        | 18/133 [00:03<00:10, 10.76it/s]Extracting Features:  16%|█▌        | 21/133 [00:04<00:08, 13.89it/s]Extracting Features:  18%|█▊        | 24/133 [00:04<00:08, 12.36it/s]Extracting Features:  20%|█▉        | 26/133 [00:04<00:09, 10.92it/s]Extracting Features:  21%|██        | 28/133 [00:04<00:09, 11.38it/s]Extracting Features:  24%|██▍       | 32/133 [00:04<00:06, 14.72it/s]Extracting Features:  26%|██▌       | 34/133 [00:05<00:08, 12.18it/s]Extracting Features:  27%|██▋       | 36/133 [00:05<00:07, 12.85it/s]Extracting Features:  30%|███       | 40/133 [00:05<00:06, 13.99it/s]Extracting Features:  34%|███▍      | 45/133 [00:05<00:04, 18.64it/s]Extracting Features:  36%|███▌      | 48/133 [00:06<00:05, 14.56it/s]Extracting Features:  38%|███▊      | 50/133 [00:06<00:06, 13.19it/s]Extracting Features:  39%|███▉      | 52/133 [00:06<00:06, 13.13it/s]Extracting Features:  41%|████      | 54/133 [00:06<00:07, 10.37it/s]Extracting Features:  42%|████▏     | 56/133 [00:06<00:07,  9.74it/s]Extracting Features:  45%|████▌     | 60/133 [00:07<00:05, 12.55it/s]Extracting Features:  47%|████▋     | 62/133 [00:07<00:05, 13.70it/s]Extracting Features:  49%|████▉     | 65/133 [00:07<00:04, 16.11it/s]Extracting Features:  50%|█████     | 67/133 [00:07<00:05, 12.65it/s]Extracting Features:  52%|█████▏    | 69/133 [00:07<00:05, 12.53it/s]Extracting Features:  53%|█████▎    | 71/133 [00:08<00:05, 11.41it/s]Extracting Features:  56%|█████▋    | 75/133 [00:08<00:03, 15.38it/s]Extracting Features:  59%|█████▊    | 78/133 [00:08<00:03, 15.07it/s]Extracting Features:  62%|██████▏   | 82/133 [00:08<00:02, 18.90it/s]Extracting Features:  64%|██████▍   | 85/133 [00:08<00:02, 20.34it/s]Extracting Features:  66%|██████▌   | 88/133 [00:08<00:03, 14.17it/s]Extracting Features:  68%|██████▊   | 91/133 [00:09<00:02, 14.67it/s]Extracting Features:  70%|██████▉   | 93/133 [00:09<00:03, 11.32it/s]Extracting Features:  73%|███████▎  | 97/133 [00:09<00:02, 15.52it/s]Extracting Features:  75%|███████▌  | 100/133 [00:09<00:02, 14.72it/s]Extracting Features:  77%|███████▋  | 102/133 [00:10<00:02, 13.03it/s]Extracting Features:  78%|███████▊  | 104/133 [00:10<00:03,  8.72it/s]Extracting Features:  80%|███████▉  | 106/133 [00:10<00:02,  9.44it/s]Extracting Features:  81%|████████  | 108/133 [00:10<00:02,  8.92it/s]Extracting Features:  83%|████████▎ | 110/133 [00:11<00:02,  8.80it/s]Extracting Features:  85%|████████▍ | 113/133 [00:11<00:01, 11.54it/s]Extracting Features:  88%|████████▊ | 117/133 [00:11<00:01, 15.34it/s]Extracting Features:  89%|████████▉ | 119/133 [00:11<00:01, 11.43it/s]Extracting Features:  92%|█████████▏| 123/133 [00:11<00:00, 15.13it/s]Extracting Features:  94%|█████████▍| 125/133 [00:12<00:00, 10.83it/s]Extracting Features:  95%|█████████▌| 127/133 [00:12<00:00,  9.11it/s]Extracting Features:  98%|█████████▊| 130/133 [00:12<00:00,  9.23it/s]Extracting Features: 100%|██████████| 133/133 [00:13<00:00, 10.28it/s]Extracting Features: 100%|██████████| 133/133 [00:13<00:00, 10.12it/s]
2026-01-03 23:28:10,356 - INFO - [full] Saved 133 errors.
2026-01-03 23:28:10,357 - INFO - [full] No new features to save.
2026-01-03 23:28:10,360 - INFO - [windowed] Saved 133 errors.
2026-01-03 23:28:10,360 - INFO - [windowed] No new features to save.
2026-01-03 23:28:10,360 - INFO - Processing complete.
--- Step 03: Preoperative Data Preparation ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
Output: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv
Loaded cohort data. Shape: (3462, 84)
Merging preop labs from lab_data.csv. Shape: (2641, 4)
Performing stratified train/test split (80/20)...
Train set: 2769, Test set: 693
Processing categorical variables...
Applying one-hot encoding...
Handling outliers...
Leaving missing values as NaN (no imputation)
Saving processed data to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv...
Done.
--- Step 04: Intraoperative Data Preparation ---

--- Processing Full Features Waveform Data ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf.csv
Loaded data. Shape: (13715, 27)
Pivoting to wide format...
Pivot complete. Shape before flattening: (3453, 96)
Flattening column names...
Column names flattened. Shape: (3453, 98)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide.csv...
Done with Full Features.

--- Processing Windowed Features Waveform Data ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_windowed.csv
Loaded data. Shape: (13715, 99)
Pivoting to wide format...
Pivot complete. Shape before flattening: (3453, 384)
Flattening column names...
Column names flattened. Shape: (3453, 386)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide_windowed.csv...
Done with Windowed Features.
--- Step 05: Data Merge ---
Loading Preop Data from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv...
Preop Data Shape: (3462, 84)

--- Merging Full Features Data ---
Intraop Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide.csv
Loaded intraop data. Shape: (3453, 98)
Merging with preoperative data...
WARNING: Merge introduced 28758 NaN values.
Leaving NaNs in merged output (imputation disabled).
WARNING: 14 rows have missing 'split_group'.
Dropping rows with missing split_group/preop data...
Final merged shape: (3439, 180)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
Done with Full Features.

--- Merging Windowed Features Data ---
Intraop Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide_windowed.csv
Loaded intraop data. Shape: (3453, 386)
Merging with preoperative data...
WARNING: Merge introduced 35742 NaN values.
Leaving NaNs in merged output (imputation disabled).
WARNING: 14 rows have missing 'split_group'.
Dropping rows with missing split_group/preop data...
Final merged shape: (3439, 468)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
Done with Windowed Features.
----------------------------------------------------------------
Running: Model=xgboost | Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO for model_type=xgboost...
2026-01-03 23:28:17,156 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only, Model: xgboost
2026-01-03 23:28:17,157 - INFO - Loading data from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2026-01-03 23:28:17,243 - INFO - Data loaded. Shape: (3439, 180)
2026-01-03 23:28:17,249 - INFO - Using existing 'split_group' column for train/test split.
2026-01-03 23:28:17,251 - INFO - Data prepared. Train shape: (2752, 77), Test shape: (687, 77)
2026-01-03 23:28:17,251 - INFO - Positive samples in train: 137, Negative: 2615, Scale Pos Weight: 19.0876
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.290849:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.290849:   1%|          | 1/100 [00:01<02:17,  1.39s/it]Best trial: 1. Best value: 0.298026:   1%|          | 1/100 [00:02<02:17,  1.39s/it]Best trial: 1. Best value: 0.298026:   2%|▏         | 2/100 [00:02<02:13,  1.36s/it]Best trial: 2. Best value: 0.330551:   2%|▏         | 2/100 [00:04<02:13,  1.36s/it]Best trial: 2. Best value: 0.330551:   3%|▎         | 3/100 [00:04<02:26,  1.51s/it]Best trial: 2. Best value: 0.330551:   3%|▎         | 3/100 [00:05<02:26,  1.51s/it]Best trial: 2. Best value: 0.330551:   4%|▍         | 4/100 [00:05<02:13,  1.39s/it]Best trial: 2. Best value: 0.330551:   4%|▍         | 4/100 [00:08<02:13,  1.39s/it]Best trial: 2. Best value: 0.330551:   5%|▌         | 5/100 [00:08<03:00,  1.90s/it]Best trial: 2. Best value: 0.330551:   5%|▌         | 5/100 [00:10<03:00,  1.90s/it]Best trial: 2. Best value: 0.330551:   6%|▌         | 6/100 [00:10<02:58,  1.90s/it]Best trial: 2. Best value: 0.330551:   6%|▌         | 6/100 [00:11<02:58,  1.90s/it]Best trial: 2. Best value: 0.330551:   7%|▋         | 7/100 [00:11<02:44,  1.77s/it]  > HPO FAILED for model_type=xgboost. Skipping training.
----------------------------------------------------------------
Running: Model=xgboost | Outcome=any_aki | Branch=non_windowed | FeatureSet=pleth_only
----------------------------------------------------------------
  > Starting HPO for model_type=xgboost...
2026-01-03 23:28:30,606 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: pleth_only, Model: xgboost
2026-01-03 23:28:30,606 - INFO - Loading data from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2026-01-03 23:28:30,701 - INFO - Data loaded. Shape: (3439, 180)
2026-01-03 23:28:30,705 - INFO - Using existing 'split_group' column for train/test split.
2026-01-03 23:28:30,707 - INFO - Data prepared. Train shape: (2752, 24), Test shape: (687, 24)
2026-01-03 23:28:30,707 - INFO - Positive samples in train: 137, Negative: 2615, Scale Pos Weight: 19.0876
  0%|          | 0/100 [00:00<?, ?it/s]  > HPO FAILED for model_type=xgboost. Skipping training.
----------------------------------------------------------------
Running: Model=xgboost | Outcome=any_aki | Branch=non_windowed | FeatureSet=ecg_only
----------------------------------------------------------------
  > Starting HPO for model_type=xgboost...
Starting Experiments...
Prep mode: force | Models: xgboost | Results dir: /home/exouser/js2-volume/projects/aki_prediction_project/results
--- Running data preparation (steps 01–05) ---
Total cases in VitalDB: 6388
All department cases: 6388
Cases after removing missing essential data: 6016

Initial Cohort DataFrame Head:
   caseid  subjectid  casestart  ...  intraop_phe  intraop_epi  intraop_ca
0       1       5955          0  ...            0            0           0
1       2       2487          0  ...            0            0           0
2       3       2861          0  ...            0            0           0
3       4       1903          0  ...            0            0           0
4       5       4416          0  ...          900            0        2100

[5 rows x 74 columns]
Missing value percentages for preoperative variables (>0%):
cline2                 99.069149
aline2                 98.420878
lmasize                98.337766
preop_be               91.356383
preop_sao2             91.339761
preop_hco3             91.339761
preop_pao2             91.256649
preop_paco2            91.256649
preop_ph               91.123670
dltubesize             86.768617
iv2                    77.892287
cline1                 76.861702
aline1                 46.841755
intraop_uo             42.021277
intraop_ebl            37.333777
tubesize               21.725399
cormack                12.998670
airway                  6.399601
intraop_crystalloid     6.183511
preop_na                4.421543
preop_k                 4.388298
position                3.075133
preop_aptt              1.579122
preop_pt                1.363032
iv1                     1.146941
preop_gluc              0.631649
preop_plt               0.548537
preop_hb                0.349069
preop_ast               0.249335
preop_alt               0.216090
preop_alb               0.116356
preop_bun               0.099734
dtype: float64
Using vitaldb.find_cases() to find all cases with the '['SNUADC/PLETH', 'SNUADC/ECG_II', 'Primus/CO2', 'Primus/AWP']' waveforms...
Total cases in VitalDB with 'SNUADC/PLETH' or substitute 'None': 6157
Found 5802 cases with 'SNUADC/PLETH' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.44%
Total cases in VitalDB with 'SNUADC/ECG_II' or substitute '['SNUADC/ECG_V5']': 6355
Found 5801 cases with 'SNUADC/ECG_II' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.43%
Total cases in VitalDB with 'Primus/CO2' or substitute 'None': 6362
Found 5778 cases with 'Primus/CO2' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.04%
Total cases in VitalDB with 'Primus/AWP' or substitute 'None': 6360
Found 5776 cases with 'Primus/AWP' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.01%

Your final cohort with available waveform data now has 5776 cases.
Cases after excluding severe kidney disease: 5584
Cohort size after ensuring sample independence: 5343

Filtering cohort to include only patients with postoperative creatinine labs...
Final study cohort size after excluding patients without post-op labs: 3462
Loading lab data...
Lab data loaded and filtered for creatinine.
Calculating AKI Stages:   0%|          | 0/3462 [00:00<?, ?it/s]Calculating AKI Stages:   3%|▎         | 98/3462 [00:00<00:03, 975.68it/s]Calculating AKI Stages:   6%|▌         | 200/3462 [00:00<00:03, 998.02it/s]Calculating AKI Stages:   9%|▉         | 306/3462 [00:00<00:03, 1022.53it/s]Calculating AKI Stages:  12%|█▏        | 413/3462 [00:00<00:02, 1038.37it/s]Calculating AKI Stages:  15%|█▍        | 519/3462 [00:00<00:02, 1044.91it/s]Calculating AKI Stages:  18%|█▊        | 627/3462 [00:00<00:02, 1054.90it/s]Calculating AKI Stages:  21%|██        | 734/3462 [00:00<00:02, 1059.49it/s]Calculating AKI Stages:  24%|██▍       | 841/3462 [00:00<00:02, 1061.52it/s]Calculating AKI Stages:  27%|██▋       | 948/3462 [00:00<00:02, 1062.66it/s]Calculating AKI Stages:  30%|███       | 1055/3462 [00:01<00:02, 1061.19it/s]Calculating AKI Stages:  34%|███▎      | 1162/3462 [00:01<00:02, 1063.25it/s]Calculating AKI Stages:  37%|███▋      | 1271/3462 [00:01<00:02, 1068.97it/s]Calculating AKI Stages:  40%|███▉      | 1378/3462 [00:01<00:01, 1068.48it/s]Calculating AKI Stages:  43%|████▎     | 1485/3462 [00:01<00:01, 1068.05it/s]Calculating AKI Stages:  46%|████▌     | 1592/3462 [00:01<00:01, 1067.21it/s]Calculating AKI Stages:  49%|████▉     | 1700/3462 [00:01<00:01, 1068.98it/s]Calculating AKI Stages:  52%|█████▏    | 1808/3462 [00:01<00:01, 1070.77it/s]Calculating AKI Stages:  55%|█████▌    | 1916/3462 [00:01<00:01, 1073.26it/s]Calculating AKI Stages:  58%|█████▊    | 2024/3462 [00:01<00:01, 1073.50it/s]Calculating AKI Stages:  62%|██████▏   | 2132/3462 [00:02<00:01, 1072.43it/s]Calculating AKI Stages:  65%|██████▍   | 2240/3462 [00:02<00:01, 1071.00it/s]Calculating AKI Stages:  68%|██████▊   | 2348/3462 [00:02<00:01, 1069.93it/s]Calculating AKI Stages:  71%|███████   | 2456/3462 [00:02<00:00, 1071.11it/s]Calculating AKI Stages:  74%|███████▍  | 2564/3462 [00:02<00:00, 1070.20it/s]Calculating AKI Stages:  77%|███████▋  | 2672/3462 [00:02<00:00, 1067.57it/s]Calculating AKI Stages:  80%|████████  | 2780/3462 [00:02<00:00, 1069.58it/s]Calculating AKI Stages:  83%|████████▎ | 2887/3462 [00:02<00:00, 1068.97it/s]Calculating AKI Stages:  87%|████████▋ | 2995/3462 [00:02<00:00, 1069.74it/s]Calculating AKI Stages:  90%|████████▉ | 3103/3462 [00:02<00:00, 1070.35it/s]Calculating AKI Stages:  93%|█████████▎| 3211/3462 [00:03<00:00, 1069.60it/s]Calculating AKI Stages:  96%|█████████▌| 3318/3462 [00:03<00:00, 1069.68it/s]Calculating AKI Stages:  99%|█████████▉| 3425/3462 [00:03<00:00, 1069.37it/s]Calculating AKI Stages: 100%|██████████| 3462/3462 [00:03<00:00, 1062.61it/s]

AKI Labeling Complete.
Distribution of AKI Stages:
aki_stage
0    3290
1     128
2      23
3      21
Name: count, dtype: int64

Distribution of AKI Binary (Stage >= 1):
aki_label
0    3290
1     172
Name: count, dtype: int64

Distribution of Severe AKI (Stage >= 2):
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Your final cohort after all custom filters has 3462 cases.
      caseid  subjectid  casestart  ...  aki_stage  aki_label  y_severe_aki
3593    3594          1          0  ...          0          0             0
6197    6198          3          0  ...          0          0             0
3416    3417          4          0  ...          0          0             0
733      734          5          0  ...          0          0             0
1579    1580          6          0  ...          0          0             0

[5 rows x 77 columns]

--- Deriving Additional Outcomes ---
Mapping 'icu_days' to 'los_icu'...
Calculating 'los_postop' from 'dis' and 'opend'...
In-hospital mortality (y_inhosp_mortality) counts:
y_inhosp_mortality
0    3435
1      27
Name: count, dtype: Int64
ICU admission (y_icu_admit) counts:
y_icu_admit
0    2669
1     793
Name: count, dtype: Int64
Prolonged LOS Threshold (75th percentile): 7.57 days
Prolonged LOS (y_prolonged_los_postop) counts:
y_prolonged_los_postop
0    2596
1     866
Name: count, dtype: Int64
Severe AKI (y_severe_aki) counts:
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Final cohort saved to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:29:19,868 - INFO - Starting catch22 feature extraction...
2026-01-03 23:29:19,868 - INFO - Mode 'full': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors.csv
2026-01-03 23:29:19,868 - INFO - Mode 'windowed': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_windowed.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors_windowed.csv
2026-01-03 23:29:19,901 - INFO - Loaded 3462 cases from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:29:19,939 - INFO - Mode 'full': Found 13715 previously processed pairs.
2026-01-03 23:29:20,092 - INFO - Mode 'windowed': Found 13715 previously processed pairs.
2026-01-03 23:29:20,190 - INFO - 133 pairs to process.
2026-01-03 23:29:20,190 - INFO - Using 30 worker processes.
Extracting Features:   0%|          | 0/133 [00:00<?, ?it/s]Extracting Features:   1%|          | 1/133 [00:01<04:14,  1.93s/it]Extracting Features:   2%|▏         | 2/133 [00:02<01:53,  1.15it/s]Extracting Features:   2%|▏         | 3/133 [00:02<01:08,  1.90it/s]Extracting Features:   3%|▎         | 4/133 [00:02<00:47,  2.72it/s]Extracting Features:   5%|▍         | 6/133 [00:02<00:26,  4.87it/s]Extracting Features:   6%|▌         | 8/133 [00:02<00:17,  7.21it/s]Extracting Features:  10%|▉         | 13/133 [00:02<00:08, 14.19it/s]Extracting Features:  16%|█▌        | 21/133 [00:02<00:04, 24.66it/s]Extracting Features:  19%|█▉        | 25/133 [00:03<00:04, 22.18it/s]Extracting Features:  22%|██▏       | 29/133 [00:03<00:04, 24.45it/s]Extracting Features:  24%|██▍       | 32/133 [00:03<00:04, 24.71it/s]Extracting Features:  26%|██▋       | 35/133 [00:03<00:05, 16.91it/s]Extracting Features:  29%|██▊       | 38/133 [00:03<00:07, 13.01it/s]Extracting Features:  32%|███▏      | 42/133 [00:04<00:06, 14.48it/s]Extracting Features:  33%|███▎      | 44/133 [00:04<00:08, 10.58it/s]Extracting Features:  35%|███▌      | 47/133 [00:04<00:06, 12.46it/s]Extracting Features:  38%|███▊      | 50/133 [00:04<00:05, 14.39it/s]Extracting Features:  39%|███▉      | 52/133 [00:05<00:06, 13.15it/s]Extracting Features:  41%|████▏     | 55/133 [00:05<00:05, 15.26it/s]Extracting Features:  44%|████▎     | 58/133 [00:05<00:04, 17.56it/s]Extracting Features:  47%|████▋     | 62/133 [00:05<00:03, 20.09it/s]Extracting Features:  49%|████▉     | 65/133 [00:05<00:03, 19.69it/s]Extracting Features:  55%|█████▍    | 73/133 [00:05<00:01, 30.40it/s]Extracting Features:  58%|█████▊    | 77/133 [00:05<00:01, 31.40it/s]Extracting Features:  62%|██████▏   | 82/133 [00:05<00:01, 34.08it/s]Extracting Features:  65%|██████▍   | 86/133 [00:06<00:01, 33.22it/s]Extracting Features:  68%|██████▊   | 90/133 [00:06<00:01, 30.06it/s]Extracting Features:  71%|███████   | 94/133 [00:06<00:01, 28.44it/s]Extracting Features:  73%|███████▎  | 97/133 [00:06<00:01, 26.78it/s]Extracting Features:  75%|███████▌  | 100/133 [00:06<00:01, 22.02it/s]Extracting Features:  77%|███████▋  | 103/133 [00:06<00:01, 20.66it/s]Extracting Features:  82%|████████▏ | 109/133 [00:07<00:01, 22.41it/s]Extracting Features:  84%|████████▍ | 112/133 [00:07<00:01, 18.82it/s]Extracting Features:  86%|████████▋ | 115/133 [00:07<00:00, 19.78it/s]Extracting Features:  89%|████████▊ | 118/133 [00:07<00:00, 15.94it/s]Extracting Features:  90%|█████████ | 120/133 [00:07<00:00, 15.81it/s]Extracting Features:  92%|█████████▏| 123/133 [00:08<00:00, 16.98it/s]Extracting Features:  94%|█████████▍| 125/133 [00:08<00:00, 17.25it/s]Extracting Features:  97%|█████████▋| 129/133 [00:08<00:00, 19.36it/s]Extracting Features:  99%|█████████▉| 132/133 [00:08<00:00, 19.12it/s]Extracting Features: 100%|██████████| 133/133 [00:08<00:00, 15.46it/s]
2026-01-03 23:29:29,141 - INFO - [full] Saved 133 errors.
2026-01-03 23:29:29,141 - INFO - [full] No new features to save.
2026-01-03 23:29:29,143 - INFO - [windowed] Saved 133 errors.
2026-01-03 23:29:29,143 - INFO - [windowed] No new features to save.
2026-01-03 23:29:29,144 - INFO - Processing complete.
--- Step 03: Preoperative Data Preparation ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
Output: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv
Loaded cohort data. Shape: (3462, 84)
Merging preop labs from lab_data.csv. Shape: (2641, 4)
Performing stratified train/test split (80/20)...
Train set: 2769, Test set: 693
Processing categorical variables...
Applying one-hot encoding...
Handling outliers...
Leaving missing values as NaN (no imputation)
Saving processed data to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv...
Done.
--- Step 04: Intraoperative Data Preparation ---

--- Processing Full Features Waveform Data ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf.csv
Loaded data. Shape: (13715, 27)
Pivoting to wide format...
Pivot complete. Shape before flattening: (3453, 96)
Flattening column names...
Column names flattened. Shape: (3453, 98)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide.csv...
Done with Full Features.

--- Processing Windowed Features Waveform Data ---
Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_windowed.csv
Loaded data. Shape: (13715, 99)
Pivoting to wide format...
Pivot complete. Shape before flattening: (3453, 384)
Flattening column names...
Column names flattened. Shape: (3453, 386)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide_windowed.csv...
Done with Windowed Features.
--- Step 05: Data Merge ---
Loading Preop Data from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_preop_processed.csv...
Preop Data Shape: (3462, 84)

--- Merging Full Features Data ---
Intraop Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide.csv
Loaded intraop data. Shape: (3453, 98)
Merging with preoperative data...
WARNING: Merge introduced 28758 NaN values.
Leaving NaNs in merged output (imputation disabled).
WARNING: 14 rows have missing 'split_group'.
Dropping rows with missing split_group/preop data...
Final merged shape: (3439, 180)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
Done with Full Features.

--- Merging Windowed Features Data ---
Intraop Input: /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_intraop_wide_windowed.csv
Loaded intraop data. Shape: (3453, 386)
Merging with preoperative data...
WARNING: Merge introduced 35742 NaN values.
Leaving NaNs in merged output (imputation disabled).
WARNING: 14 rows have missing 'split_group'.
Dropping rows with missing split_group/preop data...
Final merged shape: (3439, 468)
Saving to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide_windowed.csv...
Done with Windowed Features.
----------------------------------------------------------------
Running: Model=xgboost | Outcome=any_aki | Branch=non_windowed | FeatureSet=preop_only
----------------------------------------------------------------
  > Starting HPO for model_type=xgboost...
2026-01-03 23:29:35,855 - INFO - Starting HPO for Outcome: any_aki, Branch: non_windowed, Feature Set: preop_only, Model: xgboost
2026-01-03 23:29:35,855 - INFO - Loading data from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_features_master_wide.csv...
2026-01-03 23:29:35,939 - INFO - Data loaded. Shape: (3439, 180)
2026-01-03 23:29:35,944 - INFO - Using existing 'split_group' column for train/test split.
2026-01-03 23:29:35,946 - INFO - Data prepared. Train shape: (2752, 77), Test shape: (687, 77)
2026-01-03 23:29:35,946 - INFO - Positive samples in train: 137, Negative: 2615, Scale Pos Weight: 19.0876
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.307359:   0%|          | 0/100 [00:01<?, ?it/s]Best trial: 0. Best value: 0.307359:   1%|          | 1/100 [00:01<02:21,  1.43s/it]Best trial: 1. Best value: 0.30786:   1%|          | 1/100 [00:03<02:21,  1.43s/it] Best trial: 1. Best value: 0.30786:   2%|▏         | 2/100 [00:03<03:19,  2.03s/it]Best trial: 2. Best value: 0.350068:   2%|▏         | 2/100 [00:06<03:19,  2.03s/it]Best trial: 2. Best value: 0.350068:   3%|▎         | 3/100 [00:06<03:42,  2.30s/it]Best trial: 3. Best value: 0.374778:   3%|▎         | 3/100 [00:08<03:42,  2.30s/it]Best trial: 3. Best value: 0.374778:   4%|▍         | 4/100 [00:08<03:24,  2.13s/it]Best trial: 3. Best value: 0.374778:   4%|▍         | 4/100 [00:11<03:24,  2.13s/it]Best trial: 3. Best value: 0.374778:   5%|▌         | 5/100 [00:11<04:11,  2.65s/it]Best trial: 3. Best value: 0.374778:   5%|▌         | 5/100 [00:13<04:11,  2.65s/it]Best trial: 3. Best value: 0.374778:   6%|▌         | 6/100 [00:13<03:30,  2.23s/it]Best trial: 3. Best value: 0.374778:   6%|▌         | 6/100 [00:15<03:30,  2.23s/it]Best trial: 3. Best value: 0.374778:   7%|▋         | 7/100 [00:15<03:33,  2.29s/it]Best trial: 3. Best value: 0.374778:   7%|▋         | 7/100 [00:17<03:33,  2.29s/it]Best trial: 3. Best value: 0.374778:   8%|▊         | 8/100 [00:17<03:03,  1.99s/it]Best trial: 8. Best value: 0.377745:   8%|▊         | 8/100 [00:22<03:03,  1.99s/it]Best trial: 8. Best value: 0.377745:   9%|▉         | 9/100 [00:22<04:31,  2.98s/it]Best trial: 8. Best value: 0.377745:   9%|▉         | 9/100 [00:23<04:31,  2.98s/it]Best trial: 8. Best value: 0.377745:  10%|█         | 10/100 [00:23<03:46,  2.52s/it]Best trial: 8. Best value: 0.377745:  10%|█         | 10/100 [00:24<03:46,  2.52s/it]Best trial: 8. Best value: 0.377745:  11%|█         | 11/100 [00:24<03:07,  2.10s/it]Best trial: 11. Best value: 0.392114:  11%|█         | 11/100 [00:27<03:07,  2.10s/it]Best trial: 11. Best value: 0.392114:  12%|█▏        | 12/100 [00:27<03:08,  2.14s/it]Best trial: 11. Best value: 0.392114:  12%|█▏        | 12/100 [00:28<03:08,  2.14s/it]Best trial: 11. Best value: 0.392114:  13%|█▎        | 13/100 [00:28<02:37,  1.81s/it]Best trial: 11. Best value: 0.392114:  13%|█▎        | 13/100 [00:30<02:37,  1.81s/it]Best trial: 11. Best value: 0.392114:  14%|█▍        | 14/100 [00:30<02:51,  1.99s/it]Best trial: 11. Best value: 0.392114:  14%|█▍        | 14/100 [00:32<02:51,  1.99s/it]Best trial: 11. Best value: 0.392114:  15%|█▌        | 15/100 [00:32<02:49,  1.99s/it]Best trial: 11. Best value: 0.392114:  15%|█▌        | 15/100 [00:35<02:49,  1.99s/it]Best trial: 11. Best value: 0.392114:  16%|█▌        | 16/100 [00:35<03:02,  2.17s/it]Best trial: 11. Best value: 0.392114:  16%|█▌        | 16/100 [00:37<03:02,  2.17s/it]Best trial: 11. Best value: 0.392114:  17%|█▋        | 17/100 [00:37<03:03,  2.21s/it]Best trial: 11. Best value: 0.392114:  17%|█▋        | 17/100 [00:39<03:03,  2.21s/it]Best trial: 11. Best value: 0.392114:  18%|█▊        | 18/100 [00:39<02:47,  2.04s/it]Best trial: 11. Best value: 0.392114:  18%|█▊        | 18/100 [00:41<02:47,  2.04s/it]Best trial: 11. Best value: 0.392114:  19%|█▉        | 19/100 [00:41<02:42,  2.01s/it]Best trial: 19. Best value: 0.396192:  19%|█▉        | 19/100 [00:44<02:42,  2.01s/it]Best trial: 19. Best value: 0.396192:  20%|██        | 20/100 [00:44<03:20,  2.50s/it]Best trial: 19. Best value: 0.396192:  20%|██        | 20/100 [00:47<03:20,  2.50s/it]Best trial: 19. Best value: 0.396192:  21%|██        | 21/100 [00:47<03:19,  2.52s/it]Best trial: 19. Best value: 0.396192:  21%|██        | 21/100 [00:50<03:19,  2.52s/it]Best trial: 19. Best value: 0.396192:  22%|██▏       | 22/100 [00:50<03:29,  2.68s/it]Best trial: 19. Best value: 0.396192:  22%|██▏       | 22/100 [00:53<03:29,  2.68s/it]Best trial: 19. Best value: 0.396192:  23%|██▎       | 23/100 [00:53<03:26,  2.68s/it]Best trial: 19. Best value: 0.396192:  23%|██▎       | 23/100 [00:55<03:26,  2.68s/it]Best trial: 19. Best value: 0.396192:  24%|██▍       | 24/100 [00:55<03:17,  2.60s/it]Best trial: 19. Best value: 0.396192:  24%|██▍       | 24/100 [00:59<03:17,  2.60s/it]Best trial: 19. Best value: 0.396192:  25%|██▌       | 25/100 [00:59<03:43,  2.98s/it]Best trial: 19. Best value: 0.396192:  25%|██▌       | 25/100 [01:02<03:43,  2.98s/it]Best trial: 19. Best value: 0.396192:  26%|██▌       | 26/100 [01:02<03:36,  2.92s/it]Best trial: 19. Best value: 0.396192:  26%|██▌       | 26/100 [01:05<03:36,  2.92s/it]Best trial: 19. Best value: 0.396192:  27%|██▋       | 27/100 [01:05<03:44,  3.07s/it]Best trial: 19. Best value: 0.396192:  27%|██▋       | 27/100 [01:08<03:44,  3.07s/it]Best trial: 19. Best value: 0.396192:  28%|██▊       | 28/100 [01:08<03:30,  2.93s/it]Best trial: 19. Best value: 0.396192:  28%|██▊       | 28/100 [01:10<03:30,  2.93s/it]Best trial: 19. Best value: 0.396192:  29%|██▉       | 29/100 [01:10<03:11,  2.69s/it]Starting Experiments...
Prep mode: force | Models: xgboost | Results dir: /home/exouser/js2-volume/projects/aki_prediction_project/results
--- Running data preparation (steps 01–05) ---
Forcing rebuild: removing existing processed directory at /home/exouser/js2-volume/projects/aki_prediction_project/data/processed
Total cases in VitalDB: 6388
All department cases: 6388
Cases after removing missing essential data: 6016

Initial Cohort DataFrame Head:
   caseid  subjectid  casestart  ...  intraop_phe  intraop_epi  intraop_ca
0       1       5955          0  ...            0            0           0
1       2       2487          0  ...            0            0           0
2       3       2861          0  ...            0            0           0
3       4       1903          0  ...            0            0           0
4       5       4416          0  ...          900            0        2100

[5 rows x 74 columns]
Missing value percentages for preoperative variables (>0%):
cline2                 99.069149
aline2                 98.420878
lmasize                98.337766
preop_be               91.356383
preop_sao2             91.339761
preop_hco3             91.339761
preop_pao2             91.256649
preop_paco2            91.256649
preop_ph               91.123670
dltubesize             86.768617
iv2                    77.892287
cline1                 76.861702
aline1                 46.841755
intraop_uo             42.021277
intraop_ebl            37.333777
tubesize               21.725399
cormack                12.998670
airway                  6.399601
intraop_crystalloid     6.183511
preop_na                4.421543
preop_k                 4.388298
position                3.075133
preop_aptt              1.579122
preop_pt                1.363032
iv1                     1.146941
preop_gluc              0.631649
preop_plt               0.548537
preop_hb                0.349069
preop_ast               0.249335
preop_alt               0.216090
preop_alb               0.116356
preop_bun               0.099734
dtype: float64
Using vitaldb.find_cases() to find all cases with the '['SNUADC/PLETH', 'SNUADC/ECG_II', 'Primus/CO2', 'Primus/AWP']' waveforms...
Total cases in VitalDB with 'SNUADC/PLETH' or substitute 'None': 6157
Found 5802 cases with 'SNUADC/PLETH' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.44%
Total cases in VitalDB with 'SNUADC/ECG_II' or substitute '['SNUADC/ECG_V5']': 6355
Found 5801 cases with 'SNUADC/ECG_II' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.43%
Total cases in VitalDB with 'Primus/CO2' or substitute 'None': 6362
Found 5778 cases with 'Primus/CO2' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.04%
Total cases in VitalDB with 'Primus/AWP' or substitute 'None': 6360
Found 5776 cases with 'Primus/AWP' out of 6016 cases left in your cohort.
Waveform Availability in Cohort: 96.01%

Your final cohort with available waveform data now has 5776 cases.
Cases after excluding severe kidney disease: 5584
Cohort size after ensuring sample independence: 5343

Filtering cohort to include only patients with postoperative creatinine labs...
Final study cohort size after excluding patients without post-op labs: 3462
Loading lab data...
Lab data loaded and filtered for creatinine.
Calculating AKI Stages:   0%|          | 0/3462 [00:00<?, ?it/s]Calculating AKI Stages:   3%|▎         | 96/3462 [00:00<00:03, 956.54it/s]Calculating AKI Stages:   6%|▌         | 199/3462 [00:00<00:03, 996.97it/s]Calculating AKI Stages:   9%|▉         | 305/3462 [00:00<00:03, 1022.24it/s]Calculating AKI Stages:  12%|█▏        | 412/3462 [00:00<00:02, 1039.66it/s]Calculating AKI Stages:  15%|█▍        | 518/3462 [00:00<00:02, 1046.05it/s]Calculating AKI Stages:  18%|█▊        | 623/3462 [00:00<00:02, 1047.36it/s]Calculating AKI Stages:  21%|██        | 730/3462 [00:00<00:02, 1052.85it/s]Calculating AKI Stages:  24%|██▍       | 836/3462 [00:00<00:02, 1054.49it/s]Calculating AKI Stages:  27%|██▋       | 943/3462 [00:00<00:02, 1058.52it/s]Calculating AKI Stages:  30%|███       | 1050/3462 [00:01<00:02, 1059.91it/s]Calculating AKI Stages:  33%|███▎      | 1156/3462 [00:01<00:02, 1055.44it/s]Calculating AKI Stages:  37%|███▋      | 1264/3462 [00:01<00:02, 1062.24it/s]Calculating AKI Stages:  40%|███▉      | 1372/3462 [00:01<00:01, 1065.88it/s]Calculating AKI Stages:  43%|████▎     | 1479/3462 [00:01<00:01, 1065.02it/s]Calculating AKI Stages:  46%|████▌     | 1586/3462 [00:01<00:01, 1064.41it/s]Calculating AKI Stages:  49%|████▉     | 1693/3462 [00:01<00:01, 1061.54it/s]Calculating AKI Stages:  52%|█████▏    | 1800/3462 [00:01<00:01, 1062.65it/s]Calculating AKI Stages:  55%|█████▌    | 1907/3462 [00:01<00:01, 1064.74it/s]Calculating AKI Stages:  58%|█████▊    | 2015/3462 [00:01<00:01, 1067.35it/s]Calculating AKI Stages:  61%|██████▏   | 2122/3462 [00:02<00:01, 1063.90it/s]Calculating AKI Stages:  64%|██████▍   | 2229/3462 [00:02<00:01, 1063.53it/s]Calculating AKI Stages:  67%|██████▋   | 2336/3462 [00:02<00:01, 1064.47it/s]Calculating AKI Stages:  71%|███████   | 2445/3462 [00:02<00:00, 1069.39it/s]Calculating AKI Stages:  74%|███████▍  | 2554/3462 [00:02<00:00, 1074.17it/s]Calculating AKI Stages:  77%|███████▋  | 2662/3462 [00:02<00:00, 1072.52it/s]Calculating AKI Stages:  80%|████████  | 2770/3462 [00:02<00:00, 1073.01it/s]Calculating AKI Stages:  83%|████████▎ | 2878/3462 [00:02<00:00, 1070.33it/s]Calculating AKI Stages:  86%|████████▋ | 2986/3462 [00:02<00:00, 1071.65it/s]Calculating AKI Stages:  89%|████████▉ | 3094/3462 [00:02<00:00, 1070.81it/s]Calculating AKI Stages:  93%|█████████▎| 3203/3462 [00:03<00:00, 1075.40it/s]Calculating AKI Stages:  96%|█████████▌| 3311/3462 [00:03<00:00, 1075.85it/s]Calculating AKI Stages:  99%|█████████▉| 3420/3462 [00:03<00:00, 1077.01it/s]Calculating AKI Stages: 100%|██████████| 3462/3462 [00:03<00:00, 1061.16it/s]

AKI Labeling Complete.
Distribution of AKI Stages:
aki_stage
0    3290
1     128
2      23
3      21
Name: count, dtype: int64

Distribution of AKI Binary (Stage >= 1):
aki_label
0    3290
1     172
Name: count, dtype: int64

Distribution of Severe AKI (Stage >= 2):
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Your final cohort after all custom filters has 3462 cases.
      caseid  subjectid  casestart  ...  aki_stage  aki_label  y_severe_aki
3593    3594          1          0  ...          0          0             0
6197    6198          3          0  ...          0          0             0
3416    3417          4          0  ...          0          0             0
733      734          5          0  ...          0          0             0
1579    1580          6          0  ...          0          0             0

[5 rows x 77 columns]

--- Deriving Additional Outcomes ---
Mapping 'icu_days' to 'los_icu'...
Calculating 'los_postop' from 'dis' and 'opend'...
In-hospital mortality (y_inhosp_mortality) counts:
y_inhosp_mortality
0    3435
1      27
Name: count, dtype: Int64
ICU admission (y_icu_admit) counts:
y_icu_admit
0    2669
1     793
Name: count, dtype: Int64
Prolonged LOS Threshold (75th percentile): 7.57 days
Prolonged LOS (y_prolonged_los_postop) counts:
y_prolonged_los_postop
0    2596
1     866
Name: count, dtype: Int64
Severe AKI (y_severe_aki) counts:
y_severe_aki
0    3418
1      44
Name: count, dtype: Int64

Final cohort saved to /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:31:04,076 - INFO - Starting catch22 feature extraction...
2026-01-03 23:31:04,076 - INFO - Mode 'full': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors.csv
2026-01-03 23:31:04,076 - INFO - Mode 'windowed': Output=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_windowed.csv, Error=/home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp_inf_errors_windowed.csv
2026-01-03 23:31:04,110 - INFO - Loaded 3462 cases from /home/exouser/js2-volume/projects/aki_prediction_project/data/processed/aki_pleth_ecg_co2_awp.csv
2026-01-03 23:31:04,110 - INFO - Mode 'full': Found 0 previously processed pairs.
2026-01-03 23:31:04,110 - INFO - Mode 'windowed': Found 0 previously processed pairs.
2026-01-03 23:31:04,152 - INFO - 13848 pairs to process.
2026-01-03 23:31:04,152 - INFO - Using 30 worker processes.
Extracting Features:   0%|          | 0/13848 [00:00<?, ?it/s]Extracting Features:   0%|          | 1/13848 [00:07<28:46:37,  7.48s/it]Extracting Features:   0%|          | 3/13848 [00:08<8:30:44,  2.21s/it] Extracting Features:   0%|          | 5/13848 [00:09<5:14:54,  1.36s/it]Extracting Features:   0%|          | 6/13848 [00:09<4:08:33,  1.08s/it]Extracting Features:   0%|          | 7/13848 [00:09<3:16:17,  1.18it/s]Extracting Features:   0%|          | 8/13848 [00:10<2:32:22,  1.51it/s]Extracting Features:   0%|          | 9/13848 [00:10<2:19:36,  1.65it/s]Extracting Features:   0%|          | 10/13848 [00:11<2:14:43,  1.71it/s]