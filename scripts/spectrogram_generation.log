2025-06-22 17:26:10,143 - INFO - --- Phase 5: Scalable Waveform Data Generation Pipeline (Robust) ---
2025-06-22 17:26:10,143 - INFO - Step 1/6: Loading cohort and data splits...
2025-06-22 17:26:10,170 - INFO - Step 2/6: Ensuring output directory exists at 'data/processed/spectrograms/pleth'...
2025-06-22 17:26:10,182 - INFO - Total cases to process in this run: 2566
2025-06-22 17:26:10,182 - INFO - Step 3/6: Processing cases and generating spectrograms...
2025-06-22 23:03:29,374 - ERROR - An unexpected error occurred processing case 18: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:30,053 - ERROR - An unexpected error occurred processing case 839: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:30,715 - ERROR - An unexpected error occurred processing case 2067: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:31,375 - ERROR - An unexpected error occurred processing case 179: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:32,040 - ERROR - An unexpected error occurred processing case 1381: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:32,700 - ERROR - An unexpected error occurred processing case 3526: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:44,435 - ERROR - An unexpected error occurred processing case 4700: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:45,658 - ERROR - An unexpected error occurred processing case 5854: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:58,940 - ERROR - An unexpected error occurred processing case 4572: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:03:59,660 - ERROR - An unexpected error occurred processing case 602: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:04:00,467 - ERROR - An unexpected error occurred processing case 3581: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:04:01,192 - ERROR - An unexpected error occurred processing case 4943: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:04:01,922 - ERROR - An unexpected error occurred processing case 3014: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:04:02,619 - ERROR - An unexpected error occurred processing case 5199: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-22 23:04:03,319 - ERROR - An unexpected error occurred processing case 3157: invalid number of data points (0) specified
Traceback (most recent call last):
  File "D:\Projects\aki_prediction_project\scripts\5_generate_spectrograms.py", line 126, in main
    resampled_waveform = signal.resample(raw_waveform, resample_len).flatten()
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\signal\_signaltools.py", line 3147, in resample
    X = sp_fft.rfft(x, axis=axis)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_backend.py", line 28, in __ua_function__
    return fn(*args, **kwargs)
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 72, in rfft
    return _execute_1D('rfft', _pocketfft.rfft, x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_basic_backend.py", line 28, in _execute_1D
    return pocketfft_func(x, n=n, axis=axis, norm=norm,
  File "C:\Users\steal\anaconda3\envs\aki_prediction_project\lib\site-packages\scipy\fft\_pocketfft\basic.py", line 58, in r2c
    raise ValueError(f"invalid number of data points ({tmp.shape[axis]}) specified")
ValueError: invalid number of data points (0) specified
2025-06-23 02:00:47,967 - INFO - Step 4/6: Scanning all spectrograms to create final mapping files...
2025-06-23 02:01:00,132 - INFO - Step 5/6: Creating and saving final train/test dataframes...
2025-06-23 02:01:05,987 - INFO - --- Phase 5 Complete ---
2025-06-23 02:01:05,988 - INFO - Script finished in 514.93 minutes.
2025-06-23 02:01:05,988 - INFO - Cases processed in this run: 2551
2025-06-23 02:01:05,988 - INFO - Cases with errors in this run: 15
2025-06-23 02:01:05,988 - INFO - Total training samples available: 2746640
2025-06-23 02:01:05,988 - INFO - Total testing samples available: 669227
2025-06-23 02:01:05,988 - INFO - Training data map saved to: data/processed/train_data.csv
2025-06-23 02:01:05,989 - INFO - Testing data map saved to: data/processed/test_data.csv
2025-06-23 02:01:05,989 - INFO - A detailed log has been saved to: scripts/spectrogram_generation.log
